CREATE OR REPLACE FUNCTION public.execute_sql(query TEXT)
RETURNS VOID AS $$
BEGIN
    EXECUTE query;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

SELECT * FROM pg_proc WHERE proname = 'execute_sql';

GRANT EXECUTE ON FUNCTION execute_sql(TEXT) TO postgres, anon, authenticated;

DROP FUNCTION get_construction_data_es;
CREATE OR REPLACE FUNCTION get_construction_data_1_es()
RETURNS TABLE (TITLE TEXT) AS $$
BEGIN
    RETURN QUERY
     SELECT  
      CASE 
        WHEN "construction_csv_1_es"."Categoría" = 'Servicio' THEN 'Servicio:' || "construction_csv_1_es"."Tarea/Equipo" || ',' || "construction_csv_1_es"."Precio Estimado" ||'€'
        ELSE "construction_csv_1_es"."Tarea/Equipo" || ',' || "construction_csv_1_es"."Precio Estimado" ||'€'
      END AS TITLE
      FROM "construction_csv_1_es"
      LIMIT 5000;
END;
$$ LANGUAGE plpgsql;
CREATE OR REPLACE FUNCTION get_construction_data_1_en()
RETURNS TABLE (TITLE TEXT) AS $$
BEGIN
    RETURN QUERY
     SELECT  
      CASE 
        WHEN "construction_csv_1_en"."Category" = 'Servicio' THEN 'Servicio:' || "construction_csv_1_en"."Task/Equipment" || ',' || "construction_csv_1_en"."Estimated Price" ||'€'
        ELSE "construction_csv_1_en"."Task/Equipment" || ',' || "construction_csv_1_en"."Estimated Price" ||'€'
      END AS TITLE
      FROM "construction_csv_1_en"
      LIMIT 5000;
END;
$$ LANGUAGE plpgsql;
