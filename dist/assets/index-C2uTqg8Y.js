var Kd=Object.defineProperty;var bh=e=>{throw TypeError(e)};var Jd=(e,r,t)=>r in e?Kd(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var Bt=(e,r,t)=>Jd(e,typeof r!="symbol"?r+"":r,t),Nl=(e,r,t)=>r.has(e)||bh("Cannot "+t);var oe=(e,r,t)=>(Nl(e,r,"read from private field"),t?t.call(e):r.get(e)),Ge=(e,r,t)=>r.has(e)?bh("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(e):r.set(e,t),qe=(e,r,t,n)=>(Nl(e,r,"write to private field"),n?n.call(e,t):r.set(e,t),t),Ue=(e,r,t)=>(Nl(e,r,"access private method"),t);var Il=(e,r,t,n)=>({set _(i){qe(e,r,i,t)},get _(){return oe(e,r,n)}});(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(i){if(i.ep)return;i.ep=!0;const l=t(i);fetch(i.href,l)}})();function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(e.__esModule)return e;var r=e.default;if(typeof r=="function"){var t=function n(){return this instanceof n?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};t.prototype=r.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),t}var jsxRuntime={exports:{}},reactJsxRuntime_production={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production;function requireReactJsxRuntime_production(){if(hasRequiredReactJsxRuntime_production)return reactJsxRuntime_production;hasRequiredReactJsxRuntime_production=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function t(n,i,l){var c=null;if(l!==void 0&&(c=""+l),i.key!==void 0&&(c=""+i.key),"key"in i){l={};for(var f in i)f!=="key"&&(l[f]=i[f])}else l=i;return i=l.ref,{$$typeof:e,type:n,key:c,ref:i!==void 0?i:null,props:l}}return reactJsxRuntime_production.Fragment=r,reactJsxRuntime_production.jsx=t,reactJsxRuntime_production.jsxs=t,reactJsxRuntime_production}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),react={exports:{}},react_production={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production;function requireReact_production(){if(hasRequiredReact_production)return react_production;hasRequiredReact_production=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),E=Symbol.iterator;function y(q){return q===null||typeof q!="object"?null:(q=E&&q[E]||q["@@iterator"],typeof q=="function"?q:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,g={};function m(q,me,N){this.props=q,this.context=me,this.refs=g,this.updater=N||S}m.prototype.isReactComponent={},m.prototype.setState=function(q,me){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,me,"setState")},m.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function A(){}A.prototype=m.prototype;function O(q,me,N){this.props=q,this.context=me,this.refs=g,this.updater=N||S}var C=O.prototype=new A;C.constructor=O,x(C,m.prototype),C.isPureReactComponent=!0;var R=Array.isArray,T={H:null,A:null,T:null,S:null},w=Object.prototype.hasOwnProperty;function v(q,me,N,P,k,B){return N=B.ref,{$$typeof:e,type:q,key:me,ref:N!==void 0?N:null,props:B}}function L(q,me){return v(q.type,me,void 0,void 0,void 0,q.props)}function M(q){return typeof q=="object"&&q!==null&&q.$$typeof===e}function X(q){var me={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(N){return me[N]})}var H=/\/+/g;function ne(q,me){return typeof q=="object"&&q!==null&&q.key!=null?X(""+q.key):me.toString(36)}function _e(){}function ge(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(_e,_e):(q.status="pending",q.then(function(me){q.status==="pending"&&(q.status="fulfilled",q.value=me)},function(me){q.status==="pending"&&(q.status="rejected",q.reason=me)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function he(q,me,N,P,k){var B=typeof q;(B==="undefined"||B==="boolean")&&(q=null);var z=!1;if(q===null)z=!0;else switch(B){case"bigint":case"string":case"number":z=!0;break;case"object":switch(q.$$typeof){case e:case r:z=!0;break;case p:return z=q._init,he(z(q._payload),me,N,P,k)}}if(z)return k=k(q),z=P===""?"."+ne(q,0):P,R(k)?(N="",z!=null&&(N=z.replace(H,"$&/")+"/"),he(k,me,N,"",function(F){return F})):k!=null&&(M(k)&&(k=L(k,N+(k.key==null||q&&q.key===k.key?"":(""+k.key).replace(H,"$&/")+"/")+z)),me.push(k)),1;z=0;var Q=P===""?".":P+":";if(R(q))for(var K=0;K<q.length;K++)P=q[K],B=Q+ne(P,K),z+=he(P,me,N,B,k);else if(K=y(q),typeof K=="function")for(q=K.call(q),K=0;!(P=q.next()).done;)P=P.value,B=Q+ne(P,K++),z+=he(P,me,N,B,k);else if(B==="object"){if(typeof q.then=="function")return he(ge(q),me,N,P,k);throw me=String(q),Error("Objects are not valid as a React child (found: "+(me==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":me)+"). If you meant to render a collection of children, use an array instead.")}return z}function W(q,me,N){if(q==null)return q;var P=[],k=0;return he(q,P,"","",function(B){return me.call(N,B,k++)}),P}function se(q){if(q._status===-1){var me=q._result;me=me(),me.then(function(N){(q._status===0||q._status===-1)&&(q._status=1,q._result=N)},function(N){(q._status===0||q._status===-1)&&(q._status=2,q._result=N)}),q._status===-1&&(q._status=0,q._result=me)}if(q._status===1)return q._result.default;throw q._result}var ue=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var me=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(me))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)};function re(){}return react_production.Children={map:W,forEach:function(q,me,N){W(q,function(){me.apply(this,arguments)},N)},count:function(q){var me=0;return W(q,function(){me++}),me},toArray:function(q){return W(q,function(me){return me})||[]},only:function(q){if(!M(q))throw Error("React.Children.only expected to receive a single React element child.");return q}},react_production.Component=m,react_production.Fragment=t,react_production.Profiler=i,react_production.PureComponent=O,react_production.StrictMode=n,react_production.Suspense=d,react_production.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,react_production.act=function(){throw Error("act(...) is not supported in production builds of React.")},react_production.cache=function(q){return function(){return q.apply(null,arguments)}},react_production.cloneElement=function(q,me,N){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var P=x({},q.props),k=q.key,B=void 0;if(me!=null)for(z in me.ref!==void 0&&(B=void 0),me.key!==void 0&&(k=""+me.key),me)!w.call(me,z)||z==="key"||z==="__self"||z==="__source"||z==="ref"&&me.ref===void 0||(P[z]=me[z]);var z=arguments.length-2;if(z===1)P.children=N;else if(1<z){for(var Q=Array(z),K=0;K<z;K++)Q[K]=arguments[K+2];P.children=Q}return v(q.type,k,void 0,void 0,B,P)},react_production.createContext=function(q){return q={$$typeof:c,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:l,_context:q},q},react_production.createElement=function(q,me,N){var P,k={},B=null;if(me!=null)for(P in me.key!==void 0&&(B=""+me.key),me)w.call(me,P)&&P!=="key"&&P!=="__self"&&P!=="__source"&&(k[P]=me[P]);var z=arguments.length-2;if(z===1)k.children=N;else if(1<z){for(var Q=Array(z),K=0;K<z;K++)Q[K]=arguments[K+2];k.children=Q}if(q&&q.defaultProps)for(P in z=q.defaultProps,z)k[P]===void 0&&(k[P]=z[P]);return v(q,B,void 0,void 0,null,k)},react_production.createRef=function(){return{current:null}},react_production.forwardRef=function(q){return{$$typeof:f,render:q}},react_production.isValidElement=M,react_production.lazy=function(q){return{$$typeof:p,_payload:{_status:-1,_result:q},_init:se}},react_production.memo=function(q,me){return{$$typeof:h,type:q,compare:me===void 0?null:me}},react_production.startTransition=function(q){var me=T.T,N={};T.T=N;try{var P=q(),k=T.S;k!==null&&k(N,P),typeof P=="object"&&P!==null&&typeof P.then=="function"&&P.then(re,ue)}catch(B){ue(B)}finally{T.T=me}},react_production.unstable_useCacheRefresh=function(){return T.H.useCacheRefresh()},react_production.use=function(q){return T.H.use(q)},react_production.useActionState=function(q,me,N){return T.H.useActionState(q,me,N)},react_production.useCallback=function(q,me){return T.H.useCallback(q,me)},react_production.useContext=function(q){return T.H.useContext(q)},react_production.useDebugValue=function(){},react_production.useDeferredValue=function(q,me){return T.H.useDeferredValue(q,me)},react_production.useEffect=function(q,me){return T.H.useEffect(q,me)},react_production.useId=function(){return T.H.useId()},react_production.useImperativeHandle=function(q,me,N){return T.H.useImperativeHandle(q,me,N)},react_production.useInsertionEffect=function(q,me){return T.H.useInsertionEffect(q,me)},react_production.useLayoutEffect=function(q,me){return T.H.useLayoutEffect(q,me)},react_production.useMemo=function(q,me){return T.H.useMemo(q,me)},react_production.useOptimistic=function(q,me){return T.H.useOptimistic(q,me)},react_production.useReducer=function(q,me,N){return T.H.useReducer(q,me,N)},react_production.useRef=function(q){return T.H.useRef(q)},react_production.useState=function(q){return T.H.useState(q)},react_production.useSyncExternalStore=function(q,me,N){return T.H.useSyncExternalStore(q,me,N)},react_production.useTransition=function(){return T.H.useTransition()},react_production.version="19.0.0",react_production}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production()),react.exports}var reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var client={exports:{}},reactDomClient_production={},scheduler={exports:{}},scheduler_production={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production;function requireScheduler_production(){return hasRequiredScheduler_production||(hasRequiredScheduler_production=1,function(e){function r(W,se){var ue=W.length;W.push(se);e:for(;0<ue;){var re=ue-1>>>1,q=W[re];if(0<i(q,se))W[re]=se,W[ue]=q,ue=re;else break e}}function t(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var se=W[0],ue=W.pop();if(ue!==se){W[0]=ue;e:for(var re=0,q=W.length,me=q>>>1;re<me;){var N=2*(re+1)-1,P=W[N],k=N+1,B=W[k];if(0>i(P,ue))k<q&&0>i(B,P)?(W[re]=B,W[k]=ue,re=k):(W[re]=P,W[N]=ue,re=N);else if(k<q&&0>i(B,ue))W[re]=B,W[k]=ue,re=k;else break e}}return se}function i(W,se){var ue=W.sortIndex-se.sortIndex;return ue!==0?ue:W.id-se.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var c=Date,f=c.now();e.unstable_now=function(){return c.now()-f}}var d=[],h=[],p=1,E=null,y=3,S=!1,x=!1,g=!1,m=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function C(W){for(var se=t(h);se!==null;){if(se.callback===null)n(h);else if(se.startTime<=W)n(h),se.sortIndex=se.expirationTime,r(d,se);else break;se=t(h)}}function R(W){if(g=!1,C(W),!x)if(t(d)!==null)x=!0,ge();else{var se=t(h);se!==null&&he(R,se.startTime-W)}}var T=!1,w=-1,v=5,L=-1;function M(){return!(e.unstable_now()-L<v)}function X(){if(T){var W=e.unstable_now();L=W;var se=!0;try{e:{x=!1,g&&(g=!1,A(w),w=-1),S=!0;var ue=y;try{t:{for(C(W),E=t(d);E!==null&&!(E.expirationTime>W&&M());){var re=E.callback;if(typeof re=="function"){E.callback=null,y=E.priorityLevel;var q=re(E.expirationTime<=W);if(W=e.unstable_now(),typeof q=="function"){E.callback=q,C(W),se=!0;break t}E===t(d)&&n(d),C(W)}else n(d);E=t(d)}if(E!==null)se=!0;else{var me=t(h);me!==null&&he(R,me.startTime-W),se=!1}}break e}finally{E=null,y=ue,S=!1}se=void 0}}finally{se?H():T=!1}}}var H;if(typeof O=="function")H=function(){O(X)};else if(typeof MessageChannel<"u"){var ne=new MessageChannel,_e=ne.port2;ne.port1.onmessage=X,H=function(){_e.postMessage(null)}}else H=function(){m(X,0)};function ge(){T||(T=!0,H())}function he(W,se){w=m(function(){W(e.unstable_now())},se)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){x||S||(x=!0,ge())},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):v=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_getFirstCallbackNode=function(){return t(d)},e.unstable_next=function(W){switch(y){case 1:case 2:case 3:var se=3;break;default:se=y}var ue=y;y=se;try{return W()}finally{y=ue}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,se){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var ue=y;y=W;try{return se()}finally{y=ue}},e.unstable_scheduleCallback=function(W,se,ue){var re=e.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?re+ue:re):ue=re,W){case 1:var q=-1;break;case 2:q=250;break;case 5:q=1073741823;break;case 4:q=1e4;break;default:q=5e3}return q=ue+q,W={id:p++,callback:se,priorityLevel:W,startTime:ue,expirationTime:q,sortIndex:-1},ue>re?(W.sortIndex=ue,r(h,W),t(d)===null&&W===t(h)&&(g?(A(w),w=-1):g=!0,he(R,ue-re))):(W.sortIndex=q,r(d,W),x||S||(x=!0,ge())),W},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(W){var se=y;return function(){var ue=y;y=se;try{return W.apply(this,arguments)}finally{y=ue}}}}(scheduler_production)),scheduler_production}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production()),scheduler.exports}var reactDom={exports:{}},reactDom_production={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production;function requireReactDom_production(){if(hasRequiredReactDom_production)return reactDom_production;hasRequiredReactDom_production=1;var e=requireReact();function r(d){var h="https://react.dev/errors/"+d;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)h+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+d+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(r(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function l(d,h,p){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:E==null?null:""+E,children:d,containerInfo:h,implementation:p}}var c=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(d,h){if(d==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return reactDom_production.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,reactDom_production.createPortal=function(d,h){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(r(299));return l(d,h,null,p)},reactDom_production.flushSync=function(d){var h=c.T,p=n.p;try{if(c.T=null,n.p=2,d)return d()}finally{c.T=h,n.p=p,n.d.f()}},reactDom_production.preconnect=function(d,h){typeof d=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,n.d.C(d,h))},reactDom_production.prefetchDNS=function(d){typeof d=="string"&&n.d.D(d)},reactDom_production.preinit=function(d,h){if(typeof d=="string"&&h&&typeof h.as=="string"){var p=h.as,E=f(p,h.crossOrigin),y=typeof h.integrity=="string"?h.integrity:void 0,S=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;p==="style"?n.d.S(d,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:E,integrity:y,fetchPriority:S}):p==="script"&&n.d.X(d,{crossOrigin:E,integrity:y,fetchPriority:S,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},reactDom_production.preinitModule=function(d,h){if(typeof d=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var p=f(h.as,h.crossOrigin);n.d.M(d,{crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&n.d.M(d)},reactDom_production.preload=function(d,h){if(typeof d=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var p=h.as,E=f(p,h.crossOrigin);n.d.L(d,p,{crossOrigin:E,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},reactDom_production.preloadModule=function(d,h){if(typeof d=="string")if(h){var p=f(h.as,h.crossOrigin);n.d.m(d,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else n.d.m(d)},reactDom_production.requestFormReset=function(d){n.d.r(d)},reactDom_production.unstable_batchedUpdates=function(d,h){return d(h)},reactDom_production.useFormState=function(d,h,p){return c.H.useFormState(d,h,p)},reactDom_production.useFormStatus=function(){return c.H.useHostTransitionStatus()},reactDom_production.version="19.0.0",reactDom_production}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),reactDom.exports=requireReactDom_production(),reactDom.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDomClient_production;function requireReactDomClient_production(){if(hasRequiredReactDomClient_production)return reactDomClient_production;hasRequiredReactDomClient_production=1;var e=requireScheduler(),r=requireReact(),t=requireReactDom();function n(a){var s="https://react.dev/errors/"+a;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+a+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}var l=Symbol.for("react.element"),c=Symbol.for("react.transitional.element"),f=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),y=Symbol.for("react.consumer"),S=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),O=Symbol.for("react.lazy"),C=Symbol.for("react.offscreen"),R=Symbol.for("react.memo_cache_sentinel"),T=Symbol.iterator;function w(a){return a===null||typeof a!="object"?null:(a=T&&a[T]||a["@@iterator"],typeof a=="function"?a:null)}var v=Symbol.for("react.client.reference");function L(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===v?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case d:return"Fragment";case f:return"Portal";case p:return"Profiler";case h:return"StrictMode";case g:return"Suspense";case m:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case S:return(a.displayName||"Context")+".Provider";case y:return(a._context.displayName||"Context")+".Consumer";case x:var s=a.render;return a=a.displayName,a||(a=s.displayName||s.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case A:return s=a.displayName||null,s!==null?s:L(a.type)||"Memo";case O:s=a._payload,a=a._init;try{return L(a(s))}catch{}}return null}var M=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X=Object.assign,H,ne;function _e(a){if(H===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);H=s&&s[1]||"",ne=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+H+a+ne}var ge=!1;function he(a,s){if(!a||ge)return"";ge=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(s){var je=function(){throw Error()};if(Object.defineProperty(je.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(je,[])}catch(Le){var De=Le}Reflect.construct(a,[],je)}else{try{je.call()}catch(Le){De=Le}a.call(je.prototype)}}else{try{throw Error()}catch(Le){De=Le}(je=a())&&typeof je.catch=="function"&&je.catch(function(){})}}catch(Le){if(Le&&De&&typeof Le.stack=="string")return[Le.stack,De.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var _=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");_&&_.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=u.DetermineComponentFrameRoot(),U=b[0],Z=b[1];if(U&&Z){var de=U.split(`
`),ye=Z.split(`
`);for(_=u=0;u<de.length&&!de[u].includes("DetermineComponentFrameRoot");)u++;for(;_<ye.length&&!ye[_].includes("DetermineComponentFrameRoot");)_++;if(u===de.length||_===ye.length)for(u=de.length-1,_=ye.length-1;1<=u&&0<=_&&de[u]!==ye[_];)_--;for(;1<=u&&0<=_;u--,_--)if(de[u]!==ye[_]){if(u!==1||_!==1)do if(u--,_--,0>_||de[u]!==ye[_]){var Ie=`
`+de[u].replace(" at new "," at ");return a.displayName&&Ie.includes("<anonymous>")&&(Ie=Ie.replace("<anonymous>",a.displayName)),Ie}while(1<=u&&0<=_);break}}}finally{ge=!1,Error.prepareStackTrace=o}return(o=a?a.displayName||a.name:"")?_e(o):""}function W(a){switch(a.tag){case 26:case 27:case 5:return _e(a.type);case 16:return _e("Lazy");case 13:return _e("Suspense");case 19:return _e("SuspenseList");case 0:case 15:return a=he(a.type,!1),a;case 11:return a=he(a.type.render,!1),a;case 1:return a=he(a.type,!0),a;default:return""}}function se(a){try{var s="";do s+=W(a),a=a.return;while(a);return s}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}function ue(a){var s=a,o=a;if(a.alternate)for(;s.return;)s=s.return;else{a=s;do s=a,s.flags&4098&&(o=s.return),a=s.return;while(a)}return s.tag===3?o:null}function re(a){if(a.tag===13){var s=a.memoizedState;if(s===null&&(a=a.alternate,a!==null&&(s=a.memoizedState)),s!==null)return s.dehydrated}return null}function q(a){if(ue(a)!==a)throw Error(n(188))}function me(a){var s=a.alternate;if(!s){if(s=ue(a),s===null)throw Error(n(188));return s!==a?null:a}for(var o=a,u=s;;){var _=o.return;if(_===null)break;var b=_.alternate;if(b===null){if(u=_.return,u!==null){o=u;continue}break}if(_.child===b.child){for(b=_.child;b;){if(b===o)return q(_),a;if(b===u)return q(_),s;b=b.sibling}throw Error(n(188))}if(o.return!==u.return)o=_,u=b;else{for(var U=!1,Z=_.child;Z;){if(Z===o){U=!0,o=_,u=b;break}if(Z===u){U=!0,u=_,o=b;break}Z=Z.sibling}if(!U){for(Z=b.child;Z;){if(Z===o){U=!0,o=b,u=_;break}if(Z===u){U=!0,u=b,o=_;break}Z=Z.sibling}if(!U)throw Error(n(189))}}if(o.alternate!==u)throw Error(n(190))}if(o.tag!==3)throw Error(n(188));return o.stateNode.current===o?a:s}function N(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a;for(a=a.child;a!==null;){if(s=N(a),s!==null)return s;a=a.sibling}return null}var P=Array.isArray,k=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,B={pending:!1,data:null,method:null,action:null},z=[],Q=-1;function K(a){return{current:a}}function F(a){0>Q||(a.current=z[Q],z[Q]=null,Q--)}function I(a,s){Q++,z[Q]=a.current,a.current=s}var V=K(null),D=K(null),Y=K(null),ie=K(null);function te(a,s){switch(I(Y,s),I(D,a),I(V,null),a=s.nodeType,a){case 9:case 11:s=(s=s.documentElement)&&(s=s.namespaceURI)?Zf(s):0;break;default:if(a=a===8?s.parentNode:s,s=a.tagName,a=a.namespaceURI)a=Zf(a),s=eh(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}F(V),I(V,s)}function j(){F(V),F(D),F(Y)}function J(a){a.memoizedState!==null&&I(ie,a);var s=V.current,o=eh(s,a.type);s!==o&&(I(D,a),I(V,o))}function Ae(a){D.current===a&&(F(V),F(D)),ie.current===a&&(F(ie),gs._currentValue=B)}var pe=Object.prototype.hasOwnProperty,ve=e.unstable_scheduleCallback,Te=e.unstable_cancelCallback,Me=e.unstable_shouldYield,ze=e.unstable_requestPaint,we=e.unstable_now,at=e.unstable_getCurrentPriorityLevel,et=e.unstable_ImmediatePriority,Ke=e.unstable_UserBlockingPriority,Ze=e.unstable_NormalPriority,ft=e.unstable_LowPriority,Je=e.unstable_IdlePriority,st=e.log,dt=e.unstable_setDisableYieldValue,nt=null,lt=null;function or(a){if(lt&&typeof lt.onCommitFiberRoot=="function")try{lt.onCommitFiberRoot(nt,a,void 0,(a.current.flags&128)===128)}catch{}}function Wt(a){if(typeof st=="function"&&dt(a),lt&&typeof lt.setStrictMode=="function")try{lt.setStrictMode(nt,a)}catch{}}var Pt=Math.clz32?Math.clz32:Se,Pe=Math.log,Ee=Math.LN2;function Se(a){return a>>>=0,a===0?32:31-(Pe(a)/Ee|0)|0}var We=128,ot=4194304;function pt(a){var s=a&42;if(s!==0)return s;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function vt(a,s){var o=a.pendingLanes;if(o===0)return 0;var u=0,_=a.suspendedLanes,b=a.pingedLanes,U=a.warmLanes;a=a.finishedLanes!==0;var Z=o&134217727;return Z!==0?(o=Z&~_,o!==0?u=pt(o):(b&=Z,b!==0?u=pt(b):a||(U=Z&~U,U!==0&&(u=pt(U))))):(Z=o&~_,Z!==0?u=pt(Z):b!==0?u=pt(b):a||(U=o&~U,U!==0&&(u=pt(U)))),u===0?0:s!==0&&s!==u&&!(s&_)&&(_=u&-u,U=s&-s,_>=U||_===32&&(U&4194176)!==0)?s:u}function Qt(a,s){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&s)===0}function Dr(a,s){switch(a){case 1:case 2:case 4:case 8:return s+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pr(){var a=We;return We<<=1,!(We&4194176)&&(We=128),a}function zt(){var a=ot;return ot<<=1,!(ot&62914560)&&(ot=4194304),a}function gr(a){for(var s=[],o=0;31>o;o++)s.push(a);return s}function Zt(a,s){a.pendingLanes|=s,s!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function na(a,s,o,u,_,b){var U=a.pendingLanes;a.pendingLanes=o,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=o,a.entangledLanes&=o,a.errorRecoveryDisabledLanes&=o,a.shellSuspendCounter=0;var Z=a.entanglements,de=a.expirationTimes,ye=a.hiddenUpdates;for(o=U&~o;0<o;){var Ie=31-Pt(o),je=1<<Ie;Z[Ie]=0,de[Ie]=-1;var De=ye[Ie];if(De!==null)for(ye[Ie]=null,Ie=0;Ie<De.length;Ie++){var Le=De[Ie];Le!==null&&(Le.lane&=-536870913)}o&=~je}u!==0&&Rt(a,u,0),b!==0&&_===0&&a.tag!==0&&(a.suspendedLanes|=b&~(U&~s))}function Rt(a,s,o){a.pendingLanes|=s,a.suspendedLanes&=~s;var u=31-Pt(s);a.entangledLanes|=s,a.entanglements[u]=a.entanglements[u]|1073741824|o&4194218}function jr(a,s){var o=a.entangledLanes|=s;for(a=a.entanglements;o;){var u=31-Pt(o),_=1<<u;_&s|a[u]&s&&(a[u]|=s),o&=~_}}function Hr(a){return a&=-a,2<a?8<a?a&134217727?32:268435456:8:2}function sa(){var a=k.p;return a!==0?a:(a=window.event,a===void 0?32:xh(a.type))}function G(a,s){var o=k.p;try{return k.p=a,s()}finally{k.p=o}}var le=Math.random().toString(36).slice(2),ee="__reactFiber$"+le,ae="__reactProps$"+le,ce="__reactContainer$"+le,fe="__reactEvents$"+le,Fe="__reactListeners$"+le,Ne="__reactHandles$"+le,ke="__reactResources$"+le,Re="__reactMarker$"+le;function Oe(a){delete a[ee],delete a[ae],delete a[fe],delete a[Fe],delete a[Ne]}function He(a){var s=a[ee];if(s)return s;for(var o=a.parentNode;o;){if(s=o[ce]||o[ee]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(a=ah(a);a!==null;){if(o=a[ee])return o;a=ah(a)}return s}a=o,o=a.parentNode}return null}function $e(a){if(a=a[ee]||a[ce]){var s=a.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return a}return null}function Ye(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a.stateNode;throw Error(n(33))}function Ve(a){var s=a[ke];return s||(s=a[ke]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Xe(a){a[Re]=!0}var ct=new Set,wt={};function St(a,s){Ft(a,s),Ft(a+"Capture",s)}function Ft(a,s){for(wt[a]=s,a=0;a<s.length;a++)ct.add(s[a])}var tr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ka=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ia={},Pr={};function kn(a){return pe.call(Pr,a)?!0:pe.call(ia,a)?!1:ka.test(a)?Pr[a]=!0:(ia[a]=!0,!1)}function nr(a,s,o){if(kn(s))if(o===null)a.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":a.removeAttribute(s);return;case"boolean":var u=s.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){a.removeAttribute(s);return}}a.setAttribute(s,""+o)}}function Ss(a,s,o){if(o===null)a.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(s);return}a.setAttribute(s,""+o)}}function zr(a,s,o,u){if(u===null)a.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(o);return}a.setAttributeNS(s,o,""+u)}}function _r(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function tc(a){var s=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Gh(a){var s=tc(a)?"checked":"value",o=Object.getOwnPropertyDescriptor(a.constructor.prototype,s),u=""+a[s];if(!a.hasOwnProperty(s)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var _=o.get,b=o.set;return Object.defineProperty(a,s,{configurable:!0,get:function(){return _.call(this)},set:function(U){u=""+U,b.call(this,U)}}),Object.defineProperty(a,s,{enumerable:o.enumerable}),{getValue:function(){return u},setValue:function(U){u=""+U},stopTracking:function(){a._valueTracker=null,delete a[s]}}}}function As(a){a._valueTracker||(a._valueTracker=Gh(a))}function rc(a){if(!a)return!1;var s=a._valueTracker;if(!s)return!0;var o=s.getValue(),u="";return a&&(u=tc(a)?a.checked?"true":"false":a.value),a=u,a!==o?(s.setValue(a),!0):!1}function bs(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var qh=/[\n"\\]/g;function mr(a){return a.replace(qh,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Pi(a,s,o,u,_,b,U,Z){a.name="",U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?a.type=U:a.removeAttribute("type"),s!=null?U==="number"?(s===0&&a.value===""||a.value!=s)&&(a.value=""+_r(s)):a.value!==""+_r(s)&&(a.value=""+_r(s)):U!=="submit"&&U!=="reset"||a.removeAttribute("value"),s!=null?Mi(a,U,_r(s)):o!=null?Mi(a,U,_r(o)):u!=null&&a.removeAttribute("value"),_==null&&b!=null&&(a.defaultChecked=!!b),_!=null&&(a.checked=_&&typeof _!="function"&&typeof _!="symbol"),Z!=null&&typeof Z!="function"&&typeof Z!="symbol"&&typeof Z!="boolean"?a.name=""+_r(Z):a.removeAttribute("name")}function ac(a,s,o,u,_,b,U,Z){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(a.type=b),s!=null||o!=null){if(!(b!=="submit"&&b!=="reset"||s!=null))return;o=o!=null?""+_r(o):"",s=s!=null?""+_r(s):o,Z||s===a.value||(a.value=s),a.defaultValue=s}u=u??_,u=typeof u!="function"&&typeof u!="symbol"&&!!u,a.checked=Z?a.checked:!!u,a.defaultChecked=!!u,U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"&&(a.name=U)}function Mi(a,s,o){s==="number"&&bs(a.ownerDocument)===a||a.defaultValue===""+o||(a.defaultValue=""+o)}function Wa(a,s,o,u){if(a=a.options,s){s={};for(var _=0;_<o.length;_++)s["$"+o[_]]=!0;for(o=0;o<a.length;o++)_=s.hasOwnProperty("$"+a[o].value),a[o].selected!==_&&(a[o].selected=_),_&&u&&(a[o].defaultSelected=!0)}else{for(o=""+_r(o),s=null,_=0;_<a.length;_++){if(a[_].value===o){a[_].selected=!0,u&&(a[_].defaultSelected=!0);return}s!==null||a[_].disabled||(s=a[_])}s!==null&&(s.selected=!0)}}function nc(a,s,o){if(s!=null&&(s=""+_r(s),s!==a.value&&(a.value=s),o==null)){a.defaultValue!==s&&(a.defaultValue=s);return}a.defaultValue=o!=null?""+_r(o):""}function sc(a,s,o,u){if(s==null){if(u!=null){if(o!=null)throw Error(n(92));if(P(u)){if(1<u.length)throw Error(n(93));u=u[0]}o=u}o==null&&(o=""),s=o}o=_r(s),a.defaultValue=o,u=a.textContent,u===o&&u!==""&&u!==null&&(a.value=u)}function Ya(a,s){if(s){var o=a.firstChild;if(o&&o===a.lastChild&&o.nodeType===3){o.nodeValue=s;return}}a.textContent=s}var $h=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ic(a,s,o){var u=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?a.setProperty(s,""):s==="float"?a.cssFloat="":a[s]="":u?a.setProperty(s,o):typeof o!="number"||o===0||$h.has(s)?s==="float"?a.cssFloat=o:a[s]=(""+o).trim():a[s]=o+"px"}function oc(a,s,o){if(s!=null&&typeof s!="object")throw Error(n(62));if(a=a.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||s!=null&&s.hasOwnProperty(u)||(u.indexOf("--")===0?a.setProperty(u,""):u==="float"?a.cssFloat="":a[u]="");for(var _ in s)u=s[_],s.hasOwnProperty(_)&&o[_]!==u&&ic(a,_,u)}else for(var b in s)s.hasOwnProperty(b)&&ic(a,b,s[b])}function Li(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Yh=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ts(a){return Yh.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var Ni=null;function Ii(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Ka=null,Ja=null;function lc(a){var s=$e(a);if(s&&(a=s.stateNode)){var o=a[ae]||null;e:switch(a=s.stateNode,s.type){case"input":if(Pi(a,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=a;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+mr(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var u=o[s];if(u!==a&&u.form===a.form){var _=u[ae]||null;if(!_)throw Error(n(90));Pi(u,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name)}}for(s=0;s<o.length;s++)u=o[s],u.form===a.form&&rc(u)}break e;case"textarea":nc(a,o.value,o.defaultValue);break e;case"select":s=o.value,s!=null&&Wa(a,!!o.multiple,s,!1)}}}var Bi=!1;function cc(a,s,o){if(Bi)return a(s,o);Bi=!0;try{var u=a(s);return u}finally{if(Bi=!1,(Ka!==null||Ja!==null)&&(li(),Ka&&(s=Ka,a=Ja,Ja=Ka=null,lc(s),a)))for(s=0;s<a.length;s++)lc(a[s])}}function Rn(a,s){var o=a.stateNode;if(o===null)return null;var u=o[ae]||null;if(u===null)return null;o=u[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(a=a.type,u=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!u;break e;default:a=!1}if(a)return null;if(o&&typeof o!="function")throw Error(n(231,s,typeof o));return o}var Ui=!1;if(tr)try{var Fn={};Object.defineProperty(Fn,"passive",{get:function(){Ui=!0}}),window.addEventListener("test",Fn,Fn),window.removeEventListener("test",Fn,Fn)}catch{Ui=!1}var oa=null,ji=null,ws=null;function uc(){if(ws)return ws;var a,s=ji,o=s.length,u,_="value"in oa?oa.value:oa.textContent,b=_.length;for(a=0;a<o&&s[a]===_[a];a++);var U=o-a;for(u=1;u<=U&&s[o-u]===_[b-u];u++);return ws=_.slice(a,1<u?1-u:void 0)}function Cs(a){var s=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&s===13&&(a=13)):a=s,a===10&&(a=13),32<=a||a===13?a:0}function ks(){return!0}function fc(){return!1}function sr(a){function s(o,u,_,b,U){this._reactName=o,this._targetInst=_,this.type=u,this.nativeEvent=b,this.target=U,this.currentTarget=null;for(var Z in a)a.hasOwnProperty(Z)&&(o=a[Z],this[Z]=o?o(b):b[Z]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?ks:fc,this.isPropagationStopped=fc,this}return X(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=ks)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=ks)},persist:function(){},isPersistent:ks}),s}var Ra={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Rs=sr(Ra),On=X({},Ra,{view:0,detail:0}),Kh=sr(On),Hi,zi,Dn,Fs=X({},On,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xi,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Dn&&(Dn&&a.type==="mousemove"?(Hi=a.screenX-Dn.screenX,zi=a.screenY-Dn.screenY):zi=Hi=0,Dn=a),Hi)},movementY:function(a){return"movementY"in a?a.movementY:zi}}),hc=sr(Fs),Jh=X({},Fs,{dataTransfer:0}),Qh=sr(Jh),Zh=X({},On,{relatedTarget:0}),Vi=sr(Zh),e0=X({},Ra,{animationName:0,elapsedTime:0,pseudoElement:0}),t0=sr(e0),r0=X({},Ra,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),a0=sr(r0),n0=X({},Ra,{data:0}),dc=sr(n0),s0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},i0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},o0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function l0(a){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(a):(a=o0[a])?!!s[a]:!1}function Xi(){return l0}var c0=X({},On,{key:function(a){if(a.key){var s=s0[a.key]||a.key;if(s!=="Unidentified")return s}return a.type==="keypress"?(a=Cs(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?i0[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xi,charCode:function(a){return a.type==="keypress"?Cs(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Cs(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),u0=sr(c0),f0=X({},Fs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pc=sr(f0),h0=X({},On,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xi}),d0=sr(h0),p0=X({},Ra,{propertyName:0,elapsedTime:0,pseudoElement:0}),g0=sr(p0),_0=X({},Fs,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),m0=sr(_0),x0=X({},Ra,{newState:0,oldState:0}),v0=sr(x0),y0=[9,13,27,32],Gi=tr&&"CompositionEvent"in window,Pn=null;tr&&"documentMode"in document&&(Pn=document.documentMode);var E0=tr&&"TextEvent"in window&&!Pn,gc=tr&&(!Gi||Pn&&8<Pn&&11>=Pn),_c=" ",mc=!1;function xc(a,s){switch(a){case"keyup":return y0.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vc(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Qa=!1;function S0(a,s){switch(a){case"compositionend":return vc(s);case"keypress":return s.which!==32?null:(mc=!0,_c);case"textInput":return a=s.data,a===_c&&mc?null:a;default:return null}}function A0(a,s){if(Qa)return a==="compositionend"||!Gi&&xc(a,s)?(a=uc(),ws=ji=oa=null,Qa=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return gc&&s.locale!=="ko"?null:s.data;default:return null}}var b0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yc(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s==="input"?!!b0[a.type]:s==="textarea"}function Ec(a,s,o,u){Ka?Ja?Ja.push(u):Ja=[u]:Ka=u,s=di(s,"onChange"),0<s.length&&(o=new Rs("onChange","change",null,o,u),a.push({event:o,listeners:s}))}var Mn=null,Ln=null;function T0(a){Wf(a,0)}function Os(a){var s=Ye(a);if(rc(s))return a}function Sc(a,s){if(a==="change")return s}var Ac=!1;if(tr){var qi;if(tr){var $i="oninput"in document;if(!$i){var bc=document.createElement("div");bc.setAttribute("oninput","return;"),$i=typeof bc.oninput=="function"}qi=$i}else qi=!1;Ac=qi&&(!document.documentMode||9<document.documentMode)}function Tc(){Mn&&(Mn.detachEvent("onpropertychange",wc),Ln=Mn=null)}function wc(a){if(a.propertyName==="value"&&Os(Ln)){var s=[];Ec(s,Ln,a,Ii(a)),cc(T0,s)}}function w0(a,s,o){a==="focusin"?(Tc(),Mn=s,Ln=o,Mn.attachEvent("onpropertychange",wc)):a==="focusout"&&Tc()}function C0(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Os(Ln)}function k0(a,s){if(a==="click")return Os(s)}function R0(a,s){if(a==="input"||a==="change")return Os(s)}function F0(a,s){return a===s&&(a!==0||1/a===1/s)||a!==a&&s!==s}var lr=typeof Object.is=="function"?Object.is:F0;function Nn(a,s){if(lr(a,s))return!0;if(typeof a!="object"||a===null||typeof s!="object"||s===null)return!1;var o=Object.keys(a),u=Object.keys(s);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var _=o[u];if(!pe.call(s,_)||!lr(a[_],s[_]))return!1}return!0}function Cc(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function kc(a,s){var o=Cc(a);a=0;for(var u;o;){if(o.nodeType===3){if(u=a+o.textContent.length,a<=s&&u>=s)return{node:o,offset:s-a};a=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Cc(o)}}function Rc(a,s){return a&&s?a===s?!0:a&&a.nodeType===3?!1:s&&s.nodeType===3?Rc(a,s.parentNode):"contains"in a?a.contains(s):a.compareDocumentPosition?!!(a.compareDocumentPosition(s)&16):!1:!1}function Fc(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var s=bs(a.document);s instanceof a.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)a=s.contentWindow;else break;s=bs(a.document)}return s}function Wi(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s&&(s==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||s==="textarea"||a.contentEditable==="true")}function O0(a,s){var o=Fc(s);s=a.focusedElem;var u=a.selectionRange;if(o!==s&&s&&s.ownerDocument&&Rc(s.ownerDocument.documentElement,s)){if(u!==null&&Wi(s)){if(a=u.start,o=u.end,o===void 0&&(o=a),"selectionStart"in s)s.selectionStart=a,s.selectionEnd=Math.min(o,s.value.length);else if(o=(a=s.ownerDocument||document)&&a.defaultView||window,o.getSelection){o=o.getSelection();var _=s.textContent.length,b=Math.min(u.start,_);u=u.end===void 0?b:Math.min(u.end,_),!o.extend&&b>u&&(_=u,u=b,b=_),_=kc(s,b);var U=kc(s,u);_&&U&&(o.rangeCount!==1||o.anchorNode!==_.node||o.anchorOffset!==_.offset||o.focusNode!==U.node||o.focusOffset!==U.offset)&&(a=a.createRange(),a.setStart(_.node,_.offset),o.removeAllRanges(),b>u?(o.addRange(a),o.extend(U.node,U.offset)):(a.setEnd(U.node,U.offset),o.addRange(a)))}}for(a=[],o=s;o=o.parentNode;)o.nodeType===1&&a.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<a.length;s++)o=a[s],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var D0=tr&&"documentMode"in document&&11>=document.documentMode,Za=null,Yi=null,In=null,Ki=!1;function Oc(a,s,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Ki||Za==null||Za!==bs(u)||(u=Za,"selectionStart"in u&&Wi(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),In&&Nn(In,u)||(In=u,u=di(Yi,"onSelect"),0<u.length&&(s=new Rs("onSelect","select",null,s,o),a.push({event:s,listeners:u}),s.target=Za)))}function Fa(a,s){var o={};return o[a.toLowerCase()]=s.toLowerCase(),o["Webkit"+a]="webkit"+s,o["Moz"+a]="moz"+s,o}var en={animationend:Fa("Animation","AnimationEnd"),animationiteration:Fa("Animation","AnimationIteration"),animationstart:Fa("Animation","AnimationStart"),transitionrun:Fa("Transition","TransitionRun"),transitionstart:Fa("Transition","TransitionStart"),transitioncancel:Fa("Transition","TransitionCancel"),transitionend:Fa("Transition","TransitionEnd")},Ji={},Dc={};tr&&(Dc=document.createElement("div").style,"AnimationEvent"in window||(delete en.animationend.animation,delete en.animationiteration.animation,delete en.animationstart.animation),"TransitionEvent"in window||delete en.transitionend.transition);function Oa(a){if(Ji[a])return Ji[a];if(!en[a])return a;var s=en[a],o;for(o in s)if(s.hasOwnProperty(o)&&o in Dc)return Ji[a]=s[o];return a}var Pc=Oa("animationend"),Mc=Oa("animationiteration"),Lc=Oa("animationstart"),P0=Oa("transitionrun"),M0=Oa("transitionstart"),L0=Oa("transitioncancel"),Nc=Oa("transitionend"),Ic=new Map,Bc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function kr(a,s){Ic.set(a,s),St(s,[a])}var xr=[],tn=0,Qi=0;function Ds(){for(var a=tn,s=Qi=tn=0;s<a;){var o=xr[s];xr[s++]=null;var u=xr[s];xr[s++]=null;var _=xr[s];xr[s++]=null;var b=xr[s];if(xr[s++]=null,u!==null&&_!==null){var U=u.pending;U===null?_.next=_:(_.next=U.next,U.next=_),u.pending=_}b!==0&&Uc(o,_,b)}}function Ps(a,s,o,u){xr[tn++]=a,xr[tn++]=s,xr[tn++]=o,xr[tn++]=u,Qi|=u,a.lanes|=u,a=a.alternate,a!==null&&(a.lanes|=u)}function Zi(a,s,o,u){return Ps(a,s,o,u),Ms(a)}function la(a,s){return Ps(a,null,null,s),Ms(a)}function Uc(a,s,o){a.lanes|=o;var u=a.alternate;u!==null&&(u.lanes|=o);for(var _=!1,b=a.return;b!==null;)b.childLanes|=o,u=b.alternate,u!==null&&(u.childLanes|=o),b.tag===22&&(a=b.stateNode,a===null||a._visibility&1||(_=!0)),a=b,b=b.return;_&&s!==null&&a.tag===3&&(b=a.stateNode,_=31-Pt(o),b=b.hiddenUpdates,a=b[_],a===null?b[_]=[s]:a.push(s),s.lane=o|536870912)}function Ms(a){if(50<ls)throw ls=0,il=null,Error(n(185));for(var s=a.return;s!==null;)a=s,s=a.return;return a.tag===3?a.stateNode:null}var rn={},jc=new WeakMap;function vr(a,s){if(typeof a=="object"&&a!==null){var o=jc.get(a);return o!==void 0?o:(s={value:a,source:s,stack:se(s)},jc.set(a,s),s)}return{value:a,source:s,stack:se(s)}}var an=[],nn=0,Ls=null,Ns=0,yr=[],Er=0,Da=null,Vr=1,Xr="";function Pa(a,s){an[nn++]=Ns,an[nn++]=Ls,Ls=a,Ns=s}function Hc(a,s,o){yr[Er++]=Vr,yr[Er++]=Xr,yr[Er++]=Da,Da=a;var u=Vr;a=Xr;var _=32-Pt(u)-1;u&=~(1<<_),o+=1;var b=32-Pt(s)+_;if(30<b){var U=_-_%5;b=(u&(1<<U)-1).toString(32),u>>=U,_-=U,Vr=1<<32-Pt(s)+_|o<<_|u,Xr=b+a}else Vr=1<<b|o<<_|u,Xr=a}function eo(a){a.return!==null&&(Pa(a,1),Hc(a,1,0))}function to(a){for(;a===Ls;)Ls=an[--nn],an[nn]=null,Ns=an[--nn],an[nn]=null;for(;a===Da;)Da=yr[--Er],yr[Er]=null,Xr=yr[--Er],yr[Er]=null,Vr=yr[--Er],yr[Er]=null}var rr=null,Yt=null,yt=!1,Rr=null,Mr=!1,ro=Error(n(519));function Ma(a){var s=Error(n(418,""));throw jn(vr(s,a)),ro}function zc(a){var s=a.stateNode,o=a.type,u=a.memoizedProps;switch(s[ee]=a,s[ae]=u,o){case"dialog":mt("cancel",s),mt("close",s);break;case"iframe":case"object":case"embed":mt("load",s);break;case"video":case"audio":for(o=0;o<us.length;o++)mt(us[o],s);break;case"source":mt("error",s);break;case"img":case"image":case"link":mt("error",s),mt("load",s);break;case"details":mt("toggle",s);break;case"input":mt("invalid",s),ac(s,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),As(s);break;case"select":mt("invalid",s);break;case"textarea":mt("invalid",s),sc(s,u.value,u.defaultValue,u.children),As(s)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||u.suppressHydrationWarning===!0||Qf(s.textContent,o)?(u.popover!=null&&(mt("beforetoggle",s),mt("toggle",s)),u.onScroll!=null&&mt("scroll",s),u.onScrollEnd!=null&&mt("scrollend",s),u.onClick!=null&&(s.onclick=pi),s=!0):s=!1,s||Ma(a)}function Vc(a){for(rr=a.return;rr;)switch(rr.tag){case 3:case 27:Mr=!0;return;case 5:case 13:Mr=!1;return;default:rr=rr.return}}function Bn(a){if(a!==rr)return!1;if(!yt)return Vc(a),yt=!0,!1;var s=!1,o;if((o=a.tag!==3&&a.tag!==27)&&((o=a.tag===5)&&(o=a.type,o=!(o!=="form"&&o!=="button")||Al(a.type,a.memoizedProps)),o=!o),o&&(s=!0),s&&Yt&&Ma(a),Vc(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));e:{for(a=a.nextSibling,s=0;a;){if(a.nodeType===8)if(o=a.data,o==="/$"){if(s===0){Yt=Or(a.nextSibling);break e}s--}else o!=="$"&&o!=="$!"&&o!=="$?"||s++;a=a.nextSibling}Yt=null}}else Yt=rr?Or(a.stateNode.nextSibling):null;return!0}function Un(){Yt=rr=null,yt=!1}function jn(a){Rr===null?Rr=[a]:Rr.push(a)}var Hn=Error(n(460)),Xc=Error(n(474)),ao={then:function(){}};function Gc(a){return a=a.status,a==="fulfilled"||a==="rejected"}function Is(){}function qc(a,s,o){switch(o=a[o],o===void 0?a.push(s):o!==s&&(s.then(Is,Is),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,a===Hn?Error(n(483)):a;default:if(typeof s.status=="string")s.then(Is,Is);else{if(a=Ct,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=s,a.status="pending",a.then(function(u){if(s.status==="pending"){var _=s;_.status="fulfilled",_.value=u}},function(u){if(s.status==="pending"){var _=s;_.status="rejected",_.reason=u}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,a===Hn?Error(n(483)):a}throw zn=s,Hn}}var zn=null;function $c(){if(zn===null)throw Error(n(459));var a=zn;return zn=null,a}var sn=null,Vn=0;function Bs(a){var s=Vn;return Vn+=1,sn===null&&(sn=[]),qc(sn,a,s)}function Xn(a,s){s=s.props.ref,a.ref=s!==void 0?s:null}function Us(a,s){throw s.$$typeof===l?Error(n(525)):(a=Object.prototype.toString.call(s),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":a)))}function Wc(a){var s=a._init;return s(a._payload)}function Yc(a){function s(be,xe){if(a){var Ce=be.deletions;Ce===null?(be.deletions=[xe],be.flags|=16):Ce.push(xe)}}function o(be,xe){if(!a)return null;for(;xe!==null;)s(be,xe),xe=xe.sibling;return null}function u(be){for(var xe=new Map;be!==null;)be.key!==null?xe.set(be.key,be):xe.set(be.index,be),be=be.sibling;return xe}function _(be,xe){return be=ya(be,xe),be.index=0,be.sibling=null,be}function b(be,xe,Ce){return be.index=Ce,a?(Ce=be.alternate,Ce!==null?(Ce=Ce.index,Ce<xe?(be.flags|=33554434,xe):Ce):(be.flags|=33554434,xe)):(be.flags|=1048576,xe)}function U(be){return a&&be.alternate===null&&(be.flags|=33554434),be}function Z(be,xe,Ce,Be){return xe===null||xe.tag!==6?(xe=Qo(Ce,be.mode,Be),xe.return=be,xe):(xe=_(xe,Ce),xe.return=be,xe)}function de(be,xe,Ce,Be){var Qe=Ce.type;return Qe===d?Ie(be,xe,Ce.props.children,Be,Ce.key):xe!==null&&(xe.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===O&&Wc(Qe)===xe.type)?(xe=_(xe,Ce.props),Xn(xe,Ce),xe.return=be,xe):(xe=ai(Ce.type,Ce.key,Ce.props,null,be.mode,Be),Xn(xe,Ce),xe.return=be,xe)}function ye(be,xe,Ce,Be){return xe===null||xe.tag!==4||xe.stateNode.containerInfo!==Ce.containerInfo||xe.stateNode.implementation!==Ce.implementation?(xe=Zo(Ce,be.mode,Be),xe.return=be,xe):(xe=_(xe,Ce.children||[]),xe.return=be,xe)}function Ie(be,xe,Ce,Be,Qe){return xe===null||xe.tag!==7?(xe=Xa(Ce,be.mode,Be,Qe),xe.return=be,xe):(xe=_(xe,Ce),xe.return=be,xe)}function je(be,xe,Ce){if(typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint")return xe=Qo(""+xe,be.mode,Ce),xe.return=be,xe;if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case c:return Ce=ai(xe.type,xe.key,xe.props,null,be.mode,Ce),Xn(Ce,xe),Ce.return=be,Ce;case f:return xe=Zo(xe,be.mode,Ce),xe.return=be,xe;case O:var Be=xe._init;return xe=Be(xe._payload),je(be,xe,Ce)}if(P(xe)||w(xe))return xe=Xa(xe,be.mode,Ce,null),xe.return=be,xe;if(typeof xe.then=="function")return je(be,Bs(xe),Ce);if(xe.$$typeof===S)return je(be,ei(be,xe),Ce);Us(be,xe)}return null}function De(be,xe,Ce,Be){var Qe=xe!==null?xe.key:null;if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return Qe!==null?null:Z(be,xe,""+Ce,Be);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case c:return Ce.key===Qe?de(be,xe,Ce,Be):null;case f:return Ce.key===Qe?ye(be,xe,Ce,Be):null;case O:return Qe=Ce._init,Ce=Qe(Ce._payload),De(be,xe,Ce,Be)}if(P(Ce)||w(Ce))return Qe!==null?null:Ie(be,xe,Ce,Be,null);if(typeof Ce.then=="function")return De(be,xe,Bs(Ce),Be);if(Ce.$$typeof===S)return De(be,xe,ei(be,Ce),Be);Us(be,Ce)}return null}function Le(be,xe,Ce,Be,Qe){if(typeof Be=="string"&&Be!==""||typeof Be=="number"||typeof Be=="bigint")return be=be.get(Ce)||null,Z(xe,be,""+Be,Qe);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case c:return be=be.get(Be.key===null?Ce:Be.key)||null,de(xe,be,Be,Qe);case f:return be=be.get(Be.key===null?Ce:Be.key)||null,ye(xe,be,Be,Qe);case O:var gt=Be._init;return Be=gt(Be._payload),Le(be,xe,Ce,Be,Qe)}if(P(Be)||w(Be))return be=be.get(Ce)||null,Ie(xe,be,Be,Qe,null);if(typeof Be.then=="function")return Le(be,xe,Ce,Bs(Be),Qe);if(Be.$$typeof===S)return Le(be,xe,Ce,ei(xe,Be),Qe);Us(xe,Be)}return null}function tt(be,xe,Ce,Be){for(var Qe=null,gt=null,rt=xe,it=xe=0,$t=null;rt!==null&&it<Ce.length;it++){rt.index>it?($t=rt,rt=null):$t=rt.sibling;var Et=De(be,rt,Ce[it],Be);if(Et===null){rt===null&&(rt=$t);break}a&&rt&&Et.alternate===null&&s(be,rt),xe=b(Et,xe,it),gt===null?Qe=Et:gt.sibling=Et,gt=Et,rt=$t}if(it===Ce.length)return o(be,rt),yt&&Pa(be,it),Qe;if(rt===null){for(;it<Ce.length;it++)rt=je(be,Ce[it],Be),rt!==null&&(xe=b(rt,xe,it),gt===null?Qe=rt:gt.sibling=rt,gt=rt);return yt&&Pa(be,it),Qe}for(rt=u(rt);it<Ce.length;it++)$t=Le(rt,be,it,Ce[it],Be),$t!==null&&(a&&$t.alternate!==null&&rt.delete($t.key===null?it:$t.key),xe=b($t,xe,it),gt===null?Qe=$t:gt.sibling=$t,gt=$t);return a&&rt.forEach(function(Ca){return s(be,Ca)}),yt&&Pa(be,it),Qe}function ut(be,xe,Ce,Be){if(Ce==null)throw Error(n(151));for(var Qe=null,gt=null,rt=xe,it=xe=0,$t=null,Et=Ce.next();rt!==null&&!Et.done;it++,Et=Ce.next()){rt.index>it?($t=rt,rt=null):$t=rt.sibling;var Ca=De(be,rt,Et.value,Be);if(Ca===null){rt===null&&(rt=$t);break}a&&rt&&Ca.alternate===null&&s(be,rt),xe=b(Ca,xe,it),gt===null?Qe=Ca:gt.sibling=Ca,gt=Ca,rt=$t}if(Et.done)return o(be,rt),yt&&Pa(be,it),Qe;if(rt===null){for(;!Et.done;it++,Et=Ce.next())Et=je(be,Et.value,Be),Et!==null&&(xe=b(Et,xe,it),gt===null?Qe=Et:gt.sibling=Et,gt=Et);return yt&&Pa(be,it),Qe}for(rt=u(rt);!Et.done;it++,Et=Ce.next())Et=Le(rt,be,it,Et.value,Be),Et!==null&&(a&&Et.alternate!==null&&rt.delete(Et.key===null?it:Et.key),xe=b(Et,xe,it),gt===null?Qe=Et:gt.sibling=Et,gt=Et);return a&&rt.forEach(function(Yd){return s(be,Yd)}),yt&&Pa(be,it),Qe}function Nt(be,xe,Ce,Be){if(typeof Ce=="object"&&Ce!==null&&Ce.type===d&&Ce.key===null&&(Ce=Ce.props.children),typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case c:e:{for(var Qe=Ce.key;xe!==null;){if(xe.key===Qe){if(Qe=Ce.type,Qe===d){if(xe.tag===7){o(be,xe.sibling),Be=_(xe,Ce.props.children),Be.return=be,be=Be;break e}}else if(xe.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===O&&Wc(Qe)===xe.type){o(be,xe.sibling),Be=_(xe,Ce.props),Xn(Be,Ce),Be.return=be,be=Be;break e}o(be,xe);break}else s(be,xe);xe=xe.sibling}Ce.type===d?(Be=Xa(Ce.props.children,be.mode,Be,Ce.key),Be.return=be,be=Be):(Be=ai(Ce.type,Ce.key,Ce.props,null,be.mode,Be),Xn(Be,Ce),Be.return=be,be=Be)}return U(be);case f:e:{for(Qe=Ce.key;xe!==null;){if(xe.key===Qe)if(xe.tag===4&&xe.stateNode.containerInfo===Ce.containerInfo&&xe.stateNode.implementation===Ce.implementation){o(be,xe.sibling),Be=_(xe,Ce.children||[]),Be.return=be,be=Be;break e}else{o(be,xe);break}else s(be,xe);xe=xe.sibling}Be=Zo(Ce,be.mode,Be),Be.return=be,be=Be}return U(be);case O:return Qe=Ce._init,Ce=Qe(Ce._payload),Nt(be,xe,Ce,Be)}if(P(Ce))return tt(be,xe,Ce,Be);if(w(Ce)){if(Qe=w(Ce),typeof Qe!="function")throw Error(n(150));return Ce=Qe.call(Ce),ut(be,xe,Ce,Be)}if(typeof Ce.then=="function")return Nt(be,xe,Bs(Ce),Be);if(Ce.$$typeof===S)return Nt(be,xe,ei(be,Ce),Be);Us(be,Ce)}return typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint"?(Ce=""+Ce,xe!==null&&xe.tag===6?(o(be,xe.sibling),Be=_(xe,Ce),Be.return=be,be=Be):(o(be,xe),Be=Qo(Ce,be.mode,Be),Be.return=be,be=Be),U(be)):o(be,xe)}return function(be,xe,Ce,Be){try{Vn=0;var Qe=Nt(be,xe,Ce,Be);return sn=null,Qe}catch(rt){if(rt===Hn)throw rt;var gt=Tr(29,rt,null,be.mode);return gt.lanes=Be,gt.return=be,gt}finally{}}}var La=Yc(!0),Kc=Yc(!1),on=K(null),js=K(0);function Jc(a,s){a=ta,I(js,a),I(on,s),ta=a|s.baseLanes}function no(){I(js,ta),I(on,on.current)}function so(){ta=js.current,F(on),F(js)}var Sr=K(null),Lr=null;function ca(a){var s=a.alternate;I(Vt,Vt.current&1),I(Sr,a),Lr===null&&(s===null||on.current!==null||s.memoizedState!==null)&&(Lr=a)}function Qc(a){if(a.tag===22){if(I(Vt,Vt.current),I(Sr,a),Lr===null){var s=a.alternate;s!==null&&s.memoizedState!==null&&(Lr=a)}}else ua()}function ua(){I(Vt,Vt.current),I(Sr,Sr.current)}function Gr(a){F(Sr),Lr===a&&(Lr=null),F(Vt)}var Vt=K(0);function Hs(a){for(var s=a;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var N0=typeof AbortController<"u"?AbortController:function(){var a=[],s=this.signal={aborted:!1,addEventListener:function(o,u){a.push(u)}};this.abort=function(){s.aborted=!0,a.forEach(function(o){return o()})}},I0=e.unstable_scheduleCallback,B0=e.unstable_NormalPriority,Xt={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function io(){return{controller:new N0,data:new Map,refCount:0}}function Gn(a){a.refCount--,a.refCount===0&&I0(B0,function(){a.controller.abort()})}var qn=null,oo=0,ln=0,cn=null;function U0(a,s){if(qn===null){var o=qn=[];oo=0,ln=pl(),cn={status:"pending",value:void 0,then:function(u){o.push(u)}}}return oo++,s.then(Zc,Zc),s}function Zc(){if(--oo===0&&qn!==null){cn!==null&&(cn.status="fulfilled");var a=qn;qn=null,ln=0,cn=null;for(var s=0;s<a.length;s++)(0,a[s])()}}function j0(a,s){var o=[],u={status:"pending",value:null,reason:null,then:function(_){o.push(_)}};return a.then(function(){u.status="fulfilled",u.value=s;for(var _=0;_<o.length;_++)(0,o[_])(s)},function(_){for(u.status="rejected",u.reason=_,_=0;_<o.length;_++)(0,o[_])(void 0)}),u}var eu=M.S;M.S=function(a,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&U0(a,s),eu!==null&&eu(a,s)};var Na=K(null);function lo(){var a=Na.current;return a!==null?a:Ct.pooledCache}function zs(a,s){s===null?I(Na,Na.current):I(Na,s.pool)}function tu(){var a=lo();return a===null?null:{parent:Xt._currentValue,pool:a}}var fa=0,ht=null,At=null,Ut=null,Vs=!1,un=!1,Ia=!1,Xs=0,$n=0,fn=null,H0=0;function It(){throw Error(n(321))}function co(a,s){if(s===null)return!1;for(var o=0;o<s.length&&o<a.length;o++)if(!lr(a[o],s[o]))return!1;return!0}function uo(a,s,o,u,_,b){return fa=b,ht=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,M.H=a===null||a.memoizedState===null?Ba:ha,Ia=!1,b=o(u,_),Ia=!1,un&&(b=au(s,o,u,_)),ru(a),b}function ru(a){M.H=Nr;var s=At!==null&&At.next!==null;if(fa=0,Ut=At=ht=null,Vs=!1,$n=0,fn=null,s)throw Error(n(300));a===null||Gt||(a=a.dependencies,a!==null&&Zs(a)&&(Gt=!0))}function au(a,s,o,u){ht=a;var _=0;do{if(un&&(fn=null),$n=0,un=!1,25<=_)throw Error(n(301));if(_+=1,Ut=At=null,a.updateQueue!=null){var b=a.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}M.H=Ua,b=s(o,u)}while(un);return b}function z0(){var a=M.H,s=a.useState()[0];return s=typeof s.then=="function"?Wn(s):s,a=a.useState()[0],(At!==null?At.memoizedState:null)!==a&&(ht.flags|=1024),s}function fo(){var a=Xs!==0;return Xs=0,a}function ho(a,s,o){s.updateQueue=a.updateQueue,s.flags&=-2053,a.lanes&=~o}function po(a){if(Vs){for(a=a.memoizedState;a!==null;){var s=a.queue;s!==null&&(s.pending=null),a=a.next}Vs=!1}fa=0,Ut=At=ht=null,un=!1,$n=Xs=0,fn=null}function ir(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ut===null?ht.memoizedState=Ut=a:Ut=Ut.next=a,Ut}function jt(){if(At===null){var a=ht.alternate;a=a!==null?a.memoizedState:null}else a=At.next;var s=Ut===null?ht.memoizedState:Ut.next;if(s!==null)Ut=s,At=a;else{if(a===null)throw ht.alternate===null?Error(n(467)):Error(n(310));At=a,a={memoizedState:At.memoizedState,baseState:At.baseState,baseQueue:At.baseQueue,queue:At.queue,next:null},Ut===null?ht.memoizedState=Ut=a:Ut=Ut.next=a}return Ut}var Gs;Gs=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Wn(a){var s=$n;return $n+=1,fn===null&&(fn=[]),a=qc(fn,a,s),s=ht,(Ut===null?s.memoizedState:Ut.next)===null&&(s=s.alternate,M.H=s===null||s.memoizedState===null?Ba:ha),a}function qs(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Wn(a);if(a.$$typeof===S)return er(a)}throw Error(n(438,String(a)))}function go(a){var s=null,o=ht.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var u=ht.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(s={data:u.data.map(function(_){return _.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=Gs(),ht.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(a),u=0;u<a;u++)o[u]=R;return s.index++,o}function qr(a,s){return typeof s=="function"?s(a):s}function $s(a){var s=jt();return _o(s,At,a)}function _o(a,s,o){var u=a.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=o;var _=a.baseQueue,b=u.pending;if(b!==null){if(_!==null){var U=_.next;_.next=b.next,b.next=U}s.baseQueue=_=b,u.pending=null}if(b=a.baseState,_===null)a.memoizedState=b;else{s=_.next;var Z=U=null,de=null,ye=s,Ie=!1;do{var je=ye.lane&-536870913;if(je!==ye.lane?(xt&je)===je:(fa&je)===je){var De=ye.revertLane;if(De===0)de!==null&&(de=de.next={lane:0,revertLane:0,action:ye.action,hasEagerState:ye.hasEagerState,eagerState:ye.eagerState,next:null}),je===ln&&(Ie=!0);else if((fa&De)===De){ye=ye.next,De===ln&&(Ie=!0);continue}else je={lane:0,revertLane:ye.revertLane,action:ye.action,hasEagerState:ye.hasEagerState,eagerState:ye.eagerState,next:null},de===null?(Z=de=je,U=b):de=de.next=je,ht.lanes|=De,Ea|=De;je=ye.action,Ia&&o(b,je),b=ye.hasEagerState?ye.eagerState:o(b,je)}else De={lane:je,revertLane:ye.revertLane,action:ye.action,hasEagerState:ye.hasEagerState,eagerState:ye.eagerState,next:null},de===null?(Z=de=De,U=b):de=de.next=De,ht.lanes|=je,Ea|=je;ye=ye.next}while(ye!==null&&ye!==s);if(de===null?U=b:de.next=Z,!lr(b,a.memoizedState)&&(Gt=!0,Ie&&(o=cn,o!==null)))throw o;a.memoizedState=b,a.baseState=U,a.baseQueue=de,u.lastRenderedState=b}return _===null&&(u.lanes=0),[a.memoizedState,u.dispatch]}function mo(a){var s=jt(),o=s.queue;if(o===null)throw Error(n(311));o.lastRenderedReducer=a;var u=o.dispatch,_=o.pending,b=s.memoizedState;if(_!==null){o.pending=null;var U=_=_.next;do b=a(b,U.action),U=U.next;while(U!==_);lr(b,s.memoizedState)||(Gt=!0),s.memoizedState=b,s.baseQueue===null&&(s.baseState=b),o.lastRenderedState=b}return[b,u]}function nu(a,s,o){var u=ht,_=jt(),b=yt;if(b){if(o===void 0)throw Error(n(407));o=o()}else o=s();var U=!lr((At||_).memoizedState,o);if(U&&(_.memoizedState=o,Gt=!0),_=_.queue,yo(ou.bind(null,u,_,a),[a]),_.getSnapshot!==s||U||Ut!==null&&Ut.memoizedState.tag&1){if(u.flags|=2048,hn(9,iu.bind(null,u,_,o,s),{destroy:void 0},null),Ct===null)throw Error(n(349));b||fa&60||su(u,s,o)}return o}function su(a,s,o){a.flags|=16384,a={getSnapshot:s,value:o},s=ht.updateQueue,s===null?(s=Gs(),ht.updateQueue=s,s.stores=[a]):(o=s.stores,o===null?s.stores=[a]:o.push(a))}function iu(a,s,o,u){s.value=o,s.getSnapshot=u,lu(s)&&cu(a)}function ou(a,s,o){return o(function(){lu(s)&&cu(a)})}function lu(a){var s=a.getSnapshot;a=a.value;try{var o=s();return!lr(a,o)}catch{return!0}}function cu(a){var s=la(a,2);s!==null&&ar(s,a,2)}function xo(a){var s=ir();if(typeof a=="function"){var o=a;if(a=o(),Ia){Wt(!0);try{o()}finally{Wt(!1)}}}return s.memoizedState=s.baseState=a,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qr,lastRenderedState:a},s}function uu(a,s,o,u){return a.baseState=o,_o(a,At,typeof u=="function"?u:qr)}function V0(a,s,o,u,_){if(Ks(a))throw Error(n(485));if(a=s.action,a!==null){var b={payload:_,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(U){b.listeners.push(U)}};M.T!==null?o(!0):b.isTransition=!1,u(b),o=s.pending,o===null?(b.next=s.pending=b,fu(s,b)):(b.next=o.next,s.pending=o.next=b)}}function fu(a,s){var o=s.action,u=s.payload,_=a.state;if(s.isTransition){var b=M.T,U={};M.T=U;try{var Z=o(_,u),de=M.S;de!==null&&de(U,Z),hu(a,s,Z)}catch(ye){vo(a,s,ye)}finally{M.T=b}}else try{b=o(_,u),hu(a,s,b)}catch(ye){vo(a,s,ye)}}function hu(a,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){du(a,s,u)},function(u){return vo(a,s,u)}):du(a,s,o)}function du(a,s,o){s.status="fulfilled",s.value=o,pu(s),a.state=o,s=a.pending,s!==null&&(o=s.next,o===s?a.pending=null:(o=o.next,s.next=o,fu(a,o)))}function vo(a,s,o){var u=a.pending;if(a.pending=null,u!==null){u=u.next;do s.status="rejected",s.reason=o,pu(s),s=s.next;while(s!==u)}a.action=null}function pu(a){a=a.listeners;for(var s=0;s<a.length;s++)(0,a[s])()}function gu(a,s){return s}function _u(a,s){if(yt){var o=Ct.formState;if(o!==null){e:{var u=ht;if(yt){if(Yt){t:{for(var _=Yt,b=Mr;_.nodeType!==8;){if(!b){_=null;break t}if(_=Or(_.nextSibling),_===null){_=null;break t}}b=_.data,_=b==="F!"||b==="F"?_:null}if(_){Yt=Or(_.nextSibling),u=_.data==="F!";break e}}Ma(u)}u=!1}u&&(s=o[0])}}return o=ir(),o.memoizedState=o.baseState=s,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gu,lastRenderedState:s},o.queue=u,o=Mu.bind(null,ht,u),u.dispatch=o,u=xo(!1),b=To.bind(null,ht,!1,u.queue),u=ir(),_={state:s,dispatch:null,action:a,pending:null},u.queue=_,o=V0.bind(null,ht,_,b,o),_.dispatch=o,u.memoizedState=a,[s,o,!1]}function mu(a){var s=jt();return xu(s,At,a)}function xu(a,s,o){s=_o(a,s,gu)[0],a=$s(qr)[0],s=typeof s=="object"&&s!==null&&typeof s.then=="function"?Wn(s):s;var u=jt(),_=u.queue,b=_.dispatch;return o!==u.memoizedState&&(ht.flags|=2048,hn(9,X0.bind(null,_,o),{destroy:void 0},null)),[s,b,a]}function X0(a,s){a.action=s}function vu(a){var s=jt(),o=At;if(o!==null)return xu(s,o,a);jt(),s=s.memoizedState,o=jt();var u=o.queue.dispatch;return o.memoizedState=a,[s,u,!1]}function hn(a,s,o,u){return a={tag:a,create:s,inst:o,deps:u,next:null},s=ht.updateQueue,s===null&&(s=Gs(),ht.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=a.next=a:(u=o.next,o.next=a,a.next=u,s.lastEffect=a),a}function yu(){return jt().memoizedState}function Ws(a,s,o,u){var _=ir();ht.flags|=a,_.memoizedState=hn(1|s,o,{destroy:void 0},u===void 0?null:u)}function Ys(a,s,o,u){var _=jt();u=u===void 0?null:u;var b=_.memoizedState.inst;At!==null&&u!==null&&co(u,At.memoizedState.deps)?_.memoizedState=hn(s,o,b,u):(ht.flags|=a,_.memoizedState=hn(1|s,o,b,u))}function Eu(a,s){Ws(8390656,8,a,s)}function yo(a,s){Ys(2048,8,a,s)}function Su(a,s){return Ys(4,2,a,s)}function Au(a,s){return Ys(4,4,a,s)}function bu(a,s){if(typeof s=="function"){a=a();var o=s(a);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return a=a(),s.current=a,function(){s.current=null}}function Tu(a,s,o){o=o!=null?o.concat([a]):null,Ys(4,4,bu.bind(null,s,a),o)}function Eo(){}function wu(a,s){var o=jt();s=s===void 0?null:s;var u=o.memoizedState;return s!==null&&co(s,u[1])?u[0]:(o.memoizedState=[a,s],a)}function Cu(a,s){var o=jt();s=s===void 0?null:s;var u=o.memoizedState;if(s!==null&&co(s,u[1]))return u[0];if(u=a(),Ia){Wt(!0);try{a()}finally{Wt(!1)}}return o.memoizedState=[u,s],u}function So(a,s,o){return o===void 0||fa&1073741824?a.memoizedState=s:(a.memoizedState=o,a=Ff(),ht.lanes|=a,Ea|=a,o)}function ku(a,s,o,u){return lr(o,s)?o:on.current!==null?(a=So(a,o,u),lr(a,s)||(Gt=!0),a):fa&42?(a=Ff(),ht.lanes|=a,Ea|=a,s):(Gt=!0,a.memoizedState=o)}function Ru(a,s,o,u,_){var b=k.p;k.p=b!==0&&8>b?b:8;var U=M.T,Z={};M.T=Z,To(a,!1,s,o);try{var de=_(),ye=M.S;if(ye!==null&&ye(Z,de),de!==null&&typeof de=="object"&&typeof de.then=="function"){var Ie=j0(de,u);Yn(a,s,Ie,hr(a))}else Yn(a,s,u,hr(a))}catch(je){Yn(a,s,{then:function(){},status:"rejected",reason:je},hr())}finally{k.p=b,M.T=U}}function G0(){}function Ao(a,s,o,u){if(a.tag!==5)throw Error(n(476));var _=Fu(a).queue;Ru(a,_,s,B,o===null?G0:function(){return Ou(a),o(u)})}function Fu(a){var s=a.memoizedState;if(s!==null)return s;s={memoizedState:B,baseState:B,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qr,lastRenderedState:B},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:qr,lastRenderedState:o},next:null},a.memoizedState=s,a=a.alternate,a!==null&&(a.memoizedState=s),s}function Ou(a){var s=Fu(a).next.queue;Yn(a,s,{},hr())}function bo(){return er(gs)}function Du(){return jt().memoizedState}function Pu(){return jt().memoizedState}function q0(a){for(var s=a.return;s!==null;){switch(s.tag){case 24:case 3:var o=hr();a=ga(o);var u=_a(s,a,o);u!==null&&(ar(u,s,o),Qn(u,s,o)),s={cache:io()},a.payload=s;return}s=s.return}}function $0(a,s,o){var u=hr();o={lane:u,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null},Ks(a)?Lu(s,o):(o=Zi(a,s,o,u),o!==null&&(ar(o,a,u),Nu(o,s,u)))}function Mu(a,s,o){var u=hr();Yn(a,s,o,u)}function Yn(a,s,o,u){var _={lane:u,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null};if(Ks(a))Lu(s,_);else{var b=a.alternate;if(a.lanes===0&&(b===null||b.lanes===0)&&(b=s.lastRenderedReducer,b!==null))try{var U=s.lastRenderedState,Z=b(U,o);if(_.hasEagerState=!0,_.eagerState=Z,lr(Z,U))return Ps(a,s,_,0),Ct===null&&Ds(),!1}catch{}finally{}if(o=Zi(a,s,_,u),o!==null)return ar(o,a,u),Nu(o,s,u),!0}return!1}function To(a,s,o,u){if(u={lane:2,revertLane:pl(),action:u,hasEagerState:!1,eagerState:null,next:null},Ks(a)){if(s)throw Error(n(479))}else s=Zi(a,o,u,2),s!==null&&ar(s,a,2)}function Ks(a){var s=a.alternate;return a===ht||s!==null&&s===ht}function Lu(a,s){un=Vs=!0;var o=a.pending;o===null?s.next=s:(s.next=o.next,o.next=s),a.pending=s}function Nu(a,s,o){if(o&4194176){var u=s.lanes;u&=a.pendingLanes,o|=u,s.lanes=o,jr(a,o)}}var Nr={readContext:er,use:qs,useCallback:It,useContext:It,useEffect:It,useImperativeHandle:It,useLayoutEffect:It,useInsertionEffect:It,useMemo:It,useReducer:It,useRef:It,useState:It,useDebugValue:It,useDeferredValue:It,useTransition:It,useSyncExternalStore:It,useId:It};Nr.useCacheRefresh=It,Nr.useMemoCache=It,Nr.useHostTransitionStatus=It,Nr.useFormState=It,Nr.useActionState=It,Nr.useOptimistic=It;var Ba={readContext:er,use:qs,useCallback:function(a,s){return ir().memoizedState=[a,s===void 0?null:s],a},useContext:er,useEffect:Eu,useImperativeHandle:function(a,s,o){o=o!=null?o.concat([a]):null,Ws(4194308,4,bu.bind(null,s,a),o)},useLayoutEffect:function(a,s){return Ws(4194308,4,a,s)},useInsertionEffect:function(a,s){Ws(4,2,a,s)},useMemo:function(a,s){var o=ir();s=s===void 0?null:s;var u=a();if(Ia){Wt(!0);try{a()}finally{Wt(!1)}}return o.memoizedState=[u,s],u},useReducer:function(a,s,o){var u=ir();if(o!==void 0){var _=o(s);if(Ia){Wt(!0);try{o(s)}finally{Wt(!1)}}}else _=s;return u.memoizedState=u.baseState=_,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:_},u.queue=a,a=a.dispatch=$0.bind(null,ht,a),[u.memoizedState,a]},useRef:function(a){var s=ir();return a={current:a},s.memoizedState=a},useState:function(a){a=xo(a);var s=a.queue,o=Mu.bind(null,ht,s);return s.dispatch=o,[a.memoizedState,o]},useDebugValue:Eo,useDeferredValue:function(a,s){var o=ir();return So(o,a,s)},useTransition:function(){var a=xo(!1);return a=Ru.bind(null,ht,a.queue,!0,!1),ir().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,s,o){var u=ht,_=ir();if(yt){if(o===void 0)throw Error(n(407));o=o()}else{if(o=s(),Ct===null)throw Error(n(349));xt&60||su(u,s,o)}_.memoizedState=o;var b={value:o,getSnapshot:s};return _.queue=b,Eu(ou.bind(null,u,b,a),[a]),u.flags|=2048,hn(9,iu.bind(null,u,b,o,s),{destroy:void 0},null),o},useId:function(){var a=ir(),s=Ct.identifierPrefix;if(yt){var o=Xr,u=Vr;o=(u&~(1<<32-Pt(u)-1)).toString(32)+o,s=":"+s+"R"+o,o=Xs++,0<o&&(s+="H"+o.toString(32)),s+=":"}else o=H0++,s=":"+s+"r"+o.toString(32)+":";return a.memoizedState=s},useCacheRefresh:function(){return ir().memoizedState=q0.bind(null,ht)}};Ba.useMemoCache=go,Ba.useHostTransitionStatus=bo,Ba.useFormState=_u,Ba.useActionState=_u,Ba.useOptimistic=function(a){var s=ir();s.memoizedState=s.baseState=a;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=To.bind(null,ht,!0,o),o.dispatch=s,[a,s]};var ha={readContext:er,use:qs,useCallback:wu,useContext:er,useEffect:yo,useImperativeHandle:Tu,useInsertionEffect:Su,useLayoutEffect:Au,useMemo:Cu,useReducer:$s,useRef:yu,useState:function(){return $s(qr)},useDebugValue:Eo,useDeferredValue:function(a,s){var o=jt();return ku(o,At.memoizedState,a,s)},useTransition:function(){var a=$s(qr)[0],s=jt().memoizedState;return[typeof a=="boolean"?a:Wn(a),s]},useSyncExternalStore:nu,useId:Du};ha.useCacheRefresh=Pu,ha.useMemoCache=go,ha.useHostTransitionStatus=bo,ha.useFormState=mu,ha.useActionState=mu,ha.useOptimistic=function(a,s){var o=jt();return uu(o,At,a,s)};var Ua={readContext:er,use:qs,useCallback:wu,useContext:er,useEffect:yo,useImperativeHandle:Tu,useInsertionEffect:Su,useLayoutEffect:Au,useMemo:Cu,useReducer:mo,useRef:yu,useState:function(){return mo(qr)},useDebugValue:Eo,useDeferredValue:function(a,s){var o=jt();return At===null?So(o,a,s):ku(o,At.memoizedState,a,s)},useTransition:function(){var a=mo(qr)[0],s=jt().memoizedState;return[typeof a=="boolean"?a:Wn(a),s]},useSyncExternalStore:nu,useId:Du};Ua.useCacheRefresh=Pu,Ua.useMemoCache=go,Ua.useHostTransitionStatus=bo,Ua.useFormState=vu,Ua.useActionState=vu,Ua.useOptimistic=function(a,s){var o=jt();return At!==null?uu(o,At,a,s):(o.baseState=a,[a,o.queue.dispatch])};function wo(a,s,o,u){s=a.memoizedState,o=o(u,s),o=o==null?s:X({},s,o),a.memoizedState=o,a.lanes===0&&(a.updateQueue.baseState=o)}var Co={isMounted:function(a){return(a=a._reactInternals)?ue(a)===a:!1},enqueueSetState:function(a,s,o){a=a._reactInternals;var u=hr(),_=ga(u);_.payload=s,o!=null&&(_.callback=o),s=_a(a,_,u),s!==null&&(ar(s,a,u),Qn(s,a,u))},enqueueReplaceState:function(a,s,o){a=a._reactInternals;var u=hr(),_=ga(u);_.tag=1,_.payload=s,o!=null&&(_.callback=o),s=_a(a,_,u),s!==null&&(ar(s,a,u),Qn(s,a,u))},enqueueForceUpdate:function(a,s){a=a._reactInternals;var o=hr(),u=ga(o);u.tag=2,s!=null&&(u.callback=s),s=_a(a,u,o),s!==null&&(ar(s,a,o),Qn(s,a,o))}};function Iu(a,s,o,u,_,b,U){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(u,b,U):s.prototype&&s.prototype.isPureReactComponent?!Nn(o,u)||!Nn(_,b):!0}function Bu(a,s,o,u){a=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,u),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,u),s.state!==a&&Co.enqueueReplaceState(s,s.state,null)}function ja(a,s){var o=s;if("ref"in s){o={};for(var u in s)u!=="ref"&&(o[u]=s[u])}if(a=a.defaultProps){o===s&&(o=X({},o));for(var _ in a)o[_]===void 0&&(o[_]=a[_])}return o}var Js=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function Uu(a){Js(a)}function ju(a){console.error(a)}function Hu(a){Js(a)}function Qs(a,s){try{var o=a.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(u){setTimeout(function(){throw u})}}function zu(a,s,o){try{var u=a.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(_){setTimeout(function(){throw _})}}function ko(a,s,o){return o=ga(o),o.tag=3,o.payload={element:null},o.callback=function(){Qs(a,s)},o}function Vu(a){return a=ga(a),a.tag=3,a}function Xu(a,s,o,u){var _=o.type.getDerivedStateFromError;if(typeof _=="function"){var b=u.value;a.payload=function(){return _(b)},a.callback=function(){zu(s,o,u)}}var U=o.stateNode;U!==null&&typeof U.componentDidCatch=="function"&&(a.callback=function(){zu(s,o,u),typeof _!="function"&&(Sa===null?Sa=new Set([this]):Sa.add(this));var Z=u.stack;this.componentDidCatch(u.value,{componentStack:Z!==null?Z:""})})}function W0(a,s,o,u,_){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(s=o.alternate,s!==null&&Jn(s,o,_,!0),o=Sr.current,o!==null){switch(o.tag){case 13:return Lr===null?cl():o.alternate===null&&Lt===0&&(Lt=3),o.flags&=-257,o.flags|=65536,o.lanes=_,u===ao?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([u]):s.add(u),fl(a,u,_)),!1;case 22:return o.flags|=65536,u===ao?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([u]):o.add(u)),fl(a,u,_)),!1}throw Error(n(435,o.tag))}return fl(a,u,_),cl(),!1}if(yt)return s=Sr.current,s!==null?(!(s.flags&65536)&&(s.flags|=256),s.flags|=65536,s.lanes=_,u!==ro&&(a=Error(n(422),{cause:u}),jn(vr(a,o)))):(u!==ro&&(s=Error(n(423),{cause:u}),jn(vr(s,o))),a=a.current.alternate,a.flags|=65536,_&=-_,a.lanes|=_,u=vr(u,o),_=ko(a.stateNode,u,_),Vo(a,_),Lt!==4&&(Lt=2)),!1;var b=Error(n(520),{cause:u});if(b=vr(b,o),is===null?is=[b]:is.push(b),Lt!==4&&(Lt=2),s===null)return!0;u=vr(u,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,a=_&-_,o.lanes|=a,a=ko(o.stateNode,u,a),Vo(o,a),!1;case 1:if(s=o.type,b=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Sa===null||!Sa.has(b))))return o.flags|=65536,_&=-_,o.lanes|=_,_=Vu(_),Xu(_,a,o,u),Vo(o,_),!1}o=o.return}while(o!==null);return!1}var Gu=Error(n(461)),Gt=!1;function Kt(a,s,o,u){s.child=a===null?Kc(s,null,o,u):La(s,a.child,o,u)}function qu(a,s,o,u,_){o=o.render;var b=s.ref;if("ref"in u){var U={};for(var Z in u)Z!=="ref"&&(U[Z]=u[Z])}else U=u;return za(s),u=uo(a,s,o,U,b,_),Z=fo(),a!==null&&!Gt?(ho(a,s,_),$r(a,s,_)):(yt&&Z&&eo(s),s.flags|=1,Kt(a,s,u,_),s.child)}function $u(a,s,o,u,_){if(a===null){var b=o.type;return typeof b=="function"&&!Jo(b)&&b.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=b,Wu(a,s,b,u,_)):(a=ai(o.type,null,u,s,s.mode,_),a.ref=s.ref,a.return=s,s.child=a)}if(b=a.child,!Io(a,_)){var U=b.memoizedProps;if(o=o.compare,o=o!==null?o:Nn,o(U,u)&&a.ref===s.ref)return $r(a,s,_)}return s.flags|=1,a=ya(b,u),a.ref=s.ref,a.return=s,s.child=a}function Wu(a,s,o,u,_){if(a!==null){var b=a.memoizedProps;if(Nn(b,u)&&a.ref===s.ref)if(Gt=!1,s.pendingProps=u=b,Io(a,_))a.flags&131072&&(Gt=!0);else return s.lanes=a.lanes,$r(a,s,_)}return Ro(a,s,o,u,_)}function Yu(a,s,o){var u=s.pendingProps,_=u.children,b=(s.stateNode._pendingVisibility&2)!==0,U=a!==null?a.memoizedState:null;if(Kn(a,s),u.mode==="hidden"||b){if(s.flags&128){if(u=U!==null?U.baseLanes|o:o,a!==null){for(_=s.child=a.child,b=0;_!==null;)b=b|_.lanes|_.childLanes,_=_.sibling;s.childLanes=b&~u}else s.childLanes=0,s.child=null;return Ku(a,s,u,o)}if(o&536870912)s.memoizedState={baseLanes:0,cachePool:null},a!==null&&zs(s,U!==null?U.cachePool:null),U!==null?Jc(s,U):no(),Qc(s);else return s.lanes=s.childLanes=536870912,Ku(a,s,U!==null?U.baseLanes|o:o,o)}else U!==null?(zs(s,U.cachePool),Jc(s,U),ua(),s.memoizedState=null):(a!==null&&zs(s,null),no(),ua());return Kt(a,s,_,o),s.child}function Ku(a,s,o,u){var _=lo();return _=_===null?null:{parent:Xt._currentValue,pool:_},s.memoizedState={baseLanes:o,cachePool:_},a!==null&&zs(s,null),no(),Qc(s),a!==null&&Jn(a,s,u,!0),null}function Kn(a,s){var o=s.ref;if(o===null)a!==null&&a.ref!==null&&(s.flags|=2097664);else{if(typeof o!="function"&&typeof o!="object")throw Error(n(284));(a===null||a.ref!==o)&&(s.flags|=2097664)}}function Ro(a,s,o,u,_){return za(s),o=uo(a,s,o,u,void 0,_),u=fo(),a!==null&&!Gt?(ho(a,s,_),$r(a,s,_)):(yt&&u&&eo(s),s.flags|=1,Kt(a,s,o,_),s.child)}function Ju(a,s,o,u,_,b){return za(s),s.updateQueue=null,o=au(s,u,o,_),ru(a),u=fo(),a!==null&&!Gt?(ho(a,s,b),$r(a,s,b)):(yt&&u&&eo(s),s.flags|=1,Kt(a,s,o,b),s.child)}function Qu(a,s,o,u,_){if(za(s),s.stateNode===null){var b=rn,U=o.contextType;typeof U=="object"&&U!==null&&(b=er(U)),b=new o(u,b),s.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=Co,s.stateNode=b,b._reactInternals=s,b=s.stateNode,b.props=u,b.state=s.memoizedState,b.refs={},Ho(s),U=o.contextType,b.context=typeof U=="object"&&U!==null?er(U):rn,b.state=s.memoizedState,U=o.getDerivedStateFromProps,typeof U=="function"&&(wo(s,o,U,u),b.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(U=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),U!==b.state&&Co.enqueueReplaceState(b,b.state,null),es(s,u,b,_),Zn(),b.state=s.memoizedState),typeof b.componentDidMount=="function"&&(s.flags|=4194308),u=!0}else if(a===null){b=s.stateNode;var Z=s.memoizedProps,de=ja(o,Z);b.props=de;var ye=b.context,Ie=o.contextType;U=rn,typeof Ie=="object"&&Ie!==null&&(U=er(Ie));var je=o.getDerivedStateFromProps;Ie=typeof je=="function"||typeof b.getSnapshotBeforeUpdate=="function",Z=s.pendingProps!==Z,Ie||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(Z||ye!==U)&&Bu(s,b,u,U),pa=!1;var De=s.memoizedState;b.state=De,es(s,u,b,_),Zn(),ye=s.memoizedState,Z||De!==ye||pa?(typeof je=="function"&&(wo(s,o,je,u),ye=s.memoizedState),(de=pa||Iu(s,o,de,u,De,ye,U))?(Ie||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(s.flags|=4194308)):(typeof b.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=u,s.memoizedState=ye),b.props=u,b.state=ye,b.context=U,u=de):(typeof b.componentDidMount=="function"&&(s.flags|=4194308),u=!1)}else{b=s.stateNode,zo(a,s),U=s.memoizedProps,Ie=ja(o,U),b.props=Ie,je=s.pendingProps,De=b.context,ye=o.contextType,de=rn,typeof ye=="object"&&ye!==null&&(de=er(ye)),Z=o.getDerivedStateFromProps,(ye=typeof Z=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(U!==je||De!==de)&&Bu(s,b,u,de),pa=!1,De=s.memoizedState,b.state=De,es(s,u,b,_),Zn();var Le=s.memoizedState;U!==je||De!==Le||pa||a!==null&&a.dependencies!==null&&Zs(a.dependencies)?(typeof Z=="function"&&(wo(s,o,Z,u),Le=s.memoizedState),(Ie=pa||Iu(s,o,Ie,u,De,Le,de)||a!==null&&a.dependencies!==null&&Zs(a.dependencies))?(ye||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(u,Le,de),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(u,Le,de)),typeof b.componentDidUpdate=="function"&&(s.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof b.componentDidUpdate!="function"||U===a.memoizedProps&&De===a.memoizedState||(s.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&De===a.memoizedState||(s.flags|=1024),s.memoizedProps=u,s.memoizedState=Le),b.props=u,b.state=Le,b.context=de,u=Ie):(typeof b.componentDidUpdate!="function"||U===a.memoizedProps&&De===a.memoizedState||(s.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||U===a.memoizedProps&&De===a.memoizedState||(s.flags|=1024),u=!1)}return b=u,Kn(a,s),u=(s.flags&128)!==0,b||u?(b=s.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:b.render(),s.flags|=1,a!==null&&u?(s.child=La(s,a.child,null,_),s.child=La(s,null,o,_)):Kt(a,s,o,_),s.memoizedState=b.state,a=s.child):a=$r(a,s,_),a}function Zu(a,s,o,u){return Un(),s.flags|=256,Kt(a,s,o,u),s.child}var Fo={dehydrated:null,treeContext:null,retryLane:0};function Oo(a){return{baseLanes:a,cachePool:tu()}}function Do(a,s,o){return a=a!==null?a.childLanes&~o:0,s&&(a|=wr),a}function ef(a,s,o){var u=s.pendingProps,_=!1,b=(s.flags&128)!==0,U;if((U=b)||(U=a!==null&&a.memoizedState===null?!1:(Vt.current&2)!==0),U&&(_=!0,s.flags&=-129),U=(s.flags&32)!==0,s.flags&=-33,a===null){if(yt){if(_?ca(s):ua(),yt){var Z=Yt,de;if(de=Z){e:{for(de=Z,Z=Mr;de.nodeType!==8;){if(!Z){Z=null;break e}if(de=Or(de.nextSibling),de===null){Z=null;break e}}Z=de}Z!==null?(s.memoizedState={dehydrated:Z,treeContext:Da!==null?{id:Vr,overflow:Xr}:null,retryLane:536870912},de=Tr(18,null,null,0),de.stateNode=Z,de.return=s,s.child=de,rr=s,Yt=null,de=!0):de=!1}de||Ma(s)}if(Z=s.memoizedState,Z!==null&&(Z=Z.dehydrated,Z!==null))return Z.data==="$!"?s.lanes=16:s.lanes=536870912,null;Gr(s)}return Z=u.children,u=u.fallback,_?(ua(),_=s.mode,Z=Mo({mode:"hidden",children:Z},_),u=Xa(u,_,o,null),Z.return=s,u.return=s,Z.sibling=u,s.child=Z,_=s.child,_.memoizedState=Oo(o),_.childLanes=Do(a,U,o),s.memoizedState=Fo,u):(ca(s),Po(s,Z))}if(de=a.memoizedState,de!==null&&(Z=de.dehydrated,Z!==null)){if(b)s.flags&256?(ca(s),s.flags&=-257,s=Lo(a,s,o)):s.memoizedState!==null?(ua(),s.child=a.child,s.flags|=128,s=null):(ua(),_=u.fallback,Z=s.mode,u=Mo({mode:"visible",children:u.children},Z),_=Xa(_,Z,o,null),_.flags|=2,u.return=s,_.return=s,u.sibling=_,s.child=u,La(s,a.child,null,o),u=s.child,u.memoizedState=Oo(o),u.childLanes=Do(a,U,o),s.memoizedState=Fo,s=_);else if(ca(s),Z.data==="$!"){if(U=Z.nextSibling&&Z.nextSibling.dataset,U)var ye=U.dgst;U=ye,u=Error(n(419)),u.stack="",u.digest=U,jn({value:u,source:null,stack:null}),s=Lo(a,s,o)}else if(Gt||Jn(a,s,o,!1),U=(o&a.childLanes)!==0,Gt||U){if(U=Ct,U!==null){if(u=o&-o,u&42)u=1;else switch(u){case 2:u=1;break;case 8:u=4;break;case 32:u=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:u=64;break;case 268435456:u=134217728;break;default:u=0}if(u=u&(U.suspendedLanes|o)?0:u,u!==0&&u!==de.retryLane)throw de.retryLane=u,la(a,u),ar(U,a,u),Gu}Z.data==="$?"||cl(),s=Lo(a,s,o)}else Z.data==="$?"?(s.flags|=128,s.child=a.child,s=cd.bind(null,a),Z._reactRetry=s,s=null):(a=de.treeContext,Yt=Or(Z.nextSibling),rr=s,yt=!0,Rr=null,Mr=!1,a!==null&&(yr[Er++]=Vr,yr[Er++]=Xr,yr[Er++]=Da,Vr=a.id,Xr=a.overflow,Da=s),s=Po(s,u.children),s.flags|=4096);return s}return _?(ua(),_=u.fallback,Z=s.mode,de=a.child,ye=de.sibling,u=ya(de,{mode:"hidden",children:u.children}),u.subtreeFlags=de.subtreeFlags&31457280,ye!==null?_=ya(ye,_):(_=Xa(_,Z,o,null),_.flags|=2),_.return=s,u.return=s,u.sibling=_,s.child=u,u=_,_=s.child,Z=a.child.memoizedState,Z===null?Z=Oo(o):(de=Z.cachePool,de!==null?(ye=Xt._currentValue,de=de.parent!==ye?{parent:ye,pool:ye}:de):de=tu(),Z={baseLanes:Z.baseLanes|o,cachePool:de}),_.memoizedState=Z,_.childLanes=Do(a,U,o),s.memoizedState=Fo,u):(ca(s),o=a.child,a=o.sibling,o=ya(o,{mode:"visible",children:u.children}),o.return=s,o.sibling=null,a!==null&&(U=s.deletions,U===null?(s.deletions=[a],s.flags|=16):U.push(a)),s.child=o,s.memoizedState=null,o)}function Po(a,s){return s=Mo({mode:"visible",children:s},a.mode),s.return=a,a.child=s}function Mo(a,s){return Cf(a,s,0,null)}function Lo(a,s,o){return La(s,a.child,null,o),a=Po(s,s.pendingProps.children),a.flags|=2,s.memoizedState=null,a}function tf(a,s,o){a.lanes|=s;var u=a.alternate;u!==null&&(u.lanes|=s),Uo(a.return,s,o)}function No(a,s,o,u,_){var b=a.memoizedState;b===null?a.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:_}:(b.isBackwards=s,b.rendering=null,b.renderingStartTime=0,b.last=u,b.tail=o,b.tailMode=_)}function rf(a,s,o){var u=s.pendingProps,_=u.revealOrder,b=u.tail;if(Kt(a,s,u.children,o),u=Vt.current,u&2)u=u&1|2,s.flags|=128;else{if(a!==null&&a.flags&128)e:for(a=s.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&tf(a,o,s);else if(a.tag===19)tf(a,o,s);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}u&=1}switch(I(Vt,u),_){case"forwards":for(o=s.child,_=null;o!==null;)a=o.alternate,a!==null&&Hs(a)===null&&(_=o),o=o.sibling;o=_,o===null?(_=s.child,s.child=null):(_=o.sibling,o.sibling=null),No(s,!1,_,o,b);break;case"backwards":for(o=null,_=s.child,s.child=null;_!==null;){if(a=_.alternate,a!==null&&Hs(a)===null){s.child=_;break}a=_.sibling,_.sibling=o,o=_,_=a}No(s,!0,o,null,b);break;case"together":No(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function $r(a,s,o){if(a!==null&&(s.dependencies=a.dependencies),Ea|=s.lanes,!(o&s.childLanes))if(a!==null){if(Jn(a,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(a!==null&&s.child!==a.child)throw Error(n(153));if(s.child!==null){for(a=s.child,o=ya(a,a.pendingProps),s.child=o,o.return=s;a.sibling!==null;)a=a.sibling,o=o.sibling=ya(a,a.pendingProps),o.return=s;o.sibling=null}return s.child}function Io(a,s){return a.lanes&s?!0:(a=a.dependencies,!!(a!==null&&Zs(a)))}function Y0(a,s,o){switch(s.tag){case 3:te(s,s.stateNode.containerInfo),da(s,Xt,a.memoizedState.cache),Un();break;case 27:case 5:J(s);break;case 4:te(s,s.stateNode.containerInfo);break;case 10:da(s,s.type,s.memoizedProps.value);break;case 13:var u=s.memoizedState;if(u!==null)return u.dehydrated!==null?(ca(s),s.flags|=128,null):o&s.child.childLanes?ef(a,s,o):(ca(s),a=$r(a,s,o),a!==null?a.sibling:null);ca(s);break;case 19:var _=(a.flags&128)!==0;if(u=(o&s.childLanes)!==0,u||(Jn(a,s,o,!1),u=(o&s.childLanes)!==0),_){if(u)return rf(a,s,o);s.flags|=128}if(_=s.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),I(Vt,Vt.current),u)break;return null;case 22:case 23:return s.lanes=0,Yu(a,s,o);case 24:da(s,Xt,a.memoizedState.cache)}return $r(a,s,o)}function af(a,s,o){if(a!==null)if(a.memoizedProps!==s.pendingProps)Gt=!0;else{if(!Io(a,o)&&!(s.flags&128))return Gt=!1,Y0(a,s,o);Gt=!!(a.flags&131072)}else Gt=!1,yt&&s.flags&1048576&&Hc(s,Ns,s.index);switch(s.lanes=0,s.tag){case 16:e:{a=s.pendingProps;var u=s.elementType,_=u._init;if(u=_(u._payload),s.type=u,typeof u=="function")Jo(u)?(a=ja(u,a),s.tag=1,s=Qu(null,s,u,a,o)):(s.tag=0,s=Ro(null,s,u,a,o));else{if(u!=null){if(_=u.$$typeof,_===x){s.tag=11,s=qu(null,s,u,a,o);break e}else if(_===A){s.tag=14,s=$u(null,s,u,a,o);break e}}throw s=L(u)||u,Error(n(306,s,""))}}return s;case 0:return Ro(a,s,s.type,s.pendingProps,o);case 1:return u=s.type,_=ja(u,s.pendingProps),Qu(a,s,u,_,o);case 3:e:{if(te(s,s.stateNode.containerInfo),a===null)throw Error(n(387));var b=s.pendingProps;_=s.memoizedState,u=_.element,zo(a,s),es(s,b,null,o);var U=s.memoizedState;if(b=U.cache,da(s,Xt,b),b!==_.cache&&jo(s,[Xt],o,!0),Zn(),b=U.element,_.isDehydrated)if(_={element:b,isDehydrated:!1,cache:U.cache},s.updateQueue.baseState=_,s.memoizedState=_,s.flags&256){s=Zu(a,s,b,o);break e}else if(b!==u){u=vr(Error(n(424)),s),jn(u),s=Zu(a,s,b,o);break e}else for(Yt=Or(s.stateNode.containerInfo.firstChild),rr=s,yt=!0,Rr=null,Mr=!0,o=Kc(s,null,b,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Un(),b===u){s=$r(a,s,o);break e}Kt(a,s,b,o)}s=s.child}return s;case 26:return Kn(a,s),a===null?(o=oh(s.type,null,s.pendingProps,null))?s.memoizedState=o:yt||(o=s.type,a=s.pendingProps,u=gi(Y.current).createElement(o),u[ee]=s,u[ae]=a,Jt(u,o,a),Xe(u),s.stateNode=u):s.memoizedState=oh(s.type,a.memoizedProps,s.pendingProps,a.memoizedState),null;case 27:return J(s),a===null&&yt&&(u=s.stateNode=nh(s.type,s.pendingProps,Y.current),rr=s,Mr=!0,Yt=Or(u.firstChild)),u=s.pendingProps.children,a!==null||yt?Kt(a,s,u,o):s.child=La(s,null,u,o),Kn(a,s),s.child;case 5:return a===null&&yt&&((_=u=Yt)&&(u=Td(u,s.type,s.pendingProps,Mr),u!==null?(s.stateNode=u,rr=s,Yt=Or(u.firstChild),Mr=!1,_=!0):_=!1),_||Ma(s)),J(s),_=s.type,b=s.pendingProps,U=a!==null?a.memoizedProps:null,u=b.children,Al(_,b)?u=null:U!==null&&Al(_,U)&&(s.flags|=32),s.memoizedState!==null&&(_=uo(a,s,z0,null,null,o),gs._currentValue=_),Kn(a,s),Kt(a,s,u,o),s.child;case 6:return a===null&&yt&&((a=o=Yt)&&(o=wd(o,s.pendingProps,Mr),o!==null?(s.stateNode=o,rr=s,Yt=null,a=!0):a=!1),a||Ma(s)),null;case 13:return ef(a,s,o);case 4:return te(s,s.stateNode.containerInfo),u=s.pendingProps,a===null?s.child=La(s,null,u,o):Kt(a,s,u,o),s.child;case 11:return qu(a,s,s.type,s.pendingProps,o);case 7:return Kt(a,s,s.pendingProps,o),s.child;case 8:return Kt(a,s,s.pendingProps.children,o),s.child;case 12:return Kt(a,s,s.pendingProps.children,o),s.child;case 10:return u=s.pendingProps,da(s,s.type,u.value),Kt(a,s,u.children,o),s.child;case 9:return _=s.type._context,u=s.pendingProps.children,za(s),_=er(_),u=u(_),s.flags|=1,Kt(a,s,u,o),s.child;case 14:return $u(a,s,s.type,s.pendingProps,o);case 15:return Wu(a,s,s.type,s.pendingProps,o);case 19:return rf(a,s,o);case 22:return Yu(a,s,o);case 24:return za(s),u=er(Xt),a===null?(_=lo(),_===null&&(_=Ct,b=io(),_.pooledCache=b,b.refCount++,b!==null&&(_.pooledCacheLanes|=o),_=b),s.memoizedState={parent:u,cache:_},Ho(s),da(s,Xt,_)):(a.lanes&o&&(zo(a,s),es(s,null,null,o),Zn()),_=a.memoizedState,b=s.memoizedState,_.parent!==u?(_={parent:u,cache:u},s.memoizedState=_,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=_),da(s,Xt,u)):(u=b.cache,da(s,Xt,u),u!==_.cache&&jo(s,[Xt],o,!0))),Kt(a,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(n(156,s.tag))}var Bo=K(null),Ha=null,Wr=null;function da(a,s,o){I(Bo,s._currentValue),s._currentValue=o}function Yr(a){a._currentValue=Bo.current,F(Bo)}function Uo(a,s,o){for(;a!==null;){var u=a.alternate;if((a.childLanes&s)!==s?(a.childLanes|=s,u!==null&&(u.childLanes|=s)):u!==null&&(u.childLanes&s)!==s&&(u.childLanes|=s),a===o)break;a=a.return}}function jo(a,s,o,u){var _=a.child;for(_!==null&&(_.return=a);_!==null;){var b=_.dependencies;if(b!==null){var U=_.child;b=b.firstContext;e:for(;b!==null;){var Z=b;b=_;for(var de=0;de<s.length;de++)if(Z.context===s[de]){b.lanes|=o,Z=b.alternate,Z!==null&&(Z.lanes|=o),Uo(b.return,o,a),u||(U=null);break e}b=Z.next}}else if(_.tag===18){if(U=_.return,U===null)throw Error(n(341));U.lanes|=o,b=U.alternate,b!==null&&(b.lanes|=o),Uo(U,o,a),U=null}else U=_.child;if(U!==null)U.return=_;else for(U=_;U!==null;){if(U===a){U=null;break}if(_=U.sibling,_!==null){_.return=U.return,U=_;break}U=U.return}_=U}}function Jn(a,s,o,u){a=null;for(var _=s,b=!1;_!==null;){if(!b){if(_.flags&524288)b=!0;else if(_.flags&262144)break}if(_.tag===10){var U=_.alternate;if(U===null)throw Error(n(387));if(U=U.memoizedProps,U!==null){var Z=_.type;lr(_.pendingProps.value,U.value)||(a!==null?a.push(Z):a=[Z])}}else if(_===ie.current){if(U=_.alternate,U===null)throw Error(n(387));U.memoizedState.memoizedState!==_.memoizedState.memoizedState&&(a!==null?a.push(gs):a=[gs])}_=_.return}a!==null&&jo(s,a,o,u),s.flags|=262144}function Zs(a){for(a=a.firstContext;a!==null;){if(!lr(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function za(a){Ha=a,Wr=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function er(a){return nf(Ha,a)}function ei(a,s){return Ha===null&&za(a),nf(a,s)}function nf(a,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},Wr===null){if(a===null)throw Error(n(308));Wr=s,a.dependencies={lanes:0,firstContext:s},a.flags|=524288}else Wr=Wr.next=s;return o}var pa=!1;function Ho(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function zo(a,s){a=a.updateQueue,s.updateQueue===a&&(s.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function ga(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function _a(a,s,o){var u=a.updateQueue;if(u===null)return null;if(u=u.shared,Dt&2){var _=u.pending;return _===null?s.next=s:(s.next=_.next,_.next=s),u.pending=s,s=Ms(a),Uc(a,null,o),s}return Ps(a,u,s,o),Ms(a)}function Qn(a,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194176)!==0)){var u=s.lanes;u&=a.pendingLanes,o|=u,s.lanes=o,jr(a,o)}}function Vo(a,s){var o=a.updateQueue,u=a.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var _=null,b=null;if(o=o.firstBaseUpdate,o!==null){do{var U={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};b===null?_=b=U:b=b.next=U,o=o.next}while(o!==null);b===null?_=b=s:b=b.next=s}else _=b=s;o={baseState:u.baseState,firstBaseUpdate:_,lastBaseUpdate:b,shared:u.shared,callbacks:u.callbacks},a.updateQueue=o;return}a=o.lastBaseUpdate,a===null?o.firstBaseUpdate=s:a.next=s,o.lastBaseUpdate=s}var Xo=!1;function Zn(){if(Xo){var a=cn;if(a!==null)throw a}}function es(a,s,o,u){Xo=!1;var _=a.updateQueue;pa=!1;var b=_.firstBaseUpdate,U=_.lastBaseUpdate,Z=_.shared.pending;if(Z!==null){_.shared.pending=null;var de=Z,ye=de.next;de.next=null,U===null?b=ye:U.next=ye,U=de;var Ie=a.alternate;Ie!==null&&(Ie=Ie.updateQueue,Z=Ie.lastBaseUpdate,Z!==U&&(Z===null?Ie.firstBaseUpdate=ye:Z.next=ye,Ie.lastBaseUpdate=de))}if(b!==null){var je=_.baseState;U=0,Ie=ye=de=null,Z=b;do{var De=Z.lane&-536870913,Le=De!==Z.lane;if(Le?(xt&De)===De:(u&De)===De){De!==0&&De===ln&&(Xo=!0),Ie!==null&&(Ie=Ie.next={lane:0,tag:Z.tag,payload:Z.payload,callback:null,next:null});e:{var tt=a,ut=Z;De=s;var Nt=o;switch(ut.tag){case 1:if(tt=ut.payload,typeof tt=="function"){je=tt.call(Nt,je,De);break e}je=tt;break e;case 3:tt.flags=tt.flags&-65537|128;case 0:if(tt=ut.payload,De=typeof tt=="function"?tt.call(Nt,je,De):tt,De==null)break e;je=X({},je,De);break e;case 2:pa=!0}}De=Z.callback,De!==null&&(a.flags|=64,Le&&(a.flags|=8192),Le=_.callbacks,Le===null?_.callbacks=[De]:Le.push(De))}else Le={lane:De,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null},Ie===null?(ye=Ie=Le,de=je):Ie=Ie.next=Le,U|=De;if(Z=Z.next,Z===null){if(Z=_.shared.pending,Z===null)break;Le=Z,Z=Le.next,Le.next=null,_.lastBaseUpdate=Le,_.shared.pending=null}}while(!0);Ie===null&&(de=je),_.baseState=de,_.firstBaseUpdate=ye,_.lastBaseUpdate=Ie,b===null&&(_.shared.lanes=0),Ea|=U,a.lanes=U,a.memoizedState=je}}function sf(a,s){if(typeof a!="function")throw Error(n(191,a));a.call(s)}function of(a,s){var o=a.callbacks;if(o!==null)for(a.callbacks=null,a=0;a<o.length;a++)sf(o[a],s)}function ts(a,s){try{var o=s.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var _=u.next;o=_;do{if((o.tag&a)===a){u=void 0;var b=o.create,U=o.inst;u=b(),U.destroy=u}o=o.next}while(o!==_)}}catch(Z){Tt(s,s.return,Z)}}function ma(a,s,o){try{var u=s.updateQueue,_=u!==null?u.lastEffect:null;if(_!==null){var b=_.next;u=b;do{if((u.tag&a)===a){var U=u.inst,Z=U.destroy;if(Z!==void 0){U.destroy=void 0,_=s;var de=o;try{Z()}catch(ye){Tt(_,de,ye)}}}u=u.next}while(u!==b)}}catch(ye){Tt(s,s.return,ye)}}function lf(a){var s=a.updateQueue;if(s!==null){var o=a.stateNode;try{of(s,o)}catch(u){Tt(a,a.return,u)}}}function cf(a,s,o){o.props=ja(a.type,a.memoizedProps),o.state=a.memoizedState;try{o.componentWillUnmount()}catch(u){Tt(a,s,u)}}function Va(a,s){try{var o=a.ref;if(o!==null){var u=a.stateNode;switch(a.tag){case 26:case 27:case 5:var _=u;break;default:_=u}typeof o=="function"?a.refCleanup=o(_):o.current=_}}catch(b){Tt(a,s,b)}}function cr(a,s){var o=a.ref,u=a.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(_){Tt(a,s,_)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(_){Tt(a,s,_)}else o.current=null}function uf(a){var s=a.type,o=a.memoizedProps,u=a.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(_){Tt(a,a.return,_)}}function ff(a,s,o){try{var u=a.stateNode;yd(u,a.type,o,s),u[ae]=s}catch(_){Tt(a,a.return,_)}}function hf(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27||a.tag===4}function Go(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||hf(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==27&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function qo(a,s,o){var u=a.tag;if(u===5||u===6)a=a.stateNode,s?o.nodeType===8?o.parentNode.insertBefore(a,s):o.insertBefore(a,s):(o.nodeType===8?(s=o.parentNode,s.insertBefore(a,o)):(s=o,s.appendChild(a)),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=pi));else if(u!==4&&u!==27&&(a=a.child,a!==null))for(qo(a,s,o),a=a.sibling;a!==null;)qo(a,s,o),a=a.sibling}function ti(a,s,o){var u=a.tag;if(u===5||u===6)a=a.stateNode,s?o.insertBefore(a,s):o.appendChild(a);else if(u!==4&&u!==27&&(a=a.child,a!==null))for(ti(a,s,o),a=a.sibling;a!==null;)ti(a,s,o),a=a.sibling}var Kr=!1,Mt=!1,$o=!1,df=typeof WeakSet=="function"?WeakSet:Set,qt=null,pf=!1;function K0(a,s){if(a=a.containerInfo,El=Ei,a=Fc(a),Wi(a)){if("selectionStart"in a)var o={start:a.selectionStart,end:a.selectionEnd};else e:{o=(o=a.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var _=u.anchorOffset,b=u.focusNode;u=u.focusOffset;try{o.nodeType,b.nodeType}catch{o=null;break e}var U=0,Z=-1,de=-1,ye=0,Ie=0,je=a,De=null;t:for(;;){for(var Le;je!==o||_!==0&&je.nodeType!==3||(Z=U+_),je!==b||u!==0&&je.nodeType!==3||(de=U+u),je.nodeType===3&&(U+=je.nodeValue.length),(Le=je.firstChild)!==null;)De=je,je=Le;for(;;){if(je===a)break t;if(De===o&&++ye===_&&(Z=U),De===b&&++Ie===u&&(de=U),(Le=je.nextSibling)!==null)break;je=De,De=je.parentNode}je=Le}o=Z===-1||de===-1?null:{start:Z,end:de}}else o=null}o=o||{start:0,end:0}}else o=null;for(Sl={focusedElem:a,selectionRange:o},Ei=!1,qt=s;qt!==null;)if(s=qt,a=s.child,(s.subtreeFlags&1028)!==0&&a!==null)a.return=s,qt=a;else for(;qt!==null;){switch(s=qt,b=s.alternate,a=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if(a&1024&&b!==null){a=void 0,o=s,_=b.memoizedProps,b=b.memoizedState,u=o.stateNode;try{var tt=ja(o.type,_,o.elementType===o.type);a=u.getSnapshotBeforeUpdate(tt,b),u.__reactInternalSnapshotBeforeUpdate=a}catch(ut){Tt(o,o.return,ut)}}break;case 3:if(a&1024){if(a=s.stateNode.containerInfo,o=a.nodeType,o===9)wl(a);else if(o===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":wl(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(a&1024)throw Error(n(163))}if(a=s.sibling,a!==null){a.return=s.return,qt=a;break}qt=s.return}return tt=pf,pf=!1,tt}function gf(a,s,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:Qr(a,o),u&4&&ts(5,o);break;case 1:if(Qr(a,o),u&4)if(a=o.stateNode,s===null)try{a.componentDidMount()}catch(Z){Tt(o,o.return,Z)}else{var _=ja(o.type,s.memoizedProps);s=s.memoizedState;try{a.componentDidUpdate(_,s,a.__reactInternalSnapshotBeforeUpdate)}catch(Z){Tt(o,o.return,Z)}}u&64&&lf(o),u&512&&Va(o,o.return);break;case 3:if(Qr(a,o),u&64&&(u=o.updateQueue,u!==null)){if(a=null,o.child!==null)switch(o.child.tag){case 27:case 5:a=o.child.stateNode;break;case 1:a=o.child.stateNode}try{of(u,a)}catch(Z){Tt(o,o.return,Z)}}break;case 26:Qr(a,o),u&512&&Va(o,o.return);break;case 27:case 5:Qr(a,o),s===null&&u&4&&uf(o),u&512&&Va(o,o.return);break;case 12:Qr(a,o);break;case 13:Qr(a,o),u&4&&xf(a,o);break;case 22:if(_=o.memoizedState!==null||Kr,!_){s=s!==null&&s.memoizedState!==null||Mt;var b=Kr,U=Mt;Kr=_,(Mt=s)&&!U?xa(a,o,(o.subtreeFlags&8772)!==0):Qr(a,o),Kr=b,Mt=U}u&512&&(o.memoizedProps.mode==="manual"?Va(o,o.return):cr(o,o.return));break;default:Qr(a,o)}}function _f(a){var s=a.alternate;s!==null&&(a.alternate=null,_f(s)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(s=a.stateNode,s!==null&&Oe(s)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var Ht=null,ur=!1;function Jr(a,s,o){for(o=o.child;o!==null;)mf(a,s,o),o=o.sibling}function mf(a,s,o){if(lt&&typeof lt.onCommitFiberUnmount=="function")try{lt.onCommitFiberUnmount(nt,o)}catch{}switch(o.tag){case 26:Mt||cr(o,s),Jr(a,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Mt||cr(o,s);var u=Ht,_=ur;for(Ht=o.stateNode,Jr(a,s,o),o=o.stateNode,s=o.attributes;s.length;)o.removeAttributeNode(s[0]);Oe(o),Ht=u,ur=_;break;case 5:Mt||cr(o,s);case 6:_=Ht;var b=ur;if(Ht=null,Jr(a,s,o),Ht=_,ur=b,Ht!==null)if(ur)try{a=Ht,u=o.stateNode,a.nodeType===8?a.parentNode.removeChild(u):a.removeChild(u)}catch(U){Tt(o,s,U)}else try{Ht.removeChild(o.stateNode)}catch(U){Tt(o,s,U)}break;case 18:Ht!==null&&(ur?(s=Ht,o=o.stateNode,s.nodeType===8?Tl(s.parentNode,o):s.nodeType===1&&Tl(s,o),vs(s)):Tl(Ht,o.stateNode));break;case 4:u=Ht,_=ur,Ht=o.stateNode.containerInfo,ur=!0,Jr(a,s,o),Ht=u,ur=_;break;case 0:case 11:case 14:case 15:Mt||ma(2,o,s),Mt||ma(4,o,s),Jr(a,s,o);break;case 1:Mt||(cr(o,s),u=o.stateNode,typeof u.componentWillUnmount=="function"&&cf(o,s,u)),Jr(a,s,o);break;case 21:Jr(a,s,o);break;case 22:Mt||cr(o,s),Mt=(u=Mt)||o.memoizedState!==null,Jr(a,s,o),Mt=u;break;default:Jr(a,s,o)}}function xf(a,s){if(s.memoizedState===null&&(a=s.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{vs(a)}catch(o){Tt(s,s.return,o)}}function J0(a){switch(a.tag){case 13:case 19:var s=a.stateNode;return s===null&&(s=a.stateNode=new df),s;case 22:return a=a.stateNode,s=a._retryCache,s===null&&(s=a._retryCache=new df),s;default:throw Error(n(435,a.tag))}}function Wo(a,s){var o=J0(a);s.forEach(function(u){var _=ud.bind(null,a,u);o.has(u)||(o.add(u),u.then(_,_))})}function Ar(a,s){var o=s.deletions;if(o!==null)for(var u=0;u<o.length;u++){var _=o[u],b=a,U=s,Z=U;e:for(;Z!==null;){switch(Z.tag){case 27:case 5:Ht=Z.stateNode,ur=!1;break e;case 3:Ht=Z.stateNode.containerInfo,ur=!0;break e;case 4:Ht=Z.stateNode.containerInfo,ur=!0;break e}Z=Z.return}if(Ht===null)throw Error(n(160));mf(b,U,_),Ht=null,ur=!1,b=_.alternate,b!==null&&(b.return=null),_.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)vf(s,a),s=s.sibling}var Fr=null;function vf(a,s){var o=a.alternate,u=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Ar(s,a),br(a),u&4&&(ma(3,a,a.return),ts(3,a),ma(5,a,a.return));break;case 1:Ar(s,a),br(a),u&512&&(Mt||o===null||cr(o,o.return)),u&64&&Kr&&(a=a.updateQueue,a!==null&&(u=a.callbacks,u!==null&&(o=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var _=Fr;if(Ar(s,a),br(a),u&512&&(Mt||o===null||cr(o,o.return)),u&4){var b=o!==null?o.memoizedState:null;if(u=a.memoizedState,o===null)if(u===null)if(a.stateNode===null){e:{u=a.type,o=a.memoizedProps,_=_.ownerDocument||_;t:switch(u){case"title":b=_.getElementsByTagName("title")[0],(!b||b[Re]||b[ee]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=_.createElement(u),_.head.insertBefore(b,_.querySelector("head > title"))),Jt(b,u,o),b[ee]=a,Xe(b),u=b;break e;case"link":var U=uh("link","href",_).get(u+(o.href||""));if(U){for(var Z=0;Z<U.length;Z++)if(b=U[Z],b.getAttribute("href")===(o.href==null?null:o.href)&&b.getAttribute("rel")===(o.rel==null?null:o.rel)&&b.getAttribute("title")===(o.title==null?null:o.title)&&b.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){U.splice(Z,1);break t}}b=_.createElement(u),Jt(b,u,o),_.head.appendChild(b);break;case"meta":if(U=uh("meta","content",_).get(u+(o.content||""))){for(Z=0;Z<U.length;Z++)if(b=U[Z],b.getAttribute("content")===(o.content==null?null:""+o.content)&&b.getAttribute("name")===(o.name==null?null:o.name)&&b.getAttribute("property")===(o.property==null?null:o.property)&&b.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&b.getAttribute("charset")===(o.charSet==null?null:o.charSet)){U.splice(Z,1);break t}}b=_.createElement(u),Jt(b,u,o),_.head.appendChild(b);break;default:throw Error(n(468,u))}b[ee]=a,Xe(b),u=b}a.stateNode=u}else fh(_,a.type,a.stateNode);else a.stateNode=ch(_,u,a.memoizedProps);else b!==u?(b===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):b.count--,u===null?fh(_,a.type,a.stateNode):ch(_,u,a.memoizedProps)):u===null&&a.stateNode!==null&&ff(a,a.memoizedProps,o.memoizedProps)}break;case 27:if(u&4&&a.alternate===null){_=a.stateNode,b=a.memoizedProps;try{for(var de=_.firstChild;de;){var ye=de.nextSibling,Ie=de.nodeName;de[Re]||Ie==="HEAD"||Ie==="BODY"||Ie==="SCRIPT"||Ie==="STYLE"||Ie==="LINK"&&de.rel.toLowerCase()==="stylesheet"||_.removeChild(de),de=ye}for(var je=a.type,De=_.attributes;De.length;)_.removeAttributeNode(De[0]);Jt(_,je,b),_[ee]=a,_[ae]=b}catch(tt){Tt(a,a.return,tt)}}case 5:if(Ar(s,a),br(a),u&512&&(Mt||o===null||cr(o,o.return)),a.flags&32){_=a.stateNode;try{Ya(_,"")}catch(tt){Tt(a,a.return,tt)}}u&4&&a.stateNode!=null&&(_=a.memoizedProps,ff(a,_,o!==null?o.memoizedProps:_)),u&1024&&($o=!0);break;case 6:if(Ar(s,a),br(a),u&4){if(a.stateNode===null)throw Error(n(162));u=a.memoizedProps,o=a.stateNode;try{o.nodeValue=u}catch(tt){Tt(a,a.return,tt)}}break;case 3:if(xi=null,_=Fr,Fr=_i(s.containerInfo),Ar(s,a),Fr=_,br(a),u&4&&o!==null&&o.memoizedState.isDehydrated)try{vs(s.containerInfo)}catch(tt){Tt(a,a.return,tt)}$o&&($o=!1,yf(a));break;case 4:u=Fr,Fr=_i(a.stateNode.containerInfo),Ar(s,a),br(a),Fr=u;break;case 12:Ar(s,a),br(a);break;case 13:Ar(s,a),br(a),a.child.flags&8192&&a.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(al=we()),u&4&&(u=a.updateQueue,u!==null&&(a.updateQueue=null,Wo(a,u)));break;case 22:if(u&512&&(Mt||o===null||cr(o,o.return)),de=a.memoizedState!==null,ye=o!==null&&o.memoizedState!==null,Ie=Kr,je=Mt,Kr=Ie||de,Mt=je||ye,Ar(s,a),Mt=je,Kr=Ie,br(a),s=a.stateNode,s._current=a,s._visibility&=-3,s._visibility|=s._pendingVisibility&2,u&8192&&(s._visibility=de?s._visibility&-2:s._visibility|1,de&&(s=Kr||Mt,o===null||ye||s||dn(a)),a.memoizedProps===null||a.memoizedProps.mode!=="manual"))e:for(o=null,s=a;;){if(s.tag===5||s.tag===26||s.tag===27){if(o===null){ye=o=s;try{if(_=ye.stateNode,de)b=_.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{U=ye.stateNode,Z=ye.memoizedProps.style;var Le=Z!=null&&Z.hasOwnProperty("display")?Z.display:null;U.style.display=Le==null||typeof Le=="boolean"?"":(""+Le).trim()}}catch(tt){Tt(ye,ye.return,tt)}}}else if(s.tag===6){if(o===null){ye=s;try{ye.stateNode.nodeValue=de?"":ye.memoizedProps}catch(tt){Tt(ye,ye.return,tt)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===a)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}u&4&&(u=a.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,Wo(a,o))));break;case 19:Ar(s,a),br(a),u&4&&(u=a.updateQueue,u!==null&&(a.updateQueue=null,Wo(a,u)));break;case 21:break;default:Ar(s,a),br(a)}}function br(a){var s=a.flags;if(s&2){try{if(a.tag!==27){e:{for(var o=a.return;o!==null;){if(hf(o)){var u=o;break e}o=o.return}throw Error(n(160))}switch(u.tag){case 27:var _=u.stateNode,b=Go(a);ti(a,b,_);break;case 5:var U=u.stateNode;u.flags&32&&(Ya(U,""),u.flags&=-33);var Z=Go(a);ti(a,Z,U);break;case 3:case 4:var de=u.stateNode.containerInfo,ye=Go(a);qo(a,ye,de);break;default:throw Error(n(161))}}}catch(Ie){Tt(a,a.return,Ie)}a.flags&=-3}s&4096&&(a.flags&=-4097)}function yf(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var s=a;yf(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),a=a.sibling}}function Qr(a,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)gf(a,s.alternate,s),s=s.sibling}function dn(a){for(a=a.child;a!==null;){var s=a;switch(s.tag){case 0:case 11:case 14:case 15:ma(4,s,s.return),dn(s);break;case 1:cr(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&cf(s,s.return,o),dn(s);break;case 26:case 27:case 5:cr(s,s.return),dn(s);break;case 22:cr(s,s.return),s.memoizedState===null&&dn(s);break;default:dn(s)}a=a.sibling}}function xa(a,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var u=s.alternate,_=a,b=s,U=b.flags;switch(b.tag){case 0:case 11:case 15:xa(_,b,o),ts(4,b);break;case 1:if(xa(_,b,o),u=b,_=u.stateNode,typeof _.componentDidMount=="function")try{_.componentDidMount()}catch(ye){Tt(u,u.return,ye)}if(u=b,_=u.updateQueue,_!==null){var Z=u.stateNode;try{var de=_.shared.hiddenCallbacks;if(de!==null)for(_.shared.hiddenCallbacks=null,_=0;_<de.length;_++)sf(de[_],Z)}catch(ye){Tt(u,u.return,ye)}}o&&U&64&&lf(b),Va(b,b.return);break;case 26:case 27:case 5:xa(_,b,o),o&&u===null&&U&4&&uf(b),Va(b,b.return);break;case 12:xa(_,b,o);break;case 13:xa(_,b,o),o&&U&4&&xf(_,b);break;case 22:b.memoizedState===null&&xa(_,b,o),Va(b,b.return);break;default:xa(_,b,o)}s=s.sibling}}function Yo(a,s){var o=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(o=a.memoizedState.cachePool.pool),a=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),a!==o&&(a!=null&&a.refCount++,o!=null&&Gn(o))}function Ko(a,s){a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&Gn(a))}function va(a,s,o,u){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Ef(a,s,o,u),s=s.sibling}function Ef(a,s,o,u){var _=s.flags;switch(s.tag){case 0:case 11:case 15:va(a,s,o,u),_&2048&&ts(9,s);break;case 3:va(a,s,o,u),_&2048&&(a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&Gn(a)));break;case 12:if(_&2048){va(a,s,o,u),a=s.stateNode;try{var b=s.memoizedProps,U=b.id,Z=b.onPostCommit;typeof Z=="function"&&Z(U,s.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(de){Tt(s,s.return,de)}}else va(a,s,o,u);break;case 23:break;case 22:b=s.stateNode,s.memoizedState!==null?b._visibility&4?va(a,s,o,u):rs(a,s):b._visibility&4?va(a,s,o,u):(b._visibility|=4,pn(a,s,o,u,(s.subtreeFlags&10256)!==0)),_&2048&&Yo(s.alternate,s);break;case 24:va(a,s,o,u),_&2048&&Ko(s.alternate,s);break;default:va(a,s,o,u)}}function pn(a,s,o,u,_){for(_=_&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var b=a,U=s,Z=o,de=u,ye=U.flags;switch(U.tag){case 0:case 11:case 15:pn(b,U,Z,de,_),ts(8,U);break;case 23:break;case 22:var Ie=U.stateNode;U.memoizedState!==null?Ie._visibility&4?pn(b,U,Z,de,_):rs(b,U):(Ie._visibility|=4,pn(b,U,Z,de,_)),_&&ye&2048&&Yo(U.alternate,U);break;case 24:pn(b,U,Z,de,_),_&&ye&2048&&Ko(U.alternate,U);break;default:pn(b,U,Z,de,_)}s=s.sibling}}function rs(a,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=a,u=s,_=u.flags;switch(u.tag){case 22:rs(o,u),_&2048&&Yo(u.alternate,u);break;case 24:rs(o,u),_&2048&&Ko(u.alternate,u);break;default:rs(o,u)}s=s.sibling}}var as=8192;function gn(a){if(a.subtreeFlags&as)for(a=a.child;a!==null;)Sf(a),a=a.sibling}function Sf(a){switch(a.tag){case 26:gn(a),a.flags&as&&a.memoizedState!==null&&Ud(Fr,a.memoizedState,a.memoizedProps);break;case 5:gn(a);break;case 3:case 4:var s=Fr;Fr=_i(a.stateNode.containerInfo),gn(a),Fr=s;break;case 22:a.memoizedState===null&&(s=a.alternate,s!==null&&s.memoizedState!==null?(s=as,as=16777216,gn(a),as=s):gn(a));break;default:gn(a)}}function Af(a){var s=a.alternate;if(s!==null&&(a=s.child,a!==null)){s.child=null;do s=a.sibling,a.sibling=null,a=s;while(a!==null)}}function ns(a){var s=a.deletions;if(a.flags&16){if(s!==null)for(var o=0;o<s.length;o++){var u=s[o];qt=u,Tf(u,a)}Af(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)bf(a),a=a.sibling}function bf(a){switch(a.tag){case 0:case 11:case 15:ns(a),a.flags&2048&&ma(9,a,a.return);break;case 3:ns(a);break;case 12:ns(a);break;case 22:var s=a.stateNode;a.memoizedState!==null&&s._visibility&4&&(a.return===null||a.return.tag!==13)?(s._visibility&=-5,ri(a)):ns(a);break;default:ns(a)}}function ri(a){var s=a.deletions;if(a.flags&16){if(s!==null)for(var o=0;o<s.length;o++){var u=s[o];qt=u,Tf(u,a)}Af(a)}for(a=a.child;a!==null;){switch(s=a,s.tag){case 0:case 11:case 15:ma(8,s,s.return),ri(s);break;case 22:o=s.stateNode,o._visibility&4&&(o._visibility&=-5,ri(s));break;default:ri(s)}a=a.sibling}}function Tf(a,s){for(;qt!==null;){var o=qt;switch(o.tag){case 0:case 11:case 15:ma(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Gn(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,qt=u;else e:for(o=a;qt!==null;){u=qt;var _=u.sibling,b=u.return;if(_f(u),u===o){qt=null;break e}if(_!==null){_.return=b,qt=_;break e}qt=b}}}function Q0(a,s,o,u){this.tag=a,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tr(a,s,o,u){return new Q0(a,s,o,u)}function Jo(a){return a=a.prototype,!(!a||!a.isReactComponent)}function ya(a,s){var o=a.alternate;return o===null?(o=Tr(a.tag,s,a.key,a.mode),o.elementType=a.elementType,o.type=a.type,o.stateNode=a.stateNode,o.alternate=a,a.alternate=o):(o.pendingProps=s,o.type=a.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=a.flags&31457280,o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,s=a.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=a.sibling,o.index=a.index,o.ref=a.ref,o.refCleanup=a.refCleanup,o}function wf(a,s){a.flags&=31457282;var o=a.alternate;return o===null?(a.childLanes=0,a.lanes=s,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,s=o.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),a}function ai(a,s,o,u,_,b){var U=0;if(u=a,typeof a=="function")Jo(a)&&(U=1);else if(typeof a=="string")U=Id(a,o,V.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case d:return Xa(o.children,_,b,s);case h:U=8,_|=24;break;case p:return a=Tr(12,o,s,_|2),a.elementType=p,a.lanes=b,a;case g:return a=Tr(13,o,s,_),a.elementType=g,a.lanes=b,a;case m:return a=Tr(19,o,s,_),a.elementType=m,a.lanes=b,a;case C:return Cf(o,_,b,s);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case E:case S:U=10;break e;case y:U=9;break e;case x:U=11;break e;case A:U=14;break e;case O:U=16,u=null;break e}U=29,o=Error(n(130,a===null?"null":typeof a,"")),u=null}return s=Tr(U,o,s,_),s.elementType=a,s.type=u,s.lanes=b,s}function Xa(a,s,o,u){return a=Tr(7,a,u,s),a.lanes=o,a}function Cf(a,s,o,u){a=Tr(22,a,u,s),a.elementType=C,a.lanes=o;var _={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var b=_._current;if(b===null)throw Error(n(456));if(!(_._pendingVisibility&2)){var U=la(b,2);U!==null&&(_._pendingVisibility|=2,ar(U,b,2))}},attach:function(){var b=_._current;if(b===null)throw Error(n(456));if(_._pendingVisibility&2){var U=la(b,2);U!==null&&(_._pendingVisibility&=-3,ar(U,b,2))}}};return a.stateNode=_,a}function Qo(a,s,o){return a=Tr(6,a,null,s),a.lanes=o,a}function Zo(a,s,o){return s=Tr(4,a.children!==null?a.children:[],a.key,s),s.lanes=o,s.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},s}function Zr(a){a.flags|=4}function kf(a,s){if(s.type!=="stylesheet"||s.state.loading&4)a.flags&=-16777217;else if(a.flags|=16777216,!hh(s)){if(s=Sr.current,s!==null&&((xt&4194176)===xt?Lr!==null:(xt&62914560)!==xt&&!(xt&536870912)||s!==Lr))throw zn=ao,Xc;a.flags|=8192}}function ni(a,s){s!==null&&(a.flags|=4),a.flags&16384&&(s=a.tag!==22?zt():536870912,a.lanes|=s,mn|=s)}function ss(a,s){if(!yt)switch(a.tailMode){case"hidden":s=a.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?a.tail=null:o.sibling=null;break;case"collapsed":o=a.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s||a.tail===null?a.tail=null:a.tail.sibling=null:u.sibling=null}}function Ot(a){var s=a.alternate!==null&&a.alternate.child===a.child,o=0,u=0;if(s)for(var _=a.child;_!==null;)o|=_.lanes|_.childLanes,u|=_.subtreeFlags&31457280,u|=_.flags&31457280,_.return=a,_=_.sibling;else for(_=a.child;_!==null;)o|=_.lanes|_.childLanes,u|=_.subtreeFlags,u|=_.flags,_.return=a,_=_.sibling;return a.subtreeFlags|=u,a.childLanes=o,s}function Z0(a,s,o){var u=s.pendingProps;switch(to(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(s),null;case 1:return Ot(s),null;case 3:return o=s.stateNode,u=null,a!==null&&(u=a.memoizedState.cache),s.memoizedState.cache!==u&&(s.flags|=2048),Yr(Xt),j(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(a===null||a.child===null)&&(Bn(s)?Zr(s):a===null||a.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,Rr!==null&&(ol(Rr),Rr=null))),Ot(s),null;case 26:return o=s.memoizedState,a===null?(Zr(s),o!==null?(Ot(s),kf(s,o)):(Ot(s),s.flags&=-16777217)):o?o!==a.memoizedState?(Zr(s),Ot(s),kf(s,o)):(Ot(s),s.flags&=-16777217):(a.memoizedProps!==u&&Zr(s),Ot(s),s.flags&=-16777217),null;case 27:Ae(s),o=Y.current;var _=s.type;if(a!==null&&s.stateNode!=null)a.memoizedProps!==u&&Zr(s);else{if(!u){if(s.stateNode===null)throw Error(n(166));return Ot(s),null}a=V.current,Bn(s)?zc(s):(a=nh(_,u,o),s.stateNode=a,Zr(s))}return Ot(s),null;case 5:if(Ae(s),o=s.type,a!==null&&s.stateNode!=null)a.memoizedProps!==u&&Zr(s);else{if(!u){if(s.stateNode===null)throw Error(n(166));return Ot(s),null}if(a=V.current,Bn(s))zc(s);else{switch(_=gi(Y.current),a){case 1:a=_.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:a=_.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":a=_.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":a=_.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":a=_.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof u.is=="string"?_.createElement("select",{is:u.is}):_.createElement("select"),u.multiple?a.multiple=!0:u.size&&(a.size=u.size);break;default:a=typeof u.is=="string"?_.createElement(o,{is:u.is}):_.createElement(o)}}a[ee]=s,a[ae]=u;e:for(_=s.child;_!==null;){if(_.tag===5||_.tag===6)a.appendChild(_.stateNode);else if(_.tag!==4&&_.tag!==27&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===s)break e;for(;_.sibling===null;){if(_.return===null||_.return===s)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}s.stateNode=a;e:switch(Jt(a,o,u),o){case"button":case"input":case"select":case"textarea":a=!!u.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&Zr(s)}}return Ot(s),s.flags&=-16777217,null;case 6:if(a&&s.stateNode!=null)a.memoizedProps!==u&&Zr(s);else{if(typeof u!="string"&&s.stateNode===null)throw Error(n(166));if(a=Y.current,Bn(s)){if(a=s.stateNode,o=s.memoizedProps,u=null,_=rr,_!==null)switch(_.tag){case 27:case 5:u=_.memoizedProps}a[ee]=s,a=!!(a.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||Qf(a.nodeValue,o)),a||Ma(s)}else a=gi(a).createTextNode(u),a[ee]=s,s.stateNode=a}return Ot(s),null;case 13:if(u=s.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(_=Bn(s),u!==null&&u.dehydrated!==null){if(a===null){if(!_)throw Error(n(318));if(_=s.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(n(317));_[ee]=s}else Un(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;Ot(s),_=!1}else Rr!==null&&(ol(Rr),Rr=null),_=!0;if(!_)return s.flags&256?(Gr(s),s):(Gr(s),null)}if(Gr(s),s.flags&128)return s.lanes=o,s;if(o=u!==null,a=a!==null&&a.memoizedState!==null,o){u=s.child,_=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(_=u.alternate.memoizedState.cachePool.pool);var b=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(b=u.memoizedState.cachePool.pool),b!==_&&(u.flags|=2048)}return o!==a&&o&&(s.child.flags|=8192),ni(s,s.updateQueue),Ot(s),null;case 4:return j(),a===null&&xl(s.stateNode.containerInfo),Ot(s),null;case 10:return Yr(s.type),Ot(s),null;case 19:if(F(Vt),_=s.memoizedState,_===null)return Ot(s),null;if(u=(s.flags&128)!==0,b=_.rendering,b===null)if(u)ss(_,!1);else{if(Lt!==0||a!==null&&a.flags&128)for(a=s.child;a!==null;){if(b=Hs(a),b!==null){for(s.flags|=128,ss(_,!1),a=b.updateQueue,s.updateQueue=a,ni(s,a),s.subtreeFlags=0,a=o,o=s.child;o!==null;)wf(o,a),o=o.sibling;return I(Vt,Vt.current&1|2),s.child}a=a.sibling}_.tail!==null&&we()>si&&(s.flags|=128,u=!0,ss(_,!1),s.lanes=4194304)}else{if(!u)if(a=Hs(b),a!==null){if(s.flags|=128,u=!0,a=a.updateQueue,s.updateQueue=a,ni(s,a),ss(_,!0),_.tail===null&&_.tailMode==="hidden"&&!b.alternate&&!yt)return Ot(s),null}else 2*we()-_.renderingStartTime>si&&o!==536870912&&(s.flags|=128,u=!0,ss(_,!1),s.lanes=4194304);_.isBackwards?(b.sibling=s.child,s.child=b):(a=_.last,a!==null?a.sibling=b:s.child=b,_.last=b)}return _.tail!==null?(s=_.tail,_.rendering=s,_.tail=s.sibling,_.renderingStartTime=we(),s.sibling=null,a=Vt.current,I(Vt,u?a&1|2:a&1),s):(Ot(s),null);case 22:case 23:return Gr(s),so(),u=s.memoizedState!==null,a!==null?a.memoizedState!==null!==u&&(s.flags|=8192):u&&(s.flags|=8192),u?o&536870912&&!(s.flags&128)&&(Ot(s),s.subtreeFlags&6&&(s.flags|=8192)):Ot(s),o=s.updateQueue,o!==null&&ni(s,o.retryQueue),o=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(o=a.memoizedState.cachePool.pool),u=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),u!==o&&(s.flags|=2048),a!==null&&F(Na),null;case 24:return o=null,a!==null&&(o=a.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),Yr(Xt),Ot(s),null;case 25:return null}throw Error(n(156,s.tag))}function ed(a,s){switch(to(s),s.tag){case 1:return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 3:return Yr(Xt),j(),a=s.flags,a&65536&&!(a&128)?(s.flags=a&-65537|128,s):null;case 26:case 27:case 5:return Ae(s),null;case 13:if(Gr(s),a=s.memoizedState,a!==null&&a.dehydrated!==null){if(s.alternate===null)throw Error(n(340));Un()}return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 19:return F(Vt),null;case 4:return j(),null;case 10:return Yr(s.type),null;case 22:case 23:return Gr(s),so(),a!==null&&F(Na),a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 24:return Yr(Xt),null;case 25:return null;default:return null}}function Rf(a,s){switch(to(s),s.tag){case 3:Yr(Xt),j();break;case 26:case 27:case 5:Ae(s);break;case 4:j();break;case 13:Gr(s);break;case 19:F(Vt);break;case 10:Yr(s.type);break;case 22:case 23:Gr(s),so(),a!==null&&F(Na);break;case 24:Yr(Xt)}}var td={getCacheForType:function(a){var s=er(Xt),o=s.data.get(a);return o===void 0&&(o=a(),s.data.set(a,o)),o}},rd=typeof WeakMap=="function"?WeakMap:Map,Dt=0,Ct=null,_t=null,xt=0,kt=0,fr=null,ea=!1,_n=!1,el=!1,ta=0,Lt=0,Ea=0,Ga=0,tl=0,wr=0,mn=0,is=null,Ir=null,rl=!1,al=0,si=1/0,ii=null,Sa=null,oi=!1,qa=null,os=0,nl=0,sl=null,ls=0,il=null;function hr(){if(Dt&2&&xt!==0)return xt&-xt;if(M.T!==null){var a=ln;return a!==0?a:pl()}return sa()}function Ff(){wr===0&&(wr=!(xt&536870912)||yt?pr():536870912);var a=Sr.current;return a!==null&&(a.flags|=32),wr}function ar(a,s,o){(a===Ct&&kt===2||a.cancelPendingCommit!==null)&&(xn(a,0),ra(a,xt,wr,!1)),Zt(a,o),(!(Dt&2)||a!==Ct)&&(a===Ct&&(!(Dt&2)&&(Ga|=o),Lt===4&&ra(a,xt,wr,!1)),Br(a))}function Of(a,s,o){if(Dt&6)throw Error(n(327));var u=!o&&(s&60)===0&&(s&a.expiredLanes)===0||Qt(a,s),_=u?sd(a,s):ul(a,s,!0),b=u;do{if(_===0){_n&&!u&&ra(a,s,0,!1);break}else if(_===6)ra(a,s,0,!ea);else{if(o=a.current.alternate,b&&!ad(o)){_=ul(a,s,!1),b=!1;continue}if(_===2){if(b=s,a.errorRecoveryDisabledLanes&b)var U=0;else U=a.pendingLanes&-536870913,U=U!==0?U:U&536870912?536870912:0;if(U!==0){s=U;e:{var Z=a;_=is;var de=Z.current.memoizedState.isDehydrated;if(de&&(xn(Z,U).flags|=256),U=ul(Z,U,!1),U!==2){if(el&&!de){Z.errorRecoveryDisabledLanes|=b,Ga|=b,_=4;break e}b=Ir,Ir=_,b!==null&&ol(b)}_=U}if(b=!1,_!==2)continue}}if(_===1){xn(a,0),ra(a,s,0,!0);break}e:{switch(u=a,_){case 0:case 1:throw Error(n(345));case 4:if((s&4194176)===s){ra(u,s,wr,!ea);break e}break;case 2:Ir=null;break;case 3:case 5:break;default:throw Error(n(329))}if(u.finishedWork=o,u.finishedLanes=s,(s&62914560)===s&&(b=al+300-we(),10<b)){if(ra(u,s,wr,!ea),vt(u,0)!==0)break e;u.timeoutHandle=th(Df.bind(null,u,o,Ir,ii,rl,s,wr,Ga,mn,ea,2,-0,0),b);break e}Df(u,o,Ir,ii,rl,s,wr,Ga,mn,ea,0,-0,0)}}break}while(!0);Br(a)}function ol(a){Ir===null?Ir=a:Ir.push.apply(Ir,a)}function Df(a,s,o,u,_,b,U,Z,de,ye,Ie,je,De){var Le=s.subtreeFlags;if((Le&8192||(Le&16785408)===16785408)&&(ps={stylesheets:null,count:0,unsuspend:Bd},Sf(s),s=jd(),s!==null)){a.cancelPendingCommit=s(Uf.bind(null,a,o,u,_,U,Z,de,1,je,De)),ra(a,b,U,!ye);return}Uf(a,o,u,_,U,Z,de,Ie,je,De)}function ad(a){for(var s=a;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var _=o[u],b=_.getSnapshot;_=_.value;try{if(!lr(b(),_))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function ra(a,s,o,u){s&=~tl,s&=~Ga,a.suspendedLanes|=s,a.pingedLanes&=~s,u&&(a.warmLanes|=s),u=a.expirationTimes;for(var _=s;0<_;){var b=31-Pt(_),U=1<<b;u[b]=-1,_&=~U}o!==0&&Rt(a,o,s)}function li(){return Dt&6?!0:(cs(0),!1)}function ll(){if(_t!==null){if(kt===0)var a=_t.return;else a=_t,Wr=Ha=null,po(a),sn=null,Vn=0,a=_t;for(;a!==null;)Rf(a.alternate,a),a=a.return;_t=null}}function xn(a,s){a.finishedWork=null,a.finishedLanes=0;var o=a.timeoutHandle;o!==-1&&(a.timeoutHandle=-1,Sd(o)),o=a.cancelPendingCommit,o!==null&&(a.cancelPendingCommit=null,o()),ll(),Ct=a,_t=o=ya(a.current,null),xt=s,kt=0,fr=null,ea=!1,_n=Qt(a,s),el=!1,mn=wr=tl=Ga=Ea=Lt=0,Ir=is=null,rl=!1,s&8&&(s|=s&32);var u=a.entangledLanes;if(u!==0)for(a=a.entanglements,u&=s;0<u;){var _=31-Pt(u),b=1<<_;s|=a[_],u&=~b}return ta=s,Ds(),o}function Pf(a,s){ht=null,M.H=Nr,s===Hn?(s=$c(),kt=3):s===Xc?(s=$c(),kt=4):kt=s===Gu?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,fr=s,_t===null&&(Lt=1,Qs(a,vr(s,a.current)))}function Mf(){var a=M.H;return M.H=Nr,a===null?Nr:a}function Lf(){var a=M.A;return M.A=td,a}function cl(){Lt=4,ea||(xt&4194176)!==xt&&Sr.current!==null||(_n=!0),!(Ea&134217727)&&!(Ga&134217727)||Ct===null||ra(Ct,xt,wr,!1)}function ul(a,s,o){var u=Dt;Dt|=2;var _=Mf(),b=Lf();(Ct!==a||xt!==s)&&(ii=null,xn(a,s)),s=!1;var U=Lt;e:do try{if(kt!==0&&_t!==null){var Z=_t,de=fr;switch(kt){case 8:ll(),U=6;break e;case 3:case 2:case 6:Sr.current===null&&(s=!0);var ye=kt;if(kt=0,fr=null,vn(a,Z,de,ye),o&&_n){U=0;break e}break;default:ye=kt,kt=0,fr=null,vn(a,Z,de,ye)}}nd(),U=Lt;break}catch(Ie){Pf(a,Ie)}while(!0);return s&&a.shellSuspendCounter++,Wr=Ha=null,Dt=u,M.H=_,M.A=b,_t===null&&(Ct=null,xt=0,Ds()),U}function nd(){for(;_t!==null;)Nf(_t)}function sd(a,s){var o=Dt;Dt|=2;var u=Mf(),_=Lf();Ct!==a||xt!==s?(ii=null,si=we()+500,xn(a,s)):_n=Qt(a,s);e:do try{if(kt!==0&&_t!==null){s=_t;var b=fr;t:switch(kt){case 1:kt=0,fr=null,vn(a,s,b,1);break;case 2:if(Gc(b)){kt=0,fr=null,If(s);break}s=function(){kt===2&&Ct===a&&(kt=7),Br(a)},b.then(s,s);break e;case 3:kt=7;break e;case 4:kt=5;break e;case 7:Gc(b)?(kt=0,fr=null,If(s)):(kt=0,fr=null,vn(a,s,b,7));break;case 5:var U=null;switch(_t.tag){case 26:U=_t.memoizedState;case 5:case 27:var Z=_t;if(!U||hh(U)){kt=0,fr=null;var de=Z.sibling;if(de!==null)_t=de;else{var ye=Z.return;ye!==null?(_t=ye,ci(ye)):_t=null}break t}}kt=0,fr=null,vn(a,s,b,5);break;case 6:kt=0,fr=null,vn(a,s,b,6);break;case 8:ll(),Lt=6;break e;default:throw Error(n(462))}}id();break}catch(Ie){Pf(a,Ie)}while(!0);return Wr=Ha=null,M.H=u,M.A=_,Dt=o,_t!==null?0:(Ct=null,xt=0,Ds(),Lt)}function id(){for(;_t!==null&&!Me();)Nf(_t)}function Nf(a){var s=af(a.alternate,a,ta);a.memoizedProps=a.pendingProps,s===null?ci(a):_t=s}function If(a){var s=a,o=s.alternate;switch(s.tag){case 15:case 0:s=Ju(o,s,s.pendingProps,s.type,void 0,xt);break;case 11:s=Ju(o,s,s.pendingProps,s.type.render,s.ref,xt);break;case 5:po(s);default:Rf(o,s),s=_t=wf(s,ta),s=af(o,s,ta)}a.memoizedProps=a.pendingProps,s===null?ci(a):_t=s}function vn(a,s,o,u){Wr=Ha=null,po(s),sn=null,Vn=0;var _=s.return;try{if(W0(a,_,s,o,xt)){Lt=1,Qs(a,vr(o,a.current)),_t=null;return}}catch(b){if(_!==null)throw _t=_,b;Lt=1,Qs(a,vr(o,a.current)),_t=null;return}s.flags&32768?(yt||u===1?a=!0:_n||xt&536870912?a=!1:(ea=a=!0,(u===2||u===3||u===6)&&(u=Sr.current,u!==null&&u.tag===13&&(u.flags|=16384))),Bf(s,a)):ci(s)}function ci(a){var s=a;do{if(s.flags&32768){Bf(s,ea);return}a=s.return;var o=Z0(s.alternate,s,ta);if(o!==null){_t=o;return}if(s=s.sibling,s!==null){_t=s;return}_t=s=a}while(s!==null);Lt===0&&(Lt=5)}function Bf(a,s){do{var o=ed(a.alternate,a);if(o!==null){o.flags&=32767,_t=o;return}if(o=a.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(a=a.sibling,a!==null)){_t=a;return}_t=a=o}while(a!==null);Lt=6,_t=null}function Uf(a,s,o,u,_,b,U,Z,de,ye){var Ie=M.T,je=k.p;try{k.p=2,M.T=null,od(a,s,o,u,je,_,b,U,Z,de,ye)}finally{M.T=Ie,k.p=je}}function od(a,s,o,u,_,b,U,Z){do yn();while(qa!==null);if(Dt&6)throw Error(n(327));var de=a.finishedWork;if(u=a.finishedLanes,de===null)return null;if(a.finishedWork=null,a.finishedLanes=0,de===a.current)throw Error(n(177));a.callbackNode=null,a.callbackPriority=0,a.cancelPendingCommit=null;var ye=de.lanes|de.childLanes;if(ye|=Qi,na(a,u,ye,b,U,Z),a===Ct&&(_t=Ct=null,xt=0),!(de.subtreeFlags&10256)&&!(de.flags&10256)||oi||(oi=!0,nl=ye,sl=o,fd(Ze,function(){return yn(),null})),o=(de.flags&15990)!==0,de.subtreeFlags&15990||o?(o=M.T,M.T=null,b=k.p,k.p=2,U=Dt,Dt|=4,K0(a,de),vf(de,a),O0(Sl,a.containerInfo),Ei=!!El,Sl=El=null,a.current=de,gf(a,de.alternate,de),ze(),Dt=U,k.p=b,M.T=o):a.current=de,oi?(oi=!1,qa=a,os=u):jf(a,ye),ye=a.pendingLanes,ye===0&&(Sa=null),or(de.stateNode),Br(a),s!==null)for(_=a.onRecoverableError,de=0;de<s.length;de++)ye=s[de],_(ye.value,{componentStack:ye.stack});return os&3&&yn(),ye=a.pendingLanes,u&4194218&&ye&42?a===il?ls++:(ls=0,il=a):ls=0,cs(0),null}function jf(a,s){(a.pooledCacheLanes&=s)===0&&(s=a.pooledCache,s!=null&&(a.pooledCache=null,Gn(s)))}function yn(){if(qa!==null){var a=qa,s=nl;nl=0;var o=Hr(os),u=M.T,_=k.p;try{if(k.p=32>o?32:o,M.T=null,qa===null)var b=!1;else{o=sl,sl=null;var U=qa,Z=os;if(qa=null,os=0,Dt&6)throw Error(n(331));var de=Dt;if(Dt|=4,bf(U.current),Ef(U,U.current,Z,o),Dt=de,cs(0,!1),lt&&typeof lt.onPostCommitFiberRoot=="function")try{lt.onPostCommitFiberRoot(nt,U)}catch{}b=!0}return b}finally{k.p=_,M.T=u,jf(a,s)}}return!1}function Hf(a,s,o){s=vr(o,s),s=ko(a.stateNode,s,2),a=_a(a,s,2),a!==null&&(Zt(a,2),Br(a))}function Tt(a,s,o){if(a.tag===3)Hf(a,a,o);else for(;s!==null;){if(s.tag===3){Hf(s,a,o);break}else if(s.tag===1){var u=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Sa===null||!Sa.has(u))){a=vr(o,a),o=Vu(2),u=_a(s,o,2),u!==null&&(Xu(o,u,s,a),Zt(u,2),Br(u));break}}s=s.return}}function fl(a,s,o){var u=a.pingCache;if(u===null){u=a.pingCache=new rd;var _=new Set;u.set(s,_)}else _=u.get(s),_===void 0&&(_=new Set,u.set(s,_));_.has(o)||(el=!0,_.add(o),a=ld.bind(null,a,s,o),s.then(a,a))}function ld(a,s,o){var u=a.pingCache;u!==null&&u.delete(s),a.pingedLanes|=a.suspendedLanes&o,a.warmLanes&=~o,Ct===a&&(xt&o)===o&&(Lt===4||Lt===3&&(xt&62914560)===xt&&300>we()-al?!(Dt&2)&&xn(a,0):tl|=o,mn===xt&&(mn=0)),Br(a)}function zf(a,s){s===0&&(s=zt()),a=la(a,s),a!==null&&(Zt(a,s),Br(a))}function cd(a){var s=a.memoizedState,o=0;s!==null&&(o=s.retryLane),zf(a,o)}function ud(a,s){var o=0;switch(a.tag){case 13:var u=a.stateNode,_=a.memoizedState;_!==null&&(o=_.retryLane);break;case 19:u=a.stateNode;break;case 22:u=a.stateNode._retryCache;break;default:throw Error(n(314))}u!==null&&u.delete(s),zf(a,o)}function fd(a,s){return ve(a,s)}var ui=null,En=null,hl=!1,fi=!1,dl=!1,$a=0;function Br(a){a!==En&&a.next===null&&(En===null?ui=En=a:En=En.next=a),fi=!0,hl||(hl=!0,dd(hd))}function cs(a,s){if(!dl&&fi){dl=!0;do for(var o=!1,u=ui;u!==null;){if(a!==0){var _=u.pendingLanes;if(_===0)var b=0;else{var U=u.suspendedLanes,Z=u.pingedLanes;b=(1<<31-Pt(42|a)+1)-1,b&=_&~(U&~Z),b=b&201326677?b&201326677|1:b?b|2:0}b!==0&&(o=!0,Gf(u,b))}else b=xt,b=vt(u,u===Ct?b:0),!(b&3)||Qt(u,b)||(o=!0,Gf(u,b));u=u.next}while(o);dl=!1}}function hd(){fi=hl=!1;var a=0;$a!==0&&(Ed()&&(a=$a),$a=0);for(var s=we(),o=null,u=ui;u!==null;){var _=u.next,b=Vf(u,s);b===0?(u.next=null,o===null?ui=_:o.next=_,_===null&&(En=o)):(o=u,(a!==0||b&3)&&(fi=!0)),u=_}cs(a)}function Vf(a,s){for(var o=a.suspendedLanes,u=a.pingedLanes,_=a.expirationTimes,b=a.pendingLanes&-62914561;0<b;){var U=31-Pt(b),Z=1<<U,de=_[U];de===-1?(!(Z&o)||Z&u)&&(_[U]=Dr(Z,s)):de<=s&&(a.expiredLanes|=Z),b&=~Z}if(s=Ct,o=xt,o=vt(a,a===s?o:0),u=a.callbackNode,o===0||a===s&&kt===2||a.cancelPendingCommit!==null)return u!==null&&u!==null&&Te(u),a.callbackNode=null,a.callbackPriority=0;if(!(o&3)||Qt(a,o)){if(s=o&-o,s===a.callbackPriority)return s;switch(u!==null&&Te(u),Hr(o)){case 2:case 8:o=Ke;break;case 32:o=Ze;break;case 268435456:o=Je;break;default:o=Ze}return u=Xf.bind(null,a),o=ve(o,u),a.callbackPriority=s,a.callbackNode=o,s}return u!==null&&u!==null&&Te(u),a.callbackPriority=2,a.callbackNode=null,2}function Xf(a,s){var o=a.callbackNode;if(yn()&&a.callbackNode!==o)return null;var u=xt;return u=vt(a,a===Ct?u:0),u===0?null:(Of(a,u,s),Vf(a,we()),a.callbackNode!=null&&a.callbackNode===o?Xf.bind(null,a):null)}function Gf(a,s){if(yn())return null;Of(a,s,!0)}function dd(a){Ad(function(){Dt&6?ve(et,a):a()})}function pl(){return $a===0&&($a=pr()),$a}function qf(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:Ts(""+a)}function $f(a,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,a.id&&o.setAttribute("form",a.id),s.parentNode.insertBefore(o,s),a=new FormData(a),o.parentNode.removeChild(o),a}function pd(a,s,o,u,_){if(s==="submit"&&o&&o.stateNode===_){var b=qf((_[ae]||null).action),U=u.submitter;U&&(s=(s=U[ae]||null)?qf(s.formAction):U.getAttribute("formAction"),s!==null&&(b=s,U=null));var Z=new Rs("action","action",null,u,_);a.push({event:Z,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if($a!==0){var de=U?$f(_,U):new FormData(_);Ao(o,{pending:!0,data:de,method:_.method,action:b},null,de)}}else typeof b=="function"&&(Z.preventDefault(),de=U?$f(_,U):new FormData(_),Ao(o,{pending:!0,data:de,method:_.method,action:b},b,de))},currentTarget:_}]})}}for(var gl=0;gl<Bc.length;gl++){var _l=Bc[gl],gd=_l.toLowerCase(),_d=_l[0].toUpperCase()+_l.slice(1);kr(gd,"on"+_d)}kr(Pc,"onAnimationEnd"),kr(Mc,"onAnimationIteration"),kr(Lc,"onAnimationStart"),kr("dblclick","onDoubleClick"),kr("focusin","onFocus"),kr("focusout","onBlur"),kr(P0,"onTransitionRun"),kr(M0,"onTransitionStart"),kr(L0,"onTransitionCancel"),kr(Nc,"onTransitionEnd"),Ft("onMouseEnter",["mouseout","mouseover"]),Ft("onMouseLeave",["mouseout","mouseover"]),Ft("onPointerEnter",["pointerout","pointerover"]),Ft("onPointerLeave",["pointerout","pointerover"]),St("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),St("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),St("onBeforeInput",["compositionend","keypress","textInput","paste"]),St("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),St("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),St("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var us="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),md=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(us));function Wf(a,s){s=(s&4)!==0;for(var o=0;o<a.length;o++){var u=a[o],_=u.event;u=u.listeners;e:{var b=void 0;if(s)for(var U=u.length-1;0<=U;U--){var Z=u[U],de=Z.instance,ye=Z.currentTarget;if(Z=Z.listener,de!==b&&_.isPropagationStopped())break e;b=Z,_.currentTarget=ye;try{b(_)}catch(Ie){Js(Ie)}_.currentTarget=null,b=de}else for(U=0;U<u.length;U++){if(Z=u[U],de=Z.instance,ye=Z.currentTarget,Z=Z.listener,de!==b&&_.isPropagationStopped())break e;b=Z,_.currentTarget=ye;try{b(_)}catch(Ie){Js(Ie)}_.currentTarget=null,b=de}}}}function mt(a,s){var o=s[fe];o===void 0&&(o=s[fe]=new Set);var u=a+"__bubble";o.has(u)||(Yf(s,a,2,!1),o.add(u))}function ml(a,s,o){var u=0;s&&(u|=4),Yf(o,a,u,s)}var hi="_reactListening"+Math.random().toString(36).slice(2);function xl(a){if(!a[hi]){a[hi]=!0,ct.forEach(function(o){o!=="selectionchange"&&(md.has(o)||ml(o,!1,a),ml(o,!0,a))});var s=a.nodeType===9?a:a.ownerDocument;s===null||s[hi]||(s[hi]=!0,ml("selectionchange",!1,s))}}function Yf(a,s,o,u){switch(xh(s)){case 2:var _=Vd;break;case 8:_=Xd;break;default:_=Ol}o=_.bind(null,s,o,a),_=void 0,!Ui||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(_=!0),u?_!==void 0?a.addEventListener(s,o,{capture:!0,passive:_}):a.addEventListener(s,o,!0):_!==void 0?a.addEventListener(s,o,{passive:_}):a.addEventListener(s,o,!1)}function vl(a,s,o,u,_){var b=u;if(!(s&1)&&!(s&2)&&u!==null)e:for(;;){if(u===null)return;var U=u.tag;if(U===3||U===4){var Z=u.stateNode.containerInfo;if(Z===_||Z.nodeType===8&&Z.parentNode===_)break;if(U===4)for(U=u.return;U!==null;){var de=U.tag;if((de===3||de===4)&&(de=U.stateNode.containerInfo,de===_||de.nodeType===8&&de.parentNode===_))return;U=U.return}for(;Z!==null;){if(U=He(Z),U===null)return;if(de=U.tag,de===5||de===6||de===26||de===27){u=b=U;continue e}Z=Z.parentNode}}u=u.return}cc(function(){var ye=b,Ie=Ii(o),je=[];e:{var De=Ic.get(a);if(De!==void 0){var Le=Rs,tt=a;switch(a){case"keypress":if(Cs(o)===0)break e;case"keydown":case"keyup":Le=u0;break;case"focusin":tt="focus",Le=Vi;break;case"focusout":tt="blur",Le=Vi;break;case"beforeblur":case"afterblur":Le=Vi;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Le=hc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Le=Qh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Le=d0;break;case Pc:case Mc:case Lc:Le=t0;break;case Nc:Le=g0;break;case"scroll":case"scrollend":Le=Kh;break;case"wheel":Le=m0;break;case"copy":case"cut":case"paste":Le=a0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Le=pc;break;case"toggle":case"beforetoggle":Le=v0}var ut=(s&4)!==0,Nt=!ut&&(a==="scroll"||a==="scrollend"),be=ut?De!==null?De+"Capture":null:De;ut=[];for(var xe=ye,Ce;xe!==null;){var Be=xe;if(Ce=Be.stateNode,Be=Be.tag,Be!==5&&Be!==26&&Be!==27||Ce===null||be===null||(Be=Rn(xe,be),Be!=null&&ut.push(fs(xe,Be,Ce))),Nt)break;xe=xe.return}0<ut.length&&(De=new Le(De,tt,null,o,Ie),je.push({event:De,listeners:ut}))}}if(!(s&7)){e:{if(De=a==="mouseover"||a==="pointerover",Le=a==="mouseout"||a==="pointerout",De&&o!==Ni&&(tt=o.relatedTarget||o.fromElement)&&(He(tt)||tt[ce]))break e;if((Le||De)&&(De=Ie.window===Ie?Ie:(De=Ie.ownerDocument)?De.defaultView||De.parentWindow:window,Le?(tt=o.relatedTarget||o.toElement,Le=ye,tt=tt?He(tt):null,tt!==null&&(Nt=ue(tt),ut=tt.tag,tt!==Nt||ut!==5&&ut!==27&&ut!==6)&&(tt=null)):(Le=null,tt=ye),Le!==tt)){if(ut=hc,Be="onMouseLeave",be="onMouseEnter",xe="mouse",(a==="pointerout"||a==="pointerover")&&(ut=pc,Be="onPointerLeave",be="onPointerEnter",xe="pointer"),Nt=Le==null?De:Ye(Le),Ce=tt==null?De:Ye(tt),De=new ut(Be,xe+"leave",Le,o,Ie),De.target=Nt,De.relatedTarget=Ce,Be=null,He(Ie)===ye&&(ut=new ut(be,xe+"enter",tt,o,Ie),ut.target=Ce,ut.relatedTarget=Nt,Be=ut),Nt=Be,Le&&tt)t:{for(ut=Le,be=tt,xe=0,Ce=ut;Ce;Ce=Sn(Ce))xe++;for(Ce=0,Be=be;Be;Be=Sn(Be))Ce++;for(;0<xe-Ce;)ut=Sn(ut),xe--;for(;0<Ce-xe;)be=Sn(be),Ce--;for(;xe--;){if(ut===be||be!==null&&ut===be.alternate)break t;ut=Sn(ut),be=Sn(be)}ut=null}else ut=null;Le!==null&&Kf(je,De,Le,ut,!1),tt!==null&&Nt!==null&&Kf(je,Nt,tt,ut,!0)}}e:{if(De=ye?Ye(ye):window,Le=De.nodeName&&De.nodeName.toLowerCase(),Le==="select"||Le==="input"&&De.type==="file")var Qe=Sc;else if(yc(De))if(Ac)Qe=R0;else{Qe=C0;var gt=w0}else Le=De.nodeName,!Le||Le.toLowerCase()!=="input"||De.type!=="checkbox"&&De.type!=="radio"?ye&&Li(ye.elementType)&&(Qe=Sc):Qe=k0;if(Qe&&(Qe=Qe(a,ye))){Ec(je,Qe,o,Ie);break e}gt&&gt(a,De,ye),a==="focusout"&&ye&&De.type==="number"&&ye.memoizedProps.value!=null&&Mi(De,"number",De.value)}switch(gt=ye?Ye(ye):window,a){case"focusin":(yc(gt)||gt.contentEditable==="true")&&(Za=gt,Yi=ye,In=null);break;case"focusout":In=Yi=Za=null;break;case"mousedown":Ki=!0;break;case"contextmenu":case"mouseup":case"dragend":Ki=!1,Oc(je,o,Ie);break;case"selectionchange":if(D0)break;case"keydown":case"keyup":Oc(je,o,Ie)}var rt;if(Gi)e:{switch(a){case"compositionstart":var it="onCompositionStart";break e;case"compositionend":it="onCompositionEnd";break e;case"compositionupdate":it="onCompositionUpdate";break e}it=void 0}else Qa?xc(a,o)&&(it="onCompositionEnd"):a==="keydown"&&o.keyCode===229&&(it="onCompositionStart");it&&(gc&&o.locale!=="ko"&&(Qa||it!=="onCompositionStart"?it==="onCompositionEnd"&&Qa&&(rt=uc()):(oa=Ie,ji="value"in oa?oa.value:oa.textContent,Qa=!0)),gt=di(ye,it),0<gt.length&&(it=new dc(it,a,null,o,Ie),je.push({event:it,listeners:gt}),rt?it.data=rt:(rt=vc(o),rt!==null&&(it.data=rt)))),(rt=E0?S0(a,o):A0(a,o))&&(it=di(ye,"onBeforeInput"),0<it.length&&(gt=new dc("onBeforeInput","beforeinput",null,o,Ie),je.push({event:gt,listeners:it}),gt.data=rt)),pd(je,a,ye,o,Ie)}Wf(je,s)})}function fs(a,s,o){return{instance:a,listener:s,currentTarget:o}}function di(a,s){for(var o=s+"Capture",u=[];a!==null;){var _=a,b=_.stateNode;_=_.tag,_!==5&&_!==26&&_!==27||b===null||(_=Rn(a,o),_!=null&&u.unshift(fs(a,_,b)),_=Rn(a,s),_!=null&&u.push(fs(a,_,b))),a=a.return}return u}function Sn(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function Kf(a,s,o,u,_){for(var b=s._reactName,U=[];o!==null&&o!==u;){var Z=o,de=Z.alternate,ye=Z.stateNode;if(Z=Z.tag,de!==null&&de===u)break;Z!==5&&Z!==26&&Z!==27||ye===null||(de=ye,_?(ye=Rn(o,b),ye!=null&&U.unshift(fs(o,ye,de))):_||(ye=Rn(o,b),ye!=null&&U.push(fs(o,ye,de)))),o=o.return}U.length!==0&&a.push({event:s,listeners:U})}var xd=/\r\n?/g,vd=/\u0000|\uFFFD/g;function Jf(a){return(typeof a=="string"?a:""+a).replace(xd,`
`).replace(vd,"")}function Qf(a,s){return s=Jf(s),Jf(a)===s}function pi(){}function bt(a,s,o,u,_,b){switch(o){case"children":typeof u=="string"?s==="body"||s==="textarea"&&u===""||Ya(a,u):(typeof u=="number"||typeof u=="bigint")&&s!=="body"&&Ya(a,""+u);break;case"className":Ss(a,"class",u);break;case"tabIndex":Ss(a,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Ss(a,o,u);break;case"style":oc(a,u,b);break;case"data":if(s!=="object"){Ss(a,"data",u);break}case"src":case"href":if(u===""&&(s!=="a"||o!=="href")){a.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){a.removeAttribute(o);break}u=Ts(""+u),a.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){a.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(o==="formAction"?(s!=="input"&&bt(a,s,"name",_.name,_,null),bt(a,s,"formEncType",_.formEncType,_,null),bt(a,s,"formMethod",_.formMethod,_,null),bt(a,s,"formTarget",_.formTarget,_,null)):(bt(a,s,"encType",_.encType,_,null),bt(a,s,"method",_.method,_,null),bt(a,s,"target",_.target,_,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){a.removeAttribute(o);break}u=Ts(""+u),a.setAttribute(o,u);break;case"onClick":u!=null&&(a.onclick=pi);break;case"onScroll":u!=null&&mt("scroll",a);break;case"onScrollEnd":u!=null&&mt("scrollend",a);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(n(61));if(o=u.__html,o!=null){if(_.children!=null)throw Error(n(60));a.innerHTML=o}}break;case"multiple":a.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":a.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){a.removeAttribute("xlink:href");break}o=Ts(""+u),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?a.setAttribute(o,""+u):a.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?a.setAttribute(o,""):a.removeAttribute(o);break;case"capture":case"download":u===!0?a.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?a.setAttribute(o,u):a.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?a.setAttribute(o,u):a.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?a.removeAttribute(o):a.setAttribute(o,u);break;case"popover":mt("beforetoggle",a),mt("toggle",a),nr(a,"popover",u);break;case"xlinkActuate":zr(a,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":zr(a,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":zr(a,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":zr(a,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":zr(a,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":zr(a,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":zr(a,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":zr(a,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":zr(a,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":nr(a,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Wh.get(o)||o,nr(a,o,u))}}function yl(a,s,o,u,_,b){switch(o){case"style":oc(a,u,b);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(n(61));if(o=u.__html,o!=null){if(_.children!=null)throw Error(n(60));a.innerHTML=o}}break;case"children":typeof u=="string"?Ya(a,u):(typeof u=="number"||typeof u=="bigint")&&Ya(a,""+u);break;case"onScroll":u!=null&&mt("scroll",a);break;case"onScrollEnd":u!=null&&mt("scrollend",a);break;case"onClick":u!=null&&(a.onclick=pi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!wt.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(_=o.endsWith("Capture"),s=o.slice(2,_?o.length-7:void 0),b=a[ae]||null,b=b!=null?b[o]:null,typeof b=="function"&&a.removeEventListener(s,b,_),typeof u=="function")){typeof b!="function"&&b!==null&&(o in a?a[o]=null:a.hasAttribute(o)&&a.removeAttribute(o)),a.addEventListener(s,u,_);break e}o in a?a[o]=u:u===!0?a.setAttribute(o,""):nr(a,o,u)}}}function Jt(a,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":mt("error",a),mt("load",a);var u=!1,_=!1,b;for(b in o)if(o.hasOwnProperty(b)){var U=o[b];if(U!=null)switch(b){case"src":u=!0;break;case"srcSet":_=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:bt(a,s,b,U,o,null)}}_&&bt(a,s,"srcSet",o.srcSet,o,null),u&&bt(a,s,"src",o.src,o,null);return;case"input":mt("invalid",a);var Z=b=U=_=null,de=null,ye=null;for(u in o)if(o.hasOwnProperty(u)){var Ie=o[u];if(Ie!=null)switch(u){case"name":_=Ie;break;case"type":U=Ie;break;case"checked":de=Ie;break;case"defaultChecked":ye=Ie;break;case"value":b=Ie;break;case"defaultValue":Z=Ie;break;case"children":case"dangerouslySetInnerHTML":if(Ie!=null)throw Error(n(137,s));break;default:bt(a,s,u,Ie,o,null)}}ac(a,b,Z,de,ye,U,_,!1),As(a);return;case"select":mt("invalid",a),u=U=b=null;for(_ in o)if(o.hasOwnProperty(_)&&(Z=o[_],Z!=null))switch(_){case"value":b=Z;break;case"defaultValue":U=Z;break;case"multiple":u=Z;default:bt(a,s,_,Z,o,null)}s=b,o=U,a.multiple=!!u,s!=null?Wa(a,!!u,s,!1):o!=null&&Wa(a,!!u,o,!0);return;case"textarea":mt("invalid",a),b=_=u=null;for(U in o)if(o.hasOwnProperty(U)&&(Z=o[U],Z!=null))switch(U){case"value":u=Z;break;case"defaultValue":_=Z;break;case"children":b=Z;break;case"dangerouslySetInnerHTML":if(Z!=null)throw Error(n(91));break;default:bt(a,s,U,Z,o,null)}sc(a,u,_,b),As(a);return;case"option":for(de in o)if(o.hasOwnProperty(de)&&(u=o[de],u!=null))switch(de){case"selected":a.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:bt(a,s,de,u,o,null)}return;case"dialog":mt("cancel",a),mt("close",a);break;case"iframe":case"object":mt("load",a);break;case"video":case"audio":for(u=0;u<us.length;u++)mt(us[u],a);break;case"image":mt("error",a),mt("load",a);break;case"details":mt("toggle",a);break;case"embed":case"source":case"link":mt("error",a),mt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ye in o)if(o.hasOwnProperty(ye)&&(u=o[ye],u!=null))switch(ye){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:bt(a,s,ye,u,o,null)}return;default:if(Li(s)){for(Ie in o)o.hasOwnProperty(Ie)&&(u=o[Ie],u!==void 0&&yl(a,s,Ie,u,o,void 0));return}}for(Z in o)o.hasOwnProperty(Z)&&(u=o[Z],u!=null&&bt(a,s,Z,u,o,null))}function yd(a,s,o,u){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var _=null,b=null,U=null,Z=null,de=null,ye=null,Ie=null;for(Le in o){var je=o[Le];if(o.hasOwnProperty(Le)&&je!=null)switch(Le){case"checked":break;case"value":break;case"defaultValue":de=je;default:u.hasOwnProperty(Le)||bt(a,s,Le,null,u,je)}}for(var De in u){var Le=u[De];if(je=o[De],u.hasOwnProperty(De)&&(Le!=null||je!=null))switch(De){case"type":b=Le;break;case"name":_=Le;break;case"checked":ye=Le;break;case"defaultChecked":Ie=Le;break;case"value":U=Le;break;case"defaultValue":Z=Le;break;case"children":case"dangerouslySetInnerHTML":if(Le!=null)throw Error(n(137,s));break;default:Le!==je&&bt(a,s,De,Le,u,je)}}Pi(a,U,Z,de,ye,Ie,b,_);return;case"select":Le=U=Z=De=null;for(b in o)if(de=o[b],o.hasOwnProperty(b)&&de!=null)switch(b){case"value":break;case"multiple":Le=de;default:u.hasOwnProperty(b)||bt(a,s,b,null,u,de)}for(_ in u)if(b=u[_],de=o[_],u.hasOwnProperty(_)&&(b!=null||de!=null))switch(_){case"value":De=b;break;case"defaultValue":Z=b;break;case"multiple":U=b;default:b!==de&&bt(a,s,_,b,u,de)}s=Z,o=U,u=Le,De!=null?Wa(a,!!o,De,!1):!!u!=!!o&&(s!=null?Wa(a,!!o,s,!0):Wa(a,!!o,o?[]:"",!1));return;case"textarea":Le=De=null;for(Z in o)if(_=o[Z],o.hasOwnProperty(Z)&&_!=null&&!u.hasOwnProperty(Z))switch(Z){case"value":break;case"children":break;default:bt(a,s,Z,null,u,_)}for(U in u)if(_=u[U],b=o[U],u.hasOwnProperty(U)&&(_!=null||b!=null))switch(U){case"value":De=_;break;case"defaultValue":Le=_;break;case"children":break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(n(91));break;default:_!==b&&bt(a,s,U,_,u,b)}nc(a,De,Le);return;case"option":for(var tt in o)if(De=o[tt],o.hasOwnProperty(tt)&&De!=null&&!u.hasOwnProperty(tt))switch(tt){case"selected":a.selected=!1;break;default:bt(a,s,tt,null,u,De)}for(de in u)if(De=u[de],Le=o[de],u.hasOwnProperty(de)&&De!==Le&&(De!=null||Le!=null))switch(de){case"selected":a.selected=De&&typeof De!="function"&&typeof De!="symbol";break;default:bt(a,s,de,De,u,Le)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ut in o)De=o[ut],o.hasOwnProperty(ut)&&De!=null&&!u.hasOwnProperty(ut)&&bt(a,s,ut,null,u,De);for(ye in u)if(De=u[ye],Le=o[ye],u.hasOwnProperty(ye)&&De!==Le&&(De!=null||Le!=null))switch(ye){case"children":case"dangerouslySetInnerHTML":if(De!=null)throw Error(n(137,s));break;default:bt(a,s,ye,De,u,Le)}return;default:if(Li(s)){for(var Nt in o)De=o[Nt],o.hasOwnProperty(Nt)&&De!==void 0&&!u.hasOwnProperty(Nt)&&yl(a,s,Nt,void 0,u,De);for(Ie in u)De=u[Ie],Le=o[Ie],!u.hasOwnProperty(Ie)||De===Le||De===void 0&&Le===void 0||yl(a,s,Ie,De,u,Le);return}}for(var be in o)De=o[be],o.hasOwnProperty(be)&&De!=null&&!u.hasOwnProperty(be)&&bt(a,s,be,null,u,De);for(je in u)De=u[je],Le=o[je],!u.hasOwnProperty(je)||De===Le||De==null&&Le==null||bt(a,s,je,De,u,Le)}var El=null,Sl=null;function gi(a){return a.nodeType===9?a:a.ownerDocument}function Zf(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function eh(a,s){if(a===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&s==="foreignObject"?0:a}function Al(a,s){return a==="textarea"||a==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var bl=null;function Ed(){var a=window.event;return a&&a.type==="popstate"?a===bl?!1:(bl=a,!0):(bl=null,!1)}var th=typeof setTimeout=="function"?setTimeout:void 0,Sd=typeof clearTimeout=="function"?clearTimeout:void 0,rh=typeof Promise=="function"?Promise:void 0,Ad=typeof queueMicrotask=="function"?queueMicrotask:typeof rh<"u"?function(a){return rh.resolve(null).then(a).catch(bd)}:th;function bd(a){setTimeout(function(){throw a})}function Tl(a,s){var o=s,u=0;do{var _=o.nextSibling;if(a.removeChild(o),_&&_.nodeType===8)if(o=_.data,o==="/$"){if(u===0){a.removeChild(_),vs(s);return}u--}else o!=="$"&&o!=="$?"&&o!=="$!"||u++;o=_}while(o);vs(s)}function wl(a){var s=a.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":wl(o),Oe(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}a.removeChild(o)}}function Td(a,s,o,u){for(;a.nodeType===1;){var _=o;if(a.nodeName.toLowerCase()!==s.toLowerCase()){if(!u&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(u){if(!a[Re])switch(s){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(b=a.getAttribute("rel"),b==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(b!==_.rel||a.getAttribute("href")!==(_.href==null?null:_.href)||a.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin)||a.getAttribute("title")!==(_.title==null?null:_.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(b=a.getAttribute("src"),(b!==(_.src==null?null:_.src)||a.getAttribute("type")!==(_.type==null?null:_.type)||a.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin))&&b&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(s==="input"&&a.type==="hidden"){var b=_.name==null?null:""+_.name;if(_.type==="hidden"&&a.getAttribute("name")===b)return a}else return a;if(a=Or(a.nextSibling),a===null)break}return null}function wd(a,s,o){if(s==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!o||(a=Or(a.nextSibling),a===null))return null;return a}function Or(a){for(;a!=null;a=a.nextSibling){var s=a.nodeType;if(s===1||s===3)break;if(s===8){if(s=a.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return a}function ah(a){a=a.previousSibling;for(var s=0;a;){if(a.nodeType===8){var o=a.data;if(o==="$"||o==="$!"||o==="$?"){if(s===0)return a;s--}else o==="/$"&&s++}a=a.previousSibling}return null}function nh(a,s,o){switch(s=gi(o),a){case"html":if(a=s.documentElement,!a)throw Error(n(452));return a;case"head":if(a=s.head,!a)throw Error(n(453));return a;case"body":if(a=s.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}var Cr=new Map,sh=new Set;function _i(a){return typeof a.getRootNode=="function"?a.getRootNode():a.ownerDocument}var aa=k.d;k.d={f:Cd,r:kd,D:Rd,C:Fd,L:Od,m:Dd,X:Md,S:Pd,M:Ld};function Cd(){var a=aa.f(),s=li();return a||s}function kd(a){var s=$e(a);s!==null&&s.tag===5&&s.type==="form"?Ou(s):aa.r(a)}var An=typeof document>"u"?null:document;function ih(a,s,o){var u=An;if(u&&typeof s=="string"&&s){var _=mr(s);_='link[rel="'+a+'"][href="'+_+'"]',typeof o=="string"&&(_+='[crossorigin="'+o+'"]'),sh.has(_)||(sh.add(_),a={rel:a,crossOrigin:o,href:s},u.querySelector(_)===null&&(s=u.createElement("link"),Jt(s,"link",a),Xe(s),u.head.appendChild(s)))}}function Rd(a){aa.D(a),ih("dns-prefetch",a,null)}function Fd(a,s){aa.C(a,s),ih("preconnect",a,s)}function Od(a,s,o){aa.L(a,s,o);var u=An;if(u&&a&&s){var _='link[rel="preload"][as="'+mr(s)+'"]';s==="image"&&o&&o.imageSrcSet?(_+='[imagesrcset="'+mr(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(_+='[imagesizes="'+mr(o.imageSizes)+'"]')):_+='[href="'+mr(a)+'"]';var b=_;switch(s){case"style":b=bn(a);break;case"script":b=Tn(a)}Cr.has(b)||(a=X({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:a,as:s},o),Cr.set(b,a),u.querySelector(_)!==null||s==="style"&&u.querySelector(hs(b))||s==="script"&&u.querySelector(ds(b))||(s=u.createElement("link"),Jt(s,"link",a),Xe(s),u.head.appendChild(s)))}}function Dd(a,s){aa.m(a,s);var o=An;if(o&&a){var u=s&&typeof s.as=="string"?s.as:"script",_='link[rel="modulepreload"][as="'+mr(u)+'"][href="'+mr(a)+'"]',b=_;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=Tn(a)}if(!Cr.has(b)&&(a=X({rel:"modulepreload",href:a},s),Cr.set(b,a),o.querySelector(_)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(ds(b)))return}u=o.createElement("link"),Jt(u,"link",a),Xe(u),o.head.appendChild(u)}}}function Pd(a,s,o){aa.S(a,s,o);var u=An;if(u&&a){var _=Ve(u).hoistableStyles,b=bn(a);s=s||"default";var U=_.get(b);if(!U){var Z={loading:0,preload:null};if(U=u.querySelector(hs(b)))Z.loading=5;else{a=X({rel:"stylesheet",href:a,"data-precedence":s},o),(o=Cr.get(b))&&Cl(a,o);var de=U=u.createElement("link");Xe(de),Jt(de,"link",a),de._p=new Promise(function(ye,Ie){de.onload=ye,de.onerror=Ie}),de.addEventListener("load",function(){Z.loading|=1}),de.addEventListener("error",function(){Z.loading|=2}),Z.loading|=4,mi(U,s,u)}U={type:"stylesheet",instance:U,count:1,state:Z},_.set(b,U)}}}function Md(a,s){aa.X(a,s);var o=An;if(o&&a){var u=Ve(o).hoistableScripts,_=Tn(a),b=u.get(_);b||(b=o.querySelector(ds(_)),b||(a=X({src:a,async:!0},s),(s=Cr.get(_))&&kl(a,s),b=o.createElement("script"),Xe(b),Jt(b,"link",a),o.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},u.set(_,b))}}function Ld(a,s){aa.M(a,s);var o=An;if(o&&a){var u=Ve(o).hoistableScripts,_=Tn(a),b=u.get(_);b||(b=o.querySelector(ds(_)),b||(a=X({src:a,async:!0,type:"module"},s),(s=Cr.get(_))&&kl(a,s),b=o.createElement("script"),Xe(b),Jt(b,"link",a),o.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},u.set(_,b))}}function oh(a,s,o,u){var _=(_=Y.current)?_i(_):null;if(!_)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=bn(o.href),o=Ve(_).hoistableStyles,u=o.get(s),u||(u={type:"style",instance:null,count:0,state:null},o.set(s,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){a=bn(o.href);var b=Ve(_).hoistableStyles,U=b.get(a);if(U||(_=_.ownerDocument||_,U={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(a,U),(b=_.querySelector(hs(a)))&&!b._p&&(U.instance=b,U.state.loading=5),Cr.has(a)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Cr.set(a,o),b||Nd(_,a,o,U.state))),s&&u===null)throw Error(n(528,""));return U}if(s&&u!==null)throw Error(n(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Tn(o),o=Ve(_).hoistableScripts,u=o.get(s),u||(u={type:"script",instance:null,count:0,state:null},o.set(s,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function bn(a){return'href="'+mr(a)+'"'}function hs(a){return'link[rel="stylesheet"]['+a+"]"}function lh(a){return X({},a,{"data-precedence":a.precedence,precedence:null})}function Nd(a,s,o,u){a.querySelector('link[rel="preload"][as="style"]['+s+"]")?u.loading=1:(s=a.createElement("link"),u.preload=s,s.addEventListener("load",function(){return u.loading|=1}),s.addEventListener("error",function(){return u.loading|=2}),Jt(s,"link",o),Xe(s),a.head.appendChild(s))}function Tn(a){return'[src="'+mr(a)+'"]'}function ds(a){return"script[async]"+a}function ch(a,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var u=a.querySelector('style[data-href~="'+mr(o.href)+'"]');if(u)return s.instance=u,Xe(u),u;var _=X({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(a.ownerDocument||a).createElement("style"),Xe(u),Jt(u,"style",_),mi(u,o.precedence,a),s.instance=u;case"stylesheet":_=bn(o.href);var b=a.querySelector(hs(_));if(b)return s.state.loading|=4,s.instance=b,Xe(b),b;u=lh(o),(_=Cr.get(_))&&Cl(u,_),b=(a.ownerDocument||a).createElement("link"),Xe(b);var U=b;return U._p=new Promise(function(Z,de){U.onload=Z,U.onerror=de}),Jt(b,"link",u),s.state.loading|=4,mi(b,o.precedence,a),s.instance=b;case"script":return b=Tn(o.src),(_=a.querySelector(ds(b)))?(s.instance=_,Xe(_),_):(u=o,(_=Cr.get(b))&&(u=X({},o),kl(u,_)),a=a.ownerDocument||a,_=a.createElement("script"),Xe(_),Jt(_,"link",u),a.head.appendChild(_),s.instance=_);case"void":return null;default:throw Error(n(443,s.type))}else s.type==="stylesheet"&&!(s.state.loading&4)&&(u=s.instance,s.state.loading|=4,mi(u,o.precedence,a));return s.instance}function mi(a,s,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),_=u.length?u[u.length-1]:null,b=_,U=0;U<u.length;U++){var Z=u[U];if(Z.dataset.precedence===s)b=Z;else if(b!==_)break}b?b.parentNode.insertBefore(a,b.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(a,s.firstChild))}function Cl(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.title==null&&(a.title=s.title)}function kl(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.integrity==null&&(a.integrity=s.integrity)}var xi=null;function uh(a,s,o){if(xi===null){var u=new Map,_=xi=new Map;_.set(o,u)}else _=xi,u=_.get(o),u||(u=new Map,_.set(o,u));if(u.has(a))return u;for(u.set(a,null),o=o.getElementsByTagName(a),_=0;_<o.length;_++){var b=o[_];if(!(b[Re]||b[ee]||a==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var U=b.getAttribute(s)||"";U=a+U;var Z=u.get(U);Z?Z.push(b):u.set(U,[b])}}return u}function fh(a,s,o){a=a.ownerDocument||a,a.head.insertBefore(o,s==="title"?a.querySelector("head > title"):null)}function Id(a,s,o){if(o===1||s.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return a=s.disabled,typeof s.precedence=="string"&&a==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function hh(a){return!(a.type==="stylesheet"&&!(a.state.loading&3))}var ps=null;function Bd(){}function Ud(a,s,o){if(ps===null)throw Error(n(475));var u=ps;if(s.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&!(s.state.loading&4)){if(s.instance===null){var _=bn(o.href),b=a.querySelector(hs(_));if(b){a=b._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(u.count++,u=vi.bind(u),a.then(u,u)),s.state.loading|=4,s.instance=b,Xe(b);return}b=a.ownerDocument||a,o=lh(o),(_=Cr.get(_))&&Cl(o,_),b=b.createElement("link"),Xe(b);var U=b;U._p=new Promise(function(Z,de){U.onload=Z,U.onerror=de}),Jt(b,"link",o),s.instance=b}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(s,a),(a=s.state.preload)&&!(s.state.loading&3)&&(u.count++,s=vi.bind(u),a.addEventListener("load",s),a.addEventListener("error",s))}}function jd(){if(ps===null)throw Error(n(475));var a=ps;return a.stylesheets&&a.count===0&&Rl(a,a.stylesheets),0<a.count?function(s){var o=setTimeout(function(){if(a.stylesheets&&Rl(a,a.stylesheets),a.unsuspend){var u=a.unsuspend;a.unsuspend=null,u()}},6e4);return a.unsuspend=s,function(){a.unsuspend=null,clearTimeout(o)}}:null}function vi(){if(this.count--,this.count===0){if(this.stylesheets)Rl(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var yi=null;function Rl(a,s){a.stylesheets=null,a.unsuspend!==null&&(a.count++,yi=new Map,s.forEach(Hd,a),yi=null,vi.call(a))}function Hd(a,s){if(!(s.state.loading&4)){var o=yi.get(a);if(o)var u=o.get(null);else{o=new Map,yi.set(a,o);for(var _=a.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<_.length;b++){var U=_[b];(U.nodeName==="LINK"||U.getAttribute("media")!=="not all")&&(o.set(U.dataset.precedence,U),u=U)}u&&o.set(null,u)}_=s.instance,U=_.getAttribute("data-precedence"),b=o.get(U)||u,b===u&&o.set(null,_),o.set(U,_),this.count++,u=vi.bind(this),_.addEventListener("load",u),_.addEventListener("error",u),b?b.parentNode.insertBefore(_,b.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(_,a.firstChild)),s.state.loading|=4}}var gs={$$typeof:S,Provider:null,Consumer:null,_currentValue:B,_currentValue2:B,_threadCount:0};function zd(a,s,o,u,_,b,U,Z){this.tag=1,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=gr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gr(0),this.hiddenUpdates=gr(null),this.identifierPrefix=u,this.onUncaughtError=_,this.onCaughtError=b,this.onRecoverableError=U,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Z,this.incompleteTransitions=new Map}function dh(a,s,o,u,_,b,U,Z,de,ye,Ie,je){return a=new zd(a,s,o,U,Z,de,ye,je),s=1,b===!0&&(s|=24),b=Tr(3,null,null,s),a.current=b,b.stateNode=a,s=io(),s.refCount++,a.pooledCache=s,s.refCount++,b.memoizedState={element:u,isDehydrated:o,cache:s},Ho(b),a}function ph(a){return a?(a=rn,a):rn}function gh(a,s,o,u,_,b){_=ph(_),u.context===null?u.context=_:u.pendingContext=_,u=ga(s),u.payload={element:o},b=b===void 0?null:b,b!==null&&(u.callback=b),o=_a(a,u,s),o!==null&&(ar(o,a,s),Qn(o,a,s))}function _h(a,s){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var o=a.retryLane;a.retryLane=o!==0&&o<s?o:s}}function Fl(a,s){_h(a,s),(a=a.alternate)&&_h(a,s)}function mh(a){if(a.tag===13){var s=la(a,67108864);s!==null&&ar(s,a,67108864),Fl(a,67108864)}}var Ei=!0;function Vd(a,s,o,u){var _=M.T;M.T=null;var b=k.p;try{k.p=2,Ol(a,s,o,u)}finally{k.p=b,M.T=_}}function Xd(a,s,o,u){var _=M.T;M.T=null;var b=k.p;try{k.p=8,Ol(a,s,o,u)}finally{k.p=b,M.T=_}}function Ol(a,s,o,u){if(Ei){var _=Dl(u);if(_===null)vl(a,s,u,Si,o),vh(a,u);else if(qd(_,a,s,o,u))u.stopPropagation();else if(vh(a,u),s&4&&-1<Gd.indexOf(a)){for(;_!==null;){var b=$e(_);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var U=pt(b.pendingLanes);if(U!==0){var Z=b;for(Z.pendingLanes|=2,Z.entangledLanes|=2;U;){var de=1<<31-Pt(U);Z.entanglements[1]|=de,U&=~de}Br(b),!(Dt&6)&&(si=we()+500,cs(0))}}break;case 13:Z=la(b,2),Z!==null&&ar(Z,b,2),li(),Fl(b,2)}if(b=Dl(u),b===null&&vl(a,s,u,Si,o),b===_)break;_=b}_!==null&&u.stopPropagation()}else vl(a,s,u,null,o)}}function Dl(a){return a=Ii(a),Pl(a)}var Si=null;function Pl(a){if(Si=null,a=He(a),a!==null){var s=ue(a);if(s===null)a=null;else{var o=s.tag;if(o===13){if(a=re(s),a!==null)return a;a=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;a=null}else s!==a&&(a=null)}}return Si=a,null}function xh(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(at()){case et:return 2;case Ke:return 8;case Ze:case ft:return 32;case Je:return 268435456;default:return 32}default:return 32}}var Ml=!1,Aa=null,ba=null,Ta=null,_s=new Map,ms=new Map,wa=[],Gd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vh(a,s){switch(a){case"focusin":case"focusout":Aa=null;break;case"dragenter":case"dragleave":ba=null;break;case"mouseover":case"mouseout":Ta=null;break;case"pointerover":case"pointerout":_s.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":ms.delete(s.pointerId)}}function xs(a,s,o,u,_,b){return a===null||a.nativeEvent!==b?(a={blockedOn:s,domEventName:o,eventSystemFlags:u,nativeEvent:b,targetContainers:[_]},s!==null&&(s=$e(s),s!==null&&mh(s)),a):(a.eventSystemFlags|=u,s=a.targetContainers,_!==null&&s.indexOf(_)===-1&&s.push(_),a)}function qd(a,s,o,u,_){switch(s){case"focusin":return Aa=xs(Aa,a,s,o,u,_),!0;case"dragenter":return ba=xs(ba,a,s,o,u,_),!0;case"mouseover":return Ta=xs(Ta,a,s,o,u,_),!0;case"pointerover":var b=_.pointerId;return _s.set(b,xs(_s.get(b)||null,a,s,o,u,_)),!0;case"gotpointercapture":return b=_.pointerId,ms.set(b,xs(ms.get(b)||null,a,s,o,u,_)),!0}return!1}function yh(a){var s=He(a.target);if(s!==null){var o=ue(s);if(o!==null){if(s=o.tag,s===13){if(s=re(o),s!==null){a.blockedOn=s,G(a.priority,function(){if(o.tag===13){var u=hr(),_=la(o,u);_!==null&&ar(_,o,u),Fl(o,u)}});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){a.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Ai(a){if(a.blockedOn!==null)return!1;for(var s=a.targetContainers;0<s.length;){var o=Dl(a.nativeEvent);if(o===null){o=a.nativeEvent;var u=new o.constructor(o.type,o);Ni=u,o.target.dispatchEvent(u),Ni=null}else return s=$e(o),s!==null&&mh(s),a.blockedOn=o,!1;s.shift()}return!0}function Eh(a,s,o){Ai(a)&&o.delete(s)}function $d(){Ml=!1,Aa!==null&&Ai(Aa)&&(Aa=null),ba!==null&&Ai(ba)&&(ba=null),Ta!==null&&Ai(Ta)&&(Ta=null),_s.forEach(Eh),ms.forEach(Eh)}function bi(a,s){a.blockedOn===s&&(a.blockedOn=null,Ml||(Ml=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,$d)))}var Ti=null;function Sh(a){Ti!==a&&(Ti=a,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Ti===a&&(Ti=null);for(var s=0;s<a.length;s+=3){var o=a[s],u=a[s+1],_=a[s+2];if(typeof u!="function"){if(Pl(u||o)===null)continue;break}var b=$e(o);b!==null&&(a.splice(s,3),s-=3,Ao(b,{pending:!0,data:_,method:o.method,action:u},u,_))}}))}function vs(a){function s(de){return bi(de,a)}Aa!==null&&bi(Aa,a),ba!==null&&bi(ba,a),Ta!==null&&bi(Ta,a),_s.forEach(s),ms.forEach(s);for(var o=0;o<wa.length;o++){var u=wa[o];u.blockedOn===a&&(u.blockedOn=null)}for(;0<wa.length&&(o=wa[0],o.blockedOn===null);)yh(o),o.blockedOn===null&&wa.shift();if(o=(a.ownerDocument||a).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var _=o[u],b=o[u+1],U=_[ae]||null;if(typeof b=="function")U||Sh(o);else if(U){var Z=null;if(b&&b.hasAttribute("formAction")){if(_=b,U=b[ae]||null)Z=U.formAction;else if(Pl(_)!==null)continue}else Z=U.action;typeof Z=="function"?o[u+1]=Z:(o.splice(u,3),u-=3),Sh(o)}}}function Ll(a){this._internalRoot=a}wi.prototype.render=Ll.prototype.render=function(a){var s=this._internalRoot;if(s===null)throw Error(n(409));var o=s.current,u=hr();gh(o,u,a,s,null,null)},wi.prototype.unmount=Ll.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var s=a.containerInfo;a.tag===0&&yn(),gh(a.current,2,null,a,null,null),li(),s[ce]=null}};function wi(a){this._internalRoot=a}wi.prototype.unstable_scheduleHydration=function(a){if(a){var s=sa();a={blockedOn:null,target:a,priority:s};for(var o=0;o<wa.length&&s!==0&&s<wa[o].priority;o++);wa.splice(o,0,a),o===0&&yh(a)}};var Ah=r.version;if(Ah!=="19.0.0")throw Error(n(527,Ah,"19.0.0"));k.findDOMNode=function(a){var s=a._reactInternals;if(s===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=me(s),a=a!==null?N(a):null,a=a===null?null:a.stateNode,a};var Wd={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:M,findFiberByHostInstance:He,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ci=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ci.isDisabled&&Ci.supportsFiber)try{nt=Ci.inject(Wd),lt=Ci}catch{}}return reactDomClient_production.createRoot=function(a,s){if(!i(a))throw Error(n(299));var o=!1,u="",_=Uu,b=ju,U=Hu,Z=null;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(u=s.identifierPrefix),s.onUncaughtError!==void 0&&(_=s.onUncaughtError),s.onCaughtError!==void 0&&(b=s.onCaughtError),s.onRecoverableError!==void 0&&(U=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(Z=s.unstable_transitionCallbacks)),s=dh(a,1,!1,null,null,o,u,_,b,U,Z,null),a[ce]=s.current,xl(a.nodeType===8?a.parentNode:a),new Ll(s)},reactDomClient_production.hydrateRoot=function(a,s,o){if(!i(a))throw Error(n(299));var u=!1,_="",b=Uu,U=ju,Z=Hu,de=null,ye=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(_=o.identifierPrefix),o.onUncaughtError!==void 0&&(b=o.onUncaughtError),o.onCaughtError!==void 0&&(U=o.onCaughtError),o.onRecoverableError!==void 0&&(Z=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(de=o.unstable_transitionCallbacks),o.formState!==void 0&&(ye=o.formState)),s=dh(a,1,!0,s,o??null,u,_,b,U,Z,de,ye),s.context=ph(null),o=s.current,u=hr(),_=ga(u),_.callback=null,_a(o,_,u),s.current.lanes=u,Zt(s,u),Br(s),a[ce]=s.current,xl(a),new wi(s)},reactDomClient_production.version="19.0.0",reactDomClient_production}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client.exports;hasRequiredClient=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),client.exports=requireReactDomClient_production(),client.exports}var clientExports=requireClient();const ReactDOM=getDefaultExportFromCjs(clientExports);var dist={},hasRequiredDist;function requireDist(){if(hasRequiredDist)return dist;hasRequiredDist=1,Object.defineProperty(dist,"__esModule",{value:!0}),dist.parse=c,dist.serialize=h;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,r=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,i=Object.prototype.toString,l=(()=>{const y=function(){};return y.prototype=Object.create(null),y})();function c(y,S){const x=new l,g=y.length;if(g<2)return x;const m=(S==null?void 0:S.decode)||p;let A=0;do{const O=y.indexOf("=",A);if(O===-1)break;const C=y.indexOf(";",A),R=C===-1?g:C;if(O>R){A=y.lastIndexOf(";",O-1)+1;continue}const T=f(y,A,O),w=d(y,O,T),v=y.slice(T,w);if(x[v]===void 0){let L=f(y,O+1,R),M=d(y,R,L);const X=m(y.slice(L,M));x[v]=X}A=R+1}while(A<g);return x}function f(y,S,x){do{const g=y.charCodeAt(S);if(g!==32&&g!==9)return S}while(++S<x);return x}function d(y,S,x){for(;S>x;){const g=y.charCodeAt(--S);if(g!==32&&g!==9)return S+1}return x}function h(y,S,x){const g=(x==null?void 0:x.encode)||encodeURIComponent;if(!e.test(y))throw new TypeError(`argument name is invalid: ${y}`);const m=g(S);if(!r.test(m))throw new TypeError(`argument val is invalid: ${S}`);let A=y+"="+m;if(!x)return A;if(x.maxAge!==void 0){if(!Number.isInteger(x.maxAge))throw new TypeError(`option maxAge is invalid: ${x.maxAge}`);A+="; Max-Age="+x.maxAge}if(x.domain){if(!t.test(x.domain))throw new TypeError(`option domain is invalid: ${x.domain}`);A+="; Domain="+x.domain}if(x.path){if(!n.test(x.path))throw new TypeError(`option path is invalid: ${x.path}`);A+="; Path="+x.path}if(x.expires){if(!E(x.expires)||!Number.isFinite(x.expires.valueOf()))throw new TypeError(`option expires is invalid: ${x.expires}`);A+="; Expires="+x.expires.toUTCString()}if(x.httpOnly&&(A+="; HttpOnly"),x.secure&&(A+="; Secure"),x.partitioned&&(A+="; Partitioned"),x.priority)switch(typeof x.priority=="string"?x.priority.toLowerCase():void 0){case"low":A+="; Priority=Low";break;case"medium":A+="; Priority=Medium";break;case"high":A+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${x.priority}`)}if(x.sameSite)switch(typeof x.sameSite=="string"?x.sameSite.toLowerCase():x.sameSite){case!0:case"strict":A+="; SameSite=Strict";break;case"lax":A+="; SameSite=Lax";break;case"none":A+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${x.sameSite}`)}return A}function p(y){if(y.indexOf("%")===-1)return y;try{return decodeURIComponent(y)}catch{return y}}function E(y){return i.call(y)==="[object Date]"}return dist}requireDist();/**
 * react-router v7.1.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var PopStateEventType="popstate";function createBrowserHistory(e={}){function r(n,i){let{pathname:l,search:c,hash:f}=n.location;return createLocation("",{pathname:l,search:c,hash:f},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(n,i){return typeof i=="string"?i:createPath(i)}return getUrlBasedHistory(r,t,null,e)}function invariant(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function warning(e,r){if(!e){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function createKey(){return Math.random().toString(36).substring(2,10)}function getHistoryState(e,r){return{usr:e.state,key:e.key,idx:r}}function createLocation(e,r,t=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof r=="string"?parsePath(r):r,state:t,key:r&&r.key||n||createKey()}}function createPath({pathname:e="/",search:r="",hash:t=""}){return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function parsePath(e){let r={};if(e){let t=e.indexOf("#");t>=0&&(r.hash=e.substring(t),e=e.substring(0,t));let n=e.indexOf("?");n>=0&&(r.search=e.substring(n),e=e.substring(0,n)),e&&(r.pathname=e)}return r}function getUrlBasedHistory(e,r,t,n={}){let{window:i=document.defaultView,v5Compat:l=!1}=n,c=i.history,f="POP",d=null,h=p();h==null&&(h=0,c.replaceState({...c.state,idx:h},""));function p(){return(c.state||{idx:null}).idx}function E(){f="POP";let m=p(),A=m==null?null:m-h;h=m,d&&d({action:f,location:g.location,delta:A})}function y(m,A){f="PUSH";let O=createLocation(g.location,m,A);h=p()+1;let C=getHistoryState(O,h),R=g.createHref(O);try{c.pushState(C,"",R)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;i.location.assign(R)}l&&d&&d({action:f,location:g.location,delta:1})}function S(m,A){f="REPLACE";let O=createLocation(g.location,m,A);h=p();let C=getHistoryState(O,h),R=g.createHref(O);c.replaceState(C,"",R),l&&d&&d({action:f,location:g.location,delta:0})}function x(m){let A=i.location.origin!=="null"?i.location.origin:i.location.href,O=typeof m=="string"?m:createPath(m);return O=O.replace(/ $/,"%20"),invariant(A,`No window.location.(origin|href) available to create URL for href: ${O}`),new URL(O,A)}let g={get action(){return f},get location(){return e(i,c)},listen(m){if(d)throw new Error("A history only accepts one active listener");return i.addEventListener(PopStateEventType,E),d=m,()=>{i.removeEventListener(PopStateEventType,E),d=null}},createHref(m){return r(i,m)},createURL:x,encodeLocation(m){let A=x(m);return{pathname:A.pathname,search:A.search,hash:A.hash}},push:y,replace:S,go(m){return c.go(m)}};return g}function matchRoutes(e,r,t="/"){return matchRoutesImpl(e,r,t,!1)}function matchRoutesImpl(e,r,t,n){let i=typeof r=="string"?parsePath(r):r,l=stripBasename(i.pathname||"/",t);if(l==null)return null;let c=flattenRoutes(e);rankRouteBranches(c);let f=null;for(let d=0;f==null&&d<c.length;++d){let h=decodePath(l);f=matchRouteBranch(c[d],h,n)}return f}function flattenRoutes(e,r=[],t=[],n=""){let i=(l,c,f)=>{let d={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};d.relativePath.startsWith("/")&&(invariant(d.relativePath.startsWith(n),`Absolute route path "${d.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(n.length));let h=joinPaths([n,d.relativePath]),p=t.concat(d);l.children&&l.children.length>0&&(invariant(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),flattenRoutes(l.children,r,p,h)),!(l.path==null&&!l.index)&&r.push({path:h,score:computeScore(h,l.index),routesMeta:p})};return e.forEach((l,c)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))i(l,c);else for(let d of explodeOptionalSegments(l.path))i(l,c,d)}),r}function explodeOptionalSegments(e){let r=e.split("/");if(r.length===0)return[];let[t,...n]=r,i=t.endsWith("?"),l=t.replace(/\?$/,"");if(n.length===0)return i?[l,""]:[l];let c=explodeOptionalSegments(n.join("/")),f=[];return f.push(...c.map(d=>d===""?l:[l,d].join("/"))),i&&f.push(...c),f.map(d=>e.startsWith("/")&&d===""?"/":d)}function rankRouteBranches(e){e.sort((r,t)=>r.score!==t.score?t.score-r.score:compareIndexes(r.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=e=>e==="*";function computeScore(e,r){let t=e.split("/"),n=t.length;return t.some(isSplat)&&(n+=splatPenalty),r&&(n+=indexRouteValue),t.filter(i=>!isSplat(i)).reduce((i,l)=>i+(paramRe.test(l)?dynamicSegmentValue:l===""?emptySegmentValue:staticSegmentValue),n)}function compareIndexes(e,r){return e.length===r.length&&e.slice(0,-1).every((n,i)=>n===r[i])?e[e.length-1]-r[r.length-1]:0}function matchRouteBranch(e,r,t=!1){let{routesMeta:n}=e,i={},l="/",c=[];for(let f=0;f<n.length;++f){let d=n[f],h=f===n.length-1,p=l==="/"?r:r.slice(l.length)||"/",E=matchPath({path:d.relativePath,caseSensitive:d.caseSensitive,end:h},p),y=d.route;if(!E&&h&&t&&!n[n.length-1].route.index&&(E=matchPath({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},p)),!E)return null;Object.assign(i,E.params),c.push({params:i,pathname:joinPaths([l,E.pathname]),pathnameBase:normalizePathname(joinPaths([l,E.pathnameBase])),route:y}),E.pathnameBase!=="/"&&(l=joinPaths([l,E.pathnameBase]))}return c}function matchPath(e,r){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,n]=compilePath(e.path,e.caseSensitive,e.end),i=r.match(t);if(!i)return null;let l=i[0],c=l.replace(/(.)\/+$/,"$1"),f=i.slice(1);return{params:n.reduce((h,{paramName:p,isOptional:E},y)=>{if(p==="*"){let x=f[y]||"";c=l.slice(0,l.length-x.length).replace(/(.)\/+$/,"$1")}const S=f[y];return E&&!S?h[p]=void 0:h[p]=(S||"").replace(/%2F/g,"/"),h},{}),pathname:l,pathnameBase:c,pattern:e}}function compilePath(e,r=!1,t=!0){warning(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,f,d)=>(n.push({paramName:f,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,r?void 0:"i"),n]}function decodePath(e){try{return e.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return warning(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${r}).`),e}}function stripBasename(e,r){if(r==="/")return e;if(!e.toLowerCase().startsWith(r.toLowerCase()))return null;let t=r.endsWith("/")?r.length-1:r.length,n=e.charAt(t);return n&&n!=="/"?null:e.slice(t)||"/"}function resolvePath(e,r="/"){let{pathname:t,search:n="",hash:i=""}=typeof e=="string"?parsePath(e):e;return{pathname:t?t.startsWith("/")?t:resolvePathname(t,r):r,search:normalizeSearch(n),hash:normalizeHash(i)}}function resolvePathname(e,r){let t=r.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function getInvalidPathError(e,r,t,n){return`Cannot include a '${e}' character in a manually specified \`to.${r}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function getPathContributingMatches(e){return e.filter((r,t)=>t===0||r.route.path&&r.route.path.length>0)}function getResolveToMatches(e){let r=getPathContributingMatches(e);return r.map((t,n)=>n===r.length-1?t.pathname:t.pathnameBase)}function resolveTo(e,r,t,n=!1){let i;typeof e=="string"?i=parsePath(e):(i={...e},invariant(!i.pathname||!i.pathname.includes("?"),getInvalidPathError("?","pathname","search",i)),invariant(!i.pathname||!i.pathname.includes("#"),getInvalidPathError("#","pathname","hash",i)),invariant(!i.search||!i.search.includes("#"),getInvalidPathError("#","search","hash",i)));let l=e===""||i.pathname==="",c=l?"/":i.pathname,f;if(c==null)f=t;else{let E=r.length-1;if(!n&&c.startsWith("..")){let y=c.split("/");for(;y[0]==="..";)y.shift(),E-=1;i.pathname=y.join("/")}f=E>=0?r[E]:"/"}let d=resolvePath(i,f),h=c&&c!=="/"&&c.endsWith("/"),p=(l||c===".")&&t.endsWith("/");return!d.pathname.endsWith("/")&&(h||p)&&(d.pathname+="/"),d}var joinPaths=e=>e.join("/").replace(/\/\/+/g,"/"),normalizePathname=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,normalizeHash=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function isRouteErrorResponse(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var validMutationMethodsArr=["POST","PUT","PATCH","DELETE"];new Set(validMutationMethodsArr);var validRequestMethodsArr=["GET",...validMutationMethodsArr];new Set(validRequestMethodsArr);var DataRouterContext=reactExports.createContext(null);DataRouterContext.displayName="DataRouter";var DataRouterStateContext=reactExports.createContext(null);DataRouterStateContext.displayName="DataRouterState";var ViewTransitionContext=reactExports.createContext({isTransitioning:!1});ViewTransitionContext.displayName="ViewTransition";var FetchersContext=reactExports.createContext(new Map);FetchersContext.displayName="Fetchers";var AwaitContext=reactExports.createContext(null);AwaitContext.displayName="Await";var NavigationContext=reactExports.createContext(null);NavigationContext.displayName="Navigation";var LocationContext=reactExports.createContext(null);LocationContext.displayName="Location";var RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1});RouteContext.displayName="Route";var RouteErrorContext=reactExports.createContext(null);RouteErrorContext.displayName="RouteError";function useHref(e,{relative:r}={}){invariant(useInRouterContext(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=reactExports.useContext(NavigationContext),{hash:i,pathname:l,search:c}=useResolvedPath(e,{relative:r}),f=l;return t!=="/"&&(f=l==="/"?t:joinPaths([t,l])),n.createHref({pathname:f,search:c,hash:i})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return invariant(useInRouterContext(),"useLocation() may be used only in the context of a <Router> component."),reactExports.useContext(LocationContext).location}var navigateEffectWarning="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function useIsomorphicLayoutEffect(e){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(e)}function useNavigate(){let{isDataRoute:e}=reactExports.useContext(RouteContext);return e?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){invariant(useInRouterContext(),"useNavigate() may be used only in the context of a <Router> component.");let e=reactExports.useContext(DataRouterContext),{basename:r,navigator:t}=reactExports.useContext(NavigationContext),{matches:n}=reactExports.useContext(RouteContext),{pathname:i}=useLocation(),l=JSON.stringify(getResolveToMatches(n)),c=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{c.current=!0}),reactExports.useCallback((d,h={})=>{if(warning(c.current,navigateEffectWarning),!c.current)return;if(typeof d=="number"){t.go(d);return}let p=resolveTo(d,JSON.parse(l),i,h.relative==="path");e==null&&r!=="/"&&(p.pathname=p.pathname==="/"?r:joinPaths([r,p.pathname])),(h.replace?t.replace:t.push)(p,h.state,h)},[r,t,l,i,e])}reactExports.createContext(null);function useResolvedPath(e,{relative:r}={}){let{matches:t}=reactExports.useContext(RouteContext),{pathname:n}=useLocation(),i=JSON.stringify(getResolveToMatches(t));return reactExports.useMemo(()=>resolveTo(e,JSON.parse(i),n,r==="path"),[e,i,n,r])}function useRoutesImpl(e,r,t,n){invariant(useInRouterContext(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=reactExports.useContext(NavigationContext),{matches:l}=reactExports.useContext(RouteContext),c=l[l.length-1],f=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",p=c&&c.route;{let A=p&&p.path||"";warningOnce(d,!p||A.endsWith("*")||A.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${A}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${A}"> to <Route path="${A==="/"?"*":`${A}/*`}">.`)}let E=useLocation(),y;y=E;let S=y.pathname||"/",x=S;if(h!=="/"){let A=h.replace(/^\//,"").split("/");x="/"+S.replace(/^\//,"").split("/").slice(A.length).join("/")}let g=matchRoutes(e,{pathname:x});return warning(p||g!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),warning(g==null||g[g.length-1].route.element!==void 0||g[g.length-1].route.Component!==void 0||g[g.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),_renderMatches(g&&g.map(A=>Object.assign({},A,{params:Object.assign({},f,A.params),pathname:joinPaths([h,i.encodeLocation?i.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?h:joinPaths([h,i.encodeLocation?i.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),l,t,n)}function DefaultErrorComponent(){let e=useRouteError(),r=isRouteErrorResponse(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},l={padding:"2px 4px",backgroundColor:n},c=null;return console.error("Error handled by React Router default ErrorBoundary:",e),c=reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("p",null," Hey developer "),reactExports.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",reactExports.createElement("code",{style:l},"ErrorBoundary")," or"," ",reactExports.createElement("code",{style:l},"errorElement")," prop on your route.")),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},r),t?reactExports.createElement("pre",{style:i},t):null,c)}var defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null),RenderErrorBoundary=class extends reactExports.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function RenderedRoute({routeContext:e,match:r,children:t}){let n=reactExports.useContext(DataRouterContext);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),reactExports.createElement(RouteContext.Provider,{value:e},t)}function _renderMatches(e,r=[],t=null,n=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(r.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let i=e,l=t==null?void 0:t.errors;if(l!=null){let d=i.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);invariant(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),i=i.slice(0,Math.min(i.length,d+1))}let c=!1,f=-1;if(t)for(let d=0;d<i.length;d++){let h=i[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(f=d),h.route.id){let{loaderData:p,errors:E}=t,y=h.route.loader&&!p.hasOwnProperty(h.route.id)&&(!E||E[h.route.id]===void 0);if(h.route.lazy||y){c=!0,f>=0?i=i.slice(0,f+1):i=[i[0]];break}}}return i.reduceRight((d,h,p)=>{let E,y=!1,S=null,x=null;t&&(E=l&&h.route.id?l[h.route.id]:void 0,S=h.route.errorElement||defaultErrorElement,c&&(f<0&&p===0?(warningOnce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,x=null):f===p&&(y=!0,x=h.route.hydrateFallbackElement||null)));let g=r.concat(i.slice(0,p+1)),m=()=>{let A;return E?A=S:y?A=x:h.route.Component?A=reactExports.createElement(h.route.Component,null):h.route.element?A=h.route.element:A=d,reactExports.createElement(RenderedRoute,{match:h,routeContext:{outlet:d,matches:g,isDataRoute:t!=null},children:A})};return t&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?reactExports.createElement(RenderErrorBoundary,{location:t.location,revalidation:t.revalidation,component:S,error:E,children:m(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):m()},null)}function getDataRouterConsoleError(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext(e){let r=reactExports.useContext(DataRouterContext);return invariant(r,getDataRouterConsoleError(e)),r}function useDataRouterState(e){let r=reactExports.useContext(DataRouterStateContext);return invariant(r,getDataRouterConsoleError(e)),r}function useRouteContext(e){let r=reactExports.useContext(RouteContext);return invariant(r,getDataRouterConsoleError(e)),r}function useCurrentRouteId(e){let r=useRouteContext(e),t=r.matches[r.matches.length-1];return invariant(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function useRouteId(){return useCurrentRouteId("useRouteId")}function useRouteError(){var n;let e=reactExports.useContext(RouteErrorContext),r=useDataRouterState("useRouteError"),t=useCurrentRouteId("useRouteError");return e!==void 0?e:(n=r.errors)==null?void 0:n[t]}function useNavigateStable(){let{router:e}=useDataRouterContext("useNavigate"),r=useCurrentRouteId("useNavigate"),t=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{t.current=!0}),reactExports.useCallback(async(i,l={})=>{warning(t.current,navigateEffectWarning),t.current&&(typeof i=="number"?e.navigate(i):await e.navigate(i,{fromRouteId:r,...l}))},[e,r])}var alreadyWarned={};function warningOnce(e,r,t){!r&&!alreadyWarned[e]&&(alreadyWarned[e]=!0,warning(!1,t))}reactExports.memo(DataRoutes);function DataRoutes({routes:e,future:r,state:t}){return useRoutesImpl(e,void 0,t,r)}function Router({basename:e="/",children:r=null,location:t,navigationType:n="POP",navigator:i,static:l=!1}){invariant(!useInRouterContext(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=e.replace(/^\/*/,"/"),f=reactExports.useMemo(()=>({basename:c,navigator:i,static:l,future:{}}),[c,i,l]);typeof t=="string"&&(t=parsePath(t));let{pathname:d="/",search:h="",hash:p="",state:E=null,key:y="default"}=t,S=reactExports.useMemo(()=>{let x=stripBasename(d,c);return x==null?null:{location:{pathname:x,search:h,hash:p,state:E,key:y},navigationType:n}},[c,d,h,p,E,y,n]);return warning(S!=null,`<Router basename="${c}"> is not able to match the URL "${d}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:reactExports.createElement(NavigationContext.Provider,{value:f},reactExports.createElement(LocationContext.Provider,{children:r,value:S}))}var defaultMethod="get",defaultEncType="application/x-www-form-urlencoded";function isHtmlElement(e){return e!=null&&typeof e.tagName=="string"}function isButtonElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="button"}function isFormElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="form"}function isInputElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="input"}function isModifiedEvent(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function shouldProcessLinkClick(e,r){return e.button===0&&(!r||r==="_self")&&!isModifiedEvent(e)}var _formDataSupportsSubmitter=null;function isFormDataSubmitterSupported(){if(_formDataSupportsSubmitter===null)try{new FormData(document.createElement("form"),0),_formDataSupportsSubmitter=!1}catch{_formDataSupportsSubmitter=!0}return _formDataSupportsSubmitter}var supportedFormEncTypes=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function getFormEncType(e){return e!=null&&!supportedFormEncTypes.has(e)?(warning(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${defaultEncType}"`),null):e}function getFormSubmissionInfo(e,r){let t,n,i,l,c;if(isFormElement(e)){let f=e.getAttribute("action");n=f?stripBasename(f,r):null,t=e.getAttribute("method")||defaultMethod,i=getFormEncType(e.getAttribute("enctype"))||defaultEncType,l=new FormData(e)}else if(isButtonElement(e)||isInputElement(e)&&(e.type==="submit"||e.type==="image")){let f=e.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=e.getAttribute("formaction")||f.getAttribute("action");if(n=d?stripBasename(d,r):null,t=e.getAttribute("formmethod")||f.getAttribute("method")||defaultMethod,i=getFormEncType(e.getAttribute("formenctype"))||getFormEncType(f.getAttribute("enctype"))||defaultEncType,l=new FormData(f,e),!isFormDataSubmitterSupported()){let{name:h,type:p,value:E}=e;if(p==="image"){let y=h?`${h}.`:"";l.append(`${y}x`,"0"),l.append(`${y}y`,"0")}else h&&l.append(h,E)}}else{if(isHtmlElement(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=defaultMethod,n=null,i=defaultEncType,c=e}return l&&i==="text/plain"&&(c=l,l=void 0),{action:n,method:t.toLowerCase(),encType:i,formData:l,body:c}}function invariant2(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}async function loadRouteModule(e,r){if(e.id in r)return r[e.id];try{let t=await import(e.module);return r[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function isHtmlLinkDescriptor(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function getKeyedPrefetchLinks(e,r,t){let n=await Promise.all(e.map(async i=>{let l=r.routes[i.route.id];if(l){let c=await loadRouteModule(l,t);return c.links?c.links():[]}return[]}));return dedupeLinkDescriptors(n.flat(1).filter(isHtmlLinkDescriptor).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function getNewMatchesForLinks(e,r,t,n,i,l){let c=(d,h)=>t[h]?d.route.id!==t[h].route.id:!0,f=(d,h)=>{var p;return t[h].pathname!==d.pathname||((p=t[h].route.path)==null?void 0:p.endsWith("*"))&&t[h].params["*"]!==d.params["*"]};return l==="assets"?r.filter((d,h)=>c(d,h)||f(d,h)):l==="data"?r.filter((d,h)=>{var E;let p=n.routes[d.route.id];if(!p||!p.hasLoader)return!1;if(c(d,h)||f(d,h))return!0;if(d.route.shouldRevalidate){let y=d.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((E=t[0])==null?void 0:E.params)||{},nextUrl:new URL(e,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function getModuleLinkHrefs(e,r){return dedupeHrefs(e.map(t=>{let n=r.routes[t.route.id];if(!n)return[];let i=[n.module];return n.imports&&(i=i.concat(n.imports)),i}).flat(1))}function dedupeHrefs(e){return[...new Set(e)]}function sortKeys(e){let r={},t=Object.keys(e).sort();for(let n of t)r[n]=e[n];return r}function dedupeLinkDescriptors(e,r){let t=new Set;return new Set(r),e.reduce((n,i)=>{let l=JSON.stringify(sortKeys(i));return t.has(l)||(t.add(l),n.push({key:l,link:i})),n},[])}function singleFetchUrl(e){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname="_root.data":r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function useDataRouterContext2(){let e=reactExports.useContext(DataRouterContext);return invariant2(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function useDataRouterStateContext(){let e=reactExports.useContext(DataRouterStateContext);return invariant2(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var FrameworkContext=reactExports.createContext(void 0);FrameworkContext.displayName="FrameworkContext";function useFrameworkContext(){let e=reactExports.useContext(FrameworkContext);return invariant2(e,"You must render this element inside a <HydratedRouter> element"),e}function usePrefetchBehavior(e,r){let t=reactExports.useContext(FrameworkContext),[n,i]=reactExports.useState(!1),[l,c]=reactExports.useState(!1),{onFocus:f,onBlur:d,onMouseEnter:h,onMouseLeave:p,onTouchStart:E}=r,y=reactExports.useRef(null);reactExports.useEffect(()=>{if(e==="render"&&c(!0),e==="viewport"){let g=A=>{A.forEach(O=>{c(O.isIntersecting)})},m=new IntersectionObserver(g,{threshold:.5});return y.current&&m.observe(y.current),()=>{m.disconnect()}}},[e]),reactExports.useEffect(()=>{if(n){let g=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(g)}}},[n]);let S=()=>{i(!0)},x=()=>{i(!1),c(!1)};return t?e!=="intent"?[l,y,{}]:[l,y,{onFocus:composeEventHandlers(f,S),onBlur:composeEventHandlers(d,x),onMouseEnter:composeEventHandlers(h,S),onMouseLeave:composeEventHandlers(p,x),onTouchStart:composeEventHandlers(E,S)}]:[!1,y,{}]}function composeEventHandlers(e,r){return t=>{e&&e(t),t.defaultPrevented||r(t)}}function PrefetchPageLinks({page:e,...r}){let{router:t}=useDataRouterContext2(),n=reactExports.useMemo(()=>matchRoutes(t.routes,e,t.basename),[t.routes,e,t.basename]);return n?reactExports.createElement(PrefetchPageLinksImpl,{page:e,matches:n,...r}):null}function useKeyedPrefetchLinks(e){let{manifest:r,routeModules:t}=useFrameworkContext(),[n,i]=reactExports.useState([]);return reactExports.useEffect(()=>{let l=!1;return getKeyedPrefetchLinks(e,r,t).then(c=>{l||i(c)}),()=>{l=!0}},[e,r,t]),n}function PrefetchPageLinksImpl({page:e,matches:r,...t}){let n=useLocation(),{manifest:i,routeModules:l}=useFrameworkContext(),{loaderData:c,matches:f}=useDataRouterStateContext(),d=reactExports.useMemo(()=>getNewMatchesForLinks(e,r,f,i,n,"data"),[e,r,f,i,n]),h=reactExports.useMemo(()=>getNewMatchesForLinks(e,r,f,i,n,"assets"),[e,r,f,i,n]),p=reactExports.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let S=new Set,x=!1;if(r.forEach(m=>{var O;let A=i.routes[m.route.id];!A||!A.hasLoader||(!d.some(C=>C.route.id===m.route.id)&&m.route.id in c&&((O=l[m.route.id])!=null&&O.shouldRevalidate)||A.hasClientLoader?x=!0:S.add(m.route.id))}),S.size===0)return[];let g=singleFetchUrl(e);return x&&S.size>0&&g.searchParams.set("_routes",r.filter(m=>S.has(m.route.id)).map(m=>m.route.id).join(",")),[g.pathname+g.search]},[c,n,i,d,r,e,l]),E=reactExports.useMemo(()=>getModuleLinkHrefs(h,i),[h,i]),y=useKeyedPrefetchLinks(h);return reactExports.createElement(reactExports.Fragment,null,p.map(S=>reactExports.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...t})),E.map(S=>reactExports.createElement("link",{key:S,rel:"modulepreload",href:S,...t})),y.map(({key:S,link:x})=>reactExports.createElement("link",{key:S,...x})))}function mergeRefs(...e){return r=>{e.forEach(t=>{typeof t=="function"?t(r):t!=null&&(t.current=r)})}}var isBrowser$1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{isBrowser$1&&(window.__reactRouterVersion="7.1.3")}catch{}function BrowserRouter({basename:e,children:r,window:t}){let n=reactExports.useRef();n.current==null&&(n.current=createBrowserHistory({window:t,v5Compat:!0}));let i=n.current,[l,c]=reactExports.useState({action:i.action,location:i.location}),f=reactExports.useCallback(d=>{reactExports.startTransition(()=>c(d))},[c]);return reactExports.useLayoutEffect(()=>i.listen(f),[i,f]),reactExports.createElement(Router,{basename:e,children:r,location:l.location,navigationType:l.action,navigator:i})}var ABSOLUTE_URL_REGEX2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function({onClick:r,discover:t="render",prefetch:n="none",relative:i,reloadDocument:l,replace:c,state:f,target:d,to:h,preventScrollReset:p,viewTransition:E,...y},S){let{basename:x}=reactExports.useContext(NavigationContext),g=typeof h=="string"&&ABSOLUTE_URL_REGEX2.test(h),m,A=!1;if(typeof h=="string"&&g&&(m=h,isBrowser$1))try{let M=new URL(window.location.href),X=h.startsWith("//")?new URL(M.protocol+h):new URL(h),H=stripBasename(X.pathname,x);X.origin===M.origin&&H!=null?h=H+X.search+X.hash:A=!0}catch{warning(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let O=useHref(h,{relative:i}),[C,R,T]=usePrefetchBehavior(n,y),w=useLinkClickHandler(h,{replace:c,state:f,target:d,preventScrollReset:p,relative:i,viewTransition:E});function v(M){r&&r(M),M.defaultPrevented||w(M)}let L=reactExports.createElement("a",{...y,...T,href:m||O,onClick:A||l?r:v,ref:mergeRefs(S,R),target:d,"data-discover":!g&&t==="render"?"true":void 0});return C&&!g?reactExports.createElement(reactExports.Fragment,null,L,reactExports.createElement(PrefetchPageLinks,{page:O})):L});Link.displayName="Link";var NavLink=reactExports.forwardRef(function({"aria-current":r="page",caseSensitive:t=!1,className:n="",end:i=!1,style:l,to:c,viewTransition:f,children:d,...h},p){let E=useResolvedPath(c,{relative:h.relative}),y=useLocation(),S=reactExports.useContext(DataRouterStateContext),{navigator:x,basename:g}=reactExports.useContext(NavigationContext),m=S!=null&&useViewTransitionState(E)&&f===!0,A=x.encodeLocation?x.encodeLocation(E).pathname:E.pathname,O=y.pathname,C=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;t||(O=O.toLowerCase(),C=C?C.toLowerCase():null,A=A.toLowerCase()),C&&g&&(C=stripBasename(C,g)||C);const R=A!=="/"&&A.endsWith("/")?A.length-1:A.length;let T=O===A||!i&&O.startsWith(A)&&O.charAt(R)==="/",w=C!=null&&(C===A||!i&&C.startsWith(A)&&C.charAt(A.length)==="/"),v={isActive:T,isPending:w,isTransitioning:m},L=T?r:void 0,M;typeof n=="function"?M=n(v):M=[n,T?"active":null,w?"pending":null,m?"transitioning":null].filter(Boolean).join(" ");let X=typeof l=="function"?l(v):l;return reactExports.createElement(Link,{...h,"aria-current":L,className:M,ref:p,style:X,to:c,viewTransition:f},typeof d=="function"?d(v):d)});NavLink.displayName="NavLink";var Form=reactExports.forwardRef(({discover:e="render",fetcherKey:r,navigate:t,reloadDocument:n,replace:i,state:l,method:c=defaultMethod,action:f,onSubmit:d,relative:h,preventScrollReset:p,viewTransition:E,...y},S)=>{let x=useSubmit(),g=useFormAction(f,{relative:h}),m=c.toLowerCase()==="get"?"get":"post",A=typeof f=="string"&&ABSOLUTE_URL_REGEX2.test(f),O=C=>{if(d&&d(C),C.defaultPrevented)return;C.preventDefault();let R=C.nativeEvent.submitter,T=(R==null?void 0:R.getAttribute("formmethod"))||c;x(R||C.currentTarget,{fetcherKey:r,method:T,navigate:t,replace:i,state:l,relative:h,preventScrollReset:p,viewTransition:E})};return reactExports.createElement("form",{ref:S,method:m,action:g,onSubmit:n?d:O,...y,"data-discover":!A&&e==="render"?"true":void 0})});Form.displayName="Form";function getDataRouterConsoleError2(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext3(e){let r=reactExports.useContext(DataRouterContext);return invariant(r,getDataRouterConsoleError2(e)),r}function useLinkClickHandler(e,{target:r,replace:t,state:n,preventScrollReset:i,relative:l,viewTransition:c}={}){let f=useNavigate(),d=useLocation(),h=useResolvedPath(e,{relative:l});return reactExports.useCallback(p=>{if(shouldProcessLinkClick(p,r)){p.preventDefault();let E=t!==void 0?t:createPath(d)===createPath(h);f(e,{replace:E,state:n,preventScrollReset:i,relative:l,viewTransition:c})}},[d,f,h,t,n,r,e,i,l,c])}var fetcherId=0,getUniqueFetcherId=()=>`__${String(++fetcherId)}__`;function useSubmit(){let{router:e}=useDataRouterContext3("useSubmit"),{basename:r}=reactExports.useContext(NavigationContext),t=useRouteId();return reactExports.useCallback(async(n,i={})=>{let{action:l,method:c,encType:f,formData:d,body:h}=getFormSubmissionInfo(n,r);if(i.navigate===!1){let p=i.fetcherKey||getUniqueFetcherId();await e.fetch(p,t,i.action||l,{preventScrollReset:i.preventScrollReset,formData:d,body:h,formMethod:i.method||c,formEncType:i.encType||f,flushSync:i.flushSync})}else await e.navigate(i.action||l,{preventScrollReset:i.preventScrollReset,formData:d,body:h,formMethod:i.method||c,formEncType:i.encType||f,replace:i.replace,state:i.state,fromRouteId:t,flushSync:i.flushSync,viewTransition:i.viewTransition})},[e,r,t])}function useFormAction(e,{relative:r}={}){let{basename:t}=reactExports.useContext(NavigationContext),n=reactExports.useContext(RouteContext);invariant(n,"useFormAction must be used inside a RouteContext");let[i]=n.matches.slice(-1),l={...useResolvedPath(e||".",{relative:r})},c=useLocation();if(e==null){l.search=c.search;let f=new URLSearchParams(l.search),d=f.getAll("index");if(d.some(p=>p==="")){f.delete("index"),d.filter(E=>E).forEach(E=>f.append("index",E));let p=f.toString();l.search=p?`?${p}`:""}}return(!e||e===".")&&i.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(l.pathname=l.pathname==="/"?t:joinPaths([t,l.pathname])),createPath(l)}function useViewTransitionState(e,r={}){let t=reactExports.useContext(ViewTransitionContext);invariant(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=useDataRouterContext3("useViewTransitionState"),i=useResolvedPath(e,{relative:r.relative});if(!t.isTransitioning)return!1;let l=stripBasename(t.currentLocation.pathname,n)||t.currentLocation.pathname,c=stripBasename(t.nextLocation.pathname,n)||t.nextLocation.pathname;return matchPath(i.pathname,c)!=null||matchPath(i.pathname,l)!=null}new TextEncoder;const scriptRel="modulepreload",assetsURL=function(e){return"/"+e},seen={},__vitePreload=function(r,t,n){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),f=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));i=Promise.allSettled(t.map(d=>{if(d=assetsURL(d),d in seen)return;seen[d]=!0;const h=d.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${p}`))return;const E=document.createElement("link");if(E.rel=h?"stylesheet":scriptRel,h||(E.as="script"),E.crossOrigin="",E.href=d,f&&E.setAttribute("nonce",f),document.head.appendChild(E),h)return new Promise((y,S)=>{E.addEventListener("load",y),E.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${d}`)))})}))}function l(c){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=c,window.dispatchEvent(f),!f.defaultPrevented)throw c}return i.then(c=>{for(const f of c||[])f.status==="rejected"&&l(f.reason);return r().catch(l)})},resolveFetch$3=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>__vitePreload(async()=>{const{default:n}=await Promise.resolve().then(()=>browser);return{default:n}},[]).then(({default:n})=>n(...t)):r=fetch,(...t)=>r(...t)};class FunctionsError extends Error{constructor(r,t="FunctionsError",n){super(r),this.name=t,this.context=n}}class FunctionsFetchError extends FunctionsError{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class FunctionsRelayError extends FunctionsError{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class FunctionsHttpError extends FunctionsError{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var FunctionRegion;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(FunctionRegion||(FunctionRegion={}));var __awaiter$7=function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(p){try{h(n.next(p))}catch(E){c(E)}}function d(p){try{h(n.throw(p))}catch(E){c(E)}}function h(p){p.done?l(p.value):i(p.value).then(f,d)}h((n=n.apply(e,r||[])).next())})};class FunctionsClient{constructor(r,{headers:t={},customFetch:n,region:i=FunctionRegion.Any}={}){this.url=r,this.headers=t,this.region=i,this.fetch=resolveFetch$3(n)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r,t={}){var n;return __awaiter$7(this,void 0,void 0,function*(){try{const{headers:i,method:l,body:c}=t;let f={},{region:d}=t;d||(d=this.region),d&&d!=="any"&&(f["x-region"]=d);let h;c&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",h=c):typeof c=="string"?(f["Content-Type"]="text/plain",h=c):typeof FormData<"u"&&c instanceof FormData?h=c:(f["Content-Type"]="application/json",h=JSON.stringify(c)));const p=yield this.fetch(`${this.url}/${r}`,{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),i),body:h}).catch(x=>{throw new FunctionsFetchError(x)}),E=p.headers.get("x-relay-error");if(E&&E==="true")throw new FunctionsRelayError(p);if(!p.ok)throw new FunctionsHttpError(p);let y=((n=p.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),S;return y==="application/json"?S=yield p.json():y==="application/octet-stream"?S=yield p.blob():y==="text/event-stream"?S=p:y==="multipart/form-data"?S=yield p.formData():S=yield p.text(),{data:S,error:null}}catch(i){return{data:null,error:i}}})}}var cjs={},PostgrestClient$1={},PostgrestQueryBuilder$1={},PostgrestFilterBuilder$1={},PostgrestTransformBuilder$1={},PostgrestBuilder$1={},getGlobal=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},globalObject=getGlobal();const fetch$1=globalObject.fetch,nodeFetch=globalObject.fetch.bind(globalObject),Headers$1=globalObject.Headers,Request=globalObject.Request,Response$1=globalObject.Response,browser=Object.freeze(Object.defineProperty({__proto__:null,Headers:Headers$1,Request,Response:Response$1,default:nodeFetch,fetch:fetch$1},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(browser);var PostgrestError$1={},hasRequiredPostgrestError;function requirePostgrestError(){if(hasRequiredPostgrestError)return PostgrestError$1;hasRequiredPostgrestError=1,Object.defineProperty(PostgrestError$1,"__esModule",{value:!0});class e extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return PostgrestError$1.default=e,PostgrestError$1}var hasRequiredPostgrestBuilder;function requirePostgrestBuilder(){if(hasRequiredPostgrestBuilder)return PostgrestBuilder$1;hasRequiredPostgrestBuilder=1;var e=PostgrestBuilder$1.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(PostgrestBuilder$1,"__esModule",{value:!0});const r=e(require$$0),t=e(requirePostgrestError());class n{constructor(l){this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=l.headers,this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=l.shouldThrowOnError,this.signal=l.signal,this.isMaybeSingle=l.isMaybeSingle,l.fetch?this.fetch=l.fetch:typeof fetch>"u"?this.fetch=r.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,c){return this.headers=Object.assign({},this.headers),this.headers[l]=c,this}then(l,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const f=this.fetch;let d=f(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async h=>{var p,E,y;let S=null,x=null,g=null,m=h.status,A=h.statusText;if(h.ok){if(this.method!=="HEAD"){const T=await h.text();T===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?x=T:x=JSON.parse(T))}const C=(p=this.headers.Prefer)===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),R=(E=h.headers.get("content-range"))===null||E===void 0?void 0:E.split("/");C&&R&&R.length>1&&(g=parseInt(R[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(x)&&(x.length>1?(S={code:"PGRST116",details:`Results contain ${x.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},x=null,g=null,m=406,A="Not Acceptable"):x.length===1?x=x[0]:x=null)}else{const C=await h.text();try{S=JSON.parse(C),Array.isArray(S)&&h.status===404&&(x=[],S=null,m=200,A="OK")}catch{h.status===404&&C===""?(m=204,A="No Content"):S={message:C}}if(S&&this.isMaybeSingle&&(!((y=S==null?void 0:S.details)===null||y===void 0)&&y.includes("0 rows"))&&(S=null,m=200,A="OK"),S&&this.shouldThrowOnError)throw new t.default(S)}return{error:S,data:x,count:g,status:m,statusText:A}});return this.shouldThrowOnError||(d=d.catch(h=>{var p,E,y;return{error:{message:`${(p=h==null?void 0:h.name)!==null&&p!==void 0?p:"FetchError"}: ${h==null?void 0:h.message}`,details:`${(E=h==null?void 0:h.stack)!==null&&E!==void 0?E:""}`,hint:"",code:`${(y=h==null?void 0:h.code)!==null&&y!==void 0?y:""}`},data:null,count:null,status:0,statusText:""}})),d.then(l,c)}}return PostgrestBuilder$1.default=n,PostgrestBuilder$1}var hasRequiredPostgrestTransformBuilder;function requirePostgrestTransformBuilder(){if(hasRequiredPostgrestTransformBuilder)return PostgrestTransformBuilder$1;hasRequiredPostgrestTransformBuilder=1;var e=PostgrestTransformBuilder$1.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(PostgrestTransformBuilder$1,"__esModule",{value:!0});const r=e(requirePostgrestBuilder());class t extends r.default{select(i){let l=!1;const c=(i??"*").split("").map(f=>/\s/.test(f)&&!l?"":(f==='"'&&(l=!l),f)).join("");return this.url.searchParams.set("select",c),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(i,{ascending:l=!0,nullsFirst:c,foreignTable:f,referencedTable:d=f}={}){const h=d?`${d}.order`:"order",p=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${p?`${p},`:""}${i}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:l,referencedTable:c=l}={}){const f=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(f,`${i}`),this}range(i,l,{foreignTable:c,referencedTable:f=c}={}){const d=typeof f>"u"?"offset":`${f}.offset`,h=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(d,`${i}`),this.url.searchParams.set(h,`${l-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:i=!1,verbose:l=!1,settings:c=!1,buffers:f=!1,wal:d=!1,format:h="text"}={}){var p;const E=[i?"analyze":null,l?"verbose":null,c?"settings":null,f?"buffers":null,d?"wal":null].filter(Boolean).join("|"),y=(p=this.headers.Accept)!==null&&p!==void 0?p:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${h}; for="${y}"; options=${E};`,h==="json"?this:this}rollback(){var i;return((i=this.headers.Prefer)!==null&&i!==void 0?i:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return PostgrestTransformBuilder$1.default=t,PostgrestTransformBuilder$1}var hasRequiredPostgrestFilterBuilder;function requirePostgrestFilterBuilder(){if(hasRequiredPostgrestFilterBuilder)return PostgrestFilterBuilder$1;hasRequiredPostgrestFilterBuilder=1;var e=PostgrestFilterBuilder$1.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(PostgrestFilterBuilder$1,"__esModule",{value:!0});const r=e(requirePostgrestTransformBuilder());class t extends r.default{eq(i,l){return this.url.searchParams.append(i,`eq.${l}`),this}neq(i,l){return this.url.searchParams.append(i,`neq.${l}`),this}gt(i,l){return this.url.searchParams.append(i,`gt.${l}`),this}gte(i,l){return this.url.searchParams.append(i,`gte.${l}`),this}lt(i,l){return this.url.searchParams.append(i,`lt.${l}`),this}lte(i,l){return this.url.searchParams.append(i,`lte.${l}`),this}like(i,l){return this.url.searchParams.append(i,`like.${l}`),this}likeAllOf(i,l){return this.url.searchParams.append(i,`like(all).{${l.join(",")}}`),this}likeAnyOf(i,l){return this.url.searchParams.append(i,`like(any).{${l.join(",")}}`),this}ilike(i,l){return this.url.searchParams.append(i,`ilike.${l}`),this}ilikeAllOf(i,l){return this.url.searchParams.append(i,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(i,l){return this.url.searchParams.append(i,`ilike(any).{${l.join(",")}}`),this}is(i,l){return this.url.searchParams.append(i,`is.${l}`),this}in(i,l){const c=Array.from(new Set(l)).map(f=>typeof f=="string"&&new RegExp("[,()]").test(f)?`"${f}"`:`${f}`).join(",");return this.url.searchParams.append(i,`in.(${c})`),this}contains(i,l){return typeof l=="string"?this.url.searchParams.append(i,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(i,`cs.{${l.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(l)}`),this}containedBy(i,l){return typeof l=="string"?this.url.searchParams.append(i,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(i,`cd.{${l.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(l)}`),this}rangeGt(i,l){return this.url.searchParams.append(i,`sr.${l}`),this}rangeGte(i,l){return this.url.searchParams.append(i,`nxl.${l}`),this}rangeLt(i,l){return this.url.searchParams.append(i,`sl.${l}`),this}rangeLte(i,l){return this.url.searchParams.append(i,`nxr.${l}`),this}rangeAdjacent(i,l){return this.url.searchParams.append(i,`adj.${l}`),this}overlaps(i,l){return typeof l=="string"?this.url.searchParams.append(i,`ov.${l}`):this.url.searchParams.append(i,`ov.{${l.join(",")}}`),this}textSearch(i,l,{config:c,type:f}={}){let d="";f==="plain"?d="pl":f==="phrase"?d="ph":f==="websearch"&&(d="w");const h=c===void 0?"":`(${c})`;return this.url.searchParams.append(i,`${d}fts${h}.${l}`),this}match(i){return Object.entries(i).forEach(([l,c])=>{this.url.searchParams.append(l,`eq.${c}`)}),this}not(i,l,c){return this.url.searchParams.append(i,`not.${l}.${c}`),this}or(i,{foreignTable:l,referencedTable:c=l}={}){const f=c?`${c}.or`:"or";return this.url.searchParams.append(f,`(${i})`),this}filter(i,l,c){return this.url.searchParams.append(i,`${l}.${c}`),this}}return PostgrestFilterBuilder$1.default=t,PostgrestFilterBuilder$1}var hasRequiredPostgrestQueryBuilder;function requirePostgrestQueryBuilder(){if(hasRequiredPostgrestQueryBuilder)return PostgrestQueryBuilder$1;hasRequiredPostgrestQueryBuilder=1;var e=PostgrestQueryBuilder$1.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(PostgrestQueryBuilder$1,"__esModule",{value:!0});const r=e(requirePostgrestFilterBuilder());class t{constructor(i,{headers:l={},schema:c,fetch:f}){this.url=i,this.headers=l,this.schema=c,this.fetch=f}select(i,{head:l=!1,count:c}={}){const f=l?"HEAD":"GET";let d=!1;const h=(i??"*").split("").map(p=>/\s/.test(p)&&!d?"":(p==='"'&&(d=!d),p)).join("");return this.url.searchParams.set("select",h),c&&(this.headers.Prefer=`count=${c}`),new r.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(i,{count:l,defaultToNull:c=!0}={}){const f="POST",d=[];if(this.headers.Prefer&&d.push(this.headers.Prefer),l&&d.push(`count=${l}`),c||d.push("missing=default"),this.headers.Prefer=d.join(","),Array.isArray(i)){const h=i.reduce((p,E)=>p.concat(Object.keys(E)),[]);if(h.length>0){const p=[...new Set(h)].map(E=>`"${E}"`);this.url.searchParams.set("columns",p.join(","))}}return new r.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}upsert(i,{onConflict:l,ignoreDuplicates:c=!1,count:f,defaultToNull:d=!0}={}){const h="POST",p=[`resolution=${c?"ignore":"merge"}-duplicates`];if(l!==void 0&&this.url.searchParams.set("on_conflict",l),this.headers.Prefer&&p.push(this.headers.Prefer),f&&p.push(`count=${f}`),d||p.push("missing=default"),this.headers.Prefer=p.join(","),Array.isArray(i)){const E=i.reduce((y,S)=>y.concat(Object.keys(S)),[]);if(E.length>0){const y=[...new Set(E)].map(S=>`"${S}"`);this.url.searchParams.set("columns",y.join(","))}}return new r.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}update(i,{count:l}={}){const c="PATCH",f=[];return this.headers.Prefer&&f.push(this.headers.Prefer),l&&f.push(`count=${l}`),this.headers.Prefer=f.join(","),new r.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}delete({count:i}={}){const l="DELETE",c=[];return i&&c.push(`count=${i}`),this.headers.Prefer&&c.unshift(this.headers.Prefer),this.headers.Prefer=c.join(","),new r.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return PostgrestQueryBuilder$1.default=t,PostgrestQueryBuilder$1}var constants={},version$4={},hasRequiredVersion;function requireVersion(){return hasRequiredVersion||(hasRequiredVersion=1,Object.defineProperty(version$4,"__esModule",{value:!0}),version$4.version=void 0,version$4.version="0.0.0-automated"),version$4}var hasRequiredConstants;function requireConstants(){if(hasRequiredConstants)return constants;hasRequiredConstants=1,Object.defineProperty(constants,"__esModule",{value:!0}),constants.DEFAULT_HEADERS=void 0;const e=requireVersion();return constants.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${e.version}`},constants}var hasRequiredPostgrestClient;function requirePostgrestClient(){if(hasRequiredPostgrestClient)return PostgrestClient$1;hasRequiredPostgrestClient=1;var e=PostgrestClient$1.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(PostgrestClient$1,"__esModule",{value:!0});const r=e(requirePostgrestQueryBuilder()),t=e(requirePostgrestFilterBuilder()),n=requireConstants();class i{constructor(c,{headers:f={},schema:d,fetch:h}={}){this.url=c,this.headers=Object.assign(Object.assign({},n.DEFAULT_HEADERS),f),this.schemaName=d,this.fetch=h}from(c){const f=new URL(`${this.url}/${c}`);return new r.default(f,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(c){return new i(this.url,{headers:this.headers,schema:c,fetch:this.fetch})}rpc(c,f={},{head:d=!1,get:h=!1,count:p}={}){let E;const y=new URL(`${this.url}/rpc/${c}`);let S;d||h?(E=d?"HEAD":"GET",Object.entries(f).filter(([g,m])=>m!==void 0).map(([g,m])=>[g,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([g,m])=>{y.searchParams.append(g,m)})):(E="POST",S=f);const x=Object.assign({},this.headers);return p&&(x.Prefer=`count=${p}`),new t.default({method:E,url:y,headers:x,schema:this.schemaName,body:S,fetch:this.fetch,allowEmpty:!1})}}return PostgrestClient$1.default=i,PostgrestClient$1}var hasRequiredCjs;function requireCjs(){if(hasRequiredCjs)return cjs;hasRequiredCjs=1;var e=cjs.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(cjs,"__esModule",{value:!0}),cjs.PostgrestError=cjs.PostgrestBuilder=cjs.PostgrestTransformBuilder=cjs.PostgrestFilterBuilder=cjs.PostgrestQueryBuilder=cjs.PostgrestClient=void 0;const r=e(requirePostgrestClient());cjs.PostgrestClient=r.default;const t=e(requirePostgrestQueryBuilder());cjs.PostgrestQueryBuilder=t.default;const n=e(requirePostgrestFilterBuilder());cjs.PostgrestFilterBuilder=n.default;const i=e(requirePostgrestTransformBuilder());cjs.PostgrestTransformBuilder=i.default;const l=e(requirePostgrestBuilder());cjs.PostgrestBuilder=l.default;const c=e(requirePostgrestError());return cjs.PostgrestError=c.default,cjs.default={PostgrestClient:r.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:i.default,PostgrestBuilder:l.default,PostgrestError:c.default},cjs}var cjsExports=requireCjs();const index=getDefaultExportFromCjs(cjsExports),{PostgrestClient,PostgrestQueryBuilder,PostgrestFilterBuilder,PostgrestTransformBuilder,PostgrestBuilder,PostgrestError}=index,version$3="2.11.2",DEFAULT_HEADERS$3={"X-Client-Info":`realtime-js/${version$3}`},VSN="1.0.0",DEFAULT_TIMEOUT=1e4,WS_CLOSE_NORMAL=1e3;var SOCKET_STATES;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(SOCKET_STATES||(SOCKET_STATES={}));var CHANNEL_STATES;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(CHANNEL_STATES||(CHANNEL_STATES={}));var CHANNEL_EVENTS;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(CHANNEL_EVENTS||(CHANNEL_EVENTS={}));var TRANSPORTS;(function(e){e.websocket="websocket"})(TRANSPORTS||(TRANSPORTS={}));var CONNECTION_STATE;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(CONNECTION_STATE||(CONNECTION_STATE={}));class Serializer{constructor(){this.HEADER_LENGTH=1}decode(r,t){return r.constructor===ArrayBuffer?t(this._binaryDecode(r)):t(typeof r=="string"?JSON.parse(r):{})}_binaryDecode(r){const t=new DataView(r),n=new TextDecoder;return this._decodeBroadcast(r,t,n)}_decodeBroadcast(r,t,n){const i=t.getUint8(1),l=t.getUint8(2);let c=this.HEADER_LENGTH+2;const f=n.decode(r.slice(c,c+i));c=c+i;const d=n.decode(r.slice(c,c+l));c=c+l;const h=JSON.parse(n.decode(r.slice(c,r.byteLength)));return{ref:null,topic:f,event:d,payload:h}}}class Timer{constructor(r,t){this.callback=r,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var PostgresTypes;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(PostgresTypes||(PostgresTypes={}));const convertChangeData=(e,r,t={})=>{var n;const i=(n=t.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(r).reduce((l,c)=>(l[c]=convertColumn(c,e,r,i),l),{})},convertColumn=(e,r,t,n)=>{const i=r.find(f=>f.name===e),l=i==null?void 0:i.type,c=t[e];return l&&!n.includes(l)?convertCell(l,c):noop$1(c)},convertCell=(e,r)=>{if(e.charAt(0)==="_"){const t=e.slice(1,e.length);return toArray(r,t)}switch(e){case PostgresTypes.bool:return toBoolean(r);case PostgresTypes.float4:case PostgresTypes.float8:case PostgresTypes.int2:case PostgresTypes.int4:case PostgresTypes.int8:case PostgresTypes.numeric:case PostgresTypes.oid:return toNumber(r);case PostgresTypes.json:case PostgresTypes.jsonb:return toJson(r);case PostgresTypes.timestamp:return toTimestampString(r);case PostgresTypes.abstime:case PostgresTypes.date:case PostgresTypes.daterange:case PostgresTypes.int4range:case PostgresTypes.int8range:case PostgresTypes.money:case PostgresTypes.reltime:case PostgresTypes.text:case PostgresTypes.time:case PostgresTypes.timestamptz:case PostgresTypes.timetz:case PostgresTypes.tsrange:case PostgresTypes.tstzrange:return noop$1(r);default:return noop$1(r)}},noop$1=e=>e,toBoolean=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},toNumber=e=>{if(typeof e=="string"){const r=parseFloat(e);if(!Number.isNaN(r))return r}return e},toJson=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(r){return console.log(`JSON parse error: ${r}`),e}return e},toArray=(e,r)=>{if(typeof e!="string")return e;const t=e.length-1,n=e[t];if(e[0]==="{"&&n==="}"){let l;const c=e.slice(1,t);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(f=>convertCell(r,f))}return e},toTimestampString=e=>typeof e=="string"?e.replace(" ","T"):e,httpEndpointURL=e=>{let r=e;return r=r.replace(/^ws/i,"http"),r=r.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),r.replace(/\/+$/,"")};class Push{constructor(r,t,n={},i=DEFAULT_TIMEOUT){this.channel=r,this.event=t,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,t){var n;return this._hasReceived(r)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:r,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const r=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:r,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:t}){this.recHooks.filter(n=>n.status===r).forEach(n=>n.callback(t))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}var REALTIME_PRESENCE_LISTEN_EVENTS;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(REALTIME_PRESENCE_LISTEN_EVENTS||(REALTIME_PRESENCE_LISTEN_EVENTS={}));class RealtimePresence{constructor(r,t){this.channel=r,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:l,onLeave:c,onSync:f}=this.caller;this.joinRef=this.channel._joinRef(),this.state=RealtimePresence.syncState(this.state,i,l,c),this.pendingDiffs.forEach(d=>{this.state=RealtimePresence.syncDiff(this.state,d,l,c)}),this.pendingDiffs=[],f()}),this.channel._on(n.diff,{},i=>{const{onJoin:l,onLeave:c,onSync:f}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=RealtimePresence.syncDiff(this.state,i,l,c),f())}),this.onJoin((i,l,c)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:l,newPresences:c})}),this.onLeave((i,l,c)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(r,t,n,i){const l=this.cloneDeep(r),c=this.transformState(t),f={},d={};return this.map(l,(h,p)=>{c[h]||(d[h]=p)}),this.map(c,(h,p)=>{const E=l[h];if(E){const y=p.map(m=>m.presence_ref),S=E.map(m=>m.presence_ref),x=p.filter(m=>S.indexOf(m.presence_ref)<0),g=E.filter(m=>y.indexOf(m.presence_ref)<0);x.length>0&&(f[h]=x),g.length>0&&(d[h]=g)}else f[h]=p}),this.syncDiff(l,{joins:f,leaves:d},n,i)}static syncDiff(r,t,n,i){const{joins:l,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(l,(f,d)=>{var h;const p=(h=r[f])!==null&&h!==void 0?h:[];if(r[f]=this.cloneDeep(d),p.length>0){const E=r[f].map(S=>S.presence_ref),y=p.filter(S=>E.indexOf(S.presence_ref)<0);r[f].unshift(...y)}n(f,p,d)}),this.map(c,(f,d)=>{let h=r[f];if(!h)return;const p=d.map(E=>E.presence_ref);h=h.filter(E=>p.indexOf(E.presence_ref)<0),r[f]=h,i(f,h,d),h.length===0&&delete r[f]}),r}static map(r,t){return Object.getOwnPropertyNames(r).map(n=>t(n,r[n]))}static transformState(r){return r=this.cloneDeep(r),Object.getOwnPropertyNames(r).reduce((t,n)=>{const i=r[n];return"metas"in i?t[n]=i.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):t[n]=i,t},{})}static cloneDeep(r){return JSON.parse(JSON.stringify(r))}onJoin(r){this.caller.onJoin=r}onLeave(r){this.caller.onLeave=r}onSync(r){this.caller.onSync=r}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var REALTIME_POSTGRES_CHANGES_LISTEN_EVENT;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT||(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT={}));var REALTIME_LISTEN_TYPES;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(REALTIME_LISTEN_TYPES||(REALTIME_LISTEN_TYPES={}));var REALTIME_SUBSCRIBE_STATES;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(REALTIME_SUBSCRIBE_STATES||(REALTIME_SUBSCRIBE_STATES={}));class RealtimeChannel{constructor(r,t={config:{}},n){this.topic=r,this.params=t,this.socket=n,this.bindings={},this.state=CHANNEL_STATES.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=r.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Push(this,CHANNEL_EVENTS.join,this.params,this.timeout),this.rejoinTimer=new Timer(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=CHANNEL_STATES.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=CHANNEL_STATES.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())}),this._on(CHANNEL_EVENTS.reply,{},(i,l)=>{this._trigger(this._replyEventName(l),i)}),this.presence=new RealtimePresence(this),this.broadcastEndpointURL=httpEndpointURL(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(r,t=this.timeout){var n,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:l,presence:c,private:f}}=this.params;this._onError(p=>r==null?void 0:r(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR,p)),this._onClose(()=>r==null?void 0:r(REALTIME_SUBSCRIBE_STATES.CLOSED));const d={},h={broadcast:l,presence:c,postgres_changes:(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&i!==void 0?i:[],private:f};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:h},d)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:p})=>{var E;if(this.socket.setAuth(),p===void 0){r==null||r(REALTIME_SUBSCRIBE_STATES.SUBSCRIBED);return}else{const y=this.bindings.postgres_changes,S=(E=y==null?void 0:y.length)!==null&&E!==void 0?E:0,x=[];for(let g=0;g<S;g++){const m=y[g],{filter:{event:A,schema:O,table:C,filter:R}}=m,T=p&&p[g];if(T&&T.event===A&&T.schema===O&&T.table===C&&T.filter===R)x.push(Object.assign(Object.assign({},m),{id:T.id}));else{this.unsubscribe(),r==null||r(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,r&&r(REALTIME_SUBSCRIBE_STATES.SUBSCRIBED);return}}).receive("error",p=>{r==null||r(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{r==null||r(REALTIME_SUBSCRIBE_STATES.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(r,t={}){return await this.send({type:"presence",event:"track",payload:r},t.timeout||this.timeout)}async untrack(r={}){return await this.send({type:"presence",event:"untrack"},r)}on(r,t,n){return this._on(r,t,n)}async send(r,t={}){var n,i;if(!this._canPush()&&r.type==="broadcast"){const{event:l,payload:c}=r,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=h.body)===null||i===void 0?void 0:i.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,f,d;const h=this._push(r.type,r,t.timeout||this.timeout);r.type==="broadcast"&&!(!((d=(f=(c=this.params)===null||c===void 0?void 0:c.config)===null||f===void 0?void 0:f.broadcast)===null||d===void 0)&&d.ack)&&l("ok"),h.receive("ok",()=>l("ok")),h.receive("error",()=>l("error")),h.receive("timeout",()=>l("timed out"))})}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=CHANNEL_STATES.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(CHANNEL_EVENTS.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const i=new Push(this,CHANNEL_EVENTS.leave,{},r);i.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}async _fetchWithTimeout(r,t,n){const i=new AbortController,l=setTimeout(()=>i.abort(),n),c=await this.socket.fetch(r,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(l),c}_push(r,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Push(this,r,t,n);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(r,t,n){return t}_isMember(r){return this.topic===r}_joinRef(){return this.joinPush.ref}_trigger(r,t,n){var i,l;const c=r.toLocaleLowerCase(),{close:f,error:d,leave:h,join:p}=CHANNEL_EVENTS;if(n&&[f,d,h,p].indexOf(c)>=0&&n!==this._joinRef())return;let y=this._onMessage(c,t,n);if(t&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(S=>{var x,g,m;return((x=S.filter)===null||x===void 0?void 0:x.event)==="*"||((m=(g=S.filter)===null||g===void 0?void 0:g.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===c}).map(S=>S.callback(y,n)):(l=this.bindings[c])===null||l===void 0||l.filter(S=>{var x,g,m,A,O,C;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in S){const R=S.id,T=(x=S.filter)===null||x===void 0?void 0:x.event;return R&&((g=t.ids)===null||g===void 0?void 0:g.includes(R))&&(T==="*"||(T==null?void 0:T.toLocaleLowerCase())===((m=t.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{const R=(O=(A=S==null?void 0:S.filter)===null||A===void 0?void 0:A.event)===null||O===void 0?void 0:O.toLocaleLowerCase();return R==="*"||R===((C=t==null?void 0:t.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return S.type.toLocaleLowerCase()===c}).map(S=>{if(typeof y=="object"&&"ids"in y){const x=y.data,{schema:g,table:m,commit_timestamp:A,type:O,errors:C}=x;y=Object.assign(Object.assign({},{schema:g,table:m,commit_timestamp:A,eventType:O,new:{},old:{},errors:C}),this._getPayloadRecords(x))}S.callback(y,n)})}_isClosed(){return this.state===CHANNEL_STATES.closed}_isJoined(){return this.state===CHANNEL_STATES.joined}_isJoining(){return this.state===CHANNEL_STATES.joining}_isLeaving(){return this.state===CHANNEL_STATES.leaving}_replyEventName(r){return`chan_reply_${r}`}_on(r,t,n){const i=r.toLocaleLowerCase(),l={type:i,filter:t,callback:n};return this.bindings[i]?this.bindings[i].push(l):this.bindings[i]=[l],this}_off(r,t){const n=r.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(i=>{var l;return!(((l=i.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===n&&RealtimeChannel.isEqual(i.filter,t))}),this}static isEqual(r,t){if(Object.keys(r).length!==Object.keys(t).length)return!1;for(const n in r)if(r[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(r){this._on(CHANNEL_EVENTS.close,{},r)}_onError(r){this._on(CHANNEL_EVENTS.error,{},t=>r(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(r=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=CHANNEL_STATES.joining,this.joinPush.resend(r))}_getPayloadRecords(r){const t={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(t.new=convertChangeData(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(t.old=convertChangeData(r.columns,r.old_record)),t}}const noop=()=>{},NATIVE_WEBSOCKET_AVAILABLE=typeof WebSocket<"u",WORKER_SCRIPT=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class RealtimeClient{constructor(r,t){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=DEFAULT_HEADERS$3,this.params={},this.timeout=DEFAULT_TIMEOUT,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=noop,this.conn=null,this.sendBuffer=[],this.serializer=new Serializer,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=l=>{let c;return l?c=l:typeof fetch>"u"?c=(...f)=>__vitePreload(async()=>{const{default:d}=await Promise.resolve().then(()=>browser);return{default:d}},void 0).then(({default:d})=>d(...f)):c=fetch,(...f)=>c(...f)},this.endPoint=`${r}/${TRANSPORTS.websocket}`,this.httpEndpoint=httpEndpointURL(r),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const i=(n=t==null?void 0:t.params)===null||n===void 0?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:l=>[1e3,2e3,5e3,1e4][l-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(l,c)=>c(JSON.stringify(l)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Timer(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(NATIVE_WEBSOCKET_AVAILABLE){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new WSWebSocketDummy(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),__vitePreload(async()=>{const{default:r}=await import("./browser-BA6TtlBo.js").then(t=>t.b);return{default:r}},[]).then(({default:r})=>{this.conn=new r(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:VSN}))}disconnect(r,t){this.conn&&(this.conn.onclose=function(){},r?this.conn.close(r,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(r){const t=await r.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const r=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),r}log(r,t,n){this.logger(r,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case SOCKET_STATES.connecting:return CONNECTION_STATE.Connecting;case SOCKET_STATES.open:return CONNECTION_STATE.Open;case SOCKET_STATES.closing:return CONNECTION_STATE.Closing;default:return CONNECTION_STATE.Closed}}isConnected(){return this.connectionState()===CONNECTION_STATE.Open}channel(r,t={config:{}}){const n=new RealtimeChannel(`realtime:${r}`,t,this);return this.channels.push(n),n}push(r){const{topic:t,event:n,payload:i,ref:l}=r,c=()=>{this.encode(r,f=>{var d;(d=this.conn)===null||d===void 0||d.send(f)})};this.log("push",`${t} ${n} (${l})`,i),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(r=null){let t=r||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let n=null;try{n=JSON.parse(atob(t.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=t,this.channels.forEach(i=>{t&&i.updateJoinPayload({access_token:t}),i.joinedOnce&&i._isJoined()&&i._push(CHANNEL_EVENTS.access_token,{access_token:t})})}}async sendHeartbeat(){var r;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(r=this.conn)===null||r===void 0||r.close(WS_CLOSE_NORMAL,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}_leaveOpenTopic(r){let t=this.channels.find(n=>n.topic===r&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${r}"`),t.unsubscribe())}_remove(r){this.channels=this.channels.filter(t=>t._joinRef()!==r._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this._onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r))}_onConnMessage(r){this.decode(r.data,t=>{let{topic:n,event:i,payload:l,ref:c}=t;c&&c===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${l.status||""} ${n} ${i} ${c&&"("+c+")"||""}`,l),this.channels.filter(f=>f._isMember(n)).forEach(f=>f._trigger(i,l,c)),this.stateChangeCallbacks.message.forEach(f=>f(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const r=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(r),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(r=>r())}_onConnClose(r){this.log("transport","close",r),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(r))}_onConnError(r){this.log("transport",r.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(r))}_triggerChanError(){this.channels.forEach(r=>r._trigger(CHANNEL_EVENTS.error))}_appendParams(r,t){if(Object.keys(t).length===0)return r;const n=r.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${r}${n}${i}`}_workerObjectUrl(r){let t;if(r)t=r;else{const n=new Blob([WORKER_SCRIPT],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}}class WSWebSocketDummy{constructor(r,t,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=SOCKET_STATES.connecting,this.send=()=>{},this.url=null,this.url=r,this.close=n.close}}class StorageError extends Error{constructor(r){super(r),this.__isStorageError=!0,this.name="StorageError"}}function isStorageError(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class StorageApiError extends StorageError{constructor(r,t){super(r),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class StorageUnknownError extends StorageError{constructor(r,t){super(r),this.name="StorageUnknownError",this.originalError=t}}var __awaiter$6=function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(p){try{h(n.next(p))}catch(E){c(E)}}function d(p){try{h(n.throw(p))}catch(E){c(E)}}function h(p){p.done?l(p.value):i(p.value).then(f,d)}h((n=n.apply(e,r||[])).next())})};const resolveFetch$2=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>__vitePreload(async()=>{const{default:n}=await Promise.resolve().then(()=>browser);return{default:n}},void 0).then(({default:n})=>n(...t)):r=fetch,(...t)=>r(...t)},resolveResponse=()=>__awaiter$6(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield __vitePreload(()=>Promise.resolve().then(()=>browser),void 0)).Response:Response}),recursiveToCamel=e=>{if(Array.isArray(e))return e.map(t=>recursiveToCamel(t));if(typeof e=="function"||e!==Object(e))return e;const r={};return Object.entries(e).forEach(([t,n])=>{const i=t.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));r[i]=recursiveToCamel(n)}),r};var __awaiter$5=function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(p){try{h(n.next(p))}catch(E){c(E)}}function d(p){try{h(n.throw(p))}catch(E){c(E)}}function h(p){p.done?l(p.value):i(p.value).then(f,d)}h((n=n.apply(e,r||[])).next())})};const _getErrorMessage$1=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),handleError$1=(e,r,t)=>__awaiter$5(void 0,void 0,void 0,function*(){const n=yield resolveResponse();e instanceof n&&!(t!=null&&t.noResolveJson)?e.json().then(i=>{r(new StorageApiError(_getErrorMessage$1(i),e.status||500))}).catch(i=>{r(new StorageUnknownError(_getErrorMessage$1(i),i))}):r(new StorageUnknownError(_getErrorMessage$1(e),e))}),_getRequestParams$1=(e,r,t,n)=>{const i={method:e,headers:(r==null?void 0:r.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},r==null?void 0:r.headers),n&&(i.body=JSON.stringify(n)),Object.assign(Object.assign({},i),t))};function _handleRequest$1(e,r,t,n,i,l){return __awaiter$5(this,void 0,void 0,function*(){return new Promise((c,f)=>{e(t,_getRequestParams$1(r,n,i,l)).then(d=>{if(!d.ok)throw d;return n!=null&&n.noResolveJson?d:d.json()}).then(d=>c(d)).catch(d=>handleError$1(d,f,n))})})}function get(e,r,t,n){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(e,"GET",r,t,n)})}function post(e,r,t,n,i){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(e,"POST",r,n,i,t)})}function put(e,r,t,n,i){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(e,"PUT",r,n,i,t)})}function head(e,r,t,n){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(e,"HEAD",r,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function remove(e,r,t,n,i){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(e,"DELETE",r,n,i,t)})}var __awaiter$4=function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(p){try{h(n.next(p))}catch(E){c(E)}}function d(p){try{h(n.throw(p))}catch(E){c(E)}}function h(p){p.done?l(p.value):i(p.value).then(f,d)}h((n=n.apply(e,r||[])).next())})};const DEFAULT_SEARCH_OPTIONS={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},DEFAULT_FILE_OPTIONS={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class StorageFileApi{constructor(r,t={},n,i){this.url=r,this.headers=t,this.bucketId=n,this.fetch=resolveFetch$2(i)}uploadOrUpdate(r,t,n,i){return __awaiter$4(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},DEFAULT_FILE_OPTIONS),i);let f=Object.assign(Object.assign({},this.headers),r==="POST"&&{"x-upsert":String(c.upsert)});const d=c.metadata;typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),d&&l.append("metadata",this.encodeMetadata(d)),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl),d&&l.append("metadata",this.encodeMetadata(d))):(l=n,f["cache-control"]=`max-age=${c.cacheControl}`,f["content-type"]=c.contentType,d&&(f["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),i!=null&&i.headers&&(f=Object.assign(Object.assign({},f),i.headers));const h=this._removeEmptyFolders(t),p=this._getFinalPath(h),E=yield this.fetch(`${this.url}/object/${p}`,Object.assign({method:r,body:l,headers:f},c!=null&&c.duplex?{duplex:c.duplex}:{})),y=yield E.json();return E.ok?{data:{path:h,id:y.Id,fullPath:y.Key},error:null}:{data:null,error:y}}catch(l){if(isStorageError(l))return{data:null,error:l};throw l}})}upload(r,t,n){return __awaiter$4(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",r,t,n)})}uploadToSignedUrl(r,t,n,i){return __awaiter$4(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(r),c=this._getFinalPath(l),f=new URL(this.url+`/object/upload/sign/${c}`);f.searchParams.set("token",t);try{let d;const h=Object.assign({upsert:DEFAULT_FILE_OPTIONS.upsert},i),p=Object.assign(Object.assign({},this.headers),{"x-upsert":String(h.upsert)});typeof Blob<"u"&&n instanceof Blob?(d=new FormData,d.append("cacheControl",h.cacheControl),d.append("",n)):typeof FormData<"u"&&n instanceof FormData?(d=n,d.append("cacheControl",h.cacheControl)):(d=n,p["cache-control"]=`max-age=${h.cacheControl}`,p["content-type"]=h.contentType);const E=yield this.fetch(f.toString(),{method:"PUT",body:d,headers:p}),y=yield E.json();return E.ok?{data:{path:l,fullPath:y.Key},error:null}:{data:null,error:y}}catch(d){if(isStorageError(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(r,t){return __awaiter$4(this,void 0,void 0,function*(){try{let n=this._getFinalPath(r);const i=Object.assign({},this.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const l=yield post(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),c=new URL(this.url+l.url),f=c.searchParams.get("token");if(!f)throw new StorageError("No token returned by API");return{data:{signedUrl:c.toString(),path:r,token:f},error:null}}catch(n){if(isStorageError(n))return{data:null,error:n};throw n}})}update(r,t,n){return __awaiter$4(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",r,t,n)})}move(r,t,n){return __awaiter$4(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:r,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(isStorageError(i))return{data:null,error:i};throw i}})}copy(r,t,n){return __awaiter$4(this,void 0,void 0,function*(){try{return{data:{path:(yield post(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:r,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(isStorageError(i))return{data:null,error:i};throw i}})}createSignedUrl(r,t,n){return __awaiter$4(this,void 0,void 0,function*(){try{let i=this._getFinalPath(r),l=yield post(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const c=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(i){if(isStorageError(i))return{data:null,error:i};throw i}})}createSignedUrls(r,t,n){return __awaiter$4(this,void 0,void 0,function*(){try{const i=yield post(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:r},{headers:this.headers}),l=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(i){if(isStorageError(i))return{data:null,error:i};throw i}})}download(r,t){return __awaiter$4(this,void 0,void 0,function*(){const i=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),c=l?`?${l}`:"";try{const f=this._getFinalPath(r);return{data:yield(yield get(this.fetch,`${this.url}/${i}/${f}${c}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(f){if(isStorageError(f))return{data:null,error:f};throw f}})}info(r){return __awaiter$4(this,void 0,void 0,function*(){const t=this._getFinalPath(r);try{const n=yield get(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:recursiveToCamel(n),error:null}}catch(n){if(isStorageError(n))return{data:null,error:n};throw n}})}exists(r){return __awaiter$4(this,void 0,void 0,function*(){const t=this._getFinalPath(r);try{return yield head(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(isStorageError(n)&&n instanceof StorageUnknownError){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(r,t){const n=this._getFinalPath(r),i=[],l=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";l!==""&&i.push(l);const f=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",d=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});d!==""&&i.push(d);let h=i.join("&");return h!==""&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${f}/public/${n}${h}`)}}}remove(r){return __awaiter$4(this,void 0,void 0,function*(){try{return{data:yield remove(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:r},{headers:this.headers}),error:null}}catch(t){if(isStorageError(t))return{data:null,error:t};throw t}})}list(r,t,n){return __awaiter$4(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},DEFAULT_SEARCH_OPTIONS),t),{prefix:r||""});return{data:yield post(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(isStorageError(i))return{data:null,error:i};throw i}})}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const t=[];return r.width&&t.push(`width=${r.width}`),r.height&&t.push(`height=${r.height}`),r.resize&&t.push(`resize=${r.resize}`),r.format&&t.push(`format=${r.format}`),r.quality&&t.push(`quality=${r.quality}`),t.join("&")}}const version$2="2.7.1",DEFAULT_HEADERS$2={"X-Client-Info":`storage-js/${version$2}`};var __awaiter$3=function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(p){try{h(n.next(p))}catch(E){c(E)}}function d(p){try{h(n.throw(p))}catch(E){c(E)}}function h(p){p.done?l(p.value):i(p.value).then(f,d)}h((n=n.apply(e,r||[])).next())})};class StorageBucketApi{constructor(r,t={},n){this.url=r,this.headers=Object.assign(Object.assign({},DEFAULT_HEADERS$2),t),this.fetch=resolveFetch$2(n)}listBuckets(){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield get(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(r){if(isStorageError(r))return{data:null,error:r};throw r}})}getBucket(r){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield get(this.fetch,`${this.url}/bucket/${r}`,{headers:this.headers}),error:null}}catch(t){if(isStorageError(t))return{data:null,error:t};throw t}})}createBucket(r,t={public:!1}){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/bucket`,{id:r,name:r,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(isStorageError(n))return{data:null,error:n};throw n}})}updateBucket(r,t){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield put(this.fetch,`${this.url}/bucket/${r}`,{id:r,name:r,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(isStorageError(n))return{data:null,error:n};throw n}})}emptyBucket(r){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/bucket/${r}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(isStorageError(t))return{data:null,error:t};throw t}})}deleteBucket(r){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield remove(this.fetch,`${this.url}/bucket/${r}`,{},{headers:this.headers}),error:null}}catch(t){if(isStorageError(t))return{data:null,error:t};throw t}})}}class StorageClient extends StorageBucketApi{constructor(r,t={},n){super(r,t,n)}from(r){return new StorageFileApi(this.url,this.headers,r,this.fetch)}}const version$1="2.48.0";let JS_ENV="";typeof Deno<"u"?JS_ENV="deno":typeof document<"u"?JS_ENV="web":typeof navigator<"u"&&navigator.product==="ReactNative"?JS_ENV="react-native":JS_ENV="node";const DEFAULT_HEADERS$1={"X-Client-Info":`supabase-js-${JS_ENV}/${version$1}`},DEFAULT_GLOBAL_OPTIONS={headers:DEFAULT_HEADERS$1},DEFAULT_DB_OPTIONS={schema:"public"},DEFAULT_AUTH_OPTIONS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},DEFAULT_REALTIME_OPTIONS={};var __awaiter$2=function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(p){try{h(n.next(p))}catch(E){c(E)}}function d(p){try{h(n.throw(p))}catch(E){c(E)}}function h(p){p.done?l(p.value):i(p.value).then(f,d)}h((n=n.apply(e,r||[])).next())})};const resolveFetch$1=e=>{let r;return e?r=e:typeof fetch>"u"?r=nodeFetch:r=fetch,(...t)=>r(...t)},resolveHeadersConstructor=()=>typeof Headers>"u"?Headers$1:Headers,fetchWithAuth=(e,r,t)=>{const n=resolveFetch$1(t),i=resolveHeadersConstructor();return(l,c)=>__awaiter$2(void 0,void 0,void 0,function*(){var f;const d=(f=yield r())!==null&&f!==void 0?f:e;let h=new i(c==null?void 0:c.headers);return h.has("apikey")||h.set("apikey",e),h.has("Authorization")||h.set("Authorization",`Bearer ${d}`),n(l,Object.assign(Object.assign({},c),{headers:h}))})};var __awaiter$1=function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(p){try{h(n.next(p))}catch(E){c(E)}}function d(p){try{h(n.throw(p))}catch(E){c(E)}}function h(p){p.done?l(p.value):i(p.value).then(f,d)}h((n=n.apply(e,r||[])).next())})};function stripTrailingSlash(e){return e.replace(/\/$/,"")}function applySettingDefaults(e,r){const{db:t,auth:n,realtime:i,global:l}=e,{db:c,auth:f,realtime:d,global:h}=r,p={db:Object.assign(Object.assign({},c),t),auth:Object.assign(Object.assign({},f),n),realtime:Object.assign(Object.assign({},d),i),global:Object.assign(Object.assign({},h),l),accessToken:()=>__awaiter$1(this,void 0,void 0,function*(){return""})};return e.accessToken?p.accessToken=e.accessToken:delete p.accessToken,p}const version="2.67.3",GOTRUE_URL="http://localhost:9999",STORAGE_KEY="supabase.auth.token",DEFAULT_HEADERS={"X-Client-Info":`gotrue-js/${version}`},EXPIRY_MARGIN=10,API_VERSION_HEADER_NAME="X-Supabase-Api-Version",API_VERSIONS={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function expiresAt(e){return Math.round(Date.now()/1e3)+e}function uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const r=Math.random()*16|0;return(e=="x"?r:r&3|8).toString(16)})}const isBrowser=()=>typeof window<"u"&&typeof document<"u",localStorageWriteTests={tested:!1,writable:!1},supportsLocalStorage=()=>{if(!isBrowser())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(localStorageWriteTests.tested)return localStorageWriteTests.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),localStorageWriteTests.tested=!0,localStorageWriteTests.writable=!0}catch{localStorageWriteTests.tested=!0,localStorageWriteTests.writable=!1}return localStorageWriteTests.writable};function parseParametersFromURL(e){const r={},t=new URL(e);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,l)=>{r[l]=i})}catch{}return t.searchParams.forEach((n,i)=>{r[i]=n}),r}const resolveFetch=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>__vitePreload(async()=>{const{default:n}=await Promise.resolve().then(()=>browser);return{default:n}},void 0).then(({default:n})=>n(...t)):r=fetch,(...t)=>r(...t)},looksLikeFetchResponse=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",setItemAsync=async(e,r,t)=>{await e.setItem(r,JSON.stringify(t))},getItemAsync=async(e,r)=>{const t=await e.getItem(r);if(!t)return null;try{return JSON.parse(t)}catch{return t}},removeItemAsync=async(e,r)=>{await e.removeItem(r)};function decodeBase64URL(e){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",n,i,l,c,f,d,h,p=0;for(e=e.replace("-","+").replace("_","/");p<e.length;)c=r.indexOf(e.charAt(p++)),f=r.indexOf(e.charAt(p++)),d=r.indexOf(e.charAt(p++)),h=r.indexOf(e.charAt(p++)),n=c<<2|f>>4,i=(f&15)<<4|d>>2,l=(d&3)<<6|h,t=t+String.fromCharCode(n),d!=64&&i!=0&&(t=t+String.fromCharCode(i)),h!=64&&l!=0&&(t=t+String.fromCharCode(l));return t}class Deferred{constructor(){this.promise=new Deferred.promiseConstructor((r,t)=>{this.resolve=r,this.reject=t})}}Deferred.promiseConstructor=Promise;function decodeJWTPayload(e){const r=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=e.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!r.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const n=t[1];return JSON.parse(decodeBase64URL(n))}async function sleep(e){return await new Promise(r=>{setTimeout(()=>r(null),e)})}function retryable(e,r){return new Promise((n,i)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await e(l);if(!r(l,null,c)){n(c);return}}catch(c){if(!r(l,c)){i(c);return}}})()})}function dec2hex(e){return("0"+e.toString(16)).substr(-2)}function generatePKCEVerifier(){const r=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let i="";for(let l=0;l<56;l++)i+=t.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(r),Array.from(r,dec2hex).join("")}async function sha256(e){const t=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(n);return Array.from(i).map(l=>String.fromCharCode(l)).join("")}function base64urlencode(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function generatePKCEChallenge(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await sha256(e);return base64urlencode(t)}async function getCodeChallengeAndMethod(e,r,t=!1){const n=generatePKCEVerifier();let i=n;t&&(i+="/PASSWORD_RECOVERY"),await setItemAsync(e,`${r}-code-verifier`,i);const l=await generatePKCEChallenge(n);return[l,n===l?"plain":"s256"]}const API_VERSION_REGEX=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function parseResponseAPIVersion(e){const r=e.headers.get(API_VERSION_HEADER_NAME);if(!r||!r.match(API_VERSION_REGEX))return null;try{return new Date(`${r}T00:00:00.0Z`)}catch{return null}}class AuthError extends Error{constructor(r,t,n){super(r),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function isAuthError(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class AuthApiError extends AuthError{constructor(r,t,n){super(r,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function isAuthApiError(e){return isAuthError(e)&&e.name==="AuthApiError"}class AuthUnknownError extends AuthError{constructor(r,t){super(r),this.name="AuthUnknownError",this.originalError=t}}class CustomAuthError extends AuthError{constructor(r,t,n,i){super(r,n,i),this.name=t,this.status=n}}class AuthSessionMissingError extends CustomAuthError{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function isAuthSessionMissingError(e){return isAuthError(e)&&e.name==="AuthSessionMissingError"}class AuthInvalidTokenResponseError extends CustomAuthError{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class AuthInvalidCredentialsError extends CustomAuthError{constructor(r){super(r,"AuthInvalidCredentialsError",400,void 0)}}class AuthImplicitGrantRedirectError extends CustomAuthError{constructor(r,t=null){super(r,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function isAuthImplicitGrantRedirectError(e){return isAuthError(e)&&e.name==="AuthImplicitGrantRedirectError"}class AuthPKCEGrantCodeExchangeError extends CustomAuthError{constructor(r,t=null){super(r,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class AuthRetryableFetchError extends CustomAuthError{constructor(r,t){super(r,"AuthRetryableFetchError",t,void 0)}}function isAuthRetryableFetchError(e){return isAuthError(e)&&e.name==="AuthRetryableFetchError"}class AuthWeakPasswordError extends CustomAuthError{constructor(r,t,n){super(r,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}var __rest$1=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t};const _getErrorMessage=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),NETWORK_ERROR_CODES=[502,503,504];async function handleError(e){var r;if(!looksLikeFetchResponse(e))throw new AuthRetryableFetchError(_getErrorMessage(e),0);if(NETWORK_ERROR_CODES.includes(e.status))throw new AuthRetryableFetchError(_getErrorMessage(e),e.status);let t;try{t=await e.json()}catch(l){throw new AuthUnknownError(_getErrorMessage(l),l)}let n;const i=parseResponseAPIVersion(e);if(i&&i.getTime()>=API_VERSIONS["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new AuthWeakPasswordError(_getErrorMessage(t),e.status,((r=t.weak_password)===null||r===void 0?void 0:r.reasons)||[]);if(n==="session_not_found")throw new AuthSessionMissingError}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new AuthWeakPasswordError(_getErrorMessage(t),e.status,t.weak_password.reasons);throw new AuthApiError(_getErrorMessage(t),e.status||500,n)}const _getRequestParams=(e,r,t,n)=>{const i={method:e,headers:(r==null?void 0:r.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r==null?void 0:r.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),t))};async function _request(e,r,t,n){var i;const l=Object.assign({},n==null?void 0:n.headers);l[API_VERSION_HEADER_NAME]||(l[API_VERSION_HEADER_NAME]=API_VERSIONS["2024-01-01"].name),n!=null&&n.jwt&&(l.Authorization=`Bearer ${n.jwt}`);const c=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(c.redirect_to=n.redirectTo);const f=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",d=await _handleRequest(e,r,t+f,{headers:l,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(d):{data:Object.assign({},d),error:null}}async function _handleRequest(e,r,t,n,i,l){const c=_getRequestParams(r,n,i,l);let f;try{f=await e(t,Object.assign({},c))}catch(d){throw console.error(d),new AuthRetryableFetchError(_getErrorMessage(d),0)}if(f.ok||await handleError(f),n!=null&&n.noResolveJson)return f;try{return await f.json()}catch(d){await handleError(d)}}function _sessionResponse(e){var r;let t=null;hasSession(e)&&(t=Object.assign({},e),e.expires_at||(t.expires_at=expiresAt(e.expires_in)));const n=(r=e.user)!==null&&r!==void 0?r:e;return{data:{session:t,user:n},error:null}}function _sessionResponsePassword(e){const r=_sessionResponse(e);return!r.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(r.data.weak_password=e.weak_password),r}function _userResponse(e){var r;return{data:{user:(r=e.user)!==null&&r!==void 0?r:e},error:null}}function _ssoResponse(e){return{data:e,error:null}}function _generateLinkResponse(e){const{action_link:r,email_otp:t,hashed_token:n,redirect_to:i,verification_type:l}=e,c=__rest$1(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),f={action_link:r,email_otp:t,hashed_token:n,redirect_to:i,verification_type:l},d=Object.assign({},c);return{data:{properties:f,user:d},error:null}}function _noResolveJsonResponse(e){return e}function hasSession(e){return e.access_token&&e.refresh_token&&e.expires_in}var __rest=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t};class GoTrueAdminApi{constructor({url:r="",headers:t={},fetch:n}){this.url=r,this.headers=t,this.fetch=resolveFetch(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(r,t="global"){try{return await _request(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:r,noResolveJson:!0}),{data:null,error:null}}catch(n){if(isAuthError(n))return{data:null,error:n};throw n}}async inviteUserByEmail(r,t={}){try{return await _request(this.fetch,"POST",`${this.url}/invite`,{body:{email:r,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:_userResponse})}catch(n){if(isAuthError(n))return{data:{user:null},error:n};throw n}}async generateLink(r){try{const{options:t}=r,n=__rest(r,["options"]),i=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await _request(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:_generateLinkResponse,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(isAuthError(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(r){try{return await _request(this.fetch,"POST",`${this.url}/admin/users`,{body:r,headers:this.headers,xform:_userResponse})}catch(t){if(isAuthError(t))return{data:{user:null},error:t};throw t}}async listUsers(r){var t,n,i,l,c,f,d;try{const h={nextPage:null,lastPage:0,total:0},p=await _request(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=r==null?void 0:r.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(l=(i=r==null?void 0:r.perPage)===null||i===void 0?void 0:i.toString())!==null&&l!==void 0?l:""},xform:_noResolveJsonResponse});if(p.error)throw p.error;const E=await p.json(),y=(c=p.headers.get("x-total-count"))!==null&&c!==void 0?c:0,S=(d=(f=p.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&d!==void 0?d:[];return S.length>0&&(S.forEach(x=>{const g=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(x.split(";")[1].split("=")[1]);h[`${m}Page`]=g}),h.total=parseInt(y)),{data:Object.assign(Object.assign({},E),h),error:null}}catch(h){if(isAuthError(h))return{data:{users:[]},error:h};throw h}}async getUserById(r){try{return await _request(this.fetch,"GET",`${this.url}/admin/users/${r}`,{headers:this.headers,xform:_userResponse})}catch(t){if(isAuthError(t))return{data:{user:null},error:t};throw t}}async updateUserById(r,t){try{return await _request(this.fetch,"PUT",`${this.url}/admin/users/${r}`,{body:t,headers:this.headers,xform:_userResponse})}catch(n){if(isAuthError(n))return{data:{user:null},error:n};throw n}}async deleteUser(r,t=!1){try{return await _request(this.fetch,"DELETE",`${this.url}/admin/users/${r}`,{headers:this.headers,body:{should_soft_delete:t},xform:_userResponse})}catch(n){if(isAuthError(n))return{data:{user:null},error:n};throw n}}async _listFactors(r){try{const{data:t,error:n}=await _request(this.fetch,"GET",`${this.url}/admin/users/${r.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:n}}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}async _deleteFactor(r){try{return{data:await _request(this.fetch,"DELETE",`${this.url}/admin/users/${r.userId}/factors/${r.id}`,{headers:this.headers}),error:null}}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}}const localStorageAdapter={getItem:e=>supportsLocalStorage()?globalThis.localStorage.getItem(e):null,setItem:(e,r)=>{supportsLocalStorage()&&globalThis.localStorage.setItem(e,r)},removeItem:e=>{supportsLocalStorage()&&globalThis.localStorage.removeItem(e)}};function memoryLocalStorageAdapter(e={}){return{getItem:r=>e[r]||null,setItem:(r,t)=>{e[r]=t},removeItem:r=>{delete e[r]}}}function polyfillGlobalThis(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const internals={debug:!!(globalThis&&supportsLocalStorage()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class LockAcquireTimeoutError extends Error{constructor(r){super(r),this.isAcquireTimeout=!0}}class NavigatorLockAcquireTimeoutError extends LockAcquireTimeoutError{}async function navigatorLock(e,r,t){internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,r);const n=new globalThis.AbortController;return r>0&&setTimeout(()=>{n.abort(),internals.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},r),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,r===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await t()}finally{internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(r===0)throw internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new NavigatorLockAcquireTimeoutError(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(internals.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}polyfillGlobalThis();const DEFAULT_OPTIONS={url:GOTRUE_URL,storageKey:STORAGE_KEY,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:DEFAULT_HEADERS,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},AUTO_REFRESH_TICK_DURATION=30*1e3,AUTO_REFRESH_TICK_THRESHOLD=3;async function lockNoOp(e,r,t){return await t()}class GoTrueClient{constructor(r){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=GoTrueClient.nextInstanceID,GoTrueClient.nextInstanceID+=1,this.instanceID>0&&isBrowser()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},DEFAULT_OPTIONS),r);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new GoTrueAdminApi({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=resolveFetch(i.fetch),this.lock=i.lock||lockNoOp,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:isBrowser()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=navigatorLock:this.lock=lockNoOp,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:supportsLocalStorage()?this.storage=localStorageAdapter:(this.memoryStorage={},this.storage=memoryLocalStorageAdapter(this.memoryStorage)):(this.memoryStorage={},this.storage=memoryLocalStorageAdapter(this.memoryStorage)),isBrowser()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}_debug(...r){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${version}) ${new Date().toISOString()}`,...r),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var r;try{const t=parseParametersFromURL(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),isBrowser()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:l}=await this._getSessionFromURL(t,n);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),isAuthImplicitGrantRedirectError(l)){const d=(r=l.details)===null||r===void 0?void 0:r.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:f}=i;return this._debug("#_initialize()","detected session in URL",c,"redirect type",f),await this._saveSession(c),setTimeout(async()=>{f==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return isAuthError(t)?{error:t}:{error:new AuthUnknownError("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(r){var t,n,i;try{const l=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=r==null?void 0:r.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=r==null?void 0:r.options)===null||i===void 0?void 0:i.captchaToken}},xform:_sessionResponse}),{data:c,error:f}=l;if(f||!c)return{data:{user:null,session:null},error:f};const d=c.session,h=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:h,session:d},error:null}}catch(l){if(isAuthError(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(r){var t,n,i;try{let l;if("email"in r){const{email:p,password:E,options:y}=r;let S=null,x=null;this.flowType==="pkce"&&([S,x]=await getCodeChallengeAndMethod(this.storage,this.storageKey)),l=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y==null?void 0:y.emailRedirectTo,body:{email:p,password:E,data:(t=y==null?void 0:y.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:y==null?void 0:y.captchaToken},code_challenge:S,code_challenge_method:x},xform:_sessionResponse})}else if("phone"in r){const{phone:p,password:E,options:y}=r;l=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:E,data:(n=y==null?void 0:y.data)!==null&&n!==void 0?n:{},channel:(i=y==null?void 0:y.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:y==null?void 0:y.captchaToken}},xform:_sessionResponse})}else throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a password");const{data:c,error:f}=l;if(f||!c)return{data:{user:null,session:null},error:f};const d=c.session,h=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:h,session:d},error:null}}catch(l){if(isAuthError(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(r){try{let t;if("email"in r){const{email:l,password:c,options:f}=r;t=await _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:_sessionResponsePassword})}else if("phone"in r){const{phone:l,password:c,options:f}=r;t=await _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:_sessionResponsePassword})}else throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a password");const{data:n,error:i}=t;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(t){if(isAuthError(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(r){var t,n,i,l;return await this._handleProviderSignIn(r.provider,{redirectTo:(t=r.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=r.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=r.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(l=r.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(r){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(r))}async _exchangeCodeForSession(r){const t=await getItemAsync(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(t??"").split("/");try{const{data:l,error:c}=await _request(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:r,code_verifier:n},xform:_sessionResponse});if(await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new AuthInvalidTokenResponseError}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:i??null}),error:c})}catch(l){if(isAuthError(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(r){try{const{options:t,provider:n,token:i,access_token:l,nonce:c}=r,f=await _request(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:_sessionResponse}),{data:d,error:h}=f;return h?{data:{user:null,session:null},error:h}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:h})}catch(t){if(isAuthError(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(r){var t,n,i,l,c;try{if("email"in r){const{email:f,options:d}=r;let h=null,p=null;this.flowType==="pkce"&&([h,p]=await getCodeChallengeAndMethod(this.storage,this.storageKey));const{error:E}=await _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:f,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},create_user:(n=d==null?void 0:d.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:h,code_challenge_method:p},redirectTo:d==null?void 0:d.emailRedirectTo});return{data:{user:null,session:null},error:E}}if("phone"in r){const{phone:f,options:d}=r,{data:h,error:p}=await _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:f,data:(i=d==null?void 0:d.data)!==null&&i!==void 0?i:{},create_user:(l=d==null?void 0:d.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(c=d==null?void 0:d.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:h==null?void 0:h.message_id},error:p}}throw new AuthInvalidCredentialsError("You must provide either an email or phone number.")}catch(f){if(isAuthError(f))return{data:{user:null,session:null},error:f};throw f}}async verifyOtp(r){var t,n;try{let i,l;"options"in r&&(i=(t=r.options)===null||t===void 0?void 0:t.redirectTo,l=(n=r.options)===null||n===void 0?void 0:n.captchaToken);const{data:c,error:f}=await _request(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},r),{gotrue_meta_security:{captcha_token:l}}),redirectTo:i,xform:_sessionResponse});if(f)throw f;if(!c)throw new Error("An error occurred on token verification.");const d=c.session,h=c.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(r.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:h,session:d},error:null}}catch(i){if(isAuthError(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(r){var t,n,i;try{let l=null,c=null;return this.flowType==="pkce"&&([l,c]=await getCodeChallengeAndMethod(this.storage,this.storageKey)),await _request(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in r?{provider_id:r.providerId}:null),"domain"in r?{domain:r.domain}:null),{redirect_to:(n=(t=r.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=r==null?void 0:r.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:r.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:_ssoResponse})}catch(l){if(isAuthError(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async r=>{const{data:{session:t},error:n}=r;if(n)throw n;if(!t)throw new AuthSessionMissingError;const{error:i}=await _request(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}})}catch(r){if(isAuthError(r))return{data:{user:null,session:null},error:r};throw r}}async resend(r){try{const t=`${this.url}/resend`;if("email"in r){const{email:n,type:i,options:l}=r,{error:c}=await _request(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in r){const{phone:n,type:i,options:l}=r,{data:c,error:f}=await _request(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:f}}throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a type")}catch(t){if(isAuthError(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(r,t){this._debug("#_acquireLock","begin",r);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,r,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(r){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await r(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let r=null;const t=await getItemAsync(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?r=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!r)return{data:{session:null},error:null};const n=r.expires_at?r.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",r.expires_at),!n){if(this.storage.isServer){let c=this.suppressGetSessionWarning;r=new Proxy(r,{get:(d,h,p)=>(!c&&h==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,h,p))})}return{data:{session:r},error:null}}const{session:i,error:l}=await this._callRefreshToken(r.refresh_token);return l?{data:{session:null},error:l}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(r){return r?await this._getUser(r):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(r){try{return r?await _request(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:r,xform:_userResponse}):await this._useSession(async t=>{var n,i,l;const{data:c,error:f}=t;if(f)throw f;return!(!((n=c.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new AuthSessionMissingError}:await _request(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(i=c.session)===null||i===void 0?void 0:i.access_token)!==null&&l!==void 0?l:void 0,xform:_userResponse})})}catch(t){if(isAuthError(t))return isAuthSessionMissingError(t)&&(await this._removeSession(),await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(r,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(r,t))}async _updateUser(r,t={}){try{return await this._useSession(async n=>{const{data:i,error:l}=n;if(l)throw l;if(!i.session)throw new AuthSessionMissingError;const c=i.session;let f=null,d=null;this.flowType==="pkce"&&r.email!=null&&([f,d]=await getCodeChallengeAndMethod(this.storage,this.storageKey));const{data:h,error:p}=await _request(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},r),{code_challenge:f,code_challenge_method:d}),jwt:c.access_token,xform:_userResponse});if(p)throw p;return c.user=h.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(n){if(isAuthError(n))return{data:{user:null},error:n};throw n}}_decodeJWT(r){return decodeJWTPayload(r)}async setSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(r))}async _setSession(r){try{if(!r.access_token||!r.refresh_token)throw new AuthSessionMissingError;const t=Date.now()/1e3;let n=t,i=!0,l=null;const c=decodeJWTPayload(r.access_token);if(c.exp&&(n=c.exp,i=n<=t),i){const{session:f,error:d}=await this._callRefreshToken(r.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!f)return{data:{user:null,session:null},error:null};l=f}else{const{data:f,error:d}=await this._getUser(r.access_token);if(d)throw d;l={access_token:r.access_token,refresh_token:r.refresh_token,user:f.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(t){if(isAuthError(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(r))}async _refreshSession(r){try{return await this._useSession(async t=>{var n;if(!r){const{data:c,error:f}=t;if(f)throw f;r=(n=c.session)!==null&&n!==void 0?n:void 0}if(!(r!=null&&r.refresh_token))throw new AuthSessionMissingError;const{session:i,error:l}=await this._callRefreshToken(r.refresh_token);return l?{data:{user:null,session:null},error:l}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(isAuthError(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(r,t){try{if(!isBrowser())throw new AuthImplicitGrantRedirectError("No browser detected.");if(r.error||r.error_description||r.error_code)throw new AuthImplicitGrantRedirectError(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new AuthPKCEGrantCodeExchangeError("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new AuthImplicitGrantRedirectError("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!r.code)throw new AuthPKCEGrantCodeExchangeError("No code detected.");const{data:O,error:C}=await this._exchangeCodeForSession(r.code);if(C)throw C;const R=new URL(window.location.href);return R.searchParams.delete("code"),window.history.replaceState(window.history.state,"",R.toString()),{data:{session:O.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:l,refresh_token:c,expires_in:f,expires_at:d,token_type:h}=r;if(!l||!f||!c||!h)throw new AuthImplicitGrantRedirectError("No session defined in URL");const p=Math.round(Date.now()/1e3),E=parseInt(f);let y=p+E;d&&(y=parseInt(d));const S=y-p;S*1e3<=AUTO_REFRESH_TICK_DURATION&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${S}s, should have been closer to ${E}s`);const x=y-E;p-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,y,p):p-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,y,p);const{data:g,error:m}=await this._getUser(l);if(m)throw m;const A={provider_token:n,provider_refresh_token:i,access_token:l,expires_in:E,expires_at:y,refresh_token:c,token_type:h,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:A,redirectType:r.type},error:null}}catch(n){if(isAuthError(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(r){return!!(r.access_token||r.error_description)}async _isPKCECallback(r){const t=await getItemAsync(this.storage,`${this.storageKey}-code-verifier`);return!!(r.code&&t)}async signOut(r={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(r))}async _signOut({scope:r}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:i,error:l}=t;if(l)return{error:l};const c=(n=i.session)===null||n===void 0?void 0:n.access_token;if(c){const{error:f}=await this.admin.signOut(c,r);if(f&&!(isAuthApiError(f)&&(f.status===404||f.status===401||f.status===403)))return{error:f}}return r!=="others"&&(await this._removeSession(),await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(r){const t=uuid(),n={id:t,callback:r,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(r){return await this._useSession(async t=>{var n,i;try{const{data:{session:l},error:c}=t;if(c)throw c;await((n=this.stateChangeEmitters.get(r))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",r,"session",l)}catch(l){await((i=this.stateChangeEmitters.get(r))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",r,"error",l),console.error(l)}})}async resetPasswordForEmail(r,t={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await getCodeChallengeAndMethod(this.storage,this.storageKey,!0));try{return await _request(this.fetch,"POST",`${this.url}/recover`,{body:{email:r,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(isAuthError(l))return{data:null,error:l};throw l}}async getUserIdentities(){var r;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(r=t.user.identities)!==null&&r!==void 0?r:[]},error:null}}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}async linkIdentity(r){var t;try{const{data:n,error:i}=await this._useSession(async l=>{var c,f,d,h,p;const{data:E,error:y}=l;if(y)throw y;const S=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,r.provider,{redirectTo:(c=r.options)===null||c===void 0?void 0:c.redirectTo,scopes:(f=r.options)===null||f===void 0?void 0:f.scopes,queryParams:(d=r.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await _request(this.fetch,"GET",S,{headers:this.headers,jwt:(p=(h=E.session)===null||h===void 0?void 0:h.access_token)!==null&&p!==void 0?p:void 0})});if(i)throw i;return isBrowser()&&!(!((t=r.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:r.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(isAuthError(n))return{data:{provider:r.provider,url:null},error:n};throw n}}async unlinkIdentity(r){try{return await this._useSession(async t=>{var n,i;const{data:l,error:c}=t;if(c)throw c;return await _request(this.fetch,"DELETE",`${this.url}/user/identities/${r.identity_id}`,{headers:this.headers,jwt:(i=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}async _refreshAccessToken(r){const t=`#_refreshAccessToken(${r.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await retryable(async i=>(i>0&&await sleep(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await _request(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:r},headers:this.headers,xform:_sessionResponse})),(i,l)=>{const c=200*Math.pow(2,i);return l&&isAuthRetryableFetchError(l)&&Date.now()+c-n<AUTO_REFRESH_TICK_DURATION})}catch(n){if(this._debug(t,"error",n),isAuthError(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(r){return typeof r=="object"&&r!==null&&"access_token"in r&&"refresh_token"in r&&"expires_at"in r}async _handleProviderSignIn(r,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,r,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",r,"options",t,"url",n),isBrowser()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:r,url:n},error:null}}async _recoverAndRefresh(){var r;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const n=await getItemAsync(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n)){this._debug(t,"session is not valid"),n!==null&&await this._removeSession();return}const i=Math.round(Date.now()/1e3),l=((r=n.expires_at)!==null&&r!==void 0?r:1/0)<i+EXPIRY_MARGIN;if(this._debug(t,`session has${l?"":" not"} expired with margin of ${EXPIRY_MARGIN}s`),l){if(this.autoRefreshToken&&n.refresh_token){const{error:c}=await this._callRefreshToken(n.refresh_token);c&&(console.error(c),isAuthRetryableFetchError(c)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(t,"error",n),console.error(n);return}finally{this._debug(t,"end")}}async _callRefreshToken(r){var t,n;if(!r)throw new AuthSessionMissingError;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${r.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Deferred;const{data:l,error:c}=await this._refreshAccessToken(r);if(c)throw c;if(!l.session)throw new AuthSessionMissingError;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const f={session:l.session,error:null};return this.refreshingDeferred.resolve(f),f}catch(l){if(this._debug(i,"error",l),isAuthError(l)){const c={session:null,error:l};return isAuthRetryableFetchError(l)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(l),l}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(r,t,n=!0){const i=`#_notifyAllSubscribers(${r})`;this._debug(i,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:r,session:t});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async f=>{try{await f.callback(r,t)}catch(d){l.push(d)}});if(await Promise.all(c),l.length>0){for(let f=0;f<l.length;f+=1)console.error(l[f]);throw l[0]}}finally{this._debug(i,"end")}}async _saveSession(r){this._debug("#_saveSession()",r),this.suppressGetSessionWarning=!0,await setItemAsync(this.storage,this.storageKey,r)}async _removeSession(){this._debug("#_removeSession()"),await removeItemAsync(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const r=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{r&&isBrowser()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",r)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const r=setInterval(()=>this._autoRefreshTokenTick(),AUTO_REFRESH_TICK_DURATION);this.autoRefreshTicker=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const r=this.autoRefreshTicker;this.autoRefreshTicker=null,r&&clearInterval(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const r=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-r)/AUTO_REFRESH_TICK_DURATION);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${AUTO_REFRESH_TICK_DURATION}ms, refresh threshold is ${AUTO_REFRESH_TICK_THRESHOLD} ticks`),i<=AUTO_REFRESH_TICK_THRESHOLD&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(r){if(r.isAcquireTimeout||r instanceof LockAcquireTimeoutError)this._debug("auto refresh token tick lock not available");else throw r}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!isBrowser()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(r){console.error("_handleVisibilityChange",r)}}async _onVisibilityChanged(r){const t=`#_onVisibilityChanged(${r})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),r||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(r,t,n){const i=[`provider=${encodeURIComponent(t)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[l,c]=await getCodeChallengeAndMethod(this.storage,this.storageKey),f=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});i.push(f.toString())}if(n!=null&&n.queryParams){const l=new URLSearchParams(n.queryParams);i.push(l.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${r}?${i.join("&")}`}async _unenroll(r){try{return await this._useSession(async t=>{var n;const{data:i,error:l}=t;return l?{data:null,error:l}:await _request(this.fetch,"DELETE",`${this.url}/factors/${r.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}async _enroll(r){try{return await this._useSession(async t=>{var n,i;const{data:l,error:c}=t;if(c)return{data:null,error:c};const f=Object.assign({friendly_name:r.friendlyName,factor_type:r.factorType},r.factorType==="phone"?{phone:r.phone}:{issuer:r.issuer}),{data:d,error:h}=await _request(this.fetch,"POST",`${this.url}/factors`,{body:f,headers:this.headers,jwt:(n=l==null?void 0:l.session)===null||n===void 0?void 0:n.access_token});return h?{data:null,error:h}:(r.factorType==="totp"&&(!((i=d==null?void 0:d.totp)===null||i===void 0)&&i.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}async _verify(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:i,error:l}=t;if(l)return{data:null,error:l};const{data:c,error:f}=await _request(this.fetch,"POST",`${this.url}/factors/${r.factorId}/verify`,{body:{code:r.code,challenge_id:r.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return f?{data:null,error:f}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:f})})}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}})}async _challenge(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:i,error:l}=t;return l?{data:null,error:l}:await _request(this.fetch,"POST",`${this.url}/factors/${r.factorId}/challenge`,{body:{channel:r.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(r){const{data:t,error:n}=await this._challenge({factorId:r.factorId});return n?{data:null,error:n}:await this._verify({factorId:r.factorId,challengeId:t.id,code:r.code})}async _listFactors(){const{data:{user:r},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=(r==null?void 0:r.factors)||[],i=n.filter(c=>c.factor_type==="totp"&&c.status==="verified"),l=n.filter(c=>c.factor_type==="phone"&&c.status==="verified");return{data:{all:n,totp:i,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async r=>{var t,n;const{data:{session:i},error:l}=r;if(l)return{data:null,error:l};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const c=this._decodeJWT(i.access_token);let f=null;c.aal&&(f=c.aal);let d=f;((n=(t=i.user.factors)===null||t===void 0?void 0:t.filter(E=>E.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(d="aal2");const p=c.amr||[];return{data:{currentLevel:f,nextLevel:d,currentAuthenticationMethods:p},error:null}}))}}GoTrueClient.nextInstanceID=0;const AuthClient=GoTrueClient;class SupabaseAuthClient extends AuthClient{constructor(r){super(r)}}var __awaiter=function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(p){try{h(n.next(p))}catch(E){c(E)}}function d(p){try{h(n.throw(p))}catch(E){c(E)}}function h(p){p.done?l(p.value):i(p.value).then(f,d)}h((n=n.apply(e,r||[])).next())})};class SupabaseClient{constructor(r,t,n){var i,l,c;if(this.supabaseUrl=r,this.supabaseKey=t,!r)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const f=stripTrailingSlash(r);this.realtimeUrl=`${f}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${f}/auth/v1`,this.storageUrl=`${f}/storage/v1`,this.functionsUrl=`${f}/functions/v1`;const d=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,h={db:DEFAULT_DB_OPTIONS,realtime:DEFAULT_REALTIME_OPTIONS,auth:Object.assign(Object.assign({},DEFAULT_AUTH_OPTIONS),{storageKey:d}),global:DEFAULT_GLOBAL_OPTIONS},p=applySettingDefaults(n??{},h);this.storageKey=(i=p.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(l=p.global.headers)!==null&&l!==void 0?l:{},p.accessToken?(this.accessToken=p.accessToken,this.auth=new Proxy({},{get:(E,y)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(y)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=p.auth)!==null&&c!==void 0?c:{},this.headers,p.global.fetch),this.fetch=fetchWithAuth(t,this._getAccessToken.bind(this),p.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},p.realtime)),this.rest=new PostgrestClient(`${f}/rest/v1`,{headers:this.headers,schema:p.db.schema,fetch:this.fetch}),p.accessToken||this._listenForAuthEvents()}get functions(){return new FunctionsClient(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new StorageClient(this.storageUrl,this.headers,this.fetch)}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,t={},n={}){return this.rest.rpc(r,t,n)}channel(r,t={config:{}}){return this.realtime.channel(r,t)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var r,t;return __awaiter(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:t,detectSessionInUrl:n,storage:i,storageKey:l,flowType:c,lock:f,debug:d},h,p){const E={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new SupabaseAuthClient({url:this.authUrl,headers:Object.assign(Object.assign({},E),h),storageKey:l,autoRefreshToken:r,persistSession:t,detectSessionInUrl:n,storage:i,flowType:c,lock:f,debug:d,fetch:p,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(r){return new RealtimeClient(this.realtimeUrl,Object.assign(Object.assign({},r),{params:Object.assign({apikey:this.supabaseKey},r==null?void 0:r.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(r,t,n){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:r==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const createClient=(e,r,t)=>new SupabaseClient(e,r,t);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var current_ansi=1252,VALID_ANSI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],CS2CP={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},set_ansi=function(e){VALID_ANSI.indexOf(e)!=-1&&(current_ansi=CS2CP[0]=e)};function reset_ansi(){set_ansi(1252)}var set_cp=function(e){set_ansi(e)};function reset_cp(){set_cp(1200),reset_ansi()}function char_codes(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function utf16leread(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function utf16beread(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var debom=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?utf16leread(e.slice(2)):r==254&&t==255?utf16beread(e.slice(2)):r==65279?e.slice(1):e},_getchar=function(r){return String.fromCharCode(r)},_getansi=function(r){return String.fromCharCode(r)},$cptable,Base64_map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Base64_encode(e){for(var r="",t=0,n=0,i=0,l=0,c=0,f=0,d=0,h=0;h<e.length;)t=e.charCodeAt(h++),l=t>>2,n=e.charCodeAt(h++),c=(t&3)<<4|n>>4,i=e.charCodeAt(h++),f=(n&15)<<2|i>>6,d=i&63,isNaN(n)?f=d=64:isNaN(i)&&(d=64),r+=Base64_map.charAt(l)+Base64_map.charAt(c)+Base64_map.charAt(f)+Base64_map.charAt(d);return r}function Base64_decode(e){var r="",t=0,n=0,i=0,l=0,c=0,f=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)l=Base64_map.indexOf(e.charAt(h++)),c=Base64_map.indexOf(e.charAt(h++)),t=l<<2|c>>4,r+=String.fromCharCode(t),f=Base64_map.indexOf(e.charAt(h++)),n=(c&15)<<4|f>>2,f!==64&&(r+=String.fromCharCode(n)),d=Base64_map.indexOf(e.charAt(h++)),i=(f&3)<<6|d,d!==64&&(r+=String.fromCharCode(i));return r}var has_buf=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Buffer_from=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function new_raw_buf(e){return has_buf?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function new_unsafe_buf(e){return has_buf?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var s2a=function(r){return has_buf?Buffer_from(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function a2s(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function ab2a(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ab2a(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var bconcat=has_buf?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:Buffer_from(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),i=0;for(r=0,t=0;r<e.length;t+=i,++r)if(i=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function utf8decode(e){for(var r=[],t=0,n=e.length+250,i=new_raw_buf(e.length+255),l=0;l<e.length;++l){var c=e.charCodeAt(l);if(c<128)i[t++]=c;else if(c<2048)i[t++]=192|c>>6&31,i[t++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var f=e.charCodeAt(++l)&1023;i[t++]=240|c>>8&7,i[t++]=128|c>>2&63,i[t++]=128|f>>6&15|(c&3)<<4,i[t++]=128|f&63}else i[t++]=224|c>>12&15,i[t++]=128|c>>6&63,i[t++]=128|c&63;t>n&&(r.push(i.slice(0,t)),t=0,i=new_raw_buf(65535),n=65530)}return r.push(i.slice(0,t)),bconcat(r)}var chr0=/\u0000/g,chr1=/[\u0001-\u0006]/g;function _strrev(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function pad0(e,r){var t=""+e;return t.length>=r?t:fill("0",r-t.length)+t}function pad_(e,r){var t=""+e;return t.length>=r?t:fill(" ",r-t.length)+t}function rpad_(e,r){var t=""+e;return t.length>=r?t:t+fill(" ",r-t.length)}function pad0r1(e,r){var t=""+Math.round(e);return t.length>=r?t:fill("0",r-t.length)+t}function pad0r2(e,r){var t=""+e;return t.length>=r?t:fill("0",r-t.length)+t}var p2_32=Math.pow(2,32);function pad0r(e,r){if(e>p2_32||e<-p2_32)return pad0r1(e,r);var t=Math.round(e);return pad0r2(t,r)}function SSF_isgeneral(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var days=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],months=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SSF_init_table(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var table_fmt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},SSF_default_map={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SSF_default_str={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function SSF_frac(e,r,t){for(var n=e<0?-1:1,i=e*n,l=0,c=1,f=0,d=1,h=0,p=0,E=Math.floor(i);h<r&&(E=Math.floor(i),f=E*c+l,p=E*h+d,!(i-E<5e-8));)i=1/(i-E),l=c,c=f,d=h,h=p;if(p>r&&(h>r?(p=d,f=l):(p=h,f=c)),!t)return[0,n*f,p];var y=Math.floor(n*f/p);return[y,n*f-y*p,p]}function SSF_parse_date_code(e,r,t){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),l=0,c=[],f={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(f.u)<1e-6&&(f.u=0),r&&r.date1904&&(n+=1462),f.u>.9999&&(f.u=0,++i==86400&&(f.T=i=0,++n,++f.D)),n===60)c=t?[1317,10,29]:[1900,2,29],l=3;else if(n===0)c=t?[1317,8,29]:[1900,1,0],l=6;else{n>60&&--n;var d=new Date(1900,0,1);d.setDate(d.getDate()+n-1),c=[d.getFullYear(),d.getMonth()+1,d.getDate()],l=d.getDay(),n<60&&(l=(l+6)%7),t&&(l=SSF_fix_hijri(d,c))}return f.y=c[0],f.m=c[1],f.d=c[2],f.S=i%60,i=Math.floor(i/60),f.M=i%60,i=Math.floor(i/60),f.H=i,f.q=l,f}var SSFbasedate=new Date(1899,11,31,0,0,0),SSFdnthresh=SSFbasedate.getTime(),SSFbase1904=new Date(1900,2,1,0,0,0);function datenum_local(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=SSFbase1904&&(t+=24*60*60*1e3),(t-(SSFdnthresh+(e.getTimezoneOffset()-SSFbasedate.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function SSF_strip_decimal(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SSF_normalize_exp(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SSF_small_exp(e){var r=e<0?12:11,t=SSF_strip_decimal(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function SSF_large_exp(e){var r=SSF_strip_decimal(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function SSF_general_num(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=SSF_small_exp(e):r===10?t=e.toFixed(10).substr(0,12):t=SSF_large_exp(e),SSF_strip_decimal(SSF_normalize_exp(t.toUpperCase()))}function SSF_general(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):SSF_general_num(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return SSF_format(14,datenum_local(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function SSF_fix_hijri(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function SSF_write_date(e,r,t,n){var i="",l=0,c=0,f=t.y,d,h=0;switch(e){case 98:f=t.y+543;case 121:switch(r.length){case 1:case 2:d=f%100,h=2;break;default:d=f%1e4,h=4;break}break;case 109:switch(r.length){case 1:case 2:d=t.m,h=r.length;break;case 3:return months[t.m-1][1];case 5:return months[t.m-1][0];default:return months[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:d=t.d,h=r.length;break;case 3:return days[t.q][0];default:return days[t.q][1]}break;case 104:switch(r.length){case 1:case 2:d=1+(t.H+11)%12,h=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:d=t.H,h=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:d=t.M,h=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?pad0(t.S,r.length):(n>=2?c=n===3?1e3:100:c=n===1?10:1,l=Math.round(c*(t.S+t.u)),l>=60*c&&(l=0),r==="s"?l===0?"0":""+l/c:(i=pad0(l,2+n),r==="ss"?i.substr(0,2):"."+i.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":d=t.D*24+t.H;break;case"[m]":case"[mm]":d=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":d=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}h=r.length===3?1:2;break;case 101:d=f,h=1;break}var p=h>0?pad0(d,h):"";return p}function commaify(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var pct1=/%/g;function write_num_pct(e,r,t){var n=r.replace(pct1,""),i=r.length-n.length;return write_num(e,n,t*Math.pow(10,2*i))+fill("%",i)}function write_num_cm(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return write_num(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function write_num_exp(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+write_num_exp(e,-r);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var l=Math.floor(Math.log(r)*Math.LOG10E)%i;if(l<0&&(l+=i),t=(r/Math.pow(10,l)).toPrecision(n+1+(i+l)%i),t.indexOf("e")===-1){var c=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+l):t+="E+"+(c-l);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,d,h,p){return d+h+p.substr(0,(i+l)%i)+"."+p.substr(l)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var frac1=/# (\?+)( ?)\/( ?)(\d+)/;function write_num_f1(e,r,t){var n=parseInt(e[4],10),i=Math.round(r*n),l=Math.floor(i/n),c=i-l*n,f=n;return t+(l===0?"":""+l)+" "+(c===0?fill(" ",e[1].length+1+e[4].length):pad_(c,e[1].length)+e[2]+"/"+e[3]+pad0(f,e[4].length))}function write_num_f2(e,r,t){return t+(r===0?"":""+r)+fill(" ",e[1].length+2+e[4].length)}var dec1=/^#*0*\.([0#]+)/,closeparen=/\).*[0#]/,phone=/\(###\) ###\\?-####/;function hashq(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function rnd(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function dec(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function carry(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function flr(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function write_num_flt(e,r,t){if(e.charCodeAt(0)===40&&!r.match(closeparen)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?write_num_flt("n",n,t):"("+write_num_flt("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return write_num_cm(e,r,t);if(r.indexOf("%")!==-1)return write_num_pct(e,r,t);if(r.indexOf("E")!==-1)return write_num_exp(r,t);if(r.charCodeAt(0)===36)return"$"+write_num_flt(e,r.substr(r.charAt(1)==" "?2:1),t);var i,l,c,f,d=Math.abs(t),h=t<0?"-":"";if(r.match(/^00+$/))return h+pad0r(d,r.length);if(r.match(/^[#?]+$/))return i=pad0r(t,0),i==="0"&&(i=""),i.length>r.length?i:hashq(r.substr(0,r.length-i.length))+i;if(l=r.match(frac1))return write_num_f1(l,d,h);if(r.match(/^#+0+$/))return h+pad0r(d,r.length-r.indexOf("0"));if(l=r.match(dec1))return i=rnd(t,l[1].length).replace(/^([^\.]+)$/,"$1."+hashq(l[1])).replace(/\.$/,"."+hashq(l[1])).replace(/\.(\d*)$/,function(x,g){return"."+g+fill("0",hashq(l[1]).length-g.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),l=r.match(/^(0*)\.(#*)$/))return h+rnd(d,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=r.match(/^#{1,3},##0(\.?)$/))return h+commaify(pad0r(d,0));if(l=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+write_num_flt(e,r,-t):commaify(""+(Math.floor(t)+carry(t,l[1].length)))+"."+pad0(dec(t,l[1].length),l[1].length);if(l=r.match(/^#,#*,#0/))return write_num_flt(e,r.replace(/^#,#*,/,""),t);if(l=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=_strrev(write_num_flt(e,r.replace(/[\\-]/g,""),t)),c=0,_strrev(_strrev(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return c<i.length?i.charAt(c++):x==="0"?"0":""}));if(r.match(phone))return i=write_num_flt(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var p="";if(l=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),f=SSF_frac(d,Math.pow(10,c)-1,!1),i=""+h,p=write_num("n",l[1],f[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),i+=p+l[2]+"/"+l[3],p=rpad_(f[2],c),p.length<l[4].length&&(p=hashq(l[4].substr(l[4].length-p.length))+p),i+=p,i;if(l=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),f=SSF_frac(d,Math.pow(10,c)-1,!0),h+(f[0]||(f[1]?"":"0"))+" "+(f[1]?pad_(f[1],c)+l[2]+"/"+l[3]+rpad_(f[2],c):fill(" ",2*c+1+l[2].length+l[3].length));if(l=r.match(/^[#0?]+$/))return i=pad0r(t,0),r.length<=i.length?i:hashq(r.substr(0,r.length-i.length))+i;if(l=r.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=i.indexOf(".");var E=r.indexOf(".")-c,y=r.length-i.length-E;return hashq(r.substr(0,E)+i+r.substr(r.length-y))}if(l=r.match(/^00,000\.([#0]*0)$/))return c=dec(t,l[1].length),t<0?"-"+write_num_flt(e,r,-t):commaify(flr(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?pad0(0,3-x.length):"")+x})+"."+pad0(c,l[1].length);switch(r){case"###,##0.00":return write_num_flt(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var S=commaify(pad0r(d,0));return S!=="0"?h+S:"";case"###,###.00":return write_num_flt(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return write_num_flt(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function write_num_cm2(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return write_num(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function write_num_pct2(e,r,t){var n=r.replace(pct1,""),i=r.length-n.length;return write_num(e,n,t*Math.pow(10,2*i))+fill("%",i)}function write_num_exp2(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+write_num_exp2(e,-r);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var l=Math.floor(Math.log(r)*Math.LOG10E)%i;if(l<0&&(l+=i),t=(r/Math.pow(10,l)).toPrecision(n+1+(i+l)%i),!t.match(/[Ee]/)){var c=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+l):t+="E+"+(c-l),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,d,h,p){return d+h+p.substr(0,(i+l)%i)+"."+p.substr(l)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function write_num_int(e,r,t){if(e.charCodeAt(0)===40&&!r.match(closeparen)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?write_num_int("n",n,t):"("+write_num_int("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return write_num_cm2(e,r,t);if(r.indexOf("%")!==-1)return write_num_pct2(e,r,t);if(r.indexOf("E")!==-1)return write_num_exp2(r,t);if(r.charCodeAt(0)===36)return"$"+write_num_int(e,r.substr(r.charAt(1)==" "?2:1),t);var i,l,c,f,d=Math.abs(t),h=t<0?"-":"";if(r.match(/^00+$/))return h+pad0(d,r.length);if(r.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>r.length?i:hashq(r.substr(0,r.length-i.length))+i;if(l=r.match(frac1))return write_num_f2(l,d,h);if(r.match(/^#+0+$/))return h+pad0(d,r.length-r.indexOf("0"));if(l=r.match(dec1))return i=(""+t).replace(/^([^\.]+)$/,"$1."+hashq(l[1])).replace(/\.$/,"."+hashq(l[1])),i=i.replace(/\.(\d*)$/,function(x,g){return"."+g+fill("0",hashq(l[1]).length-g.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),l=r.match(/^(0*)\.(#*)$/))return h+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=r.match(/^#{1,3},##0(\.?)$/))return h+commaify(""+d);if(l=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+write_num_int(e,r,-t):commaify(""+t)+"."+fill("0",l[1].length);if(l=r.match(/^#,#*,#0/))return write_num_int(e,r.replace(/^#,#*,/,""),t);if(l=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=_strrev(write_num_int(e,r.replace(/[\\-]/g,""),t)),c=0,_strrev(_strrev(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return c<i.length?i.charAt(c++):x==="0"?"0":""}));if(r.match(phone))return i=write_num_int(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var p="";if(l=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),f=SSF_frac(d,Math.pow(10,c)-1,!1),i=""+h,p=write_num("n",l[1],f[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),i+=p+l[2]+"/"+l[3],p=rpad_(f[2],c),p.length<l[4].length&&(p=hashq(l[4].substr(l[4].length-p.length))+p),i+=p,i;if(l=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),f=SSF_frac(d,Math.pow(10,c)-1,!0),h+(f[0]||(f[1]?"":"0"))+" "+(f[1]?pad_(f[1],c)+l[2]+"/"+l[3]+rpad_(f[2],c):fill(" ",2*c+1+l[2].length+l[3].length));if(l=r.match(/^[#0?]+$/))return i=""+t,r.length<=i.length?i:hashq(r.substr(0,r.length-i.length))+i;if(l=r.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=i.indexOf(".");var E=r.indexOf(".")-c,y=r.length-i.length-E;return hashq(r.substr(0,E)+i+r.substr(r.length-y))}if(l=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+write_num_int(e,r,-t):commaify(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?pad0(0,3-x.length):"")+x})+"."+pad0(0,l[1].length);switch(r){case"###,###":case"##,###":case"#,###":var S=commaify(""+d);return S!=="0"?h+S:"";default:if(r.match(/\.[0#?]*$/))return write_num_int(e,r.slice(0,r.lastIndexOf(".")),t)+hashq(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function write_num(e,r,t){return(t|0)===t?write_num_int(e,r,t):write_num_flt(e,r,t)}function SSF_split_fmt(e){for(var r=[],t=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(i,n-i),i=n+1}if(r[r.length]=e.substr(i),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var SSF_abstime=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fmt_is_date(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":SSF_isgeneral(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(SSF_abstime))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function eval_fmt(e,r,t,n){for(var i=[],l="",c=0,f="",d="t",h,p,E,y="H";c<e.length;)switch(f=e.charAt(c)){case"G":if(!SSF_isgeneral(e,c))throw new Error("unrecognized character "+f+" in "+e);i[i.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";(E=e.charCodeAt(++c))!==34&&c<e.length;)l+=String.fromCharCode(E);i[i.length]={t:"t",v:l},++c;break;case"\\":var S=e.charAt(++c),x=S==="("||S===")"?S:"t";i[i.length]={t:x,v:S},++c;break;case"_":i[i.length]={t:"t",v:" "},c+=2;break;case"@":i[i.length]={t:"T",v:r},++c;break;case"B":case"b":if(e.charAt(c+1)==="1"||e.charAt(c+1)==="2"){if(h==null&&(h=SSF_parse_date_code(r,t,e.charAt(c+1)==="2"),h==null))return"";i[i.length]={t:"X",v:e.substr(c,2)},d=f,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":f=f.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||h==null&&(h=SSF_parse_date_code(r,t),h==null))return"";for(l=f;++c<e.length&&e.charAt(c).toLowerCase()===f;)l+=f;f==="m"&&d.toLowerCase()==="h"&&(f="M"),f==="h"&&(f=y),i[i.length]={t:f,v:l},d=f;break;case"A":case"a":case"":var g={t:f,v:f};if(h==null&&(h=SSF_parse_date_code(r,t)),e.substr(c,3).toUpperCase()==="A/P"?(h!=null&&(g.v=h.H>=12?"P":"A"),g.t="T",y="h",c+=3):e.substr(c,5).toUpperCase()==="AM/PM"?(h!=null&&(g.v=h.H>=12?"PM":"AM"),g.t="T",c+=5,y="h"):e.substr(c,5).toUpperCase()==="/"?(h!=null&&(g.v=h.H>=12?"":""),g.t="T",c+=5,y="h"):(g.t="t",++c),h==null&&g.t==="T")return"";i[i.length]=g,d=f;break;case"[":for(l=f;e.charAt(c++)!=="]"&&c<e.length;)l+=e.charAt(c);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(SSF_abstime)){if(h==null&&(h=SSF_parse_date_code(r,t),h==null))return"";i[i.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",fmt_is_date(e)||(i[i.length]={t:"t",v:l}));break;case".":if(h!=null){for(l=f;++c<e.length&&(f=e.charAt(c))==="0";)l+=f;i[i.length]={t:"s",v:l};break}case"0":case"#":for(l=f;++c<e.length&&"0#?.,E+-%".indexOf(f=e.charAt(c))>-1;)l+=f;i[i.length]={t:"n",v:l};break;case"?":for(l=f;e.charAt(++c)===f;)l+=f;i[i.length]={t:f,v:l},d=f;break;case"*":++c,(e.charAt(c)==" "||e.charAt(c)=="*")&&++c;break;case"(":case")":i[i.length]={t:n===1?"t":f,v:f},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=f;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);i[i.length]={t:"D",v:l};break;case" ":i[i.length]={t:f,v:f},++c;break;case"$":i[i.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(f)===-1)throw new Error("unrecognized character "+f+" in "+e);i[i.length]={t:"t",v:f},++c;break}var m=0,A=0,O;for(c=i.length-1,d="t";c>=0;--c)switch(i[c].t){case"h":case"H":i[c].t=y,d="h",m<1&&(m=1);break;case"s":(O=i[c].v.match(/\.0+$/))&&(A=Math.max(A,O[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":d=i[c].t;break;case"m":d==="s"&&(i[c].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&i[c].v.match(/[Hh]/)&&(m=1),m<2&&i[c].v.match(/[Mm]/)&&(m=2),m<3&&i[c].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var C="",R;for(c=0;c<i.length;++c)switch(i[c].t){case"t":case"T":case" ":case"D":break;case"X":i[c].v="",i[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[c].v=SSF_write_date(i[c].t.charCodeAt(0),i[c].v,h,A),i[c].t="t";break;case"n":case"?":for(R=c+1;i[R]!=null&&((f=i[R].t)==="?"||f==="D"||(f===" "||f==="t")&&i[R+1]!=null&&(i[R+1].t==="?"||i[R+1].t==="t"&&i[R+1].v==="/")||i[c].t==="("&&(f===" "||f==="n"||f===")")||f==="t"&&(i[R].v==="/"||i[R].v===" "&&i[R+1]!=null&&i[R+1].t=="?"));)i[c].v+=i[R].v,i[R]={v:"",t:";"},++R;C+=i[c].v,c=R-1;break;case"G":i[c].t="t",i[c].v=SSF_general(r,t);break}var T="",w,v;if(C.length>0){C.charCodeAt(0)==40?(w=r<0&&C.charCodeAt(0)===45?-r:r,v=write_num("n",C,w)):(w=r<0&&n>1?-r:r,v=write_num("n",C,w),w<0&&i[0]&&i[0].t=="t"&&(v=v.substr(1),i[0].v="-"+i[0].v)),R=v.length-1;var L=i.length;for(c=0;c<i.length;++c)if(i[c]!=null&&i[c].t!="t"&&i[c].v.indexOf(".")>-1){L=c;break}var M=i.length;if(L===i.length&&v.indexOf("E")===-1){for(c=i.length-1;c>=0;--c)i[c]==null||"n?".indexOf(i[c].t)===-1||(R>=i[c].v.length-1?(R-=i[c].v.length,i[c].v=v.substr(R+1,i[c].v.length)):R<0?i[c].v="":(i[c].v=v.substr(0,R+1),R=-1),i[c].t="t",M=c);R>=0&&M<i.length&&(i[M].v=v.substr(0,R+1)+i[M].v)}else if(L!==i.length&&v.indexOf("E")===-1){for(R=v.indexOf(".")-1,c=L;c>=0;--c)if(!(i[c]==null||"n?".indexOf(i[c].t)===-1)){for(p=i[c].v.indexOf(".")>-1&&c===L?i[c].v.indexOf(".")-1:i[c].v.length-1,T=i[c].v.substr(p+1);p>=0;--p)R>=0&&(i[c].v.charAt(p)==="0"||i[c].v.charAt(p)==="#")&&(T=v.charAt(R--)+T);i[c].v=T,i[c].t="t",M=c}for(R>=0&&M<i.length&&(i[M].v=v.substr(0,R+1)+i[M].v),R=v.indexOf(".")+1,c=L;c<i.length;++c)if(!(i[c]==null||"n?(".indexOf(i[c].t)===-1&&c!==L)){for(p=i[c].v.indexOf(".")>-1&&c===L?i[c].v.indexOf(".")+1:0,T=i[c].v.substr(0,p);p<i[c].v.length;++p)R<v.length&&(T+=v.charAt(R++));i[c].v=T,i[c].t="t",M=c}}}for(c=0;c<i.length;++c)i[c]!=null&&"n?".indexOf(i[c].t)>-1&&(w=n>1&&r<0&&c>0&&i[c-1].v==="-"?-r:r,i[c].v=write_num(i[c].t,i[c].v,w),i[c].t="t");var X="";for(c=0;c!==i.length;++c)i[c]!=null&&(X+=i[c].v);return X}var cfregex2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function chkcond(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function choose_fmt(e,r){var t=SSF_split_fmt(e),n=t.length,i=t[n-1].indexOf("@");if(n<4&&i>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var l=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,l];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var c=t[0].match(cfregex2),f=t[1].match(cfregex2);return chkcond(r,c)?[n,t[0]]:chkcond(r,f)?[n,t[1]]:[n,t[c!=null&&f!=null?2:1]]}return[n,l]}function SSF_format(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:table_fmt)[e],n==null&&(n=t.table&&t.table[SSF_default_map[e]]||table_fmt[SSF_default_map[e]]),n==null&&(n=SSF_default_str[e]||"General");break}if(SSF_isgeneral(n,0))return SSF_general(r,t);r instanceof Date&&(r=datenum_local(r,t.date1904));var i=choose_fmt(n,r);if(SSF_isgeneral(i[1]))return SSF_general(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return eval_fmt(i[1],r,t,i[0])}function SSF_load(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(table_fmt[t]==null){r<0&&(r=t);continue}if(table_fmt[t]==e){r=t;break}}r<0&&(r=391)}return table_fmt[r]=e,r}function make_ssf(){table_fmt=SSF_init_table()}var SSFImplicit={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},dateNFregex=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dateNF_regex(e){var r=typeof e=="number"?table_fmt[e]:e;return r=r.replace(dateNFregex,"(\\d+)"),new RegExp("^"+r+"$")}function dateNF_fix(e,r,t){var n=-1,i=-1,l=-1,c=-1,f=-1,d=-1;(r.match(dateNFregex)||[]).forEach(function(E,y){var S=parseInt(t[y+1],10);switch(E.toLowerCase().charAt(0)){case"y":n=S;break;case"d":l=S;break;case"h":c=S;break;case"s":d=S;break;case"m":c>=0?f=S:i=S;break}}),d>=0&&f==-1&&i>=0&&(f=i,i=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var p=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return c==-1&&f==-1&&d==-1?h:n==-1&&i==-1&&l==-1?p:h+"T"+p}var CRC32=function(){var e={};e.version="1.2.0";function r(){for(var v=0,L=new Array(256),M=0;M!=256;++M)v=M,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,v=v&1?-306674912^v>>>1:v>>>1,L[M]=v;return typeof Int32Array<"u"?new Int32Array(L):L}var t=r();function n(v){var L=0,M=0,X=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(X=0;X!=256;++X)H[X]=v[X];for(X=0;X!=256;++X)for(M=v[X],L=256+X;L<4096;L+=256)M=H[L]=M>>>8^v[M&255];var ne=[];for(X=1;X!=16;++X)ne[X-1]=typeof Int32Array<"u"?H.subarray(X*256,X*256+256):H.slice(X*256,X*256+256);return ne}var i=n(t),l=i[0],c=i[1],f=i[2],d=i[3],h=i[4],p=i[5],E=i[6],y=i[7],S=i[8],x=i[9],g=i[10],m=i[11],A=i[12],O=i[13],C=i[14];function R(v,L){for(var M=L^-1,X=0,H=v.length;X<H;)M=M>>>8^t[(M^v.charCodeAt(X++))&255];return~M}function T(v,L){for(var M=L^-1,X=v.length-15,H=0;H<X;)M=C[v[H++]^M&255]^O[v[H++]^M>>8&255]^A[v[H++]^M>>16&255]^m[v[H++]^M>>>24]^g[v[H++]]^x[v[H++]]^S[v[H++]]^y[v[H++]]^E[v[H++]]^p[v[H++]]^h[v[H++]]^d[v[H++]]^f[v[H++]]^c[v[H++]]^l[v[H++]]^t[v[H++]];for(X+=15;H<X;)M=M>>>8^t[(M^v[H++])&255];return~M}function w(v,L){for(var M=L^-1,X=0,H=v.length,ne=0,_e=0;X<H;)ne=v.charCodeAt(X++),ne<128?M=M>>>8^t[(M^ne)&255]:ne<2048?(M=M>>>8^t[(M^(192|ne>>6&31))&255],M=M>>>8^t[(M^(128|ne&63))&255]):ne>=55296&&ne<57344?(ne=(ne&1023)+64,_e=v.charCodeAt(X++)&1023,M=M>>>8^t[(M^(240|ne>>8&7))&255],M=M>>>8^t[(M^(128|ne>>2&63))&255],M=M>>>8^t[(M^(128|_e>>6&15|(ne&3)<<4))&255],M=M>>>8^t[(M^(128|_e&63))&255]):(M=M>>>8^t[(M^(224|ne>>12&15))&255],M=M>>>8^t[(M^(128|ne>>6&63))&255],M=M>>>8^t[(M^(128|ne&63))&255]);return~M}return e.table=t,e.bstr=R,e.buf=T,e.str=w,e}(),CFB=function(){var r={};r.version="1.2.1";function t(G,le){for(var ee=G.split("/"),ae=le.split("/"),ce=0,fe=0,Fe=Math.min(ee.length,ae.length);ce<Fe;++ce){if(fe=ee[ce].length-ae[ce].length)return fe;if(ee[ce]!=ae[ce])return ee[ce]<ae[ce]?-1:1}return ee.length-ae.length}function n(G){if(G.charAt(G.length-1)=="/")return G.slice(0,-1).indexOf("/")===-1?G:n(G.slice(0,-1));var le=G.lastIndexOf("/");return le===-1?G:G.slice(0,le+1)}function i(G){if(G.charAt(G.length-1)=="/")return i(G.slice(0,-1));var le=G.lastIndexOf("/");return le===-1?G:G.slice(le+1)}function l(G,le){typeof le=="string"&&(le=new Date(le));var ee=le.getHours();ee=ee<<6|le.getMinutes(),ee=ee<<5|le.getSeconds()>>>1,G.write_shift(2,ee);var ae=le.getFullYear()-1980;ae=ae<<4|le.getMonth()+1,ae=ae<<5|le.getDate(),G.write_shift(2,ae)}function c(G){var le=G.read_shift(2)&65535,ee=G.read_shift(2)&65535,ae=new Date,ce=ee&31;ee>>>=5;var fe=ee&15;ee>>>=4,ae.setMilliseconds(0),ae.setFullYear(ee+1980),ae.setMonth(fe-1),ae.setDate(ce);var Fe=le&31;le>>>=5;var Ne=le&63;return le>>>=6,ae.setHours(le),ae.setMinutes(Ne),ae.setSeconds(Fe<<1),ae}function f(G){prep_blob(G,0);for(var le={},ee=0;G.l<=G.length-4;){var ae=G.read_shift(2),ce=G.read_shift(2),fe=G.l+ce,Fe={};switch(ae){case 21589:ee=G.read_shift(1),ee&1&&(Fe.mtime=G.read_shift(4)),ce>5&&(ee&2&&(Fe.atime=G.read_shift(4)),ee&4&&(Fe.ctime=G.read_shift(4))),Fe.mtime&&(Fe.mt=new Date(Fe.mtime*1e3));break}G.l=fe,le[ae]=Fe}return le}var d;function h(){return d||(d={})}function p(G,le){if(G[0]==80&&G[1]==75)return Se(G,le);if((G[0]|32)==109&&(G[1]|32)==105)return gr(G,le);if(G.length<512)throw new Error("CFB file size "+G.length+" < 512");var ee=3,ae=512,ce=0,fe=0,Fe=0,Ne=0,ke=0,Re=[],Oe=G.slice(0,512);prep_blob(Oe,0);var He=E(Oe);switch(ee=He[0],ee){case 3:ae=512;break;case 4:ae=4096;break;case 0:if(He[1]==0)return Se(G,le);default:throw new Error("Major Version: Expected 3 or 4 saw "+ee)}ae!==512&&(Oe=G.slice(0,ae),prep_blob(Oe,28));var $e=G.slice(0,ae);y(Oe,ee);var Ye=Oe.read_shift(4,"i");if(ee===3&&Ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ye);Oe.l+=4,Fe=Oe.read_shift(4,"i"),Oe.l+=4,Oe.chk("00100000","Mini Stream Cutoff Size: "),Ne=Oe.read_shift(4,"i"),ce=Oe.read_shift(4,"i"),ke=Oe.read_shift(4,"i"),fe=Oe.read_shift(4,"i");for(var Ve=-1,Xe=0;Xe<109&&(Ve=Oe.read_shift(4,"i"),!(Ve<0));++Xe)Re[Xe]=Ve;var ct=S(G,ae);m(ke,fe,ct,ae,Re);var wt=O(ct,Fe,Re,ae);wt[Fe].name="!Directory",ce>0&&Ne!==_e&&(wt[Ne].name="!MiniFAT"),wt[Re[0]].name="!FAT",wt.fat_addrs=Re,wt.ssz=ae;var St={},Ft=[],tr=[],ka=[];C(Fe,wt,ct,Ft,ce,St,tr,Ne),x(tr,ka,Ft),Ft.shift();var ia={FileIndex:tr,FullPaths:ka};return le&&le.raw&&(ia.raw={header:$e,sectors:ct}),ia}function E(G){if(G[G.l]==80&&G[G.l+1]==75)return[0,0];G.chk(ge,"Header Signature: "),G.l+=16;var le=G.read_shift(2,"u");return[G.read_shift(2,"u"),le]}function y(G,le){var ee=9;switch(G.l+=2,ee=G.read_shift(2)){case 9:if(le!=3)throw new Error("Sector Shift: Expected 9 saw "+ee);break;case 12:if(le!=4)throw new Error("Sector Shift: Expected 12 saw "+ee);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ee)}G.chk("0600","Mini Sector Shift: "),G.chk("000000000000","Reserved: ")}function S(G,le){for(var ee=Math.ceil(G.length/le)-1,ae=[],ce=1;ce<ee;++ce)ae[ce-1]=G.slice(ce*le,(ce+1)*le);return ae[ee-1]=G.slice(ee*le),ae}function x(G,le,ee){for(var ae=0,ce=0,fe=0,Fe=0,Ne=0,ke=ee.length,Re=[],Oe=[];ae<ke;++ae)Re[ae]=Oe[ae]=ae,le[ae]=ee[ae];for(;Ne<Oe.length;++Ne)ae=Oe[Ne],ce=G[ae].L,fe=G[ae].R,Fe=G[ae].C,Re[ae]===ae&&(ce!==-1&&Re[ce]!==ce&&(Re[ae]=Re[ce]),fe!==-1&&Re[fe]!==fe&&(Re[ae]=Re[fe])),Fe!==-1&&(Re[Fe]=ae),ce!==-1&&ae!=Re[ae]&&(Re[ce]=Re[ae],Oe.lastIndexOf(ce)<Ne&&Oe.push(ce)),fe!==-1&&ae!=Re[ae]&&(Re[fe]=Re[ae],Oe.lastIndexOf(fe)<Ne&&Oe.push(fe));for(ae=1;ae<ke;++ae)Re[ae]===ae&&(fe!==-1&&Re[fe]!==fe?Re[ae]=Re[fe]:ce!==-1&&Re[ce]!==ce&&(Re[ae]=Re[ce]));for(ae=1;ae<ke;++ae)if(G[ae].type!==0){if(Ne=ae,Ne!=Re[Ne])do Ne=Re[Ne],le[ae]=le[Ne]+"/"+le[ae];while(Ne!==0&&Re[Ne]!==-1&&Ne!=Re[Ne]);Re[ae]=-1}for(le[0]+="/",ae=1;ae<ke;++ae)G[ae].type!==2&&(le[ae]+="/")}function g(G,le,ee){for(var ae=G.start,ce=G.size,fe=[],Fe=ae;ee&&ce>0&&Fe>=0;)fe.push(le.slice(Fe*ne,Fe*ne+ne)),ce-=ne,Fe=__readInt32LE(ee,Fe*4);return fe.length===0?new_buf(0):bconcat(fe).slice(0,G.size)}function m(G,le,ee,ae,ce){var fe=_e;if(G===_e){if(le!==0)throw new Error("DIFAT chain shorter than expected")}else if(G!==-1){var Fe=ee[G],Ne=(ae>>>2)-1;if(!Fe)return;for(var ke=0;ke<Ne&&(fe=__readInt32LE(Fe,ke*4))!==_e;++ke)ce.push(fe);m(__readInt32LE(Fe,ae-4),le-1,ee,ae,ce)}}function A(G,le,ee,ae,ce){var fe=[],Fe=[];ce||(ce=[]);var Ne=ae-1,ke=0,Re=0;for(ke=le;ke>=0;){ce[ke]=!0,fe[fe.length]=ke,Fe.push(G[ke]);var Oe=ee[Math.floor(ke*4/ae)];if(Re=ke*4&Ne,ae<4+Re)throw new Error("FAT boundary crossed: "+ke+" 4 "+ae);if(!G[Oe])break;ke=__readInt32LE(G[Oe],Re)}return{nodes:fe,data:__toBuffer([Fe])}}function O(G,le,ee,ae){var ce=G.length,fe=[],Fe=[],Ne=[],ke=[],Re=ae-1,Oe=0,He=0,$e=0,Ye=0;for(Oe=0;Oe<ce;++Oe)if(Ne=[],$e=Oe+le,$e>=ce&&($e-=ce),!Fe[$e]){ke=[];var Ve=[];for(He=$e;He>=0;){Ve[He]=!0,Fe[He]=!0,Ne[Ne.length]=He,ke.push(G[He]);var Xe=ee[Math.floor(He*4/ae)];if(Ye=He*4&Re,ae<4+Ye)throw new Error("FAT boundary crossed: "+He+" 4 "+ae);if(!G[Xe]||(He=__readInt32LE(G[Xe],Ye),Ve[He]))break}fe[$e]={nodes:Ne,data:__toBuffer([ke])}}return fe}function C(G,le,ee,ae,ce,fe,Fe,Ne){for(var ke=0,Re=ae.length?2:0,Oe=le[G].data,He=0,$e=0,Ye;He<Oe.length;He+=128){var Ve=Oe.slice(He,He+128);prep_blob(Ve,64),$e=Ve.read_shift(2),Ye=__utf16le(Ve,0,$e-Re),ae.push(Ye);var Xe={name:Ye,type:Ve.read_shift(1),color:Ve.read_shift(1),L:Ve.read_shift(4,"i"),R:Ve.read_shift(4,"i"),C:Ve.read_shift(4,"i"),clsid:Ve.read_shift(16),state:Ve.read_shift(4,"i"),start:0,size:0},ct=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);ct!==0&&(Xe.ct=R(Ve,Ve.l-8));var wt=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);wt!==0&&(Xe.mt=R(Ve,Ve.l-8)),Xe.start=Ve.read_shift(4,"i"),Xe.size=Ve.read_shift(4,"i"),Xe.size<0&&Xe.start<0&&(Xe.size=Xe.type=0,Xe.start=_e,Xe.name=""),Xe.type===5?(ke=Xe.start,ce>0&&ke!==_e&&(le[ke].name="!StreamData")):Xe.size>=4096?(Xe.storage="fat",le[Xe.start]===void 0&&(le[Xe.start]=A(ee,Xe.start,le.fat_addrs,le.ssz)),le[Xe.start].name=Xe.name,Xe.content=le[Xe.start].data.slice(0,Xe.size)):(Xe.storage="minifat",Xe.size<0?Xe.size=0:ke!==_e&&Xe.start!==_e&&le[ke]&&(Xe.content=g(Xe,le[ke].data,(le[Ne]||{}).data))),Xe.content&&prep_blob(Xe.content,0),fe[Ye]=Xe,Fe.push(Xe)}}function R(G,le){return new Date((__readUInt32LE(G,le+4)/1e7*Math.pow(2,32)+__readUInt32LE(G,le)/1e7-11644473600)*1e3)}function T(G,le){return h(),p(d.readFileSync(G),le)}function w(G,le){var ee=le&&le.type;switch(ee||has_buf&&Buffer.isBuffer(G)&&(ee="buffer"),ee||"base64"){case"file":return T(G,le);case"base64":return p(s2a(Base64_decode(G)),le);case"binary":return p(s2a(G),le)}return p(G,le)}function v(G,le){var ee=le||{},ae=ee.root||"Root Entry";if(G.FullPaths||(G.FullPaths=[]),G.FileIndex||(G.FileIndex=[]),G.FullPaths.length!==G.FileIndex.length)throw new Error("inconsistent CFB structure");G.FullPaths.length===0&&(G.FullPaths[0]=ae+"/",G.FileIndex[0]={name:ae,type:5}),ee.CLSID&&(G.FileIndex[0].clsid=ee.CLSID),L(G)}function L(G){var le="Sh33tJ5";if(!CFB.find(G,"/"+le)){var ee=new_buf(4);ee[0]=55,ee[1]=ee[3]=50,ee[2]=54,G.FileIndex.push({name:le,type:2,content:ee,size:4,L:69,R:69,C:69}),G.FullPaths.push(G.FullPaths[0]+le),M(G)}}function M(G,le){v(G);for(var ee=!1,ae=!1,ce=G.FullPaths.length-1;ce>=0;--ce){var fe=G.FileIndex[ce];switch(fe.type){case 0:ae?ee=!0:(G.FileIndex.pop(),G.FullPaths.pop());break;case 1:case 2:case 5:ae=!0,isNaN(fe.R*fe.L*fe.C)&&(ee=!0),fe.R>-1&&fe.L>-1&&fe.R==fe.L&&(ee=!0);break;default:ee=!0;break}}if(!(!ee&&!le)){var Fe=new Date(1987,1,19),Ne=0,ke=Object.create?Object.create(null):{},Re=[];for(ce=0;ce<G.FullPaths.length;++ce)ke[G.FullPaths[ce]]=!0,G.FileIndex[ce].type!==0&&Re.push([G.FullPaths[ce],G.FileIndex[ce]]);for(ce=0;ce<Re.length;++ce){var Oe=n(Re[ce][0]);ae=ke[Oe],ae||(Re.push([Oe,{name:i(Oe).replace("/",""),type:1,clsid:W,ct:Fe,mt:Fe,content:null}]),ke[Oe]=!0)}for(Re.sort(function(Ye,Ve){return t(Ye[0],Ve[0])}),G.FullPaths=[],G.FileIndex=[],ce=0;ce<Re.length;++ce)G.FullPaths[ce]=Re[ce][0],G.FileIndex[ce]=Re[ce][1];for(ce=0;ce<Re.length;++ce){var He=G.FileIndex[ce],$e=G.FullPaths[ce];if(He.name=i($e).replace("/",""),He.L=He.R=He.C=-(He.color=1),He.size=He.content?He.content.length:0,He.start=0,He.clsid=He.clsid||W,ce===0)He.C=Re.length>1?1:-1,He.size=0,He.type=5;else if($e.slice(-1)=="/"){for(Ne=ce+1;Ne<Re.length&&n(G.FullPaths[Ne])!=$e;++Ne);for(He.C=Ne>=Re.length?-1:Ne,Ne=ce+1;Ne<Re.length&&n(G.FullPaths[Ne])!=n($e);++Ne);He.R=Ne>=Re.length?-1:Ne,He.type=1}else n(G.FullPaths[ce+1]||"")==n($e)&&(He.R=ce+1),He.type=2}}}function X(G,le){var ee=le||{};if(ee.fileType=="mad")return Zt(G,ee);switch(M(G),ee.fileType){case"zip":return ot(G,ee)}var ae=function(Ye){for(var Ve=0,Xe=0,ct=0;ct<Ye.FileIndex.length;++ct){var wt=Ye.FileIndex[ct];if(wt.content){var St=wt.content.length;St>0&&(St<4096?Ve+=St+63>>6:Xe+=St+511>>9)}}for(var Ft=Ye.FullPaths.length+3>>2,tr=Ve+7>>3,ka=Ve+127>>7,ia=tr+Xe+Ft+ka,Pr=ia+127>>7,kn=Pr<=109?0:Math.ceil((Pr-109)/127);ia+Pr+kn+127>>7>Pr;)kn=++Pr<=109?0:Math.ceil((Pr-109)/127);var nr=[1,kn,Pr,ka,Ft,Xe,Ve,0];return Ye.FileIndex[0].size=Ve<<6,nr[7]=(Ye.FileIndex[0].start=nr[0]+nr[1]+nr[2]+nr[3]+nr[4]+nr[5])+(nr[6]+7>>3),nr}(G),ce=new_buf(ae[7]<<9),fe=0,Fe=0;{for(fe=0;fe<8;++fe)ce.write_shift(1,he[fe]);for(fe=0;fe<8;++fe)ce.write_shift(2,0);for(ce.write_shift(2,62),ce.write_shift(2,3),ce.write_shift(2,65534),ce.write_shift(2,9),ce.write_shift(2,6),fe=0;fe<3;++fe)ce.write_shift(2,0);for(ce.write_shift(4,0),ce.write_shift(4,ae[2]),ce.write_shift(4,ae[0]+ae[1]+ae[2]+ae[3]-1),ce.write_shift(4,0),ce.write_shift(4,4096),ce.write_shift(4,ae[3]?ae[0]+ae[1]+ae[2]-1:_e),ce.write_shift(4,ae[3]),ce.write_shift(-4,ae[1]?ae[0]-1:_e),ce.write_shift(4,ae[1]),fe=0;fe<109;++fe)ce.write_shift(-4,fe<ae[2]?ae[1]+fe:-1)}if(ae[1])for(Fe=0;Fe<ae[1];++Fe){for(;fe<236+Fe*127;++fe)ce.write_shift(-4,fe<ae[2]?ae[1]+fe:-1);ce.write_shift(-4,Fe===ae[1]-1?_e:Fe+1)}var Ne=function(Ye){for(Fe+=Ye;fe<Fe-1;++fe)ce.write_shift(-4,fe+1);Ye&&(++fe,ce.write_shift(-4,_e))};for(Fe=fe=0,Fe+=ae[1];fe<Fe;++fe)ce.write_shift(-4,se.DIFSECT);for(Fe+=ae[2];fe<Fe;++fe)ce.write_shift(-4,se.FATSECT);Ne(ae[3]),Ne(ae[4]);for(var ke=0,Re=0,Oe=G.FileIndex[0];ke<G.FileIndex.length;++ke)Oe=G.FileIndex[ke],Oe.content&&(Re=Oe.content.length,!(Re<4096)&&(Oe.start=Fe,Ne(Re+511>>9)));for(Ne(ae[6]+7>>3);ce.l&511;)ce.write_shift(-4,se.ENDOFCHAIN);for(Fe=fe=0,ke=0;ke<G.FileIndex.length;++ke)Oe=G.FileIndex[ke],Oe.content&&(Re=Oe.content.length,!(!Re||Re>=4096)&&(Oe.start=Fe,Ne(Re+63>>6)));for(;ce.l&511;)ce.write_shift(-4,se.ENDOFCHAIN);for(fe=0;fe<ae[4]<<2;++fe){var He=G.FullPaths[fe];if(!He||He.length===0){for(ke=0;ke<17;++ke)ce.write_shift(4,0);for(ke=0;ke<3;++ke)ce.write_shift(4,-1);for(ke=0;ke<12;++ke)ce.write_shift(4,0);continue}Oe=G.FileIndex[fe],fe===0&&(Oe.start=Oe.size?Oe.start-1:_e);var $e=fe===0&&ee.root||Oe.name;if(Re=2*($e.length+1),ce.write_shift(64,$e,"utf16le"),ce.write_shift(2,Re),ce.write_shift(1,Oe.type),ce.write_shift(1,Oe.color),ce.write_shift(-4,Oe.L),ce.write_shift(-4,Oe.R),ce.write_shift(-4,Oe.C),Oe.clsid)ce.write_shift(16,Oe.clsid,"hex");else for(ke=0;ke<4;++ke)ce.write_shift(4,0);ce.write_shift(4,Oe.state||0),ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(4,Oe.start),ce.write_shift(4,Oe.size),ce.write_shift(4,0)}for(fe=1;fe<G.FileIndex.length;++fe)if(Oe=G.FileIndex[fe],Oe.size>=4096)if(ce.l=Oe.start+1<<9,has_buf&&Buffer.isBuffer(Oe.content))Oe.content.copy(ce,ce.l,0,Oe.size),ce.l+=Oe.size+511&-512;else{for(ke=0;ke<Oe.size;++ke)ce.write_shift(1,Oe.content[ke]);for(;ke&511;++ke)ce.write_shift(1,0)}for(fe=1;fe<G.FileIndex.length;++fe)if(Oe=G.FileIndex[fe],Oe.size>0&&Oe.size<4096)if(has_buf&&Buffer.isBuffer(Oe.content))Oe.content.copy(ce,ce.l,0,Oe.size),ce.l+=Oe.size+63&-64;else{for(ke=0;ke<Oe.size;++ke)ce.write_shift(1,Oe.content[ke]);for(;ke&63;++ke)ce.write_shift(1,0)}if(has_buf)ce.l=ce.length;else for(;ce.l<ce.length;)ce.write_shift(1,0);return ce}function H(G,le){var ee=G.FullPaths.map(function(ke){return ke.toUpperCase()}),ae=ee.map(function(ke){var Re=ke.split("/");return Re[Re.length-(ke.slice(-1)=="/"?2:1)]}),ce=!1;le.charCodeAt(0)===47?(ce=!0,le=ee[0].slice(0,-1)+le):ce=le.indexOf("/")!==-1;var fe=le.toUpperCase(),Fe=ce===!0?ee.indexOf(fe):ae.indexOf(fe);if(Fe!==-1)return G.FileIndex[Fe];var Ne=!fe.match(chr1);for(fe=fe.replace(chr0,""),Ne&&(fe=fe.replace(chr1,"!")),Fe=0;Fe<ee.length;++Fe)if((Ne?ee[Fe].replace(chr1,"!"):ee[Fe]).replace(chr0,"")==fe||(Ne?ae[Fe].replace(chr1,"!"):ae[Fe]).replace(chr0,"")==fe)return G.FileIndex[Fe];return null}var ne=64,_e=-2,ge="d0cf11e0a1b11ae1",he=[208,207,17,224,161,177,26,225],W="00000000000000000000000000000000",se={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:_e,FREESECT:-1,HEADER_SIGNATURE:ge,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:W,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ue(G,le,ee){h();var ae=X(G,ee);d.writeFileSync(le,ae)}function re(G){for(var le=new Array(G.length),ee=0;ee<G.length;++ee)le[ee]=String.fromCharCode(G[ee]);return le.join("")}function q(G,le){var ee=X(G,le);switch(le&&le.type||"buffer"){case"file":return h(),d.writeFileSync(le.filename,ee),ee;case"binary":return typeof ee=="string"?ee:re(ee);case"base64":return Base64_encode(typeof ee=="string"?ee:re(ee));case"buffer":if(has_buf)return Buffer.isBuffer(ee)?ee:Buffer_from(ee);case"array":return typeof ee=="string"?s2a(ee):ee}return ee}var me;function N(G){try{var le=G.InflateRaw,ee=new le;if(ee._processChunk(new Uint8Array([3,0]),ee._finishFlushFlag),ee.bytesRead)me=G;else throw new Error("zlib does not expose bytesRead")}catch(ae){console.error("cannot use native zlib: "+(ae.message||ae))}}function P(G,le){if(!me)return Pe(G,le);var ee=me.InflateRaw,ae=new ee,ce=ae._processChunk(G.slice(G.l),ae._finishFlushFlag);return G.l+=ae.bytesRead,ce}function k(G){return me?me.deflateRawSync(G):Je(G)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function K(G){var le=(G<<1|G<<11)&139536|(G<<5|G<<15)&558144;return(le>>16|le>>8|le)&255}for(var F=typeof Uint8Array<"u",I=F?new Uint8Array(256):[],V=0;V<256;++V)I[V]=K(V);function D(G,le){var ee=I[G&255];return le<=8?ee>>>8-le:(ee=ee<<8|I[G>>8&255],le<=16?ee>>>16-le:(ee=ee<<8|I[G>>16&255],ee>>>24-le))}function Y(G,le){var ee=le&7,ae=le>>>3;return(G[ae]|(ee<=6?0:G[ae+1]<<8))>>>ee&3}function ie(G,le){var ee=le&7,ae=le>>>3;return(G[ae]|(ee<=5?0:G[ae+1]<<8))>>>ee&7}function te(G,le){var ee=le&7,ae=le>>>3;return(G[ae]|(ee<=4?0:G[ae+1]<<8))>>>ee&15}function j(G,le){var ee=le&7,ae=le>>>3;return(G[ae]|(ee<=3?0:G[ae+1]<<8))>>>ee&31}function J(G,le){var ee=le&7,ae=le>>>3;return(G[ae]|(ee<=1?0:G[ae+1]<<8))>>>ee&127}function Ae(G,le,ee){var ae=le&7,ce=le>>>3,fe=(1<<ee)-1,Fe=G[ce]>>>ae;return ee<8-ae||(Fe|=G[ce+1]<<8-ae,ee<16-ae)||(Fe|=G[ce+2]<<16-ae,ee<24-ae)||(Fe|=G[ce+3]<<24-ae),Fe&fe}function pe(G,le,ee){var ae=le&7,ce=le>>>3;return ae<=5?G[ce]|=(ee&7)<<ae:(G[ce]|=ee<<ae&255,G[ce+1]=(ee&7)>>8-ae),le+3}function ve(G,le,ee){var ae=le&7,ce=le>>>3;return ee=(ee&1)<<ae,G[ce]|=ee,le+1}function Te(G,le,ee){var ae=le&7,ce=le>>>3;return ee<<=ae,G[ce]|=ee&255,ee>>>=8,G[ce+1]=ee,le+8}function Me(G,le,ee){var ae=le&7,ce=le>>>3;return ee<<=ae,G[ce]|=ee&255,ee>>>=8,G[ce+1]=ee&255,G[ce+2]=ee>>>8,le+16}function ze(G,le){var ee=G.length,ae=2*ee>le?2*ee:le+5,ce=0;if(ee>=le)return G;if(has_buf){var fe=new_unsafe_buf(ae);if(G.copy)G.copy(fe);else for(;ce<G.length;++ce)fe[ce]=G[ce];return fe}else if(F){var Fe=new Uint8Array(ae);if(Fe.set)Fe.set(G);else for(;ce<ee;++ce)Fe[ce]=G[ce];return Fe}return G.length=ae,G}function we(G){for(var le=new Array(G),ee=0;ee<G;++ee)le[ee]=0;return le}function at(G,le,ee){var ae=1,ce=0,fe=0,Fe=0,Ne=0,ke=G.length,Re=F?new Uint16Array(32):we(32);for(fe=0;fe<32;++fe)Re[fe]=0;for(fe=ke;fe<ee;++fe)G[fe]=0;ke=G.length;var Oe=F?new Uint16Array(ke):we(ke);for(fe=0;fe<ke;++fe)Re[ce=G[fe]]++,ae<ce&&(ae=ce),Oe[fe]=0;for(Re[0]=0,fe=1;fe<=ae;++fe)Re[fe+16]=Ne=Ne+Re[fe-1]<<1;for(fe=0;fe<ke;++fe)Ne=G[fe],Ne!=0&&(Oe[fe]=Re[Ne+16]++);var He=0;for(fe=0;fe<ke;++fe)if(He=G[fe],He!=0)for(Ne=D(Oe[fe],ae)>>ae-He,Fe=(1<<ae+4-He)-1;Fe>=0;--Fe)le[Ne|Fe<<He]=He&15|fe<<4;return ae}var et=F?new Uint16Array(512):we(512),Ke=F?new Uint16Array(32):we(32);if(!F){for(var Ze=0;Ze<512;++Ze)et[Ze]=0;for(Ze=0;Ze<32;++Ze)Ke[Ze]=0}(function(){for(var G=[],le=0;le<32;le++)G.push(5);at(G,Ke,32);var ee=[];for(le=0;le<=143;le++)ee.push(8);for(;le<=255;le++)ee.push(9);for(;le<=279;le++)ee.push(7);for(;le<=287;le++)ee.push(8);at(ee,et,288)})();var ft=function(){for(var le=F?new Uint8Array(32768):[],ee=0,ae=0;ee<Q.length-1;++ee)for(;ae<Q[ee+1];++ae)le[ae]=ee;for(;ae<32768;++ae)le[ae]=29;var ce=F?new Uint8Array(259):[];for(ee=0,ae=0;ee<z.length-1;++ee)for(;ae<z[ee+1];++ae)ce[ae]=ee;function fe(Ne,ke){for(var Re=0;Re<Ne.length;){var Oe=Math.min(65535,Ne.length-Re),He=Re+Oe==Ne.length;for(ke.write_shift(1,+He),ke.write_shift(2,Oe),ke.write_shift(2,~Oe&65535);Oe-- >0;)ke[ke.l++]=Ne[Re++]}return ke.l}function Fe(Ne,ke){for(var Re=0,Oe=0,He=F?new Uint16Array(32768):[];Oe<Ne.length;){var $e=Math.min(65535,Ne.length-Oe);if($e<10){for(Re=pe(ke,Re,+(Oe+$e==Ne.length)),Re&7&&(Re+=8-(Re&7)),ke.l=Re/8|0,ke.write_shift(2,$e),ke.write_shift(2,~$e&65535);$e-- >0;)ke[ke.l++]=Ne[Oe++];Re=ke.l*8;continue}Re=pe(ke,Re,+(Oe+$e==Ne.length)+2);for(var Ye=0;$e-- >0;){var Ve=Ne[Oe];Ye=(Ye<<5^Ve)&32767;var Xe=-1,ct=0;if((Xe=He[Ye])&&(Xe|=Oe&-32768,Xe>Oe&&(Xe-=32768),Xe<Oe))for(;Ne[Xe+ct]==Ne[Oe+ct]&&ct<250;)++ct;if(ct>2){Ve=ce[ct],Ve<=22?Re=Te(ke,Re,I[Ve+1]>>1)-1:(Te(ke,Re,3),Re+=5,Te(ke,Re,I[Ve-23]>>5),Re+=3);var wt=Ve<8?0:Ve-4>>2;wt>0&&(Me(ke,Re,ct-z[Ve]),Re+=wt),Ve=le[Oe-Xe],Re=Te(ke,Re,I[Ve]>>3),Re-=3;var St=Ve<4?0:Ve-2>>1;St>0&&(Me(ke,Re,Oe-Xe-Q[Ve]),Re+=St);for(var Ft=0;Ft<ct;++Ft)He[Ye]=Oe&32767,Ye=(Ye<<5^Ne[Oe])&32767,++Oe;$e-=ct-1}else Ve<=143?Ve=Ve+48:Re=ve(ke,Re,1),Re=Te(ke,Re,I[Ve]),He[Ye]=Oe&32767,++Oe}Re=Te(ke,Re,0)-1}return ke.l=(Re+7)/8|0,ke.l}return function(ke,Re){return ke.length<8?fe(ke,Re):Fe(ke,Re)}}();function Je(G){var le=new_buf(50+Math.floor(G.length*1.1)),ee=ft(G,le);return le.slice(0,ee)}var st=F?new Uint16Array(32768):we(32768),dt=F?new Uint16Array(32768):we(32768),nt=F?new Uint16Array(128):we(128),lt=1,or=1;function Wt(G,le){var ee=j(G,le)+257;le+=5;var ae=j(G,le)+1;le+=5;var ce=te(G,le)+4;le+=4;for(var fe=0,Fe=F?new Uint8Array(19):we(19),Ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ke=1,Re=F?new Uint8Array(8):we(8),Oe=F?new Uint8Array(8):we(8),He=Fe.length,$e=0;$e<ce;++$e)Fe[B[$e]]=fe=ie(G,le),ke<fe&&(ke=fe),Re[fe]++,le+=3;var Ye=0;for(Re[0]=0,$e=1;$e<=ke;++$e)Oe[$e]=Ye=Ye+Re[$e-1]<<1;for($e=0;$e<He;++$e)(Ye=Fe[$e])!=0&&(Ne[$e]=Oe[Ye]++);var Ve=0;for($e=0;$e<He;++$e)if(Ve=Fe[$e],Ve!=0){Ye=I[Ne[$e]]>>8-Ve;for(var Xe=(1<<7-Ve)-1;Xe>=0;--Xe)nt[Ye|Xe<<Ve]=Ve&7|$e<<3}var ct=[];for(ke=1;ct.length<ee+ae;)switch(Ye=nt[J(G,le)],le+=Ye&7,Ye>>>=3){case 16:for(fe=3+Y(G,le),le+=2,Ye=ct[ct.length-1];fe-- >0;)ct.push(Ye);break;case 17:for(fe=3+ie(G,le),le+=3;fe-- >0;)ct.push(0);break;case 18:for(fe=11+J(G,le),le+=7;fe-- >0;)ct.push(0);break;default:ct.push(Ye),ke<Ye&&(ke=Ye);break}var wt=ct.slice(0,ee),St=ct.slice(ee);for($e=ee;$e<286;++$e)wt[$e]=0;for($e=ae;$e<30;++$e)St[$e]=0;return lt=at(wt,st,286),or=at(St,dt,30),le}function Pt(G,le){if(G[0]==3&&!(G[1]&3))return[new_raw_buf(le),2];for(var ee=0,ae=0,ce=new_unsafe_buf(le||1<<18),fe=0,Fe=ce.length>>>0,Ne=0,ke=0;!(ae&1);){if(ae=ie(G,ee),ee+=3,ae>>>1)ae>>1==1?(Ne=9,ke=5):(ee=Wt(G,ee),Ne=lt,ke=or);else{ee&7&&(ee+=8-(ee&7));var Re=G[ee>>>3]|G[(ee>>>3)+1]<<8;if(ee+=32,Re>0)for(!le&&Fe<fe+Re&&(ce=ze(ce,fe+Re),Fe=ce.length);Re-- >0;)ce[fe++]=G[ee>>>3],ee+=8;continue}for(;;){!le&&Fe<fe+32767&&(ce=ze(ce,fe+32767),Fe=ce.length);var Oe=Ae(G,ee,Ne),He=ae>>>1==1?et[Oe]:st[Oe];if(ee+=He&15,He>>>=4,!(He>>>8&255))ce[fe++]=He;else{if(He==256)break;He-=257;var $e=He<8?0:He-4>>2;$e>5&&($e=0);var Ye=fe+z[He];$e>0&&(Ye+=Ae(G,ee,$e),ee+=$e),Oe=Ae(G,ee,ke),He=ae>>>1==1?Ke[Oe]:dt[Oe],ee+=He&15,He>>>=4;var Ve=He<4?0:He-2>>1,Xe=Q[He];for(Ve>0&&(Xe+=Ae(G,ee,Ve),ee+=Ve),!le&&Fe<Ye&&(ce=ze(ce,Ye+100),Fe=ce.length);fe<Ye;)ce[fe]=ce[fe-Xe],++fe}}}return le?[ce,ee+7>>>3]:[ce.slice(0,fe),ee+7>>>3]}function Pe(G,le){var ee=G.slice(G.l||0),ae=Pt(ee,le);return G.l+=ae[1],ae[0]}function Ee(G,le){if(G)typeof console<"u"&&console.error(le);else throw new Error(le)}function Se(G,le){var ee=G;prep_blob(ee,0);var ae=[],ce=[],fe={FileIndex:ae,FullPaths:ce};v(fe,{root:le.root});for(var Fe=ee.length-4;(ee[Fe]!=80||ee[Fe+1]!=75||ee[Fe+2]!=5||ee[Fe+3]!=6)&&Fe>=0;)--Fe;ee.l=Fe+4,ee.l+=4;var Ne=ee.read_shift(2);ee.l+=6;var ke=ee.read_shift(4);for(ee.l=ke,Fe=0;Fe<Ne;++Fe){ee.l+=20;var Re=ee.read_shift(4),Oe=ee.read_shift(4),He=ee.read_shift(2),$e=ee.read_shift(2),Ye=ee.read_shift(2);ee.l+=8;var Ve=ee.read_shift(4),Xe=f(ee.slice(ee.l+He,ee.l+He+$e));ee.l+=He+$e+Ye;var ct=ee.l;ee.l=Ve+4,We(ee,Re,Oe,fe,Xe),ee.l=ct}return fe}function We(G,le,ee,ae,ce){G.l+=2;var fe=G.read_shift(2),Fe=G.read_shift(2),Ne=c(G);if(fe&8257)throw new Error("Unsupported ZIP encryption");for(var ke=G.read_shift(4),Re=G.read_shift(4),Oe=G.read_shift(4),He=G.read_shift(2),$e=G.read_shift(2),Ye="",Ve=0;Ve<He;++Ve)Ye+=String.fromCharCode(G[G.l++]);if($e){var Xe=f(G.slice(G.l,G.l+$e));(Xe[21589]||{}).mt&&(Ne=Xe[21589].mt),((ce||{})[21589]||{}).mt&&(Ne=ce[21589].mt)}G.l+=$e;var ct=G.slice(G.l,G.l+Re);switch(Fe){case 8:ct=P(G,Oe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Fe)}var wt=!1;fe&8&&(ke=G.read_shift(4),ke==134695760&&(ke=G.read_shift(4),wt=!0),Re=G.read_shift(4),Oe=G.read_shift(4)),Re!=le&&Ee(wt,"Bad compressed size: "+le+" != "+Re),Oe!=ee&&Ee(wt,"Bad uncompressed size: "+ee+" != "+Oe),Rt(ae,Ye,ct,{unsafe:!0,mt:Ne})}function ot(G,le){var ee=le||{},ae=[],ce=[],fe=new_buf(1),Fe=ee.compression?8:0,Ne=0,ke=0,Re=0,Oe=0,He=0,$e=G.FullPaths[0],Ye=$e,Ve=G.FileIndex[0],Xe=[],ct=0;for(ke=1;ke<G.FullPaths.length;++ke)if(Ye=G.FullPaths[ke].slice($e.length),Ve=G.FileIndex[ke],!(!Ve.size||!Ve.content||Ye=="Sh33tJ5")){var wt=Oe,St=new_buf(Ye.length);for(Re=0;Re<Ye.length;++Re)St.write_shift(1,Ye.charCodeAt(Re)&127);St=St.slice(0,St.l),Xe[He]=CRC32.buf(Ve.content,0);var Ft=Ve.content;Fe==8&&(Ft=k(Ft)),fe=new_buf(30),fe.write_shift(4,67324752),fe.write_shift(2,20),fe.write_shift(2,Ne),fe.write_shift(2,Fe),Ve.mt?l(fe,Ve.mt):fe.write_shift(4,0),fe.write_shift(-4,Xe[He]),fe.write_shift(4,Ft.length),fe.write_shift(4,Ve.content.length),fe.write_shift(2,St.length),fe.write_shift(2,0),Oe+=fe.length,ae.push(fe),Oe+=St.length,ae.push(St),Oe+=Ft.length,ae.push(Ft),fe=new_buf(46),fe.write_shift(4,33639248),fe.write_shift(2,0),fe.write_shift(2,20),fe.write_shift(2,Ne),fe.write_shift(2,Fe),fe.write_shift(4,0),fe.write_shift(-4,Xe[He]),fe.write_shift(4,Ft.length),fe.write_shift(4,Ve.content.length),fe.write_shift(2,St.length),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(4,0),fe.write_shift(4,wt),ct+=fe.l,ce.push(fe),ct+=St.length,ce.push(St),++He}return fe=new_buf(22),fe.write_shift(4,101010256),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(2,He),fe.write_shift(2,He),fe.write_shift(4,ct),fe.write_shift(4,Oe),fe.write_shift(2,0),bconcat([bconcat(ae),bconcat(ce),fe])}var pt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function vt(G,le){if(G.ctype)return G.ctype;var ee=G.name||"",ae=ee.match(/\.([^\.]+)$/);return ae&&pt[ae[1]]||le&&(ae=(ee=le).match(/[\.\\]([^\.\\])+$/),ae&&pt[ae[1]])?pt[ae[1]]:"application/octet-stream"}function Qt(G){for(var le=Base64_encode(G),ee=[],ae=0;ae<le.length;ae+=76)ee.push(le.slice(ae,ae+76));return ee.join(`\r
`)+`\r
`}function Dr(G){var le=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Re){var Oe=Re.charCodeAt(0).toString(16).toUpperCase();return"="+(Oe.length==1?"0"+Oe:Oe)});le=le.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),le.charAt(0)==`
`&&(le="=0D"+le.slice(1)),le=le.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ee=[],ae=le.split(`\r
`),ce=0;ce<ae.length;++ce){var fe=ae[ce];if(fe.length==0){ee.push("");continue}for(var Fe=0;Fe<fe.length;){var Ne=76,ke=fe.slice(Fe,Fe+Ne);ke.charAt(Ne-1)=="="?Ne--:ke.charAt(Ne-2)=="="?Ne-=2:ke.charAt(Ne-3)=="="&&(Ne-=3),ke=fe.slice(Fe,Fe+Ne),Fe+=Ne,Fe<fe.length&&(ke+="="),ee.push(ke)}}return ee.join(`\r
`)}function pr(G){for(var le=[],ee=0;ee<G.length;++ee){for(var ae=G[ee];ee<=G.length&&ae.charAt(ae.length-1)=="=";)ae=ae.slice(0,ae.length-1)+G[++ee];le.push(ae)}for(var ce=0;ce<le.length;++ce)le[ce]=le[ce].replace(/[=][0-9A-Fa-f]{2}/g,function(fe){return String.fromCharCode(parseInt(fe.slice(1),16))});return s2a(le.join(`\r
`))}function zt(G,le,ee){for(var ae="",ce="",fe="",Fe,Ne=0;Ne<10;++Ne){var ke=le[Ne];if(!ke||ke.match(/^\s*$/))break;var Re=ke.match(/^(.*?):\s*([^\s].*)$/);if(Re)switch(Re[1].toLowerCase()){case"content-location":ae=Re[2].trim();break;case"content-type":fe=Re[2].trim();break;case"content-transfer-encoding":ce=Re[2].trim();break}}switch(++Ne,ce.toLowerCase()){case"base64":Fe=s2a(Base64_decode(le.slice(Ne).join("")));break;case"quoted-printable":Fe=pr(le.slice(Ne));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ce)}var Oe=Rt(G,ae.slice(ee.length),Fe,{unsafe:!0});fe&&(Oe.ctype=fe)}function gr(G,le){if(re(G.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ee=le&&le.root||"",ae=(has_buf&&Buffer.isBuffer(G)?G.toString("binary"):re(G)).split(`\r
`),ce=0,fe="";for(ce=0;ce<ae.length;++ce)if(fe=ae[ce],!!/^Content-Location:/i.test(fe)&&(fe=fe.slice(fe.indexOf("file")),ee||(ee=fe.slice(0,fe.lastIndexOf("/")+1)),fe.slice(0,ee.length)!=ee))for(;ee.length>0&&(ee=ee.slice(0,ee.length-1),ee=ee.slice(0,ee.lastIndexOf("/")+1),fe.slice(0,ee.length)!=ee););var Fe=(ae[1]||"").match(/boundary="(.*?)"/);if(!Fe)throw new Error("MAD cannot find boundary");var Ne="--"+(Fe[1]||""),ke=[],Re=[],Oe={FileIndex:ke,FullPaths:Re};v(Oe);var He,$e=0;for(ce=0;ce<ae.length;++ce){var Ye=ae[ce];Ye!==Ne&&Ye!==Ne+"--"||($e++&&zt(Oe,ae.slice(He,ce),ee),He=ce)}return Oe}function Zt(G,le){var ee=le||{},ae=ee.boundary||"SheetJS";ae="------="+ae;for(var ce=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ae.slice(2)+'"',"","",""],fe=G.FullPaths[0],Fe=fe,Ne=G.FileIndex[0],ke=1;ke<G.FullPaths.length;++ke)if(Fe=G.FullPaths[ke].slice(fe.length),Ne=G.FileIndex[ke],!(!Ne.size||!Ne.content||Fe=="Sh33tJ5")){Fe=Fe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ct){return"_x"+ct.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ct){return"_u"+ct.charCodeAt(0).toString(16)+"_"});for(var Re=Ne.content,Oe=has_buf&&Buffer.isBuffer(Re)?Re.toString("binary"):re(Re),He=0,$e=Math.min(1024,Oe.length),Ye=0,Ve=0;Ve<=$e;++Ve)(Ye=Oe.charCodeAt(Ve))>=32&&Ye<128&&++He;var Xe=He>=$e*4/5;ce.push(ae),ce.push("Content-Location: "+(ee.root||"file:///C:/SheetJS/")+Fe),ce.push("Content-Transfer-Encoding: "+(Xe?"quoted-printable":"base64")),ce.push("Content-Type: "+vt(Ne,Fe)),ce.push(""),ce.push(Xe?Dr(Oe):Qt(Oe))}return ce.push(ae+`--\r
`),ce.join(`\r
`)}function na(G){var le={};return v(le,G),le}function Rt(G,le,ee,ae){var ce=ae&&ae.unsafe;ce||v(G);var fe=!ce&&CFB.find(G,le);if(!fe){var Fe=G.FullPaths[0];le.slice(0,Fe.length)==Fe?Fe=le:(Fe.slice(-1)!="/"&&(Fe+="/"),Fe=(Fe+le).replace("//","/")),fe={name:i(le),type:2},G.FileIndex.push(fe),G.FullPaths.push(Fe),ce||CFB.utils.cfb_gc(G)}return fe.content=ee,fe.size=ee?ee.length:0,ae&&(ae.CLSID&&(fe.clsid=ae.CLSID),ae.mt&&(fe.mt=ae.mt),ae.ct&&(fe.ct=ae.ct)),fe}function jr(G,le){v(G);var ee=CFB.find(G,le);if(ee){for(var ae=0;ae<G.FileIndex.length;++ae)if(G.FileIndex[ae]==ee)return G.FileIndex.splice(ae,1),G.FullPaths.splice(ae,1),!0}return!1}function Hr(G,le,ee){v(G);var ae=CFB.find(G,le);if(ae){for(var ce=0;ce<G.FileIndex.length;++ce)if(G.FileIndex[ce]==ae)return G.FileIndex[ce].name=i(ee),G.FullPaths[ce]=ee,!0}return!1}function sa(G){M(G,!0)}return r.find=H,r.read=w,r.parse=p,r.write=q,r.writeFile=ue,r.utils={cfb_new:na,cfb_add:Rt,cfb_del:jr,cfb_mov:Hr,cfb_gc:sa,ReadShift,CheckField,prep_blob,bconcat,use_zlib:N,_deflateRaw:Je,_inflateRaw:Pe,consts:se},r}();function read_binary(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function keys(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function evert(e){for(var r=[],t=keys(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}var basedate=new Date(1899,11,30,0,0,0);function datenum(e,r){var t=e.getTime(),n=basedate.getTime()+(e.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var refdate=new Date,dnthresh=basedate.getTime()+(refdate.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4,refoffset=refdate.getTimezoneOffset();function numdate(e){var r=new Date;return r.setTime(e*24*60*60*1e3+dnthresh),r.getTimezoneOffset()!==refoffset&&r.setTime(r.getTime()+(r.getTimezoneOffset()-refoffset)*6e4),r}function parse_isodur(e){var r=0,t=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=i.length;++l)if(i[l]){switch(t=1,l>3&&(n=!0),i[l].slice(i[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[l].slice(i[l].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(i[l],10)}return r}var good_pd_date_1=new Date("2017-02-19T19:06:09.000Z"),good_pd_date=isNaN(good_pd_date_1.getFullYear())?new Date("2/19/17"):good_pd_date_1,good_pd=good_pd_date.getFullYear()==2017;function parseDate(e,r){var t=new Date(e);if(good_pd)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(good_pd_date.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function cc2str(e,r){if(has_buf&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return utf8write(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return utf8write(utf16beread(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return utf8write(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return utf8write(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return t[l]||l})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function dup(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=dup(e[t]));return r}function fill(e,r){for(var t="";t.length<r;)t+=e;return t}function fuzzynum(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,l){return t=-t,l}),!isNaN(r=Number(n)))?r/t:r}var lower_months=["january","february","march","april","may","june","july","august","september","october","november","december"];function fuzzydate(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),i=r.getMonth(),l=r.getDate();if(isNaN(l))return t;var c=e.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&lower_months.indexOf(c)==-1)return t}else if(c.match(/[a-z]/))return t;return n<0||n>8099?t:(i>0||l>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var split_regex=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,i){if(e||typeof n=="string")return t.split(n);for(var l=t.split(n),c=[l[0]],f=1;f<l.length;++f)c.push(i),c.push(l[f]);return c}}();function getdatastr(e){return e?e.content&&e.type?cc2str(e.content,!0):e.data?debom(e.data):e.asNodeBuffer&&has_buf?debom(e.asNodeBuffer().toString("binary")):e.asBinary?debom(e.asBinary()):e._data&&e._data.getContent?debom(cc2str(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function getdatabin(e){if(!e)return null;if(e.data)return char_codes(e.data);if(e.asNodeBuffer&&has_buf)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?char_codes(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function getdata(e){return e&&e.name.slice(-4)===".bin"?getdatabin(e):getdatastr(e)}function safegetzipfile(e,r){for(var t=e.FullPaths||keys(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),l=0;l<t.length;++l){var c=t[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==c||i==c)return e.files?e.files[t[l]]:e.FileIndex[l]}return null}function getzipfile(e,r){var t=safegetzipfile(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function getzipdata(e,r,t){if(!t)return getdata(getzipfile(e,r));if(!r)return null;try{return getzipdata(e,r)}catch{return null}}function getzipstr(e,r,t){if(!t)return getdatastr(getzipfile(e,r));if(!r)return null;try{return getzipstr(e,r)}catch{return null}}function getzipbin(e,r,t){return getdatabin(getzipfile(e,r))}function zipentries(e){for(var r=e.FullPaths||keys(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function zip_add_file(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return has_buf?n=Buffer_from(t):n=utf8decode(t),CFB.utils.cfb_add(e,r,n)}CFB.utils.cfb_add(e,r,t)}else e.file(r,t)}function zip_read(e,r){switch(r.type){case"base64":return CFB.read(e,{type:"base64"});case"binary":return CFB.read(e,{type:"binary"});case"buffer":case"array":return CFB.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function resolve_path(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?t.pop():i!=="."&&t.push(i)}return t.join("/")}var XML_HEADER=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,attregexg=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,tagregex1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,tagregex2=/<[^>]*>/g,tagregex=XML_HEADER.match(tagregex1)?tagregex1:tagregex2,nsregex=/<\w*:/,nsregex2=/<(\/?)\w+:/;function parsexmltag(e,r,t){for(var n={},i=0,l=0;i!==e.length&&!((l=e.charCodeAt(i))===32||l===10||l===13);++i);if(r||(n[0]=e.slice(0,i)),i===e.length)return n;var c=e.match(attregexg),f=0,d="",h=0,p="",E="",y=1;if(c)for(h=0;h!=c.length;++h){for(E=c[h],l=0;l!=E.length&&E.charCodeAt(l)!==61;++l);for(p=E.slice(0,l).trim();E.charCodeAt(l+1)==32;)++l;for(y=(i=E.charCodeAt(l+1))==34||i==39?1:0,d=E.slice(l+1+y,E.length-y),f=0;f!=p.length&&p.charCodeAt(f)!==58;++f);if(f===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),n[p]=d,n[p.toLowerCase()]=d;else{var S=(f===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(f+1);if(n[S]&&p.slice(f-3,f)=="ext")continue;n[S]=d,n[S.toLowerCase()]=d}}return n}function strip_ns(e){return e.replace(nsregex2,"<$1")}var encodings={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rencoding=evert(encodings),unescapexml=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(n){var i=n+"",l=i.indexOf("<![CDATA[");if(l==-1)return i.replace(e,function(f,d){return encodings[f]||String.fromCharCode(parseInt(d,f.indexOf("x")>-1?16:10))||f}).replace(r,function(f,d){return String.fromCharCode(parseInt(d,16))});var c=i.indexOf("]]>");return t(i.slice(0,l))+i.slice(l+9,c)+t(i.slice(c+3))}}(),decregex=/[&<>'"]/g,htmlcharegex=/[\u0000-\u001f]/g;function escapehtml(e){var r=e+"";return r.replace(decregex,function(t){return rencoding[t]}).replace(/\n/g,"<br/>").replace(htmlcharegex,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var xlml_fixstr=function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}}();function parsexmlbool(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function utf8reada(e){for(var r="",t=0,n=0,i=0,l=0,c=0,f=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(i=e.charCodeAt(t++),n>191&&n<224){c=(n&31)<<6,c|=i&63,r+=String.fromCharCode(c);continue}if(l=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(i&63)<<6|l&63);continue}c=e.charCodeAt(t++),f=((n&7)<<18|(i&63)<<12|(l&63)<<6|c&63)-65536,r+=String.fromCharCode(55296+(f>>>10&1023)),r+=String.fromCharCode(56320+(f&1023))}return r}function utf8readb(e){var r=new_raw_buf(2*e.length),t,n,i=1,l=0,c=0,f;for(n=0;n<e.length;n+=i)i=1,(f=e.charCodeAt(n))<128?t=f:f<224?(t=(f&31)*64+(e.charCodeAt(n+1)&63),i=2):f<240?(t=(f&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,t=(f&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,c=55296+(t>>>10&1023),t=56320+(t&1023)),c!==0&&(r[l++]=c&255,r[l++]=c>>>8,c=0),r[l++]=t%256,r[l++]=t>>>8;return r.slice(0,l).toString("ucs2")}function utf8readc(e){return Buffer_from(e,"binary").toString("utf8")}var utf8corpus="foo bar baz",utf8read=has_buf&&(utf8readc(utf8corpus)==utf8reada(utf8corpus)&&utf8readc||utf8readb(utf8corpus)==utf8reada(utf8corpus)&&utf8readb)||utf8reada,utf8write=has_buf?function(e){return Buffer_from(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,i=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(i>>18&7))),r.push(String.fromCharCode(144+(i>>12&63))),r.push(String.fromCharCode(128+(i>>6&63))),r.push(String.fromCharCode(128+(i&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},matchtag=function(){var e={};return function(t,n){var i=t+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),htmldecode=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),vtregex=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),vtvregex=/<\/?(?:vt:)?variant>/g,vtmregex=/<(?:vt:)([^>]*)>([\s\S]*)</;function parseVector(e,r){var t=parsexmltag(e),n=e.match(vtregex(t.baseType))||[],i=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return i}return n.forEach(function(l){var c=l.replace(vtvregex,"").match(vtmregex);c&&i.push({v:utf8read(c[2]),t:c[1]})}),i}var wtregex=/(^\s|\s$|\n)/;function wxt_helper(e){return keys(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function writextag(e,r,t){return"<"+e+(t!=null?wxt_helper(t):"")+(r!=null?(r.match(wtregex)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function xlml_normalize(e){if(has_buf&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return utf8read(a2s(ab2a(e)));throw new Error("Bad input format: expected Buffer or string")}var xlmlregex=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,XMLNS={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},XMLNS_main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function read_double_le(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),i=e[r+6]&15,l=5;l>=0;--l)i=i*256+e[r+l];return n==2047?i==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),t*Math.pow(2,n-52)*i)}function write_double_le(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,i=0,l=0,c=n?-r:r;isFinite(c)?c==0?i=l=0:(i=Math.floor(Math.log(c)/Math.LN2),l=c*Math.pow(2,52-i),i<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?i=-1022:(l-=Math.pow(2,52),i+=1023)):(i=2047,l=isNaN(r)?26985:0);for(var f=0;f<=5;++f,l/=256)e[t+f]=l&255;e[t+6]=(i&15)<<4|l&15,e[t+7]=i>>4|n}var ___toBuffer=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,l=e[0][n].length;i<l;i+=t)r.push.apply(r,e[0][n].slice(i,i+t));return r},__toBuffer=has_buf?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:Buffer_from(r)})):___toBuffer(e)}:___toBuffer,___utf16le=function(e,r,t){for(var n=[],i=r;i<t;i+=2)n.push(String.fromCharCode(__readUInt16LE(e,i)));return n.join("").replace(chr0,"")},__utf16le=has_buf?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(chr0,""):___utf16le(e,r,t)}:___utf16le,___hexlify=function(e,r,t){for(var n=[],i=r;i<r+t;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},__hexlify=has_buf?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):___hexlify(e,r,t)}:___hexlify,___utf8=function(e,r,t){for(var n=[],i=r;i<t;i++)n.push(String.fromCharCode(__readUInt8(e,i)));return n.join("")},__utf8=has_buf?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):___utf8(r,t,n)}:___utf8,___lpstr=function(e,r){var t=__readUInt32LE(e,r);return t>0?__utf8(e,r+4,r+4+t-1):""},__lpstr=___lpstr,___cpstr=function(e,r){var t=__readUInt32LE(e,r);return t>0?__utf8(e,r+4,r+4+t-1):""},__cpstr=___cpstr,___lpwstr=function(e,r){var t=2*__readUInt32LE(e,r);return t>0?__utf8(e,r+4,r+4+t-1):""},__lpwstr=___lpwstr,___lpp4=function(r,t){var n=__readUInt32LE(r,t);return n>0?__utf16le(r,t+4,t+4+n):""},__lpp4=___lpp4,___8lpp4=function(e,r){var t=__readUInt32LE(e,r);return t>0?__utf8(e,r+4,r+4+t):""},__8lpp4=___8lpp4,___double=function(e,r){return read_double_le(e,r)},__double=___double,is_buf=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};has_buf&&(__lpstr=function(r,t){if(!Buffer.isBuffer(r))return ___lpstr(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},__cpstr=function(r,t){if(!Buffer.isBuffer(r))return ___cpstr(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},__lpwstr=function(r,t){if(!Buffer.isBuffer(r))return ___lpwstr(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},__lpp4=function(r,t){if(!Buffer.isBuffer(r))return ___lpp4(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},__8lpp4=function(r,t){if(!Buffer.isBuffer(r))return ___8lpp4(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},__double=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):___double(r,t)},is_buf=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var __readUInt8=function(e,r){return e[r]},__readUInt16LE=function(e,r){return e[r+1]*256+e[r]},__readInt16LE=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},__readUInt32LE=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},__readInt32LE=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},__readInt32BE=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function ReadShift(e,r){var t="",n,i,l=[],c,f,d,h;switch(r){case"dbcs":if(h=this.l,has_buf&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)t+=String.fromCharCode(__readUInt16LE(this,h)),h+=2;e*=2;break;case"utf8":t=__utf8(this,this.l,this.l+e);break;case"utf16le":e*=2,t=__utf16le(this,this.l,this.l+e);break;case"wstr":return ReadShift.call(this,e,"dbcs");case"lpstr-ansi":t=__lpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpstr-cp":t=__cpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpwstr":t=__lpwstr(this,this.l),e=4+2*__readUInt32LE(this,this.l);break;case"lpp4":e=4+__readUInt32LE(this,this.l),t=__lpp4(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+__readUInt32LE(this,this.l),t=__8lpp4(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(c=__readUInt8(this,this.l+e++))!==0;)l.push(_getchar(c));t=l.join("");break;case"_wstr":for(e=0,t="";(c=__readUInt16LE(this,this.l+e))!==0;)l.push(_getchar(c)),e+=2;e+=2,t=l.join("");break;case"dbcs-cont":for(t="",h=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return c=__readUInt8(this,h),this.l=h+1,f=ReadShift.call(this,e-d,c?"dbcs-cont":"sbcs-cont"),l.join("")+f;l.push(_getchar(__readUInt16LE(this,h))),h+=2}t=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",h=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return c=__readUInt8(this,h),this.l=h+1,f=ReadShift.call(this,e-d,c?"dbcs-cont":"sbcs-cont"),l.join("")+f;l.push(_getchar(__readUInt8(this,h))),h+=1}t=l.join("");break;default:switch(e){case 1:return n=__readUInt8(this,this.l),this.l++,n;case 2:return n=(r==="i"?__readInt16LE:__readUInt16LE)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(n=(e>0?__readInt32LE:__readInt32BE)(this,this.l),this.l+=4,n):(i=__readUInt32LE(this,this.l),this.l+=4,i);case 8:case-8:if(r==="f")return e==8?i=__double(this,this.l):i=__double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:t=__hexlify(this,this.l,e);break}}return this.l+=e,t}var __writeUInt32LE=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},__writeInt32LE=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},__writeUInt16LE=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function WriteShift(e,r,t){var n=0,i=0;if(t==="dbcs"){for(i=0;i!=r.length;++i)__writeUInt16LE(this,r.charCodeAt(i),this.l+2*i);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=r.length;++i)this[this.l+i]=r.charCodeAt(i)&255;n=r.length}else if(t==="hex"){for(;i<e;++i)this[this.l++]=parseInt(r.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var l=Math.min(this.l+e,this.length);for(i=0;i<Math.min(r.length,e);++i){var c=r.charCodeAt(i);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,__writeUInt32LE(this,r,this.l);break;case 8:if(n=8,t==="f"){write_double_le(this,r,this.l);break}case 16:break;case-4:n=4,__writeInt32LE(this,r,this.l);break}return this.l+=n,this}function CheckField(e,r){var t=__hexlify(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function prep_blob(e,r){e.l=r,e.read_shift=ReadShift,e.chk=CheckField,e.write_shift=WriteShift}function parsenoop(e,r){e.l+=r}function new_buf(e){var r=new_raw_buf(e);return prep_blob(r,0),r}function recordhopper(e,r,t){if(e){var n,i,l;prep_blob(e,e.l||0);for(var c=e.length,f=0,d=0;e.l<c;){f=e.read_shift(1),f&128&&(f=(f&127)+((e.read_shift(1)&127)<<7));var h=XLSBRecordEnum[f]||XLSBRecordEnum[65535];for(n=e.read_shift(1),l=n&127,i=1;i<4&&n&128;++i)l+=((n=e.read_shift(1))&127)<<7*i;d=e.l+l;var p=h.f&&h.f(e,l,t);if(e.l=d,r(p,h,f))return}}}function buf_array(){var e=[],r=has_buf?256:2048,t=function(h){var p=new_buf(h);return prep_blob(p,0),p},n=t(r),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},l=function(h){return n&&h<n.length-n.l?n:(i(),n=t(Math.max(h+1,r)))},c=function(){return i(),bconcat(e)},f=function(h){i(),n=h,n.l==null&&(n.l=n.length),l(r)};return{next:l,push:f,end:c,_bufs:e}}function shift_cell_xls(e,r,t){var n=dup(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function shift_range_xls(e,r,t){var n=dup(e);return n.s=shift_cell_xls(n.s,r.s,t),n.e=shift_cell_xls(n.e,r.s,t),n}function encode_cell_xls(e,r){if(e.cRel&&e.c<0)for(e=dup(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=dup(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=encode_cell(e);return!e.cRel&&e.cRel!=null&&(t=fix_col(t)),!e.rRel&&e.rRel!=null&&(t=fix_row(t)),t}function encode_range_xls(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+encode_col(e.s.c)+":"+(e.e.cRel?"":"$")+encode_col(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+encode_row(e.s.r)+":"+(e.e.rRel?"":"$")+encode_row(e.e.r):encode_cell_xls(e.s,r.biff)+":"+encode_cell_xls(e.e,r.biff)}function decode_row(e){return parseInt(unfix_row(e),10)-1}function encode_row(e){return""+(e+1)}function fix_row(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function unfix_row(e){return e.replace(/\$(\d+)$/,"$1")}function decode_col(e){for(var r=unfix_col(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function encode_col(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function fix_col(e){return e.replace(/^([A-Z])/,"$$$1")}function unfix_col(e){return e.replace(/^\$([A-Z])/,"$1")}function split_cell(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function decode_cell(e){for(var r=0,t=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?r=10*r+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:r-1}}function encode_cell(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function decode_range(e){var r=e.indexOf(":");return r==-1?{s:decode_cell(e),e:decode_cell(e)}:{s:decode_cell(e.slice(0,r)),e:decode_cell(e.slice(r+1))}}function encode_range(e,r){return typeof r>"u"||typeof r=="number"?encode_range(e.s,e.e):(typeof e!="string"&&(e=encode_cell(e)),typeof r!="string"&&(r=encode_cell(r)),e==r?e:e+":"+r)}function safe_decode_range(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,i=0,l=e.length;for(t=0;n<l&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(r.s.c=--t,t=0;n<l&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;if(r.s.r=--t,n===l||i!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=l&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(r.e.c=--t,t=0;n!=l&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;return r.e.r=--t,r}function safe_format_cell(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=SSF_format(e.z,t?datenum(r):r)}catch{}try{return e.w=SSF_format((e.XF||{}).numFmtId||(t?14:0),t?datenum(r):r)}catch{return""+r}}function format_cell(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?BErr[e.v]||e.v:r==null?safe_format_cell(e,e.v):safe_format_cell(e,r))}function sheet_to_workbook(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function sheet_add_aoa(e,r,t){var n=t||{},i=e?Array.isArray(e):n.dense,l=e||(i?[]:{}),c=0,f=0;if(l&&n.origin!=null){if(typeof n.origin=="number")c=n.origin;else{var d=typeof n.origin=="string"?decode_cell(n.origin):n.origin;c=d.r,f=d.c}l["!ref"]||(l["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var p=safe_decode_range(l["!ref"]);h.s.c=p.s.c,h.s.r=p.s.r,h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),c==-1&&(h.e.r=c=p.e.r+1)}for(var E=0;E!=r.length;++E)if(r[E]){if(!Array.isArray(r[E]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=r[E].length;++y)if(!(typeof r[E][y]>"u")){var S={v:r[E][y]},x=c+E,g=f+y;if(h.s.r>x&&(h.s.r=x),h.s.c>g&&(h.s.c=g),h.e.r<x&&(h.e.r=x),h.e.c<g&&(h.e.c=g),r[E][y]&&typeof r[E][y]=="object"&&!Array.isArray(r[E][y])&&!(r[E][y]instanceof Date))S=r[E][y];else if(Array.isArray(S.v)&&(S.f=r[E][y][1],S.v=S.v[0]),S.v===null)if(S.f)S.t="n";else if(n.nullError)S.t="e",S.v=0;else if(n.sheetStubs)S.t="z";else continue;else typeof S.v=="number"?S.t="n":typeof S.v=="boolean"?S.t="b":S.v instanceof Date?(S.z=n.dateNF||table_fmt[14],n.cellDates?(S.t="d",S.w=SSF_format(S.z,datenum(S.v))):(S.t="n",S.v=datenum(S.v),S.w=SSF_format(S.z,S.v))):S.t="s";if(i)l[x]||(l[x]=[]),l[x][g]&&l[x][g].z&&(S.z=l[x][g].z),l[x][g]=S;else{var m=encode_cell({c:g,r:x});l[m]&&l[m].z&&(S.z=l[m].z),l[m]=S}}}return h.s.c<1e7&&(l["!ref"]=encode_range(h)),l}function aoa_to_sheet(e,r){return sheet_add_aoa(null,e,r)}function parse_Int32LE(e){return e.read_shift(4,"i")}function parse_XLWideString(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function parse_StrRun(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function parse_RichStr(e,r){var t=e.l,n=e.read_shift(1),i=parse_XLWideString(e),l=[],c={t:i,h:i};if(n&1){for(var f=e.read_shift(4),d=0;d!=f;++d)l.push(parse_StrRun(e));c.r=l}else c.r=[{ich:0,ifnt:0}];return e.l=t+r,c}var parse_BrtCommentText=parse_RichStr;function parse_XLSBCell(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function parse_XLSBShortCell(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var parse_XLSBCodeName=parse_XLWideString;function parse_XLNullableWideString(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var parse_XLNameWideString=parse_XLWideString,parse_RelID=parse_XLNullableWideString;function parse_RkNumber(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var i=n===0?__double([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):__readInt32LE(r,0)>>2;return t?i/100:i}function parse_RfX(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var parse_UncheckedRfX=parse_RfX;function parse_Xnum(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function parse_BrtColor(e){var r={},t=e.read_shift(1),n=t>>>1,i=e.read_shift(1),l=e.read_shift(2,"i"),c=e.read_shift(1),f=e.read_shift(1),d=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=i;var h=XLSIcv[i];h&&(r.rgb=rgb2Hex(h));break;case 2:r.rgb=rgb2Hex([c,f,d]);break;case 3:r.theme=i;break}return l!=0&&(r.tint=l>0?l/32767:l/32768),r}function parse_FontFlags(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function parse_ClipboardFormatOrString(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function parse_ClipboardFormatOrAnsiString(e){return parse_ClipboardFormatOrString(e,1)}function parse_ClipboardFormatOrUnicodeString(e){return parse_ClipboardFormatOrString(e,2)}var VT_I2=2,VT_I4=3,VT_BOOL=11,VT_VARIANT=12,VT_UI4=19,VT_FILETIME=64,VT_BLOB=65,VT_CF=71,VT_VECTOR_VARIANT=4108,VT_VECTOR_LPSTR=4126,VT_STRING=80,VT_USTR=81,VT_CUSTOM=[VT_STRING,VT_USTR],DocSummaryPIDDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Category",t:VT_STRING},3:{n:"PresentationFormat",t:VT_STRING},4:{n:"ByteCount",t:VT_I4},5:{n:"LineCount",t:VT_I4},6:{n:"ParagraphCount",t:VT_I4},7:{n:"SlideCount",t:VT_I4},8:{n:"NoteCount",t:VT_I4},9:{n:"HiddenCount",t:VT_I4},10:{n:"MultimediaClipCount",t:VT_I4},11:{n:"ScaleCrop",t:VT_BOOL},12:{n:"HeadingPairs",t:VT_VECTOR_VARIANT},13:{n:"TitlesOfParts",t:VT_VECTOR_LPSTR},14:{n:"Manager",t:VT_STRING},15:{n:"Company",t:VT_STRING},16:{n:"LinksUpToDate",t:VT_BOOL},17:{n:"CharacterCount",t:VT_I4},19:{n:"SharedDoc",t:VT_BOOL},22:{n:"HyperlinksChanged",t:VT_BOOL},23:{n:"AppVersion",t:VT_I4,p:"version"},24:{n:"DigSig",t:VT_BLOB},26:{n:"ContentType",t:VT_STRING},27:{n:"ContentStatus",t:VT_STRING},28:{n:"Language",t:VT_STRING},29:{n:"Version",t:VT_STRING},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},SummaryPIDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Title",t:VT_STRING},3:{n:"Subject",t:VT_STRING},4:{n:"Author",t:VT_STRING},5:{n:"Keywords",t:VT_STRING},6:{n:"Comments",t:VT_STRING},7:{n:"Template",t:VT_STRING},8:{n:"LastAuthor",t:VT_STRING},9:{n:"RevNumber",t:VT_STRING},10:{n:"EditTime",t:VT_FILETIME},11:{n:"LastPrinted",t:VT_FILETIME},12:{n:"CreatedDate",t:VT_FILETIME},13:{n:"ModifiedDate",t:VT_FILETIME},14:{n:"PageCount",t:VT_I4},15:{n:"WordCount",t:VT_I4},16:{n:"CharCount",t:VT_I4},17:{n:"Thumbnail",t:VT_CF},18:{n:"Application",t:VT_STRING},19:{n:"DocSecurity",t:VT_I4},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},CountryEnum={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},XLSFillPattern=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function rgbify(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var _XLSIcv=rgbify([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),XLSIcv=dup(_XLSIcv),BErr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RBErr={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ct2type={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function new_ct(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function parse_ct(e){var r=new_ct();if(!e||!e.match)return r;var t={};if((e.match(tagregex)||[]).forEach(function(n){var i=parsexmltag(n);switch(i[0].replace(nsregex,"<")){case"<?xml":break;case"<Types":r.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[i.Extension]=i.ContentType;break;case"<Override":r[ct2type[i.ContentType]]!==void 0&&r[ct2type[i.ContentType]].push(i.PartName);break}}),r.xmlns!==XMLNS.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}var RELS={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function get_rels_path(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function parse_rels(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(tagregex)||[]).forEach(function(i){var l=parsexmltag(i);if(l[0]==="<Relationship"){var c={};c.Type=l.Type,c.Target=l.Target,c.Id=l.Id,l.TargetMode&&(c.TargetMode=l.TargetMode);var f=l.TargetMode==="External"?l.Target:resolve_path(l.Target,r);t[f]=c,n[l.Id]=c}}),t["!id"]=n,t}var CT_ODS="application/vnd.oasis.opendocument.spreadsheet";function parse_manifest(e,r){for(var t=xlml_normalize(e),n,i;n=xlmlregex.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(i=parsexmltag(n[0],!1),i.path=="/"&&i.type!==CT_ODS)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var CORE_PROPS=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],CORE_PROPS_REGEX=function(){for(var e=new Array(CORE_PROPS.length),r=0;r<CORE_PROPS.length;++r){var t=CORE_PROPS[r],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function parse_core_props(e){var r={};e=utf8read(e);for(var t=0;t<CORE_PROPS.length;++t){var n=CORE_PROPS[t],i=e.match(CORE_PROPS_REGEX[t]);i!=null&&i.length>0&&(r[n[1]]=unescapexml(i[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=parseDate(r[n[1]]))}return r}var EXT_PROPS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function load_props_pairs(e,r,t,n){var i=[];if(typeof e=="string")i=parseVector(e,n);else for(var l=0;l<e.length;++l)i=i.concat(e[l].map(function(p){return{v:p}}));var c=typeof r=="string"?parseVector(r,n).map(function(p){return p.v}):r,f=0,d=0;if(c.length>0)for(var h=0;h!==i.length;h+=2){switch(d=+i[h+1].v,i[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=d,t.SheetNames=c.slice(f,f+d);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=d,t.DefinedNames=c.slice(f,f+d);break;case"Charts":case"Diagramme":t.Chartsheets=d,t.ChartNames=c.slice(f,f+d);break}f+=d}}function parse_ext_props(e,r,t){var n={};return r||(r={}),e=utf8read(e),EXT_PROPS.forEach(function(i){var l=(e.match(matchtag(i[0]))||[])[1];switch(i[2]){case"string":l&&(r[i[1]]=unescapexml(l));break;case"bool":r[i[1]]=l==="true";break;case"raw":var c=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));c&&c.length>0&&(n[i[1]]=c[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&load_props_pairs(n.HeadingPairs,n.TitlesOfParts,r,t),r}var custregex=/<[^>]+>[^<]*/g;function parse_cust_props(e,r){var t={},n="",i=e.match(custregex);if(i)for(var l=0;l!=i.length;++l){var c=i[l],f=parsexmltag(c);switch(f[0]){case"<?xml":break;case"<Properties":break;case"<property":n=unescapexml(f.name);break;case"</property>":n=null;break;default:if(c.indexOf("<vt:")===0){var d=c.split(">"),h=d[0].slice(4),p=d[1];switch(h){case"lpstr":case"bstr":case"lpwstr":t[n]=unescapexml(p);break;case"bool":t[n]=parsexmlbool(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(p,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(p);break;case"filetime":case"date":t[n]=parseDate(p);break;case"cy":case"error":t[n]=unescapexml(p);break;default:if(h.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",c,h,d)}}else if(c.slice(0,2)!=="</"){if(r.WTF)throw new Error(c)}}}return t}var XLMLDocPropsMap={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},evert_XLMLDPM;function xlml_set_prop(e,r,t){evert_XLMLDPM||(evert_XLMLDPM=evert(XLMLDocPropsMap)),r=evert_XLMLDPM[r]||r,e[r]=t}function parse_FILETIME(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function parse_lpstr(e,r,t){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return i}function parse_lpwstr(e,r,t){var n=e.read_shift(0,"lpwstr");return n}function parse_VtStringBase(e,r,t){return r===31?parse_lpwstr(e):parse_lpstr(e,r,t)}function parse_VtString(e,r,t){return parse_VtStringBase(e,r,t===!1?0:4)}function parse_VtUnalignedString(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return parse_VtStringBase(e,r,0)}function parse_VtVecLpwstrValue(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var i=e.l;t[n]=e.read_shift(0,"lpwstr").replace(chr0,""),e.l-i&2&&(e.l+=2)}return t}function parse_VtVecUnalignedLpstrValue(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(chr0,"");return t}function parse_VtHeadingPair(e){var r=e.l,t=parse_TypedPropertyValue(e,VT_USTR);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=parse_TypedPropertyValue(e,VT_I4);return[t,n]}function parse_VtVecHeadingPairValue(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(parse_VtHeadingPair(e));return t}function parse_dictionary(e,r){for(var t=e.read_shift(4),n={},i=0;i!=t;++i){var l=e.read_shift(4),c=e.read_shift(4);n[l]=e.read_shift(c,r===1200?"utf16le":"utf8").replace(chr0,"").replace(chr1,"!"),r===1200&&c%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function parse_BLOB(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function parse_ClipboardData(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function parse_TypedPropertyValue(e,r,t){var n=e.read_shift(2),i,l=t||{};if(e.l+=2,r!==VT_VARIANT&&n!==r&&VT_CUSTOM.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===VT_VARIANT?n:r){case 2:return i=e.read_shift(2,"i"),l.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return parse_lpstr(e,n,4).replace(chr0,"");case 31:return parse_lpwstr(e);case 64:return parse_FILETIME(e);case 65:return parse_BLOB(e);case 71:return parse_ClipboardData(e);case 80:return parse_VtString(e,n,!l.raw).replace(chr0,"");case 81:return parse_VtUnalignedString(e,n).replace(chr0,"");case 4108:return parse_VtVecHeadingPairValue(e);case 4126:case 4127:return n==4127?parse_VtVecLpwstrValue(e):parse_VtVecUnalignedLpstrValue(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function parse_PropertySet(e,r){var t=e.l,n=e.read_shift(4),i=e.read_shift(4),l=[],c=0,f=0,d=-1,h={};for(c=0;c!=i;++c){var p=e.read_shift(4),E=e.read_shift(4);l[c]=[p,E+t]}l.sort(function(O,C){return O[1]-C[1]});var y={};for(c=0;c!=i;++c){if(e.l!==l[c][1]){var S=!0;if(c>0&&r)switch(r[l[c-1][0]].t){case 2:e.l+2===l[c][1]&&(e.l+=2,S=!1);break;case 80:e.l<=l[c][1]&&(e.l=l[c][1],S=!1);break;case 4108:e.l<=l[c][1]&&(e.l=l[c][1],S=!1);break}if((!r||c==0)&&e.l<=l[c][1]&&(S=!1,e.l=l[c][1]),S)throw new Error("Read Error: Expected address "+l[c][1]+" at "+e.l+" :"+c)}if(r){var x=r[l[c][0]];if(y[x.n]=parse_TypedPropertyValue(e,x.t,{raw:!0}),x.p==="version"&&(y[x.n]=String(y[x.n]>>16)+"."+("0000"+String(y[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(y[x.n]){case 0:y[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:set_cp(f=y[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[x.n])}}else if(l[c][0]===1){if(f=y.CodePage=parse_TypedPropertyValue(e,VT_I2),set_cp(f),d!==-1){var g=e.l;e.l=l[d][1],h=parse_dictionary(e,f),e.l=g}}else if(l[c][0]===0){if(f===0){d=c,e.l=l[c+1][1];continue}h=parse_dictionary(e,f)}else{var m=h[l[c][0]],A;switch(e[e.l]){case 65:e.l+=4,A=parse_BLOB(e);break;case 30:e.l+=4,A=parse_VtString(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,A=parse_VtString(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,A=e.read_shift(4,"i");break;case 19:e.l+=4,A=e.read_shift(4);break;case 5:e.l+=4,A=e.read_shift(8,"f");break;case 11:e.l+=4,A=parsebool(e,4);break;case 64:e.l+=4,A=parseDate(parse_FILETIME(e));break;default:throw new Error("unparsed value: "+e[e.l])}y[m]=A}}return e.l=t+n,y}function parse_PropertySetStream(e,r,t){var n=e.content;if(!n)return{};prep_blob(n,0);var i,l,c,f,d=0;n.chk("feff","Byte Order: "),n.read_shift(2);var h=n.read_shift(4),p=n.read_shift(16);if(p!==CFB.utils.consts.HEADER_CLSID&&p!==t)throw new Error("Bad PropertySet CLSID "+p);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(l=n.read_shift(16),f=n.read_shift(4),i===1&&f!==n.l)throw new Error("Length mismatch: "+f+" !== "+n.l);i===2&&(c=n.read_shift(16),d=n.read_shift(4));var E=parse_PropertySet(n,r),y={SystemIdentifier:h};for(var S in E)y[S]=E[S];if(y.FMTID=l,i===1)return y;if(d-n.l==2&&(n.l+=2),n.l!==d)throw new Error("Length mismatch 2: "+n.l+" !== "+d);var x;try{x=parse_PropertySet(n,null)}catch{}for(S in x)y[S]=x[S];return y.FMTID=[l,c],y}function parsenoop2(e,r){return e.read_shift(r),null}function parslurp(e,r,t){for(var n=[],i=e.l+r;e.l<i;)n.push(t(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function parsebool(e,r){return e.read_shift(r)===1}function parseuint16(e){return e.read_shift(2,"u")}function parseuint16a(e,r){return parslurp(e,r,parseuint16)}function parse_Bes(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function parse_ShortXLUnicodeString(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var l=e.read_shift(1);l&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var c=n?e.read_shift(n,i):"";return c}function parse_XLUnicodeRichExtendedString(e){var r=e.read_shift(2),t=e.read_shift(1),n=t&4,i=t&8,l=1+(t&1),c=0,f,d={};i&&(c=e.read_shift(2)),n&&(f=e.read_shift(4));var h=l==2?"dbcs-cont":"sbcs-cont",p=r===0?"":e.read_shift(r,h);return i&&(e.l+=4*c),n&&(e.l+=f),d.t=p,i||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function parse_XLUnicodeStringNoCch(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function parse_XLUnicodeString(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):parse_XLUnicodeStringNoCch(e,n,t)}function parse_XLUnicodeString2(e,r,t){if(t.biff>5)return parse_XLUnicodeString(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function parse_ControlInfo(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function parse_URLMoniker(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var i=e.read_shift((n?r-24:r)>>1,"utf16le").replace(chr0,"");return n&&(e.l+=24),i}function parse_FileMoniker(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return t+n.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=e.read_shift(l>>1,"utf16le").replace(chr0,"");return t+c}function parse_HyperlinkMoniker(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return parse_URLMoniker(e);case"0303000000000000c000000000000046":return parse_FileMoniker(e);default:throw new Error("Unsupported Moniker "+t)}}function parse_HyperlinkString(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(chr0,""):"";return t}function parse_Hyperlink(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var l,c,f,d,h="",p,E;i&16&&(l=parse_HyperlinkString(e,t-e.l)),i&128&&(c=parse_HyperlinkString(e,t-e.l)),(i&257)===257&&(f=parse_HyperlinkString(e,t-e.l)),(i&257)===1&&(d=parse_HyperlinkMoniker(e,t-e.l)),i&8&&(h=parse_HyperlinkString(e,t-e.l)),i&32&&(p=e.read_shift(16)),i&64&&(E=parse_FILETIME(e)),e.l=t;var y=c||f||d||"";y&&h&&(y+="#"+h),y||(y="#"+h),i&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var S={Target:y};return p&&(S.guid=p),E&&(S.time=E),l&&(S.Tooltip=l),S}function parse_LongRGBA(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[r,t,n,i]}function parse_LongRGB(e,r){var t=parse_LongRGBA(e);return t[3]=0,t}function parse_XLSCell(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return{r,c:t,ixfe:n}}function parse_frtHeader(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function parse_OptXLUnicodeString(e,r,t){return r===0?"":parse_XLUnicodeString2(e,r,t)}function parse_XTI(e,r,t){var n=t.biff>8?4:2,i=e.read_shift(n),l=e.read_shift(n,"i"),c=e.read_shift(n,"i");return[i,l,c]}function parse_RkRec(e){var r=e.read_shift(2),t=parse_RkNumber(e);return[r,t]}function parse_AddinUdf(e,r,t){e.l+=4,r-=4;var n=e.l+r,i=parse_ShortXLUnicodeString(e,r,t),l=e.read_shift(2);if(n-=e.l,l!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+l);return e.l+=l,i}function parse_Ref8U(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r},e:{c:i,r:t}}}function parse_RefU(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r},e:{c:i,r:t}}}var parse_Ref=parse_RefU;function parse_FtCmo(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function parse_FtNts(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function parse_FtCf(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function parse_FtSkip(e){e.l+=2,e.l+=e.read_shift(2)}var FtTab={0:parse_FtSkip,4:parse_FtSkip,5:parse_FtSkip,6:parse_FtSkip,7:parse_FtCf,8:parse_FtSkip,9:parse_FtSkip,10:parse_FtSkip,11:parse_FtSkip,12:parse_FtSkip,13:parse_FtNts,14:parse_FtSkip,15:parse_FtSkip,16:parse_FtSkip,17:parse_FtSkip,18:parse_FtSkip,19:parse_FtSkip,20:parse_FtSkip,21:parse_FtCmo};function parse_FtArray(e,r){for(var t=e.l+r,n=[];e.l<t;){var i=e.read_shift(2);e.l-=2;try{n.push(FtTab[i](e,t-e.l))}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function parse_BOF(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function parse_InterfaceHdr(e,r){return r===0||e.read_shift(2),1200}function parse_WriteAccess(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,i=parse_XLUnicodeString2(e,0,t);return e.read_shift(r+n-e.l),i}function parse_WsBool(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function parse_BoundSheet8(e,r,t){var n=e.read_shift(4),i=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var c=parse_ShortXLUnicodeString(e,0,t);return c.length===0&&(c="Sheet1"),{pos:n,hs:i,dt:l,name:c}}function parse_SST(e,r){for(var t=e.l+r,n=e.read_shift(4),i=e.read_shift(4),l=[],c=0;c!=i&&e.l<t;++c)l.push(parse_XLUnicodeRichExtendedString(e));return l.Count=n,l.Unique=i,l}function parse_ExtSST(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function parse_Row(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function parse_ForceFullCalculation(e){var r=parse_frtHeader(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function parse_RecalcId(e){return e.read_shift(2),e.read_shift(4)}function parse_DefaultRowHeight(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);t&&t.biff==2&&(n=1-(i>>15),i&=32767);var l={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[l,i]}function parse_Window1(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),d=e.read_shift(2),h=e.read_shift(2);return{Pos:[r,t],Dim:[n,i],Flags:l,CurTab:c,FirstTab:f,Selected:d,TabRatio:h}}function parse_Window2(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function parse_Pane(){}function parse_Font(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=parse_ShortXLUnicodeString(e,0,t),n}function parse_LabelSst(e){var r=parse_XLSCell(e);return r.isst=e.read_shift(4),r}function parse_Label(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,i=parse_XLSCell(e);t.biff==2&&e.l++;var l=parse_XLUnicodeString(e,n-e.l,t);return i.val=l,i}function parse_Format(e,r,t){var n=e.read_shift(2),i=parse_XLUnicodeString2(e,0,t);return[n,i]}var parse_BIFF2Format=parse_XLUnicodeString2;function parse_Dimensions(e,r,t){var n=e.l+r,i=t.biff==8||!t.biff?4:2,l=e.read_shift(i),c=e.read_shift(i),f=e.read_shift(2),d=e.read_shift(2);return e.l=n,{s:{r:l,c:f},e:{r:c,c:d}}}function parse_RK(e){var r=e.read_shift(2),t=e.read_shift(2),n=parse_RkRec(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function parse_MulRk(e,r){for(var t=e.l+r-2,n=e.read_shift(2),i=e.read_shift(2),l=[];e.l<t;)l.push(parse_RkRec(e));if(e.l!==t)throw new Error("MulRK read error");var c=e.read_shift(2);if(l.length!=c-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:c,rkrec:l}}function parse_MulBlank(e,r){for(var t=e.l+r-2,n=e.read_shift(2),i=e.read_shift(2),l=[];e.l<t;)l.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var c=e.read_shift(2);if(l.length!=c-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:c,ixfe:l}}function parse_CellStyleXF(e,r,t,n){var i={},l=e.read_shift(4),c=e.read_shift(4),f=e.read_shift(4),d=e.read_shift(2);return i.patternType=XLSFillPattern[f>>26],n.cellStyles&&(i.alc=l&7,i.fWrap=l>>3&1,i.alcV=l>>4&7,i.fJustLast=l>>7&1,i.trot=l>>8&255,i.cIndent=l>>16&15,i.fShrinkToFit=l>>20&1,i.iReadOrder=l>>22&2,i.fAtrNum=l>>26&1,i.fAtrFnt=l>>27&1,i.fAtrAlc=l>>28&1,i.fAtrBdr=l>>29&1,i.fAtrPat=l>>30&1,i.fAtrProt=l>>31&1,i.dgLeft=c&15,i.dgRight=c>>4&15,i.dgTop=c>>8&15,i.dgBottom=c>>12&15,i.icvLeft=c>>16&127,i.icvRight=c>>23&127,i.grbitDiag=c>>30&3,i.icvTop=f&127,i.icvBottom=f>>7&127,i.icvDiag=f>>14&127,i.dgDiag=f>>21&15,i.icvFore=d&127,i.icvBack=d>>7&127,i.fsxButton=d>>14&1),i}function parse_XF(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=parse_CellStyleXF(e,r,n.fStyle,t),n}function parse_Guts(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function parse_BoolErr(e,r,t){var n=parse_XLSCell(e);(t.biff==2||r==9)&&++e.l;var i=parse_Bes(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function parse_Number(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=parse_XLSCell(e),i=parse_Xnum(e);return n.val=i,n}var parse_XLHeaderFooter=parse_OptXLUnicodeString;function parse_SupBook(e,r,t){var n=e.l+r,i=e.read_shift(2),l=e.read_shift(2);if(t.sbcch=l,l==1025||l==14849)return[l,i];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var c=parse_XLUnicodeStringNoCch(e,l),f=[];n>e.l;)f.push(parse_XLUnicodeString(e));return[l,i,c,f]}function parse_ExternName(e,r,t){var n=e.read_shift(2),i,l={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(i=parse_AddinUdf(e,r-2,t)),l.body=i||e.read_shift(r-2),typeof i=="string"&&(l.Name=i),l}var XLSLblBuiltIn=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function parse_Lbl(e,r,t){var n=e.l+r,i=e.read_shift(2),l=e.read_shift(1),c=e.read_shift(1),f=e.read_shift(t&&t.biff==2?1:2),d=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),d=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var h=parse_XLUnicodeStringNoCch(e,c,t);i&32&&(h=XLSLblBuiltIn[h.charCodeAt(0)]);var p=n-e.l;t&&t.biff==2&&--p;var E=n==e.l||f===0||!(p>0)?[]:parse_NameParsedFormula(e,p,t,f);return{chKey:l,Name:h,itab:d,rgce:E}}function parse_ExternSheet(e,r,t){if(t.biff<8)return parse_BIFF5ExternSheet(e,r,t);for(var n=[],i=e.l+r,l=e.read_shift(t.biff>8?4:2);l--!==0;)n.push(parse_XTI(e,t.biff>8?12:6,t));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function parse_BIFF5ExternSheet(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=parse_ShortXLUnicodeString(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function parse_NameCmt(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),i=e.read_shift(2),l=parse_XLUnicodeStringNoCch(e,n,t),c=parse_XLUnicodeStringNoCch(e,i,t);return[l,c]}function parse_ShrFmla(e,r,t){var n=parse_RefU(e);e.l++;var i=e.read_shift(1);return r-=8,[parse_SharedParsedFormula(e,r,t),i,n]}function parse_Array(e,r,t){var n=parse_Ref(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,parse_ArrayParsedFormula(e,r,t)]}function parse_MTRSettings(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function parse_NoteSh(e,r,t){if(!(t.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),f=parse_XLUnicodeString2(e,0,t);return t.biff<8&&e.read_shift(1),[{r:n,c:i},f,c,l]}}function parse_Note(e,r,t){return parse_NoteSh(e,r,t)}function parse_MergeCells(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(parse_Ref8U(e));return t}function parse_Obj(e,r,t){if(t&&t.biff<8)return parse_BIFF5Obj(e,r,t);var n=parse_FtCmo(e),i=parse_FtArray(e,r-22,n[1]);return{cmo:n,ft:i}}var parse_BIFF5OT={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=t,{fmt:n}}};function parse_BIFF5Obj(e,r,t){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var c=[];return c.push((parse_BIFF5OT[n]||parsenoop)(e,r,t)),{cmo:[i,n,l],ft:c}}function parse_TxO(e,r,t){var n=e.l,i="";try{e.l+=4;var l=(t.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:c=parse_ControlInfo(e,6,t);var f=e.read_shift(2);e.read_shift(2),parseuint16(e,2);var d=e.read_shift(2);e.l+=d;for(var h=1;h<e.lens.length-1;++h){if(e.l-n!=e.lens[h])throw new Error("TxO: bad continue record");var p=e[e.l],E=parse_XLUnicodeStringNoCch(e,e.lens[h+1]-e.lens[h]-1);if(i+=E,i.length>=(p?f:2*f))break}if(i.length!==f&&i.length!==f*2)throw new Error("cchText: "+f+" != "+i.length);return e.l=n+r,{t:i}}catch{return e.l=n+r,{t:i}}}function parse_HLink(e,r){var t=parse_Ref8U(e);e.l+=16;var n=parse_Hyperlink(e,r-24);return[t,n]}function parse_HLinkTooltip(e,r){e.read_shift(2);var t=parse_Ref8U(e),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(chr0,""),[t,n]}function parse_Country(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=CountryEnum[t]||t,t=e.read_shift(2),r[1]=CountryEnum[t]||t,r}function parse_ClrtClient(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(parse_LongRGB(e));return t}function parse_Palette(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(parse_LongRGB(e));return t}function parse_XFCRC(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function parse_ColInfo(e,r,t){if(!t.cellStyles)return parsenoop(e,r);var n=t&&t.biff>=12?4:2,i=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(n),f=e.read_shift(n),d=e.read_shift(2);n==2&&(e.l+=2);var h={s:i,e:l,w:c,ixfe:f,flags:d};return(t.biff>=5||!t.biff)&&(h.level=d>>8&7),h}function parse_Setup(e,r){var t={};return r<32||(e.l+=16,t.header=parse_Xnum(e),t.footer=parse_Xnum(e),e.l+=2),t}function parse_ShtProps(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var parse_Blank=parse_XLSCell,parse_Scl=parseuint16a,parse_String=parse_XLUnicodeString;function parse_ImData(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),i={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function parse_BIFF2STR(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=parse_XLSCell(e);++e.l;var i=parse_XLUnicodeString2(e,r-7,t);return n.t="str",n.val=i,n}function parse_BIFF2NUM(e){var r=parse_XLSCell(e);++e.l;var t=parse_Xnum(e);return r.t="n",r.val=t,r}function parse_BIFF2INT(e){var r=parse_XLSCell(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function parse_BIFF2STRING(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function parse_BIFF2FONTXTRA(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function parse_RString(e,r,t){var n=e.l+r,i=parse_XLSCell(e),l=e.read_shift(2),c=parse_XLUnicodeStringNoCch(e,l,t);return e.l=n,i.t="str",i.val=c,i}var DBF_SUPPORTED_VERSIONS=[2,3,48,49,131,139,140,245],DBF=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=evert({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(f,d){var h=[],p=new_raw_buf(1);switch(d.type){case"base64":p=s2a(Base64_decode(f));break;case"binary":p=s2a(f);break;case"buffer":case"array":p=f;break}prep_blob(p,0);var E=p.read_shift(1),y=!!(E&136),S=!1,x=!1;switch(E){case 2:break;case 3:break;case 48:S=!0,y=!0;break;case 49:S=!0,y=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+E.toString(16))}var g=0,m=521;E==2&&(g=p.read_shift(2)),p.l+=3,E!=2&&(g=p.read_shift(4)),g>1048576&&(g=1e6),E!=2&&(m=p.read_shift(2));var A=p.read_shift(2),O=d.codepage||1252;E!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(O=e[p[p.l]]),p.l+=1,p.l+=2),x&&(p.l+=36);for(var C=[],R={},T=Math.min(p.length,E==2?521:m-10-(S?264:0)),w=x?32:11;p.l<T&&p[p.l]!=13;)switch(R={},R.name=$cptable.utils.decode(O,p.slice(p.l,p.l+w)).replace(/[\u0000\r\n].*$/g,""),p.l+=w,R.type=String.fromCharCode(p.read_shift(1)),E!=2&&!x&&(R.offset=p.read_shift(4)),R.len=p.read_shift(1),E==2&&(R.offset=p.read_shift(2)),R.dec=p.read_shift(1),R.name.length&&C.push(R),E!=2&&(p.l+=x?13:14),R.type){case"B":(!S||R.len!=8)&&d.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+R.type)}if(p[p.l]!==13&&(p.l=m-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=m;var v=0,L=0;for(h[0]=[],L=0;L!=C.length;++L)h[0][L]=C[L].name;for(;g-- >0;){if(p[p.l]===42){p.l+=A;continue}for(++p.l,h[++v]=[],L=0,L=0;L!=C.length;++L){var M=p.slice(p.l,p.l+C[L].len);p.l+=C[L].len,prep_blob(M,0);var X=$cptable.utils.decode(O,M);switch(C[L].type){case"C":X.trim().length&&(h[v][L]=X.replace(/\s+$/,""));break;case"D":X.length===8?h[v][L]=new Date(+X.slice(0,4),+X.slice(4,6)-1,+X.slice(6,8)):h[v][L]=X;break;case"F":h[v][L]=parseFloat(X.trim());break;case"+":case"I":h[v][L]=x?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(X.trim().toUpperCase()){case"Y":case"T":h[v][L]=!0;break;case"N":case"F":h[v][L]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+X+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+E.toString(16));h[v][L]="##MEMO##"+(x?parseInt(X.trim(),10):M.read_shift(4));break;case"N":X=X.replace(/\u0000/g,"").trim(),X&&X!="."&&(h[v][L]=+X||0);break;case"@":h[v][L]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":h[v][L]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":h[v][L]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[v][L]=-M.read_shift(-8,"f");break;case"B":if(S&&C[L].len==8){h[v][L]=M.read_shift(8,"f");break}case"G":case"P":M.l+=C[L].len;break;case"0":if(C[L].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[L].type)}}}if(E!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return d.sheetRows&&(h=h.slice(0,d.sheetRows)),d.DBF=C,h}function n(f,d){var h=d||{};h.dateNF||(h.dateNF="yyyymmdd");var p=aoa_to_sheet(t(f,h),h);return p["!cols"]=h.DBF.map(function(E){return{wch:E.len,DBF:E}}),delete h.DBF,p}function i(f,d){try{return sheet_to_workbook(n(f,d),d)}catch(h){if(d&&d.WTF)throw h}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function c(f,d){var h=d||{};if(+h.codepage>=0&&set_cp(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var p=buf_array(),E=sheet_to_json(f,{header:1,raw:!0,cellDates:!0}),y=E[0],S=E.slice(1),x=f["!cols"]||[],g=0,m=0,A=0,O=1;for(g=0;g<y.length;++g){if(((x[g]||{}).DBF||{}).name){y[g]=x[g].DBF.name,++A;continue}if(y[g]!=null){if(++A,typeof y[g]=="number"&&(y[g]=y[g].toString(10)),typeof y[g]!="string")throw new Error("DBF Invalid column name "+y[g]+" |"+typeof y[g]+"|");if(y.indexOf(y[g])!==g){for(m=0;m<1024;++m)if(y.indexOf(y[g]+"_"+m)==-1){y[g]+="_"+m;break}}}}var C=safe_decode_range(f["!ref"]),R=[],T=[],w=[];for(g=0;g<=C.e.c-C.s.c;++g){var v="",L="",M=0,X=[];for(m=0;m<S.length;++m)S[m][g]!=null&&X.push(S[m][g]);if(X.length==0||y[g]==null){R[g]="?";continue}for(m=0;m<X.length;++m){switch(typeof X[m]){case"number":L="B";break;case"string":L="C";break;case"boolean":L="L";break;case"object":L=X[m]instanceof Date?"D":"C";break;default:L="C"}M=Math.max(M,String(X[m]).length),v=v&&v!=L?"C":L}M>250&&(M=250),L=((x[g]||{}).DBF||{}).type,L=="C"&&x[g].DBF.len>M&&(M=x[g].DBF.len),v=="B"&&L=="N"&&(v="N",w[g]=x[g].DBF.dec,M=x[g].DBF.len),T[g]=v=="C"||L=="N"?M:l[v]||0,O+=T[g],R[g]=v}var H=p.next(32);for(H.write_shift(4,318902576),H.write_shift(4,S.length),H.write_shift(2,296+32*A),H.write_shift(2,O),g=0;g<4;++g)H.write_shift(4,0);for(H.write_shift(4,0|(+r[current_ansi]||3)<<8),g=0,m=0;g<y.length;++g)if(y[g]!=null){var ne=p.next(32),_e=(y[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ne.write_shift(1,_e,"sbcs"),ne.write_shift(1,R[g]=="?"?"C":R[g],"sbcs"),ne.write_shift(4,m),ne.write_shift(1,T[g]||l[R[g]]||0),ne.write_shift(1,w[g]||0),ne.write_shift(1,2),ne.write_shift(4,0),ne.write_shift(1,0),ne.write_shift(4,0),ne.write_shift(4,0),m+=T[g]||l[R[g]]||0}var ge=p.next(264);for(ge.write_shift(4,13),g=0;g<65;++g)ge.write_shift(4,0);for(g=0;g<S.length;++g){var he=p.next(O);for(he.write_shift(1,0),m=0;m<y.length;++m)if(y[m]!=null)switch(R[m]){case"L":he.write_shift(1,S[g][m]==null?63:S[g][m]?84:70);break;case"B":he.write_shift(8,S[g][m]||0,"f");break;case"N":var W="0";for(typeof S[g][m]=="number"&&(W=S[g][m].toFixed(w[m]||0)),A=0;A<T[m]-W.length;++A)he.write_shift(1,32);he.write_shift(1,W,"sbcs");break;case"D":S[g][m]?(he.write_shift(4,("0000"+S[g][m].getFullYear()).slice(-4),"sbcs"),he.write_shift(2,("00"+(S[g][m].getMonth()+1)).slice(-2),"sbcs"),he.write_shift(2,("00"+S[g][m].getDate()).slice(-2),"sbcs")):he.write_shift(8,"00000000","sbcs");break;case"C":var se=String(S[g][m]!=null?S[g][m]:"").slice(0,T[m]);for(he.write_shift(1,se,"sbcs"),A=0;A<T[m]-se.length;++A)he.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:i,to_sheet:n,from_sheet:c}}(),SYLK=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+keys(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(y,S){var x=e[S];return typeof x=="number"?_getansi(x):x},n=function(y,S,x){var g=S.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return g==59?y:_getansi(g)};e["|"]=254;function i(y,S){switch(S.type){case"base64":return l(Base64_decode(y),S);case"binary":return l(y,S);case"buffer":return l(has_buf&&Buffer.isBuffer(y)?y.toString("binary"):a2s(y),S);case"array":return l(cc2str(y),S)}throw new Error("Unrecognized type "+S.type)}function l(y,S){var x=y.split(/[\n\r]+/),g=-1,m=-1,A=0,O=0,C=[],R=[],T=null,w={},v=[],L=[],M=[],X=0,H;for(+S.codepage>=0&&set_cp(+S.codepage);A!==x.length;++A){X=0;var ne=x[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),_e=ne.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),ge=_e[0],he;if(ne.length>0)switch(ge){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":_e[1].charAt(0)=="P"&&R.push(ne.slice(3).replace(/;;/g,";"));break;case"C":var W=!1,se=!1,ue=!1,re=!1,q=-1,me=-1;for(O=1;O<_e.length;++O)switch(_e[O].charAt(0)){case"A":break;case"X":m=parseInt(_e[O].slice(1))-1,se=!0;break;case"Y":for(g=parseInt(_e[O].slice(1))-1,se||(m=0),H=C.length;H<=g;++H)C[H]=[];break;case"K":he=_e[O].slice(1),he.charAt(0)==='"'?he=he.slice(1,he.length-1):he==="TRUE"?he=!0:he==="FALSE"?he=!1:isNaN(fuzzynum(he))?isNaN(fuzzydate(he).getDate())||(he=parseDate(he)):(he=fuzzynum(he),T!==null&&fmt_is_date(T)&&(he=numdate(he))),W=!0;break;case"E":re=!0;var N=rc_to_a1(_e[O].slice(1),{r:g,c:m});C[g][m]=[C[g][m],N];break;case"S":ue=!0,C[g][m]=[C[g][m],"S5S"];break;case"G":break;case"R":q=parseInt(_e[O].slice(1))-1;break;case"C":me=parseInt(_e[O].slice(1))-1;break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+ne)}if(W&&(C[g][m]&&C[g][m].length==2?C[g][m][0]=he:C[g][m]=he,T=null),ue){if(re)throw new Error("SYLK shared formula cannot have own formula");var P=q>-1&&C[q][me];if(!P||!P[1])throw new Error("SYLK shared formula cannot find base");C[g][m][1]=shift_formula_str(P[1],{r:g-q,c:m-me})}break;case"F":var k=0;for(O=1;O<_e.length;++O)switch(_e[O].charAt(0)){case"X":m=parseInt(_e[O].slice(1))-1,++k;break;case"Y":for(g=parseInt(_e[O].slice(1))-1,H=C.length;H<=g;++H)C[H]=[];break;case"M":X=parseInt(_e[O].slice(1))/20;break;case"F":break;case"G":break;case"P":T=R[parseInt(_e[O].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=_e[O].slice(1).split(" "),H=parseInt(M[0],10);H<=parseInt(M[1],10);++H)X=parseInt(M[2],10),L[H-1]=X===0?{hidden:!0}:{wch:X},process_col(L[H-1]);break;case"C":m=parseInt(_e[O].slice(1))-1,L[m]||(L[m]={});break;case"R":g=parseInt(_e[O].slice(1))-1,v[g]||(v[g]={}),X>0?(v[g].hpt=X,v[g].hpx=pt2px(X)):X===0&&(v[g].hidden=!0);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+ne)}k<1&&(T=null);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+ne)}}return v.length>0&&(w["!rows"]=v),L.length>0&&(w["!cols"]=L),S&&S.sheetRows&&(C=C.slice(0,S.sheetRows)),[C,w]}function c(y,S){var x=i(y,S),g=x[0],m=x[1],A=aoa_to_sheet(g,S);return keys(m).forEach(function(O){A[O]=m[O]}),A}function f(y,S){return sheet_to_workbook(c(y,S),S)}function d(y,S,x,g){var m="C;Y"+(x+1)+";X"+(g+1)+";K";switch(y.t){case"n":m+=y.v||0,y.f&&!y.F&&(m+=";E"+a1_to_rc(y.f,{r:x,c:g}));break;case"b":m+=y.v?"TRUE":"FALSE";break;case"e":m+=y.w||y.v;break;case"d":m+='"'+(y.w||y.v)+'"';break;case"s":m+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function h(y,S){S.forEach(function(x,g){var m="F;W"+(g+1)+" "+(g+1)+" ";x.hidden?m+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=width2px(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=px2char(x.wpx)),typeof x.wch=="number"&&(m+=Math.round(x.wch))),m.charAt(m.length-1)!=" "&&y.push(m)})}function p(y,S){S.forEach(function(x,g){var m="F;";x.hidden?m+="M0;":x.hpt?m+="M"+20*x.hpt+";":x.hpx&&(m+="M"+20*px2pt(x.hpx)+";"),m.length>2&&y.push(m+"R"+(g+1))})}function E(y,S){var x=["ID;PWXL;N;E"],g=[],m=safe_decode_range(y["!ref"]),A,O=Array.isArray(y),C=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),y["!cols"]&&h(x,y["!cols"]),y["!rows"]&&p(x,y["!rows"]),x.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var R=m.s.r;R<=m.e.r;++R)for(var T=m.s.c;T<=m.e.c;++T){var w=encode_cell({r:R,c:T});A=O?(y[R]||[])[T]:y[w],!(!A||A.v==null&&(!A.f||A.F))&&g.push(d(A,y,R,T))}return x.join(C)+C+g.join(C)+C+"E"+C}return{to_workbook:f,to_sheet:c,from_sheet:E}}(),DIF=function(){function e(l,c){switch(c.type){case"base64":return r(Base64_decode(l),c);case"binary":return r(l,c);case"buffer":return r(has_buf&&Buffer.isBuffer(l)?l.toString("binary"):a2s(l),c);case"array":return r(cc2str(l),c)}throw new Error("Unrecognized type "+c.type)}function r(l,c){for(var f=l.split(`
`),d=-1,h=-1,p=0,E=[];p!==f.length;++p){if(f[p].trim()==="BOT"){E[++d]=[],h=0;continue}if(!(d<0)){var y=f[p].trim().split(","),S=y[0],x=y[1];++p;for(var g=f[p]||"";(g.match(/["]/g)||[]).length&1&&p<f.length-1;)g+=`
`+f[++p];switch(g=g.trim(),+S){case-1:if(g==="BOT"){E[++d]=[],h=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?E[d][h]=!0:g==="FALSE"?E[d][h]=!1:isNaN(fuzzynum(x))?isNaN(fuzzydate(x).getDate())?E[d][h]=x:E[d][h]=parseDate(x):E[d][h]=fuzzynum(x),++h;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),E[d][h++]=g!==""?g:null;break}if(g==="EOD")break}}return c&&c.sheetRows&&(E=E.slice(0,c.sheetRows)),E}function t(l,c){return aoa_to_sheet(e(l,c),c)}function n(l,c){return sheet_to_workbook(t(l,c),c)}var i=function(){var l=function(d,h,p,E,y){d.push(h),d.push(p+","+E),d.push('"'+y.replace(/"/g,'""')+'"')},c=function(d,h,p,E){d.push(h+","+p),d.push(h==1?'"'+E.replace(/"/g,'""')+'"':E)};return function(d){var h=[],p=safe_decode_range(d["!ref"]),E,y=Array.isArray(d);l(h,"TABLE",0,1,"sheetjs"),l(h,"VECTORS",0,p.e.r-p.s.r+1,""),l(h,"TUPLES",0,p.e.c-p.s.c+1,""),l(h,"DATA",0,0,"");for(var S=p.s.r;S<=p.e.r;++S){c(h,-1,0,"BOT");for(var x=p.s.c;x<=p.e.c;++x){var g=encode_cell({r:S,c:x});if(E=y?(d[S]||[])[x]:d[g],!E){c(h,1,0,"");continue}switch(E.t){case"n":var m=E.w;!m&&E.v!=null&&(m=E.v),m==null?E.f&&!E.F?c(h,1,0,"="+E.f):c(h,1,0,""):c(h,0,m,"V");break;case"b":c(h,0,E.v?1:0,E.v?"TRUE":"FALSE");break;case"s":c(h,1,0,isNaN(E.v)?E.v:'="'+E.v+'"');break;case"d":E.w||(E.w=SSF_format(E.z||table_fmt[14],datenum(parseDate(E.v)))),c(h,0,E.w,"V");break;default:c(h,1,0,"")}}}c(h,-1,0,"EOD");var A=`\r
`,O=h.join(A);return O}}();return{to_workbook:n,to_sheet:t,from_sheet:i}}(),ETH=function(){function e(E){return E.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(E){return E.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(E,y){for(var S=E.split(`
`),x=-1,g=-1,m=0,A=[];m!==S.length;++m){var O=S[m].trim().split(":");if(O[0]==="cell"){var C=decode_cell(O[1]);if(A.length<=C.r)for(x=A.length;x<=C.r;++x)A[x]||(A[x]=[]);switch(x=C.r,g=C.c,O[2]){case"t":A[x][g]=e(O[3]);break;case"v":A[x][g]=+O[3];break;case"vtf":var R=O[O.length-1];case"vtc":switch(O[3]){case"nl":A[x][g]=!!+O[4];break;default:A[x][g]=+O[4];break}O[2]=="vtf"&&(A[x][g]=[A[x][g],R])}}}return y&&y.sheetRows&&(A=A.slice(0,y.sheetRows)),A}function n(E,y){return aoa_to_sheet(t(E,y),y)}function i(E,y){return sheet_to_workbook(n(E,y),y)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,f=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function h(E){if(!E||!E["!ref"])return"";for(var y=[],S=[],x,g="",m=decode_range(E["!ref"]),A=Array.isArray(E),O=m.s.r;O<=m.e.r;++O)for(var C=m.s.c;C<=m.e.c;++C)if(g=encode_cell({r:O,c:C}),x=A?(E[O]||[])[C]:E[g],!(!x||x.v==null||x.t==="z")){switch(S=["cell",g,"t"],x.t){case"s":case"str":S.push(r(x.v));break;case"n":x.f?(S[2]="vtf",S[3]="n",S[4]=x.v,S[5]=r(x.f)):(S[2]="v",S[3]=x.v);break;case"b":S[2]="vt"+(x.f?"f":"c"),S[3]="nl",S[4]=x.v?"1":"0",S[5]=r(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var R=datenum(parseDate(x.v));S[2]="vtc",S[3]="nd",S[4]=""+R,S[5]=x.w||SSF_format(x.z||table_fmt[14],R);break;case"e":continue}y.push(S.join(":"))}return y.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function p(E){return[l,c,f,c,h(E),d].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:p}}(),PRN=function(){function e(p,E,y,S,x){x.raw?E[y][S]=p:p===""||(p==="TRUE"?E[y][S]=!0:p==="FALSE"?E[y][S]=!1:isNaN(fuzzynum(p))?isNaN(fuzzydate(p).getDate())?E[y][S]=p:E[y][S]=parseDate(p):E[y][S]=fuzzynum(p))}function r(p,E){var y=E||{},S=[];if(!p||p.length===0)return S;for(var x=p.split(/[\r\n]/),g=x.length-1;g>=0&&x[g].length===0;)--g;for(var m=10,A=0,O=0;O<=g;++O)A=x[O].indexOf(" "),A==-1?A=x[O].length:A++,m=Math.max(m,A);for(O=0;O<=g;++O){S[O]=[];var C=0;for(e(x[O].slice(0,m).trim(),S,O,C,y),C=1;C<=(x[O].length-m)/10+1;++C)e(x[O].slice(m+(C-1)*10,m+C*10).trim(),S,O,C,y)}return y.sheetRows&&(S=S.slice(0,y.sheetRows)),S}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(p){for(var E={},y=!1,S=0,x=0;S<p.length;++S)(x=p.charCodeAt(S))==34?y=!y:!y&&x in t&&(E[x]=(E[x]||0)+1);x=[];for(S in E)Object.prototype.hasOwnProperty.call(E,S)&&x.push([E[S],S]);if(!x.length){E=n;for(S in E)Object.prototype.hasOwnProperty.call(E,S)&&x.push([E[S],S])}return x.sort(function(g,m){return g[0]-m[0]||n[g[1]]-n[m[1]]}),t[x.pop()[1]]||44}function l(p,E){var y=E||{},S="",x=y.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(S=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(S=p.charAt(4),p=p.slice(6)):S=i(p.slice(0,1024)):y.FS?S=y.FS:S=i(p.slice(0,1024));var m=0,A=0,O=0,C=0,R=0,T=S.charCodeAt(0),w=!1,v=0,L=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var M=y.dateNF!=null?dateNF_regex(y.dateNF):null;function X(){var H=p.slice(C,R),ne={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),H.length===0)ne.t="z";else if(y.raw)ne.t="s",ne.v=H;else if(H.trim().length===0)ne.t="s",ne.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(ne.t="s",ne.v=H.slice(2,-1).replace(/""/g,'"')):fuzzyfmla(H)?(ne.t="n",ne.f=H.slice(1)):(ne.t="s",ne.v=H);else if(H=="TRUE")ne.t="b",ne.v=!0;else if(H=="FALSE")ne.t="b",ne.v=!1;else if(!isNaN(O=fuzzynum(H)))ne.t="n",y.cellText!==!1&&(ne.w=H),ne.v=O;else if(!isNaN(fuzzydate(H).getDate())||M&&H.match(M)){ne.z=y.dateNF||table_fmt[14];var _e=0;M&&H.match(M)&&(H=dateNF_fix(H,y.dateNF,H.match(M)||[]),_e=1),y.cellDates?(ne.t="d",ne.v=parseDate(H,_e)):(ne.t="n",ne.v=datenum(parseDate(H,_e))),y.cellText!==!1&&(ne.w=SSF_format(ne.z,ne.v instanceof Date?datenum(ne.v):ne.v)),y.cellNF||delete ne.z}else ne.t="s",ne.v=H;if(ne.t=="z"||(y.dense?(x[m]||(x[m]=[]),x[m][A]=ne):x[encode_cell({c:A,r:m})]=ne),C=R+1,L=p.charCodeAt(C),g.e.c<A&&(g.e.c=A),g.e.r<m&&(g.e.r=m),v==T)++A;else if(A=0,++m,y.sheetRows&&y.sheetRows<=m)return!0}e:for(;R<p.length;++R)switch(v=p.charCodeAt(R)){case 34:L===34&&(w=!w);break;case T:case 10:case 13:if(!w&&X())break e;break}return R-C>0&&X(),x["!ref"]=encode_range(g),x}function c(p,E){return!(E&&E.PRN)||E.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?l(p,E):aoa_to_sheet(r(p,E),E)}function f(p,E){var y="",S=E.type=="string"?[0,0,0,0]:firstbyte(p,E);switch(E.type){case"base64":y=Base64_decode(p);break;case"binary":y=p;break;case"buffer":E.codepage==65001?y=p.toString("utf8"):(E.codepage,y=has_buf&&Buffer.isBuffer(p)?p.toString("binary"):a2s(p));break;case"array":y=cc2str(p);break;case"string":y=p;break;default:throw new Error("Unrecognized type "+E.type)}return S[0]==239&&S[1]==187&&S[2]==191?y=utf8read(y.slice(3)):E.type!="string"&&E.type!="buffer"&&E.codepage==65001?y=utf8read(y):E.type=="binary",y.slice(0,19)=="socialcalc:version:"?ETH.to_sheet(E.type=="string"?y:utf8read(y),E):c(y,E)}function d(p,E){return sheet_to_workbook(f(p,E),E)}function h(p){for(var E=[],y=safe_decode_range(p["!ref"]),S,x=Array.isArray(p),g=y.s.r;g<=y.e.r;++g){for(var m=[],A=y.s.c;A<=y.e.c;++A){var O=encode_cell({r:g,c:A});if(S=x?(p[g]||[])[A]:p[O],!S||S.v==null){m.push("          ");continue}for(var C=(S.w||(format_cell(S),S.w)||"").slice(0,10);C.length<10;)C+=" ";m.push(C+(A===0?" ":""))}E.push(m.join(""))}return E.join(`
`)}return{to_workbook:d,to_sheet:f,from_sheet:h}}();function read_wb_ID(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var i=SYLK.to_workbook(e,t);return t.WTF=n,i}catch(l){if(t.WTF=n,!l.message.match(/SYLK bad record ID/)&&n)throw l;return PRN.to_workbook(e,r)}}var WK_=function(){function e(N,P,k){if(N){prep_blob(N,N.l||0);for(var B=k.Enum||q;N.l<N.length;){var z=N.read_shift(2),Q=B[z]||B[65535],K=N.read_shift(2),F=N.l+K,I=Q.f&&Q.f(N,K,k);if(N.l=F,P(I,Q,z))return}}}function r(N,P){switch(P.type){case"base64":return t(s2a(Base64_decode(N)),P);case"binary":return t(s2a(N),P);case"buffer":case"array":return t(N,P)}throw"Unsupported type "+P.type}function t(N,P){if(!N)return N;var k=P||{},B=k.dense?[]:{},z="Sheet1",Q="",K=0,F={},I=[],V=[],D={s:{r:0,c:0},e:{r:0,c:0}},Y=k.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)k.Enum=q,e(N,function(J,Ae,pe){switch(pe){case 0:k.vers=J,J>=4096&&(k.qpro=!0);break;case 6:D=J;break;case 204:J&&(Q=J);break;case 222:Q=J;break;case 15:case 51:k.qpro||(J[1].v=J[1].v.slice(1));case 13:case 14:case 16:pe==14&&(J[2]&112)==112&&(J[2]&15)>1&&(J[2]&15)<15&&(J[1].z=k.dateNF||table_fmt[14],k.cellDates&&(J[1].t="d",J[1].v=numdate(J[1].v))),k.qpro&&J[3]>K&&(B["!ref"]=encode_range(D),F[z]=B,I.push(z),B=k.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},K=J[3],z=Q||"Sheet"+(K+1),Q="");var ve=k.dense?(B[J[0].r]||[])[J[0].c]:B[encode_cell(J[0])];if(ve){ve.t=J[1].t,ve.v=J[1].v,J[1].z!=null&&(ve.z=J[1].z),J[1].f!=null&&(ve.f=J[1].f);break}k.dense?(B[J[0].r]||(B[J[0].r]=[]),B[J[0].r][J[0].c]=J[1]):B[encode_cell(J[0])]=J[1];break}},k);else if(N[2]==26||N[2]==14)k.Enum=me,N[2]==14&&(k.qpro=!0,N.l=0),e(N,function(J,Ae,pe){switch(pe){case 204:z=J;break;case 22:J[1].v=J[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(J[3]>K&&(B["!ref"]=encode_range(D),F[z]=B,I.push(z),B=k.dense?[]:{},D={s:{r:0,c:0},e:{r:0,c:0}},K=J[3],z="Sheet"+(K+1)),Y>0&&J[0].r>=Y)break;k.dense?(B[J[0].r]||(B[J[0].r]=[]),B[J[0].r][J[0].c]=J[1]):B[encode_cell(J[0])]=J[1],D.e.c<J[0].c&&(D.e.c=J[0].c),D.e.r<J[0].r&&(D.e.r=J[0].r);break;case 27:J[14e3]&&(V[J[14e3][0]]=J[14e3][1]);break;case 1537:V[J[0]]=J[1],J[0]==K&&(z=J[1]);break}},k);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(B["!ref"]=encode_range(D),F[Q||z]=B,I.push(Q||z),!V.length)return{SheetNames:I,Sheets:F};for(var ie={},te=[],j=0;j<V.length;++j)F[I[j]]?(te.push(V[j]||I[j]),ie[V[j]]=F[V[j]]||F[I[j]]):(te.push(V[j]),ie[V[j]]={"!ref":"A1"});return{SheetNames:te,Sheets:ie}}function n(N,P){var k=P||{};if(+k.codepage>=0&&set_cp(+k.codepage),k.type=="string")throw new Error("Cannot write WK1 to JS string");var B=buf_array(),z=safe_decode_range(N["!ref"]),Q=Array.isArray(N),K=[];write_biff_rec(B,0,l(1030)),write_biff_rec(B,6,d(z));for(var F=Math.min(z.e.r,8191),I=z.s.r;I<=F;++I)for(var V=encode_row(I),D=z.s.c;D<=z.e.c;++D){I===z.s.r&&(K[D]=encode_col(D));var Y=K[D]+V,ie=Q?(N[I]||[])[D]:N[Y];if(!(!ie||ie.t=="z"))if(ie.t=="n")(ie.v|0)==ie.v&&ie.v>=-32768&&ie.v<=32767?write_biff_rec(B,13,S(I,D,ie.v)):write_biff_rec(B,14,g(I,D,ie.v));else{var te=format_cell(ie);write_biff_rec(B,15,E(I,D,te.slice(0,239)))}}return write_biff_rec(B,1),B.end()}function i(N,P){var k=P||{};if(+k.codepage>=0&&set_cp(+k.codepage),k.type=="string")throw new Error("Cannot write WK3 to JS string");var B=buf_array();write_biff_rec(B,0,c(N));for(var z=0,Q=0;z<N.SheetNames.length;++z)(N.Sheets[N.SheetNames[z]]||{})["!ref"]&&write_biff_rec(B,27,re(N.SheetNames[z],Q++));var K=0;for(z=0;z<N.SheetNames.length;++z){var F=N.Sheets[N.SheetNames[z]];if(!(!F||!F["!ref"])){for(var I=safe_decode_range(F["!ref"]),V=Array.isArray(F),D=[],Y=Math.min(I.e.r,8191),ie=I.s.r;ie<=Y;++ie)for(var te=encode_row(ie),j=I.s.c;j<=I.e.c;++j){ie===I.s.r&&(D[j]=encode_col(j));var J=D[j]+te,Ae=V?(F[ie]||[])[j]:F[J];if(!(!Ae||Ae.t=="z"))if(Ae.t=="n")write_biff_rec(B,23,X(ie,j,K,Ae.v));else{var pe=format_cell(Ae);write_biff_rec(B,22,v(ie,j,K,pe.slice(0,239)))}}++K}}return write_biff_rec(B,1),B.end()}function l(N){var P=new_buf(2);return P.write_shift(2,N),P}function c(N){var P=new_buf(26);P.write_shift(2,4096),P.write_shift(2,4),P.write_shift(4,0);for(var k=0,B=0,z=0,Q=0;Q<N.SheetNames.length;++Q){var K=N.SheetNames[Q],F=N.Sheets[K];if(!(!F||!F["!ref"])){++z;var I=decode_range(F["!ref"]);k<I.e.r&&(k=I.e.r),B<I.e.c&&(B=I.e.c)}}return k>8191&&(k=8191),P.write_shift(2,k),P.write_shift(1,z),P.write_shift(1,B),P.write_shift(2,0),P.write_shift(2,0),P.write_shift(1,1),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(4,0),P}function f(N,P,k){var B={s:{c:0,r:0},e:{c:0,r:0}};return P==8&&k.qpro?(B.s.c=N.read_shift(1),N.l++,B.s.r=N.read_shift(2),B.e.c=N.read_shift(1),N.l++,B.e.r=N.read_shift(2),B):(B.s.c=N.read_shift(2),B.s.r=N.read_shift(2),P==12&&k.qpro&&(N.l+=2),B.e.c=N.read_shift(2),B.e.r=N.read_shift(2),P==12&&k.qpro&&(N.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function d(N){var P=new_buf(8);return P.write_shift(2,N.s.c),P.write_shift(2,N.s.r),P.write_shift(2,N.e.c),P.write_shift(2,N.e.r),P}function h(N,P,k){var B=[{c:0,r:0},{t:"n",v:0},0,0];return k.qpro&&k.vers!=20768?(B[0].c=N.read_shift(1),B[3]=N.read_shift(1),B[0].r=N.read_shift(2),N.l+=2):(B[2]=N.read_shift(1),B[0].c=N.read_shift(2),B[0].r=N.read_shift(2)),B}function p(N,P,k){var B=N.l+P,z=h(N,P,k);if(z[1].t="s",k.vers==20768){N.l++;var Q=N.read_shift(1);return z[1].v=N.read_shift(Q,"utf8"),z}return k.qpro&&N.l++,z[1].v=N.read_shift(B-N.l,"cstr"),z}function E(N,P,k){var B=new_buf(7+k.length);B.write_shift(1,255),B.write_shift(2,P),B.write_shift(2,N),B.write_shift(1,39);for(var z=0;z<B.length;++z){var Q=k.charCodeAt(z);B.write_shift(1,Q>=128?95:Q)}return B.write_shift(1,0),B}function y(N,P,k){var B=h(N,P,k);return B[1].v=N.read_shift(2,"i"),B}function S(N,P,k){var B=new_buf(7);return B.write_shift(1,255),B.write_shift(2,P),B.write_shift(2,N),B.write_shift(2,k,"i"),B}function x(N,P,k){var B=h(N,P,k);return B[1].v=N.read_shift(8,"f"),B}function g(N,P,k){var B=new_buf(13);return B.write_shift(1,255),B.write_shift(2,P),B.write_shift(2,N),B.write_shift(8,k,"f"),B}function m(N,P,k){var B=N.l+P,z=h(N,P,k);if(z[1].v=N.read_shift(8,"f"),k.qpro)N.l=B;else{var Q=N.read_shift(2);R(N.slice(N.l,N.l+Q),z),N.l+=Q}return z}function A(N,P,k){var B=P&32768;return P&=-32769,P=(B?N:0)+(P>=8192?P-16384:P),(B?"":"$")+(k?encode_col(P):encode_row(P))}var O={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function R(N,P){prep_blob(N,0);for(var k=[],B=0,z="",Q="",K="",F="";N.l<N.length;){var I=N[N.l++];switch(I){case 0:k.push(N.read_shift(8,"f"));break;case 1:Q=A(P[0].c,N.read_shift(2),!0),z=A(P[0].r,N.read_shift(2),!1),k.push(Q+z);break;case 2:{var V=A(P[0].c,N.read_shift(2),!0),D=A(P[0].r,N.read_shift(2),!1);Q=A(P[0].c,N.read_shift(2),!0),z=A(P[0].r,N.read_shift(2),!1),k.push(V+D+":"+Q+z)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:k.push("("+k.pop()+")");break;case 5:k.push(N.read_shift(2));break;case 6:{for(var Y="";I=N[N.l++];)Y+=String.fromCharCode(I);k.push('"'+Y.replace(/"/g,'""')+'"')}break;case 8:k.push("-"+k.pop());break;case 23:k.push("+"+k.pop());break;case 22:k.push("NOT("+k.pop()+")");break;case 20:case 21:F=k.pop(),K=k.pop(),k.push(["AND","OR"][I-20]+"("+K+","+F+")");break;default:if(I<32&&C[I])F=k.pop(),K=k.pop(),k.push(K+C[I]+F);else if(O[I]){if(B=O[I][1],B==69&&(B=N[N.l++]),B>k.length){console.error("WK1 bad formula parse 0x"+I.toString(16)+":|"+k.join("|")+"|");return}var ie=k.slice(-B);k.length-=B,k.push(O[I][0]+"("+ie.join(",")+")")}else return I<=7?console.error("WK1 invalid opcode "+I.toString(16)):I<=24?console.error("WK1 unsupported op "+I.toString(16)):I<=30?console.error("WK1 invalid opcode "+I.toString(16)):I<=115?console.error("WK1 unsupported function opcode "+I.toString(16)):console.error("WK1 unrecognized opcode "+I.toString(16))}}k.length==1?P[1].f=""+k[0]:console.error("WK1 bad formula parse |"+k.join("|")+"|")}function T(N){var P=[{c:0,r:0},{t:"n",v:0},0];return P[0].r=N.read_shift(2),P[3]=N[N.l++],P[0].c=N[N.l++],P}function w(N,P){var k=T(N);return k[1].t="s",k[1].v=N.read_shift(P-4,"cstr"),k}function v(N,P,k,B){var z=new_buf(6+B.length);z.write_shift(2,N),z.write_shift(1,k),z.write_shift(1,P),z.write_shift(1,39);for(var Q=0;Q<B.length;++Q){var K=B.charCodeAt(Q);z.write_shift(1,K>=128?95:K)}return z.write_shift(1,0),z}function L(N,P){var k=T(N);k[1].v=N.read_shift(2);var B=k[1].v>>1;if(k[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return k[1].v=B,k}function M(N,P){var k=T(N),B=N.read_shift(4),z=N.read_shift(4),Q=N.read_shift(2);if(Q==65535)return B===0&&z===3221225472?(k[1].t="e",k[1].v=15):B===0&&z===3489660928?(k[1].t="e",k[1].v=42):k[1].v=0,k;var K=Q&32768;return Q=(Q&32767)-16446,k[1].v=(1-K*2)*(z*Math.pow(2,Q+32)+B*Math.pow(2,Q)),k}function X(N,P,k,B){var z=new_buf(14);if(z.write_shift(2,N),z.write_shift(1,k),z.write_shift(1,P),B==0)return z.write_shift(4,0),z.write_shift(4,0),z.write_shift(2,65535),z;var Q=0,K=0,F=0,I=0;return B<0&&(Q=1,B=-B),K=Math.log2(B)|0,B/=Math.pow(2,K-31),I=B>>>0,I&2147483648||(B/=2,++K,I=B>>>0),B-=I,I|=2147483648,I>>>=0,B*=Math.pow(2,32),F=B>>>0,z.write_shift(4,F),z.write_shift(4,I),K+=16383+(Q?32768:0),z.write_shift(2,K),z}function H(N,P){var k=M(N);return N.l+=P-14,k}function ne(N,P){var k=T(N),B=N.read_shift(4);return k[1].v=B>>6,k}function _e(N,P){var k=T(N),B=N.read_shift(8,"f");return k[1].v=B,k}function ge(N,P){var k=_e(N);return N.l+=P-10,k}function he(N,P){return N[N.l+P-1]==0?N.read_shift(P,"cstr"):""}function W(N,P){var k=N[N.l++];k>P-1&&(k=P-1);for(var B="";B.length<k;)B+=String.fromCharCode(N[N.l++]);return B}function se(N,P,k){if(!(!k.qpro||P<21)){var B=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var z=N.read_shift(P-21,"cstr");return[B,z]}}function ue(N,P){for(var k={},B=N.l+P;N.l<B;){var z=N.read_shift(2);if(z==14e3){for(k[z]=[0,""],k[z][0]=N.read_shift(2);N[N.l];)k[z][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return k}function re(N,P){var k=new_buf(5+N.length);k.write_shift(2,14e3),k.write_shift(2,P);for(var B=0;B<N.length;++B){var z=N.charCodeAt(B);k[k.l++]=z>127?95:z}return k[k.l++]=0,k}var q={0:{n:"BOF",f:parseuint16},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:he},222:{n:"SHEETNAMELP",f:W},65535:{n:""}},me={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:w},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:L},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ue},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ne},38:{n:"??"},39:{n:"NUMBER27",f:_e},40:{n:"FORMULA28",f:ge},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:he},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:r}}();function parse_rpr(e){var r={},t=e.match(tagregex),n=0,i=!1;if(t)for(;n!=t.length;++n){var l=parsexmltag(t[n]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;r.cp=CS2CP[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=l.val;break;case"<sz":r.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":l.rgb&&(r.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(l[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+l[0])}}return r}var parse_rs=function(){var e=matchtag("t"),r=matchtag("rPr");function t(l){var c=l.match(e);if(!c)return{t:"s",v:""};var f={t:"s",v:unescapexml(c[1])},d=l.match(r);return d&&(f.s=parse_rpr(d[1])),f}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(c){return c.replace(n,"").split(i).map(t).filter(function(f){return f.v})}}(),rs_to_html=function(){var r=/(\r\n|\n)/g;function t(i,l,c){var f=[];i.u&&f.push("text-decoration: underline;"),i.uval&&f.push("text-underline-style:"+i.uval+";"),i.sz&&f.push("font-size:"+i.sz+"pt;"),i.outline&&f.push("text-effect: outline;"),i.shadow&&f.push("text-shadow: auto;"),l.push('<span style="'+f.join("")+'">'),i.b&&(l.push("<b>"),c.push("</b>")),i.i&&(l.push("<i>"),c.push("</i>")),i.strike&&(l.push("<s>"),c.push("</s>"));var d=i.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(l.push("<"+d+">"),c.push("</"+d+">")),c.push("</span>"),i}function n(i){var l=[[],i.v,[]];return i.v?(i.s&&t(i.s,l[0],l[2]),l[0].join("")+l[1].replace(r,"<br/>")+l[2].join("")):""}return function(l){return l.map(n).join("")}}(),sitregex=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,sirregex=/<(?:\w+:)?r>/,sirphregex=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function parse_si(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=unescapexml(utf8read(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=utf8read(e),t&&(n.h=escapehtml(n.t))):e.match(sirregex)&&(n.r=utf8read(e),n.t=unescapexml(utf8read((e.replace(sirphregex,"").match(sitregex)||[]).join("").replace(tagregex,""))),t&&(n.h=rs_to_html(parse_rs(n.r)))),n):{t:""}}var sstr0=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sstr1=/<(?:\w+:)?(?:si|sstItem)>/g,sstr2=/<\/(?:\w+:)?(?:si|sstItem)>/;function parse_sst_xml(e,r){var t=[],n="";if(!e)return t;var i=e.match(sstr0);if(i){n=i[2].replace(sstr1,"").split(sstr2);for(var l=0;l!=n.length;++l){var c=parse_si(n[l].trim(),r);c!=null&&(t[t.length]=c)}i=parsexmltag(i[1]),t.Count=i.count,t.Unique=i.uniqueCount}return t}function parse_BrtBeginSst(e){return[e.read_shift(4),e.read_shift(4)]}function parse_sst_bin(e,r){var t=[],n=!1;return recordhopper(e,function(l,c,f){switch(f){case 159:t.Count=l[0],t.Unique=l[1];break;case 19:t.push(l);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(c.T,!n||r.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}),t}function _JS2ANSI(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function parse_CRYPTOVersion(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function parse_DataSpaceVersionInfo(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=parse_CRYPTOVersion(e,4),r.U=parse_CRYPTOVersion(e,4),r.W=parse_CRYPTOVersion(e,4),r}function parse_DataSpaceMapEntry(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},i=e.read_shift(4),l=[];i-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=l,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function parse_DataSpaceMap(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(parse_DataSpaceMapEntry(e));return r}function parse_DataSpaceDefinition(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function parse_TransformInfoHeader(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=parse_CRYPTOVersion(e,4),r.U=parse_CRYPTOVersion(e,4),r.W=parse_CRYPTOVersion(e,4),r}function parse_Primary(e){var r=parse_TransformInfoHeader(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function parse_EncryptionHeader(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function parse_EncryptionVerifier(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function parse_EncryptionInfo(e){var r=parse_CRYPTOVersion(e);switch(r.Minor){case 2:return[r.Minor,parse_EncInfoStd(e)];case 3:return[r.Minor,parse_EncInfoExt()];case 4:return[r.Minor,parse_EncInfoAgl(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function parse_EncInfoStd(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=parse_EncryptionHeader(e,t),i=parse_EncryptionVerifier(e,e.length-e.l);return{t:"Std",h:n,v:i}}function parse_EncInfoExt(){throw new Error("File is password-protected: ECMA-376 Extensible")}function parse_EncInfoAgl(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(tagregex,function(l){var c=parsexmltag(l);switch(strip_ns(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(f){n[f]=c[f]});break;case"<dataIntegrity":n.encryptedHmacKey=c.encryptedHmacKey,n.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(c);break;default:throw c[0]}}),n}function parse_RC4CryptoHeader(e,r){var t={},n=t.EncryptionVersionInfo=parse_CRYPTOVersion(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var i=e.read_shift(4);return r-=4,t.EncryptionHeader=parse_EncryptionHeader(e,i),r-=i,t.EncryptionVerifier=parse_EncryptionVerifier(e,r),t}function parse_RC4Header(e){var r={},t=r.EncryptionVersionInfo=parse_CRYPTOVersion(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function crypto_CreatePasswordVerifier_Method1(e){var r=0,t,n=_JS2ANSI(e),i=n.length+1,l,c,f,d,h;for(t=new_raw_buf(i),t[0]=n.length,l=1;l!=i;++l)t[l]=n[l-1];for(l=i-1;l>=0;--l)c=t[l],f=r&16384?1:0,d=r<<1&32767,h=f|d,r=h^c;return r^52811}var crypto_CreateXorArray_Method1=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(c){return(c/2|c*128)&255},i=function(c,f){return n(c^f)},l=function(c){for(var f=r[c.length-1],d=104,h=c.length-1;h>=0;--h)for(var p=c[h],E=0;E!=7;++E)p&64&&(f^=t[d]),p*=2,--d;return f};return function(c){for(var f=_JS2ANSI(c),d=l(f),h=f.length,p=new_raw_buf(16),E=0;E!=16;++E)p[E]=0;var y,S,x;for((h&1)===1&&(y=d>>8,p[h]=i(e[0],y),--h,y=d&255,S=f[f.length-1],p[h]=i(S,y));h>0;)--h,y=d>>8,p[h]=i(f[h],y),--h,y=d&255,p[h]=i(f[h],y);for(h=15,x=15-f.length;x>0;)y=d>>8,p[h]=i(e[x],y),--h,--x,y=d&255,p[h]=i(f[h],y),--h,--x;return p}}(),crypto_DecryptData_Method1=function(e,r,t,n,i){i||(i=r),n||(n=crypto_CreateXorArray_Method1(e));var l,c;for(l=0;l!=r.length;++l)c=r[l],c^=n[t],c=(c>>5|c<<3)&255,i[l]=c,++t;return[i,t,n]},crypto_MakeXorDecryptor=function(e){var r=0,t=crypto_CreateXorArray_Method1(e);return function(n){var i=crypto_DecryptData_Method1("",n,r,t);return r=i[1],i[0]}};function parse_XORObfuscation(e,r,t,n){var i={key:parseuint16(e),verificationBytes:parseuint16(e)};return t.password&&(i.verifier=crypto_CreatePasswordVerifier_Method1(t.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=crypto_MakeXorDecryptor(t.password)),i}function parse_FilePassHeader(e,r,t){var n=t;return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=parse_RC4Header(e):n.Data=parse_RC4CryptoHeader(e,r),n}function parse_FilePass(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?parse_FilePassHeader(e,r-2,n):parse_XORObfuscation(e,t.biff>=8?r:r-2,t,n),n}var RTF=function(){function e(i,l){switch(l.type){case"base64":return r(Base64_decode(i),l);case"binary":return r(i,l);case"buffer":return r(has_buf&&Buffer.isBuffer(i)?i.toString("binary"):a2s(i),l);case"array":return r(cc2str(i),l)}throw new Error("Unrecognized type "+l.type)}function r(i,l){var c=l||{},f=c.dense?[]:{},d=i.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(p,E){Array.isArray(f)&&(f[E]=[]);for(var y=/\\\w+\b/g,S=0,x,g=-1;x=y.exec(p);){switch(x[0]){case"\\cell":var m=p.slice(S,y.lastIndex-x[0].length);if(m[0]==" "&&(m=m.slice(1)),++g,m.length){var A={v:m,t:"s"};Array.isArray(f)?f[E][g]=A:f[encode_cell({r:E,c:g})]=A}break}S=y.lastIndex}g>h.e.c&&(h.e.c=g)}),f["!ref"]=encode_range(h),f}function t(i,l){return sheet_to_workbook(e(i,l),l)}function n(i){for(var l=["{\\rtf1\\ansi"],c=safe_decode_range(i["!ref"]),f,d=Array.isArray(i),h=c.s.r;h<=c.e.r;++h){l.push("\\trowd\\trautofit1");for(var p=c.s.c;p<=c.e.c;++p)l.push("\\cellx"+(p+1));for(l.push("\\pard\\intbl"),p=c.s.c;p<=c.e.c;++p){var E=encode_cell({r:h,c:p});f=d?(i[h]||[])[p]:i[E],!(!f||f.v==null&&(!f.f||f.F))&&(l.push(" "+(f.w||(format_cell(f),f.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}}();function hex2RGB(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function rgb2Hex(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function rgb2HSL(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,i=Math.max(r,t,n),l=Math.min(r,t,n),c=i-l;if(c===0)return[0,0,r];var f=0,d=0,h=i+l;switch(d=c/(h>1?2-h:h),i){case r:f=((t-n)/c+6)%6;break;case t:f=(n-r)/c+2;break;case n:f=(r-t)/c+4;break}return[f/6,d,h/2]}function hsl2RGB(e){var r=e[0],t=e[1],n=e[2],i=t*2*(n<.5?n:1-n),l=n-i/2,c=[l,l,l],f=6*r,d;if(t!==0)switch(f|0){case 0:case 6:d=i*f,c[0]+=i,c[1]+=d;break;case 1:d=i*(2-f),c[0]+=d,c[1]+=i;break;case 2:d=i*(f-2),c[1]+=i,c[2]+=d;break;case 3:d=i*(4-f),c[1]+=d,c[2]+=i;break;case 4:d=i*(f-4),c[2]+=i,c[0]+=d;break;case 5:d=i*(6-f),c[2]+=d,c[0]+=i;break}for(var h=0;h!=3;++h)c[h]=Math.round(c[h]*255);return c}function rgb_tint(e,r){if(r===0)return e;var t=rgb2HSL(hex2RGB(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),rgb2Hex(hsl2RGB(t))}var DEF_MDW=6,MAX_MDW=15,MIN_MDW=1,MDW=DEF_MDW;function width2px(e){return Math.floor((e+Math.round(128/MDW)/256)*MDW)}function px2char(e){return Math.floor((e-5)/MDW*100+.5)/100}function char2width(e){return Math.round((e*MDW+5)/MDW*256)/256}function cycle_width(e){return char2width(px2char(width2px(e)))}function find_mdw_colw(e){var r=Math.abs(e-cycle_width(e)),t=MDW;if(r>.005)for(MDW=MIN_MDW;MDW<MAX_MDW;++MDW)Math.abs(e-cycle_width(e))<=r&&(r=Math.abs(e-cycle_width(e)),t=MDW);MDW=t}function process_col(e){e.width?(e.wpx=width2px(e.width),e.wch=px2char(e.wpx),e.MDW=MDW):e.wpx?(e.wch=px2char(e.wpx),e.width=char2width(e.wch),e.MDW=MDW):typeof e.wch=="number"&&(e.width=char2width(e.wch),e.wpx=width2px(e.width),e.MDW=MDW),e.customWidth&&delete e.customWidth}var DEF_PPI=96,PPI=DEF_PPI;function px2pt(e){return e*96/PPI}function pt2px(e){return e*PPI/96}var XLMLPatternTypeMap={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function parse_borders(e,r,t,n){r.Borders=[];var i={},l=!1;(e[0].match(tagregex)||[]).forEach(function(c){var f=parsexmltag(c);switch(strip_ns(f[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},f.diagonalUp&&(i.diagonalUp=parsexmlbool(f.diagonalUp)),f.diagonalDown&&(i.diagonalDown=parsexmlbool(f.diagonalDown)),r.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+f[0]+" in borders")}})}function parse_fills(e,r,t,n){r.Fills=[];var i={},l=!1;(e[0].match(tagregex)||[]).forEach(function(c){var f=parsexmltag(c);switch(strip_ns(f[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},r.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":f.patternType&&(i.patternType=f.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),f.indexed&&(i.bgColor.indexed=parseInt(f.indexed,10)),f.theme&&(i.bgColor.theme=parseInt(f.theme,10)),f.tint&&(i.bgColor.tint=parseFloat(f.tint)),f.rgb&&(i.bgColor.rgb=f.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),f.theme&&(i.fgColor.theme=parseInt(f.theme,10)),f.tint&&(i.fgColor.tint=parseFloat(f.tint)),f.rgb!=null&&(i.fgColor.rgb=f.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+f[0]+" in fills")}})}function parse_fonts(e,r,t,n){r.Fonts=[];var i={},l=!1;(e[0].match(tagregex)||[]).forEach(function(c){var f=parsexmltag(c);switch(strip_ns(f[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(i),i={};break;case"<name":f.val&&(i.name=utf8read(f.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=f.val?parsexmlbool(f.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=f.val?parsexmlbool(f.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(f.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=f.val?parsexmlbool(f.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=f.val?parsexmlbool(f.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=f.val?parsexmlbool(f.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=f.val?parsexmlbool(f.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=f.val?parsexmlbool(f.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":f.val&&(i.sz=+f.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":f.val&&(i.vertAlign=f.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":f.val&&(i.family=parseInt(f.val,10));break;case"<family/>":case"</family>":break;case"<scheme":f.val&&(i.scheme=f.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(f.val=="1")break;f.codepage=CS2CP[parseInt(f.val,10)];break;case"<color":if(i.color||(i.color={}),f.auto&&(i.color.auto=parsexmlbool(f.auto)),f.rgb)i.color.rgb=f.rgb.slice(-6);else if(f.indexed){i.color.index=parseInt(f.indexed,10);var d=XLSIcv[i.color.index];i.color.index==81&&(d=XLSIcv[1]),d||(d=XLSIcv[1]),i.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else f.theme&&(i.color.theme=parseInt(f.theme,10),f.tint&&(i.color.tint=parseFloat(f.tint)),f.theme&&t.themeElements&&t.themeElements.clrScheme&&(i.color.rgb=rgb_tint(t.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+f[0]+" in fonts")}})}function parse_numFmts(e,r,t){r.NumberFmt=[];for(var n=keys(table_fmt),i=0;i<n.length;++i)r.NumberFmt[n[i]]=table_fmt[n[i]];var l=e[0].match(tagregex);if(l)for(i=0;i<l.length;++i){var c=parsexmltag(l[i]);switch(strip_ns(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var f=unescapexml(utf8read(c.formatCode)),d=parseInt(c.numFmtId,10);if(r.NumberFmt[d]=f,d>0){if(d>392){for(d=392;d>60&&r.NumberFmt[d]!=null;--d);r.NumberFmt[d]=f}SSF_load(f,d)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}var cellXF_uint=["numFmtId","fillId","fontId","borderId","xfId"],cellXF_bool=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function parse_cellXfs(e,r,t){r.CellXf=[];var n,i=!1;(e[0].match(tagregex)||[]).forEach(function(l){var c=parsexmltag(l),f=0;switch(strip_ns(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=c,delete n[0],f=0;f<cellXF_uint.length;++f)n[cellXF_uint[f]]&&(n[cellXF_uint[f]]=parseInt(n[cellXF_uint[f]],10));for(f=0;f<cellXF_bool.length;++f)n[cellXF_bool[f]]&&(n[cellXF_bool[f]]=parsexmlbool(n[cellXF_bool[f]]));if(r.NumberFmt&&n.numFmtId>392){for(f=392;f>60;--f)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[f]){n.numFmtId=f;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};c.vertical&&(d.vertical=c.vertical),c.horizontal&&(d.horizontal=c.horizontal),c.textRotation!=null&&(d.textRotation=c.textRotation),c.indent&&(d.indent=c.indent),c.wrapText&&(d.wrapText=parsexmlbool(c.wrapText)),n.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(t&&t.WTF&&!i)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}var parse_sty_xml=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(f,d,h){var p={};if(!f)return p;f=f.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var E;return(E=f.match(r))&&parse_numFmts(E,p,h),(E=f.match(i))&&parse_fonts(E,p,d,h),(E=f.match(n))&&parse_fills(E,p,d,h),(E=f.match(l))&&parse_borders(E,p,d,h),(E=f.match(t))&&parse_cellXfs(E,p,h),p}}();function parse_BrtFmt(e,r){var t=e.read_shift(2),n=parse_XLWideString(e);return[t,n]}function parse_BrtFont(e,r,t){var n={};n.sz=e.read_shift(2)/20;var i=parse_FontFlags(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var l=e.read_shift(2);switch(l===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var c=e.read_shift(1);c!=0&&(n.underline=c);var f=e.read_shift(1);f>0&&(n.family=f);var d=e.read_shift(1);switch(d>0&&(n.charset=d),e.l++,n.color=parse_BrtColor(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=parse_XLWideString(e),n}var parse_BrtFill=parsenoop;function parse_BrtXF(e,r){var t=e.l+r,n=e.read_shift(2),i=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:i}}var parse_BrtBorder=parsenoop;function parse_sty_bin(e,r,t){var n={};n.NumberFmt=[];for(var i in table_fmt)n.NumberFmt[i]=table_fmt[i];n.CellXf=[],n.Fonts=[];var l=[],c=!1;return recordhopper(e,function(d,h,p){switch(p){case 44:n.NumberFmt[d[0]]=d[1],SSF_load(d[1],d[0]);break;case 43:n.Fonts.push(d),d.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(d.color.rgb=rgb_tint(r.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&n.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:l.push(p),c=!0;break;case 38:l.pop(),c=!1;break;default:if(h.T>0)l.push(p);else if(h.T<0)l.pop();else if(!c||t.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),n}var XLSXThemeClrScheme=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function parse_clrScheme(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(tagregex)||[]).forEach(function(i){var l=parsexmltag(i);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=l.val;break;case"<a:sysClr":n.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(r.themeElements.clrScheme[XLSXThemeClrScheme.indexOf(l[0])]=n,n={}):n.name=l[0].slice(3,l[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function parse_fontScheme(){}function parse_fmtScheme(){}var clrsregex=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,fntsregex=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,fmtsregex=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function parse_themeElements(e,r,t){r.themeElements={};var n;[["clrScheme",clrsregex,parse_clrScheme],["fontScheme",fntsregex,parse_fontScheme],["fmtScheme",fmtsregex,parse_fmtScheme]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,r,t)})}var themeltregex=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function parse_theme_xml(e,r){(!e||e.length===0)&&(e=write_theme());var t,n={};if(!(t=e.match(themeltregex)))throw new Error("themeElements not found in theme");return parse_themeElements(t[0],n,r),n.raw=e,n}function write_theme(e,r){var t=[XML_HEADER];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function parse_Theme(e,r,t){var n=e.l+r,i=e.read_shift(4);if(i!==124226){if(!t.cellStyles){e.l=n;return}var l=e.slice(e.l);e.l=n;var c;try{c=zip_read(l,{type:"array"})}catch{return}var f=getzipstr(c,"theme/theme/theme1.xml",!0);if(f)return parse_theme_xml(f,t)}}function parse_ColorTheme(e){return e.read_shift(4)}function parse_FullColorExt(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=parse_IcvXF(e,4);break;case 2:r.xclrValue=parse_LongRGBA(e);break;case 3:r.xclrValue=parse_ColorTheme(e);break;case 4:e.l+=4;break}return e.l+=8,r}function parse_IcvXF(e,r){return parsenoop(e,r)}function parse_XFExtGradient(e,r){return parsenoop(e,r)}function parse_ExtProp(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=parse_FullColorExt(e);break;case 6:n[1]=parse_XFExtGradient(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function parse_XFExt(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),l=[];i-- >0;)l.push(parse_ExtProp(e,t-e.l));return{ixfe:n,ext:l}}function update_xfext(e,r){r.forEach(function(t){switch(t[0]){}})}function parse_BrtMdtinfo(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:parse_XLWideString(e)}}function parse_BrtMdb(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function parse_BrtBeginEsmdb(e){return e.l+=4,e.read_shift(4)!=0}function parse_xlmeta_bin(e,r,t){var n={Types:[],Cell:[],Value:[]},i=t||{},l=[],c=!1,f=2;return recordhopper(e,function(d,h,p){switch(p){case 335:n.Types.push({name:d.name});break;case 51:d.forEach(function(E){f==1?n.Cell.push({type:n.Types[E[0]-1].name,index:E[1]}):f==0&&n.Value.push({type:n.Types[E[0]-1].name,index:E[1]})});break;case 337:f=d?1:0;break;case 338:f=2;break;case 35:l.push(p),c=!0;break;case 36:l.pop(),c=!1;break;default:if(!h.T){if(!c||i.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),n}function parse_xlmeta_xml(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,l=2,c;return e.replace(tagregex,function(f){var d=parsexmltag(f);switch(strip_ns(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<n.Types.length;++h)n.Types[h].name==d.name&&(c=n.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?n.Cell.push({type:n.Types[d.t-1].name,index:+d.v}):l==0&&n.Value.push({type:n.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+d.i);break;default:if(!i&&t.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return f}),n}function parse_cc_xml(e){var r=[];if(!e)return r;var t=1;return(e.match(tagregex)||[]).forEach(function(n){var i=parsexmltag(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?t=i.i:i.i=t,r.push(i);break}}),r}function parse_BrtCalcChainItem$(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=encode_cell(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function parse_cc_bin(e,r,t){var n=[];return recordhopper(e,function(l,c,f){switch(f){case 63:n.push(l);break;default:if(!c.T)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function parse_xlink_xml(){}function parse_xlink_bin(e,r,t,n){if(!e)return e;var i=n||{},l=!1;recordhopper(e,function(f,d,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!d.T){if(!l||i.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},i)}function parse_drawing(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}function sheet_insert_comments(e,r,t,n){var i=Array.isArray(e),l;r.forEach(function(c){var f=decode_cell(c.ref);if(i?(e[f.r]||(e[f.r]=[]),l=e[f.r][f.c]):l=e[c.ref],!l){l={t:"z"},i?e[f.r][f.c]=l:e[c.ref]=l;var d=safe_decode_range(e["!ref"]||"BDWGO1000001:A1");d.s.r>f.r&&(d.s.r=f.r),d.e.r<f.r&&(d.e.r=f.r),d.s.c>f.c&&(d.s.c=f.c),d.e.c<f.c&&(d.e.c=f.c);var h=encode_range(d);h!==e["!ref"]&&(e["!ref"]=h)}l.c||(l.c=[]);var p={a:c.author,t:c.t,r:c.r,T:t};c.h&&(p.h=c.h);for(var E=l.c.length-1;E>=0;--E){if(!t&&l.c[E].T)return;t&&!l.c[E].T&&l.c.splice(E,1)}if(t&&n){for(E=0;E<n.length;++E)if(p.a==n[E].id){p.a=n[E].name||p.a;break}}l.c.push(p)})}function parse_comments_xml(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var f=c.match(/<(?:\w+:)?author[^>]*>(.*)/);f&&t.push(f[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var f=c.match(/<(?:\w+:)?comment[^>]*>/);if(f){var d=parsexmltag(f[0]),h={author:d.authorId&&t[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},p=decode_cell(d.ref);if(!(r.sheetRows&&r.sheetRows<=p.r)){var E=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!E&&!!E[1]&&parse_si(E[1])||{r:"",t:"",h:""};h.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),h.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(h.h=y.h),n.push(h)}}}}),n}function parse_tcmnt_xml(e,r){var t=[],n=!1,i={},l=0;return e.replace(tagregex,function(f,d){var h=parsexmltag(f);switch(strip_ns(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":i.t!=null&&t.push(i);break;case"<text>":case"<text":l=d+f.length;break;case"</text>":i.t=e.slice(l,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return f}),t}function parse_people_xml(e,r){var t=[],n=!1;return e.replace(tagregex,function(l){var c=parsexmltag(l);switch(strip_ns(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return l}),t}function parse_BrtBeginComment(e){var r={};r.iauthor=e.read_shift(4);var t=parse_UncheckedRfX(e);return r.rfx=t.s,r.ref=encode_cell(t.s),e.l+=16,r}var parse_BrtCommentAuthor=parse_XLWideString;function parse_comments_bin(e,r){var t=[],n=[],i={},l=!1;return recordhopper(e,function(f,d,h){switch(h){case 632:n.push(f);break;case 635:i=f;break;case 637:i.t=f.t,i.h=f.h,i.r=f.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,r.sheetRows&&i.rfx&&r.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,t.push(i);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!l||r.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),t}var CT_VBA="application/vnd.ms-office.vbaProject";function make_vba_xls(e){var r=CFB.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var i=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");CFB.utils.cfb_add(r,i,e.FileIndex[n].content)}}),CFB.write(r)}function parse_ds_bin(){return{"!type":"dialog"}}function parse_ds_xml(){return{"!type":"dialog"}}function parse_ms_bin(){return{"!type":"macro"}}function parse_ms_xml(){return{"!type":"macro"}}var rc_to_a1=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,i,l,c){var f=!1,d=!1;l.length==0?d=!0:l.charAt(0)=="["&&(d=!0,l=l.slice(1,-1)),c.length==0?f=!0:c.charAt(0)=="["&&(f=!0,c=c.slice(1,-1));var h=l.length>0?parseInt(l,10)|0:0,p=c.length>0?parseInt(c,10)|0:0;return f?p+=r.c:--p,d?h+=r.r:--h,i+(f?"":"$")+encode_col(p)+(d?"":"$")+encode_row(h)}return function(i,l){return r=l,i.replace(e,t)}}(),crefregex=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,a1_to_rc=function(){return function(r,t){return r.replace(crefregex,function(n,i,l,c,f,d){var h=decode_col(c)-(l?0:t.c),p=decode_row(d)-(f?0:t.r),E=p==0?"":f?p+1:"["+p+"]",y=h==0?"":l?h+1:"["+h+"]";return i+"R"+E+"C"+y})}}();function shift_formula_str(e,r){return e.replace(crefregex,function(t,n,i,l,c,f){return n+(i=="$"?i+l:encode_col(decode_col(l)+r.c))+(c=="$"?c+f:encode_row(decode_row(f)+r.r))})}function shift_formula_xlsx(e,r,t){var n=decode_range(r),i=n.s,l=decode_cell(t),c={r:l.r-i.r,c:l.c-i.c};return shift_formula_str(e,c)}function fuzzyfmla(e){return e.length!=1}function _xlfn(e){return e.replace(/_xlfn\./g,"")}function parseread1(e){e.l+=1}function parse_ColRelU(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function parse_RgceArea(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return parse_RgceArea_BIFF2(e);t.biff==12&&(n=4)}var i=e.read_shift(n),l=e.read_shift(n),c=parse_ColRelU(e),f=parse_ColRelU(e);return{s:{r:i,c:c[0],cRel:c[1],rRel:c[2]},e:{r:l,c:f[0],cRel:f[1],rRel:f[2]}}}function parse_RgceArea_BIFF2(e){var r=parse_ColRelU(e),t=parse_ColRelU(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function parse_RgceAreaRel(e,r,t){if(t.biff<8)return parse_RgceArea_BIFF2(e);var n=e.read_shift(t.biff==12?4:2),i=e.read_shift(t.biff==12?4:2),l=parse_ColRelU(e),c=parse_ColRelU(e);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function parse_RgceLoc(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return parse_RgceLoc_BIFF2(e);var n=e.read_shift(t&&t.biff==12?4:2),i=parse_ColRelU(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function parse_RgceLoc_BIFF2(e){var r=parse_ColRelU(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function parse_RgceElfLoc(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function parse_RgceLocRel(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return parse_RgceLocRel_BIFF2(e);var i=e.read_shift(n>=12?4:2),l=e.read_shift(2),c=(l&16384)>>14,f=(l&32768)>>15;if(l&=16383,f==1)for(;i>524287;)i-=1048576;if(c==1)for(;l>8191;)l=l-16384;return{r:i,c:l,cRel:c,rRel:f}}function parse_RgceLocRel_BIFF2(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,i=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),i==1&&t>=128&&(t=t-256),{r,c:t,cRel:i,rRel:n}}function parse_PtgArea(e,r,t){var n=(e[e.l++]&96)>>5,i=parse_RgceArea(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,i]}function parse_PtgArea3d(e,r,t){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),l=8;if(t)switch(t.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var c=parse_RgceArea(e,l,t);return[n,i,c]}function parse_PtgAreaErr(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function parse_PtgAreaErr3d(e,r,t){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),l=8;if(t)switch(t.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[n,i]}function parse_PtgAreaN(e,r,t){var n=(e[e.l++]&96)>>5,i=parse_RgceAreaRel(e,r-1,t);return[n,i]}function parse_PtgArray(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function parse_PtgAttrBaxcel(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function parse_PtgAttrChoose(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),i=[],l=0;l<=n;++l)i.push(e.read_shift(t&&t.biff==2?1:2));return i}function parse_PtgAttrGoto(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function parse_PtgAttrIf(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function parse_PtgAttrIfError(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function parse_PtgAttrSemi(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function parse_PtgAttrSpaceType(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function parse_PtgAttrSpace(e){return e.read_shift(2),parse_PtgAttrSpaceType(e)}function parse_PtgAttrSpaceSemi(e){return e.read_shift(2),parse_PtgAttrSpaceType(e)}function parse_PtgRef(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var i=parse_RgceLoc(e,0,t);return[n,i]}function parse_PtgRefN(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var i=parse_RgceLocRel(e,0,t);return[n,i]}function parse_PtgRef3d(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var l=parse_RgceLoc(e,0,t);return[n,i,l]}function parse_PtgFunc(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(t&&t.biff<=3?1:2);return[FtabArgc[i],Ftab[i],n]}function parse_PtgFuncVar(e,r,t){var n=e[e.l++],i=e.read_shift(1),l=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:parsetab(e);return[i,(l[0]===0?Ftab:Cetab)[l[1]]]}function parsetab(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function parse_PtgAttrSum(e,r,t){e.l+=t&&t.biff==2?3:4}function parse_PtgExp(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(t&&t.biff==2?1:2);return[n,i]}function parse_PtgErr(e){return e.l++,BErr[e.read_shift(1)]}function parse_PtgInt(e){return e.l++,e.read_shift(2)}function parse_PtgBool(e){return e.l++,e.read_shift(1)!==0}function parse_PtgNum(e){return e.l++,parse_Xnum(e)}function parse_PtgStr(e,r,t){return e.l++,parse_ShortXLUnicodeString(e,r-1,t)}function parse_SerAr(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=parsebool(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=BErr[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=parse_Xnum(e);break;case 2:t[1]=parse_XLUnicodeString2(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function parse_PtgExtraMem(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),i=[],l=0;l!=n;++l)i.push((t.biff==12?parse_UncheckedRfX:parse_Ref8U)(e));return i}function parse_PtgExtraArray(e,r,t){var n=0,i=0;t.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--i==0&&(i=256));for(var l=0,c=[];l!=n&&(c[l]=[]);++l)for(var f=0;f!=i;++f)c[l][f]=parse_SerAr(e,t.biff);return c}function parse_PtgName(e,r,t){var n=e.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,l=e.read_shift(i);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,l]}function parse_PtgNameX(e,r,t){if(t.biff==5)return parse_PtgNameX_BIFF5(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),l=e.read_shift(4);return[n,i,l]}function parse_PtgNameX_BIFF5(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function parse_PtgMemArea(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var i=e.read_shift(t&&t.biff==2?1:2);return[n,i]}function parse_PtgMemFunc(e,r,t){var n=e.read_shift(1)>>>5&3,i=e.read_shift(t&&t.biff==2?1:2);return[n,i]}function parse_PtgRefErr(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function parse_PtgRefErr3d(e,r,t){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),l=4;if(t)switch(t.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[n,i]}var parse_PtgMemErr=parsenoop,parse_PtgMemNoMem=parsenoop,parse_PtgTbl=parsenoop;function parse_PtgElfLoc(e,r,t){return e.l+=2,[parse_RgceElfLoc(e)]}function parse_PtgElfNoop(e){return e.l+=6,[]}var parse_PtgElfCol=parse_PtgElfLoc,parse_PtgElfColS=parse_PtgElfNoop,parse_PtgElfColSV=parse_PtgElfNoop,parse_PtgElfColV=parse_PtgElfLoc;function parse_PtgElfLel(e){return e.l+=2,[parseuint16(e),e.read_shift(2)&1]}var parse_PtgElfRadical=parse_PtgElfLoc,parse_PtgElfRadicalLel=parse_PtgElfLel,parse_PtgElfRadicalS=parse_PtgElfNoop,parse_PtgElfRw=parse_PtgElfLoc,parse_PtgElfRwV=parse_PtgElfLoc,PtgListRT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function parse_PtgList(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),l=e.read_shift(2),c=PtgListRT[t>>2&31];return{ixti:r,coltype:t&3,rt:c,idx:n,c:i,C:l}}function parse_PtgSxName(e){return e.l+=2,[e.read_shift(4)]}function parse_PtgSheet(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function parse_PtgEndSheet(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function parse_PtgMemAreaN(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function parse_PtgMemNoMemN(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function parse_PtgAttrNoop(e){return e.l+=4,[0,0]}var PtgTypes={1:{n:"PtgExp",f:parse_PtgExp},2:{n:"PtgTbl",f:parse_PtgTbl},3:{n:"PtgAdd",f:parseread1},4:{n:"PtgSub",f:parseread1},5:{n:"PtgMul",f:parseread1},6:{n:"PtgDiv",f:parseread1},7:{n:"PtgPower",f:parseread1},8:{n:"PtgConcat",f:parseread1},9:{n:"PtgLt",f:parseread1},10:{n:"PtgLe",f:parseread1},11:{n:"PtgEq",f:parseread1},12:{n:"PtgGe",f:parseread1},13:{n:"PtgGt",f:parseread1},14:{n:"PtgNe",f:parseread1},15:{n:"PtgIsect",f:parseread1},16:{n:"PtgUnion",f:parseread1},17:{n:"PtgRange",f:parseread1},18:{n:"PtgUplus",f:parseread1},19:{n:"PtgUminus",f:parseread1},20:{n:"PtgPercent",f:parseread1},21:{n:"PtgParen",f:parseread1},22:{n:"PtgMissArg",f:parseread1},23:{n:"PtgStr",f:parse_PtgStr},26:{n:"PtgSheet",f:parse_PtgSheet},27:{n:"PtgEndSheet",f:parse_PtgEndSheet},28:{n:"PtgErr",f:parse_PtgErr},29:{n:"PtgBool",f:parse_PtgBool},30:{n:"PtgInt",f:parse_PtgInt},31:{n:"PtgNum",f:parse_PtgNum},32:{n:"PtgArray",f:parse_PtgArray},33:{n:"PtgFunc",f:parse_PtgFunc},34:{n:"PtgFuncVar",f:parse_PtgFuncVar},35:{n:"PtgName",f:parse_PtgName},36:{n:"PtgRef",f:parse_PtgRef},37:{n:"PtgArea",f:parse_PtgArea},38:{n:"PtgMemArea",f:parse_PtgMemArea},39:{n:"PtgMemErr",f:parse_PtgMemErr},40:{n:"PtgMemNoMem",f:parse_PtgMemNoMem},41:{n:"PtgMemFunc",f:parse_PtgMemFunc},42:{n:"PtgRefErr",f:parse_PtgRefErr},43:{n:"PtgAreaErr",f:parse_PtgAreaErr},44:{n:"PtgRefN",f:parse_PtgRefN},45:{n:"PtgAreaN",f:parse_PtgAreaN},46:{n:"PtgMemAreaN",f:parse_PtgMemAreaN},47:{n:"PtgMemNoMemN",f:parse_PtgMemNoMemN},57:{n:"PtgNameX",f:parse_PtgNameX},58:{n:"PtgRef3d",f:parse_PtgRef3d},59:{n:"PtgArea3d",f:parse_PtgArea3d},60:{n:"PtgRefErr3d",f:parse_PtgRefErr3d},61:{n:"PtgAreaErr3d",f:parse_PtgAreaErr3d},255:{}},PtgDupes={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ptg18={1:{n:"PtgElfLel",f:parse_PtgElfLel},2:{n:"PtgElfRw",f:parse_PtgElfRw},3:{n:"PtgElfCol",f:parse_PtgElfCol},6:{n:"PtgElfRwV",f:parse_PtgElfRwV},7:{n:"PtgElfColV",f:parse_PtgElfColV},10:{n:"PtgElfRadical",f:parse_PtgElfRadical},11:{n:"PtgElfRadicalS",f:parse_PtgElfRadicalS},13:{n:"PtgElfColS",f:parse_PtgElfColS},15:{n:"PtgElfColSV",f:parse_PtgElfColSV},16:{n:"PtgElfRadicalLel",f:parse_PtgElfRadicalLel},25:{n:"PtgList",f:parse_PtgList},29:{n:"PtgSxName",f:parse_PtgSxName},255:{}},Ptg19={0:{n:"PtgAttrNoop",f:parse_PtgAttrNoop},1:{n:"PtgAttrSemi",f:parse_PtgAttrSemi},2:{n:"PtgAttrIf",f:parse_PtgAttrIf},4:{n:"PtgAttrChoose",f:parse_PtgAttrChoose},8:{n:"PtgAttrGoto",f:parse_PtgAttrGoto},16:{n:"PtgAttrSum",f:parse_PtgAttrSum},32:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},33:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},64:{n:"PtgAttrSpace",f:parse_PtgAttrSpace},65:{n:"PtgAttrSpaceSemi",f:parse_PtgAttrSpaceSemi},128:{n:"PtgAttrIfError",f:parse_PtgAttrIfError},255:{}};function parse_RgbExtra(e,r,t,n){if(n.biff<8)return parsenoop(e,r);for(var i=e.l+r,l=[],c=0;c!==t.length;++c)switch(t[c][0]){case"PtgArray":t[c][1]=parse_PtgExtraArray(e,0,n),l.push(t[c][1]);break;case"PtgMemArea":t[c][2]=parse_PtgExtraMem(e,t[c][1],n),l.push(t[c][2]);break;case"PtgExp":n&&n.biff==12&&(t[c][1][1]=e.read_shift(4),l.push(t[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[c][0]}return r=i-e.l,r!==0&&l.push(parsenoop(e,r)),l}function parse_Rgce(e,r,t){for(var n=e.l+r,i,l,c=[];n!=e.l;)r=n-e.l,l=e[e.l],i=PtgTypes[l]||PtgTypes[PtgDupes[l]],(l===24||l===25)&&(i=(l===24?Ptg18:Ptg19)[e[e.l+1]]),!i||!i.f?parsenoop(e,r):c.push([i.n,i.f(e,r,t)]);return c}function stringify_array(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],i=[],l=0;l<n.length;++l){var c=n[l];if(c)switch(c[0]){case 2:i.push('"'+c[1].replace(/"/g,'""')+'"');break;default:i.push(c[1])}else i.push("")}r.push(i.join(","))}return r.join(";")}var PtgBinOp={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function formula_quote_sheet_name(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function get_ixti_raw(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var i="";if(t.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function get_ixti(e,r,t){var n=get_ixti_raw(e,r,t);return n=="#REF"?n:formula_quote_sheet_name(n,t)}function stringify_formula(e,r,t,n,i){var l=i&&i.biff||8,c={s:{c:0,r:0},e:{c:0,r:0}},f=[],d,h,p,E=0,y=0,S,x="";if(!e[0]||!e[0][0])return"";for(var g=-1,m="",A=0,O=e[0].length;A<O;++A){var C=e[0][A];switch(C[0]){case"PtgUminus":f.push("-"+f.pop());break;case"PtgUplus":f.push("+"+f.pop());break;case"PtgPercent":f.push(f.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=f.pop(),h=f.pop(),g>=0){switch(e[0][g][1][0]){case 0:m=fill(" ",e[0][g][1][1]);break;case 1:m=fill("\r",e[0][g][1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}h=h+m,g=-1}f.push(h+PtgBinOp[C[0]]+d);break;case"PtgIsect":d=f.pop(),h=f.pop(),f.push(h+" "+d);break;case"PtgUnion":d=f.pop(),h=f.pop(),f.push(h+","+d);break;case"PtgRange":d=f.pop(),h=f.pop(),f.push(h+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=shift_cell_xls(C[1][1],c,i),f.push(encode_cell_xls(p,l));break;case"PtgRefN":p=t?shift_cell_xls(C[1][1],t,i):C[1][1],f.push(encode_cell_xls(p,l));break;case"PtgRef3d":E=C[1][1],p=shift_cell_xls(C[1][2],c,i),x=get_ixti(n,E,i),f.push(x+"!"+encode_cell_xls(p,l));break;case"PtgFunc":case"PtgFuncVar":var R=C[1][0],T=C[1][1];R||(R=0),R&=127;var w=R==0?[]:f.slice(-R);f.length-=R,T==="User"&&(T=w.shift()),f.push(T+"("+w.join(",")+")");break;case"PtgBool":f.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":f.push(C[1]);break;case"PtgNum":f.push(String(C[1]));break;case"PtgStr":f.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":f.push(C[1]);break;case"PtgAreaN":S=shift_range_xls(C[1][1],t?{s:t}:c,i),f.push(encode_range_xls(S,i));break;case"PtgArea":S=shift_range_xls(C[1][1],c,i),f.push(encode_range_xls(S,i));break;case"PtgArea3d":E=C[1][1],S=C[1][2],x=get_ixti(n,E,i),f.push(x+"!"+encode_range_xls(S,i));break;case"PtgAttrSum":f.push("SUM("+f.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=C[1][2];var v=(n.names||[])[y-1]||(n[0]||[])[y],L=v?v.Name:"SH33TJSNAME"+String(y);L&&L.slice(0,6)=="_xlfn."&&!i.xlfn&&(L=L.slice(6)),f.push(L);break;case"PtgNameX":var M=C[1][1];y=C[1][2];var X;if(i.biff<=5)M<0&&(M=-M),n[M]&&(X=n[M][y]);else{var H="";if(((n[M]||[])[0]||[])[0]==14849||(((n[M]||[])[0]||[])[0]==1025?n[M][y]&&n[M][y].itab>0&&(H=n.SheetNames[n[M][y].itab-1]+"!"):H=n.SheetNames[y-1]+"!"),n[M]&&n[M][y])H+=n[M][y].Name;else if(n[0]&&n[0][y])H+=n[0][y].Name;else{var ne=(get_ixti_raw(n,M,i)||"").split(";;");ne[y-1]?H=ne[y-1]:H+="SH33TJSERRX"}f.push(H);break}X||(X={Name:"SH33TJSERRY"}),f.push(X.Name);break;case"PtgParen":var _e="(",ge=")";if(g>=0){switch(m="",e[0][g][1][0]){case 2:_e=fill(" ",e[0][g][1][1])+_e;break;case 3:_e=fill("\r",e[0][g][1][1])+_e;break;case 4:ge=fill(" ",e[0][g][1][1])+ge;break;case 5:ge=fill("\r",e[0][g][1][1])+ge;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}f.push(_e+f.pop()+ge);break;case"PtgRefErr":f.push("#REF!");break;case"PtgRefErr3d":f.push("#REF!");break;case"PtgExp":p={c:C[1][1],r:C[1][0]};var he={c:t.c,r:t.r};if(n.sharedf[encode_cell(p)]){var W=n.sharedf[encode_cell(p)];f.push(stringify_formula(W,c,he,n,i))}else{var se=!1;for(d=0;d!=n.arrayf.length;++d)if(h=n.arrayf[d],!(p.c<h[0].s.c||p.c>h[0].e.c)&&!(p.r<h[0].s.r||p.r>h[0].e.r)){f.push(stringify_formula(h[1],c,he,n,i)),se=!0;break}se||f.push(C[1])}break;case"PtgArray":f.push("{"+stringify_array(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":f.push("");break;case"PtgAreaErr":f.push("#REF!");break;case"PtgAreaErr3d":f.push("#REF!");break;case"PtgList":f.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var ue=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&ue.indexOf(e[0][A][0])==-1){C=e[0][g];var re=!0;switch(C[1][0]){case 4:re=!1;case 0:m=fill(" ",C[1][1]);break;case 5:re=!1;case 1:m=fill("\r",C[1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}f.push((re?m:"")+f.pop()+(re?"":m)),g=-1}}if(f.length>1&&i.WTF)throw new Error("bad formula stack");return f[0]}function parse_ArrayParsedFormula(e,r,t){var n=e.l+r,i=t.biff==2?1:2,l,c=e.read_shift(i);if(c==65535)return[[],parsenoop(e,r-2)];var f=parse_Rgce(e,c,t);return r!==c+i&&(l=parse_RgbExtra(e,r-c-i,f,t)),e.l=n,[f,l]}function parse_XLSCellParsedFormula(e,r,t){var n=e.l+r,i=t.biff==2?1:2,l,c=e.read_shift(i);if(c==65535)return[[],parsenoop(e,r-2)];var f=parse_Rgce(e,c,t);return r!==c+i&&(l=parse_RgbExtra(e,r-c-i,f,t)),e.l=n,[f,l]}function parse_NameParsedFormula(e,r,t,n){var i=e.l+r,l=parse_Rgce(e,n,t),c;return i!==e.l&&(c=parse_RgbExtra(e,i-e.l,l,t)),[l,c]}function parse_SharedParsedFormula(e,r,t){var n=e.l+r,i,l=e.read_shift(2),c=parse_Rgce(e,l,t);return l==65535?[[],parsenoop(e,r-2)]:(r!==l+2&&(i=parse_RgbExtra(e,n-l-2,c,t)),[c,i])}function parse_FormulaValue(e){var r;if(__readUInt16LE(e,e.l+6)!==65535)return[parse_Xnum(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function parse_Formula(e,r,t){var n=e.l+r,i=parse_XLSCell(e);t.biff==2&&++e.l;var l=parse_FormulaValue(e),c=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var f=parse_XLSCellParsedFormula(e,n-e.l,t);return{cell:i,val:l[0],formula:f,shared:c>>3&1,tt:l[1]}}function parse_XLSBParsedFormula(e,r,t){var n=e.read_shift(4),i=parse_Rgce(e,n,t),l=e.read_shift(4),c=l>0?parse_RgbExtra(e,l,i,t):null;return[i,c]}var parse_XLSBArrayParsedFormula=parse_XLSBParsedFormula,parse_XLSBCellParsedFormula=parse_XLSBParsedFormula,parse_XLSBNameParsedFormula=parse_XLSBParsedFormula,parse_XLSBSharedParsedFormula=parse_XLSBParsedFormula,Cetab={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ftab={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FtabArgc={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ods_to_csf_formula(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function ods_to_csf_3D(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var strs={},_ssfopts={};function default_margins(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function safe_format(e,r,t,n,i,l){try{n.cellNF&&(e.z=table_fmt[r])}catch(f){if(n.WTF)throw f}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=parseDate(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(table_fmt[r]==null&&SSF_load(SSFImplicit[r]||"General",r),e.t==="e")e.w=e.w||BErr[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v);else if(e.t==="d"){var c=datenum(e.v);(c|0)===c?e.w=c.toString(10):e.w=SSF_general_num(c)}else{if(e.v===void 0)return"";e.w=SSF_general(e.v,_ssfopts)}else e.t==="d"?e.w=SSF_format(r,datenum(e.v),_ssfopts):e.w=SSF_format(r,e.v,_ssfopts)}catch(f){if(n.WTF)throw f}if(n.cellStyles&&t!=null)try{e.s=l.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=rgb_tint(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=rgb_tint(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(f){if(n.WTF&&l.Fills)throw f}}}function parse_ws_xml_dim(e,r){var t=safe_decode_range(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=encode_range(t))}var mergecregex=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sheetdataregex=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hlinkregex=/<(?:\w:)?hyperlink [^>]*>/mg,dimregex=/"(\w*:\w*)"/,colregex=/<(?:\w:)?col\b[^>]*[\/]?>/g,afregex=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,marginregex=/<(?:\w:)?pageMargins[^>]*\/>/g,sheetprregex=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,sheetprregex2=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,svsregex=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function parse_ws_xml(e,r,t,n,i,l,c){if(!e)return e;n||(n={"!id":{}});var f=r.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",p="",E=e.match(sheetdataregex);E?(h=e.slice(0,E.index),p=e.slice(E.index+E[0].length)):h=p=e;var y=h.match(sheetprregex);y?parse_ws_xml_sheetpr(y[0],f,i,t):(y=h.match(sheetprregex2))&&parse_ws_xml_sheetpr2(y[0],y[1]||"",f,i,t);var S=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(S>0){var x=h.slice(S,S+50).match(dimregex);x&&parse_ws_xml_dim(f,x[1])}var g=h.match(svsregex);g&&g[1]&&parse_ws_xml_sheetviews(g[1],i);var m=[];if(r.cellStyles){var A=h.match(colregex);A&&parse_ws_xml_cols(m,A)}E&&parse_ws_xml_data(E[1],f,r,d,l,c);var O=p.match(afregex);O&&(f["!autofilter"]=parse_ws_xml_autofilter(O[0]));var C=[],R=p.match(mergecregex);if(R)for(S=0;S!=R.length;++S)C[S]=safe_decode_range(R[S].slice(R[S].indexOf('"')+1));var T=p.match(hlinkregex);T&&parse_ws_xml_hlinks(f,T,n);var w=p.match(marginregex);if(w&&(f["!margins"]=parse_ws_xml_margins(parsexmltag(w[0]))),!f["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(f["!ref"]=encode_range(d)),r.sheetRows>0&&f["!ref"]){var v=safe_decode_range(f["!ref"]);r.sheetRows<=+v.e.r&&(v.e.r=r.sheetRows-1,v.e.r>d.e.r&&(v.e.r=d.e.r),v.e.r<v.s.r&&(v.s.r=v.e.r),v.e.c>d.e.c&&(v.e.c=d.e.c),v.e.c<v.s.c&&(v.s.c=v.e.c),f["!fullref"]=f["!ref"],f["!ref"]=encode_range(v))}return m.length>0&&(f["!cols"]=m),C.length>0&&(f["!merges"]=C),f}function parse_ws_xml_sheetpr(e,r,t,n){var i=parsexmltag(e);t.Sheets[n]||(t.Sheets[n]={}),i.codeName&&(t.Sheets[n].CodeName=unescapexml(utf8read(i.codeName)))}function parse_ws_xml_sheetpr2(e,r,t,n,i){parse_ws_xml_sheetpr(e.slice(0,e.indexOf(">")),t,n,i)}function parse_ws_xml_hlinks(e,r,t){for(var n=Array.isArray(e),i=0;i!=r.length;++i){var l=parsexmltag(utf8read(r[i]),!0);if(!l.ref)return;var c=((t||{})["!id"]||[])[l.id];c?(l.Target=c.Target,l.location&&(l.Target+="#"+unescapexml(l.location))):(l.Target="#"+unescapexml(l.location),c={Target:l.Target,TargetMode:"Internal"}),l.Rel=c,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var f=safe_decode_range(l.ref),d=f.s.r;d<=f.e.r;++d)for(var h=f.s.c;h<=f.e.c;++h){var p=encode_cell({c:h,r:d});n?(e[d]||(e[d]=[]),e[d][h]||(e[d][h]={t:"z",v:void 0}),e[d][h].l=l):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=l)}}}function parse_ws_xml_margins(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function parse_ws_xml_cols(e,r){for(var t=!1,n=0;n!=r.length;++n){var i=parsexmltag(r[n],!0);i.hidden&&(i.hidden=parsexmlbool(i.hidden));var l=parseInt(i.min,10)-1,c=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!t&&i.width&&(t=!0,find_mdw_colw(i.width)),process_col(i);l<=c;)e[l++]=dup(i)}}function parse_ws_xml_autofilter(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var sviewregex=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function parse_ws_xml_sheetviews(e,r){r.Views||(r.Views=[{}]),(e.match(sviewregex)||[]).forEach(function(t,n){var i=parsexmltag(t);r.Views[n]||(r.Views[n]={}),+i.zoomScale&&(r.Views[n].zoom=+i.zoomScale),parsexmlbool(i.rightToLeft)&&(r.Views[n].RTL=!0)})}var parse_ws_xml_data=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,l=matchtag("v"),c=matchtag("f");return function(d,h,p,E,y,S){for(var x=0,g="",m=[],A=[],O=0,C=0,R=0,T="",w,v,L=0,M=0,X,H,ne=0,_e=0,ge=Array.isArray(S.CellXf),he,W=[],se=[],ue=Array.isArray(h),re=[],q={},me=!1,N=!!p.sheetStubs,P=d.split(r),k=0,B=P.length;k!=B;++k){g=P[k].trim();var z=g.length;if(z!==0){var Q=0;e:for(x=0;x<z;++x)switch(g[x]){case">":if(g[x-1]!="/"){++x;break e}if(p&&p.cellStyles){if(v=parsexmltag(g.slice(Q,x),!0),L=v.r!=null?parseInt(v.r,10):L+1,M=-1,p.sheetRows&&p.sheetRows<L)continue;q={},me=!1,v.ht&&(me=!0,q.hpt=parseFloat(v.ht),q.hpx=pt2px(q.hpt)),v.hidden=="1"&&(me=!0,q.hidden=!0),v.outlineLevel!=null&&(me=!0,q.level=+v.outlineLevel),me&&(re[L-1]=q)}break;case"<":Q=x;break}if(Q>=x)break;if(v=parsexmltag(g.slice(Q,x),!0),L=v.r!=null?parseInt(v.r,10):L+1,M=-1,!(p.sheetRows&&p.sheetRows<L)){E.s.r>L-1&&(E.s.r=L-1),E.e.r<L-1&&(E.e.r=L-1),p&&p.cellStyles&&(q={},me=!1,v.ht&&(me=!0,q.hpt=parseFloat(v.ht),q.hpx=pt2px(q.hpt)),v.hidden=="1"&&(me=!0,q.hidden=!0),v.outlineLevel!=null&&(me=!0,q.level=+v.outlineLevel),me&&(re[L-1]=q)),m=g.slice(x).split(e);for(var K=0;K!=m.length&&m[K].trim().charAt(0)=="<";++K);for(m=m.slice(K),x=0;x!=m.length;++x)if(g=m[x].trim(),g.length!==0){if(A=g.match(t),O=x,C=0,R=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,A!=null&&A.length===2){for(O=0,T=A[1],C=0;C!=T.length&&!((R=T.charCodeAt(C)-64)<1||R>26);++C)O=26*O+R;--O,M=O}else++M;for(C=0;C!=g.length&&g.charCodeAt(C)!==62;++C);if(++C,v=parsexmltag(g.slice(0,C),!0),v.r||(v.r=encode_cell({r:L-1,c:M})),T=g.slice(C),w={t:""},(A=T.match(l))!=null&&A[1]!==""&&(w.v=unescapexml(A[1])),p.cellFormula){if((A=T.match(c))!=null&&A[1]!==""){if(w.f=unescapexml(utf8read(A[1])).replace(/\r\n/g,`
`),p.xlfn||(w.f=_xlfn(w.f)),A[0].indexOf('t="array"')>-1)w.F=(T.match(i)||[])[1],w.F.indexOf(":")>-1&&W.push([safe_decode_range(w.F),w.F]);else if(A[0].indexOf('t="shared"')>-1){H=parsexmltag(A[0]);var F=unescapexml(utf8read(A[1]));p.xlfn||(F=_xlfn(F)),se[parseInt(H.si,10)]=[H,F,v.r]}}else(A=T.match(/<f[^>]*\/>/))&&(H=parsexmltag(A[0]),se[H.si]&&(w.f=shift_formula_xlsx(se[H.si][1],se[H.si][2],v.r)));var I=decode_cell(v.r);for(C=0;C<W.length;++C)I.r>=W[C][0].s.r&&I.r<=W[C][0].e.r&&I.c>=W[C][0].s.c&&I.c<=W[C][0].e.c&&(w.F=W[C][1])}if(v.t==null&&w.v===void 0)if(w.f||w.F)w.v=0,w.t="n";else if(N)w.t="z";else continue;else w.t=v.t||"n";switch(E.s.c>M&&(E.s.c=M),E.e.c<M&&(E.e.c=M),w.t){case"n":if(w.v==""||w.v==null){if(!N)continue;w.t="z"}else w.v=parseFloat(w.v);break;case"s":if(typeof w.v>"u"){if(!N)continue;w.t="z"}else X=strs[parseInt(w.v,10)],w.v=X.t,w.r=X.r,p.cellHTML&&(w.h=X.h);break;case"str":w.t="s",w.v=w.v!=null?utf8read(w.v):"",p.cellHTML&&(w.h=escapehtml(w.v));break;case"inlineStr":A=T.match(n),w.t="s",A!=null&&(X=parse_si(A[1]))?(w.v=X.t,p.cellHTML&&(w.h=X.h)):w.v="";break;case"b":w.v=parsexmlbool(w.v);break;case"d":p.cellDates?w.v=parseDate(w.v,1):(w.v=datenum(parseDate(w.v,1)),w.t="n");break;case"e":(!p||p.cellText!==!1)&&(w.w=w.v),w.v=RBErr[w.v];break}if(ne=_e=0,he=null,ge&&v.s!==void 0&&(he=S.CellXf[v.s],he!=null&&(he.numFmtId!=null&&(ne=he.numFmtId),p.cellStyles&&he.fillId!=null&&(_e=he.fillId))),safe_format(w,ne,_e,p,y,S),p.cellDates&&ge&&w.t=="n"&&fmt_is_date(table_fmt[ne])&&(w.t="d",w.v=numdate(w.v)),v.cm&&p.xlmeta){var V=(p.xlmeta.Cell||[])[+v.cm-1];V&&V.type=="XLDAPR"&&(w.D=!0)}if(ue){var D=decode_cell(v.r);h[D.r]||(h[D.r]=[]),h[D.r][D.c]=w}else h[v.r]=w}}}}re.length>0&&(h["!rows"]=re)}}();function parse_BrtRowHdr(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=n,l&7&&(t.level=l&7),l&16&&(t.hidden=!0),l&32&&(t.hpt=i/20),t}var parse_BrtWsDim=parse_UncheckedRfX;function parse_BrtWsFmtInfo(){}function parse_BrtWsProp(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=parse_XLSBCodeName(e),t}function parse_BrtCellBlank(e){var r=parse_XLSBCell(e);return[r]}function parse_BrtShortBlank(e){var r=parse_XLSBShortCell(e);return[r]}function parse_BrtCellBool(e){var r=parse_XLSBCell(e),t=e.read_shift(1);return[r,t,"b"]}function parse_BrtShortBool(e){var r=parse_XLSBShortCell(e),t=e.read_shift(1);return[r,t,"b"]}function parse_BrtCellError(e){var r=parse_XLSBCell(e),t=e.read_shift(1);return[r,t,"e"]}function parse_BrtShortError(e){var r=parse_XLSBShortCell(e),t=e.read_shift(1);return[r,t,"e"]}function parse_BrtCellIsst(e){var r=parse_XLSBCell(e),t=e.read_shift(4);return[r,t,"s"]}function parse_BrtShortIsst(e){var r=parse_XLSBShortCell(e),t=e.read_shift(4);return[r,t,"s"]}function parse_BrtCellReal(e){var r=parse_XLSBCell(e),t=parse_Xnum(e);return[r,t,"n"]}function parse_BrtShortReal(e){var r=parse_XLSBShortCell(e),t=parse_Xnum(e);return[r,t,"n"]}function parse_BrtCellRk(e){var r=parse_XLSBCell(e),t=parse_RkNumber(e);return[r,t,"n"]}function parse_BrtShortRk(e){var r=parse_XLSBShortCell(e),t=parse_RkNumber(e);return[r,t,"n"]}function parse_BrtCellRString(e){var r=parse_XLSBCell(e),t=parse_RichStr(e);return[r,t,"is"]}function parse_BrtCellSt(e){var r=parse_XLSBCell(e),t=parse_XLWideString(e);return[r,t,"str"]}function parse_BrtShortSt(e){var r=parse_XLSBShortCell(e),t=parse_XLWideString(e);return[r,t,"str"]}function parse_BrtFmlaBool(e,r,t){var n=e.l+r,i=parse_XLSBCell(e);i.r=t["!row"];var l=e.read_shift(1),c=[i,l,"b"];if(t.cellFormula){e.l+=2;var f=parse_XLSBCellParsedFormula(e,n-e.l,t);c[3]=stringify_formula(f,null,i,t.supbooks,t)}else e.l=n;return c}function parse_BrtFmlaError(e,r,t){var n=e.l+r,i=parse_XLSBCell(e);i.r=t["!row"];var l=e.read_shift(1),c=[i,l,"e"];if(t.cellFormula){e.l+=2;var f=parse_XLSBCellParsedFormula(e,n-e.l,t);c[3]=stringify_formula(f,null,i,t.supbooks,t)}else e.l=n;return c}function parse_BrtFmlaNum(e,r,t){var n=e.l+r,i=parse_XLSBCell(e);i.r=t["!row"];var l=parse_Xnum(e),c=[i,l,"n"];if(t.cellFormula){e.l+=2;var f=parse_XLSBCellParsedFormula(e,n-e.l,t);c[3]=stringify_formula(f,null,i,t.supbooks,t)}else e.l=n;return c}function parse_BrtFmlaString(e,r,t){var n=e.l+r,i=parse_XLSBCell(e);i.r=t["!row"];var l=parse_XLWideString(e),c=[i,l,"str"];if(t.cellFormula){e.l+=2;var f=parse_XLSBCellParsedFormula(e,n-e.l,t);c[3]=stringify_formula(f,null,i,t.supbooks,t)}else e.l=n;return c}var parse_BrtMergeCell=parse_UncheckedRfX;function parse_BrtHLink(e,r){var t=e.l+r,n=parse_UncheckedRfX(e),i=parse_XLNullableWideString(e),l=parse_XLWideString(e),c=parse_XLWideString(e),f=parse_XLWideString(e);e.l=t;var d={rfx:n,relId:i,loc:l,display:f};return c&&(d.Tooltip=c),d}function parse_BrtPane(){}function parse_BrtArrFmla(e,r,t){var n=e.l+r,i=parse_RfX(e),l=e.read_shift(1),c=[i];if(c[2]=l,t.cellFormula){var f=parse_XLSBArrayParsedFormula(e,n-e.l,t);c[1]=f}else e.l=n;return c}function parse_BrtShrFmla(e,r,t){var n=e.l+r,i=parse_UncheckedRfX(e),l=[i];if(t.cellFormula){var c=parse_XLSBSharedParsedFormula(e,n-e.l,t);l[1]=c,e.l=n}else e.l=n;return l}var BrtMarginKeys=["left","right","top","bottom","header","footer"];function parse_BrtMargins(e){var r={};return BrtMarginKeys.forEach(function(t){r[t]=parse_Xnum(e)}),r}function parse_BrtBeginWsView(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function parse_BrtDVal(){}function parse_BrtDVal14(){}function parse_ws_bin(e,r,t,n,i,l,c){if(!e)return e;var f=r||{};n||(n={"!id":{}});var d=f.dense?[]:{},h,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=!1,y=!1,S,x,g,m,A,O,C,R,T,w=[];f.biff=12,f["!row"]=0;var v=0,L=!1,M=[],X={},H=f.supbooks||i.supbooks||[[]];if(H.sharedf=X,H.arrayf=M,H.SheetNames=i.SheetNames||i.Sheets.map(function(ue){return ue.name}),!f.supbooks&&(f.supbooks=H,i.Names))for(var ne=0;ne<i.Names.length;++ne)H[0][ne+1]=i.Names[ne];var _e=[],ge=[],he=!1;XLSBRecordEnum[16]={n:"BrtShortReal",f:parse_BrtShortReal};var W;if(recordhopper(e,function(re,q,me){if(!y)switch(me){case 148:h=re;break;case 0:S=re,f.sheetRows&&f.sheetRows<=S.r&&(y=!0),R=encode_row(m=S.r),f["!row"]=S.r,(re.hidden||re.hpt||re.level!=null)&&(re.hpt&&(re.hpx=pt2px(re.hpt)),ge[re.r]=re);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:re[2]},re[2]){case"n":x.v=re[1];break;case"s":C=strs[re[1]],x.v=C.t,x.r=C.r;break;case"b":x.v=!!re[1];break;case"e":x.v=re[1],f.cellText!==!1&&(x.w=BErr[x.v]);break;case"str":x.t="s",x.v=re[1];break;case"is":x.t="s",x.v=re[1].t;break}if((g=c.CellXf[re[0].iStyleRef])&&safe_format(x,g.numFmtId,null,f,l,c),A=re[0].c==-1?A+1:re[0].c,f.dense?(d[m]||(d[m]=[]),d[m][A]=x):d[encode_col(A)+R]=x,f.cellFormula){for(L=!1,v=0;v<M.length;++v){var N=M[v];S.r>=N[0].s.r&&S.r<=N[0].e.r&&A>=N[0].s.c&&A<=N[0].e.c&&(x.F=encode_range(N[0]),L=!0)}!L&&re.length>3&&(x.f=re[3])}if(p.s.r>S.r&&(p.s.r=S.r),p.s.c>A&&(p.s.c=A),p.e.r<S.r&&(p.e.r=S.r),p.e.c<A&&(p.e.c=A),f.cellDates&&g&&x.t=="n"&&fmt_is_date(table_fmt[g.numFmtId])){var P=SSF_parse_date_code(x.v);P&&(x.t="d",x.v=new Date(P.y,P.m-1,P.d,P.H,P.M,P.S,P.u))}W&&(W.type=="XLDAPR"&&(x.D=!0),W=void 0);break;case 1:case 12:if(!f.sheetStubs||E)break;x={t:"z",v:void 0},A=re[0].c==-1?A+1:re[0].c,f.dense?(d[m]||(d[m]=[]),d[m][A]=x):d[encode_col(A)+R]=x,p.s.r>S.r&&(p.s.r=S.r),p.s.c>A&&(p.s.c=A),p.e.r<S.r&&(p.e.r=S.r),p.e.c<A&&(p.e.c=A),W&&(W.type=="XLDAPR"&&(x.D=!0),W=void 0);break;case 176:w.push(re);break;case 49:W=((f.xlmeta||{}).Cell||[])[re-1];break;case 494:var k=n["!id"][re.relId];for(k?(re.Target=k.Target,re.loc&&(re.Target+="#"+re.loc),re.Rel=k):re.relId==""&&(re.Target="#"+re.loc),m=re.rfx.s.r;m<=re.rfx.e.r;++m)for(A=re.rfx.s.c;A<=re.rfx.e.c;++A)f.dense?(d[m]||(d[m]=[]),d[m][A]||(d[m][A]={t:"z",v:void 0}),d[m][A].l=re):(O=encode_cell({c:A,r:m}),d[O]||(d[O]={t:"z",v:void 0}),d[O].l=re);break;case 426:if(!f.cellFormula)break;M.push(re),T=f.dense?d[m][A]:d[encode_col(A)+R],T.f=stringify_formula(re[1],p,{r:S.r,c:A},H,f),T.F=encode_range(re[0]);break;case 427:if(!f.cellFormula)break;X[encode_cell(re[0].s)]=re[1],T=f.dense?d[m][A]:d[encode_col(A)+R],T.f=stringify_formula(re[1],p,{r:S.r,c:A},H,f);break;case 60:if(!f.cellStyles)break;for(;re.e>=re.s;)_e[re.e--]={width:re.w/256,hidden:!!(re.flags&1),level:re.level},he||(he=!0,find_mdw_colw(re.w/256)),process_col(_e[re.e+1]);break;case 161:d["!autofilter"]={ref:encode_range(re)};break;case 476:d["!margins"]=re;break;case 147:i.Sheets[t]||(i.Sheets[t]={}),re.name&&(i.Sheets[t].CodeName=re.name),(re.above||re.left)&&(d["!outline"]={above:re.above,left:re.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),re.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:E=!0;break;case 36:E=!1;break;case 37:E=!0;break;case 38:E=!1;break;default:if(!q.T){if(!E||f.WTF)throw new Error("Unexpected record 0x"+me.toString(16))}}},f),delete f.supbooks,delete f["!row"],!d["!ref"]&&(p.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(d["!ref"]=encode_range(h||p)),f.sheetRows&&d["!ref"]){var se=safe_decode_range(d["!ref"]);f.sheetRows<=+se.e.r&&(se.e.r=f.sheetRows-1,se.e.r>p.e.r&&(se.e.r=p.e.r),se.e.r<se.s.r&&(se.s.r=se.e.r),se.e.c>p.e.c&&(se.e.c=p.e.c),se.e.c<se.s.c&&(se.s.c=se.e.c),d["!fullref"]=d["!ref"],d["!ref"]=encode_range(se))}return w.length>0&&(d["!merges"]=w),_e.length>0&&(d["!cols"]=_e),ge.length>0&&(d["!rows"]=ge),d}function parse_Cache(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var c=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(r[+c[1]]=t?+c[2]:c[2])});var i=unescapexml((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){n=l.replace(/<.*?>/g,"")}),[r,i,n]}function parse_chart(e,r,t,n,i,l){var c=l||{"!type":"chart"};if(!e)return l;var f=0,d=0,h="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(E){var y=parse_Cache(E);p.s.r=p.s.c=0,p.e.c=f,h=encode_col(f),y[0].forEach(function(S,x){c[h+encode_row(x)]={t:"n",v:S,z:y[1]},d=x}),p.e.r<d&&(p.e.r=d),++f}),f>0&&(c["!ref"]=encode_range(p)),c}function parse_cs_xml(e,r,t,n,i){if(!e)return e;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c,f=e.match(sheetprregex);return f&&parse_ws_xml_sheetpr(f[0],l,i,t),(c=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=c[1]),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}function parse_BrtCsProp(e,r){e.l+=10;var t=parse_XLWideString(e);return{name:t}}function parse_cs_bin(e,r,t,n,i){if(!e)return e;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c=!1;return recordhopper(e,function(d,h,p){switch(p){case 550:l["!rel"]=d;break;case 651:i.Sheets[t]||(i.Sheets[t]={}),d.name&&(i.Sheets[t].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!c||r.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},r),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}var WBPropsDef=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],WBViewDef=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],SheetDef=[],CalcPrDef=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function push_defaults_array(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],i=0;i!=r.length;++i){var l=r[i];if(n[l[0]]==null)n[l[0]]=l[1];else switch(l[2]){case"bool":typeof n[l[0]]=="string"&&(n[l[0]]=parsexmlbool(n[l[0]]));break;case"int":typeof n[l[0]]=="string"&&(n[l[0]]=parseInt(n[l[0]],10));break}}}function push_defaults(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=parsexmlbool(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function parse_wb_defaults(e){push_defaults(e.WBProps,WBPropsDef),push_defaults(e.CalcPr,CalcPrDef),push_defaults_array(e.WBView,WBViewDef),push_defaults_array(e.Sheets,SheetDef),_ssfopts.date1904=parsexmlbool(e.WBProps.date1904)}var badchars="][*?/\\".split("");function check_ws_name(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return badchars.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var wbnsregex=/<\w+:workbook/;function parse_wb_xml(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",l={},c=0;if(e.replace(tagregex,function(d,h){var p=parsexmltag(d);switch(strip_ns(p[0])){case"<?xml":break;case"<workbook":d.match(wbnsregex)&&(i="xmlns"+d.match(/<(\w+):/)[1]),t.xmlns=p[i];break;case"</workbook>":break;case"<fileVersion":delete p[0],t.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":WBPropsDef.forEach(function(E){if(p[E[0]]!=null)switch(E[2]){case"bool":t.WBProps[E[0]]=parsexmlbool(p[E[0]]);break;case"int":t.WBProps[E[0]]=parseInt(p[E[0]],10);break;default:t.WBProps[E[0]]=p[E[0]]}}),p.codeName&&(t.WBProps.CodeName=utf8read(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],t.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=unescapexml(utf8read(p.name)),delete p[0],t.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":l={},l.Name=utf8read(p.name),p.comment&&(l.Comment=p.comment),p.localSheetId&&(l.Sheet=+p.localSheetId),parsexmlbool(p.hidden||"0")&&(l.Hidden=!0),c=h+d.length;break;case"</definedName>":l.Ref=unescapexml(utf8read(e.slice(c,h))),t.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete p[0],t.CalcPr=p;break;case"<calcPr/>":delete p[0],t.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return d}),XMLNS_main.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return parse_wb_defaults(t),t}function parse_BrtBundleSh(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=parse_RelID(e),t.name=parse_XLWideString(e),t}function parse_BrtWbProp(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var i=r>8?parse_XLWideString(e):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function parse_BrtFRTArchID$(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function parse_BrtName(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var i=e.read_shift(4),l=parse_XLNameWideString(e),c=parse_XLSBNameParsedFormula(e,0,t),f=parse_XLNullableWideString(e);e.l=n;var d={Name:l,Ptg:c};return i<268435455&&(d.Sheet=i),f&&(d.Comment=f),d}function parse_wb_bin(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;r||(r={}),r.biff=12;var l=[],c=[[]];return c.SheetNames=[],c.XTI=[],XLSBRecordEnum[16]={n:"BrtFRTArchID$",f:parse_BrtFRTArchID$},recordhopper(e,function(d,h,p){switch(p){case 156:c.SheetNames.push(d.name),t.Sheets.push(d);break;case 153:t.WBProps=d;break;case 39:d.Sheet!=null&&(r.SID=d.Sheet),d.Ref=stringify_formula(d.Ptg,null,null,c,r),delete r.SID,delete d.Ptg,l.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([p,d]):c[0]=[p,d],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(d),c.XTI=c.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(p),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(p),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!h.T){if(!i||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},r),parse_wb_defaults(t),t.Names=l,t.supbooks=c,t}function parse_wb(e,r,t){return r.slice(-4)===".bin"?parse_wb_bin(e,t):parse_wb_xml(e,t)}function parse_ws(e,r,t,n,i,l,c,f){return r.slice(-4)===".bin"?parse_ws_bin(e,n,t,i,l,c,f):parse_ws_xml(e,n,t,i,l,c,f)}function parse_cs(e,r,t,n,i,l,c,f){return r.slice(-4)===".bin"?parse_cs_bin(e,n,t,i,l):parse_cs_xml(e,n,t,i,l)}function parse_ms(e,r,t,n,i,l,c,f){return r.slice(-4)===".bin"?parse_ms_bin():parse_ms_xml()}function parse_ds(e,r,t,n,i,l,c,f){return r.slice(-4)===".bin"?parse_ds_bin():parse_ds_xml()}function parse_sty(e,r,t,n){return r.slice(-4)===".bin"?parse_sty_bin(e,t,n):parse_sty_xml(e,t,n)}function parse_theme(e,r,t){return parse_theme_xml(e,t)}function parse_sst(e,r,t){return r.slice(-4)===".bin"?parse_sst_bin(e,t):parse_sst_xml(e,t)}function parse_cmnt(e,r,t){return r.slice(-4)===".bin"?parse_comments_bin(e,t):parse_comments_xml(e,t)}function parse_cc(e,r,t){return r.slice(-4)===".bin"?parse_cc_bin(e):parse_cc_xml(e)}function parse_xlink(e,r,t,n){return t.slice(-4)===".bin"?parse_xlink_bin(e,r,t,n):void 0}function parse_xlmeta(e,r,t){return r.slice(-4)===".bin"?parse_xlmeta_bin(e,r,t):parse_xlmeta_xml(e,r,t)}var attregexg2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,attregex2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function xlml_parsexmltag(e,r){var t=e.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var i=e.match(attregexg2),l,c,f,d;if(i)for(d=0;d!=i.length;++d)l=i[d].match(attregex2),(c=l[1].indexOf(":"))===-1?n[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?f="xmlns"+l[1].slice(6):f=l[1].slice(c+1),n[f]=l[2].slice(1,l[2].length-1));return n}function xlml_parsexmltagobj(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(attregexg2),i,l,c,f;if(n)for(f=0;f!=n.length;++f)i=n[f].match(attregex2),(l=i[1].indexOf(":"))===-1?t[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(l+1),t[c]=i[2].slice(1,i[2].length-1));return t}var XLMLFormatMap;function xlml_format(e,r){var t=XLMLFormatMap[e]||unescapexml(e);return t==="General"?SSF_general(r):SSF_format(t,r)}function xlml_set_custprop(e,r,t,n){var i=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=parsexmlbool(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=parseDate(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[unescapexml(r)]=i}function safe_format_xlml(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||BErr[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v):e.w=SSF_general(e.v):e.w=xlml_format(r||"General",e.v)}catch(l){if(t.WTF)throw l}try{var n=XLMLFormatMap[r]||r||"General";if(t.cellNF&&(e.z=n),t.cellDates&&e.t=="n"&&fmt_is_date(n)){var i=SSF_parse_date_code(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(l){if(t.WTF)throw l}}}function process_style_xlml(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=XLMLPatternTypeMap[n.Pattern]||n.Pattern)}e[r.ID]=r}function parse_xlml_data(e,r,t,n,i,l,c,f,d,h){var p="General",E=n.StyleID,y={};h=h||{};var S=[],x=0;for(E===void 0&&f&&(E=f.StyleID),E===void 0&&c&&(E=c.StyleID);l[E]!==void 0&&(l[E].nf&&(p=l[E].nf),l[E].Interior&&S.push(l[E].Interior),!!l[E].Parent);)E=l[E].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=parsexmlbool(e);break;case"String":n.t="s",n.r=xlml_fixstr(unescapexml(e)),n.v=e.indexOf("<")>-1?unescapexml(r||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(parseDate(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=unescapexml(e):n.v<60&&(n.v=n.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=RBErr[e],h.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=xlml_fixstr(r||e));break}if(safe_format_xlml(n,p,h),h.cellFormula!==!1)if(n.Formula){var g=unescapexml(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=rc_to_a1(g,i),delete n.Formula,n.ArrayRange=="RC"?n.F=rc_to_a1("RC:RC",i):n.ArrayRange&&(n.F=rc_to_a1(n.ArrayRange,i),d.push([safe_decode_range(n.F),n.F]))}else for(x=0;x<d.length;++x)i.r>=d[x][0].s.r&&i.r<=d[x][0].e.r&&i.c>=d[x][0].s.c&&i.c<=d[x][0].e.c&&(n.F=d[x][1]);h.cellStyles&&(S.forEach(function(m){!y.patternType&&m.patternType&&(y.patternType=m.patternType)}),n.s=y),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function xlml_clean_comment(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function parse_xlml_xml(e,r){var t=r||{};make_ssf();var n=debom(xlml_normalize(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=utf8read(n));var i=n.slice(0,1024).toLowerCase(),l=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var c=dup(t);return c.type="string",PRN.to_workbook(n,c)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ae){i.indexOf("<"+Ae)>=0&&(l=!0)}),l)return html_to_workbook(n,t);XLMLFormatMap={"General Number":"General","General Date":table_fmt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":table_fmt[15],"Short Date":table_fmt[14],"Long Time":table_fmt[19],"Medium Time":table_fmt[18],"Short Time":table_fmt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:table_fmt[2],Standard:table_fmt[4],Percent:table_fmt[10],Scientific:table_fmt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var f,d=[],h,p={},E=[],y=t.dense?[]:{},S="",x={},g={},m=xlml_parsexmltag('<Data ss:Type="String">'),A=0,O=0,C=0,R={s:{r:2e6,c:2e6},e:{r:0,c:0}},T={},w={},v="",L=0,M=[],X={},H={},ne=0,_e=[],ge=[],he={},W=[],se,ue=!1,re=[],q=[],me={},N=0,P=0,k={Sheets:[],WBProps:{date1904:!1}},B={};xlmlregex.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var z="";f=xlmlregex.exec(n);)switch(f[3]=(z=f[3]).toLowerCase()){case"data":if(z=="data"){if(f[1]==="/"){if((h=d.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&d.push([f[3],!0]);break}if(d[d.length-1][1])break;f[1]==="/"?parse_xlml_data(n.slice(A,f.index),v,m,d[d.length-1][0]=="comment"?he:x,{c:O,r:C},T,W[O],g,re,t):(v="",m=xlml_parsexmltag(f[0]),A=f.index+f[0].length);break;case"cell":if(f[1]==="/")if(ge.length>0&&(x.c=ge),(!t.sheetRows||t.sheetRows>C)&&x.v!==void 0&&(t.dense?(y[C]||(y[C]=[]),y[C][O]=x):y[encode_col(O)+encode_row(C)]=x),x.HRef&&(x.l={Target:unescapexml(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(N=O+(parseInt(x.MergeAcross,10)|0),P=C+(parseInt(x.MergeDown,10)|0),M.push({s:{c:O,r:C},e:{c:N,r:P}})),!t.sheetStubs)x.MergeAcross?O=N+1:++O;else if(x.MergeAcross||x.MergeDown){for(var Q=O;Q<=N;++Q)for(var K=C;K<=P;++K)(Q>O||K>C)&&(t.dense?(y[K]||(y[K]=[]),y[K][Q]={t:"z"}):y[encode_col(Q)+encode_row(K)]={t:"z"});O=N+1}else++O;else x=xlml_parsexmltagobj(f[0]),x.Index&&(O=+x.Index-1),O<R.s.c&&(R.s.c=O),O>R.e.c&&(R.e.c=O),f[0].slice(-2)==="/>"&&++O,ge=[];break;case"row":f[1]==="/"||f[0].slice(-2)==="/>"?(C<R.s.r&&(R.s.r=C),C>R.e.r&&(R.e.r=C),f[0].slice(-2)==="/>"&&(g=xlml_parsexmltag(f[0]),g.Index&&(C=+g.Index-1)),O=0,++C):(g=xlml_parsexmltag(f[0]),g.Index&&(C=+g.Index-1),me={},(g.AutoFitHeight=="0"||g.Height)&&(me.hpx=parseInt(g.Height,10),me.hpt=px2pt(me.hpx),q[C]=me),g.Hidden=="1"&&(me.hidden=!0,q[C]=me));break;case"worksheet":if(f[1]==="/"){if((h=d.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"));E.push(S),R.s.r<=R.e.r&&R.s.c<=R.e.c&&(y["!ref"]=encode_range(R),t.sheetRows&&t.sheetRows<=R.e.r&&(y["!fullref"]=y["!ref"],R.e.r=t.sheetRows-1,y["!ref"]=encode_range(R))),M.length&&(y["!merges"]=M),W.length>0&&(y["!cols"]=W),q.length>0&&(y["!rows"]=q),p[S]=y}else R={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=O=0,d.push([f[3],!1]),h=xlml_parsexmltag(f[0]),S=unescapexml(h.Name),y=t.dense?[]:{},M=[],re=[],q=[],B={name:S,Hidden:0},k.Sheets.push(B);break;case"table":if(f[1]==="/"){if((h=d.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"))}else{if(f[0].slice(-2)=="/>")break;d.push([f[3],!1]),W=[],ue=!1}break;case"style":f[1]==="/"?process_style_xlml(T,w,t):w=xlml_parsexmltag(f[0]);break;case"numberformat":w.nf=unescapexml(xlml_parsexmltag(f[0]).Format||"General"),XLMLFormatMap[w.nf]&&(w.nf=XLMLFormatMap[w.nf]);for(var F=0;F!=392&&table_fmt[F]!=w.nf;++F);if(F==392){for(F=57;F!=392;++F)if(table_fmt[F]==null){SSF_load(w.nf,F);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(se=xlml_parsexmltag(f[0]),se.Hidden&&(se.hidden=!0,delete se.Hidden),se.Width&&(se.wpx=parseInt(se.Width,10)),!ue&&se.wpx>10){ue=!0,MDW=DEF_MDW;for(var I=0;I<W.length;++I)W[I]&&process_col(W[I])}ue&&process_col(se),W[se.Index-1||W.length]=se;for(var V=0;V<+se.Span;++V)W[W.length]=dup(se);break;case"namedrange":if(f[1]==="/")break;k.Names||(k.Names=[]);var D=parsexmltag(f[0]),Y={Name:D.Name,Ref:rc_to_a1(D.RefersTo.slice(1),{r:0,c:0})};k.Sheets.length>0&&(Y.Sheet=k.Sheets.length-1),k.Names.push(Y);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(f[0].slice(-2)==="/>")break;f[1]==="/"?v+=n.slice(L,f.index):L=f.index+f[0].length;break;case"interior":if(!t.cellStyles)break;w.Interior=xlml_parsexmltag(f[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(f[0].slice(-2)==="/>")break;f[1]==="/"?xlml_set_prop(X,z,n.slice(ne,f.index)):ne=f.index+f[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(f[1]==="/"){if((h=d.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"))}else d.push([f[3],!1]);break;case"comment":if(f[1]==="/"){if((h=d.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"));xlml_clean_comment(he),ge.push(he)}else d.push([f[3],!1]),h=xlml_parsexmltag(f[0]),he={a:h.Author};break;case"autofilter":if(f[1]==="/"){if((h=d.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"))}else if(f[0].charAt(f[0].length-2)!=="/"){var ie=xlml_parsexmltag(f[0]);y["!autofilter"]={ref:rc_to_a1(ie.Range).replace(/\$/g,"")},d.push([f[3],!0])}break;case"name":break;case"datavalidation":if(f[1]==="/"){if((h=d.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&d.push([f[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(f[1]==="/"){if((h=d.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&d.push([f[3],!0]);break;case"null":break;default:if(d.length==0&&f[3]=="document"||d.length==0&&f[3]=="uof")return parse_fods(n,t);var te=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(f[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:te=!1}break;case"componentoptions":switch(f[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:te=!1}break;case"excelworkbook":switch(f[3]){case"date1904":k.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:te=!1}break;case"workbookoptions":switch(f[3]){case"owcversion":break;case"height":break;case"width":break;default:te=!1}break;case"worksheetoptions":switch(f[3]){case"visible":if(f[0].slice(-2)!=="/>")if(f[1]==="/")switch(n.slice(ne,f.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2;break}else ne=f.index+f[0].length;break;case"header":y["!margins"]||default_margins(y["!margins"]={},"xlml"),isNaN(+parsexmltag(f[0]).Margin)||(y["!margins"].header=+parsexmltag(f[0]).Margin);break;case"footer":y["!margins"]||default_margins(y["!margins"]={},"xlml"),isNaN(+parsexmltag(f[0]).Margin)||(y["!margins"].footer=+parsexmltag(f[0]).Margin);break;case"pagemargins":var j=parsexmltag(f[0]);y["!margins"]||default_margins(y["!margins"]={},"xlml"),isNaN(+j.Top)||(y["!margins"].top=+j.Top),isNaN(+j.Left)||(y["!margins"].left=+j.Left),isNaN(+j.Right)||(y["!margins"].right=+j.Right),isNaN(+j.Bottom)||(y["!margins"].bottom=+j.Bottom);break;case"displayrighttoleft":k.Views||(k.Views=[]),k.Views[0]||(k.Views[0]={}),k.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:te=!1}break;case"pivottable":case"pivotcache":switch(f[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:te=!1}break;case"pagebreaks":switch(f[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:te=!1}break;case"autofilter":switch(f[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:te=!1}break;case"querytable":switch(f[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:te=!1}break;case"datavalidation":switch(f[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:te=!1}break;case"sorting":case"conditionalformatting":switch(f[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:te=!1}break;case"mapinfo":case"schema":case"data":switch(f[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:te=!1}break;case"smarttags":break;default:te=!1;break}if(te||f[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+f[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(f[0].slice(-2)==="/>")break;f[1]==="/"?xlml_set_custprop(H,z,_e,n.slice(ne,f.index)):(_e=f,ne=f.index+f[0].length);break}if(t.WTF)throw"Unrecognized tag: "+f[3]+"|"+d.join("|")}var J={};return!t.bookSheets&&!t.bookProps&&(J.Sheets=p),J.SheetNames=E,J.Workbook=k,J.SSF=dup(table_fmt),J.Props=X,J.Custprops=H,J}function parse_xlml(e,r){switch(fix_read_opts(r=r||{}),r.type||"base64"){case"base64":return parse_xlml_xml(Base64_decode(e),r);case"binary":case"buffer":case"file":return parse_xlml_xml(e,r);case"array":return parse_xlml_xml(a2s(e),r)}}function parse_compobj(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=parse_ClipboardFormatOrAnsiString(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=parse_ClipboardFormatOrUnicodeString(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var CONTINUE_RT=[60,1084,2066,2165,2175];function slurp(e,r,t,n,i){var l=n,c=[],f=t.slice(t.l,t.l+l);if(i.enc&&i.enc.insitu&&f.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(f)}c.push(f),t.l+=l;for(var d=__readUInt16LE(t,t.l),h=XLSRecordEnum[d],p=0;h!=null&&CONTINUE_RT.indexOf(d)>-1;)l=__readUInt16LE(t,t.l+2),p=t.l+4,d==2066?p+=4:(d==2165||d==2175)&&(p+=12),f=t.slice(p,t.l+4+l),c.push(f),t.l+=4+l,h=XLSRecordEnum[d=__readUInt16LE(t,t.l)];var E=bconcat(c);prep_blob(E,0);var y=0;E.lens=[];for(var S=0;S<c.length;++S)E.lens.push(y),y+=c[S].length;if(E.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+E.length+" < "+n;return r.f(E,E.length,i)}function safe_format_xf(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=table_fmt[n])}catch(l){if(r.WTF)throw l}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||BErr[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v):e.w=SSF_general(e.v):e.w=SSF_format(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(l){if(r.WTF)throw l}if(r.cellDates&&n&&e.t=="n"&&fmt_is_date(table_fmt[n]||String(n))){var i=SSF_parse_date_code(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function make_cell(e,r,t){return{v:e,ixfe:r,t}}function parse_workbook(e,r){var t={opts:{}},n={},i=r.dense?[]:{},l={},c={},f=null,d=[],h="",p={},E,y="",S,x,g,m,A={},O=[],C,R,T=[],w=[],v={Sheets:[],WBProps:{date1904:!1},Views:[{}]},L={},M=function(Je){return Je<8?XLSIcv[Je]:Je<64&&w[Je-8]||XLSIcv[Je]},X=function(Je,st,dt){var nt=st.XF.data;if(!(!nt||!nt.patternType||!dt||!dt.cellStyles)){st.s={},st.s.patternType=nt.patternType;var lt;(lt=rgb2Hex(M(nt.icvFore)))&&(st.s.fgColor={rgb:lt}),(lt=rgb2Hex(M(nt.icvBack)))&&(st.s.bgColor={rgb:lt})}},H=function(Je,st,dt){if(!(me>1)&&!(dt.sheetRows&&Je.r>=dt.sheetRows)){if(dt.cellStyles&&st.XF&&st.XF.data&&X(Je,st,dt),delete st.ixfe,delete st.XF,E=Je,y=encode_cell(Je),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),Je.r<c.s.r&&(c.s.r=Je.r),Je.c<c.s.c&&(c.s.c=Je.c),Je.r+1>c.e.r&&(c.e.r=Je.r+1),Je.c+1>c.e.c&&(c.e.c=Je.c+1),dt.cellFormula&&st.f){for(var nt=0;nt<O.length;++nt)if(!(O[nt][0].s.c>Je.c||O[nt][0].s.r>Je.r)&&!(O[nt][0].e.c<Je.c||O[nt][0].e.r<Je.r)){st.F=encode_range(O[nt][0]),(O[nt][0].s.c!=Je.c||O[nt][0].s.r!=Je.r)&&delete st.f,st.f&&(st.f=""+stringify_formula(O[nt][1],c,Je,re,ne));break}}dt.dense?(i[Je.r]||(i[Je.r]=[]),i[Je.r][Je.c]=st):i[y]=st}},ne={enc:!1,sbcch:0,snames:[],sharedf:A,arrayf:O,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(ne.password=r.password);var _e,ge=[],he=[],W=[],se=[],ue=!1,re=[];re.SheetNames=ne.snames,re.sharedf=ne.sharedf,re.arrayf=ne.arrayf,re.names=[],re.XTI=[];var q=0,me=0,N=0,P=[],k=[],B;ne.codepage=1200,set_cp(1200);for(var z=!1;e.l<e.length-1;){var Q=e.l,K=e.read_shift(2);if(K===0&&q===10)break;var F=e.l===e.length?0:e.read_shift(2),I=XLSRecordEnum[K];if(I&&I.f){if(r.bookSheets&&q===133&&K!==133)break;if(q=K,I.r===2||I.r==12){var V=e.read_shift(2);if(F-=2,!ne.enc&&V!==K&&((V&255)<<8|V>>8)!==K)throw new Error("rt mismatch: "+V+"!="+K);I.r==12&&(e.l+=10,F-=10)}var D={};if(K===10?D=I.f(e,F,ne):D=slurp(K,I,e,F,ne),me==0&&[9,521,1033,2057].indexOf(q)===-1)continue;switch(K){case 34:t.opts.Date1904=v.WBProps.date1904=D;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(ne.enc||(e.l=0),ne.enc=D,!r.password)throw new Error("File is password-protected");if(D.valid==null)throw new Error("Encryption scheme unsupported");if(!D.valid)throw new Error("Password is incorrect");break;case 92:ne.lastuser=D;break;case 66:var Y=Number(D);switch(Y){case 21010:Y=1200;break;case 32768:Y=1e4;break;case 32769:Y=1252;break}set_cp(ne.codepage=Y),z=!0;break;case 317:ne.rrtabid=D;break;case 25:ne.winlocked=D;break;case 439:t.opts.RefreshAll=D;break;case 12:t.opts.CalcCount=D;break;case 16:t.opts.CalcDelta=D;break;case 17:t.opts.CalcIter=D;break;case 13:t.opts.CalcMode=D;break;case 14:t.opts.CalcPrecision=D;break;case 95:t.opts.CalcSaveRecalc=D;break;case 15:ne.CalcRefMode=D;break;case 2211:t.opts.FullCalc=D;break;case 129:D.fDialog&&(i["!type"]="dialog"),D.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),D.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:T.push(D);break;case 430:re.push([D]),re[re.length-1].XTI=[];break;case 35:case 547:re[re.length-1].push(D);break;case 24:case 536:B={Name:D.Name,Ref:stringify_formula(D.rgce,c,null,re,ne)},D.itab>0&&(B.Sheet=D.itab-1),re.names.push(B),re[0]||(re[0]=[],re[0].XTI=[]),re[re.length-1].push(D),D.Name=="_xlnm._FilterDatabase"&&D.itab>0&&D.rgce&&D.rgce[0]&&D.rgce[0][0]&&D.rgce[0][0][0]=="PtgArea3d"&&(k[D.itab-1]={ref:encode_range(D.rgce[0][0][1][2])});break;case 22:ne.ExternCount=D;break;case 23:re.length==0&&(re[0]=[],re[0].XTI=[]),re[re.length-1].XTI=re[re.length-1].XTI.concat(D),re.XTI=re.XTI.concat(D);break;case 2196:if(ne.biff<8)break;B!=null&&(B.Comment=D[1]);break;case 18:i["!protect"]=D;break;case 19:D!==0&&ne.WTF&&console.error("Password verifier: "+D);break;case 133:l[D.pos]=D,ne.snames.push(D.name);break;case 10:{if(--me)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,i["!ref"]=encode_range(c),r.sheetRows&&r.sheetRows<=c.e.r){var ie=c.e.r;c.e.r=r.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=encode_range(c),c.e.r=ie}c.e.r++,c.e.c++}ge.length>0&&(i["!merges"]=ge),he.length>0&&(i["!objects"]=he),W.length>0&&(i["!cols"]=W),se.length>0&&(i["!rows"]=se),v.Sheets.push(L)}h===""?p=i:n[h]=i,i=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(ne.biff===8&&(ne.biff={9:2,521:3,1033:4}[K]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[D.BIFFVer]||8),ne.biffguess=D.BIFFVer==0,D.BIFFVer==0&&D.dt==4096&&(ne.biff=5,z=!0,set_cp(ne.codepage=28591)),ne.biff==8&&D.BIFFVer==0&&D.dt==16&&(ne.biff=2),me++)break;if(i=r.dense?[]:{},ne.biff<8&&!z&&(z=!0,set_cp(ne.codepage=r.codepage||1252)),ne.biff<5||D.BIFFVer==0&&D.dt==4096){h===""&&(h="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var te={pos:e.l-F,name:h};l[te.pos]=te,ne.snames.push(h)}else h=(l[Q]||{name:""}).name;D.dt==32&&(i["!type"]="chart"),D.dt==64&&(i["!type"]="macro"),ge=[],he=[],ne.arrayf=O=[],W=[],se=[],ue=!1,L={Hidden:(l[Q]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(r.dense?(i[D.r]||[])[D.c]:i[encode_cell({c:D.c,r:D.r})])&&++D.c,C={ixfe:D.ixfe,XF:T[D.ixfe]||{},v:D.val,t:"n"},N>0&&(C.z=P[C.ixfe>>8&63]),safe_format_xf(C,r,t.opts.Date1904),H({c:D.c,r:D.r},C,r);break;case 5:case 517:C={ixfe:D.ixfe,XF:T[D.ixfe],v:D.val,t:D.t},N>0&&(C.z=P[C.ixfe>>8&63]),safe_format_xf(C,r,t.opts.Date1904),H({c:D.c,r:D.r},C,r);break;case 638:C={ixfe:D.ixfe,XF:T[D.ixfe],v:D.rknum,t:"n"},N>0&&(C.z=P[C.ixfe>>8&63]),safe_format_xf(C,r,t.opts.Date1904),H({c:D.c,r:D.r},C,r);break;case 189:for(var j=D.c;j<=D.C;++j){var J=D.rkrec[j-D.c][0];C={ixfe:J,XF:T[J],v:D.rkrec[j-D.c][1],t:"n"},N>0&&(C.z=P[C.ixfe>>8&63]),safe_format_xf(C,r,t.opts.Date1904),H({c:j,r:D.r},C,r)}break;case 6:case 518:case 1030:{if(D.val=="String"){f=D;break}if(C=make_cell(D.val,D.cell.ixfe,D.tt),C.XF=T[C.ixfe],r.cellFormula){var Ae=D.formula;if(Ae&&Ae[0]&&Ae[0][0]&&Ae[0][0][0]=="PtgExp"){var pe=Ae[0][0][1][0],ve=Ae[0][0][1][1],Te=encode_cell({r:pe,c:ve});A[Te]?C.f=""+stringify_formula(D.formula,c,D.cell,re,ne):C.F=((r.dense?(i[pe]||[])[ve]:i[Te])||{}).F}else C.f=""+stringify_formula(D.formula,c,D.cell,re,ne)}N>0&&(C.z=P[C.ixfe>>8&63]),safe_format_xf(C,r,t.opts.Date1904),H(D.cell,C,r),f=D}break;case 7:case 519:if(f)f.val=D,C=make_cell(D,f.cell.ixfe,"s"),C.XF=T[C.ixfe],r.cellFormula&&(C.f=""+stringify_formula(f.formula,c,f.cell,re,ne)),N>0&&(C.z=P[C.ixfe>>8&63]),safe_format_xf(C,r,t.opts.Date1904),H(f.cell,C,r),f=null;else throw new Error("String record expects Formula");break;case 33:case 545:{O.push(D);var Me=encode_cell(D[0].s);if(S=r.dense?(i[D[0].s.r]||[])[D[0].s.c]:i[Me],r.cellFormula&&S){if(!f||!Me||!S)break;S.f=""+stringify_formula(D[1],c,D[0],re,ne),S.F=encode_range(D[0])}}break;case 1212:{if(!r.cellFormula)break;if(y){if(!f)break;A[encode_cell(f.cell)]=D[0],S=r.dense?(i[f.cell.r]||[])[f.cell.c]:i[encode_cell(f.cell)],(S||{}).f=""+stringify_formula(D[0],c,E,re,ne)}}break;case 253:C=make_cell(d[D.isst].t,D.ixfe,"s"),d[D.isst].h&&(C.h=d[D.isst].h),C.XF=T[C.ixfe],N>0&&(C.z=P[C.ixfe>>8&63]),safe_format_xf(C,r,t.opts.Date1904),H({c:D.c,r:D.r},C,r);break;case 513:r.sheetStubs&&(C={ixfe:D.ixfe,XF:T[D.ixfe],t:"z"},N>0&&(C.z=P[C.ixfe>>8&63]),safe_format_xf(C,r,t.opts.Date1904),H({c:D.c,r:D.r},C,r));break;case 190:if(r.sheetStubs)for(var ze=D.c;ze<=D.C;++ze){var we=D.ixfe[ze-D.c];C={ixfe:we,XF:T[we],t:"z"},N>0&&(C.z=P[C.ixfe>>8&63]),safe_format_xf(C,r,t.opts.Date1904),H({c:ze,r:D.r},C,r)}break;case 214:case 516:case 4:C=make_cell(D.val,D.ixfe,"s"),C.XF=T[C.ixfe],N>0&&(C.z=P[C.ixfe>>8&63]),safe_format_xf(C,r,t.opts.Date1904),H({c:D.c,r:D.r},C,r);break;case 0:case 512:me===1&&(c=D);break;case 252:d=D;break;case 1054:if(ne.biff==4){P[N++]=D[1];for(var at=0;at<N+163&&table_fmt[at]!=D[1];++at);at>=163&&SSF_load(D[1],N+163)}else SSF_load(D[1],D[0]);break;case 30:{P[N++]=D;for(var et=0;et<N+163&&table_fmt[et]!=D;++et);et>=163&&SSF_load(D,N+163)}break;case 229:ge=ge.concat(D);break;case 93:he[D.cmo[0]]=ne.lastobj=D;break;case 438:ne.lastobj.TxO=D;break;case 127:ne.lastobj.ImData=D;break;case 440:for(m=D[0].s.r;m<=D[0].e.r;++m)for(g=D[0].s.c;g<=D[0].e.c;++g)S=r.dense?(i[m]||[])[g]:i[encode_cell({c:g,r:m})],S&&(S.l=D[1]);break;case 2048:for(m=D[0].s.r;m<=D[0].e.r;++m)for(g=D[0].s.c;g<=D[0].e.c;++g)S=r.dense?(i[m]||[])[g]:i[encode_cell({c:g,r:m})],S&&S.l&&(S.l.Tooltip=D[1]);break;case 28:{if(ne.biff<=5&&ne.biff>=2)break;S=r.dense?(i[D[0].r]||[])[D[0].c]:i[encode_cell(D[0])];var Ke=he[D[2]];S||(r.dense?(i[D[0].r]||(i[D[0].r]=[]),S=i[D[0].r][D[0].c]={t:"z"}):S=i[encode_cell(D[0])]={t:"z"},c.e.r=Math.max(c.e.r,D[0].r),c.s.r=Math.min(c.s.r,D[0].r),c.e.c=Math.max(c.e.c,D[0].c),c.s.c=Math.min(c.s.c,D[0].c)),S.c||(S.c=[]),x={a:D[1],t:Ke.TxO.t},S.c.push(x)}break;case 2173:update_xfext(T[D.ixfe],D.ext);break;case 125:{if(!ne.cellStyles)break;for(;D.e>=D.s;)W[D.e--]={width:D.w/256,level:D.level||0,hidden:!!(D.flags&1)},ue||(ue=!0,find_mdw_colw(D.w/256)),process_col(W[D.e+1])}break;case 520:{var Ze={};D.level!=null&&(se[D.r]=Ze,Ze.level=D.level),D.hidden&&(se[D.r]=Ze,Ze.hidden=!0),D.hpt&&(se[D.r]=Ze,Ze.hpt=D.hpt,Ze.hpx=pt2px(D.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||default_margins(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[K]]=D;break;case 161:i["!margins"]||default_margins(i["!margins"]={}),i["!margins"].header=D.header,i["!margins"].footer=D.footer;break;case 574:D.RTL&&(v.Views[0].RTL=!0);break;case 146:w=D;break;case 2198:_e=D;break;case 140:R=D;break;case 442:h?L.CodeName=D||L.name:v.WBProps.CodeName=D||"ThisWorkbook";break}}else I||console.error("Missing Info for XLS Record 0x"+K.toString(16)),e.l+=F}return t.SheetNames=keys(l).sort(function(ft,Je){return Number(ft)-Number(Je)}).map(function(ft){return l[ft].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&p["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=p)):t.Preamble=p,t.Sheets&&k.forEach(function(ft,Je){t.Sheets[t.SheetNames[Je]]["!autofilter"]=ft}),t.Strings=d,t.SSF=dup(table_fmt),ne.enc&&(t.Encryption=ne.enc),_e&&(t.Themes=_e),t.Metadata={},R!==void 0&&(t.Metadata.Country=R),re.names.length>0&&(v.Names=re.names),t.Workbook=v,t}var PSCLSID={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function parse_xls_props(e,r,t){var n=CFB.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=parse_PropertySetStream(n,DocSummaryPIDDSI,PSCLSID.DSI);for(var l in i)r[l]=i[l]}catch(h){if(t.WTF)throw h}var c=CFB.find(e,"/!SummaryInformation");if(c&&c.size>0)try{var f=parse_PropertySetStream(c,SummaryPIDSI,PSCLSID.SI);for(var d in f)r[d]==null&&(r[d]=f[d])}catch(h){if(t.WTF)throw h}r.HeadingPairs&&r.TitlesOfParts&&(load_props_pairs(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function parse_xlscfb(e,r){r||(r={}),fix_read_opts(r),reset_cp(),r.codepage&&set_ansi(r.codepage);var t,n;if(e.FullPaths){if(CFB.find(e,"/encryption"))throw new Error("File is password-protected");t=CFB.find(e,"!CompObj"),n=CFB.find(e,"/Workbook")||CFB.find(e,"/Book")}else{switch(r.type){case"base64":e=s2a(Base64_decode(e));break;case"binary":e=s2a(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}prep_blob(e,0),n={content:e}}var i,l;if(t&&parse_compobj(t),r.bookProps&&!r.bookSheets)i={};else{var c=has_buf?"buffer":"array";if(n&&n.content)i=parse_workbook(n.content,r);else if((l=CFB.find(e,"PerfectOffice_MAIN"))&&l.content)i=WK_.to_workbook(l.content,(r.type=c,r));else if((l=CFB.find(e,"NativeContent_MAIN"))&&l.content)i=WK_.to_workbook(l.content,(r.type=c,r));else throw(l=CFB.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&CFB.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=make_vba_xls(e))}var f={};return e.FullPaths&&parse_xls_props(e,f,r),i.Props=i.Custprops=f,r.bookFiles&&(i.cfb=e),i}var XLSBRecordEnum={0:{f:parse_BrtRowHdr},1:{f:parse_BrtCellBlank},2:{f:parse_BrtCellRk},3:{f:parse_BrtCellError},4:{f:parse_BrtCellBool},5:{f:parse_BrtCellReal},6:{f:parse_BrtCellSt},7:{f:parse_BrtCellIsst},8:{f:parse_BrtFmlaString},9:{f:parse_BrtFmlaNum},10:{f:parse_BrtFmlaBool},11:{f:parse_BrtFmlaError},12:{f:parse_BrtShortBlank},13:{f:parse_BrtShortRk},14:{f:parse_BrtShortError},15:{f:parse_BrtShortBool},16:{f:parse_BrtShortReal},17:{f:parse_BrtShortSt},18:{f:parse_BrtShortIsst},19:{f:parse_RichStr},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:parse_BrtName},40:{},42:{},43:{f:parse_BrtFont},44:{f:parse_BrtFmt},45:{f:parse_BrtFill},46:{f:parse_BrtBorder},47:{f:parse_BrtXF},48:{},49:{f:parse_Int32LE},50:{},51:{f:parse_BrtMdb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:parse_ColInfo},62:{f:parse_BrtCellRString},63:{f:parse_BrtCalcChainItem$},64:{f:parse_BrtDVal},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:parsenoop,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:parse_BrtBeginWsView},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:parse_BrtWsProp},148:{f:parse_BrtWsDim,p:16},151:{f:parse_BrtPane},152:{},153:{f:parse_BrtWbProp},154:{},155:{},156:{f:parse_BrtBundleSh},157:{},158:{},159:{T:1,f:parse_BrtBeginSst},160:{T:-1},161:{T:1,f:parse_UncheckedRfX},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:parse_BrtMergeCell},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:parse_BrtMdtinfo},336:{T:-1},337:{f:parse_BrtBeginEsmdb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:parse_RelID},357:{},358:{},359:{},360:{T:1},361:{},362:{f:parse_ExternSheet},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:parse_BrtArrFmla},427:{f:parse_BrtShrFmla},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:parse_BrtMargins},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:parse_BrtWsFmtInfo},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:parse_BrtHLink},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:parse_RelID},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:parse_BrtCommentAuthor},633:{T:1},634:{T:-1},635:{T:1,f:parse_BrtBeginComment},636:{T:-1},637:{f:parse_BrtCommentText},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:parse_BrtCsProp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:parse_BrtDVal14},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},XLSRecordEnum={6:{f:parse_Formula},10:{f:parsenoop2},12:{f:parseuint16},13:{f:parseuint16},14:{f:parsebool},15:{f:parsebool},16:{f:parse_Xnum},17:{f:parsebool},18:{f:parsebool},19:{f:parseuint16},20:{f:parse_XLHeaderFooter},21:{f:parse_XLHeaderFooter},23:{f:parse_ExternSheet},24:{f:parse_Lbl},25:{f:parsebool},26:{},27:{},28:{f:parse_Note},29:{},34:{f:parsebool},35:{f:parse_ExternName},38:{f:parse_Xnum},39:{f:parse_Xnum},40:{f:parse_Xnum},41:{f:parse_Xnum},42:{f:parsebool},43:{f:parsebool},47:{f:parse_FilePass},49:{f:parse_Font},51:{f:parseuint16},60:{},61:{f:parse_Window1},64:{f:parsebool},65:{f:parse_Pane},66:{f:parseuint16},77:{},80:{},81:{},82:{},85:{f:parseuint16},89:{},90:{},91:{},92:{f:parse_WriteAccess},93:{f:parse_Obj},94:{},95:{f:parsebool},96:{},97:{},99:{f:parsebool},125:{f:parse_ColInfo},128:{f:parse_Guts},129:{f:parse_WsBool},130:{f:parseuint16},131:{f:parsebool},132:{f:parsebool},133:{f:parse_BoundSheet8},134:{},140:{f:parse_Country},141:{f:parseuint16},144:{},146:{f:parse_Palette},151:{},152:{},153:{},154:{},155:{},156:{f:parseuint16},157:{},158:{},160:{f:parse_Scl},161:{f:parse_Setup},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:parse_MulRk},190:{f:parse_MulBlank},193:{f:parsenoop2},197:{},198:{},199:{},200:{},201:{},202:{f:parsebool},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:parseuint16},220:{},221:{f:parsebool},222:{},224:{f:parse_XF},225:{f:parse_InterfaceHdr},226:{f:parsenoop2},227:{},229:{f:parse_MergeCells},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:parse_SST},253:{f:parse_LabelSst},255:{f:parse_ExtSST},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:parseuint16a},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:parsebool},353:{f:parsenoop2},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:parse_SupBook},431:{f:parsebool},432:{},433:{},434:{},437:{},438:{f:parse_TxO},439:{f:parsebool},440:{f:parse_HLink},441:{},442:{f:parse_XLUnicodeString},443:{},444:{f:parseuint16},445:{},446:{},448:{f:parsenoop2},449:{f:parse_RecalcId,r:2},450:{f:parsenoop2},512:{f:parse_Dimensions},513:{f:parse_Blank},515:{f:parse_Number},516:{f:parse_Label},517:{f:parse_BoolErr},519:{f:parse_String},520:{f:parse_Row},523:{},545:{f:parse_Array},549:{f:parse_DefaultRowHeight},566:{},574:{f:parse_Window2},638:{f:parse_RK},659:{},1048:{},1054:{f:parse_Format},1084:{},1212:{f:parse_ShrFmla},2048:{f:parse_HLinkTooltip},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:parse_BOF},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:parsenoop2},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:parse_XFCRC,r:12},2173:{f:parse_XFExt,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:parsebool,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:parse_NameCmt,r:12},2197:{},2198:{f:parse_Theme,r:12},2199:{},2200:{},2201:{},2202:{f:parse_MTRSettings,r:12},2203:{f:parsenoop2},2204:{},2205:{},2206:{},2207:{},2211:{f:parse_ForceFullCalculation},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:parseuint16},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:parse_ShtProps},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:parse_ClrtClient},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:parse_Dimensions},1:{},2:{f:parse_BIFF2INT},3:{f:parse_BIFF2NUM},4:{f:parse_BIFF2STR},5:{f:parse_BoolErr},7:{f:parse_BIFF2STRING},8:{},9:{f:parse_BOF},11:{},22:{f:parseuint16},30:{f:parse_BIFF2Format},31:{},32:{},33:{f:parse_Array},36:{},37:{f:parse_DefaultRowHeight},50:{f:parse_BIFF2FONTXTRA},62:{},52:{},67:{},68:{f:parseuint16},69:{},86:{},126:{},127:{f:parse_ImData},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:parse_RString},223:{},234:{},354:{},421:{},518:{f:parse_Formula},521:{f:parse_BOF},536:{f:parse_Lbl},547:{f:parse_ExternName},561:{},579:{},1030:{f:parse_Formula},1033:{f:parse_BOF},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function write_biff_rec(e,r,t,n){var i=r;if(!isNaN(i)){var l=(t||[]).length||0,c=e.next(4);c.write_shift(2,i),c.write_shift(2,l),l>0&&is_buf(t)&&e.push(t)}}function html_to_sheet(e,r){var t=r,n=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),c=i.index,f=l&&l.index||e.length,d=split_regex(e.slice(c,f),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,p=0,E=0,y=0,S={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(c=0;c<d.length;++c){var g=d[c].trim(),m=g.slice(0,3).toLowerCase();if(m=="<tr"){if(++h,t.sheetRows&&t.sheetRows<=h){--h;break}p=0;continue}if(!(m!="<td"&&m!="<th")){var A=g.split(/<\/t[dh]>/i);for(f=0;f<A.length;++f){var O=A[f].trim();if(O.match(/<t[dh]/i)){for(var C=O,R=0;C.charAt(0)=="<"&&(R=C.indexOf(">"))>-1;)C=C.slice(R+1);for(var T=0;T<x.length;++T){var w=x[T];w.s.c==p&&w.s.r<h&&h<=w.e.r&&(p=w.e.c+1,T=-1)}var v=parsexmltag(O.slice(0,O.indexOf(">")));y=v.colspan?+v.colspan:1,((E=+v.rowspan)>1||y>1)&&x.push({s:{r:h,c:p},e:{r:h+(E||1)-1,c:p+y-1}});var L=v.t||v["data-t"]||"";if(!C.length){p+=y;continue}if(C=htmldecode(C),S.s.r>h&&(S.s.r=h),S.e.r<h&&(S.e.r=h),S.s.c>p&&(S.s.c=p),S.e.c<p&&(S.e.c=p),!C.length){p+=y;continue}var M={t:"s",v:C};t.raw||!C.trim().length||L=="s"||(C==="TRUE"?M={t:"b",v:!0}:C==="FALSE"?M={t:"b",v:!1}:isNaN(fuzzynum(C))?isNaN(fuzzydate(C).getDate())||(M={t:"d",v:parseDate(C)},t.cellDates||(M={t:"n",v:datenum(M.v)}),M.z=t.dateNF||table_fmt[14]):M={t:"n",v:fuzzynum(C)}),t.dense?(n[h]||(n[h]=[]),n[h][p]=M):n[encode_cell({r:h,c:p})]=M,p+=y}}}}return n["!ref"]=encode_range(S),x.length&&(n["!merges"]=x),n}function make_html_row(e,r,t,n){for(var i=e["!merges"]||[],l=[],c=r.s.c;c<=r.e.c;++c){for(var f=0,d=0,h=0;h<i.length;++h)if(!(i[h].s.r>t||i[h].s.c>c)&&!(i[h].e.r<t||i[h].e.c<c)){if(i[h].s.r<t||i[h].s.c<c){f=-1;break}f=i[h].e.r-i[h].s.r+1,d=i[h].e.c-i[h].s.c+1;break}if(!(f<0)){var p=encode_cell({r:t,c}),E=n.dense?(e[t]||[])[c]:e[p],y=E&&E.v!=null&&(E.h||escapehtml(E.w||(format_cell(E),E.w)||""))||"",S={};f>1&&(S.rowspan=f),d>1&&(S.colspan=d),n.editable?y='<span contenteditable="true">'+y+"</span>":E&&(S["data-t"]=E&&E.t||"z",E.v!=null&&(S["data-v"]=E.v),E.z!=null&&(S["data-z"]=E.z),E.l&&(E.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+E.l.Target+'">'+y+"</a>")),S.id=(n.id||"sjs")+"-"+p,l.push(writextag("td",y,S))}}var x="<tr>";return x+l.join("")+"</tr>"}var HTML_BEGIN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HTML_END="</body></html>";function html_to_workbook(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return sheet_to_workbook(html_to_sheet(t[0],r),r);var n=book_new();return t.forEach(function(i,l){book_append_sheet(n,html_to_sheet(i,r),"Sheet"+(l+1))}),n}function make_html_preamble(e,r,t){var n=[];return n.join("")+"<table"+(t.id?' id="'+t.id+'"':"")+">"}function sheet_to_html(e,r){var t=r||{},n=t.header!=null?t.header:HTML_BEGIN,i=t.footer!=null?t.footer:HTML_END,l=[n],c=decode_range(e["!ref"]);t.dense=Array.isArray(e),l.push(make_html_preamble(e,c,t));for(var f=c.s.r;f<=c.e.r;++f)l.push(make_html_row(e,c,f,t));return l.push("</table>"+i),l.join("")}function sheet_add_dom(e,r,t){var n=t||{},i=0,l=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?decode_cell(n.origin):n.origin;i=c.r,l=c.c}var f=r.getElementsByTagName("tr"),d=Math.min(n.sheetRows||1e7,f.length),h={s:{r:0,c:0},e:{r:i,c:l}};if(e["!ref"]){var p=decode_range(e["!ref"]);h.s.r=Math.min(h.s.r,p.s.r),h.s.c=Math.min(h.s.c,p.s.c),h.e.r=Math.max(h.e.r,p.e.r),h.e.c=Math.max(h.e.c,p.e.c),i==-1&&(h.e.r=i=p.e.r+1)}var E=[],y=0,S=e["!rows"]||(e["!rows"]=[]),x=0,g=0,m=0,A=0,O=0,C=0;for(e["!cols"]||(e["!cols"]=[]);x<f.length&&g<d;++x){var R=f[x];if(is_dom_element_hidden(R)){if(n.display)continue;S[g]={hidden:!0}}var T=R.children;for(m=A=0;m<T.length;++m){var w=T[m];if(!(n.display&&is_dom_element_hidden(w))){var v=w.hasAttribute("data-v")?w.getAttribute("data-v"):w.hasAttribute("v")?w.getAttribute("v"):htmldecode(w.innerHTML),L=w.getAttribute("data-z")||w.getAttribute("z");for(y=0;y<E.length;++y){var M=E[y];M.s.c==A+l&&M.s.r<g+i&&g+i<=M.e.r&&(A=M.e.c+1-l,y=-1)}C=+w.getAttribute("colspan")||1,((O=+w.getAttribute("rowspan")||1)>1||C>1)&&E.push({s:{r:g+i,c:A+l},e:{r:g+i+(O||1)-1,c:A+l+(C||1)-1}});var X={t:"s",v},H=w.getAttribute("data-t")||w.getAttribute("t")||"";v!=null&&(v.length==0?X.t=H||"z":n.raw||v.trim().length==0||H=="s"||(v==="TRUE"?X={t:"b",v:!0}:v==="FALSE"?X={t:"b",v:!1}:isNaN(fuzzynum(v))?isNaN(fuzzydate(v).getDate())||(X={t:"d",v:parseDate(v)},n.cellDates||(X={t:"n",v:datenum(X.v)}),X.z=n.dateNF||table_fmt[14]):X={t:"n",v:fuzzynum(v)})),X.z===void 0&&L!=null&&(X.z=L);var ne="",_e=w.getElementsByTagName("A");if(_e&&_e.length)for(var ge=0;ge<_e.length&&!(_e[ge].hasAttribute("href")&&(ne=_e[ge].getAttribute("href"),ne.charAt(0)!="#"));++ge);ne&&ne.charAt(0)!="#"&&(X.l={Target:ne}),n.dense?(e[g+i]||(e[g+i]=[]),e[g+i][A+l]=X):e[encode_cell({c:A+l,r:g+i})]=X,h.e.c<A+l&&(h.e.c=A+l),A+=C}}++g}return E.length&&(e["!merges"]=(e["!merges"]||[]).concat(E)),h.e.r=Math.max(h.e.r,g-1+i),e["!ref"]=encode_range(h),g>=d&&(e["!fullref"]=encode_range((h.e.r=f.length-x+g-1+i,h))),e}function parse_dom_table(e,r){var t=r||{},n=t.dense?[]:{};return sheet_add_dom(n,e,r)}function table_to_book(e,r){return sheet_to_workbook(parse_dom_table(e,r),r)}function is_dom_element_hidden(e){var r="",t=get_get_computed_style_function(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function get_get_computed_style_function(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function parse_text_p(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=unescapexml(r.replace(/<[^>]*>/g,""));return[t]}var number_formats_ods={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function parse_content_xml(e,r){var t=r||{},n=xlml_normalize(e),i=[],l,c,f={name:""},d="",h=0,p,E,y={},S=[],x=t.dense?[]:{},g,m,A={value:""},O="",C=0,R=[],T=-1,w=-1,v={s:{r:1e6,c:1e7},e:{r:0,c:0}},L=0,M={},X=[],H={},ne=0,_e=0,ge=[],he=1,W=1,se=[],ue={Names:[]},re={},q=["",""],me=[],N={},P="",k=0,B=!1,z=!1,Q=0;for(xlmlregex.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=xlmlregex.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(v.e.c>=v.s.c&&v.e.r>=v.s.r?x["!ref"]=encode_range(v):x["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=v.e.r&&(x["!fullref"]=x["!ref"],v.e.r=t.sheetRows-1,x["!ref"]=encode_range(v)),X.length&&(x["!merges"]=X),ge.length&&(x["!rows"]=ge),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),S.push(p.name),y[p.name]=x,z=!1):g[0].charAt(g[0].length-2)!=="/"&&(p=parsexmltag(g[0],!1),T=w=-1,v.s.r=v.s.c=1e7,v.e.r=v.e.c=0,x=t.dense?[]:{},X=[],ge=[],z=!0);break;case"table-row-group":g[1]==="/"?--L:++L;break;case"table-row":case"":if(g[1]==="/"){T+=he,he=1;break}if(E=parsexmltag(g[0],!1),E.?T=E.-1:T==-1&&(T=0),he=+E["number-rows-repeated"]||1,he<10)for(Q=0;Q<he;++Q)L>0&&(ge[T+Q]={level:L});w=-1;break;case"covered-table-cell":g[1]!=="/"&&++w,t.sheetStubs&&(t.dense?(x[T]||(x[T]=[]),x[T][w]={t:"z"}):x[encode_cell({r:T,c:w})]={t:"z"}),O="",R=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++w,A=parsexmltag(g[0],!1),W=parseInt(A["number-columns-repeated"]||"1",10),m={t:"z",v:null},A.formula&&t.cellFormula!=!1&&(m.f=ods_to_csf_formula(unescapexml(A.formula))),(A.||A["value-type"])=="string"&&(m.t="s",m.v=unescapexml(A["string-value"]||""),t.dense?(x[T]||(x[T]=[]),x[T][w]=m):x[encode_cell({r:T,c:w})]=m),w+=W-1;else if(g[1]!=="/"){++w,O="",C=0,R=[],W=1;var K=he?T+he-1:T;if(w>v.e.c&&(v.e.c=w),w<v.s.c&&(v.s.c=w),T<v.s.r&&(v.s.r=T),K>v.e.r&&(v.e.r=K),A=parsexmltag(g[0],!1),me=[],N={},m={t:A.||A["value-type"],v:null},t.cellFormula)if(A.formula&&(A.formula=unescapexml(A.formula)),A["number-matrix-columns-spanned"]&&A["number-matrix-rows-spanned"]&&(ne=parseInt(A["number-matrix-rows-spanned"],10)||0,_e=parseInt(A["number-matrix-columns-spanned"],10)||0,H={s:{r:T,c:w},e:{r:T+ne-1,c:w+_e-1}},m.F=encode_range(H),se.push([H,m.F])),A.formula)m.f=ods_to_csf_formula(A.formula);else for(Q=0;Q<se.length;++Q)T>=se[Q][0].s.r&&T<=se[Q][0].e.r&&w>=se[Q][0].s.c&&w<=se[Q][0].e.c&&(m.F=se[Q][1]);switch((A["number-columns-spanned"]||A["number-rows-spanned"])&&(ne=parseInt(A["number-rows-spanned"],10)||0,_e=parseInt(A["number-columns-spanned"],10)||0,H={s:{r:T,c:w},e:{r:T+ne-1,c:w+_e-1}},X.push(H)),A["number-columns-repeated"]&&(W=parseInt(A["number-columns-repeated"],10)),m.t){case"boolean":m.t="b",m.v=parsexmlbool(A["boolean-value"]);break;case"float":m.t="n",m.v=parseFloat(A.value);break;case"percentage":m.t="n",m.v=parseFloat(A.value);break;case"currency":m.t="n",m.v=parseFloat(A.value);break;case"date":m.t="d",m.v=parseDate(A["date-value"]),t.cellDates||(m.t="n",m.v=datenum(m.v)),m.z="m/d/yy";break;case"time":m.t="n",m.v=parse_isodur(A["time-value"])/86400,t.cellDates&&(m.t="d",m.v=numdate(m.v)),m.z="HH:MM:SS";break;case"number":m.t="n",m.v=parseFloat(A.);break;default:if(m.t==="string"||m.t==="text"||!m.t)m.t="s",A["string-value"]!=null&&(O=unescapexml(A["string-value"]),R=[]);else throw new Error("Unsupported value type "+m.t)}}else{if(B=!1,m.t==="s"&&(m.v=O||"",R.length&&(m.R=R),B=C==0),re.Target&&(m.l=re),me.length>0&&(m.c=me,me=[]),O&&t.cellText!==!1&&(m.w=O),B&&(m.t="z",delete m.v),(!B||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=T))for(var F=0;F<he;++F){if(W=parseInt(A["number-columns-repeated"]||"1",10),t.dense)for(x[T+F]||(x[T+F]=[]),x[T+F][w]=F==0?m:dup(m);--W>0;)x[T+F][w+W]=dup(m);else for(x[encode_cell({r:T+F,c:w})]=m;--W>0;)x[encode_cell({r:T+F,c:w+W})]=dup(m);v.e.c<=w&&(v.e.c=w)}W=parseInt(A["number-columns-repeated"]||"1",10),w+=W-1,W=0,m={},O="",R=[]}re={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((l=i.pop())[0]!==g[3])throw"Bad state: "+l}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((l=i.pop())[0]!==g[3])throw"Bad state: "+l;N.t=O,R.length&&(N.R=R),N.a=P,me.push(N)}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);P="",k=0,O="",C=0,R=[];break;case"creator":g[1]==="/"?P=n.slice(k,g.index):k=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((l=i.pop())[0]!==g[3])throw"Bad state: "+l}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);O="",C=0,R=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(M[f.name]=d,(l=i.pop())[0]!==g[3])throw"Bad state: "+l}else g[0].charAt(g[0].length-2)!=="/"&&(d="",f=parsexmltag(g[0],!1),i.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":c=parsexmltag(g[0],!1),d+=number_formats_ods[g[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":c=parsexmltag(g[0],!1),d+=number_formats_ods[g[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":d+=n.slice(h,g.index);break}else h=g.index+g[0].length;break;case"named-range":c=parsexmltag(g[0],!1),q=ods_to_csf_3D(c["cell-range-address"]);var I={Name:c.name,Ref:q[0]+"!"+q[1]};z&&(I.Sheet=S.length),ue.Names.push(I);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(g[1]==="/"&&(!A||!A["string-value"])){var V=parse_text_p(n.slice(C,g.index));O=(O.length>0?O+`
`:"")+V[0]}else parsexmltag(g[0],!1),C=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{q=ods_to_csf_3D(parsexmltag(g[0])["target-range-address"]),y[q[0]]["!autofilter"]={ref:q[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(re=parsexmltag(g[0],!1),!re.href)break;re.Target=unescapexml(re.href),delete re.href,re.Target.charAt(0)=="#"&&re.Target.indexOf(".")>-1?(q=ods_to_csf_3D(re.Target.slice(1)),re.Target="#"+q[0]+"!"+q[1]):re.Target.match(/^\.\.[\\\/]/)&&(re.Target=re.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(g)}}var D={Sheets:y,SheetNames:S,Workbook:ue};return t.bookSheets&&delete D.Sheets,D}function parse_ods(e,r){r=r||{},safegetzipfile(e,"META-INF/manifest.xml")&&parse_manifest(getzipdata(e,"META-INF/manifest.xml"),r);var t=getzipstr(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=parse_content_xml(utf8read(t),r);return safegetzipfile(e,"meta.xml")&&(n.Props=parse_core_props(getzipdata(e,"meta.xml"))),n}function parse_fods(e,r){return parse_content_xml(e,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function u8_to_dataview(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function u8str(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):utf8read(a2s(e))}function u8concat(e){var r=e.reduce(function(i,l){return i+l.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(i){t.set(i,n),n+=i.length}),t}function popcnt(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function readDecimal128LE(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,i=r+13;i>=r;--i)n=n*256+e[i];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function parse_varint49(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function varint_to_i32(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function parse_shallow(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],i=parse_varint49(e,t),l=i&7;i=Math.floor(i/8);var c=0,f;if(i==0)break;switch(l){case 0:{for(var d=t[0];e[t[0]++]>=128;);f=e.slice(d,t[0])}break;case 5:c=4,f=e.slice(t[0],t[0]+c),t[0]+=c;break;case 1:c=8,f=e.slice(t[0],t[0]+c),t[0]+=c;break;case 2:c=parse_varint49(e,t),f=e.slice(t[0],t[0]+c),t[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(i," at offset ").concat(n))}var h={data:f,type:l};r[i]==null?r[i]=[h]:r[i].push(h)}return r}function mappa(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function parse_iwa_file(e){for(var r,t=[],n=[0];n[0]<e.length;){var i=parse_varint49(e,n),l=parse_shallow(e.slice(n[0],n[0]+i));n[0]+=i;var c={id:varint_to_i32(l[1][0].data),messages:[]};l[2].forEach(function(f){var d=parse_shallow(f.data),h=varint_to_i32(d[3][0].data);c.messages.push({meta:d,data:e.slice(n[0],n[0]+h)}),n[0]+=h}),(r=l[3])!=null&&r[0]&&(c.merge=varint_to_i32(l[3][0].data)>>>0>0),t.push(c)}return t}function parse_snappy_chunk(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=parse_varint49(r,t),i=[];t[0]<r.length;){var l=r[t[0]]&3;if(l==0){var c=r[t[0]++]>>2;if(c<60)++c;else{var f=c-59;c=r[t[0]],f>1&&(c|=r[t[0]+1]<<8),f>2&&(c|=r[t[0]+2]<<16),f>3&&(c|=r[t[0]+3]<<24),c>>>=0,c++,t[0]+=f}i.push(r.slice(t[0],t[0]+c)),t[0]+=c;continue}else{var d=0,h=0;if(l==1?(h=(r[t[0]]>>2&7)+4,d=(r[t[0]++]&224)<<3,d|=r[t[0]++]):(h=(r[t[0]++]>>2)+1,l==2?(d=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(d=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),i=[u8concat(i)],d==0)throw new Error("Invalid offset 0");if(d>i[0].length)throw new Error("Invalid offset beyond length");if(h>=d)for(i.push(i[0].slice(-d)),h-=d;h>=i[i.length-1].length;)i.push(i[i.length-1]),h-=i[i.length-1].length;i.push(i[0].slice(-d,-d+h))}}var p=u8concat(i);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function decompress_iwa_file(e){for(var r=[],t=0;t<e.length;){var n=e[t++],i=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(parse_snappy_chunk(n,e.slice(t,t+i))),t+=i}if(t!==e.length)throw new Error("data is not a valid framed stream!");return u8concat(r)}function parse_old_storage(e,r,t,n){var i=u8_to_dataview(e),l=i.getUint32(4,!0),c=(n>1?12:8)+popcnt(l&(n>1?3470:398))*4,f=-1,d=-1,h=NaN,p=new Date(2001,0,1);l&512&&(f=i.getUint32(c,!0),c+=4),c+=popcnt(l&(n>1?12288:4096))*4,l&16&&(d=i.getUint32(c,!0),c+=4),l&32&&(h=i.getFloat64(c,!0),c+=8),l&64&&(p.setTime(p.getTime()+i.getFloat64(c,!0)*1e3),c+=8);var E;switch(e[2]){case 0:break;case 2:E={t:"n",v:h};break;case 3:E={t:"s",v:r[d]};break;case 5:E={t:"d",v:p};break;case 6:E={t:"b",v:h>0};break;case 7:E={t:"n",v:h/86400};break;case 8:E={t:"e",v:0};break;case 9:if(f>-1)E={t:"s",v:t[f]};else if(d>-1)E={t:"s",v:r[d]};else if(!isNaN(h))E={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return E}function parse_new_storage(e,r,t){var n=u8_to_dataview(e),i=n.getUint32(8,!0),l=12,c=-1,f=-1,d=NaN,h=NaN,p=new Date(2001,0,1);i&1&&(d=readDecimal128LE(e,l),l+=16),i&2&&(h=n.getFloat64(l,!0),l+=8),i&4&&(p.setTime(p.getTime()+n.getFloat64(l,!0)*1e3),l+=8),i&8&&(f=n.getUint32(l,!0),l+=4),i&16&&(c=n.getUint32(l,!0),l+=4);var E;switch(e[1]){case 0:break;case 2:E={t:"n",v:d};break;case 3:E={t:"s",v:r[f]};break;case 5:E={t:"d",v:p};break;case 6:E={t:"b",v:h>0};break;case 7:E={t:"n",v:h/86400};break;case 8:E={t:"e",v:0};break;case 9:if(c>-1)E={t:"s",v:t[c]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:E={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return E}function parse_cell_storage(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return parse_old_storage(e,r,t,e[0]);case 5:return parse_new_storage(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function parse_TSP_Reference(e){var r=parse_shallow(e);return parse_varint49(r[1][0].data)}function parse_TST_TableDataList(e,r){var t=parse_shallow(r.data),n=varint_to_i32(t[1][0].data),i=t[3],l=[];return(i||[]).forEach(function(c){var f=parse_shallow(c.data),d=varint_to_i32(f[1][0].data)>>>0;switch(n){case 1:l[d]=u8str(f[3][0].data);break;case 8:{var h=e[parse_TSP_Reference(f[9][0].data)][0],p=parse_shallow(h.data),E=e[parse_TSP_Reference(p[1][0].data)][0],y=varint_to_i32(E.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var S=parse_shallow(E.data);l[d]=S[3].map(function(x){return u8str(x.data)}).join("")}break}}),l}function parse_TST_TileRowInfo(e,r){var t,n,i,l,c,f,d,h,p,E,y,S,x,g,m=parse_shallow(e),A=varint_to_i32(m[1][0].data)>>>0,O=varint_to_i32(m[2][0].data)>>>0,C=((n=(t=m[8])==null?void 0:t[0])==null?void 0:n.data)&&varint_to_i32(m[8][0].data)>0||!1,R,T;if((l=(i=m[7])==null?void 0:i[0])!=null&&l.data&&r!=0)R=(f=(c=m[7])==null?void 0:c[0])==null?void 0:f.data,T=(h=(d=m[6])==null?void 0:d[0])==null?void 0:h.data;else if((E=(p=m[4])==null?void 0:p[0])!=null&&E.data&&r!=1)R=(S=(y=m[4])==null?void 0:y[0])==null?void 0:S.data,T=(g=(x=m[3])==null?void 0:x[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var w=C?4:1,v=u8_to_dataview(R),L=[],M=0;M<R.length/2;++M){var X=v.getUint16(M*2,!0);X<65535&&L.push([M,X])}if(L.length!=O)throw"Expected ".concat(O," cells, found ").concat(L.length);var H=[];for(M=0;M<L.length-1;++M)H[L[M][0]]=T.subarray(L[M][1]*w,L[M+1][1]*w);return L.length>=1&&(H[L[L.length-1][0]]=T.subarray(L[L.length-1][1]*w)),{R:A,cells:H}}function parse_TST_Tile(e,r){var t,n=parse_shallow(r.data),i=(t=n==null?void 0:n[7])!=null&&t[0]?varint_to_i32(n[7][0].data)>>>0>0?1:0:-1,l=mappa(n[5],function(c){return parse_TST_TileRowInfo(c,i)});return{nrows:varint_to_i32(n[4][0].data)>>>0,data:l.reduce(function(c,f){return c[f.R]||(c[f.R]=[]),f.cells.forEach(function(d,h){if(c[f.R][h])throw new Error("Duplicate cell r=".concat(f.R," c=").concat(h));c[f.R][h]=d}),c},[])}}function parse_TST_TableModelArchive(e,r,t){var n,i=parse_shallow(r.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(varint_to_i32(i[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(l.e.c=(varint_to_i32(i[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));t["!ref"]=encode_range(l);var c=parse_shallow(i[4][0].data),f=parse_TST_TableDataList(e,e[parse_TSP_Reference(c[4][0].data)][0]),d=(n=c[17])!=null&&n[0]?parse_TST_TableDataList(e,e[parse_TSP_Reference(c[17][0].data)][0]):[],h=parse_shallow(c[3][0].data),p=0;h[1].forEach(function(E){var y=parse_shallow(E.data),S=e[parse_TSP_Reference(y[2][0].data)][0],x=varint_to_i32(S.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var g=parse_TST_Tile(e,S);g.data.forEach(function(m,A){m.forEach(function(O,C){var R=encode_cell({r:p+A,c:C}),T=parse_cell_storage(O,f,d);T&&(t[R]=T)})}),p+=g.nrows})}function parse_TST_TableInfoArchive(e,r){var t=parse_shallow(r.data),n={"!ref":"A1"},i=e[parse_TSP_Reference(t[2][0].data)],l=varint_to_i32(i[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return parse_TST_TableModelArchive(e,i[0],n),n}function parse_TN_SheetArchive(e,r){var t,n=parse_shallow(r.data),i={name:(t=n[1])!=null&&t[0]?u8str(n[1][0].data):"",sheets:[]},l=mappa(n[2],parse_TSP_Reference);return l.forEach(function(c){e[c].forEach(function(f){var d=varint_to_i32(f.meta[1][0].data);d==6e3&&i.sheets.push(parse_TST_TableInfoArchive(e,f))})}),i}function parse_TN_DocumentArchive(e,r){var t=book_new(),n=parse_shallow(r.data),i=mappa(n[1],parse_TSP_Reference);if(i.forEach(function(l){e[l].forEach(function(c){var f=varint_to_i32(c.meta[1][0].data);if(f==2){var d=parse_TN_SheetArchive(e,c);d.sheets.forEach(function(h,p){book_append_sheet(t,h,p==0?d.name:d.name+"_"+p,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function parse_numbers_iwa(e){var r,t,n,i,l={},c=[];if(e.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var h;try{h=decompress_iwa_file(d.content)}catch(E){return console.log("?? "+d.content.length+" "+(E.message||E))}var p;try{p=parse_iwa_file(h)}catch(E){return console.log("## "+(E.message||E))}p.forEach(function(E){l[E.id]=E.messages,c.push(E.id)})}}),!c.length)throw new Error("File has no messages");var f=((i=(n=(t=(r=l==null?void 0:l[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&varint_to_i32(l[1][0].meta[1][0].data)==1&&l[1][0];if(f||c.forEach(function(d){l[d].forEach(function(h){var p=varint_to_i32(h.meta[1][0].data)>>>0;if(p==1)if(!f)f=h;else throw new Error("Document has multiple roots")})}),!f)throw new Error("Cannot find Document root");return parse_TN_DocumentArchive(l,f)}function fix_opts_func(e){return function(t){for(var n=0;n!=e.length;++n){var i=e[n];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function fix_read_opts(e){fix_opts_func([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function get_sheet_type(e){return RELS.WS.indexOf(e)>-1?"sheet":e==RELS.CS?"chart":e==RELS.DS?"dialog":e==RELS.MS?"macro":e&&e.length?e:"sheet"}function safe_parse_wbrels(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,get_sheet_type(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function safe_parse_sheet(e,r,t,n,i,l,c,f,d,h,p,E){try{l[n]=parse_rels(getzipstr(e,t,!0),r);var y=getzipdata(e,r),S;switch(f){case"sheet":S=parse_ws(y,r,i,d,l[n],h,p,E);break;case"chart":if(S=parse_cs(y,r,i,d,l[n],h,p,E),!S||!S["!drawel"])break;var x=resolve_path(S["!drawel"].Target,r),g=get_rels_path(x),m=parse_drawing(getzipstr(e,x,!0),parse_rels(getzipstr(e,g,!0),x)),A=resolve_path(m,x),O=get_rels_path(A);S=parse_chart(getzipstr(e,A,!0),A,d,parse_rels(getzipstr(e,O,!0),A),h,S);break;case"macro":S=parse_ms(y,r,i,d,l[n],h,p,E);break;case"dialog":S=parse_ds(y,r,i,d,l[n],h,p,E);break;default:throw new Error("Unrecognized sheet type "+f)}c[n]=S;var C=[];l&&l[n]&&keys(l[n]).forEach(function(R){var T="";if(l[n][R].Type==RELS.CMNT){T=resolve_path(l[n][R].Target,r);var w=parse_cmnt(getzipdata(e,T,!0),T,d);if(!w||!w.length)return;sheet_insert_comments(S,w,!1)}l[n][R].Type==RELS.TCMNT&&(T=resolve_path(l[n][R].Target,r),C=C.concat(parse_tcmnt_xml(getzipdata(e,T,!0),d)))}),C&&C.length&&sheet_insert_comments(S,C,!0,d.people||[])}catch(R){if(d.WTF)throw R}}function strip_front_slash(e){return e.charAt(0)=="/"?e.slice(1):e}function parse_zip(e,r){if(make_ssf(),r=r||{},fix_read_opts(r),safegetzipfile(e,"META-INF/manifest.xml")||safegetzipfile(e,"objectdata.xml"))return parse_ods(e,r);if(safegetzipfile(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof parse_numbers_iwa<"u"){if(e.FileIndex)return parse_numbers_iwa(e);var t=CFB.utils.cfb_new();return zipentries(e).forEach(function(ge){zip_add_file(t,ge,getzipbin(e,ge))}),parse_numbers_iwa(t)}throw new Error("Unsupported NUMBERS file")}if(!safegetzipfile(e,"[Content_Types].xml"))throw safegetzipfile(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):safegetzipfile(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=zipentries(e),i=parse_ct(getzipstr(e,"[Content_Types].xml")),l=!1,c,f;if(i.workbooks.length===0&&(f="xl/workbook.xml",getzipdata(e,f,!0)&&i.workbooks.push(f)),i.workbooks.length===0){if(f="xl/workbook.bin",!getzipdata(e,f,!0))throw new Error("Could not find workbook");i.workbooks.push(f),l=!0}i.workbooks[0].slice(-3)=="bin"&&(l=!0);var d={},h={};if(!r.bookSheets&&!r.bookProps){if(strs=[],i.sst)try{strs=parse_sst(getzipdata(e,strip_front_slash(i.sst)),i.sst,r)}catch(ge){if(r.WTF)throw ge}r.cellStyles&&i.themes.length&&(d=parse_theme(getzipstr(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],r)),i.style&&(h=parse_sty(getzipdata(e,strip_front_slash(i.style)),i.style,d,r))}i.links.map(function(ge){try{var he=parse_rels(getzipstr(e,get_rels_path(strip_front_slash(ge))),ge);return parse_xlink(getzipdata(e,strip_front_slash(ge)),he,ge,r)}catch{}});var p=parse_wb(getzipdata(e,strip_front_slash(i.workbooks[0])),i.workbooks[0],r),E={},y="";i.coreprops.length&&(y=getzipdata(e,strip_front_slash(i.coreprops[0]),!0),y&&(E=parse_core_props(y)),i.extprops.length!==0&&(y=getzipdata(e,strip_front_slash(i.extprops[0]),!0),y&&parse_ext_props(y,E,r)));var S={};(!r.bookSheets||r.bookProps)&&i.custprops.length!==0&&(y=getzipstr(e,strip_front_slash(i.custprops[0]),!0),y&&(S=parse_cust_props(y,r)));var x={};if((r.bookSheets||r.bookProps)&&(p.Sheets?c=p.Sheets.map(function(he){return he.name}):E.Worksheets&&E.SheetNames.length>0&&(c=E.SheetNames),r.bookProps&&(x.Props=E,x.Custprops=S),r.bookSheets&&typeof c<"u"&&(x.SheetNames=c),r.bookSheets?x.SheetNames:r.bookProps))return x;c={};var g={};r.bookDeps&&i.calcchain&&(g=parse_cc(getzipdata(e,strip_front_slash(i.calcchain)),i.calcchain));var m=0,A={},O,C;{var R=p.Sheets;E.Worksheets=R.length,E.SheetNames=[];for(var T=0;T!=R.length;++T)E.SheetNames[T]=R[T].name}var w=l?"bin":"xml",v=i.workbooks[0].lastIndexOf("/"),L=(i.workbooks[0].slice(0,v+1)+"_rels/"+i.workbooks[0].slice(v+1)+".rels").replace(/^\//,"");safegetzipfile(e,L)||(L="xl/_rels/workbook."+w+".rels");var M=parse_rels(getzipstr(e,L,!0),L.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(r.xlmeta=parse_xlmeta(getzipdata(e,strip_front_slash(i.metadata[0])),i.metadata[0],r)),(i.people||[]).length>=1&&(r.people=parse_people_xml(getzipdata(e,strip_front_slash(i.people[0])),r)),M&&(M=safe_parse_wbrels(M,p.Sheets));var X=getzipdata(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(m=0;m!=E.Worksheets;++m){var H="sheet";if(M&&M[m]?(O="xl/"+M[m][1].replace(/[\/]?xl\//,""),safegetzipfile(e,O)||(O=M[m][1]),safegetzipfile(e,O)||(O=L.replace(/_rels\/.*$/,"")+M[m][1]),H=M[m][2]):(O="xl/worksheets/sheet"+(m+1-X)+"."+w,O=O.replace(/sheet0\./,"sheet.")),C=O.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(m!=r.sheets)continue e;break;case"string":if(E.SheetNames[m].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var ne=!1,_e=0;_e!=r.sheets.length;++_e)typeof r.sheets[_e]=="number"&&r.sheets[_e]==m&&(ne=1),typeof r.sheets[_e]=="string"&&r.sheets[_e].toLowerCase()==E.SheetNames[m].toLowerCase()&&(ne=1);if(!ne)continue e}}safe_parse_sheet(e,O,C,E.SheetNames[m],m,A,c,H,r,p,d,h)}return x={Directory:i,Workbook:p,Props:E,Custprops:S,Deps:g,Sheets:c,SheetNames:E.SheetNames,Strings:strs,Styles:h,Themes:d,SSF:dup(table_fmt)},r&&r.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(ge,he){ge=ge.replace(/^Root Entry[\/]/,""),x.keys.push(ge),x.files[ge]=e.FileIndex[he]}))),r&&r.bookVBA&&(i.vba.length>0?x.vbaraw=getzipdata(e,strip_front_slash(i.vba[0]),!0):i.defaults&&i.defaults.bin===CT_VBA&&(x.vbaraw=getzipdata(e,"xl/vbaProject.bin",!0))),x}function parse_xlsxcfb(e,r){var t=r||{},n="Workbook",i=CFB.find(e,n);try{if(n="/!DataSpaces/Version",i=CFB.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(parse_DataSpaceVersionInfo(i.content),n="/!DataSpaces/DataSpaceMap",i=CFB.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=parse_DataSpaceMap(i.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=CFB.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=parse_DataSpaceDefinition(i.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=CFB.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);parse_Primary(i.content)}catch{}if(n="/EncryptionInfo",i=CFB.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var f=parse_EncryptionInfo(i.content);if(n="/EncryptedPackage",i=CFB.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(f[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(f[1],i.content,t.password||"",t);if(f[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(f[1],i.content,t.password||"",t);throw new Error("File is password-protected")}function firstbyte(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Base64_decode(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function read_cfb(e,r){return CFB.find(e,"EncryptedPackage")?parse_xlsxcfb(e,r):parse_xlscfb(e,r)}function read_zip(e,r){var t,n=e,i=r||{};return i.type||(i.type=has_buf&&Buffer.isBuffer(e)?"buffer":"base64"),t=zip_read(n,i),parse_zip(t,i)}function read_plaintext(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return parse_xlml(e.slice(t),r);default:break e}return PRN.to_workbook(e,r)}function read_plaintext_raw(e,r){var t="",n=firstbyte(e,r);switch(r.type){case"base64":t=Base64_decode(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=cc2str(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=utf8read(t)),r.type="binary",read_plaintext(t,r)}function read_utf16(e,r){var t=e;return r.type=="base64"&&(t=Base64_decode(t)),t=$cptable.utils.decode(1200,t.slice(2),"str"),r.type="binary",read_plaintext(t,r)}function bstrify(e){return e.match(/[^\x00-\x7F]/)?utf8write(e):e}function read_prn(e,r,t,n){return n?(t.type="string",PRN.to_workbook(e,t)):PRN.to_workbook(r,t)}function readSync(e,r){reset_cp();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return readSync(new Uint8Array(e),(t=dup(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],l=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),_ssfopts={},t.dateNF&&(_ssfopts.dateNF=t.dateNF),t.type||(t.type=has_buf&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=has_buf?"buffer":"binary",n=read_binary(e),typeof Uint8Array<"u"&&!has_buf&&(t.type="array")),t.type=="string"&&(l=!0,t.type="binary",t.codepage=65001,n=bstrify(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),f=new Uint8Array(c);if(f.foo="bar",!f.foo)return t=dup(t),t.type="array",readSync(ab2a(n),t)}switch((i=firstbyte(n,t))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return read_cfb(CFB.read(n,t),t);break;case 9:if(i[1]<=8)return parse_xlscfb(n,t);break;case 60:return parse_xlml(n,t);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return read_wb_ID(n,t);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return DIF.to_workbook(n,t);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?read_zip(n,t):read_prn(e,n,t,l);case 239:return i[3]===60?parse_xlml(n,t):read_prn(e,n,t,l);case 255:if(i[1]===254)return read_utf16(n,t);if(i[1]===0&&i[2]===2&&i[3]===0)return WK_.to_workbook(n,t);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return WK_.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return DBF.to_workbook(n,t);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return RTF.to_workbook(n,t);break;case 10:case 13:case 32:return read_plaintext_raw(n,t);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return DBF_SUPPORTED_VERSIONS.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?DBF.to_workbook(n,t):read_prn(e,n,t,l)}function make_json_row(e,r,t,n,i,l,c,f){var d=encode_row(t),h=f.defval,p=f.raw||!Object.prototype.hasOwnProperty.call(f,"raw"),E=!0,y=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:t,enumerable:!1})}catch{y.__rowNum__=t}else y.__rowNum__=t;if(!c||e[t])for(var S=r.s.c;S<=r.e.c;++S){var x=c?e[t][S]:e[n[S]+d];if(x===void 0||x.t===void 0){if(h===void 0)continue;l[S]!=null&&(y[l[S]]=h);continue}var g=x.v;switch(x.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(l[S]!=null){if(g==null)if(x.t=="e"&&g===null)y[l[S]]=null;else if(h!==void 0)y[l[S]]=h;else if(p&&g===null)y[l[S]]=null;else continue;else y[l[S]]=p&&(x.t!=="n"||x.t==="n"&&f.rawNumbers!==!1)?g:format_cell(x,g,f);g!=null&&(E=!1)}}return{row:y,isempty:E}}function sheet_to_json(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,i=1,l=[],c=0,f="",d={s:{r:0,c:0},e:{r:0,c:0}},h=r||{},p=h.range!=null?h.range:e["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof p){case"string":d=safe_decode_range(p);break;case"number":d=safe_decode_range(e["!ref"]),d.s.r=p;break;default:d=p}n>0&&(i=0);var E=encode_row(d.s.r),y=[],S=[],x=0,g=0,m=Array.isArray(e),A=d.s.r,O=0,C={};m&&!e[A]&&(e[A]=[]);var R=h.skipHidden&&e["!cols"]||[],T=h.skipHidden&&e["!rows"]||[];for(O=d.s.c;O<=d.e.c;++O)if(!(R[O]||{}).hidden)switch(y[O]=encode_col(O),t=m?e[A][O]:e[y[O]+E],n){case 1:l[O]=O-d.s.c;break;case 2:l[O]=y[O];break;case 3:l[O]=h.header[O-d.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),f=c=format_cell(t,null,h),g=C[c]||0,!g)C[c]=1;else{do f=c+"_"+g++;while(C[f]);C[c]=g,C[f]=1}l[O]=f}for(A=d.s.r+i;A<=d.e.r;++A)if(!(T[A]||{}).hidden){var w=make_json_row(e,d,A,y,n,l,m,h);(w.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(S[x++]=w.row)}return S.length=x,S}var qreg=/"/g;function make_csv_row(e,r,t,n,i,l,c,f){for(var d=!0,h=[],p="",E=encode_row(t),y=r.s.c;y<=r.e.c;++y)if(n[y]){var S=f.dense?(e[t]||[])[y]:e[n[y]+E];if(S==null)p="";else if(S.v!=null){d=!1,p=""+(f.rawNumbers&&S.t=="n"?S.v:format_cell(S,null,f));for(var x=0,g=0;x!==p.length;++x)if((g=p.charCodeAt(x))===i||g===l||g===34||f.forceQuotes){p='"'+p.replace(qreg,'""')+'"';break}p=="ID"&&(p='"ID"')}else S.f!=null&&!S.F?(d=!1,p="="+S.f,p.indexOf(",")>=0&&(p='"'+p.replace(qreg,'""')+'"')):p="";h.push(p)}return f.blankrows===!1&&d?null:h.join(c)}function sheet_to_csv(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var i=safe_decode_range(e["!ref"]),l=n.FS!==void 0?n.FS:",",c=l.charCodeAt(0),f=n.RS!==void 0?n.RS:`
`,d=f.charCodeAt(0),h=new RegExp((l=="|"?"\\|":l)+"+$"),p="",E=[];n.dense=Array.isArray(e);for(var y=n.skipHidden&&e["!cols"]||[],S=n.skipHidden&&e["!rows"]||[],x=i.s.c;x<=i.e.c;++x)(y[x]||{}).hidden||(E[x]=encode_col(x));for(var g=0,m=i.s.r;m<=i.e.r;++m)(S[m]||{}).hidden||(p=make_csv_row(e,i,m,E,c,d,l,n),p!=null&&(n.strip&&(p=p.replace(h,"")),(p||n.blankrows!==!1)&&t.push((g++?f:"")+p)));return delete n.dense,t.join("")}function sheet_to_txt(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=sheet_to_csv(e,r);return t}function sheet_to_formulae(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var i=safe_decode_range(e["!ref"]),l="",c=[],f,d=[],h=Array.isArray(e);for(f=i.s.c;f<=i.e.c;++f)c[f]=encode_col(f);for(var p=i.s.r;p<=i.e.r;++p)for(l=encode_row(p),f=i.s.c;f<=i.e.c;++f)if(r=c[f]+l,t=h?(e[p]||[])[f]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}d[d.length]=r+"="+n}return d}function sheet_add_json(e,r,t){var n=t||{},i=+!n.skipHeader,l=e||{},c=0,f=0;if(n.origin!=null)if(typeof n.origin=="number")c=n.origin;else{var d=typeof n.origin=="string"?decode_cell(n.origin):n.origin;c=d.r,f=d.c}var h,p={s:{c:0,r:0},e:{c:f,r:c+r.length-1+i}};if(l["!ref"]){var E=safe_decode_range(l["!ref"]);p.e.c=Math.max(p.e.c,E.e.c),p.e.r=Math.max(p.e.r,E.e.r),c==-1&&(c=E.e.r+1,p.e.r=c+r.length-1+i)}else c==-1&&(c=0,p.e.r=r.length-1+i);var y=n.header||[],S=0;r.forEach(function(g,m){keys(g).forEach(function(A){(S=y.indexOf(A))==-1&&(y[S=y.length]=A);var O=g[A],C="z",R="",T=encode_cell({c:f+S,r:c+m+i});h=ws_get_cell_stub(l,T),O&&typeof O=="object"&&!(O instanceof Date)?l[T]=O:(typeof O=="number"?C="n":typeof O=="boolean"?C="b":typeof O=="string"?C="s":O instanceof Date?(C="d",n.cellDates||(C="n",O=datenum(O)),R=n.dateNF||table_fmt[14]):O===null&&n.nullError&&(C="e",O=0),h?(h.t=C,h.v=O,delete h.w,delete h.R,R&&(h.z=R)):l[T]=h={t:C,v:O},R&&(h.z=R))})}),p.e.c=Math.max(p.e.c,f+y.length-1);var x=encode_row(c);if(i)for(S=0;S<y.length;++S)l[encode_col(S+f)+x]={t:"s",v:y[S]};return l["!ref"]=encode_range(p),l}function json_to_sheet(e,r){return sheet_add_json(null,e,r)}function ws_get_cell_stub(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=decode_cell(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?ws_get_cell_stub(e,encode_cell(r)):ws_get_cell_stub(e,encode_cell({r,c:t||0}))}function wb_sheet_idx(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function book_new(){return{SheetNames:[],Sheets:{}}}function book_append_sheet(e,r,t,n){var i=1;if(!t)for(;i<=65535&&e.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var l=t.match(/(^.*?)(\d+)$/);i=l&&+l[2]||0;var c=l&&l[1]||t;for(++i;i<=65535&&e.SheetNames.indexOf(t=c+i)!=-1;++i);}if(check_ws_name(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function book_set_sheet_visibility(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=wb_sheet_idx(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function cell_set_number_format(e,r){return e.z=r,e}function cell_set_hyperlink(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function cell_set_internal_link(e,r,t){return cell_set_hyperlink(e,"#"+r,t)}function cell_add_comment(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function sheet_set_array_formula(e,r,t,n){for(var i=typeof r!="string"?r:safe_decode_range(r),l=typeof r=="string"?r:encode_range(r),c=i.s.r;c<=i.e.r;++c)for(var f=i.s.c;f<=i.e.c;++f){var d=ws_get_cell_stub(e,c,f);d.t="n",d.F=l,delete d.v,c==i.s.r&&f==i.s.c&&(d.f=t,n&&(d.D=!0))}return e}var utils={encode_col,encode_row,encode_cell,encode_range,decode_col,decode_row,split_cell,decode_cell,decode_range,format_cell,sheet_add_aoa,sheet_add_json,sheet_add_dom,aoa_to_sheet,json_to_sheet,table_to_sheet:parse_dom_table,table_to_book,sheet_to_csv,sheet_to_txt,sheet_to_json,sheet_to_html,sheet_to_formulae,sheet_to_row_object_array:sheet_to_json,sheet_get_cell:ws_get_cell_stub,book_new,book_append_sheet,book_set_sheet_visibility,cell_set_number_format,cell_set_hyperlink,cell_set_internal_link,cell_add_comment,sheet_set_array_formula,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,function(module,exports){(function(r,t){module.exports=t()})(globalThis,()=>(()=>{var __webpack_modules__=[,(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.VerbosityLevel=r.Util=r.UnknownErrorException=r.UnexpectedResponseException=r.UNSUPPORTED_FEATURES=r.TextRenderingMode=r.StreamType=r.RenderingIntentFlag=r.PermissionFlag=r.PasswordResponses=r.PasswordException=r.PageActionEventType=r.OPS=r.MissingPDFException=r.LINE_FACTOR=r.LINE_DESCENT_FACTOR=r.InvalidPDFException=r.ImageKind=r.IDENTITY_MATRIX=r.FormatError=r.FontType=r.FeatureTest=r.FONT_IDENTITY_MATRIX=r.DocumentActionEventType=r.CMapCompressionType=r.BaseException=r.AnnotationType=r.AnnotationStateModelType=r.AnnotationReviewState=r.AnnotationReplyType=r.AnnotationMode=r.AnnotationMarkedState=r.AnnotationFlag=r.AnnotationFieldFlag=r.AnnotationEditorType=r.AnnotationEditorPrefix=r.AnnotationEditorParamsType=r.AnnotationBorderStyleType=r.AnnotationActionEventType=r.AbortException=void 0,r.arrayByteLength=J,r.arraysToBytes=Ae,r.assert=P,r.bytesToString=te,r.createPromiseCapability=Pt,r.createValidAbsoluteUrl=B,r.escapeString=ft,r.getModificationDate=Wt,r.getVerbosityLevel=re,r.info=q,r.isArrayBuffer=lt,r.isArrayEqual=or,r.isAscii=Je,r.objectFromMap=Te,r.objectSize=ve,r.setVerbosityLevel=ue,r.shadow=z,r.string32=pe,r.stringToBytes=j,r.stringToPDFString=Ze,r.stringToUTF16BEString=st,r.stringToUTF8String=dt,r.unreachable=N,r.utf8StringToString=nt,r.warn=me,t(2);const n=[1,0,0,1,0,0];r.IDENTITY_MATRIX=n;const i=[.001,0,0,.001,0,0];r.FONT_IDENTITY_MATRIX=i;const l=1.35;r.LINE_FACTOR=l;const c=.35;r.LINE_DESCENT_FACTOR=c;const f={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};r.RenderingIntentFlag=f;const d={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};r.AnnotationMode=d;const h="pdfjs_internal_editor_";r.AnnotationEditorPrefix=h;const p={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};r.AnnotationEditorType=p;const E={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};r.AnnotationEditorParamsType=E;const y={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};r.PermissionFlag=y;const S={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};r.TextRenderingMode=S;const x={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};r.ImageKind=x;const g={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};r.AnnotationType=g;const m={MARKED:"Marked",REVIEW:"Review"};r.AnnotationStateModelType=m;const A={MARKED:"Marked",UNMARKED:"Unmarked"};r.AnnotationMarkedState=A;const O={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};r.AnnotationReviewState=O;const C={GROUP:"Group",REPLY:"R"};r.AnnotationReplyType=C;const R={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};r.AnnotationFlag=R;const T={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};r.AnnotationFieldFlag=T;const w={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};r.AnnotationBorderStyleType=w;const v={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};r.AnnotationActionEventType=v;const L={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};r.DocumentActionEventType=L;const M={O:"PageOpen",C:"PageClose"};r.PageActionEventType=M;const X={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};r.StreamType=X;const H={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};r.FontType=H;const ne={ERRORS:0,WARNINGS:1,INFOS:5};r.VerbosityLevel=ne;const _e={NONE:0,BINARY:1,STREAM:2};r.CMapCompressionType=_e;const ge={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};r.OPS=ge;const he={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};r.UNSUPPORTED_FEATURES=he;const W={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};r.PasswordResponses=W;let se=ne.WARNINGS;function ue(Pe){Number.isInteger(Pe)&&(se=Pe)}function re(){return se}function q(Pe){se>=ne.INFOS&&console.log(`Info: ${Pe}`)}function me(Pe){se>=ne.WARNINGS&&console.log(`Warning: ${Pe}`)}function N(Pe){throw new Error(Pe)}function P(Pe,Ee){Pe||N(Ee)}function k(Pe){if(!Pe)return!1;switch(Pe.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function B(Pe,Ee=null,Se=null){if(!Pe)return null;try{if(Se&&typeof Pe=="string"){if(Se.addDefaultProtocol&&Pe.startsWith("www.")){const ot=Pe.match(/\./g);ot&&ot.length>=2&&(Pe=`http://${Pe}`)}if(Se.tryConvertEncoding)try{Pe=dt(Pe)}catch{}}const We=Ee?new URL(Pe,Ee):new URL(Pe);if(k(We))return We}catch{}return null}function z(Pe,Ee,Se){return Object.defineProperty(Pe,Ee,{value:Se,enumerable:!0,configurable:!0,writable:!1}),Se}const Q=function(){function Ee(Se,We){this.constructor===Ee&&N("Cannot initialize BaseException."),this.message=Se,this.name=We}return Ee.prototype=new Error,Ee.constructor=Ee,Ee}();r.BaseException=Q;class K extends Q{constructor(Ee,Se){super(Ee,"PasswordException"),this.code=Se}}r.PasswordException=K;class F extends Q{constructor(Ee,Se){super(Ee,"UnknownErrorException"),this.details=Se}}r.UnknownErrorException=F;class I extends Q{constructor(Ee){super(Ee,"InvalidPDFException")}}r.InvalidPDFException=I;class V extends Q{constructor(Ee){super(Ee,"MissingPDFException")}}r.MissingPDFException=V;class D extends Q{constructor(Ee,Se){super(Ee,"UnexpectedResponseException"),this.status=Se}}r.UnexpectedResponseException=D;class Y extends Q{constructor(Ee){super(Ee,"FormatError")}}r.FormatError=Y;class ie extends Q{constructor(Ee){super(Ee,"AbortException")}}r.AbortException=ie;function te(Pe){(typeof Pe!="object"||Pe===null||Pe.length===void 0)&&N("Invalid argument for bytesToString");const Ee=Pe.length,Se=8192;if(Ee<Se)return String.fromCharCode.apply(null,Pe);const We=[];for(let ot=0;ot<Ee;ot+=Se){const pt=Math.min(ot+Se,Ee),vt=Pe.subarray(ot,pt);We.push(String.fromCharCode.apply(null,vt))}return We.join("")}function j(Pe){typeof Pe!="string"&&N("Invalid argument for stringToBytes");const Ee=Pe.length,Se=new Uint8Array(Ee);for(let We=0;We<Ee;++We)Se[We]=Pe.charCodeAt(We)&255;return Se}function J(Pe){if(Pe.length!==void 0)return Pe.length;if(Pe.byteLength!==void 0)return Pe.byteLength;N("Invalid argument for arrayByteLength")}function Ae(Pe){const Ee=Pe.length;if(Ee===1&&Pe[0]instanceof Uint8Array)return Pe[0];let Se=0;for(let pt=0;pt<Ee;pt++)Se+=J(Pe[pt]);let We=0;const ot=new Uint8Array(Se);for(let pt=0;pt<Ee;pt++){let vt=Pe[pt];vt instanceof Uint8Array||(typeof vt=="string"?vt=j(vt):vt=new Uint8Array(vt));const Qt=vt.byteLength;ot.set(vt,We),We+=Qt}return ot}function pe(Pe){return String.fromCharCode(Pe>>24&255,Pe>>16&255,Pe>>8&255,Pe&255)}function ve(Pe){return Object.keys(Pe).length}function Te(Pe){const Ee=Object.create(null);for(const[Se,We]of Pe)Ee[Se]=We;return Ee}function Me(){const Pe=new Uint8Array(4);return Pe[0]=1,new Uint32Array(Pe.buffer,0,1)[0]===1}function ze(){try{return new Function(""),!0}catch{return!1}}class we{static get isLittleEndian(){return z(this,"isLittleEndian",Me())}static get isEvalSupported(){return z(this,"isEvalSupported",ze())}static get isOffscreenCanvasSupported(){return z(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}}r.FeatureTest=we;const at=[...Array(256).keys()].map(Pe=>Pe.toString(16).padStart(2,"0"));class et{static makeHexColor(Ee,Se,We){return`#${at[Ee]}${at[Se]}${at[We]}`}static scaleMinMax(Ee,Se){let We;Ee[0]?(Ee[0]<0&&(We=Se[0],Se[0]=Se[1],Se[1]=We),Se[0]*=Ee[0],Se[1]*=Ee[0],Ee[3]<0&&(We=Se[2],Se[2]=Se[3],Se[3]=We),Se[2]*=Ee[3],Se[3]*=Ee[3]):(We=Se[0],Se[0]=Se[2],Se[2]=We,We=Se[1],Se[1]=Se[3],Se[3]=We,Ee[1]<0&&(We=Se[2],Se[2]=Se[3],Se[3]=We),Se[2]*=Ee[1],Se[3]*=Ee[1],Ee[2]<0&&(We=Se[0],Se[0]=Se[1],Se[1]=We),Se[0]*=Ee[2],Se[1]*=Ee[2]),Se[0]+=Ee[4],Se[1]+=Ee[4],Se[2]+=Ee[5],Se[3]+=Ee[5]}static transform(Ee,Se){return[Ee[0]*Se[0]+Ee[2]*Se[1],Ee[1]*Se[0]+Ee[3]*Se[1],Ee[0]*Se[2]+Ee[2]*Se[3],Ee[1]*Se[2]+Ee[3]*Se[3],Ee[0]*Se[4]+Ee[2]*Se[5]+Ee[4],Ee[1]*Se[4]+Ee[3]*Se[5]+Ee[5]]}static applyTransform(Ee,Se){const We=Ee[0]*Se[0]+Ee[1]*Se[2]+Se[4],ot=Ee[0]*Se[1]+Ee[1]*Se[3]+Se[5];return[We,ot]}static applyInverseTransform(Ee,Se){const We=Se[0]*Se[3]-Se[1]*Se[2],ot=(Ee[0]*Se[3]-Ee[1]*Se[2]+Se[2]*Se[5]-Se[4]*Se[3])/We,pt=(-Ee[0]*Se[1]+Ee[1]*Se[0]+Se[4]*Se[1]-Se[5]*Se[0])/We;return[ot,pt]}static getAxialAlignedBoundingBox(Ee,Se){const We=et.applyTransform(Ee,Se),ot=et.applyTransform(Ee.slice(2,4),Se),pt=et.applyTransform([Ee[0],Ee[3]],Se),vt=et.applyTransform([Ee[2],Ee[1]],Se);return[Math.min(We[0],ot[0],pt[0],vt[0]),Math.min(We[1],ot[1],pt[1],vt[1]),Math.max(We[0],ot[0],pt[0],vt[0]),Math.max(We[1],ot[1],pt[1],vt[1])]}static inverseTransform(Ee){const Se=Ee[0]*Ee[3]-Ee[1]*Ee[2];return[Ee[3]/Se,-Ee[1]/Se,-Ee[2]/Se,Ee[0]/Se,(Ee[2]*Ee[5]-Ee[4]*Ee[3])/Se,(Ee[4]*Ee[1]-Ee[5]*Ee[0])/Se]}static apply3dTransform(Ee,Se){return[Ee[0]*Se[0]+Ee[1]*Se[1]+Ee[2]*Se[2],Ee[3]*Se[0]+Ee[4]*Se[1]+Ee[5]*Se[2],Ee[6]*Se[0]+Ee[7]*Se[1]+Ee[8]*Se[2]]}static singularValueDecompose2dScale(Ee){const Se=[Ee[0],Ee[2],Ee[1],Ee[3]],We=Ee[0]*Se[0]+Ee[1]*Se[2],ot=Ee[0]*Se[1]+Ee[1]*Se[3],pt=Ee[2]*Se[0]+Ee[3]*Se[2],vt=Ee[2]*Se[1]+Ee[3]*Se[3],Qt=(We+vt)/2,Dr=Math.sqrt((We+vt)**2-4*(We*vt-pt*ot))/2,pr=Qt+Dr||1,zt=Qt-Dr||1;return[Math.sqrt(pr),Math.sqrt(zt)]}static normalizeRect(Ee){const Se=Ee.slice(0);return Ee[0]>Ee[2]&&(Se[0]=Ee[2],Se[2]=Ee[0]),Ee[1]>Ee[3]&&(Se[1]=Ee[3],Se[3]=Ee[1]),Se}static intersect(Ee,Se){const We=Math.max(Math.min(Ee[0],Ee[2]),Math.min(Se[0],Se[2])),ot=Math.min(Math.max(Ee[0],Ee[2]),Math.max(Se[0],Se[2]));if(We>ot)return null;const pt=Math.max(Math.min(Ee[1],Ee[3]),Math.min(Se[1],Se[3])),vt=Math.min(Math.max(Ee[1],Ee[3]),Math.max(Se[1],Se[3]));return pt>vt?null:[We,pt,ot,vt]}static bezierBoundingBox(Ee,Se,We,ot,pt,vt,Qt,Dr){const pr=[],zt=[[],[]];let gr,Zt,na,Rt,jr,Hr,sa,G;for(let ce=0;ce<2;++ce){if(ce===0?(Zt=6*Ee-12*We+6*pt,gr=-3*Ee+9*We-9*pt+3*Qt,na=3*We-3*Ee):(Zt=6*Se-12*ot+6*vt,gr=-3*Se+9*ot-9*vt+3*Dr,na=3*ot-3*Se),Math.abs(gr)<1e-12){if(Math.abs(Zt)<1e-12)continue;Rt=-na/Zt,0<Rt&&Rt<1&&pr.push(Rt);continue}sa=Zt*Zt-4*na*gr,G=Math.sqrt(sa),!(sa<0)&&(jr=(-Zt+G)/(2*gr),0<jr&&jr<1&&pr.push(jr),Hr=(-Zt-G)/(2*gr),0<Hr&&Hr<1&&pr.push(Hr))}let le=pr.length,ee;const ae=le;for(;le--;)Rt=pr[le],ee=1-Rt,zt[0][le]=ee*ee*ee*Ee+3*ee*ee*Rt*We+3*ee*Rt*Rt*pt+Rt*Rt*Rt*Qt,zt[1][le]=ee*ee*ee*Se+3*ee*ee*Rt*ot+3*ee*Rt*Rt*vt+Rt*Rt*Rt*Dr;return zt[0][ae]=Ee,zt[1][ae]=Se,zt[0][ae+1]=Qt,zt[1][ae+1]=Dr,zt[0].length=zt[1].length=ae+2,[Math.min(...zt[0]),Math.min(...zt[1]),Math.max(...zt[0]),Math.max(...zt[1])]}}r.Util=et;const Ke=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Ze(Pe){if(Pe[0]>=""){let Se;if(Pe[0]===""&&Pe[1]===""?Se="utf-16be":Pe[0]===""&&Pe[1]===""?Se="utf-16le":Pe[0]===""&&Pe[1]===""&&Pe[2]===""&&(Se="utf-8"),Se)try{const We=new TextDecoder(Se,{fatal:!0}),ot=j(Pe);return We.decode(ot)}catch(We){me(`stringToPDFString: "${We}".`)}}const Ee=[];for(let Se=0,We=Pe.length;Se<We;Se++){const ot=Ke[Pe.charCodeAt(Se)];Ee.push(ot?String.fromCharCode(ot):Pe.charAt(Se))}return Ee.join("")}function ft(Pe){return Pe.replace(/([()\\\n\r])/g,Ee=>Ee===`
`?"\\n":Ee==="\r"?"\\r":`\\${Ee}`)}function Je(Pe){return/^[\x00-\x7F]*$/.test(Pe)}function st(Pe){const Ee=[""];for(let Se=0,We=Pe.length;Se<We;Se++){const ot=Pe.charCodeAt(Se);Ee.push(String.fromCharCode(ot>>8&255),String.fromCharCode(ot&255))}return Ee.join("")}function dt(Pe){return decodeURIComponent(escape(Pe))}function nt(Pe){return unescape(encodeURIComponent(Pe))}function lt(Pe){return typeof Pe=="object"&&Pe!==null&&Pe.byteLength!==void 0}function or(Pe,Ee){if(Pe.length!==Ee.length)return!1;for(let Se=0,We=Pe.length;Se<We;Se++)if(Pe[Se]!==Ee[Se])return!1;return!0}function Wt(Pe=new Date){return[Pe.getUTCFullYear().toString(),(Pe.getUTCMonth()+1).toString().padStart(2,"0"),Pe.getUTCDate().toString().padStart(2,"0"),Pe.getUTCHours().toString().padStart(2,"0"),Pe.getUTCMinutes().toString().padStart(2,"0"),Pe.getUTCSeconds().toString().padStart(2,"0")].join("")}function Pt(){const Pe=Object.create(null);let Ee=!1;return Object.defineProperty(Pe,"settled",{get(){return Ee}}),Pe.promise=new Promise(function(Se,We){Pe.resolve=function(ot){Ee=!0,Se(ot)},Pe.reject=function(ot){Ee=!0,We(ot)}}),Pe}},(e,r,t)=>{t(3)},(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.isNodeJS=void 0;const t=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");r.isNodeJS=t},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var e,t,n,i,l,c,f,d,h,Bl,E,y;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(5),_display_utils=__w_pdfjs_require__(8),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:x,NodeCMapReaderFactory:g,NodeStandardFontDataFactory:m}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=x,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=g,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=m}let createPDFNetworkStream;function setPDFNetworkStreamFactory(x){createPDFNetworkStream=x}function getDocument(x){const g=new PDFDocumentLoadingTask;let m;if(typeof x=="string"||x instanceof URL)m={url:x};else if((0,_util.isArrayBuffer)(x))m={data:x};else if(x instanceof PDFDataRangeTransport)m={range:x};else{if(typeof x!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!x.url&&!x.data&&!x.range)throw new Error("Invalid parameter object: need either .data, .range or .url");m=x}const A=Object.create(null);let O=null,C=null;for(const T in m){const w=m[T];switch(T){case"url":if(typeof window<"u")try{A[T]=new URL(w,window.location).href;continue}catch(v){(0,_util.warn)(`Cannot create valid URL: "${v}".`)}else if(typeof w=="string"||w instanceof URL){A[T]=w.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":O=w;continue;case"worker":C=w;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&w instanceof Buffer)A[T]=new Uint8Array(w);else{if(w instanceof Uint8Array)break;if(typeof w=="string")A[T]=(0,_util.stringToBytes)(w);else if(typeof w=="object"&&w!==null&&!isNaN(w.length))A[T]=new Uint8Array(w);else if((0,_util.isArrayBuffer)(w))A[T]=new Uint8Array(w);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}A[T]=w}if(A.CMapReaderFactory=A.CMapReaderFactory||DefaultCMapReaderFactory,A.StandardFontDataFactory=A.StandardFontDataFactory||DefaultStandardFontDataFactory,A.ignoreErrors=A.stopAtErrors!==!0,A.fontExtraProperties=A.fontExtraProperties===!0,A.pdfBug=A.pdfBug===!0,A.enableXfa=A.enableXfa===!0,(!Number.isInteger(A.rangeChunkSize)||A.rangeChunkSize<1)&&(A.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof A.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(A.docBaseUrl))&&(A.docBaseUrl=null),(!Number.isInteger(A.maxImageSize)||A.maxImageSize<-1)&&(A.maxImageSize=-1),typeof A.cMapUrl!="string"&&(A.cMapUrl=null),typeof A.standardFontDataUrl!="string"&&(A.standardFontDataUrl=null),typeof A.useWorkerFetch!="boolean"&&(A.useWorkerFetch=A.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&A.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof A.isEvalSupported!="boolean"&&(A.isEvalSupported=!0),typeof A.disableFontFace!="boolean"&&(A.disableFontFace=_is_node.isNodeJS),typeof A.useSystemFonts!="boolean"&&(A.useSystemFonts=!_is_node.isNodeJS&&!A.disableFontFace),(typeof A.ownerDocument!="object"||A.ownerDocument===null)&&(A.ownerDocument=globalThis.document),typeof A.disableRange!="boolean"&&(A.disableRange=!1),typeof A.disableStream!="boolean"&&(A.disableStream=!1),typeof A.disableAutoFetch!="boolean"&&(A.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(A.verbosity),!C){const T={verbosity:A.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};C=T.port?PDFWorker.fromPort(T):new PDFWorker(T),g._worker=C}const R=g.docId;return C.promise.then(function(){if(g.destroyed)throw new Error("Loading aborted");const T=_fetchDocument(C,A,O,R),w=new Promise(function(v){let L;O?L=new _transport_stream.PDFDataTransportStream({length:A.length,initialData:A.initialData,progressiveDone:A.progressiveDone,contentDispositionFilename:A.contentDispositionFilename,disableRange:A.disableRange,disableStream:A.disableStream},O):A.data||(L=createPDFNetworkStream({url:A.url,length:A.length,httpHeaders:A.httpHeaders,withCredentials:A.withCredentials,rangeChunkSize:A.rangeChunkSize,disableRange:A.disableRange,disableStream:A.disableStream})),v(L)});return Promise.all([T,w]).then(function([v,L]){if(g.destroyed)throw new Error("Loading aborted");const M=new _message_handler.MessageHandler(R,v,C.port),X=new WorkerTransport(M,g,L,A);g._transport=X,M.send("Ready",null)})}).catch(g._capability.reject),g}async function _fetchDocument(x,g,m,A){if(x.destroyed)throw new Error("Worker was destroyed");m&&(g.length=m.length,g.initialData=m.initialData,g.progressiveDone=m.progressiveDone,g.contentDispositionFilename=m.contentDispositionFilename);const O=await x.messageHandler.sendWithPromise("GetDocRequest",{docId:A,apiVersion:"2.16.105",source:{data:g.data,url:g.url,password:g.password,disableAutoFetch:g.disableAutoFetch,rangeChunkSize:g.rangeChunkSize,length:g.length},maxImageSize:g.maxImageSize,disableFontFace:g.disableFontFace,docBaseUrl:g.docBaseUrl,ignoreErrors:g.ignoreErrors,isEvalSupported:g.isEvalSupported,fontExtraProperties:g.fontExtraProperties,enableXfa:g.enableXfa,useSystemFonts:g.useSystemFonts,cMapUrl:g.useWorkerFetch?g.cMapUrl:null,standardFontDataUrl:g.useWorkerFetch?g.standardFontDataUrl:null});if(g.data&&(g.data=null),x.destroyed)throw new Error("Worker was destroyed");return O}const r=class r{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${Il(r,e)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var g;this.destroyed=!0,await((g=this._transport)==null?void 0:g.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};e=new WeakMap,Ge(r,e,0);let PDFDocumentLoadingTask=r;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(g,m,A=!1,O=null){this.length=g,this.initialData=m,this.progressiveDone=A,this.contentDispositionFilename=O,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(g){this._rangeListeners.push(g)}addProgressListener(g){this._progressListeners.push(g)}addProgressiveReadListener(g){this._progressiveReadListeners.push(g)}addProgressiveDoneListener(g){this._progressiveDoneListeners.push(g)}onDataRange(g,m){for(const A of this._rangeListeners)A(g,m)}onDataProgress(g,m){this._readyCapability.promise.then(()=>{for(const A of this._progressListeners)A(g,m)})}onDataProgressiveRead(g){this._readyCapability.promise.then(()=>{for(const m of this._progressiveReadListeners)m(g)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const g of this._progressiveDoneListeners)g()})}transportReady(){this._readyCapability.resolve()}requestDataRange(g,m){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(g,m){this._pdfInfo=g,this._transport=m,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(g){return this._transport.getPage(g)}getPageIndex(g){return this._transport.getPageIndex(g)}getDestinations(){return this._transport.getDestinations()}getDestination(g){return this._transport.getDestination(g)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(g=!1){return this._transport.startCleanup(g||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(g,m,A,O,C=!1){this._pageIndex=g,this._pageInfo=m,this._ownerDocument=O,this._transport=A,this._stats=C?new _display_utils.StatTimer:null,this._pdfBug=C,this.commonObjs=A.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:g,rotation:m=this.rotate,offsetX:A=0,offsetY:O=0,dontFlip:C=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:g,rotation:m,offsetX:A,offsetY:O,dontFlip:C})}getAnnotations({intent:g="display"}={}){const m=this._transport.getRenderingIntent(g);let A=this._annotationPromises.get(m.cacheKey);return A||(A=this._transport.getAnnotations(this._pageIndex,m.renderingIntent),this._annotationPromises.set(m.cacheKey,A),A=A.then(O=>{for(const C of O)C.titleObj!==void 0&&Object.defineProperty(C,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),C.titleObj.str}}),C.contentsObj!==void 0&&Object.defineProperty(C,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),C.contentsObj.str}});return O})),A}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var g;return((g=this._transport._htmlForXfa)==null?void 0:g.children[this._pageIndex])||null}render({canvasContext:g,viewport:m,intent:A="display",annotationMode:O=_util.AnnotationMode.ENABLE,transform:C=null,imageLayer:R=null,canvasFactory:T=null,background:w=null,optionalContentConfigPromise:v=null,annotationCanvasMap:L=null,pageColors:M=null,printAnnotationStorage:X=null}){var ue,re;((ue=arguments[0])==null?void 0:ue.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&O===_util.AnnotationMode.ENABLE&&(O=_util.AnnotationMode.ENABLE_FORMS)),((re=arguments[0])==null?void 0:re.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&O===_util.AnnotationMode.ENABLE&&(O=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const H=this._transport.getRenderingIntent(A,O,X);this.pendingCleanup=!1,v||(v=this._transport.getOptionalContentConfig());let ne=this._intentStates.get(H.cacheKey);ne||(ne=Object.create(null),this._intentStates.set(H.cacheKey,ne)),ne.streamReaderCancelTimeout&&(clearTimeout(ne.streamReaderCancelTimeout),ne.streamReaderCancelTimeout=null);const _e=T||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),ge=!!(H.renderingIntent&_util.RenderingIntentFlag.PRINT);ne.displayReadyCapability||(ne.displayReadyCapability=(0,_util.createPromiseCapability)(),ne.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(H));const he=q=>{ne.renderTasks.delete(W),(this.cleanupAfterRender||ge)&&(this.pendingCleanup=!0),this._tryCleanup(),q?(W.capability.reject(q),this._abortOperatorList({intentState:ne,reason:q instanceof Error?q:new Error(q)})):W.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},W=new InternalRenderTask({callback:he,params:{canvasContext:g,viewport:m,transform:C,imageLayer:R,background:w},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:L,operatorList:ne.operatorList,pageIndex:this._pageIndex,canvasFactory:_e,useRequestAnimationFrame:!ge,pdfBug:this._pdfBug,pageColors:M});(ne.renderTasks||(ne.renderTasks=new Set)).add(W);const se=W.task;return Promise.all([ne.displayReadyCapability.promise,v]).then(([q,me])=>{if(this.pendingCleanup){he();return}this._stats&&this._stats.time("Rendering"),W.initializeGraphics({transparency:q,optionalContentConfig:me}),W.operatorListChanged()}).catch(he),se}getOperatorList({intent:g="display",annotationMode:m=_util.AnnotationMode.ENABLE,printAnnotationStorage:A=null}={}){function O(){R.operatorList.lastChunk&&(R.opListReadCapability.resolve(R.operatorList),R.renderTasks.delete(T))}const C=this._transport.getRenderingIntent(g,m,A,!0);let R=this._intentStates.get(C.cacheKey);R||(R=Object.create(null),this._intentStates.set(C.cacheKey,R));let T;return R.opListReadCapability||(T=Object.create(null),T.operatorListChanged=O,R.opListReadCapability=(0,_util.createPromiseCapability)(),(R.renderTasks||(R.renderTasks=new Set)).add(T),R.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(C)),R.opListReadCapability.promise}streamTextContent({disableCombineTextItems:g=!1,includeMarkedContent:m=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:g!==!0,includeMarkedContent:m===!0},{highWaterMark:100,size(O){return O.items.length}})}getTextContent(g={}){if(this._transport._htmlForXfa)return this.getXfa().then(A=>_xfa_text.XfaText.textContent(A));const m=this.streamTextContent(g);return new Promise(function(A,O){function C(){R.read().then(function({value:w,done:v}){if(v){A(T);return}Object.assign(T.styles,w.styles),T.items.push(...w.items),C()},O)}const R=m.getReader(),T={items:[],styles:Object.create(null)};C()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const g=[];for(const m of this._intentStates.values())if(this._abortOperatorList({intentState:m,reason:new Error("Page was destroyed."),force:!0}),!m.opListReadCapability)for(const A of m.renderTasks)g.push(A.completed),A.cancel();this.objs.clear();for(const m of this._bitmaps)m.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(g)}cleanup(g=!1){return this.pendingCleanup=!0,this._tryCleanup(g)}_tryCleanup(g=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:m,operatorList:A}of this._intentStates.values())if(m.size>0||!A.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,g&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const m of this._bitmaps)m.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(g,m){const A=this._intentStates.get(m);A&&(this._stats&&this._stats.timeEnd("Page Request"),A.displayReadyCapability&&A.displayReadyCapability.resolve(g))}_renderPageChunk(g,m){for(let A=0,O=g.length;A<O;A++)m.operatorList.fnArray.push(g.fnArray[A]),m.operatorList.argsArray.push(g.argsArray[A]);m.operatorList.lastChunk=g.lastChunk,m.operatorList.separateAnnots=g.separateAnnots;for(const A of m.renderTasks)A.operatorListChanged();g.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:g,cacheKey:m,annotationStorageMap:A}){const C=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:g,cacheKey:m,annotationStorage:A}).getReader(),R=this._intentStates.get(m);R.streamReader=C;const T=()=>{C.read().then(({value:w,done:v})=>{if(v){R.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(w,R),T())},w=>{if(R.streamReader=null,!this._transport.destroyed){if(R.operatorList){R.operatorList.lastChunk=!0;for(const v of R.renderTasks)v.operatorListChanged();this._tryCleanup()}if(R.displayReadyCapability)R.displayReadyCapability.reject(w);else if(R.opListReadCapability)R.opListReadCapability.reject(w);else throw w}})};T()}_abortOperatorList({intentState:g,reason:m,force:A=!1}){if(g.streamReader){if(!A){if(g.renderTasks.size>0)return;if(m instanceof _display_utils.RenderingCancelledException){g.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:g,reason:m,force:!0}),g.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(g.streamReader.cancel(new _util.AbortException(m.message)).catch(()=>{}),g.streamReader=null,!this._transport.destroyed){for(const[O,C]of this._intentStates)if(C===g){this._intentStates.delete(O);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(g,m){const A={data:structuredClone(g,m)};this._deferred.then(()=>{for(const O of this._listeners)O.call(this,A)})}addEventListener(g,m){this._listeners.push(m)}removeEventListener(g,m){const A=this._listeners.indexOf(m);this._listeners.splice(A,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const x=(t=document==null?void 0:document.currentScript)==null?void 0:t.src;x&&(PDFWorkerUtil.fallbackWorkerSrc=x.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(x,g){let m;try{if(m=new URL(x),!m.origin||m.origin==="null")return!1}catch{return!1}const A=new URL(g,m);return m.origin===A.origin},PDFWorkerUtil.createCDNWrapper=function(x){const g=`importScripts("${x}");`;return URL.createObjectURL(new Blob([g]))}}const _PDFWorker=class _PDFWorker{constructor({name:x=null,port:g=null,verbosity:m=(0,_util.getVerbosityLevel)()}={}){if(g&&oe(_PDFWorker,n).has(g))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=x,this.destroyed=!1,this.verbosity=m,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,g){oe(_PDFWorker,n).set(g,this),this._initializeFromPort(g);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(x){this._port=x,this._messageHandler=new _message_handler.MessageHandler("main","worker",x),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:x}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,x)||(x=PDFWorkerUtil.createCDNWrapper(new URL(x,window.location).href));const g=new Worker(x),m=new _message_handler.MessageHandler("main","worker",g),A=()=>{g.removeEventListener("error",O),m.destroy(),g.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},O=()=>{this._webWorker||A()};g.addEventListener("error",O),m.on("test",R=>{if(g.removeEventListener("error",O),this.destroyed){A();return}R?(this._messageHandler=m,this._port=g,this._webWorker=g,this._readyCapability.resolve(),m.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),m.destroy(),g.terminate())}),m.on("ready",R=>{if(g.removeEventListener("error",O),this.destroyed){A();return}try{C()}catch{this._setupFakeWorker()}});const C=()=>{const R=new Uint8Array;m.send("test",R,[R.buffer])};C();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(x=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const g=new LoopbackPort;this._port=g;const m=`fake${PDFWorkerUtil.fakeWorkerId++}`,A=new _message_handler.MessageHandler(m+"_worker",m,g);x.setup(A,g);const O=new _message_handler.MessageHandler(m,m+"_worker",g);this._messageHandler=O,this._readyCapability.resolve(),O.send("configure",{verbosity:this.verbosity})}).catch(x=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${x.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),oe(_PDFWorker,n).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(x){if(!(x!=null&&x.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return oe(this,n).has(x.port)?oe(this,n).get(x.port):new _PDFWorker(x)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var x;try{return((x=globalThis.pdfjsWorker)==null?void 0:x.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};n=new WeakMap,Ge(_PDFWorker,n,new WeakMap);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(g,m,A,O){Ge(this,i,null);Ge(this,l,new Map);Ge(this,c,new Map);Ge(this,f,null);this.messageHandler=g,this.loadingTask=m,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:m.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:O.ownerDocument,styleElement:O.styleElement}),this._params=O,O.useWorkerFetch||(this.CMapReaderFactory=new O.CMapReaderFactory({baseUrl:O.cMapUrl,isCompressed:O.cMapPacked}),this.StandardFontDataFactory=new O.StandardFontDataFactory({baseUrl:O.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=A,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return oe(this,i)}getRenderingIntent(g,m=_util.AnnotationMode.ENABLE,A=null,O=!1){let C=_util.RenderingIntentFlag.DISPLAY,R=null;switch(g){case"any":C=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":C=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${g}`)}switch(m){case _util.AnnotationMode.DISABLE:C+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:C+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:C+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,R=(C&_util.RenderingIntentFlag.PRINT&&A instanceof _annotation_storage.PrintAnnotationStorage?A:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${m}`)}return O&&(C+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:C,cacheKey:`${C}_${_annotation_storage.AnnotationStorage.getHash(R)}`,annotationStorageMap:R}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const g=[];for(const A of oe(this,l).values())g.push(A._destroy());oe(this,l).clear(),oe(this,c).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const m=this.messageHandler.sendWithPromise("Terminate",null);return g.push(m),Promise.all(g).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),qe(this,f,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:g,loadingTask:m}=this;g.on("GetReader",(A,O)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=C=>{this._lastProgress={loaded:C.loaded,total:C.total}},O.onPull=()=>{this._fullReader.read().then(function({value:C,done:R}){if(R){O.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(C),"GetReader - expected an ArrayBuffer."),O.enqueue(new Uint8Array(C),1,[C])}).catch(C=>{O.error(C)})},O.onCancel=C=>{this._fullReader.cancel(C),O.ready.catch(R=>{if(!this.destroyed)throw R})}}),g.on("ReaderHeadersReady",A=>{const O=(0,_util.createPromiseCapability)(),C=this._fullReader;return C.headersReady.then(()=>{var R;(!C.isStreamingSupported||!C.isRangeSupported)&&(this._lastProgress&&((R=m.onProgress)==null||R.call(m,this._lastProgress)),C.onProgress=T=>{var w;(w=m.onProgress)==null||w.call(m,{loaded:T.loaded,total:T.total})}),O.resolve({isStreamingSupported:C.isStreamingSupported,isRangeSupported:C.isRangeSupported,contentLength:C.contentLength})},O.reject),O.promise}),g.on("GetRangeReader",(A,O)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const C=this._networkStream.getRangeReader(A.begin,A.end);if(!C){O.close();return}O.onPull=()=>{C.read().then(function({value:R,done:T}){if(T){O.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(R),"GetRangeReader - expected an ArrayBuffer."),O.enqueue(new Uint8Array(R),1,[R])}).catch(R=>{O.error(R)})},O.onCancel=R=>{C.cancel(R),O.ready.catch(T=>{if(!this.destroyed)throw T})}}),g.on("GetDoc",({pdfInfo:A})=>{this._numPages=A.numPages,this._htmlForXfa=A.htmlForXfa,delete A.htmlForXfa,m._capability.resolve(new PDFDocumentProxy(A,this))}),g.on("DocException",function(A){let O;switch(A.name){case"PasswordException":O=new _util.PasswordException(A.message,A.code);break;case"InvalidPDFException":O=new _util.InvalidPDFException(A.message);break;case"MissingPDFException":O=new _util.MissingPDFException(A.message);break;case"UnexpectedResponseException":O=new _util.UnexpectedResponseException(A.message,A.status);break;case"UnknownErrorException":O=new _util.UnknownErrorException(A.message,A.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}m._capability.reject(O)}),g.on("PasswordRequest",A=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),m.onPassword){const O=C=>{C instanceof Error?this._passwordCapability.reject(C):this._passwordCapability.resolve({password:C})};try{m.onPassword(O,A.code)}catch(C){this._passwordCapability.reject(C)}}else this._passwordCapability.reject(new _util.PasswordException(A.message,A.code));return this._passwordCapability.promise}),g.on("DataLoaded",A=>{var O;(O=m.onProgress)==null||O.call(m,{loaded:A.length,total:A.length}),this.downloadInfoCapability.resolve(A)}),g.on("StartRenderPage",A=>{if(this.destroyed)return;oe(this,l).get(A.pageIndex)._startRenderPage(A.transparency,A.cacheKey)}),g.on("commonobj",([A,O,C])=>{var R;if(!this.destroyed&&!this.commonObjs.has(A))switch(O){case"Font":const T=this._params;if("error"in C){const L=C.error;(0,_util.warn)(`Error during font loading: ${L}`),this.commonObjs.resolve(A,L);break}let w=null;T.pdfBug&&((R=globalThis.FontInspector)!=null&&R.enabled)&&(w={registerFont(L,M){globalThis.FontInspector.fontAdded(L,M)}});const v=new _font_loader.FontFaceObject(C,{isEvalSupported:T.isEvalSupported,disableFontFace:T.disableFontFace,ignoreErrors:T.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:w});this.fontLoader.bind(v).catch(L=>g.sendWithPromise("FontFallback",{id:A})).finally(()=>{!T.fontExtraProperties&&v.data&&(v.data=null),this.commonObjs.resolve(A,v)});break;case"FontPath":case"Image":this.commonObjs.resolve(A,C);break;default:throw new Error(`Got unknown common object type ${O}`)}}),g.on("obj",([A,O,C,R])=>{var w;if(this.destroyed)return;const T=oe(this,l).get(O);if(!T.objs.has(A))switch(C){case"Image":T.objs.resolve(A,R);const v=8e6;if(R){let L;if(R.bitmap){const{bitmap:M,width:X,height:H}=R;L=X*H*4,T._bitmaps.add(M)}else L=((w=R.data)==null?void 0:w.length)||0;L>v&&(T.cleanupAfterRender=!0)}break;case"Pattern":T.objs.resolve(A,R);break;default:throw new Error(`Got unknown object type ${C}`)}}),g.on("DocProgress",A=>{var O;this.destroyed||(O=m.onProgress)==null||O.call(m,{loaded:A.loaded,total:A.total})}),g.on("DocStats",A=>{this.destroyed||qe(this,i,Object.freeze({streamTypes:Object.freeze(A.streamTypes),fontTypes:Object.freeze(A.fontTypes)}))}),g.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),g.on("FetchBuiltInCMap",A=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(A):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),g.on("FetchStandardFontData",A=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(A):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:g}){var m,A;this.destroyed||(A=(m=this.loadingTask).onUnsupportedFeature)==null||A.call(m,g)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(g){if(!Number.isInteger(g)||g<=0||g>this._numPages)return Promise.reject(new Error("Invalid page request."));const m=g-1,A=oe(this,c).get(m);if(A)return A;const O=this.messageHandler.sendWithPromise("GetPage",{pageIndex:m}).then(C=>{if(this.destroyed)throw new Error("Transport destroyed");const R=new PDFPageProxy(m,C,this,this._params.ownerDocument,this._params.pdfBug);return oe(this,l).set(m,R),R});return oe(this,c).set(m,O),O}getPageIndex(g){return typeof g!="object"||g===null||!Number.isInteger(g.num)||g.num<0||!Number.isInteger(g.gen)||g.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:g.num,gen:g.gen})}getAnnotations(g,m){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:g,intent:m})}saveDocument(){var g;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((g=this._fullReader)==null?void 0:g.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(g){return typeof g!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:g})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(g){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:g})}getStructTree(g){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:g})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(g=>new _optional_content_config.OptionalContentConfig(g))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return oe(this,f)||qe(this,f,this.messageHandler.sendWithPromise("GetMetadata",null).then(g=>{var m,A;return{info:g[0],metadata:g[1]?new _metadata.Metadata(g[1]):null,contentDispositionFilename:((m=this._fullReader)==null?void 0:m.filename)??null,contentLength:((A=this._fullReader)==null?void 0:A.contentLength)??null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(g=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const m of oe(this,l).values())if(!m.cleanup())throw new Error(`startCleanup: Page ${m.pageNumber} is currently rendering.`);this.commonObjs.clear(),g||this.fontLoader.clear(),qe(this,f,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const g=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:g.disableAutoFetch,enableXfa:g.enableXfa})}}i=new WeakMap,l=new WeakMap,c=new WeakMap,f=new WeakMap;class PDFObjects{constructor(){Ge(this,h);Ge(this,d,Object.create(null))}get(g,m=null){if(m){const O=Ue(this,h,Bl).call(this,g);return O.capability.promise.then(()=>m(O.data)),null}const A=oe(this,d)[g];if(!(A!=null&&A.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${g}.`);return A.data}has(g){const m=oe(this,d)[g];return(m==null?void 0:m.capability.settled)||!1}resolve(g,m=null){const A=Ue(this,h,Bl).call(this,g);A.data=m,A.capability.resolve()}clear(){qe(this,d,Object.create(null))}}d=new WeakMap,h=new WeakSet,Bl=function(g){const m=oe(this,d)[g];return m||(oe(this,d)[g]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(g){Ge(this,E,null);qe(this,E,g),this.onContinue=null}get promise(){return oe(this,E).capability.promise}cancel(){oe(this,E).cancel()}get separateAnnots(){const{separateAnnots:g}=oe(this,E).operatorList;if(!g)return!1;const{annotationCanvasMap:m}=oe(this,E);return g.form||g.canvas&&(m==null?void 0:m.size)>0}}E=new WeakMap,exports.RenderTask=RenderTask;const S=class S{constructor({callback:g,params:m,objs:A,commonObjs:O,annotationCanvasMap:C,operatorList:R,pageIndex:T,canvasFactory:w,useRequestAnimationFrame:v=!1,pdfBug:L=!1,pageColors:M=null}){this.callback=g,this.params=m,this.objs=A,this.commonObjs=O,this.annotationCanvasMap=C,this.operatorListIdx=null,this.operatorList=R,this._pageIndex=T,this.canvasFactory=w,this._pdfBug=L,this.pageColors=M,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=v===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=m.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:g=!1,optionalContentConfig:m}){var w;if(this.cancelled)return;if(this._canvas){if(oe(S,y).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");oe(S,y).add(this._canvas)}this._pdfBug&&((w=globalThis.StepperManager)!=null&&w.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:A,viewport:O,transform:C,imageLayer:R,background:T}=this.params;this.gfx=new _canvas.CanvasGraphics(A,this.commonObjs,this.objs,this.canvasFactory,R,m,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:C,viewport:O,transparency:g,background:T}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(g=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&oe(S,y).delete(this._canvas),this.callback(g||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&oe(S,y).delete(this._canvas),this.callback())))}};y=new WeakMap,Ge(S,y,new WeakSet);let InternalRenderTask=S;const version="2.16.105";exports.version=version;const build="172ccdbe5";exports.build=build},(e,r,t)=>{var d,Th,p;Object.defineProperty(r,"__esModule",{value:!0}),r.PrintAnnotationStorage=r.AnnotationStorage=void 0;var n=t(1),i=t(6),l=t(10);class c{constructor(){Ge(this,d);this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(y,S){const x=this._storage.get(y);return x===void 0?S:Object.assign(S,x)}getRawValue(y){return this._storage.get(y)}remove(y){if(this._storage.delete(y),this._storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const S of this._storage.values())if(S instanceof i.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(y,S){const x=this._storage.get(y);let g=!1;if(x!==void 0)for(const[m,A]of Object.entries(S))x[m]!==A&&(g=!0,x[m]=A);else g=!0,this._storage.set(y,S);g&&Ue(this,d,Th).call(this),S instanceof i.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(S.constructor._type)}has(y){return this._storage.has(y)}getAll(){return this._storage.size>0?(0,n.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new f(this)}get serializable(){if(this._storage.size===0)return null;const y=new Map;for(const[S,x]of this._storage){const g=x instanceof i.AnnotationEditor?x.serialize():x;g&&y.set(S,g)}return y}static getHash(y){if(!y)return"";const S=new l.MurmurHash3_64;for(const[x,g]of y)S.update(`${x}:${JSON.stringify(g)}`);return S.hexdigest()}}d=new WeakSet,Th=function(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())},r.AnnotationStorage=c;class f extends c{constructor(S){super();Ge(this,p,null);qe(this,p,structuredClone(S.serializable))}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return oe(this,p)}}p=new WeakMap,r.PrintAnnotationStorage=f},(e,r,t)=>{var c,f,d,h,p,E;Object.defineProperty(r,"__esModule",{value:!0}),r.AnnotationEditor=void 0;var n=t(7),i=t(1);const y=class y{constructor(x){Ge(this,c,this.focusin.bind(this));Ge(this,f,this.focusout.bind(this));Ge(this,d,!1);Ge(this,h,!1);Ge(this,p,!1);Ge(this,E,y._zIndex++);this.constructor===y&&(0,i.unreachable)("Cannot initialize AnnotationEditor."),this.parent=x.parent,this.id=x.id,this.width=this.height=null,this.pageIndex=x.parent.pageIndex,this.name=x.name,this.div=null;const[g,m]=this.parent.viewportBaseDimensions;this.x=x.x/g,this.y=x.y/m,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,i.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=oe(this,E)}focusin(x){oe(this,d)?qe(this,d,!1):this.parent.setSelected(this)}focusout(x){if(!this.isAttachedToDOM)return;const g=x.relatedTarget;g!=null&&g.closest(`#${this.id}`)||(x.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(x){const g=this.parent.div.getBoundingClientRect();this.startX=x.clientX-g.x,this.startY=x.clientY-g.y,x.dataTransfer.setData("text/plain",this.id),x.dataTransfer.effectAllowed="move"}setAt(x,g,m,A){const[O,C]=this.parent.viewportBaseDimensions;[m,A]=this.screenToPageTranslation(m,A),this.x=(x+m)/O,this.y=(g+A)/C,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(x,g){const[m,A]=this.parent.viewportBaseDimensions;[x,g]=this.screenToPageTranslation(x,g),this.x+=x/m,this.y+=g/A,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(x,g){const{rotation:m}=this.parent.viewport;switch(m){case 90:return[g,-x];case 180:return[-x,-g];case 270:return[-g,x];default:return[x,g]}}setDims(x,g){const[m,A]=this.parent.viewportBaseDimensions;this.div.style.width=`${100*x/m}%`,this.div.style.height=`${100*g/A}%`}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",oe(this,c)),this.div.addEventListener("focusout",oe(this,f));const[x,g]=this.getInitialTranslation();return this.translate(x,g),(0,n.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(x){const g=n.KeyboardManager.platform.isMac;if(x.button!==0||x.ctrlKey&&g){x.preventDefault();return}x.ctrlKey&&!g||x.shiftKey||x.metaKey&&g?this.parent.toggleSelected(this):this.parent.setSelected(this),qe(this,d,!0)}getRect(x,g){const[m,A]=this.parent.viewportBaseDimensions,[O,C]=this.parent.pageDimensions,R=O*x/m,T=C*g/A,w=this.x*O,v=this.y*C,L=this.width*O,M=this.height*C;switch(this.rotation){case 0:return[w+R,C-v-T-M,w+R+L,C-v-T];case 90:return[w+T,C-v+R,w+T+M,C-v+R+L];case 180:return[w-R-L,C-v+T,w-R,C-v+T+M];case 270:return[w-T-M,C-v-R-L,w-T,C-v-R];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(x,g){const[m,A,O,C]=x,R=O-m,T=C-A;switch(this.rotation){case 0:return[m,g-C,R,T];case 90:return[m,g-A,T,R];case 180:return[O,g-A,R,T];case 270:return[O,g-C,T,R];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){qe(this,p,!0)}disableEditMode(){qe(this,p,!1)}isInEditMode(){return oe(this,p)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var x;(x=this.div)==null||x.addEventListener("focusin",oe(this,c))}serialize(){(0,i.unreachable)("An editor must be serializable")}static deserialize(x,g){const m=new this.prototype.constructor({parent:g,id:g.getNextId()});m.rotation=x.rotation;const[A,O]=g.pageDimensions,[C,R,T,w]=m.getRectInCurrentCoords(x.rect,O);return m.x=C/A,m.y=R/O,m.width=T/A,m.height=w/O,m}remove(){this.div.removeEventListener("focusin",oe(this,c)),this.div.removeEventListener("focusout",oe(this,f)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var x;(x=this.div)==null||x.classList.add("selectedEditor")}unselect(){var x;(x=this.div)==null||x.classList.remove("selectedEditor")}updateParams(x,g){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return oe(this,h)}set isEditing(x){qe(this,h,x),x?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};c=new WeakMap,f=new WeakMap,d=new WeakMap,h=new WeakMap,p=new WeakMap,E=new WeakMap,Bt(y,"_colorManager",new n.ColorManager),Bt(y,"_zIndex",1);let l=y;r.AnnotationEditor=l},(e,r,t)=>{var S,x,g,m,A,O,wh,T,v,L,M,X,H,ne,_e,ge,he,W,se,ue,re,q,me,N,P,k,Ch,Ul,dr,ys,kh,Rh,jl,Es,ki;Object.defineProperty(r,"__esModule",{value:!0}),r.KeyboardManager=r.CommandManager=r.ColorManager=r.AnnotationEditorUIManager=void 0,r.bindEvents=l,r.opacityToHex=c;var n=t(1),i=t(8);function l(te,j,J){for(const Ae of J)j.addEventListener(Ae,te[Ae].bind(te))}function c(te){return Math.round(Math.min(255,Math.max(1,255*te))).toString(16).padStart(2,"0")}class f{constructor(){Ge(this,S,0)}getId(){return`${n.AnnotationEditorPrefix}${Il(this,S)._++}`}}S=new WeakMap;class d{constructor(j=128){Ge(this,x,[]);Ge(this,g,!1);Ge(this,m);Ge(this,A,-1);qe(this,m,j)}add({cmd:j,undo:J,mustExec:Ae,type:pe=NaN,overwriteIfSameType:ve=!1,keepUndo:Te=!1}){if(Ae&&j(),oe(this,g))return;const Me={cmd:j,undo:J,type:pe};if(oe(this,A)===-1){oe(this,x).length>0&&(oe(this,x).length=0),qe(this,A,0),oe(this,x).push(Me);return}if(ve&&oe(this,x)[oe(this,A)].type===pe){Te&&(Me.undo=oe(this,x)[oe(this,A)].undo),oe(this,x)[oe(this,A)]=Me;return}const ze=oe(this,A)+1;ze===oe(this,m)?oe(this,x).splice(0,1):(qe(this,A,ze),ze<oe(this,x).length&&oe(this,x).splice(ze)),oe(this,x).push(Me)}undo(){oe(this,A)!==-1&&(qe(this,g,!0),oe(this,x)[oe(this,A)].undo(),qe(this,g,!1),qe(this,A,oe(this,A)-1))}redo(){oe(this,A)<oe(this,x).length-1&&(qe(this,A,oe(this,A)+1),qe(this,g,!0),oe(this,x)[oe(this,A)].cmd(),qe(this,g,!1))}hasSomethingToUndo(){return oe(this,A)!==-1}hasSomethingToRedo(){return oe(this,A)<oe(this,x).length-1}destroy(){qe(this,x,null)}}x=new WeakMap,g=new WeakMap,m=new WeakMap,A=new WeakMap,r.CommandManager=d;const R=class R{constructor(j){Ge(this,O);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const J=R.platform.isMac;for(const[Ae,pe]of j)for(const ve of Ae){const Te=ve.startsWith("mac+");J&&Te?(this.callbacks.set(ve.slice(4),pe),this.allKeys.add(ve.split("+").at(-1))):!J&&!Te&&(this.callbacks.set(ve,pe),this.allKeys.add(ve.split("+").at(-1)))}}static get platform(){const j=typeof navigator<"u"?navigator.platform:"";return(0,n.shadow)(this,"platform",{isWin:j.includes("Win"),isMac:j.includes("Mac")})}exec(j,J){if(!this.allKeys.has(J.key))return;const Ae=this.callbacks.get(Ue(this,O,wh).call(this,J));Ae&&(Ae.bind(j)(),J.stopPropagation(),J.preventDefault())}};O=new WeakSet,wh=function(j){j.altKey&&this.buffer.push("alt"),j.ctrlKey&&this.buffer.push("ctrl"),j.metaKey&&this.buffer.push("meta"),j.shiftKey&&this.buffer.push("shift"),this.buffer.push(j.key);const J=this.buffer.join("+");return this.buffer.length=0,J};let h=R;r.KeyboardManager=h;class p{constructor(){Ge(this,T,null)}copy(j){j&&(Array.isArray(j)?qe(this,T,j.map(J=>J.serialize())):qe(this,T,[j.serialize()]),qe(this,T,oe(this,T).filter(J=>!!J)),oe(this,T).length===0&&qe(this,T,null))}paste(){return oe(this,T)}isEmpty(){return oe(this,T)===null}destroy(){qe(this,T,null)}}T=new WeakMap;const w=class w{get _colors(){const j=new Map([["CanvasText",null],["Canvas",null]]);return(0,i.getColorValues)(j),(0,n.shadow)(this,"_colors",j)}convert(j){const J=(0,i.getRGB)(j);if(!window.matchMedia("(forced-colors: active)").matches)return J;for(const[Ae,pe]of this._colors)if(pe.every((ve,Te)=>ve===J[Te]))return w._colorsMapping.get(Ae);return J}getHexCode(j){const J=this._colors.get(j);return J?n.Util.makeHexColor(...J):j}};Bt(w,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let E=w;r.ColorManager=E;const ie=class ie{constructor(j,J){Ge(this,k);Ge(this,v,null);Ge(this,L,new Map);Ge(this,M,new Map);Ge(this,X,new p);Ge(this,H,new d);Ge(this,ne,0);Ge(this,_e,null);Ge(this,ge,null);Ge(this,he,new f);Ge(this,W,!1);Ge(this,se,n.AnnotationEditorType.NONE);Ge(this,ue,new Set);Ge(this,re,this.keydown.bind(this));Ge(this,q,this.onEditingAction.bind(this));Ge(this,me,this.onPageChanging.bind(this));Ge(this,N,{isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});Ge(this,P,null);qe(this,P,j),qe(this,ge,J),oe(this,ge)._on("editingaction",oe(this,q)),oe(this,ge)._on("pagechanging",oe(this,me))}destroy(){Ue(this,k,Ul).call(this),oe(this,ge)._off("editingaction",oe(this,q)),oe(this,ge)._off("pagechanging",oe(this,me));for(const j of oe(this,M).values())j.destroy();oe(this,M).clear(),oe(this,L).clear(),qe(this,v,null),oe(this,ue).clear(),oe(this,X).destroy(),oe(this,H).destroy()}onPageChanging({pageNumber:j}){qe(this,ne,j-1)}focusMainContainer(){oe(this,P).focus()}keydown(j){var J;(J=this.getActive())!=null&&J.shouldGetKeyboardEvents()||ie._keyboardManager.exec(this,j)}onEditingAction(j){["undo","redo","cut","copy","paste","delete","selectAll"].includes(j.name)&&this[j.name]()}setEditingState(j){j?(Ue(this,k,Ch).call(this),Ue(this,k,dr).call(this,{isEditing:oe(this,se)!==n.AnnotationEditorType.NONE,isEmpty:Ue(this,k,Es).call(this),hasSomethingToUndo:oe(this,H).hasSomethingToUndo(),hasSomethingToRedo:oe(this,H).hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:oe(this,X).isEmpty()})):(Ue(this,k,Ul).call(this),Ue(this,k,dr).call(this,{isEditing:!1}))}registerEditorTypes(j){qe(this,_e,j);for(const J of oe(this,_e))Ue(this,k,ys).call(this,J.defaultPropertiesToUpdate)}getId(){return oe(this,he).getId()}addLayer(j){oe(this,M).set(j.pageIndex,j),oe(this,W)?j.enable():j.disable()}removeLayer(j){oe(this,M).delete(j.pageIndex)}updateMode(j){if(qe(this,se,j),j===n.AnnotationEditorType.NONE)this.setEditingState(!1),Ue(this,k,Rh).call(this);else{this.setEditingState(!0),Ue(this,k,kh).call(this);for(const J of oe(this,M).values())J.updateMode(j)}}updateToolbar(j){j!==oe(this,se)&&oe(this,ge).dispatch("switchannotationeditormode",{source:this,mode:j})}updateParams(j,J){for(const Ae of oe(this,ue))Ae.updateParams(j,J);for(const Ae of oe(this,_e))Ae.updateDefaultParams(j,J)}getEditors(j){const J=[];for(const Ae of oe(this,L).values())Ae.pageIndex===j&&J.push(Ae);return J}getEditor(j){return oe(this,L).get(j)}addEditor(j){oe(this,L).set(j.id,j)}removeEditor(j){oe(this,L).delete(j.id),this.unselect(j)}setActiveEditor(j){oe(this,v)!==j&&(qe(this,v,j),j&&Ue(this,k,ys).call(this,j.propertiesToUpdate))}toggleSelected(j){if(oe(this,ue).has(j)){oe(this,ue).delete(j),j.unselect(),Ue(this,k,dr).call(this,{hasSelectedEditor:this.hasSelection});return}oe(this,ue).add(j),j.select(),Ue(this,k,ys).call(this,j.propertiesToUpdate),Ue(this,k,dr).call(this,{hasSelectedEditor:!0})}setSelected(j){for(const J of oe(this,ue))J!==j&&J.unselect();oe(this,ue).clear(),oe(this,ue).add(j),j.select(),Ue(this,k,ys).call(this,j.propertiesToUpdate),Ue(this,k,dr).call(this,{hasSelectedEditor:!0})}isSelected(j){return oe(this,ue).has(j)}unselect(j){j.unselect(),oe(this,ue).delete(j),Ue(this,k,dr).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return oe(this,ue).size!==0}undo(){oe(this,H).undo(),Ue(this,k,dr).call(this,{hasSomethingToUndo:oe(this,H).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:Ue(this,k,Es).call(this)})}redo(){oe(this,H).redo(),Ue(this,k,dr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:oe(this,H).hasSomethingToRedo(),isEmpty:Ue(this,k,Es).call(this)})}addCommands(j){oe(this,H).add(j),Ue(this,k,dr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:Ue(this,k,Es).call(this)})}delete(){if(oe(this,v)&&oe(this,v).commitOrRemove(),!this.hasSelection)return;const j=[...oe(this,ue)],J=()=>{for(const pe of j)pe.remove()},Ae=()=>{for(const pe of j)Ue(this,k,jl).call(this,pe)};this.addCommands({cmd:J,undo:Ae,mustExec:!0})}copy(){if(oe(this,v)&&oe(this,v).commitOrRemove(),this.hasSelection){const j=[];for(const J of oe(this,ue))J.isEmpty()||j.push(J);if(j.length===0)return;oe(this,X).copy(j),Ue(this,k,dr).call(this,{hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(oe(this,X).isEmpty())return;this.unselectAll();const j=oe(this,M).get(oe(this,ne)),J=oe(this,X).paste().map(ve=>j.deserialize(ve)),Ae=()=>{for(const ve of J)Ue(this,k,jl).call(this,ve);Ue(this,k,ki).call(this,J)},pe=()=>{for(const ve of J)ve.remove()};this.addCommands({cmd:Ae,undo:pe,mustExec:!0})}selectAll(){for(const j of oe(this,ue))j.commit();Ue(this,k,ki).call(this,oe(this,L).values())}unselectAll(){if(oe(this,v)){oe(this,v).commitOrRemove();return}if(Ue(this,k,ki).size!==0){for(const j of oe(this,ue))j.unselect();oe(this,ue).clear(),Ue(this,k,dr).call(this,{hasSelectedEditor:!1})}}isActive(j){return oe(this,v)===j}getActive(){return oe(this,v)}getMode(){return oe(this,se)}};v=new WeakMap,L=new WeakMap,M=new WeakMap,X=new WeakMap,H=new WeakMap,ne=new WeakMap,_e=new WeakMap,ge=new WeakMap,he=new WeakMap,W=new WeakMap,se=new WeakMap,ue=new WeakMap,re=new WeakMap,q=new WeakMap,me=new WeakMap,N=new WeakMap,P=new WeakMap,k=new WeakSet,Ch=function(){oe(this,P).addEventListener("keydown",oe(this,re))},Ul=function(){oe(this,P).removeEventListener("keydown",oe(this,re))},dr=function(j){Object.entries(j).some(([Ae,pe])=>oe(this,N)[Ae]!==pe)&&oe(this,ge).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(oe(this,N),j)})},ys=function(j){oe(this,ge).dispatch("annotationeditorparamschanged",{source:this,details:j})},kh=function(){if(!oe(this,W)){qe(this,W,!0);for(const j of oe(this,M).values())j.enable()}},Rh=function(){if(this.unselectAll(),oe(this,W)){qe(this,W,!1);for(const j of oe(this,M).values())j.disable()}},jl=function(j){const J=oe(this,M).get(j.pageIndex);J?J.addOrRebuild(j):this.addEditor(j)},Es=function(){if(oe(this,L).size===0)return!0;if(oe(this,L).size===1)for(const j of oe(this,L).values())return j.isEmpty();return!1},ki=function(j){oe(this,ue).clear();for(const J of j)J.isEmpty()||(oe(this,ue).add(J),J.select());Ue(this,k,dr).call(this,{hasSelectedEditor:!0})},Bt(ie,"_keyboardManager",new h([[["ctrl+a","mac+meta+a"],ie.prototype.selectAll],[["ctrl+c","mac+meta+c"],ie.prototype.copy],[["ctrl+v","mac+meta+v"],ie.prototype.paste],[["ctrl+x","mac+meta+x"],ie.prototype.cut],[["ctrl+z","mac+meta+z"],ie.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],ie.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],ie.prototype.delete],[["Escape","mac+Escape"],ie.prototype.unselectAll]]));let y=ie;r.AnnotationEditorUIManager=y},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.StatTimer=r.RenderingCancelledException=r.PixelsPerInch=r.PageViewport=r.PDFDateString=r.DOMStandardFontDataFactory=r.DOMSVGFactory=r.DOMCanvasFactory=r.DOMCMapReaderFactory=r.AnnotationPrefix=void 0,r.deprecated=w,r.getColorValues=H,r.getCurrentTransform=ne,r.getCurrentTransformInverse=_e,r.getFilenameFromUrl=A,r.getPdfFilenameFromUrl=O,r.getRGB=X,r.getXfaPageViewport=M,r.isDataScheme=g,r.isPdfFile=m,r.isValidFetchUrl=R,r.loadScript=T;var n=t(9),i=t(1);const l="http://www.w3.org/2000/svg",c="pdfjs_internal_id_";r.AnnotationPrefix=c;const ge=class ge{};Bt(ge,"CSS",96),Bt(ge,"PDF",72),Bt(ge,"PDF_TO_CSS_UNITS",ge.CSS/ge.PDF);let f=ge;r.PixelsPerInch=f;class d extends n.BaseCanvasFactory{constructor({ownerDocument:W=globalThis.document}={}){super(),this._document=W}_createCanvas(W,se){const ue=this._document.createElement("canvas");return ue.width=W,ue.height=se,ue}}r.DOMCanvasFactory=d;async function h(he,W=!1){if(R(he,document.baseURI)){const se=await fetch(he);if(!se.ok)throw new Error(se.statusText);return W?new Uint8Array(await se.arrayBuffer()):(0,i.stringToBytes)(await se.text())}return new Promise((se,ue)=>{const re=new XMLHttpRequest;re.open("GET",he,!0),W&&(re.responseType="arraybuffer"),re.onreadystatechange=()=>{if(re.readyState===XMLHttpRequest.DONE){if(re.status===200||re.status===0){let q;if(W&&re.response?q=new Uint8Array(re.response):!W&&re.responseText&&(q=(0,i.stringToBytes)(re.responseText)),q){se(q);return}}ue(new Error(re.statusText))}},re.send(null)})}class p extends n.BaseCMapReaderFactory{_fetchData(W,se){return h(W,this.isCompressed).then(ue=>({cMapData:ue,compressionType:se}))}}r.DOMCMapReaderFactory=p;class E extends n.BaseStandardFontDataFactory{_fetchData(W){return h(W,!0)}}r.DOMStandardFontDataFactory=E;class y extends n.BaseSVGFactory{_createSVG(W){return document.createElementNS(l,W)}}r.DOMSVGFactory=y;class S{constructor({viewBox:W,scale:se,rotation:ue,offsetX:re=0,offsetY:q=0,dontFlip:me=!1}){this.viewBox=W,this.scale=se,this.rotation=ue,this.offsetX=re,this.offsetY=q;const N=(W[2]+W[0])/2,P=(W[3]+W[1])/2;let k,B,z,Q;switch(ue%=360,ue<0&&(ue+=360),ue){case 180:k=-1,B=0,z=0,Q=1;break;case 90:k=0,B=1,z=1,Q=0;break;case 270:k=0,B=-1,z=-1,Q=0;break;case 0:k=1,B=0,z=0,Q=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}me&&(z=-z,Q=-Q);let K,F,I,V;k===0?(K=Math.abs(P-W[1])*se+re,F=Math.abs(N-W[0])*se+q,I=Math.abs(W[3]-W[1])*se,V=Math.abs(W[2]-W[0])*se):(K=Math.abs(N-W[0])*se+re,F=Math.abs(P-W[1])*se+q,I=Math.abs(W[2]-W[0])*se,V=Math.abs(W[3]-W[1])*se),this.transform=[k*se,B*se,z*se,Q*se,K-k*se*N-z*se*P,F-B*se*N-Q*se*P],this.width=I,this.height=V}clone({scale:W=this.scale,rotation:se=this.rotation,offsetX:ue=this.offsetX,offsetY:re=this.offsetY,dontFlip:q=!1}={}){return new S({viewBox:this.viewBox.slice(),scale:W,rotation:se,offsetX:ue,offsetY:re,dontFlip:q})}convertToViewportPoint(W,se){return i.Util.applyTransform([W,se],this.transform)}convertToViewportRectangle(W){const se=i.Util.applyTransform([W[0],W[1]],this.transform),ue=i.Util.applyTransform([W[2],W[3]],this.transform);return[se[0],se[1],ue[0],ue[1]]}convertToPdfPoint(W,se){return i.Util.applyInverseTransform([W,se],this.transform)}}r.PageViewport=S;class x extends i.BaseException{constructor(W,se){super(W,"RenderingCancelledException"),this.type=se}}r.RenderingCancelledException=x;function g(he){const W=he.length;let se=0;for(;se<W&&he[se].trim()==="";)se++;return he.substring(se,se+5).toLowerCase()==="data:"}function m(he){return typeof he=="string"&&/\.pdf$/i.test(he)}function A(he){const W=he.indexOf("#"),se=he.indexOf("?"),ue=Math.min(W>0?W:he.length,se>0?se:he.length);return he.substring(he.lastIndexOf("/",ue)+1,ue)}function O(he,W="document.pdf"){if(typeof he!="string")return W;if(g(he))return(0,i.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),W;const se=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,ue=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,re=se.exec(he);let q=ue.exec(re[1])||ue.exec(re[2])||ue.exec(re[3]);if(q&&(q=q[0],q.includes("%")))try{q=ue.exec(decodeURIComponent(q))[0]}catch{}return q||W}class C{constructor(){this.started=Object.create(null),this.times=[]}time(W){W in this.started&&(0,i.warn)(`Timer is already running for ${W}`),this.started[W]=Date.now()}timeEnd(W){W in this.started||(0,i.warn)(`Timer has not been started for ${W}`),this.times.push({name:W,start:this.started[W],end:Date.now()}),delete this.started[W]}toString(){const W=[];let se=0;for(const ue of this.times){const re=ue.name;re.length>se&&(se=re.length)}for(const ue of this.times){const re=ue.end-ue.start;W.push(`${ue.name.padEnd(se)} ${re}ms
`)}return W.join("")}}r.StatTimer=C;function R(he,W){try{const{protocol:se}=W?new URL(he,W):new URL(he);return se==="http:"||se==="https:"}catch{return!1}}function T(he,W=!1){return new Promise((se,ue)=>{const re=document.createElement("script");re.src=he,re.onload=function(q){W&&re.remove(),se(q)},re.onerror=function(){ue(new Error(`Cannot load script at: ${re.src}`))},(document.head||document.documentElement).append(re)})}function w(he){console.log("Deprecated API usage: "+he)}let v;class L{static toDateObject(W){if(!W||typeof W!="string")return null;v||(v=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const se=v.exec(W);if(!se)return null;const ue=parseInt(se[1],10);let re=parseInt(se[2],10);re=re>=1&&re<=12?re-1:0;let q=parseInt(se[3],10);q=q>=1&&q<=31?q:1;let me=parseInt(se[4],10);me=me>=0&&me<=23?me:0;let N=parseInt(se[5],10);N=N>=0&&N<=59?N:0;let P=parseInt(se[6],10);P=P>=0&&P<=59?P:0;const k=se[7]||"Z";let B=parseInt(se[8],10);B=B>=0&&B<=23?B:0;let z=parseInt(se[9],10)||0;return z=z>=0&&z<=59?z:0,k==="-"?(me+=B,N+=z):k==="+"&&(me-=B,N-=z),new Date(Date.UTC(ue,re,q,me,N,P))}}r.PDFDateString=L;function M(he,{scale:W=1,rotation:se=0}){const{width:ue,height:re}=he.attributes.style,q=[0,0,parseInt(ue),parseInt(re)];return new S({viewBox:q,scale:W,rotation:se})}function X(he){if(he.startsWith("#")){const W=parseInt(he.slice(1),16);return[(W&16711680)>>16,(W&65280)>>8,W&255]}return he.startsWith("rgb(")?he.slice(4,-1).split(",").map(W=>parseInt(W)):he.startsWith("rgba(")?he.slice(5,-1).split(",").map(W=>parseInt(W)).slice(0,3):((0,i.warn)(`Not a valid color format: "${he}"`),[0,0,0])}function H(he){const W=document.createElement("span");W.style.visibility="hidden",document.body.append(W);for(const se of he.keys()){W.style.color=se;const ue=window.getComputedStyle(W).color;he.set(se,X(ue))}W.remove()}function ne(he){const{a:W,b:se,c:ue,d:re,e:q,f:me}=he.getTransform();return[W,se,ue,re,q,me]}function _e(he){const{a:W,b:se,c:ue,d:re,e:q,f:me}=he.getTransform().invertSelf();return[W,se,ue,re,q,me]}},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.BaseStandardFontDataFactory=r.BaseSVGFactory=r.BaseCanvasFactory=r.BaseCMapReaderFactory=void 0;var n=t(1);class i{constructor(){this.constructor===i&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(h,p){if(h<=0||p<=0)throw new Error("Invalid canvas size");const E=this._createCanvas(h,p);return{canvas:E,context:E.getContext("2d")}}reset(h,p,E){if(!h.canvas)throw new Error("Canvas is not specified");if(p<=0||E<=0)throw new Error("Invalid canvas size");h.canvas.width=p,h.canvas.height=E}destroy(h){if(!h.canvas)throw new Error("Canvas is not specified");h.canvas.width=0,h.canvas.height=0,h.canvas=null,h.context=null}_createCanvas(h,p){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}r.BaseCanvasFactory=i;class l{constructor({baseUrl:h=null,isCompressed:p=!1}){this.constructor===l&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=h,this.isCompressed=p}async fetch({name:h}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!h)throw new Error("CMap name must be specified.");const p=this.baseUrl+h+(this.isCompressed?".bcmap":""),E=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(p,E).catch(y=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${p}`)})}_fetchData(h,p){(0,n.unreachable)("Abstract method `_fetchData` called.")}}r.BaseCMapReaderFactory=l;class c{constructor({baseUrl:h=null}){this.constructor===c&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=h}async fetch({filename:h}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!h)throw new Error("Font filename must be specified.");const p=`${this.baseUrl}${h}`;return this._fetchData(p).catch(E=>{throw new Error(`Unable to load font data at: ${p}`)})}_fetchData(h){(0,n.unreachable)("Abstract method `_fetchData` called.")}}r.BaseStandardFontDataFactory=c;class f{constructor(){this.constructor===f&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(h,p,E=!1){if(h<=0||p<=0)throw new Error("Invalid SVG dimensions");const y=this._createSVG("svg:svg");return y.setAttribute("version","1.1"),E||(y.setAttribute("width",`${h}px`),y.setAttribute("height",`${p}px`)),y.setAttribute("preserveAspectRatio","none"),y.setAttribute("viewBox",`0 0 ${h} ${p}`),y}createElement(h){if(typeof h!="string")throw new Error("Invalid SVG element type");return this._createSVG(h)}_createSVG(h){(0,n.unreachable)("Abstract method `_createSVG` called.")}}r.BaseSVGFactory=f},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.MurmurHash3_64=void 0;var n=t(1);const i=3285377520,l=4294901760,c=65535;class f{constructor(h){this.h1=h?h&4294967295:i,this.h2=h?h&4294967295:i}update(h){let p,E;if(typeof h=="string"){p=new Uint8Array(h.length*2),E=0;for(let v=0,L=h.length;v<L;v++){const M=h.charCodeAt(v);M<=255?p[E++]=M:(p[E++]=M>>>8,p[E++]=M&255)}}else if((0,n.isArrayBuffer)(h))p=h.slice(),E=p.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const y=E>>2,S=E-y*4,x=new Uint32Array(p.buffer,0,y);let g=0,m=0,A=this.h1,O=this.h2;const C=3432918353,R=461845907,T=C&c,w=R&c;for(let v=0;v<y;v++)v&1?(g=x[v],g=g*C&l|g*T&c,g=g<<15|g>>>17,g=g*R&l|g*w&c,A^=g,A=A<<13|A>>>19,A=A*5+3864292196):(m=x[v],m=m*C&l|m*T&c,m=m<<15|m>>>17,m=m*R&l|m*w&c,O^=m,O=O<<13|O>>>19,O=O*5+3864292196);switch(g=0,S){case 3:g^=p[y*4+2]<<16;case 2:g^=p[y*4+1]<<8;case 1:g^=p[y*4],g=g*C&l|g*T&c,g=g<<15|g>>>17,g=g*R&l|g*w&c,y&1?A^=g:O^=g}this.h1=A,this.h2=O}hexdigest(){let h=this.h1,p=this.h2;h^=p>>>1,h=h*3981806797&l|h*36045&c,p=p*4283543511&l|((p<<16|h>>>16)*2950163797&l)>>>16,h^=p>>>1,h=h*444984403&l|h*60499&c,p=p*3301882366&l|((p<<16|h>>>16)*3120437893&l)>>>16,h^=p>>>1;const E=(h>>>0).toString(16),y=(p>>>0).toString(16);return E.padStart(8,"0")+y.padStart(8,"0")}}r.MurmurHash3_64=f},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.FontLoader=r.FontFaceObject=void 0;var n=t(1);class i{constructor({docId:d,onUnsupportedFeature:h,ownerDocument:p=globalThis.document,styleElement:E=null}){this.constructor===i&&(0,n.unreachable)("Cannot initialize BaseFontLoader."),this.docId=d,this._onUnsupportedFeature=h,this._document=p,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(d){this.nativeFontFaces.push(d),this._document.fonts.add(d)}insertRule(d){let h=this.styleElement;h||(h=this.styleElement=this._document.createElement("style"),h.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(h));const p=h.sheet;p.insertRule(d,p.cssRules.length)}clear(){for(const d of this.nativeFontFaces)this._document.fonts.delete(d);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(d){if(d.attached||d.missingFile)return;if(d.attached=!0,this.isFontLoadingAPISupported){const p=d.createNativeFontFace();if(p){this.addNativeFontFace(p);try{await p.loaded}catch(E){throw this._onUnsupportedFeature({featureId:n.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,n.warn)(`Failed to load font '${p.family}': '${E}'.`),d.disableFontFace=!0,E}}return}const h=d.createFontFaceRule();if(h){if(this.insertRule(h),this.isSyncFontLoadingSupported)return;await new Promise(p=>{const E=this._queueLoadingCallback(p);this._prepareFontLoadEvent([h],[d],E)})}}_queueLoadingCallback(d){(0,n.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var h;const d=!!((h=this._document)!=null&&h.fonts);return(0,n.shadow)(this,"isFontLoadingAPISupported",d)}get isSyncFontLoadingSupported(){(0,n.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,n.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(d,h,p){(0,n.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let l;r.FontLoader=l,r.FontLoader=l=class extends i{constructor(d){super(d),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let d=!1;if(typeof navigator>"u")d=!0;else{const h=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(h==null?void 0:h[1])>=14&&(d=!0)}return(0,n.shadow)(this,"isSyncFontLoadingSupported",d)}_queueLoadingCallback(d){function h(){for((0,n.assert)(!E.done,"completeRequest() cannot be called twice."),E.done=!0;p.requests.length>0&&p.requests[0].done;){const y=p.requests.shift();setTimeout(y.callback,0)}}const p=this.loadingContext,E={id:`pdfjs-font-loading-${p.nextRequestId++}`,done:!1,complete:h,callback:d};return p.requests.push(E),E}get _loadTestFont(){const d=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,n.shadow)(this,"_loadTestFont",d())}_prepareFontLoadEvent(d,h,p){function E(_e,ge){return _e.charCodeAt(ge)<<24|_e.charCodeAt(ge+1)<<16|_e.charCodeAt(ge+2)<<8|_e.charCodeAt(ge+3)&255}function y(_e,ge,he,W){const se=_e.substring(0,ge),ue=_e.substring(ge+he);return se+W+ue}let S,x;const g=this._document.createElement("canvas");g.width=1,g.height=1;const m=g.getContext("2d");let A=0;function O(_e,ge){if(A++,A>30){(0,n.warn)("Load test font never loaded."),ge();return}if(m.font="30px "+_e,m.fillText(".",0,20),m.getImageData(0,0,1,1).data[3]>0){ge();return}setTimeout(O.bind(null,_e,ge))}const C=`lt${Date.now()}${this.loadTestFontId++}`;let R=this._loadTestFont;R=y(R,976,C.length,C);const w=16,v=1482184792;let L=E(R,w);for(S=0,x=C.length-3;S<x;S+=4)L=L-v+E(C,S)|0;S<C.length&&(L=L-v+E(C+"XXX",S)|0),R=y(R,w,4,(0,n.string32)(L));const M=`url(data:font/opentype;base64,${btoa(R)});`,X=`@font-face {font-family:"${C}";src:${M}}`;this.insertRule(X);const H=[];for(const _e of h)H.push(_e.loadedName);H.push(C);const ne=this._document.createElement("div");ne.style.visibility="hidden",ne.style.width=ne.style.height="10px",ne.style.position="absolute",ne.style.top=ne.style.left="0px";for(const _e of H){const ge=this._document.createElement("span");ge.textContent="Hi",ge.style.fontFamily=_e,ne.append(ge)}this._document.body.append(ne),O(C,()=>{ne.remove(),p.complete()})}};class c{constructor(d,{isEvalSupported:h=!0,disableFontFace:p=!1,ignoreErrors:E=!1,onUnsupportedFeature:y,fontRegistry:S=null}){this.compiledGlyphs=Object.create(null);for(const x in d)this[x]=d[x];this.isEvalSupported=h!==!1,this.disableFontFace=p===!0,this.ignoreErrors=E===!0,this._onUnsupportedFeature=y,this.fontRegistry=S}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let d;if(!this.cssFontInfo)d=new FontFace(this.loadedName,this.data,{});else{const h={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(h.style=`oblique ${this.cssFontInfo.italicAngle}deg`),d=new FontFace(this.cssFontInfo.fontFamily,this.data,h)}return this.fontRegistry&&this.fontRegistry.registerFont(this),d}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const d=(0,n.bytesToString)(this.data),h=`url(data:${this.mimetype};base64,${btoa(d)});`;let p;if(!this.cssFontInfo)p=`@font-face {font-family:"${this.loadedName}";src:${h}}`;else{let E=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(E+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),p=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${E}src:${h}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,h),p}getPathGenerator(d,h){if(this.compiledGlyphs[h]!==void 0)return this.compiledGlyphs[h];let p;try{p=d.get(this.loadedName+"_path_"+h)}catch(E){if(!this.ignoreErrors)throw E;return this._onUnsupportedFeature({featureId:n.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,n.warn)(`getPathGenerator - ignoring character: "${E}".`),this.compiledGlyphs[h]=function(y,S){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const E=[];for(const y of p){const S=y.args!==void 0?y.args.join(","):"";E.push("c.",y.cmd,"(",S,`);
`)}return this.compiledGlyphs[h]=new Function("c","size",E.join(""))}return this.compiledGlyphs[h]=function(E,y){for(const S of p)S.cmd==="scale"&&(S.args=[y,-y]),E[S.cmd].apply(E,S.args)}}}r.FontFaceObject=c},(e,r,t)=>{var re,Hl;Object.defineProperty(r,"__esModule",{value:!0}),r.CanvasGraphics=void 0;var n=t(8),i=t(1),l=t(13),c=t(14),f=t(3);const d=16,h=100,p=4096,E=15,y=10,S=f.isNodeJS&&typeof Path2D>"u"?-1:1e3,x=16;function g(N,P){if(N._removeMirroring)throw new Error("Context is already forwarding operations.");N.__originalSave=N.save,N.__originalRestore=N.restore,N.__originalRotate=N.rotate,N.__originalScale=N.scale,N.__originalTranslate=N.translate,N.__originalTransform=N.transform,N.__originalSetTransform=N.setTransform,N.__originalResetTransform=N.resetTransform,N.__originalClip=N.clip,N.__originalMoveTo=N.moveTo,N.__originalLineTo=N.lineTo,N.__originalBezierCurveTo=N.bezierCurveTo,N.__originalRect=N.rect,N.__originalClosePath=N.closePath,N.__originalBeginPath=N.beginPath,N._removeMirroring=()=>{N.save=N.__originalSave,N.restore=N.__originalRestore,N.rotate=N.__originalRotate,N.scale=N.__originalScale,N.translate=N.__originalTranslate,N.transform=N.__originalTransform,N.setTransform=N.__originalSetTransform,N.resetTransform=N.__originalResetTransform,N.clip=N.__originalClip,N.moveTo=N.__originalMoveTo,N.lineTo=N.__originalLineTo,N.bezierCurveTo=N.__originalBezierCurveTo,N.rect=N.__originalRect,N.closePath=N.__originalClosePath,N.beginPath=N.__originalBeginPath,delete N._removeMirroring},N.save=function(){P.save(),this.__originalSave()},N.restore=function(){P.restore(),this.__originalRestore()},N.translate=function(B,z){P.translate(B,z),this.__originalTranslate(B,z)},N.scale=function(B,z){P.scale(B,z),this.__originalScale(B,z)},N.transform=function(B,z,Q,K,F,I){P.transform(B,z,Q,K,F,I),this.__originalTransform(B,z,Q,K,F,I)},N.setTransform=function(B,z,Q,K,F,I){P.setTransform(B,z,Q,K,F,I),this.__originalSetTransform(B,z,Q,K,F,I)},N.resetTransform=function(){P.resetTransform(),this.__originalResetTransform()},N.rotate=function(B){P.rotate(B),this.__originalRotate(B)},N.clip=function(B){P.clip(B),this.__originalClip(B)},N.moveTo=function(k,B){P.moveTo(k,B),this.__originalMoveTo(k,B)},N.lineTo=function(k,B){P.lineTo(k,B),this.__originalLineTo(k,B)},N.bezierCurveTo=function(k,B,z,Q,K,F){P.bezierCurveTo(k,B,z,Q,K,F),this.__originalBezierCurveTo(k,B,z,Q,K,F)},N.rect=function(k,B,z,Q){P.rect(k,B,z,Q),this.__originalRect(k,B,z,Q)},N.closePath=function(){P.closePath(),this.__originalClosePath()},N.beginPath=function(){P.beginPath(),this.__originalBeginPath()}}class m{constructor(P){this.canvasFactory=P,this.cache=Object.create(null)}getCanvas(P,k,B){let z;return this.cache[P]!==void 0?(z=this.cache[P],this.canvasFactory.reset(z,k,B)):(z=this.canvasFactory.create(k,B),this.cache[P]=z),z}delete(P){delete this.cache[P]}clear(){for(const P in this.cache){const k=this.cache[P];this.canvasFactory.destroy(k),delete this.cache[P]}}}function A(N,P,k,B,z,Q,K,F,I,V){const[D,Y,ie,te,j,J]=(0,n.getCurrentTransform)(N);if(Y===0&&ie===0){const ve=K*D+j,Te=Math.round(ve),Me=F*te+J,ze=Math.round(Me),we=(K+I)*D+j,at=Math.abs(Math.round(we)-Te)||1,et=(F+V)*te+J,Ke=Math.abs(Math.round(et)-ze)||1;return N.setTransform(Math.sign(D),0,0,Math.sign(te),Te,ze),N.drawImage(P,k,B,z,Q,0,0,at,Ke),N.setTransform(D,Y,ie,te,j,J),[at,Ke]}if(D===0&&te===0){const ve=F*ie+j,Te=Math.round(ve),Me=K*Y+J,ze=Math.round(Me),we=(F+V)*ie+j,at=Math.abs(Math.round(we)-Te)||1,et=(K+I)*Y+J,Ke=Math.abs(Math.round(et)-ze)||1;return N.setTransform(0,Math.sign(Y),Math.sign(ie),0,Te,ze),N.drawImage(P,k,B,z,Q,0,0,Ke,at),N.setTransform(D,Y,ie,te,j,J),[Ke,at]}N.drawImage(P,k,B,z,Q,K,F,I,V);const Ae=Math.hypot(D,Y),pe=Math.hypot(ie,te);return[Ae*I,pe*V]}function O(N){const{width:P,height:k}=N;if(P>S||k>S)return null;const B=1e3,z=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),Q=P+1;let K=new Uint8Array(Q*(k+1)),F,I,V;const D=P+7&-8;let Y=new Uint8Array(D*k),ie=0;for(const pe of N.data){let ve=128;for(;ve>0;)Y[ie++]=pe&ve?0:255,ve>>=1}let te=0;for(ie=0,Y[ie]!==0&&(K[0]=1,++te),I=1;I<P;I++)Y[ie]!==Y[ie+1]&&(K[I]=Y[ie]?2:1,++te),ie++;for(Y[ie]!==0&&(K[I]=2,++te),F=1;F<k;F++){ie=F*D,V=F*Q,Y[ie-D]!==Y[ie]&&(K[V]=Y[ie]?1:8,++te);let pe=(Y[ie]?4:0)+(Y[ie-D]?8:0);for(I=1;I<P;I++)pe=(pe>>2)+(Y[ie+1]?4:0)+(Y[ie-D+1]?8:0),z[pe]&&(K[V+I]=z[pe],++te),ie++;if(Y[ie-D]!==Y[ie]&&(K[V+I]=Y[ie]?2:4,++te),te>B)return null}for(ie=D*(k-1),V=F*Q,Y[ie]!==0&&(K[V]=8,++te),I=1;I<P;I++)Y[ie]!==Y[ie+1]&&(K[V+I]=Y[ie]?4:8,++te),ie++;if(Y[ie]!==0&&(K[V+I]=4,++te),te>B)return null;const j=new Int32Array([0,Q,-1,0,-Q,0,0,0,1]),J=new Path2D;for(F=0;te&&F<=k;F++){let pe=F*Q;const ve=pe+P;for(;pe<ve&&!K[pe];)pe++;if(pe===ve)continue;J.moveTo(pe%Q,F);const Te=pe;let Me=K[pe];do{const ze=j[Me];do pe+=ze;while(!K[pe]);const we=K[pe];we!==5&&we!==10?(Me=we,K[pe]=0):(Me=we&51*Me>>4,K[pe]&=Me>>2|Me<<2),J.lineTo(pe%Q,pe/Q|0),K[pe]||--te}while(Te!==pe);--F}return Y=null,K=null,function(pe){pe.save(),pe.scale(1/P,-1/k),pe.translate(0,-k),pe.fill(J),pe.beginPath(),pe.restore()}}class C{constructor(P,k){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=i.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=i.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,P,k])}clone(){const P=Object.create(this);return P.clipBox=this.clipBox.slice(),P}setCurrentPoint(P,k){this.x=P,this.y=k}updatePathMinMax(P,k,B){[k,B]=i.Util.applyTransform([k,B],P),this.minX=Math.min(this.minX,k),this.minY=Math.min(this.minY,B),this.maxX=Math.max(this.maxX,k),this.maxY=Math.max(this.maxY,B)}updateRectMinMax(P,k){const B=i.Util.applyTransform(k,P),z=i.Util.applyTransform(k.slice(2),P);this.minX=Math.min(this.minX,B[0],z[0]),this.minY=Math.min(this.minY,B[1],z[1]),this.maxX=Math.max(this.maxX,B[0],z[0]),this.maxY=Math.max(this.maxY,B[1],z[1])}updateScalingPathMinMax(P,k){i.Util.scaleMinMax(P,k),this.minX=Math.min(this.minX,k[0]),this.maxX=Math.max(this.maxX,k[1]),this.minY=Math.min(this.minY,k[2]),this.maxY=Math.max(this.maxY,k[3])}updateCurvePathMinMax(P,k,B,z,Q,K,F,I,V,D){const Y=i.Util.bezierBoundingBox(k,B,z,Q,K,F,I,V);if(D){D[0]=Math.min(D[0],Y[0],Y[2]),D[1]=Math.max(D[1],Y[0],Y[2]),D[2]=Math.min(D[2],Y[1],Y[3]),D[3]=Math.max(D[3],Y[1],Y[3]);return}this.updateRectMinMax(P,Y)}getPathBoundingBox(P=l.PathType.FILL,k=null){const B=[this.minX,this.minY,this.maxX,this.maxY];if(P===l.PathType.STROKE){k||(0,i.unreachable)("Stroke bounding box must include transform.");const z=i.Util.singularValueDecompose2dScale(k),Q=z[0]*this.lineWidth/2,K=z[1]*this.lineWidth/2;B[0]-=Q,B[1]-=K,B[2]+=Q,B[3]+=K}return B}updateClipFromPath(){const P=i.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(P||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(P){this.clipBox=P,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(P=l.PathType.FILL,k=null){return i.Util.intersect(this.clipBox,this.getPathBoundingBox(P,k))}}function R(N,P,k=null){if(typeof ImageData<"u"&&P instanceof ImageData){N.putImageData(P,0,0);return}const B=P.height,z=P.width,Q=B%x,K=(B-Q)/x,F=Q===0?K:K+1,I=N.createImageData(z,x);let V=0,D;const Y=P.data,ie=I.data;let te,j,J,Ae,pe,ve,Te,Me;if(k)switch(k.length){case 1:pe=k[0],ve=k[0],Te=k[0],Me=k[0];break;case 4:pe=k[0],ve=k[1],Te=k[2],Me=k[3];break}if(P.kind===i.ImageKind.GRAYSCALE_1BPP){const ze=Y.byteLength,we=new Uint32Array(ie.buffer,0,ie.byteLength>>2),at=we.length,et=z+7>>3;let Ke=4294967295,Ze=i.FeatureTest.isLittleEndian?4278190080:255;for(Me&&Me[0]===255&&Me[255]===0&&([Ke,Ze]=[Ze,Ke]),te=0;te<F;te++){for(J=te<K?x:Q,D=0,j=0;j<J;j++){const ft=ze-V;let Je=0;const st=ft>et?z:ft*8-7,dt=st&-8;let nt=0,lt=0;for(;Je<dt;Je+=8)lt=Y[V++],we[D++]=lt&128?Ke:Ze,we[D++]=lt&64?Ke:Ze,we[D++]=lt&32?Ke:Ze,we[D++]=lt&16?Ke:Ze,we[D++]=lt&8?Ke:Ze,we[D++]=lt&4?Ke:Ze,we[D++]=lt&2?Ke:Ze,we[D++]=lt&1?Ke:Ze;for(;Je<st;Je++)nt===0&&(lt=Y[V++],nt=128),we[D++]=lt&nt?Ke:Ze,nt>>=1}for(;D<at;)we[D++]=0;N.putImageData(I,0,te*x)}}else if(P.kind===i.ImageKind.RGBA_32BPP){const ze=!!(pe||ve||Te);for(j=0,Ae=z*x*4,te=0;te<K;te++){if(ie.set(Y.subarray(V,V+Ae)),V+=Ae,ze)for(let we=0;we<Ae;we+=4)pe&&(ie[we+0]=pe[ie[we+0]]),ve&&(ie[we+1]=ve[ie[we+1]]),Te&&(ie[we+2]=Te[ie[we+2]]);N.putImageData(I,0,j),j+=x}if(te<F){if(Ae=z*Q*4,ie.set(Y.subarray(V,V+Ae)),ze)for(let we=0;we<Ae;we+=4)pe&&(ie[we+0]=pe[ie[we+0]]),ve&&(ie[we+1]=ve[ie[we+1]]),Te&&(ie[we+2]=Te[ie[we+2]]);N.putImageData(I,0,j)}}else if(P.kind===i.ImageKind.RGB_24BPP){const ze=!!(pe||ve||Te);for(J=x,Ae=z*J,te=0;te<F;te++){for(te>=K&&(J=Q,Ae=z*J),D=0,j=Ae;j--;)ie[D++]=Y[V++],ie[D++]=Y[V++],ie[D++]=Y[V++],ie[D++]=255;if(ze)for(let we=0;we<D;we+=4)pe&&(ie[we+0]=pe[ie[we+0]]),ve&&(ie[we+1]=ve[ie[we+1]]),Te&&(ie[we+2]=Te[ie[we+2]]);N.putImageData(I,0,te*x)}}else throw new Error(`bad image kind: ${P.kind}`)}function T(N,P){if(P.bitmap){N.drawImage(P.bitmap,0,0);return}const k=P.height,B=P.width,z=k%x,Q=(k-z)/x,K=z===0?Q:Q+1,F=N.createImageData(B,x);let I=0;const V=P.data,D=F.data;for(let Y=0;Y<K;Y++){const ie=Y<Q?x:z;({srcPos:I}=(0,c.applyMaskImageData)({src:V,srcPos:I,dest:D,width:B,height:ie})),N.putImageData(F,0,Y*x)}}function w(N,P){const k=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let B=0,z=k.length;B<z;B++){const Q=k[B];N[Q]!==void 0&&(P[Q]=N[Q])}N.setLineDash!==void 0&&(P.setLineDash(N.getLineDash()),P.lineDashOffset=N.lineDashOffset)}function v(N,P){N.strokeStyle=N.fillStyle=P||"#000000",N.fillRule="nonzero",N.globalAlpha=1,N.lineWidth=1,N.lineCap="butt",N.lineJoin="miter",N.miterLimit=10,N.globalCompositeOperation="source-over",N.font="10px sans-serif",N.setLineDash!==void 0&&(N.setLineDash([]),N.lineDashOffset=0)}function L(N,P,k,B){const z=N.length;for(let Q=3;Q<z;Q+=4){const K=N[Q];if(K===0)N[Q-3]=P,N[Q-2]=k,N[Q-1]=B;else if(K<255){const F=255-K;N[Q-3]=N[Q-3]*K+P*F>>8,N[Q-2]=N[Q-2]*K+k*F>>8,N[Q-1]=N[Q-1]*K+B*F>>8}}}function M(N,P,k){const B=N.length,z=1/255;for(let Q=3;Q<B;Q+=4){const K=k?k[N[Q]]:N[Q];P[Q]=P[Q]*K*z|0}}function X(N,P,k){const B=N.length;for(let z=3;z<B;z+=4){const Q=N[z-3]*77+N[z-2]*152+N[z-1]*28;P[z]=k?P[z]*k[Q>>8]>>8:P[z]*Q>>16}}function H(N,P,k,B,z,Q,K,F,I,V,D){const Y=!!Q,ie=Y?Q[0]:0,te=Y?Q[1]:0,j=Y?Q[2]:0;let J;z==="Luminosity"?J=X:J=M;const pe=Math.min(B,Math.ceil(1048576/k));for(let ve=0;ve<B;ve+=pe){const Te=Math.min(pe,B-ve),Me=N.getImageData(F-V,ve+(I-D),k,Te),ze=P.getImageData(F,ve+I,k,Te);Y&&L(Me.data,ie,te,j),J(Me.data,ze.data,K),P.putImageData(ze,F,ve+I)}}function ne(N,P,k,B){const z=B[0],Q=B[1],K=B[2]-z,F=B[3]-Q;K===0||F===0||(H(P.context,k,K,F,P.subtype,P.backdrop,P.transferMap,z,Q,P.offsetX,P.offsetY),N.save(),N.globalAlpha=1,N.globalCompositeOperation="source-over",N.setTransform(1,0,0,1,0,0),N.drawImage(k.canvas,0,0),N.restore())}function _e(N,P){const k=i.Util.singularValueDecompose2dScale(N);k[0]=Math.fround(k[0]),k[1]=Math.fround(k[1]);const B=Math.fround((globalThis.devicePixelRatio||1)*n.PixelsPerInch.PDF_TO_CSS_UNITS);return P!==void 0?P:k[0]<=B||k[1]<=B}const ge=["butt","round","square"],he=["miter","round","bevel"],W={},se={},me=class me{constructor(P,k,B,z,Q,K,F,I){Ge(this,re);this.ctx=P,this.current=new C(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=k,this.objs=B,this.canvasFactory=z,this.imageLayer=Q,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=K,this.cachedCanvases=new m(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=F,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(I==null?void 0:I.background)||null,this.foregroundColor=(I==null?void 0:I.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(P,k=null){return typeof P=="string"?P.startsWith("g_")?this.commonObjs.get(P):this.objs.get(P):k}beginDrawing({transform:P,viewport:k,transparency:B=!1,background:z=null}){const Q=this.ctx.canvas.width,K=this.ctx.canvas.height,F=z||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const I=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const V=this.backgroundColor=this.ctx.fillStyle;let D=!0,Y=F;if(this.ctx.fillStyle=F,Y=this.ctx.fillStyle,D=typeof Y=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Y),I==="#000000"&&V==="#ffffff"||I===V||!D)this.foregroundColor=this.backgroundColor=null;else{const[ie,te,j]=(0,n.getRGB)(Y),J=pe=>(pe/=255,pe<=.03928?pe/12.92:((pe+.055)/1.055)**2.4),Ae=Math.round(.2126*J(ie)+.7152*J(te)+.0722*J(j));this.selectColor=(pe,ve,Te)=>{const Me=.2126*J(pe)+.7152*J(ve)+.0722*J(Te);return Math.round(Me)===Ae?V:I}}}if(this.ctx.fillStyle=this.backgroundColor||F,this.ctx.fillRect(0,0,Q,K),this.ctx.restore(),B){const I=this.cachedCanvases.getCanvas("transparent",Q,K);this.compositeCtx=this.ctx,this.transparentCanvas=I.canvas,this.ctx=I.context,this.ctx.save(),this.ctx.transform(...(0,n.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),v(this.ctx,this.foregroundColor),P&&(this.ctx.transform(...P),this.outputScaleX=P[0],this.outputScaleY=P[0]),this.ctx.transform(...k.transform),this.viewportScale=k.scale,this.baseTransform=(0,n.getCurrentTransform)(this.ctx),this.imageLayer&&((0,n.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}executeOperatorList(P,k,B,z){const Q=P.argsArray,K=P.fnArray;let F=k||0;const I=Q.length;if(I===F)return F;const V=I-F>y&&typeof B=="function",D=V?Date.now()+E:0;let Y=0;const ie=this.commonObjs,te=this.objs;let j;for(;;){if(z!==void 0&&F===z.nextBreakPoint)return z.breakIt(F,B),F;if(j=K[F],j!==i.OPS.dependency)this[j].apply(this,Q[F]);else for(const J of Q[F]){const Ae=J.startsWith("g_")?ie:te;if(!Ae.has(J))return Ae.get(J,B),F}if(F++,F===I)return F;if(V&&++Y>y){if(Date.now()>D)return B(),F;Y=0}}}endDrawing(){Ue(this,re,Hl).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const P of this._cachedBitmapsMap.values()){for(const k of P.values())typeof HTMLCanvasElement<"u"&&k instanceof HTMLCanvasElement&&(k.width=k.height=0);P.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(P,k){const B=P.width,z=P.height;let Q=Math.max(Math.hypot(k[0],k[1]),1),K=Math.max(Math.hypot(k[2],k[3]),1),F=B,I=z,V="prescale1",D,Y;for(;Q>2&&F>1||K>2&&I>1;){let ie=F,te=I;Q>2&&F>1&&(ie=Math.ceil(F/2),Q/=F/ie),K>2&&I>1&&(te=Math.ceil(I/2),K/=I/te),D=this.cachedCanvases.getCanvas(V,ie,te),Y=D.context,Y.clearRect(0,0,ie,te),Y.drawImage(P,0,0,F,I,0,0,ie,te),P=D.canvas,F=ie,I=te,V=V==="prescale1"?"prescale2":"prescale1"}return{img:P,paintWidth:F,paintHeight:I}}_createMaskCanvas(P){const k=this.ctx,{width:B,height:z}=P,Q=this.current.fillColor,K=this.current.patternFill,F=(0,n.getCurrentTransform)(k);let I,V,D,Y;if((P.bitmap||P.data)&&P.count>1){const at=P.bitmap||P.data.buffer,et=F.slice(0,4);V=JSON.stringify(K?et:[et,Q]),I=this._cachedBitmapsMap.get(at),I||(I=new Map,this._cachedBitmapsMap.set(at,I));const Ke=I.get(V);if(Ke&&!K){const Ze=Math.round(Math.min(F[0],F[2])+F[4]),ft=Math.round(Math.min(F[1],F[3])+F[5]);return{canvas:Ke,offsetX:Ze,offsetY:ft}}D=Ke}D||(Y=this.cachedCanvases.getCanvas("maskCanvas",B,z),T(Y.context,P));let ie=i.Util.transform(F,[1/B,0,0,-1/z,0,0]);ie=i.Util.transform(ie,[1,0,0,1,0,-z]);const te=i.Util.applyTransform([0,0],ie),j=i.Util.applyTransform([B,z],ie),J=i.Util.normalizeRect([te[0],te[1],j[0],j[1]]),Ae=Math.round(J[2]-J[0])||1,pe=Math.round(J[3]-J[1])||1,ve=this.cachedCanvases.getCanvas("fillCanvas",Ae,pe),Te=ve.context,Me=Math.min(te[0],j[0]),ze=Math.min(te[1],j[1]);Te.translate(-Me,-ze),Te.transform(...ie),D||(D=this._scaleImage(Y.canvas,(0,n.getCurrentTransformInverse)(Te)),D=D.img,I&&K&&I.set(V,D)),Te.imageSmoothingEnabled=_e((0,n.getCurrentTransform)(Te),P.interpolate),A(Te,D,0,0,D.width,D.height,0,0,B,z),Te.globalCompositeOperation="source-in";const we=i.Util.transform((0,n.getCurrentTransformInverse)(Te),[1,0,0,1,-Me,-ze]);return Te.fillStyle=K?Q.getPattern(k,this,we,l.PathType.FILL):Q,Te.fillRect(0,0,B,z),I&&!K&&(this.cachedCanvases.delete("fillCanvas"),I.set(V,ve.canvas)),{canvas:ve.canvas,offsetX:Math.round(Me),offsetY:Math.round(ze)}}setLineWidth(P){P!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=P,this.ctx.lineWidth=P}setLineCap(P){this.ctx.lineCap=ge[P]}setLineJoin(P){this.ctx.lineJoin=he[P]}setMiterLimit(P){this.ctx.miterLimit=P}setDash(P,k){const B=this.ctx;B.setLineDash!==void 0&&(B.setLineDash(P),B.lineDashOffset=k)}setRenderingIntent(P){}setFlatness(P){}setGState(P){for(let k=0,B=P.length;k<B;k++){const z=P[k],Q=z[0],K=z[1];switch(Q){case"LW":this.setLineWidth(K);break;case"LC":this.setLineCap(K);break;case"LJ":this.setLineJoin(K);break;case"ML":this.setMiterLimit(K);break;case"D":this.setDash(K[0],K[1]);break;case"RI":this.setRenderingIntent(K);break;case"FL":this.setFlatness(K);break;case"Font":this.setFont(K[0],K[1]);break;case"CA":this.current.strokeAlpha=z[1];break;case"ca":this.current.fillAlpha=z[1],this.ctx.globalAlpha=z[1];break;case"BM":this.ctx.globalCompositeOperation=K;break;case"SMask":this.current.activeSMask=K?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=K}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const P=this.inSMaskMode;this.current.activeSMask&&!P?this.beginSMaskMode():!this.current.activeSMask&&P&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const P=this.ctx.canvas.width,k=this.ctx.canvas.height,B="smaskGroupAt"+this.groupLevel,z=this.cachedCanvases.getCanvas(B,P,k);this.suspendedCtx=this.ctx,this.ctx=z.context;const Q=this.ctx;Q.setTransform(...(0,n.getCurrentTransform)(this.suspendedCtx)),w(this.suspendedCtx,Q),g(Q,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),w(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(P){if(!this.current.activeSMask)return;P?(P[0]=Math.floor(P[0]),P[1]=Math.floor(P[1]),P[2]=Math.ceil(P[2]),P[3]=Math.ceil(P[3])):P=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const k=this.current.activeSMask,B=this.suspendedCtx;ne(B,k,this.ctx,P),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(w(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const P=this.current;this.stateStack.push(P),this.current=P.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),w(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(P,k,B,z,Q,K){this.ctx.transform(P,k,B,z,Q,K),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(P,k,B){const z=this.ctx,Q=this.current;let K=Q.x,F=Q.y,I,V;const D=(0,n.getCurrentTransform)(z),Y=D[0]===0&&D[3]===0||D[1]===0&&D[2]===0,ie=Y?B.slice(0):null;for(let te=0,j=0,J=P.length;te<J;te++)switch(P[te]|0){case i.OPS.rectangle:K=k[j++],F=k[j++];const Ae=k[j++],pe=k[j++],ve=K+Ae,Te=F+pe;z.moveTo(K,F),Ae===0||pe===0?z.lineTo(ve,Te):(z.lineTo(ve,F),z.lineTo(ve,Te),z.lineTo(K,Te)),Y||Q.updateRectMinMax(D,[K,F,ve,Te]),z.closePath();break;case i.OPS.moveTo:K=k[j++],F=k[j++],z.moveTo(K,F),Y||Q.updatePathMinMax(D,K,F);break;case i.OPS.lineTo:K=k[j++],F=k[j++],z.lineTo(K,F),Y||Q.updatePathMinMax(D,K,F);break;case i.OPS.curveTo:I=K,V=F,K=k[j+4],F=k[j+5],z.bezierCurveTo(k[j],k[j+1],k[j+2],k[j+3],K,F),Q.updateCurvePathMinMax(D,I,V,k[j],k[j+1],k[j+2],k[j+3],K,F,ie),j+=6;break;case i.OPS.curveTo2:I=K,V=F,z.bezierCurveTo(K,F,k[j],k[j+1],k[j+2],k[j+3]),Q.updateCurvePathMinMax(D,I,V,K,F,k[j],k[j+1],k[j+2],k[j+3],ie),K=k[j+2],F=k[j+3],j+=4;break;case i.OPS.curveTo3:I=K,V=F,K=k[j+2],F=k[j+3],z.bezierCurveTo(k[j],k[j+1],K,F,K,F),Q.updateCurvePathMinMax(D,I,V,k[j],k[j+1],K,F,K,F,ie),j+=4;break;case i.OPS.closePath:z.closePath();break}Y&&Q.updateScalingPathMinMax(D,ie),Q.setCurrentPoint(K,F)}closePath(){this.ctx.closePath()}stroke(P){P=typeof P<"u"?P:!0;const k=this.ctx,B=this.current.strokeColor;k.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof B=="object"&&(B!=null&&B.getPattern)?(k.save(),k.strokeStyle=B.getPattern(k,this,(0,n.getCurrentTransformInverse)(k),l.PathType.STROKE),this.rescaleAndStroke(!1),k.restore()):this.rescaleAndStroke(!0)),P&&this.consumePath(this.current.getClippedPathBoundingBox()),k.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(P){P=typeof P<"u"?P:!0;const k=this.ctx,B=this.current.fillColor,z=this.current.patternFill;let Q=!1;z&&(k.save(),k.fillStyle=B.getPattern(k,this,(0,n.getCurrentTransformInverse)(k),l.PathType.FILL),Q=!0);const K=this.current.getClippedPathBoundingBox();this.contentVisible&&K!==null&&(this.pendingEOFill?(k.fill("evenodd"),this.pendingEOFill=!1):k.fill()),Q&&k.restore(),P&&this.consumePath(K)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=W}eoClip(){this.pendingClip=se}beginText(){this.current.textMatrix=i.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const P=this.pendingTextPaths,k=this.ctx;if(P===void 0){k.beginPath();return}k.save(),k.beginPath();for(const B of P)k.setTransform(...B.transform),k.translate(B.x,B.y),B.addToPath(k,B.fontSize);k.restore(),k.clip(),k.beginPath(),delete this.pendingTextPaths}setCharSpacing(P){this.current.charSpacing=P}setWordSpacing(P){this.current.wordSpacing=P}setHScale(P){this.current.textHScale=P/100}setLeading(P){this.current.leading=-P}setFont(P,k){const B=this.commonObjs.get(P),z=this.current;if(!B)throw new Error(`Can't find font for ${P}`);if(z.fontMatrix=B.fontMatrix||i.FONT_IDENTITY_MATRIX,(z.fontMatrix[0]===0||z.fontMatrix[3]===0)&&(0,i.warn)("Invalid font matrix for font "+P),k<0?(k=-k,z.fontDirection=-1):z.fontDirection=1,this.current.font=B,this.current.fontSize=k,B.isType3Font)return;const Q=B.loadedName||"sans-serif";let K="normal";B.black?K="900":B.bold&&(K="bold");const F=B.italic?"italic":"normal",I=`"${Q}", ${B.fallbackName}`;let V=k;k<d?V=d:k>h&&(V=h),this.current.fontSizeScale=k/V,this.ctx.font=`${F} ${K} ${V}px ${I}`}setTextRenderingMode(P){this.current.textRenderingMode=P}setTextRise(P){this.current.textRise=P}moveText(P,k){this.current.x=this.current.lineX+=P,this.current.y=this.current.lineY+=k}setLeadingMoveText(P,k){this.setLeading(-k),this.moveText(P,k)}setTextMatrix(P,k,B,z,Q,K){this.current.textMatrix=[P,k,B,z,Q,K],this.current.textMatrixScale=Math.hypot(P,k),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(P,k,B,z){const Q=this.ctx,K=this.current,F=K.font,I=K.textRenderingMode,V=K.fontSize/K.fontSizeScale,D=I&i.TextRenderingMode.FILL_STROKE_MASK,Y=!!(I&i.TextRenderingMode.ADD_TO_PATH_FLAG),ie=K.patternFill&&!F.missingFile;let te;(F.disableFontFace||Y||ie)&&(te=F.getPathGenerator(this.commonObjs,P)),F.disableFontFace||ie?(Q.save(),Q.translate(k,B),Q.beginPath(),te(Q,V),z&&Q.setTransform(...z),(D===i.TextRenderingMode.FILL||D===i.TextRenderingMode.FILL_STROKE)&&Q.fill(),(D===i.TextRenderingMode.STROKE||D===i.TextRenderingMode.FILL_STROKE)&&Q.stroke(),Q.restore()):((D===i.TextRenderingMode.FILL||D===i.TextRenderingMode.FILL_STROKE)&&Q.fillText(P,k,B),(D===i.TextRenderingMode.STROKE||D===i.TextRenderingMode.FILL_STROKE)&&Q.strokeText(P,k,B)),Y&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,n.getCurrentTransform)(Q),x:k,y:B,fontSize:V,addToPath:te})}get isFontSubpixelAAEnabled(){const{context:P}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);P.scale(1.5,1),P.fillText("I",0,10);const k=P.getImageData(0,0,10,10).data;let B=!1;for(let z=3;z<k.length;z+=4)if(k[z]>0&&k[z]<255){B=!0;break}return(0,i.shadow)(this,"isFontSubpixelAAEnabled",B)}showText(P){const k=this.current,B=k.font;if(B.isType3Font)return this.showType3Text(P);const z=k.fontSize;if(z===0)return;const Q=this.ctx,K=k.fontSizeScale,F=k.charSpacing,I=k.wordSpacing,V=k.fontDirection,D=k.textHScale*V,Y=P.length,ie=B.vertical,te=ie?1:-1,j=B.defaultVMetrics,J=z*k.fontMatrix[0],Ae=k.textRenderingMode===i.TextRenderingMode.FILL&&!B.disableFontFace&&!k.patternFill;Q.save(),Q.transform(...k.textMatrix),Q.translate(k.x,k.y+k.textRise),V>0?Q.scale(D,-1):Q.scale(D,1);let pe;if(k.patternFill){Q.save();const we=k.fillColor.getPattern(Q,this,(0,n.getCurrentTransformInverse)(Q),l.PathType.FILL);pe=(0,n.getCurrentTransform)(Q),Q.restore(),Q.fillStyle=we}let ve=k.lineWidth;const Te=k.textMatrixScale;if(Te===0||ve===0){const we=k.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;(we===i.TextRenderingMode.STROKE||we===i.TextRenderingMode.FILL_STROKE)&&(ve=this.getSinglePixelWidth())}else ve/=Te;K!==1&&(Q.scale(K,K),ve/=K),Q.lineWidth=ve;let Me=0,ze;for(ze=0;ze<Y;++ze){const we=P[ze];if(typeof we=="number"){Me+=te*we*z/1e3;continue}let at=!1;const et=(we.isSpace?I:0)+F,Ke=we.fontChar,Ze=we.accent;let ft,Je,st=we.width;if(ie){const nt=we.vmetric||j,lt=-(we.vmetric?nt[1]:st*.5)*J,or=nt[2]*J;st=nt?-nt[0]:st,ft=lt/K,Je=(Me+or)/K}else ft=Me/K,Je=0;if(B.remeasure&&st>0){const nt=Q.measureText(Ke).width*1e3/z*K;if(st<nt&&this.isFontSubpixelAAEnabled){const lt=st/nt;at=!0,Q.save(),Q.scale(lt,1),ft/=lt}else st!==nt&&(ft+=(st-nt)/2e3*z/K)}if(this.contentVisible&&(we.isInFont||B.missingFile)){if(Ae&&!Ze)Q.fillText(Ke,ft,Je);else if(this.paintChar(Ke,ft,Je,pe),Ze){const nt=ft+z*Ze.offset.x/K,lt=Je-z*Ze.offset.y/K;this.paintChar(Ze.fontChar,nt,lt,pe)}}let dt;ie?dt=st*J-et*V:dt=st*J+et*V,Me+=dt,at&&Q.restore()}ie?k.y-=Me:k.x+=Me*D,Q.restore(),this.compose()}showType3Text(P){const k=this.ctx,B=this.current,z=B.font,Q=B.fontSize,K=B.fontDirection,F=z.vertical?1:-1,I=B.charSpacing,V=B.wordSpacing,D=B.textHScale*K,Y=B.fontMatrix||i.FONT_IDENTITY_MATRIX,ie=P.length,te=B.textRenderingMode===i.TextRenderingMode.INVISIBLE;let j,J,Ae,pe;if(!(te||Q===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,k.save(),k.transform(...B.textMatrix),k.translate(B.x,B.y),k.scale(D,K),j=0;j<ie;++j){if(J=P[j],typeof J=="number"){pe=F*J*Q/1e3,this.ctx.translate(pe,0),B.x+=pe*D;continue}const ve=(J.isSpace?V:0)+I,Te=z.charProcOperatorList[J.operatorListId];if(!Te){(0,i.warn)(`Type3 character "${J.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=J,this.save(),k.scale(Q,Q),k.transform(...Y),this.executeOperatorList(Te),this.restore()),Ae=i.Util.applyTransform([J.width,0],Y)[0]*Q+ve,k.translate(Ae,0),B.x+=Ae*D}k.restore(),this.processingType3=null}}setCharWidth(P,k){}setCharWidthAndBounds(P,k,B,z,Q,K){this.ctx.rect(B,z,Q-B,K-z),this.ctx.clip(),this.endPath()}getColorN_Pattern(P){let k;if(P[0]==="TilingPattern"){const B=P[1],z=this.baseTransform||(0,n.getCurrentTransform)(this.ctx),Q={createCanvasGraphics:K=>new me(K,this.commonObjs,this.objs,this.canvasFactory)};k=new l.TilingPattern(P,B,this.ctx,Q,z)}else k=this._getPattern(P[1],P[2]);return k}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(P,k,B){var Q;const z=((Q=this.selectColor)==null?void 0:Q.call(this,P,k,B))||i.Util.makeHexColor(P,k,B);this.ctx.strokeStyle=z,this.current.strokeColor=z}setFillRGBColor(P,k,B){var Q;const z=((Q=this.selectColor)==null?void 0:Q.call(this,P,k,B))||i.Util.makeHexColor(P,k,B);this.ctx.fillStyle=z,this.current.fillColor=z,this.current.patternFill=!1}_getPattern(P,k=null){let B;return this.cachedPatterns.has(P)?B=this.cachedPatterns.get(P):(B=(0,l.getShadingPattern)(this.objs.get(P)),this.cachedPatterns.set(P,B)),k&&(B.matrix=k),B}shadingFill(P){if(!this.contentVisible)return;const k=this.ctx;this.save();const B=this._getPattern(P);k.fillStyle=B.getPattern(k,this,(0,n.getCurrentTransformInverse)(k),l.PathType.SHADING);const z=(0,n.getCurrentTransformInverse)(k);if(z){const Q=k.canvas,K=Q.width,F=Q.height,I=i.Util.applyTransform([0,0],z),V=i.Util.applyTransform([0,F],z),D=i.Util.applyTransform([K,0],z),Y=i.Util.applyTransform([K,F],z),ie=Math.min(I[0],V[0],D[0],Y[0]),te=Math.min(I[1],V[1],D[1],Y[1]),j=Math.max(I[0],V[0],D[0],Y[0]),J=Math.max(I[1],V[1],D[1],Y[1]);this.ctx.fillRect(ie,te,j-ie,J-te)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,i.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,i.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(P,k){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(P)&&P.length===6&&this.transform(...P),this.baseTransform=(0,n.getCurrentTransform)(this.ctx),k)){const B=k[2]-k[0],z=k[3]-k[1];this.ctx.rect(k[0],k[1],B,z),this.current.updateRectMinMax((0,n.getCurrentTransform)(this.ctx),k),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(P){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const k=this.ctx;P.isolated||(0,i.info)("TODO: Support non-isolated groups."),P.knockout&&(0,i.warn)("Knockout groups not supported.");const B=(0,n.getCurrentTransform)(k);if(P.matrix&&k.transform(...P.matrix),!P.bbox)throw new Error("Bounding box is required.");let z=i.Util.getAxialAlignedBoundingBox(P.bbox,(0,n.getCurrentTransform)(k));const Q=[0,0,k.canvas.width,k.canvas.height];z=i.Util.intersect(z,Q)||[0,0,0,0];const K=Math.floor(z[0]),F=Math.floor(z[1]);let I=Math.max(Math.ceil(z[2])-K,1),V=Math.max(Math.ceil(z[3])-F,1),D=1,Y=1;I>p&&(D=I/p,I=p),V>p&&(Y=V/p,V=p),this.current.startNewPathAndClipBox([0,0,I,V]);let ie="groupAt"+this.groupLevel;P.smask&&(ie+="_smask_"+this.smaskCounter++%2);const te=this.cachedCanvases.getCanvas(ie,I,V),j=te.context;j.scale(1/D,1/Y),j.translate(-K,-F),j.transform(...B),P.smask?this.smaskStack.push({canvas:te.canvas,context:j,offsetX:K,offsetY:F,scaleX:D,scaleY:Y,subtype:P.smask.subtype,backdrop:P.smask.backdrop,transferMap:P.smask.transferMap||null,startTransformInverse:null}):(k.setTransform(1,0,0,1,0,0),k.translate(K,F),k.scale(D,Y),k.save()),w(k,j),this.ctx=j,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(k),this.groupLevel++}endGroup(P){if(!this.contentVisible)return;this.groupLevel--;const k=this.ctx,B=this.groupStack.pop();if(this.ctx=B,this.ctx.imageSmoothingEnabled=!1,P.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const z=(0,n.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...z);const Q=i.Util.getAxialAlignedBoundingBox([0,0,k.canvas.width,k.canvas.height],z);this.ctx.drawImage(k.canvas,0,0),this.ctx.restore(),this.compose(Q)}}beginAnnotation(P,k,B,z,Q){if(Ue(this,re,Hl).call(this),v(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(k)&&k.length===4){const K=k[2]-k[0],F=k[3]-k[1];if(Q&&this.annotationCanvasMap){B=B.slice(),B[4]-=k[0],B[5]-=k[1],k=k.slice(),k[0]=k[1]=0,k[2]=K,k[3]=F;const[I,V]=i.Util.singularValueDecompose2dScale((0,n.getCurrentTransform)(this.ctx)),{viewportScale:D}=this,Y=Math.ceil(K*this.outputScaleX*D),ie=Math.ceil(F*this.outputScaleY*D);this.annotationCanvas=this.canvasFactory.create(Y,ie);const{canvas:te,context:j}=this.annotationCanvas;this.annotationCanvasMap.set(P,te),this.annotationCanvas.savedCtx=this.ctx,this.ctx=j,this.ctx.setTransform(I,0,0,-V,0,F*V),v(this.ctx,this.foregroundColor)}else v(this.ctx,this.foregroundColor),this.ctx.rect(k[0],k[1],K,F),this.ctx.clip(),this.endPath()}this.current=new C(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...B),this.transform(...z)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(P){if(!this.contentVisible)return;const k=P.count;P=this.getObject(P.data,P),P.count=k;const B=this.ctx,z=this.processingType3;if(z&&(z.compiled===void 0&&(z.compiled=O(P)),z.compiled)){z.compiled(B);return}const Q=this._createMaskCanvas(P),K=Q.canvas;B.save(),B.setTransform(1,0,0,1,0,0),B.drawImage(K,Q.offsetX,Q.offsetY),B.restore(),this.compose()}paintImageMaskXObjectRepeat(P,k,B=0,z=0,Q,K){if(!this.contentVisible)return;P=this.getObject(P.data,P);const F=this.ctx;F.save();const I=(0,n.getCurrentTransform)(F);F.transform(k,B,z,Q,0,0);const V=this._createMaskCanvas(P);F.setTransform(1,0,0,1,0,0);for(let D=0,Y=K.length;D<Y;D+=2){const ie=i.Util.transform(I,[k,B,z,Q,K[D],K[D+1]]),[te,j]=i.Util.applyTransform([0,0],ie);F.drawImage(V.canvas,te,j)}F.restore(),this.compose()}paintImageMaskXObjectGroup(P){if(!this.contentVisible)return;const k=this.ctx,B=this.current.fillColor,z=this.current.patternFill;for(const Q of P){const{data:K,width:F,height:I,transform:V}=Q,D=this.cachedCanvases.getCanvas("maskCanvas",F,I),Y=D.context;Y.save();const ie=this.getObject(K,Q);T(Y,ie),Y.globalCompositeOperation="source-in",Y.fillStyle=z?B.getPattern(Y,this,(0,n.getCurrentTransformInverse)(k),l.PathType.FILL):B,Y.fillRect(0,0,F,I),Y.restore(),k.save(),k.transform(...V),k.scale(1,-1),A(k,D.canvas,0,0,F,I,0,-1,1,1),k.restore()}this.compose()}paintImageXObject(P){if(!this.contentVisible)return;const k=this.getObject(P);if(!k){(0,i.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(k)}paintImageXObjectRepeat(P,k,B,z){if(!this.contentVisible)return;const Q=this.getObject(P);if(!Q){(0,i.warn)("Dependent image isn't ready yet");return}const K=Q.width,F=Q.height,I=[];for(let V=0,D=z.length;V<D;V+=2)I.push({transform:[k,0,0,B,z[V],z[V+1]],x:0,y:0,w:K,h:F});this.paintInlineImageXObjectGroup(Q,I)}paintInlineImageXObject(P){if(!this.contentVisible)return;const k=P.width,B=P.height,z=this.ctx;this.save(),z.scale(1/k,-1/B);let Q;if(typeof HTMLElement=="function"&&P instanceof HTMLElement||!P.data)Q=P;else{const V=this.cachedCanvases.getCanvas("inlineImage",k,B),D=V.context;R(D,P,this.current.transferMaps),Q=V.canvas}const K=this._scaleImage(Q,(0,n.getCurrentTransformInverse)(z));z.imageSmoothingEnabled=_e((0,n.getCurrentTransform)(z),P.interpolate);const[F,I]=A(z,K.img,0,0,K.paintWidth,K.paintHeight,0,-B,k,B);if(this.imageLayer){const[V,D]=i.Util.applyTransform([0,-B],(0,n.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:P,left:V,top:D,width:F,height:I})}this.compose(),this.restore()}paintInlineImageXObjectGroup(P,k){if(!this.contentVisible)return;const B=this.ctx,z=P.width,Q=P.height,K=this.cachedCanvases.getCanvas("inlineImage",z,Q),F=K.context;R(F,P,this.current.transferMaps);for(const I of k){if(B.save(),B.transform(...I.transform),B.scale(1,-1),A(B,K.canvas,I.x,I.y,I.w,I.h,0,-1,1,1),this.imageLayer){const[V,D]=i.Util.applyTransform([I.x,I.y],(0,n.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:P,left:V,top:D,width:z,height:Q})}B.restore()}this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(P){}markPointProps(P,k){}beginMarkedContent(P){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(P,k){P==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(k)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(P){const k=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(P);const B=this.ctx;this.pendingClip&&(k||(this.pendingClip===se?B.clip("evenodd"):B.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),B.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const P=(0,n.getCurrentTransform)(this.ctx);if(P[1]===0&&P[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(P[0]),Math.abs(P[3]));else{const k=Math.abs(P[0]*P[3]-P[2]*P[1]),B=Math.hypot(P[0],P[2]),z=Math.hypot(P[1],P[3]);this._cachedGetSinglePixelWidth=Math.max(B,z)/k}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:P}=this.current,k=(0,n.getCurrentTransform)(this.ctx);let B,z;if(k[1]===0&&k[2]===0){const Q=Math.abs(k[0]),K=Math.abs(k[3]);if(P===0)B=1/Q,z=1/K;else{const F=Q*P,I=K*P;B=F<1?1/F:1,z=I<1?1/I:1}}else{const Q=Math.abs(k[0]*k[3]-k[2]*k[1]),K=Math.hypot(k[0],k[1]),F=Math.hypot(k[2],k[3]);if(P===0)B=F/Q,z=K/Q;else{const I=P*Q;B=F>I?F/I:1,z=K>I?K/I:1}}this._cachedScaleForStroking=[B,z]}return this._cachedScaleForStroking}rescaleAndStroke(P){const{ctx:k}=this,{lineWidth:B}=this.current,[z,Q]=this.getScaleForStroking();if(k.lineWidth=B||1,z===1&&Q===1){k.stroke();return}let K,F,I;P&&(K=(0,n.getCurrentTransform)(k),F=k.getLineDash().slice(),I=k.lineDashOffset),k.scale(z,Q);const V=Math.max(z,Q);k.setLineDash(k.getLineDash().map(D=>D/V)),k.lineDashOffset/=V,k.stroke(),P&&(k.setTransform(...K),k.setLineDash(F),k.lineDashOffset=I)}isContentVisible(){for(let P=this.markedContentStack.length-1;P>=0;P--)if(!this.markedContentStack[P].visible)return!1;return!0}};re=new WeakSet,Hl=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)};let ue=me;r.CanvasGraphics=ue;for(const N in i.OPS)ue.prototype[N]!==void 0&&(ue.prototype[i.OPS[N]]=ue.prototype[N])},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TilingPattern=r.PathType=void 0,r.getShadingPattern=x;var n=t(1),i=t(8),l=t(3);const c={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};r.PathType=c;function f(A,O){if(!O||l.isNodeJS)return;const C=O[2]-O[0],R=O[3]-O[1],T=new Path2D;T.rect(O[0],O[1],C,R),A.clip(T)}class d{constructor(){this.constructor===d&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class h extends d{constructor(O){super(),this._type=O[1],this._bbox=O[2],this._colorStops=O[3],this._p0=O[4],this._p1=O[5],this._r0=O[6],this._r1=O[7],this.matrix=null}_createGradient(O){let C;this._type==="axial"?C=O.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(C=O.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const R of this._colorStops)C.addColorStop(R[0],R[1]);return C}getPattern(O,C,R,T){let w;if(T===c.STROKE||T===c.FILL){const v=C.current.getClippedPathBoundingBox(T,(0,i.getCurrentTransform)(O))||[0,0,0,0],L=Math.ceil(v[2]-v[0])||1,M=Math.ceil(v[3]-v[1])||1,X=C.cachedCanvases.getCanvas("pattern",L,M,!0),H=X.context;H.clearRect(0,0,H.canvas.width,H.canvas.height),H.beginPath(),H.rect(0,0,H.canvas.width,H.canvas.height),H.translate(-v[0],-v[1]),R=n.Util.transform(R,[1,0,0,1,v[0],v[1]]),H.transform(...C.baseTransform),this.matrix&&H.transform(...this.matrix),f(H,this._bbox),H.fillStyle=this._createGradient(H),H.fill(),w=O.createPattern(X.canvas,"no-repeat");const ne=new DOMMatrix(R);try{w.setTransform(ne)}catch(_e){(0,n.warn)(`RadialAxialShadingPattern.getPattern: "${_e==null?void 0:_e.message}".`)}}else f(O,this._bbox),w=this._createGradient(O);return w}}function p(A,O,C,R,T,w,v,L){const M=O.coords,X=O.colors,H=A.data,ne=A.width*4;let _e;M[C+1]>M[R+1]&&(_e=C,C=R,R=_e,_e=w,w=v,v=_e),M[R+1]>M[T+1]&&(_e=R,R=T,T=_e,_e=v,v=L,L=_e),M[C+1]>M[R+1]&&(_e=C,C=R,R=_e,_e=w,w=v,v=_e);const ge=(M[C]+O.offsetX)*O.scaleX,he=(M[C+1]+O.offsetY)*O.scaleY,W=(M[R]+O.offsetX)*O.scaleX,se=(M[R+1]+O.offsetY)*O.scaleY,ue=(M[T]+O.offsetX)*O.scaleX,re=(M[T+1]+O.offsetY)*O.scaleY;if(he>=re)return;const q=X[w],me=X[w+1],N=X[w+2],P=X[v],k=X[v+1],B=X[v+2],z=X[L],Q=X[L+1],K=X[L+2],F=Math.round(he),I=Math.round(re);let V,D,Y,ie,te,j,J,Ae;for(let pe=F;pe<=I;pe++){if(pe<se){let we;pe<he?we=0:we=(he-pe)/(he-se),V=ge-(ge-W)*we,D=q-(q-P)*we,Y=me-(me-k)*we,ie=N-(N-B)*we}else{let we;pe>re?we=1:se===re?we=0:we=(se-pe)/(se-re),V=W-(W-ue)*we,D=P-(P-z)*we,Y=k-(k-Q)*we,ie=B-(B-K)*we}let ve;pe<he?ve=0:pe>re?ve=1:ve=(he-pe)/(he-re),te=ge-(ge-ue)*ve,j=q-(q-z)*ve,J=me-(me-Q)*ve,Ae=N-(N-K)*ve;const Te=Math.round(Math.min(V,te)),Me=Math.round(Math.max(V,te));let ze=ne*pe+Te*4;for(let we=Te;we<=Me;we++)ve=(V-we)/(V-te),ve<0?ve=0:ve>1&&(ve=1),H[ze++]=D-(D-j)*ve|0,H[ze++]=Y-(Y-J)*ve|0,H[ze++]=ie-(ie-Ae)*ve|0,H[ze++]=255}}function E(A,O,C){const R=O.coords,T=O.colors;let w,v;switch(O.type){case"lattice":const L=O.verticesPerRow,M=Math.floor(R.length/L)-1,X=L-1;for(w=0;w<M;w++){let H=w*L;for(let ne=0;ne<X;ne++,H++)p(A,C,R[H],R[H+1],R[H+L],T[H],T[H+1],T[H+L]),p(A,C,R[H+L+1],R[H+1],R[H+L],T[H+L+1],T[H+1],T[H+L])}break;case"triangles":for(w=0,v=R.length;w<v;w+=3)p(A,C,R[w],R[w+1],R[w+2],T[w],T[w+1],T[w+2]);break;default:throw new Error("illegal figure")}}class y extends d{constructor(O){super(),this._coords=O[2],this._colors=O[3],this._figures=O[4],this._bounds=O[5],this._bbox=O[7],this._background=O[8],this.matrix=null}_createMeshCanvas(O,C,R){const L=Math.floor(this._bounds[0]),M=Math.floor(this._bounds[1]),X=Math.ceil(this._bounds[2])-L,H=Math.ceil(this._bounds[3])-M,ne=Math.min(Math.ceil(Math.abs(X*O[0]*1.1)),3e3),_e=Math.min(Math.ceil(Math.abs(H*O[1]*1.1)),3e3),ge=X/ne,he=H/_e,W={coords:this._coords,colors:this._colors,offsetX:-L,offsetY:-M,scaleX:1/ge,scaleY:1/he},se=ne+2*2,ue=_e+2*2,re=R.getCanvas("mesh",se,ue,!1),q=re.context,me=q.createImageData(ne,_e);if(C){const P=me.data;for(let k=0,B=P.length;k<B;k+=4)P[k]=C[0],P[k+1]=C[1],P[k+2]=C[2],P[k+3]=255}for(const P of this._figures)E(me,P,W);return q.putImageData(me,2,2),{canvas:re.canvas,offsetX:L-2*ge,offsetY:M-2*he,scaleX:ge,scaleY:he}}getPattern(O,C,R,T){f(O,this._bbox);let w;if(T===c.SHADING)w=n.Util.singularValueDecompose2dScale((0,i.getCurrentTransform)(O));else if(w=n.Util.singularValueDecompose2dScale(C.baseTransform),this.matrix){const L=n.Util.singularValueDecompose2dScale(this.matrix);w=[w[0]*L[0],w[1]*L[1]]}const v=this._createMeshCanvas(w,T===c.SHADING?null:this._background,C.cachedCanvases);return T!==c.SHADING&&(O.setTransform(...C.baseTransform),this.matrix&&O.transform(...this.matrix)),O.translate(v.offsetX,v.offsetY),O.scale(v.scaleX,v.scaleY),O.createPattern(v.canvas,"no-repeat")}}class S extends d{getPattern(){return"hotpink"}}function x(A){switch(A[0]){case"RadialAxial":return new h(A);case"Mesh":return new y(A);case"Dummy":return new S}throw new Error(`Unknown IR type: ${A[0]}`)}const g={COLORED:1,UNCOLORED:2};class m{static get MAX_PATTERN_SIZE(){return(0,n.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(O,C,R,T,w){this.operatorList=O[2],this.matrix=O[3]||[1,0,0,1,0,0],this.bbox=O[4],this.xstep=O[5],this.ystep=O[6],this.paintType=O[7],this.tilingType=O[8],this.color=C,this.ctx=R,this.canvasGraphicsFactory=T,this.baseTransform=w}createPatternCanvas(O){const C=this.operatorList,R=this.bbox,T=this.xstep,w=this.ystep,v=this.paintType,L=this.tilingType,M=this.color,X=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+L);const H=R[0],ne=R[1],_e=R[2],ge=R[3],he=n.Util.singularValueDecompose2dScale(this.matrix),W=n.Util.singularValueDecompose2dScale(this.baseTransform),se=[he[0]*W[0],he[1]*W[1]],ue=this.getSizeAndScale(T,this.ctx.canvas.width,se[0]),re=this.getSizeAndScale(w,this.ctx.canvas.height,se[1]),q=O.cachedCanvases.getCanvas("pattern",ue.size,re.size,!0),me=q.context,N=X.createCanvasGraphics(me);N.groupLevel=O.groupLevel,this.setFillAndStrokeStyleToContext(N,v,M);let P=H,k=ne,B=_e,z=ge;return H<0&&(P=0,B+=Math.abs(H)),ne<0&&(k=0,z+=Math.abs(ne)),me.translate(-(ue.scale*P),-(re.scale*k)),N.transform(ue.scale,0,0,re.scale,0,0),me.save(),this.clipBbox(N,P,k,B,z),N.baseTransform=(0,i.getCurrentTransform)(N.ctx),N.executeOperatorList(C),N.endDrawing(),{canvas:q.canvas,scaleX:ue.scale,scaleY:re.scale,offsetX:P,offsetY:k}}getSizeAndScale(O,C,R){O=Math.abs(O);const T=Math.max(m.MAX_PATTERN_SIZE,C);let w=Math.ceil(O*R);return w>=T?w=T:R=w/O,{scale:R,size:w}}clipBbox(O,C,R,T,w){const v=T-C,L=w-R;O.ctx.rect(C,R,v,L),O.current.updateRectMinMax((0,i.getCurrentTransform)(O.ctx),[C,R,T,w]),O.clip(),O.endPath()}setFillAndStrokeStyleToContext(O,C,R){const T=O.ctx,w=O.current;switch(C){case g.COLORED:const v=this.ctx;T.fillStyle=v.fillStyle,T.strokeStyle=v.strokeStyle,w.fillColor=v.fillStyle,w.strokeColor=v.strokeStyle;break;case g.UNCOLORED:const L=n.Util.makeHexColor(R[0],R[1],R[2]);T.fillStyle=L,T.strokeStyle=L,w.fillColor=L,w.strokeColor=L;break;default:throw new n.FormatError(`Unsupported paint type: ${C}`)}}getPattern(O,C,R,T){let w=R;T!==c.SHADING&&(w=n.Util.transform(w,C.baseTransform),this.matrix&&(w=n.Util.transform(w,this.matrix)));const v=this.createPatternCanvas(C);let L=new DOMMatrix(w);L=L.translate(v.offsetX,v.offsetY),L=L.scale(1/v.scaleX,1/v.scaleY);const M=O.createPattern(v.canvas,"repeat");try{M.setTransform(L)}catch(X){(0,n.warn)(`TilingPattern.getPattern: "${X==null?void 0:X.message}".`)}return M}}r.TilingPattern=m},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.applyMaskImageData=i;var n=t(1);function i({src:l,srcPos:c=0,dest:f,destPos:d=0,width:h,height:p,inverseDecode:E=!1}){const y=n.FeatureTest.isLittleEndian?4278190080:255,[S,x]=E?[0,y]:[y,0],g=h>>3,m=h&7,A=l.length;f=new Uint32Array(f.buffer);for(let O=0;O<p;O++){for(const R=c+g;c<R;c++){const T=c<A?l[c]:255;f[d++]=T&128?x:S,f[d++]=T&64?x:S,f[d++]=T&32?x:S,f[d++]=T&16?x:S,f[d++]=T&8?x:S,f[d++]=T&4?x:S,f[d++]=T&2?x:S,f[d++]=T&1?x:S}if(m===0)continue;const C=c<A?l[c++]:255;for(let R=0;R<m;R++)f[d++]=C&1<<7-R?x:S}return{srcPos:c,destPos:d}}},(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GlobalWorkerOptions=void 0;const t=Object.create(null);r.GlobalWorkerOptions=t,t.workerPort=t.workerPort===void 0?null:t.workerPort,t.workerSrc=t.workerSrc===void 0?"":t.workerSrc},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.MessageHandler=void 0;var n=t(1);const i={UNKNOWN:0,DATA:1,ERROR:2},l={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function c(d){switch(d instanceof Error||typeof d=="object"&&d!==null||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),d.name){case"AbortException":return new n.AbortException(d.message);case"MissingPDFException":return new n.MissingPDFException(d.message);case"PasswordException":return new n.PasswordException(d.message,d.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(d.message,d.status);case"UnknownErrorException":return new n.UnknownErrorException(d.message,d.details);default:return new n.UnknownErrorException(d.message,d.toString())}}class f{constructor(h,p,E){this.sourceName=h,this.targetName=p,this.comObj=E,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=y=>{const S=y.data;if(S.targetName!==this.sourceName)return;if(S.stream){this._processStreamMessage(S);return}if(S.callback){const g=S.callbackId,m=this.callbackCapabilities[g];if(!m)throw new Error(`Cannot resolve callback ${g}`);if(delete this.callbackCapabilities[g],S.callback===i.DATA)m.resolve(S.data);else if(S.callback===i.ERROR)m.reject(c(S.reason));else throw new Error("Unexpected callback case");return}const x=this.actionHandler[S.action];if(!x)throw new Error(`Unknown action from worker: ${S.action}`);if(S.callbackId){const g=this.sourceName,m=S.sourceName;new Promise(function(A){A(x(S.data))}).then(function(A){E.postMessage({sourceName:g,targetName:m,callback:i.DATA,callbackId:S.callbackId,data:A})},function(A){E.postMessage({sourceName:g,targetName:m,callback:i.ERROR,callbackId:S.callbackId,reason:c(A)})});return}if(S.streamId){this._createStreamSink(S);return}x(S.data)},E.addEventListener("message",this._onComObjOnMessage)}on(h,p){const E=this.actionHandler;if(E[h])throw new Error(`There is already an actionName called "${h}"`);E[h]=p}send(h,p,E){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,data:p},E)}sendWithPromise(h,p,E){const y=this.callbackId++,S=(0,n.createPromiseCapability)();this.callbackCapabilities[y]=S;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,callbackId:y,data:p},E)}catch(x){S.reject(x)}return S.promise}sendWithStream(h,p,E,y){const S=this.streamId++,x=this.sourceName,g=this.targetName,m=this.comObj;return new ReadableStream({start:A=>{const O=(0,n.createPromiseCapability)();return this.streamControllers[S]={controller:A,startCall:O,pullCall:null,cancelCall:null,isClosed:!1},m.postMessage({sourceName:x,targetName:g,action:h,streamId:S,data:p,desiredSize:A.desiredSize},y),O.promise},pull:A=>{const O=(0,n.createPromiseCapability)();return this.streamControllers[S].pullCall=O,m.postMessage({sourceName:x,targetName:g,stream:l.PULL,streamId:S,desiredSize:A.desiredSize}),O.promise},cancel:A=>{(0,n.assert)(A instanceof Error,"cancel must have a valid reason");const O=(0,n.createPromiseCapability)();return this.streamControllers[S].cancelCall=O,this.streamControllers[S].isClosed=!0,m.postMessage({sourceName:x,targetName:g,stream:l.CANCEL,streamId:S,reason:c(A)}),O.promise}},E)}_createStreamSink(h){const p=h.streamId,E=this.sourceName,y=h.sourceName,S=this.comObj,x=this,g=this.actionHandler[h.action],m={enqueue(A,O=1,C){if(this.isCancelled)return;const R=this.desiredSize;this.desiredSize-=O,R>0&&this.desiredSize<=0&&(this.sinkCapability=(0,n.createPromiseCapability)(),this.ready=this.sinkCapability.promise),S.postMessage({sourceName:E,targetName:y,stream:l.ENQUEUE,streamId:p,chunk:A},C)},close(){this.isCancelled||(this.isCancelled=!0,S.postMessage({sourceName:E,targetName:y,stream:l.CLOSE,streamId:p}),delete x.streamSinks[p])},error(A){(0,n.assert)(A instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,S.postMessage({sourceName:E,targetName:y,stream:l.ERROR,streamId:p,reason:c(A)}))},sinkCapability:(0,n.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:h.desiredSize,ready:null};m.sinkCapability.resolve(),m.ready=m.sinkCapability.promise,this.streamSinks[p]=m,new Promise(function(A){A(g(h.data,m))}).then(function(){S.postMessage({sourceName:E,targetName:y,stream:l.START_COMPLETE,streamId:p,success:!0})},function(A){S.postMessage({sourceName:E,targetName:y,stream:l.START_COMPLETE,streamId:p,reason:c(A)})})}_processStreamMessage(h){const p=h.streamId,E=this.sourceName,y=h.sourceName,S=this.comObj,x=this.streamControllers[p],g=this.streamSinks[p];switch(h.stream){case l.START_COMPLETE:h.success?x.startCall.resolve():x.startCall.reject(c(h.reason));break;case l.PULL_COMPLETE:h.success?x.pullCall.resolve():x.pullCall.reject(c(h.reason));break;case l.PULL:if(!g){S.postMessage({sourceName:E,targetName:y,stream:l.PULL_COMPLETE,streamId:p,success:!0});break}g.desiredSize<=0&&h.desiredSize>0&&g.sinkCapability.resolve(),g.desiredSize=h.desiredSize,new Promise(function(m){m(g.onPull&&g.onPull())}).then(function(){S.postMessage({sourceName:E,targetName:y,stream:l.PULL_COMPLETE,streamId:p,success:!0})},function(m){S.postMessage({sourceName:E,targetName:y,stream:l.PULL_COMPLETE,streamId:p,reason:c(m)})});break;case l.ENQUEUE:if((0,n.assert)(x,"enqueue should have stream controller"),x.isClosed)break;x.controller.enqueue(h.chunk);break;case l.CLOSE:if((0,n.assert)(x,"close should have stream controller"),x.isClosed)break;x.isClosed=!0,x.controller.close(),this._deleteStreamController(x,p);break;case l.ERROR:(0,n.assert)(x,"error should have stream controller"),x.controller.error(c(h.reason)),this._deleteStreamController(x,p);break;case l.CANCEL_COMPLETE:h.success?x.cancelCall.resolve():x.cancelCall.reject(c(h.reason)),this._deleteStreamController(x,p);break;case l.CANCEL:if(!g)break;new Promise(function(m){m(g.onCancel&&g.onCancel(c(h.reason)))}).then(function(){S.postMessage({sourceName:E,targetName:y,stream:l.CANCEL_COMPLETE,streamId:p,success:!0})},function(m){S.postMessage({sourceName:E,targetName:y,stream:l.CANCEL_COMPLETE,streamId:p,reason:c(m)})}),g.sinkCapability.reject(c(h.reason)),g.isCancelled=!0,delete this.streamSinks[p];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(h,p){await Promise.allSettled([h.startCall&&h.startCall.promise,h.pullCall&&h.pullCall.promise,h.cancelCall&&h.cancelCall.promise]),delete this.streamControllers[p]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}r.MessageHandler=f},(e,r,t)=>{var l,c;Object.defineProperty(r,"__esModule",{value:!0}),r.Metadata=void 0;var n=t(1);class i{constructor({parsedData:d,rawData:h}){Ge(this,l);Ge(this,c);qe(this,l,d),qe(this,c,h)}getRaw(){return oe(this,c)}get(d){return oe(this,l).get(d)??null}getAll(){return(0,n.objectFromMap)(oe(this,l))}has(d){return oe(this,l).has(d)}}l=new WeakMap,c=new WeakMap,r.Metadata=i},(e,r,t)=>{var f,d,h,p,E,y,zl;Object.defineProperty(r,"__esModule",{value:!0}),r.OptionalContentConfig=void 0;var n=t(1);const i=Symbol("INTERNAL");class l{constructor(g,m){Ge(this,f,!0);this.name=g,this.intent=m}get visible(){return oe(this,f)}_setVisible(g,m){g!==i&&(0,n.unreachable)("Internal method `_setVisible` called."),qe(this,f,m)}}f=new WeakMap;class c{constructor(g){Ge(this,y);Ge(this,d,!0);Ge(this,h,new Map);Ge(this,p,null);Ge(this,E,null);if(this.name=null,this.creator=null,g!==null){this.name=g.name,this.creator=g.creator,qe(this,E,g.order);for(const m of g.groups)oe(this,h).set(m.id,new l(m.name,m.intent));if(g.baseState==="OFF")for(const m of oe(this,h).values())m._setVisible(i,!1);for(const m of g.on)oe(this,h).get(m)._setVisible(i,!0);for(const m of g.off)oe(this,h).get(m)._setVisible(i,!1);qe(this,p,new Map);for(const[m,A]of oe(this,h))oe(this,p).set(m,A.visible)}}isVisible(g){if(oe(this,h).size===0)return!0;if(!g)return(0,n.warn)("Optional content group not defined."),!0;if(g.type==="OCG")return oe(this,h).has(g.id)?oe(this,h).get(g.id).visible:((0,n.warn)(`Optional content group not found: ${g.id}`),!0);if(g.type==="OCMD"){if(g.expression)return Ue(this,y,zl).call(this,g.expression);if(!g.policy||g.policy==="AnyOn"){for(const m of g.ids){if(!oe(this,h).has(m))return(0,n.warn)(`Optional content group not found: ${m}`),!0;if(oe(this,h).get(m).visible)return!0}return!1}else if(g.policy==="AllOn"){for(const m of g.ids){if(!oe(this,h).has(m))return(0,n.warn)(`Optional content group not found: ${m}`),!0;if(!oe(this,h).get(m).visible)return!1}return!0}else if(g.policy==="AnyOff"){for(const m of g.ids){if(!oe(this,h).has(m))return(0,n.warn)(`Optional content group not found: ${m}`),!0;if(!oe(this,h).get(m).visible)return!0}return!1}else if(g.policy==="AllOff"){for(const m of g.ids){if(!oe(this,h).has(m))return(0,n.warn)(`Optional content group not found: ${m}`),!0;if(oe(this,h).get(m).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${g.policy}.`),!0}return(0,n.warn)(`Unknown group type ${g.type}.`),!0}setVisibility(g,m=!0){if(!oe(this,h).has(g)){(0,n.warn)(`Optional content group not found: ${g}`);return}oe(this,h).get(g)._setVisible(i,!!m),qe(this,d,null)}get hasInitialVisibility(){if(oe(this,d)!==null)return oe(this,d);for(const[g,m]of oe(this,h)){const A=oe(this,p).get(g);if(m.visible!==A)return qe(this,d,!1)}return qe(this,d,!0)}getOrder(){return oe(this,h).size?oe(this,E)?oe(this,E).slice():[...oe(this,h).keys()]:null}getGroups(){return oe(this,h).size>0?(0,n.objectFromMap)(oe(this,h)):null}getGroup(g){return oe(this,h).get(g)||null}}d=new WeakMap,h=new WeakMap,p=new WeakMap,E=new WeakMap,y=new WeakSet,zl=function(g){const m=g.length;if(m<2)return!0;const A=g[0];for(let O=1;O<m;O++){const C=g[O];let R;if(Array.isArray(C))R=Ue(this,y,zl).call(this,C);else if(oe(this,h).has(C))R=oe(this,h).get(C).visible;else return(0,n.warn)(`Optional content group not found: ${C}`),!0;switch(A){case"And":if(!R)return!1;break;case"Or":if(R)return!0;break;case"Not":return!R;default:return!0}}return A==="And"},r.OptionalContentConfig=c},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFDataTransportStream=void 0;var n=t(1),i=t(8);class l{constructor(h,p){(0,n.assert)(p,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=h.progressiveDone||!1,this._contentDispositionFilename=h.contentDispositionFilename||null;const E=h.initialData;if((E==null?void 0:E.length)>0){const y=new Uint8Array(E).buffer;this._queuedChunks.push(y)}this._pdfDataRangeTransport=p,this._isStreamingSupported=!h.disableStream,this._isRangeSupported=!h.disableRange,this._contentLength=h.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((y,S)=>{this._onReceiveData({begin:y,chunk:S})}),this._pdfDataRangeTransport.addProgressListener((y,S)=>{this._onProgress({loaded:y,total:S})}),this._pdfDataRangeTransport.addProgressiveReadListener(y=>{this._onReceiveData({chunk:y})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(h){const p=new Uint8Array(h.chunk).buffer;if(h.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(p):this._queuedChunks.push(p);else{const E=this._rangeReaders.some(function(y){return y._begin!==h.begin?!1:(y._enqueue(p),!0)});(0,n.assert)(E,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var h;return((h=this._fullRequestReader)==null?void 0:h._loaded)??0}_onProgress(h){if(h.total===void 0){const p=this._rangeReaders[0];p!=null&&p.onProgress&&p.onProgress({loaded:h.loaded})}else{const p=this._fullRequestReader;p!=null&&p.onProgress&&p.onProgress({loaded:h.loaded,total:h.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(h){const p=this._rangeReaders.indexOf(h);p>=0&&this._rangeReaders.splice(p,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const h=this._queuedChunks;return this._queuedChunks=null,new c(this,h,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(h,p){if(p<=this._progressiveDataLength)return null;const E=new f(this,h,p);return this._pdfDataRangeTransport.requestDataRange(h,p),this._rangeReaders.push(E),E}cancelAllRequests(h){this._fullRequestReader&&this._fullRequestReader.cancel(h);for(const p of this._rangeReaders.slice(0))p.cancel(h);this._pdfDataRangeTransport.abort()}}r.PDFDataTransportStream=l;class c{constructor(h,p,E=!1,y=null){this._stream=h,this._done=E||!1,this._filename=(0,i.isPdfFile)(y)?y:null,this._queuedChunks=p||[],this._loaded=0;for(const S of this._queuedChunks)this._loaded+=S.byteLength;this._requests=[],this._headersReady=Promise.resolve(),h._fullRequestReader=this,this.onProgress=null}_enqueue(h){this._done||(this._requests.length>0?this._requests.shift().resolve({value:h,done:!1}):this._queuedChunks.push(h),this._loaded+=h.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const h=(0,n.createPromiseCapability)();return this._requests.push(h),h.promise}cancel(h){this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class f{constructor(h,p,E){this._stream=h,this._begin=p,this._end=E,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(h){if(!this._done){if(this._requests.length===0)this._queuedChunk=h;else{this._requests.shift().resolve({value:h,done:!1});for(const E of this._requests)E.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const p=this._queuedChunk;return this._queuedChunk=null,{value:p,done:!1}}if(this._done)return{value:void 0,done:!0};const h=(0,n.createPromiseCapability)();return this._requests.push(h),h.promise}cancel(h){this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.XfaText=void 0;class t{static textContent(i){const l=[],c={items:l,styles:Object.create(null)};function f(d){var E;if(!d)return;let h=null;const p=d.name;if(p==="#text")h=d.value;else if(t.shouldBuildText(p))(E=d==null?void 0:d.attributes)!=null&&E.textContent?h=d.attributes.textContent:d.value&&(h=d.value);else return;if(h!==null&&l.push({str:h}),!!d.children)for(const y of d.children)f(y)}return f(i),c}static shouldBuildText(i){return!(i==="textarea"||i==="input"||i==="option"||i==="select")}}r.XfaText=t},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.NodeStandardFontDataFactory=r.NodeCanvasFactory=r.NodeCMapReaderFactory=void 0;var n=t(9);const i=function(d){return new Promise((h,p)=>{require$$5.readFile(d,(y,S)=>{if(y||!S){p(new Error(y));return}h(new Uint8Array(S))})})};class l extends n.BaseCanvasFactory{_createCanvas(h,p){return require$$5.createCanvas(h,p)}}r.NodeCanvasFactory=l;class c extends n.BaseCMapReaderFactory{_fetchData(h,p){return i(h).then(E=>({cMapData:E,compressionType:p}))}}r.NodeCMapReaderFactory=c;class f extends n.BaseStandardFontDataFactory{_fetchData(h){return i(h)}}r.NodeStandardFontDataFactory=f},(e,r,t)=>{var d,h,p,E,y,S,x,g,m,Vl,Fh,Xl,Oh;Object.defineProperty(r,"__esModule",{value:!0}),r.AnnotationEditorLayer=void 0;var n=t(7),i=t(1),l=t(23),c=t(24);const T=class T{constructor(v){Ge(this,m);Ge(this,d);Ge(this,h,!1);Ge(this,p,this.pointerup.bind(this));Ge(this,E,this.pointerdown.bind(this));Ge(this,y,new Map);Ge(this,S,!1);Ge(this,x,!1);Ge(this,g);T._initialized||(T._initialized=!0,l.FreeTextEditor.initialize(v.l10n),c.InkEditor.initialize(v.l10n),v.uiManager.registerEditorTypes([l.FreeTextEditor,c.InkEditor])),qe(this,g,v.uiManager),this.annotationStorage=v.annotationStorage,this.pageIndex=v.pageIndex,this.div=v.div,qe(this,d,v.accessibilityManager),oe(this,g).addLayer(this)}updateToolbar(v){oe(this,g).updateToolbar(v)}updateMode(v=oe(this,g).getMode()){Ue(this,m,Oh).call(this),v===i.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),oe(this,g).unselectAll()}addInkEditorIfNeeded(v){if(!v&&oe(this,g).getMode()!==i.AnnotationEditorType.INK)return;if(!v){for(const M of oe(this,y).values())if(M.isEmpty()){M.setInBackground();return}}Ue(this,m,Xl).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(v){oe(this,g).setEditingState(v)}addCommands(v){oe(this,g).addCommands(v)}enable(){this.div.style.pointerEvents="auto";for(const v of oe(this,y).values())v.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const v of oe(this,y).values())v.disableEditing()}setActiveEditor(v){oe(this,g).getActive()!==v&&oe(this,g).setActiveEditor(v)}enableClick(){this.div.addEventListener("pointerdown",oe(this,E)),this.div.addEventListener("pointerup",oe(this,p))}disableClick(){this.div.removeEventListener("pointerdown",oe(this,E)),this.div.removeEventListener("pointerup",oe(this,p))}attach(v){oe(this,y).set(v.id,v)}detach(v){var L;oe(this,y).delete(v.id),(L=oe(this,d))==null||L.removePointerInTextLayer(v.contentDiv)}remove(v){oe(this,g).removeEditor(v),this.detach(v),this.annotationStorage.remove(v.id),v.div.style.display="none",setTimeout(()=>{v.div.style.display="",v.div.remove(),v.isAttachedToDOM=!1,document.activeElement===document.body&&oe(this,g).focusMainContainer()},0),oe(this,x)||this.addInkEditorIfNeeded(!1)}add(v){if(Ue(this,m,Vl).call(this,v),oe(this,g).addEditor(v),this.attach(v),!v.isAttachedToDOM){const L=v.render();this.div.append(L),v.isAttachedToDOM=!0}this.moveEditorInDOM(v),v.onceAdded(),this.addToAnnotationStorage(v)}moveEditorInDOM(v){var L;(L=oe(this,d))==null||L.moveElementInDOM(this.div,v.div,v.contentDiv,!0)}addToAnnotationStorage(v){!v.isEmpty()&&!this.annotationStorage.has(v.id)&&this.annotationStorage.setValue(v.id,v)}addOrRebuild(v){v.needsToBeRebuilt()?v.rebuild():this.add(v)}addANewEditor(v){const L=()=>{this.addOrRebuild(v)},M=()=>{v.remove()};this.addCommands({cmd:L,undo:M,mustExec:!0})}addUndoableEditor(v){const L=()=>{this.addOrRebuild(v)},M=()=>{v.remove()};this.addCommands({cmd:L,undo:M,mustExec:!1})}getNextId(){return oe(this,g).getId()}deserialize(v){switch(v.annotationType){case i.AnnotationEditorType.FREETEXT:return l.FreeTextEditor.deserialize(v,this);case i.AnnotationEditorType.INK:return c.InkEditor.deserialize(v,this)}return null}setSelected(v){oe(this,g).setSelected(v)}toggleSelected(v){oe(this,g).toggleSelected(v)}isSelected(v){return oe(this,g).isSelected(v)}unselect(v){oe(this,g).unselect(v)}pointerup(v){const L=n.KeyboardManager.platform.isMac;if(!(v.button!==0||v.ctrlKey&&L)&&v.target===this.div&&oe(this,S)){if(qe(this,S,!1),!oe(this,h)){qe(this,h,!0);return}Ue(this,m,Xl).call(this,v)}}pointerdown(v){const L=n.KeyboardManager.platform.isMac;if(v.button!==0||v.ctrlKey&&L||v.target!==this.div)return;qe(this,S,!0);const M=oe(this,g).getActive();qe(this,h,!M||M.isEmpty())}drop(v){const L=v.dataTransfer.getData("text/plain"),M=oe(this,g).getEditor(L);if(!M)return;v.preventDefault(),v.dataTransfer.dropEffect="move",Ue(this,m,Vl).call(this,M);const X=this.div.getBoundingClientRect(),H=v.clientX-X.x,ne=v.clientY-X.y;M.translate(H-M.startX,ne-M.startY),this.moveEditorInDOM(M),M.div.focus()}dragover(v){v.preventDefault()}destroy(){var v,L;((v=oe(this,g).getActive())==null?void 0:v.parent)===this&&oe(this,g).setActiveEditor(null);for(const M of oe(this,y).values())(L=oe(this,d))==null||L.removePointerInTextLayer(M.contentDiv),M.isAttachedToDOM=!1,M.div.remove(),M.parent=null;this.div=null,oe(this,y).clear(),oe(this,g).removeLayer(this)}render(v){this.viewport=v.viewport,(0,n.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const L of oe(this,g).getEditors(this.pageIndex))this.add(L);this.updateMode()}update(v){this.viewport=v.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[v,L,M,X]=this.viewport.viewBox,H=M-v,ne=X-L;return[H,ne]}get viewportBaseDimensions(){const{width:v,height:L,rotation:M}=this.viewport;return M%180===0?[v,L]:[L,v]}setDimensions(){const{width:v,height:L,rotation:M}=this.viewport,X=M%180!==0,H=Math.floor(v)+"px",ne=Math.floor(L)+"px";this.div.style.width=X?ne:H,this.div.style.height=X?H:ne,this.div.setAttribute("data-main-rotation",M)}};d=new WeakMap,h=new WeakMap,p=new WeakMap,E=new WeakMap,y=new WeakMap,S=new WeakMap,x=new WeakMap,g=new WeakMap,m=new WeakSet,Vl=function(v){var L;v.parent!==this&&(this.attach(v),v.pageIndex=this.pageIndex,(L=v.parent)==null||L.detach(v),v.parent=this,v.div&&v.isAttachedToDOM&&(v.div.remove(),this.div.append(v.div)))},Fh=function(v){switch(oe(this,g).getMode()){case i.AnnotationEditorType.FREETEXT:return new l.FreeTextEditor(v);case i.AnnotationEditorType.INK:return new c.InkEditor(v)}return null},Xl=function(v){const L=this.getNextId(),M=Ue(this,m,Fh).call(this,{parent:this,id:L,x:v.offsetX,y:v.offsetY});return M&&this.add(M),M},Oh=function(){qe(this,x,!0);for(const v of oe(this,y).values())v.isEmpty()&&v.remove();qe(this,x,!1)},Bt(T,"_initialized",!1);let f=T;r.AnnotationEditorLayer=f},(e,r,t)=>{var f,d,h,p,E,y,S,x,Dh,Ph,Mh,Gl;Object.defineProperty(r,"__esModule",{value:!0}),r.FreeTextEditor=void 0;var n=t(1),i=t(7),l=t(6);const C=class C extends l.AnnotationEditor{constructor(w){super({...w,name:"freeTextEditor"});Ge(this,x);Ge(this,f,this.editorDivBlur.bind(this));Ge(this,d,this.editorDivFocus.bind(this));Ge(this,h,this.editorDivKeydown.bind(this));Ge(this,p);Ge(this,E,"");Ge(this,y,!1);Ge(this,S);qe(this,p,w.color||C._defaultColor||l.AnnotationEditor._defaultLineColor),qe(this,S,w.fontSize||C._defaultFontSize)}static initialize(w){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(L=>[L,w.get(L)]));const v=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(v.getPropertyValue("--freetext-padding"))}static updateDefaultParams(w,v){switch(w){case n.AnnotationEditorParamsType.FREETEXT_SIZE:C._defaultFontSize=v;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:C._defaultColor=v;break}}updateParams(w,v){switch(w){case n.AnnotationEditorParamsType.FREETEXT_SIZE:Ue(this,x,Dh).call(this,v);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:Ue(this,x,Ph).call(this,v);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,C._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,C._defaultColor||l.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,oe(this,S)],[n.AnnotationEditorParamsType.FREETEXT_COLOR,oe(this,p)]]}getInitialTranslation(){return[-C._internalPadding*this.parent.scaleFactor,-(C._internalPadding+oe(this,S))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",oe(this,h)),this.editorDiv.addEventListener("focus",oe(this,d)),this.editorDiv.addEventListener("blur",oe(this,f)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",oe(this,h)),this.editorDiv.removeEventListener("focus",oe(this,d)),this.editorDiv.removeEventListener("blur",oe(this,f)),this.div.focus(),this.isEditing=!1)}focusin(w){super.focusin(w),w.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}commit(){super.commit(),oe(this,y)||(qe(this,y,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),qe(this,E,Ue(this,x,Mh).call(this).trimEnd()),Ue(this,x,Gl).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(w){this.enableEditMode(),this.editorDiv.focus()}keydown(w){w.target===this.div&&w.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(w){C._keyboardManager.exec(this,w)}editorDivFocus(w){this.isEditing=!0}editorDivBlur(w){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let w,v;this.width&&(w=this.x,v=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),C._l10nPromise.get("editor_free_text_aria_label").then(M=>{var X;return(X=this.editorDiv)==null?void 0:X.setAttribute("aria-label",M)}),C._l10nPromise.get("free_text_default_content").then(M=>{var X;return(X=this.editorDiv)==null?void 0:X.setAttribute("default-content",M)}),this.editorDiv.contentEditable=!0;const{style:L}=this.editorDiv;if(L.fontSize=`calc(${oe(this,S)}px * var(--scale-factor))`,L.color=oe(this,p),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,i.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[M,X]=this.parent.viewportBaseDimensions;this.setAt(w*M,v*X,this.width*M,this.height*X);for(const H of oe(this,E).split(`
`)){const ne=document.createElement("div");ne.append(H?document.createTextNode(H):document.createElement("br")),this.editorDiv.append(ne)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(w,v){const L=super.deserialize(w,v);return qe(L,S,w.fontSize),qe(L,p,n.Util.makeHexColor(...w.color)),qe(L,E,w.value),L}serialize(){if(this.isEmpty())return null;const w=C._internalPadding*this.parent.scaleFactor,v=this.getRect(w,w),L=l.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:n.AnnotationEditorType.FREETEXT,color:L,fontSize:oe(this,S),value:oe(this,E),pageIndex:this.parent.pageIndex,rect:v,rotation:this.rotation}}};f=new WeakMap,d=new WeakMap,h=new WeakMap,p=new WeakMap,E=new WeakMap,y=new WeakMap,S=new WeakMap,x=new WeakSet,Dh=function(w){const v=M=>{this.editorDiv.style.fontSize=`calc(${M}px * var(--scale-factor))`,this.translate(0,-(M-oe(this,S))*this.parent.scaleFactor),qe(this,S,M),Ue(this,x,Gl).call(this)},L=oe(this,S);this.parent.addCommands({cmd:()=>{v(w)},undo:()=>{v(L)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Ph=function(w){const v=oe(this,p);this.parent.addCommands({cmd:()=>{qe(this,p,w),this.editorDiv.style.color=w},undo:()=>{qe(this,p,v),this.editorDiv.style.color=v},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Mh=function(){const w=this.editorDiv.getElementsByTagName("div");if(w.length===0)return this.editorDiv.innerText;const v=[];for(let L=0,M=w.length;L<M;L++){const H=w[L].firstChild;(H==null?void 0:H.nodeName)==="#text"?v.push(H.data):v.push("")}return v.join(`
`)},Gl=function(){const[w,v]=this.parent.viewportBaseDimensions,L=this.div.getBoundingClientRect();this.width=L.width/w,this.height=L.height/v},Bt(C,"_freeTextDefaultContent",""),Bt(C,"_l10nPromise"),Bt(C,"_internalPadding",0),Bt(C,"_defaultColor",null),Bt(C,"_defaultFontSize",10),Bt(C,"_keyboardManager",new i.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],C.prototype.commitOrRemove]])),Bt(C,"_type","freetext");let c=C;r.FreeTextEditor=c},(e,r,t)=>{var h,p,E,y,S,x,g,m,A,O,C,R,T,w,v,Lh,Nh,Ih,Bh,ql,Uh,jh,Hh,Ur,$l,Ri,Fi,wn,Wl,Oi,P,Yl,zh,Vh,Xh,Kl,Di,Cn,Jl;Object.defineProperty(r,"__esModule",{value:!0}),r.InkEditor=void 0,Object.defineProperty(r,"fitCurve",{enumerable:!0,get:function(){return l.fitCurve}});var n=t(1),i=t(6),l=t(25),c=t(7);const f=16,D=class D extends i.AnnotationEditor{constructor(te){super({...te,name:"inkEditor"});Ge(this,v);Ge(this,h,0);Ge(this,p,0);Ge(this,E,0);Ge(this,y,this.canvasPointermove.bind(this));Ge(this,S,this.canvasPointerleave.bind(this));Ge(this,x,this.canvasPointerup.bind(this));Ge(this,g,this.canvasPointerdown.bind(this));Ge(this,m,!1);Ge(this,A,!1);Ge(this,O,null);Ge(this,C,null);Ge(this,R,0);Ge(this,T,0);Ge(this,w,null);this.color=te.color||null,this.thickness=te.thickness||null,this.opacity=te.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(te){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(j=>[j,te.get(j)]))}static updateDefaultParams(te,j){switch(te){case n.AnnotationEditorParamsType.INK_THICKNESS:D._defaultThickness=j;break;case n.AnnotationEditorParamsType.INK_COLOR:D._defaultColor=j;break;case n.AnnotationEditorParamsType.INK_OPACITY:D._defaultOpacity=j/100;break}}updateParams(te,j){switch(te){case n.AnnotationEditorParamsType.INK_THICKNESS:Ue(this,v,Lh).call(this,j);break;case n.AnnotationEditorParamsType.INK_COLOR:Ue(this,v,Nh).call(this,j);break;case n.AnnotationEditorParamsType.INK_OPACITY:Ue(this,v,Ih).call(this,j);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,D._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,D._defaultColor||i.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(D._defaultOpacity*100)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||D._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||D._defaultColor||i.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??D._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(Ue(this,v,Ri).call(this),Ue(this,v,Fi).call(this)),this.isAttachedToDOM||(this.parent.add(this),Ue(this,v,wn).call(this)),Ue(this,v,Cn).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,oe(this,C).disconnect(),qe(this,C,null),super.remove())}enableEditMode(){oe(this,m)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",oe(this,g)),this.canvas.addEventListener("pointerup",oe(this,x)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",oe(this,g)),this.canvas.removeEventListener("pointerup",oe(this,x)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){oe(this,m)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),qe(this,m,!0),this.div.classList.add("disabled"),Ue(this,v,Cn).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(te){super.focusin(te),this.enableEditMode()}canvasPointerdown(te){te.button!==0||!this.isInEditMode()||oe(this,m)||(this.setInForeground(),te.type!=="mouse"&&this.div.focus(),te.stopPropagation(),this.canvas.addEventListener("pointerleave",oe(this,S)),this.canvas.addEventListener("pointermove",oe(this,y)),Ue(this,v,Uh).call(this,te.offsetX,te.offsetY))}canvasPointermove(te){te.stopPropagation(),Ue(this,v,jh).call(this,te.offsetX,te.offsetY)}canvasPointerup(te){te.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(te.stopPropagation(),Ue(this,v,$l).call(this,te),this.setInBackground())}canvasPointerleave(te){Ue(this,v,$l).call(this,te),this.setInBackground()}render(){if(this.div)return this.div;let te,j;this.width&&(te=this.x,j=this.y),super.render(),D._l10nPromise.get("editor_ink_aria_label").then(Te=>{var Me;return(Me=this.div)==null?void 0:Me.setAttribute("aria-label",Te)});const[J,Ae,pe,ve]=Ue(this,v,Bh).call(this);if(this.setAt(J,Ae,0,0),this.setDims(pe,ve),Ue(this,v,Ri).call(this),this.width){const[Te,Me]=this.parent.viewportBaseDimensions;this.setAt(te*Te,j*Me,this.width*Te,this.height*Me),qe(this,A,!0),Ue(this,v,wn).call(this),this.setDims(this.width*Te,this.height*Me),Ue(this,v,Ur).call(this),Ue(this,v,Jl).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return Ue(this,v,Fi).call(this),this.div}setDimensions(te,j){const J=Math.round(te),Ae=Math.round(j);if(oe(this,R)===J&&oe(this,T)===Ae)return;qe(this,R,J),qe(this,T,Ae),this.canvas.style.visibility="hidden",oe(this,h)&&Math.abs(oe(this,h)-te/j)>.01&&(j=Math.ceil(te/oe(this,h)),this.setDims(te,j));const[pe,ve]=this.parent.viewportBaseDimensions;this.width=te/pe,this.height=j/ve,oe(this,m)&&Ue(this,v,Wl).call(this,te,j),Ue(this,v,wn).call(this),Ue(this,v,Ur).call(this),this.canvas.style.visibility="visible"}static deserialize(te,j){var at,et;const J=super.deserialize(te,j);J.thickness=te.thickness,J.color=n.Util.makeHexColor(...te.color),J.opacity=te.opacity;const[Ae,pe]=j.pageDimensions,ve=J.width*Ae,Te=J.height*pe,Me=j.scaleFactor,ze=te.thickness/2;qe(J,h,ve/Te),qe(J,m,!0),qe(J,R,Math.round(ve)),qe(J,T,Math.round(Te));for(const{bezier:Ke}of te.paths){const Ze=[];J.paths.push(Ze);let ft=Me*(Ke[0]-ze),Je=Me*(Te-Ke[1]-ze);for(let dt=2,nt=Ke.length;dt<nt;dt+=6){const lt=Me*(Ke[dt]-ze),or=Me*(Te-Ke[dt+1]-ze),Wt=Me*(Ke[dt+2]-ze),Pt=Me*(Te-Ke[dt+3]-ze),Pe=Me*(Ke[dt+4]-ze),Ee=Me*(Te-Ke[dt+5]-ze);Ze.push([[ft,Je],[lt,or],[Wt,Pt],[Pe,Ee]]),ft=Pe,Je=Ee}const st=Ue(this,P,Yl).call(this,Ze);J.bezierPath2D.push(st)}const we=Ue(at=J,v,Kl).call(at);return qe(J,E,Math.max(f,we[2]-we[0])),qe(J,p,Math.max(f,we[3]-we[1])),Ue(et=J,v,Wl).call(et,ve,Te),J}serialize(){if(this.isEmpty())return null;const te=this.getRect(0,0),j=this.rotation%180===0?te[3]-te[1]:te[2]-te[0],J=i.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:J,thickness:this.thickness,opacity:this.opacity,paths:Ue(this,v,zh).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,j),pageIndex:this.parent.pageIndex,rect:te,rotation:this.rotation}}};h=new WeakMap,p=new WeakMap,E=new WeakMap,y=new WeakMap,S=new WeakMap,x=new WeakMap,g=new WeakMap,m=new WeakMap,A=new WeakMap,O=new WeakMap,C=new WeakMap,R=new WeakMap,T=new WeakMap,w=new WeakMap,v=new WeakSet,Lh=function(te){const j=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=te,Ue(this,v,Cn).call(this)},undo:()=>{this.thickness=j,Ue(this,v,Cn).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Nh=function(te){const j=this.color;this.parent.addCommands({cmd:()=>{this.color=te,Ue(this,v,Ur).call(this)},undo:()=>{this.color=j,Ue(this,v,Ur).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Ih=function(te){te/=100;const j=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=te,Ue(this,v,Ur).call(this)},undo:()=>{this.opacity=j,Ue(this,v,Ur).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Bh=function(){const{width:te,height:j,rotation:J}=this.parent.viewport;switch(J){case 90:return[0,te,te,j];case 180:return[te,j,te,j];case 270:return[j,0,te,j];default:return[0,0,te,j]}},ql=function(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,c.opacityToHex)(this.opacity)}`},Uh=function(te,j){this.isEditing=!0,oe(this,A)||(qe(this,A,!0),Ue(this,v,wn).call(this),this.thickness||(this.thickness=D._defaultThickness),this.color||(this.color=D._defaultColor||i.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=D._defaultOpacity)),this.currentPath.push([te,j]),qe(this,O,null),Ue(this,v,ql).call(this),this.ctx.beginPath(),this.ctx.moveTo(te,j),qe(this,w,()=>{oe(this,w)&&(oe(this,O)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):Ue(this,v,Ur).call(this),this.ctx.lineTo(...oe(this,O)),qe(this,O,null),this.ctx.stroke()),window.requestAnimationFrame(oe(this,w)))}),window.requestAnimationFrame(oe(this,w))},jh=function(te,j){const[J,Ae]=this.currentPath.at(-1);te===J&&j===Ae||(this.currentPath.push([te,j]),qe(this,O,[te,j]))},Hh=function(te,j){var ze;this.ctx.closePath(),qe(this,w,null),te=Math.min(Math.max(te,0),this.canvas.width),j=Math.min(Math.max(j,0),this.canvas.height);const[J,Ae]=this.currentPath.at(-1);(te!==J||j!==Ae)&&this.currentPath.push([te,j]);let pe;if(this.currentPath.length!==1)pe=(0,l.fitCurve)(this.currentPath,30,null);else{const we=[te,j];pe=[[we,we.slice(),we.slice(),we]]}const ve=Ue(ze=D,P,Yl).call(ze,pe);this.currentPath.length=0;const Te=()=>{this.paths.push(pe),this.bezierPath2D.push(ve),this.rebuild()},Me=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(Ue(this,v,Ri).call(this),Ue(this,v,Fi).call(this)),Ue(this,v,Cn).call(this))};this.parent.addCommands({cmd:Te,undo:Me,mustExec:!0})},Ur=function(){if(this.isEmpty()){Ue(this,v,Oi).call(this);return}Ue(this,v,ql).call(this);const{canvas:te,ctx:j}=this;j.setTransform(1,0,0,1,0,0),j.clearRect(0,0,te.width,te.height),Ue(this,v,Oi).call(this);for(const J of this.bezierPath2D)j.stroke(J)},$l=function(te){Ue(this,v,Hh).call(this,te.offsetX,te.offsetY),this.canvas.removeEventListener("pointerleave",oe(this,S)),this.canvas.removeEventListener("pointermove",oe(this,y)),this.parent.addToAnnotationStorage(this)},Ri=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",D._l10nPromise.get("editor_ink_canvas_aria_label").then(te=>{var j;return(j=this.canvas)==null?void 0:j.setAttribute("aria-label",te)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Fi=function(){qe(this,C,new ResizeObserver(te=>{const j=te[0].contentRect;j.width&&j.height&&this.setDimensions(j.width,j.height)})),oe(this,C).observe(this.div)},wn=function(){if(!oe(this,A))return;const[te,j]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*te),this.canvas.height=Math.ceil(this.height*j),Ue(this,v,Oi).call(this)},Wl=function(te,j){const J=Ue(this,v,Di).call(this),Ae=(te-J)/oe(this,E),pe=(j-J)/oe(this,p);this.scaleFactor=Math.min(Ae,pe)},Oi=function(){const te=Ue(this,v,Di).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+te,this.translationY*this.scaleFactor+te)},P=new WeakSet,Yl=function(te){const j=new Path2D;for(let J=0,Ae=te.length;J<Ae;J++){const[pe,ve,Te,Me]=te[J];J===0&&j.moveTo(...pe),j.bezierCurveTo(ve[0],ve[1],Te[0],Te[1],Me[0],Me[1])}return j},zh=function(te,j,J,Ae){const ve=[],Te=this.thickness/2;let Me,ze;for(const we of this.paths){Me=[],ze=[];for(let at=0,et=we.length;at<et;at++){const[Ke,Ze,ft,Je]=we[at],st=te*(Ke[0]+j)+Te,dt=Ae-te*(Ke[1]+J)-Te,nt=te*(Ze[0]+j)+Te,lt=Ae-te*(Ze[1]+J)-Te,or=te*(ft[0]+j)+Te,Wt=Ae-te*(ft[1]+J)-Te,Pt=te*(Je[0]+j)+Te,Pe=Ae-te*(Je[1]+J)-Te;at===0&&(Me.push(st,dt),ze.push(st,dt)),Me.push(nt,lt,or,Wt,Pt,Pe),Ue(this,v,Vh).call(this,st,dt,nt,lt,or,Wt,Pt,Pe,4,ze)}ve.push({bezier:Me,points:ze})}return ve},Vh=function(te,j,J,Ae,pe,ve,Te,Me,ze,we){if(Ue(this,v,Xh).call(this,te,j,J,Ae,pe,ve,Te,Me)){we.push(Te,Me);return}for(let at=1;at<ze-1;at++){const et=at/ze,Ke=1-et;let Ze=et*te+Ke*J,ft=et*j+Ke*Ae,Je=et*J+Ke*pe,st=et*Ae+Ke*ve;const dt=et*pe+Ke*Te,nt=et*ve+Ke*Me;Ze=et*Ze+Ke*Je,ft=et*ft+Ke*st,Je=et*Je+Ke*dt,st=et*st+Ke*nt,Ze=et*Ze+Ke*Je,ft=et*ft+Ke*st,we.push(Ze,ft)}we.push(Te,Me)},Xh=function(te,j,J,Ae,pe,ve,Te,Me){const we=(3*J-2*te-Te)**2,at=(3*Ae-2*j-Me)**2,et=(3*pe-te-2*Te)**2,Ke=(3*ve-j-2*Me)**2;return Math.max(we,et)+Math.max(at,Ke)<=10},Kl=function(){let te=1/0,j=-1/0,J=1/0,Ae=-1/0;for(const pe of this.paths)for(const[ve,Te,Me,ze]of pe){const we=n.Util.bezierBoundingBox(...ve,...Te,...Me,...ze);te=Math.min(te,we[0]),J=Math.min(J,we[1]),j=Math.max(j,we[2]),Ae=Math.max(Ae,we[3])}return[te,J,j,Ae]},Di=function(){return oe(this,m)?Math.ceil(this.thickness*this.parent.scaleFactor):0},Cn=function(te=!1){if(this.isEmpty())return;if(!oe(this,m)){Ue(this,v,Ur).call(this);return}const j=Ue(this,v,Kl).call(this),J=Ue(this,v,Di).call(this);qe(this,E,Math.max(f,j[2]-j[0])),qe(this,p,Math.max(f,j[3]-j[1]));const Ae=Math.ceil(J+oe(this,E)*this.scaleFactor),pe=Math.ceil(J+oe(this,p)*this.scaleFactor),[ve,Te]=this.parent.viewportBaseDimensions;this.width=Ae/ve,this.height=pe/Te,qe(this,h,Ae/pe),Ue(this,v,Jl).call(this);const Me=this.translationX,ze=this.translationY;this.translationX=-j[0],this.translationY=-j[1],Ue(this,v,wn).call(this),Ue(this,v,Ur).call(this),qe(this,R,Ae),qe(this,T,pe),this.setDims(Ae,pe);const we=te?J/this.scaleFactor/2:0;this.translate(Me-this.translationX-we,ze-this.translationY-we)},Jl=function(){const{style:te}=this.div;oe(this,h)>=1?(te.minHeight=`${f}px`,te.minWidth=`${Math.round(oe(this,h)*f)}px`):(te.minWidth=`${f}px`,te.minHeight=`${Math.round(f/oe(this,h))}px`)},Ge(D,P),Bt(D,"_defaultColor",null),Bt(D,"_defaultOpacity",1),Bt(D,"_defaultThickness",1),Bt(D,"_l10nPromise"),Bt(D,"_type","ink");let d=D;r.InkEditor=d},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.fitCurve=void 0;const n=t(26);r.fitCurve=n},e=>{function r(x,g,m){if(!Array.isArray(x))throw new TypeError("First argument should be an array");if(x.forEach(R=>{if(!Array.isArray(R)||R.some(T=>typeof T!="number")||R.length!==x[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),x=x.filter((R,T)=>T===0||!R.every((w,v)=>w===x[T-1][v])),x.length<2)return[];const A=x.length,O=E(x[1],x[0]),C=E(x[A-2],x[A-1]);return t(x,O,C,g,m)}function t(x,g,m,A,O){var R,T,w,v,L,M,X,H,ne,_e,ge,he,W;if(x.length===2)return he=y.vectorLen(y.subtract(x[0],x[1]))/3,R=[x[0],y.addArrays(x[0],y.mulItems(g,he)),y.addArrays(x[1],y.mulItems(m,he)),x[1]],[R];if(T=f(x),[R,v,M]=n(x,T,T,g,m,O),v===0||v<A)return[R];if(v<A*A)for(w=T,L=v,X=M,W=0;W<20;W++){if(w=l(R,x,w),[R,v,M]=n(x,T,w,g,m,O),v<A)return[R];if(M===X){let se=v/L;if(se>.9999&&se<1.0001)break}L=v,X=M}return ge=[],H=y.subtract(x[M-1],x[M+1]),H.every(se=>se===0)&&(H=y.subtract(x[M-1],x[M]),[H[0],H[1]]=[-H[1],H[0]]),ne=y.normalize(H),_e=y.mulItems(ne,-1),ge=ge.concat(t(x.slice(0,M+1),g,ne,A,O)),ge=ge.concat(t(x.slice(M),_e,m,A,O)),ge}function n(x,g,m,A,O,C){var R,T,w;return R=i(x,m,A,O),[T,w]=d(x,R,g),C&&C({bez:R,points:x,params:g,maxErr:T,maxPoint:w}),[R,T,w]}function i(x,g,m,A){var O,C,R,T,w,v,L,M,X,H,ne,_e,ge,he,W,se,ue,re=x[0],q=x[x.length-1];for(O=[re,null,null,q],C=y.zeros_Xx2x2(g.length),ge=0,he=g.length;ge<he;ge++)se=g[ge],ue=1-se,R=C[ge],R[0]=y.mulItems(m,3*se*(ue*ue)),R[1]=y.mulItems(A,3*ue*(se*se));for(T=[[0,0],[0,0]],w=[0,0],ge=0,he=x.length;ge<he;ge++)se=g[ge],R=C[ge],T[0][0]+=y.dot(R[0],R[0]),T[0][1]+=y.dot(R[0],R[1]),T[1][0]+=y.dot(R[0],R[1]),T[1][1]+=y.dot(R[1],R[1]),W=y.subtract(x[ge],S.q([re,re,q,q],se)),w[0]+=y.dot(R[0],W),w[1]+=y.dot(R[1],W);return v=T[0][0]*T[1][1]-T[1][0]*T[0][1],L=T[0][0]*w[1]-T[1][0]*w[0],M=w[0]*T[1][1]-w[1]*T[0][1],X=v===0?0:M/v,H=v===0?0:L/v,_e=y.vectorLen(y.subtract(re,q)),ne=1e-6*_e,X<ne||H<ne?(O[1]=y.addArrays(re,y.mulItems(m,_e/3)),O[2]=y.addArrays(q,y.mulItems(A,_e/3))):(O[1]=y.addArrays(re,y.mulItems(m,X)),O[2]=y.addArrays(q,y.mulItems(A,H))),O}function l(x,g,m){return m.map((A,O)=>c(x,g[O],A))}function c(x,g,m){var A=y.subtract(S.q(x,m),g),O=S.qprime(x,m),C=y.mulMatrix(A,O),R=y.sum(y.squareItems(O))+2*y.mulMatrix(A,S.qprimeprime(x,m));return R===0?m:m-C/R}function f(x){var g=[],m,A,O;return x.forEach((C,R)=>{m=R?A+y.vectorLen(y.subtract(C,O)):0,g.push(m),A=m,O=C}),g=g.map(C=>C/A),g}function d(x,g,m){var A,O,C,R,T,w,v,L;O=0,C=Math.floor(x.length/2);const M=h(g,10);for(T=0,w=x.length;T<w;T++)v=x[T],L=p(g,m[T],M,10),R=y.subtract(S.q(g,L),v),A=R[0]*R[0]+R[1]*R[1],A>O&&(O=A,C=T);return[O,C]}var h=function(x,g){for(var m,A=[0],O=x[0],C=0,R=1;R<=g;R++)m=S.q(x,R/g),C+=y.vectorLen(y.subtract(m,O)),A.push(C),O=m;return A=A.map(T=>T/C),A};function p(x,g,m,A){if(g<0)return 0;if(g>1)return 1;for(var O,C,R,T,w,v=1;v<=A;v++)if(g<=m[v]){T=(v-1)/A,R=v/A,C=m[v-1],O=m[v],w=(g-C)/(O-C)*(R-T)+T;break}return w}function E(x,g){return y.normalize(y.subtract(x,g))}class y{static zeros_Xx2x2(g){for(var m=[];g--;)m.push([0,0]);return m}static mulItems(g,m){return g.map(A=>A*m)}static mulMatrix(g,m){return g.reduce((A,O,C)=>A+O*m[C],0)}static subtract(g,m){return g.map((A,O)=>A-m[O])}static addArrays(g,m){return g.map((A,O)=>A+m[O])}static addItems(g,m){return g.map(A=>A+m)}static sum(g){return g.reduce((m,A)=>m+A)}static dot(g,m){return y.mulMatrix(g,m)}static vectorLen(g){return Math.hypot(...g)}static divItems(g,m){return g.map(A=>A/m)}static squareItems(g){return g.map(m=>m*m)}static normalize(g){return this.divItems(g,this.vectorLen(g))}}class S{static q(g,m){var A=1-m,O=y.mulItems(g[0],A*A*A),C=y.mulItems(g[1],3*A*A*m),R=y.mulItems(g[2],3*A*m*m),T=y.mulItems(g[3],m*m*m);return y.addArrays(y.addArrays(O,C),y.addArrays(R,T))}static qprime(g,m){var A=1-m,O=y.mulItems(y.subtract(g[1],g[0]),3*A*A),C=y.mulItems(y.subtract(g[2],g[1]),6*A*m),R=y.mulItems(y.subtract(g[3],g[2]),3*m*m);return y.addArrays(y.addArrays(O,C),R)}static qprimeprime(g,m){return y.addArrays(y.mulItems(y.addArrays(y.subtract(g[2],y.mulItems(g[1],2)),g[0]),6*(1-m)),y.mulItems(y.addArrays(y.subtract(g[3],y.mulItems(g[2],2)),g[1]),6*m))}}e.exports=r,e.exports.fitCubic=t,e.exports.createTangent=E},(e,r,t)=>{var P,Ql,Zl,ec;Object.defineProperty(r,"__esModule",{value:!0}),r.AnnotationLayer=void 0;var n=t(1),i=t(8),l=t(5),c=t(28),f=t(29);const d=1e3,h=9,p=new WeakSet;function E(K){return{width:K[2]-K[0],height:K[3]-K[1]}}class y{static create(F){switch(F.data.annotationType){case n.AnnotationType.LINK:return new x(F);case n.AnnotationType.TEXT:return new g(F);case n.AnnotationType.WIDGET:switch(F.data.fieldType){case"Tx":return new A(F);case"Btn":return F.data.radioButton?new C(F):F.data.checkBox?new O(F):new R(F);case"Ch":return new T(F)}return new m(F);case n.AnnotationType.POPUP:return new w(F);case n.AnnotationType.FREETEXT:return new L(F);case n.AnnotationType.LINE:return new M(F);case n.AnnotationType.SQUARE:return new X(F);case n.AnnotationType.CIRCLE:return new H(F);case n.AnnotationType.POLYLINE:return new ne(F);case n.AnnotationType.CARET:return new ge(F);case n.AnnotationType.INK:return new he(F);case n.AnnotationType.POLYGON:return new _e(F);case n.AnnotationType.HIGHLIGHT:return new W(F);case n.AnnotationType.UNDERLINE:return new se(F);case n.AnnotationType.SQUIGGLY:return new ue(F);case n.AnnotationType.STRIKEOUT:return new re(F);case n.AnnotationType.STAMP:return new q(F);case n.AnnotationType.FILEATTACHMENT:return new me(F);default:return new S(F)}}}class S{constructor(F,{isRenderable:I=!1,ignoreBorder:V=!1,createQuadrilaterals:D=!1}={}){this.isRenderable=I,this.data=F.data,this.layer=F.layer,this.page=F.page,this.viewport=F.viewport,this.linkService=F.linkService,this.downloadManager=F.downloadManager,this.imageResourcesPath=F.imageResourcesPath,this.renderForms=F.renderForms,this.svgFactory=F.svgFactory,this.annotationStorage=F.annotationStorage,this.enableScripting=F.enableScripting,this.hasJSActions=F.hasJSActions,this._fieldObjects=F.fieldObjects,this._mouseState=F.mouseState,I&&(this.container=this._createContainer(V)),D&&(this.quadrilaterals=this._createQuadrilaterals(V))}_createContainer(F=!1){const I=this.data,V=this.page,D=this.viewport,Y=document.createElement("section"),{width:ie,height:te}=E(I.rect),[j,J,Ae,pe]=D.viewBox,ve=Ae-j,Te=pe-J;Y.setAttribute("data-annotation-id",I.id);const Me=n.Util.normalizeRect([I.rect[0],V.view[3]-I.rect[1]+V.view[1],I.rect[2],V.view[3]-I.rect[3]+V.view[1]]);if(!F&&I.borderStyle.width>0){Y.style.borderWidth=`${I.borderStyle.width}px`;const we=I.borderStyle.horizontalCornerRadius,at=I.borderStyle.verticalCornerRadius;if(we>0||at>0){const Ke=`calc(${we}px * var(--scale-factor)) / calc(${at}px * var(--scale-factor))`;Y.style.borderRadius=Ke}else if(this instanceof C){const Ke=`calc(${ie}px * var(--scale-factor)) / calc(${te}px * var(--scale-factor))`;Y.style.borderRadius=Ke}switch(I.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:Y.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:Y.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:Y.style.borderBottomStyle="solid";break}const et=I.borderColor||null;et?Y.style.borderColor=n.Util.makeHexColor(et[0]|0,et[1]|0,et[2]|0):Y.style.borderWidth=0}Y.style.left=`${100*(Me[0]-j)/ve}%`,Y.style.top=`${100*(Me[1]-J)/Te}%`;const{rotation:ze}=I;return I.hasOwnCanvas||ze===0?(Y.style.width=`${100*ie/ve}%`,Y.style.height=`${100*te/Te}%`):this.setRotation(ze,Y),Y}setRotation(F,I=this.container){const[V,D,Y,ie]=this.viewport.viewBox,te=Y-V,j=ie-D,{width:J,height:Ae}=E(this.data.rect);let pe,ve;F%180===0?(pe=100*J/te,ve=100*Ae/j):(pe=100*Ae/te,ve=100*J/j),I.style.width=`${pe}%`,I.style.height=`${ve}%`,I.setAttribute("data-main-rotation",(360-F)%360)}get _commonActions(){const F=(I,V,D)=>{const Y=D.detail[I];D.target.style[V]=c.ColorConverters[`${Y[0]}_HTML`](Y.slice(1))};return(0,n.shadow)(this,"_commonActions",{display:I=>{const V=I.detail.display%2===1;this.container.style.visibility=V?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:V,print:I.detail.display===0||I.detail.display===3})},print:I=>{this.annotationStorage.setValue(this.data.id,{print:I.detail.print})},hidden:I=>{this.container.style.visibility=I.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:I.detail.hidden})},focus:I=>{setTimeout(()=>I.target.focus({preventScroll:!1}),0)},userName:I=>{I.target.title=I.detail.userName},readonly:I=>{I.detail.readonly?I.target.setAttribute("readonly",""):I.target.removeAttribute("readonly")},required:I=>{this._setRequired(I.target,I.detail.required)},bgColor:I=>{F("bgColor","backgroundColor",I)},fillColor:I=>{F("fillColor","backgroundColor",I)},fgColor:I=>{F("fgColor","color",I)},textColor:I=>{F("textColor","color",I)},borderColor:I=>{F("borderColor","borderColor",I)},strokeColor:I=>{F("strokeColor","borderColor",I)},rotation:I=>{const V=I.detail.rotation;this.setRotation(V),this.annotationStorage.setValue(this.data.id,{rotation:V})}})}_dispatchEventFromSandbox(F,I){const V=this._commonActions;for(const D of Object.keys(I.detail)){const Y=F[D]||V[D];Y&&Y(I)}}_setDefaultPropertiesFromJS(F){if(!this.enableScripting)return;const I=this.annotationStorage.getRawValue(this.data.id);if(!I)return;const V=this._commonActions;for(const[D,Y]of Object.entries(I)){const ie=V[D];if(ie){const te={detail:{[D]:Y},target:F};ie(te),delete I[D]}}}_createQuadrilaterals(F=!1){if(!this.data.quadPoints)return null;const I=[],V=this.data.rect;for(const D of this.data.quadPoints)this.data.rect=[D[2].x,D[2].y,D[1].x,D[1].y],I.push(this._createContainer(F));return this.data.rect=V,I}_createPopup(F,I){let V=this.container;this.quadrilaterals&&(F=F||this.quadrilaterals,V=this.quadrilaterals[0]),F||(F=document.createElement("div"),F.className="popupTriggerArea",V.append(F));const Y=new v({container:V,trigger:F,color:I.color,titleObj:I.titleObj,modificationDate:I.modificationDate,contentsObj:I.contentsObj,richText:I.richText,hideWrapper:!0}).render();Y.style.left="100%",V.append(Y)}_renderQuadrilaterals(F){for(const I of this.quadrilaterals)I.className=F;return this.quadrilaterals}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(F,I=null){const V=[];if(this._fieldObjects){const D=this._fieldObjects[F];if(D)for(const{page:Y,id:ie,exportValues:te}of D){if(Y===-1||ie===I)continue;const j=typeof te=="string"?te:null,J=document.querySelector(`[data-element-id="${ie}"]`);if(J&&!p.has(J)){(0,n.warn)(`_getElementsByName - element not allowed: ${ie}`);continue}V.push({id:ie,exportValue:j,domElement:J})}return V}for(const D of document.getElementsByName(F)){const{id:Y,exportValue:ie}=D;Y!==I&&p.has(D)&&V.push({id:Y,exportValue:ie,domElement:D})}return V}static get platform(){const F=typeof navigator<"u"?navigator.platform:"";return(0,n.shadow)(this,"platform",{isWin:F.includes("Win"),isMac:F.includes("Mac")})}}class x extends S{constructor(F,I=null){super(F,{isRenderable:!0,ignoreBorder:!!(I!=null&&I.ignoreBorder),createQuadrilaterals:!0}),this.isTooltipOnly=F.data.isTooltipOnly}render(){const{data:F,linkService:I}=this,V=document.createElement("a");V.setAttribute("data-element-id",F.id);let D=!1;return F.url?(I.addLinkAttributes(V,F.url,F.newWindow),D=!0):F.action?(this._bindNamedAction(V,F.action),D=!0):F.dest?(this._bindLink(V,F.dest),D=!0):(F.actions&&(F.actions.Action||F.actions["Mouse Up"]||F.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(V,F),D=!0),F.resetForm?(this._bindResetFormAction(V,F.resetForm),D=!0):this.isTooltipOnly&&!D&&(this._bindLink(V,""),D=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((Y,ie)=>{const te=ie===0?V:V.cloneNode();return Y.append(te),Y}):(this.container.className="linkAnnotation",D&&this.container.append(V),this.container)}_bindLink(F,I){F.href=this.linkService.getDestinationHash(I),F.onclick=()=>(I&&this.linkService.goToDestination(I),!1),(I||I==="")&&(F.className="internalLink")}_bindNamedAction(F,I){F.href=this.linkService.getAnchorUrl(""),F.onclick=()=>(this.linkService.executeNamedAction(I),!1),F.className="internalLink"}_bindJSAction(F,I){F.href=this.linkService.getAnchorUrl("");const V=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const D of Object.keys(I.actions)){const Y=V.get(D);Y&&(F[Y]=()=>{var ie;return(ie=this.linkService.eventBus)==null||ie.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I.id,name:D}}),!1})}F.onclick||(F.onclick=()=>!1),F.className="internalLink"}_bindResetFormAction(F,I){const V=F.onclick;if(V||(F.href=this.linkService.getAnchorUrl("")),F.className="internalLink",!this._fieldObjects){(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),V||(F.onclick=()=>!1);return}F.onclick=()=>{var Ae;V&&V();const{fields:D,refs:Y,include:ie}=I,te=[];if(D.length!==0||Y.length!==0){const pe=new Set(Y);for(const ve of D){const Te=this._fieldObjects[ve]||[];for(const{id:Me}of Te)pe.add(Me)}for(const ve of Object.values(this._fieldObjects))for(const Te of ve)pe.has(Te.id)===ie&&te.push(Te)}else for(const pe of Object.values(this._fieldObjects))te.push(...pe);const j=this.annotationStorage,J=[];for(const pe of te){const{id:ve}=pe;switch(J.push(ve),pe.type){case"text":{const Me=pe.defaultValue||"";j.setValue(ve,{value:Me});break}case"checkbox":case"radiobutton":{const Me=pe.defaultValue===pe.exportValues;j.setValue(ve,{value:Me});break}case"combobox":case"listbox":{const Me=pe.defaultValue||"";j.setValue(ve,{value:Me});break}default:continue}const Te=document.querySelector(`[data-element-id="${ve}"]`);if(Te){if(!p.has(Te)){(0,n.warn)(`_bindResetFormAction - element not allowed: ${ve}`);continue}}else continue;Te.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((Ae=this.linkService.eventBus)==null||Ae.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:J,name:"ResetForm"}})),!1}}}class g extends S{constructor(F){var V,D,Y;const I=!!(F.data.hasPopup||(V=F.data.titleObj)!=null&&V.str||(D=F.data.contentsObj)!=null&&D.str||(Y=F.data.richText)!=null&&Y.str);super(F,{isRenderable:I})}render(){this.container.className="textAnnotation";const F=document.createElement("img");return F.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",F.alt="[{{type}} Annotation]",F.dataset.l10nId="text_annotation_type",F.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(F,this.data),this.container.append(F),this.container}}class m extends S{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(F){const{isWin:I,isMac:V}=S.platform;return I&&F.ctrlKey||V&&F.metaKey}_setEventListener(F,I,V,D){I.includes("mouse")?F.addEventListener(I,Y=>{var ie;(ie=this.linkService.eventBus)==null||ie.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:V,value:D(Y),shift:Y.shiftKey,modifier:this._getKeyModifier(Y)}})}):F.addEventListener(I,Y=>{var ie;(ie=this.linkService.eventBus)==null||ie.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:V,value:D(Y)}})})}_setEventListeners(F,I,V){var D;for(const[Y,ie]of I)(ie==="Action"||(D=this.data.actions)!=null&&D[ie])&&this._setEventListener(F,Y,ie,V)}_setBackgroundColor(F){const I=this.data.backgroundColor||null;F.style.backgroundColor=I===null?"transparent":n.Util.makeHexColor(I[0],I[1],I[2])}_setTextStyle(F){const I=["left","center","right"],{fontColor:V}=this.data.defaultAppearanceData,D=this.data.defaultAppearanceData.fontSize||h,Y=F.style;let ie;if(this.data.multiLine){const te=Math.abs(this.data.rect[3]-this.data.rect[1]),j=Math.round(te/(n.LINE_FACTOR*D))||1,J=te/j;ie=Math.min(D,Math.round(J/n.LINE_FACTOR))}else{const te=Math.abs(this.data.rect[3]-this.data.rect[1]);ie=Math.min(D,Math.round(te/n.LINE_FACTOR))}Y.fontSize=`calc(${ie}px * var(--scale-factor))`,Y.color=n.Util.makeHexColor(V[0],V[1],V[2]),this.data.textAlignment!==null&&(Y.textAlign=I[this.data.textAlignment])}_setRequired(F,I){I?F.setAttribute("required",!0):F.removeAttribute("required"),F.setAttribute("aria-required",I)}}class A extends m{constructor(F){const I=F.renderForms||!F.data.hasAppearance&&!!F.data.fieldValue;super(F,{isRenderable:I})}setPropertyOnSiblings(F,I,V,D){const Y=this.annotationStorage;for(const ie of this._getElementsByName(F.name,F.id))ie.domElement&&(ie.domElement[I]=V),Y.setValue(ie.id,{[D]:V})}render(){var D;const F=this.annotationStorage,I=this.data.id;this.container.className="textWidgetAnnotation";let V=null;if(this.renderForms){const Y=F.getValue(I,{value:this.data.fieldValue});let ie=Y.formattedValue||Y.value||"";const te=F.getValue(I,{charLimit:this.data.maxLen}).charLimit;te&&ie.length>te&&(ie=ie.slice(0,te));const j={userValue:ie,formattedValue:null,valueOnFocus:""};this.data.multiLine?(V=document.createElement("textarea"),V.textContent=ie,this.data.doNotScroll&&(V.style.overflowY="hidden")):(V=document.createElement("input"),V.type="text",V.setAttribute("value",ie),this.data.doNotScroll&&(V.style.overflowX="hidden")),p.add(V),V.setAttribute("data-element-id",I),V.disabled=this.data.readOnly,V.name=this.data.fieldName,V.tabIndex=d,this._setRequired(V,this.data.required),te&&(V.maxLength=te),V.addEventListener("input",Ae=>{F.setValue(I,{value:Ae.target.value}),this.setPropertyOnSiblings(V,"value",Ae.target.value,"value")}),V.addEventListener("resetform",Ae=>{const pe=this.data.defaultFieldValue??"";V.value=j.userValue=pe,j.formattedValue=null});let J=Ae=>{const{formattedValue:pe}=j;pe!=null&&(Ae.target.value=pe),Ae.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){V.addEventListener("focus",pe=>{j.userValue&&(pe.target.value=j.userValue),j.valueOnFocus=pe.target.value}),V.addEventListener("updatefromsandbox",pe=>{const ve={value(Te){j.userValue=Te.detail.value??"",F.setValue(I,{value:j.userValue.toString()}),Te.target.value=j.userValue},formattedValue(Te){const{formattedValue:Me}=Te.detail;j.formattedValue=Me,Me!=null&&Te.target!==document.activeElement&&(Te.target.value=Me),F.setValue(I,{formattedValue:Me})},selRange(Te){Te.target.setSelectionRange(...Te.detail.selRange)},charLimit:Te=>{var at;const{charLimit:Me}=Te.detail,{target:ze}=Te;if(Me===0){ze.removeAttribute("maxLength");return}ze.setAttribute("maxLength",Me);let we=j.userValue;!we||we.length<=Me||(we=we.slice(0,Me),ze.value=j.userValue=we,F.setValue(I,{value:we}),(at=this.linkService.eventBus)==null||at.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I,name:"Keystroke",value:we,willCommit:!0,commitKey:1,selStart:ze.selectionStart,selEnd:ze.selectionEnd}}))}};this._dispatchEventFromSandbox(ve,pe)}),V.addEventListener("keydown",pe=>{var Me;let ve=-1;if(pe.key==="Escape"?ve=0:pe.key==="Enter"?ve=2:pe.key==="Tab"&&(ve=3),ve===-1)return;const{value:Te}=pe.target;j.valueOnFocus!==Te&&(j.userValue=Te,(Me=this.linkService.eventBus)==null||Me.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I,name:"Keystroke",value:Te,willCommit:!0,commitKey:ve,selStart:pe.target.selectionStart,selEnd:pe.target.selectionEnd}}))});const Ae=J;J=null,V.addEventListener("blur",pe=>{var Te;const{value:ve}=pe.target;j.userValue=ve,this._mouseState.isDown&&j.valueOnFocus!==ve&&((Te=this.linkService.eventBus)==null||Te.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I,name:"Keystroke",value:ve,willCommit:!0,commitKey:1,selStart:pe.target.selectionStart,selEnd:pe.target.selectionEnd}})),Ae(pe)}),(D=this.data.actions)!=null&&D.Keystroke&&V.addEventListener("beforeinput",pe=>{var Ke;const{data:ve,target:Te}=pe,{value:Me,selectionStart:ze,selectionEnd:we}=Te;let at=ze,et=we;switch(pe.inputType){case"deleteWordBackward":{const Ze=Me.substring(0,ze).match(/\w*[^\w]*$/);Ze&&(at-=Ze[0].length);break}case"deleteWordForward":{const Ze=Me.substring(ze).match(/^[^\w]*\w*/);Ze&&(et+=Ze[0].length);break}case"deleteContentBackward":ze===we&&(at-=1);break;case"deleteContentForward":ze===we&&(et+=1);break}pe.preventDefault(),(Ke=this.linkService.eventBus)==null||Ke.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I,name:"Keystroke",value:Me,change:ve||"",willCommit:!1,selStart:at,selEnd:et}})}),this._setEventListeners(V,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],pe=>pe.target.value)}if(J&&V.addEventListener("blur",J),this.data.comb){const pe=(this.data.rect[2]-this.data.rect[0])/te;V.classList.add("comb"),V.style.letterSpacing=`calc(${pe}px * var(--scale-factor) - 1ch)`}}else V=document.createElement("div"),V.textContent=this.data.fieldValue,V.style.verticalAlign="middle",V.style.display="table-cell";return this._setTextStyle(V),this._setBackgroundColor(V),this._setDefaultPropertiesFromJS(V),this.container.append(V),this.container}}class O extends m{constructor(F){super(F,{isRenderable:F.renderForms})}render(){const F=this.annotationStorage,I=this.data,V=I.id;let D=F.getValue(V,{value:I.exportValue===I.fieldValue}).value;typeof D=="string"&&(D=D!=="Off",F.setValue(V,{value:D})),this.container.className="buttonWidgetAnnotation checkBox";const Y=document.createElement("input");return p.add(Y),Y.setAttribute("data-element-id",V),Y.disabled=I.readOnly,this._setRequired(Y,this.data.required),Y.type="checkbox",Y.name=I.fieldName,D&&Y.setAttribute("checked",!0),Y.setAttribute("exportValue",I.exportValue),Y.tabIndex=d,Y.addEventListener("change",ie=>{const{name:te,checked:j}=ie.target;for(const J of this._getElementsByName(te,V)){const Ae=j&&J.exportValue===I.exportValue;J.domElement&&(J.domElement.checked=Ae),F.setValue(J.id,{value:Ae})}F.setValue(V,{value:j})}),Y.addEventListener("resetform",ie=>{const te=I.defaultFieldValue||"Off";ie.target.checked=te===I.exportValue}),this.enableScripting&&this.hasJSActions&&(Y.addEventListener("updatefromsandbox",ie=>{const te={value(j){j.target.checked=j.detail.value!=="Off",F.setValue(V,{value:j.target.checked})}};this._dispatchEventFromSandbox(te,ie)}),this._setEventListeners(Y,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ie=>ie.target.checked)),this._setBackgroundColor(Y),this._setDefaultPropertiesFromJS(Y),this.container.append(Y),this.container}}class C extends m{constructor(F){super(F,{isRenderable:F.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const F=this.annotationStorage,I=this.data,V=I.id;let D=F.getValue(V,{value:I.fieldValue===I.buttonValue}).value;typeof D=="string"&&(D=D!==I.buttonValue,F.setValue(V,{value:D}));const Y=document.createElement("input");if(p.add(Y),Y.setAttribute("data-element-id",V),Y.disabled=I.readOnly,this._setRequired(Y,this.data.required),Y.type="radio",Y.name=I.fieldName,D&&Y.setAttribute("checked",!0),Y.tabIndex=d,Y.addEventListener("change",ie=>{const{name:te,checked:j}=ie.target;for(const J of this._getElementsByName(te,V))F.setValue(J.id,{value:!1});F.setValue(V,{value:j})}),Y.addEventListener("resetform",ie=>{const te=I.defaultFieldValue;ie.target.checked=te!=null&&te===I.buttonValue}),this.enableScripting&&this.hasJSActions){const ie=I.buttonValue;Y.addEventListener("updatefromsandbox",te=>{const j={value:J=>{const Ae=ie===J.detail.value;for(const pe of this._getElementsByName(J.target.name)){const ve=Ae&&pe.id===V;pe.domElement&&(pe.domElement.checked=ve),F.setValue(pe.id,{value:ve})}}};this._dispatchEventFromSandbox(j,te)}),this._setEventListeners(Y,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],te=>te.target.checked)}return this._setBackgroundColor(Y),this._setDefaultPropertiesFromJS(Y),this.container.append(Y),this.container}}class R extends x{constructor(F){super(F,{ignoreBorder:F.data.hasAppearance})}render(){const F=super.render();F.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(F.title=this.data.alternativeText);const I=F.lastChild;return this.enableScripting&&this.hasJSActions&&I&&(this._setDefaultPropertiesFromJS(I),I.addEventListener("updatefromsandbox",V=>{this._dispatchEventFromSandbox({},V)})),F}}class T extends m{constructor(F){super(F,{isRenderable:F.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const F=this.annotationStorage,I=this.data.id,V=F.getValue(I,{value:this.data.fieldValue}),D=document.createElement("select");p.add(D),D.setAttribute("data-element-id",I),D.disabled=this.data.readOnly,this._setRequired(D,this.data.required),D.name=this.data.fieldName,D.tabIndex=d;let Y=this.data.combo&&this.data.options.length>0;this.data.combo||(D.size=this.data.options.length,this.data.multiSelect&&(D.multiple=!0)),D.addEventListener("resetform",J=>{const Ae=this.data.defaultFieldValue;for(const pe of D.options)pe.selected=pe.value===Ae});for(const J of this.data.options){const Ae=document.createElement("option");Ae.textContent=J.displayValue,Ae.value=J.exportValue,V.value.includes(J.exportValue)&&(Ae.setAttribute("selected",!0),Y=!1),D.append(Ae)}let ie=null;if(Y){const J=document.createElement("option");J.value=" ",J.setAttribute("hidden",!0),J.setAttribute("selected",!0),D.prepend(J),ie=()=>{J.remove(),D.removeEventListener("input",ie),ie=null},D.addEventListener("input",ie)}const te=(J,Ae)=>{const pe=Ae?"value":"textContent",ve=J.target.options;return J.target.multiple?Array.prototype.filter.call(ve,Te=>Te.selected).map(Te=>Te[pe]):ve.selectedIndex===-1?null:ve[ve.selectedIndex][pe]},j=J=>{const Ae=J.target.options;return Array.prototype.map.call(Ae,pe=>({displayValue:pe.textContent,exportValue:pe.value}))};return this.enableScripting&&this.hasJSActions?(D.addEventListener("updatefromsandbox",J=>{const Ae={value(pe){ie==null||ie();const ve=pe.detail.value,Te=new Set(Array.isArray(ve)?ve:[ve]);for(const Me of D.options)Me.selected=Te.has(Me.value);F.setValue(I,{value:te(pe,!0)})},multipleSelection(pe){D.multiple=!0},remove(pe){const ve=D.options,Te=pe.detail.remove;ve[Te].selected=!1,D.remove(Te),ve.length>0&&Array.prototype.findIndex.call(ve,ze=>ze.selected)===-1&&(ve[0].selected=!0),F.setValue(I,{value:te(pe,!0),items:j(pe)})},clear(pe){for(;D.length!==0;)D.remove(0);F.setValue(I,{value:null,items:[]})},insert(pe){const{index:ve,displayValue:Te,exportValue:Me}=pe.detail.insert,ze=D.children[ve],we=document.createElement("option");we.textContent=Te,we.value=Me,ze?ze.before(we):D.append(we),F.setValue(I,{value:te(pe,!0),items:j(pe)})},items(pe){const{items:ve}=pe.detail;for(;D.length!==0;)D.remove(0);for(const Te of ve){const{displayValue:Me,exportValue:ze}=Te,we=document.createElement("option");we.textContent=Me,we.value=ze,D.append(we)}D.options.length>0&&(D.options[0].selected=!0),F.setValue(I,{value:te(pe,!0),items:j(pe)})},indices(pe){const ve=new Set(pe.detail.indices);for(const Te of pe.target.options)Te.selected=ve.has(Te.index);F.setValue(I,{value:te(pe,!0)})},editable(pe){pe.target.disabled=!pe.detail.editable}};this._dispatchEventFromSandbox(Ae,J)}),D.addEventListener("input",J=>{var ve;const Ae=te(J,!0),pe=te(J,!1);F.setValue(I,{value:Ae}),(ve=this.linkService.eventBus)==null||ve.dispatch("dispatcheventinsandbox",{source:this,detail:{id:I,name:"Keystroke",value:pe,changeEx:Ae,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(D,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],J=>J.target.checked)):D.addEventListener("input",function(J){F.setValue(I,{value:te(J,!0)})}),this.data.combo&&this._setTextStyle(D),this._setBackgroundColor(D),this._setDefaultPropertiesFromJS(D),this.container.append(D),this.container}}class w extends S{constructor(F){var V,D,Y;const I=!!((V=F.data.titleObj)!=null&&V.str||(D=F.data.contentsObj)!=null&&D.str||(Y=F.data.richText)!=null&&Y.str);super(F,{isRenderable:I})}render(){const F=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",F.includes(this.data.parentType))return this.container;const I=`[data-annotation-id="${this.data.parentId}"]`,V=this.layer.querySelectorAll(I);if(V.length===0)return this.container;const D=new v({container:this.container,trigger:Array.from(V),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),Y=this.page,ie=n.Util.normalizeRect([this.data.parentRect[0],Y.view[3]-this.data.parentRect[1]+Y.view[1],this.data.parentRect[2],Y.view[3]-this.data.parentRect[3]+Y.view[1]]),te=ie[0]+this.data.parentRect[2]-this.data.parentRect[0],j=ie[1],[J,Ae,pe,ve]=this.viewport.viewBox,Te=pe-J,Me=ve-Ae;return this.container.style.left=`${100*(te-J)/Te}%`,this.container.style.top=`${100*(j-Ae)/Me}%`,this.container.append(D.render()),this.container}}class v{constructor(F){this.container=F.container,this.trigger=F.trigger,this.color=F.color,this.titleObj=F.titleObj,this.modificationDate=F.modificationDate,this.contentsObj=F.contentsObj,this.richText=F.richText,this.hideWrapper=F.hideWrapper||!1,this.pinned=!1}render(){var te,j;const I=document.createElement("div");I.className="popupWrapper",this.hideElement=this.hideWrapper?I:this.container,this.hideElement.hidden=!0;const V=document.createElement("div");V.className="popup";const D=this.color;if(D){const J=.7*(255-D[0])+D[0],Ae=.7*(255-D[1])+D[1],pe=.7*(255-D[2])+D[2];V.style.backgroundColor=n.Util.makeHexColor(J|0,Ae|0,pe|0)}const Y=document.createElement("h1");Y.dir=this.titleObj.dir,Y.textContent=this.titleObj.str,V.append(Y);const ie=i.PDFDateString.toDateObject(this.modificationDate);if(ie){const J=document.createElement("span");J.className="popupDate",J.textContent="{{date}}, {{time}}",J.dataset.l10nId="annotation_date_string",J.dataset.l10nArgs=JSON.stringify({date:ie.toLocaleDateString(),time:ie.toLocaleTimeString()}),V.append(J)}if((te=this.richText)!=null&&te.str&&(!((j=this.contentsObj)!=null&&j.str)||this.contentsObj.str===this.richText.str))f.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:V}),V.lastChild.className="richText popupContent";else{const J=this._formatContents(this.contentsObj);V.append(J)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const J of this.trigger)J.addEventListener("click",this._toggle.bind(this)),J.addEventListener("mouseover",this._show.bind(this,!1)),J.addEventListener("mouseout",this._hide.bind(this,!1));return V.addEventListener("click",this._hide.bind(this,!0)),I.append(V),I}_formatContents({str:F,dir:I}){const V=document.createElement("p");V.className="popupContent",V.dir=I;const D=F.split(/(?:\r\n?|\n)/);for(let Y=0,ie=D.length;Y<ie;++Y){const te=D[Y];V.append(document.createTextNode(te)),Y<ie-1&&V.append(document.createElement("br"))}return V}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(F=!1){F&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(F=!0){F&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class L extends S{constructor(F){var V,D,Y;const I=!!(F.data.hasPopup||(V=F.data.titleObj)!=null&&V.str||(D=F.data.contentsObj)!=null&&D.str||(Y=F.data.richText)!=null&&Y.str);super(F,{isRenderable:I,ignoreBorder:!0}),this.textContent=F.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const F=document.createElement("div");F.className="annotationTextContent",F.setAttribute("role","comment");for(const I of this.textContent){const V=document.createElement("span");V.textContent=I,F.append(V)}this.container.append(F)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class M extends S{constructor(F){var V,D,Y;const I=!!(F.data.hasPopup||(V=F.data.titleObj)!=null&&V.str||(D=F.data.contentsObj)!=null&&D.str||(Y=F.data.richText)!=null&&Y.str);super(F,{isRenderable:I,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const F=this.data,{width:I,height:V}=E(F.rect),D=this.svgFactory.create(I,V,!0),Y=this.svgFactory.createElement("svg:line");return Y.setAttribute("x1",F.rect[2]-F.lineCoordinates[0]),Y.setAttribute("y1",F.rect[3]-F.lineCoordinates[1]),Y.setAttribute("x2",F.rect[2]-F.lineCoordinates[2]),Y.setAttribute("y2",F.rect[3]-F.lineCoordinates[3]),Y.setAttribute("stroke-width",F.borderStyle.width||1),Y.setAttribute("stroke","transparent"),Y.setAttribute("fill","transparent"),D.append(Y),this.container.append(D),this._createPopup(Y,F),this.container}}class X extends S{constructor(F){var V,D,Y;const I=!!(F.data.hasPopup||(V=F.data.titleObj)!=null&&V.str||(D=F.data.contentsObj)!=null&&D.str||(Y=F.data.richText)!=null&&Y.str);super(F,{isRenderable:I,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const F=this.data,{width:I,height:V}=E(F.rect),D=this.svgFactory.create(I,V,!0),Y=F.borderStyle.width,ie=this.svgFactory.createElement("svg:rect");return ie.setAttribute("x",Y/2),ie.setAttribute("y",Y/2),ie.setAttribute("width",I-Y),ie.setAttribute("height",V-Y),ie.setAttribute("stroke-width",Y||1),ie.setAttribute("stroke","transparent"),ie.setAttribute("fill","transparent"),D.append(ie),this.container.append(D),this._createPopup(ie,F),this.container}}class H extends S{constructor(F){var V,D,Y;const I=!!(F.data.hasPopup||(V=F.data.titleObj)!=null&&V.str||(D=F.data.contentsObj)!=null&&D.str||(Y=F.data.richText)!=null&&Y.str);super(F,{isRenderable:I,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const F=this.data,{width:I,height:V}=E(F.rect),D=this.svgFactory.create(I,V,!0),Y=F.borderStyle.width,ie=this.svgFactory.createElement("svg:ellipse");return ie.setAttribute("cx",I/2),ie.setAttribute("cy",V/2),ie.setAttribute("rx",I/2-Y/2),ie.setAttribute("ry",V/2-Y/2),ie.setAttribute("stroke-width",Y||1),ie.setAttribute("stroke","transparent"),ie.setAttribute("fill","transparent"),D.append(ie),this.container.append(D),this._createPopup(ie,F),this.container}}class ne extends S{constructor(F){var V,D,Y;const I=!!(F.data.hasPopup||(V=F.data.titleObj)!=null&&V.str||(D=F.data.contentsObj)!=null&&D.str||(Y=F.data.richText)!=null&&Y.str);super(F,{isRenderable:I,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const F=this.data,{width:I,height:V}=E(F.rect),D=this.svgFactory.create(I,V,!0);let Y=[];for(const te of F.vertices){const j=te.x-F.rect[0],J=F.rect[3]-te.y;Y.push(j+","+J)}Y=Y.join(" ");const ie=this.svgFactory.createElement(this.svgElementName);return ie.setAttribute("points",Y),ie.setAttribute("stroke-width",F.borderStyle.width||1),ie.setAttribute("stroke","transparent"),ie.setAttribute("fill","transparent"),D.append(ie),this.container.append(D),this._createPopup(ie,F),this.container}}class _e extends ne{constructor(F){super(F),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class ge extends S{constructor(F){var V,D,Y;const I=!!(F.data.hasPopup||(V=F.data.titleObj)!=null&&V.str||(D=F.data.contentsObj)!=null&&D.str||(Y=F.data.richText)!=null&&Y.str);super(F,{isRenderable:I,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class he extends S{constructor(F){var V,D,Y;const I=!!(F.data.hasPopup||(V=F.data.titleObj)!=null&&V.str||(D=F.data.contentsObj)!=null&&D.str||(Y=F.data.richText)!=null&&Y.str);super(F,{isRenderable:I,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const F=this.data,{width:I,height:V}=E(F.rect),D=this.svgFactory.create(I,V,!0);for(const Y of F.inkLists){let ie=[];for(const j of Y){const J=j.x-F.rect[0],Ae=F.rect[3]-j.y;ie.push(`${J},${Ae}`)}ie=ie.join(" ");const te=this.svgFactory.createElement(this.svgElementName);te.setAttribute("points",ie),te.setAttribute("stroke-width",F.borderStyle.width||1),te.setAttribute("stroke","transparent"),te.setAttribute("fill","transparent"),this._createPopup(te,F),D.append(te)}return this.container.append(D),this.container}}class W extends S{constructor(F){var V,D,Y;const I=!!(F.data.hasPopup||(V=F.data.titleObj)!=null&&V.str||(D=F.data.contentsObj)!=null&&D.str||(Y=F.data.richText)!=null&&Y.str);super(F,{isRenderable:I,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class se extends S{constructor(F){var V,D,Y;const I=!!(F.data.hasPopup||(V=F.data.titleObj)!=null&&V.str||(D=F.data.contentsObj)!=null&&D.str||(Y=F.data.richText)!=null&&Y.str);super(F,{isRenderable:I,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class ue extends S{constructor(F){var V,D,Y;const I=!!(F.data.hasPopup||(V=F.data.titleObj)!=null&&V.str||(D=F.data.contentsObj)!=null&&D.str||(Y=F.data.richText)!=null&&Y.str);super(F,{isRenderable:I,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class re extends S{constructor(F){var V,D,Y;const I=!!(F.data.hasPopup||(V=F.data.titleObj)!=null&&V.str||(D=F.data.contentsObj)!=null&&D.str||(Y=F.data.richText)!=null&&Y.str);super(F,{isRenderable:I,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class q extends S{constructor(F){var V,D,Y;const I=!!(F.data.hasPopup||(V=F.data.titleObj)!=null&&V.str||(D=F.data.contentsObj)!=null&&D.str||(Y=F.data.richText)!=null&&Y.str);super(F,{isRenderable:I,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class me extends S{constructor(F){var D;super(F,{isRenderable:!0});const{filename:I,content:V}=this.data.file;this.filename=(0,i.getFilenameFromUrl)(I),this.content=V,(D=this.linkService.eventBus)==null||D.dispatch("fileattachmentannotation",{source:this,filename:I,content:V})}render(){var I,V;this.container.className="fileAttachmentAnnotation";const F=document.createElement("div");return F.className="popupTriggerArea",F.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((I=this.data.titleObj)!=null&&I.str||(V=this.data.contentsObj)!=null&&V.str||this.data.richText)&&this._createPopup(F,this.data),this.container.append(F),this.container}_download(){var F;(F=this.downloadManager)==null||F.openOrDownloadData(this.container,this.content,this.filename)}}const Q=class Q{static render(F){var te,j;const{annotations:I,div:V,viewport:D,accessibilityManager:Y}=F;Ue(this,P,Zl).call(this,V,D);let ie=0;for(const J of I){if(J.annotationType!==n.AnnotationType.POPUP){const{width:pe,height:ve}=E(J.rect);if(pe<=0||ve<=0)continue}const Ae=y.create({data:J,layer:V,page:F.page,viewport:D,linkService:F.linkService,downloadManager:F.downloadManager,imageResourcesPath:F.imageResourcesPath||"",renderForms:F.renderForms!==!1,svgFactory:new i.DOMSVGFactory,annotationStorage:F.annotationStorage||new l.AnnotationStorage,enableScripting:F.enableScripting,hasJSActions:F.hasJSActions,fieldObjects:F.fieldObjects,mouseState:F.mouseState||{isDown:!1}});if(Ae.isRenderable){const pe=Ae.render();if(J.hidden&&(pe.style.visibility="hidden"),Array.isArray(pe))for(const ve of pe)ve.style.zIndex=ie++,Ue(te=Q,P,Ql).call(te,ve,J.id,V,Y);else pe.style.zIndex=ie++,Ae instanceof w?V.prepend(pe):Ue(j=Q,P,Ql).call(j,pe,J.id,V,Y)}}Ue(this,P,ec).call(this,V,F.annotationCanvasMap)}static update(F){const{annotationCanvasMap:I,div:V,viewport:D}=F;Ue(this,P,Zl).call(this,V,D),Ue(this,P,ec).call(this,V,I),V.hidden=!1}};P=new WeakSet,Ql=function(F,I,V,D){const Y=F.firstChild||F;Y.id=`${i.AnnotationPrefix}${I}`,V.append(F),D==null||D.moveElementInDOM(V,F,Y,!1)},Zl=function(F,{width:I,height:V,rotation:D}){const{style:Y}=F,ie=D%180!==0,te=Math.floor(I)+"px",j=Math.floor(V)+"px";Y.width=ie?j:te,Y.height=ie?te:j,F.setAttribute("data-main-rotation",D)},ec=function(F,I){if(I){for(const[V,D]of I){const Y=F.querySelector(`[data-annotation-id="${V}"]`);if(!Y)continue;const{firstChild:ie}=Y;ie?ie.nodeName==="CANVAS"?ie.replaceWith(D):ie.before(D):Y.append(D)}I.clear()}},Ge(Q,P);let N=Q;r.AnnotationLayer=N},(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ColorConverters=void 0;function t(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}class n{static CMYK_G([l,c,f,d]){return["G",1-Math.min(1,.3*l+.59*f+.11*c+d)]}static G_CMYK([l]){return["CMYK",0,0,0,1-l]}static G_RGB([l]){return["RGB",l,l,l]}static G_HTML([l]){const c=t(l);return`#${c}${c}${c}`}static RGB_G([l,c,f]){return["G",.3*l+.59*c+.11*f]}static RGB_HTML([l,c,f]){const d=t(l),h=t(c),p=t(f);return`#${d}${h}${p}`}static T_HTML(){return"#00000000"}static CMYK_RGB([l,c,f,d]){return["RGB",1-Math.min(1,l+d),1-Math.min(1,f+d),1-Math.min(1,c+d)]}static CMYK_HTML(l){const c=this.CMYK_RGB(l).slice(1);return this.RGB_HTML(c)}static RGB_CMYK([l,c,f]){const d=1-l,h=1-c,p=1-f,E=Math.min(d,h,p);return["CMYK",d,h,p,E]}}r.ColorConverters=n},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.XfaLayer=void 0;var n=t(20);class i{static setupStorage(c,f,d,h,p){const E=h.getValue(f,{value:null});switch(d.name){case"textarea":if(E.value!==null&&(c.textContent=E.value),p==="print")break;c.addEventListener("input",y=>{h.setValue(f,{value:y.target.value})});break;case"input":if(d.attributes.type==="radio"||d.attributes.type==="checkbox"){if(E.value===d.attributes.xfaOn?c.setAttribute("checked",!0):E.value===d.attributes.xfaOff&&c.removeAttribute("checked"),p==="print")break;c.addEventListener("change",y=>{h.setValue(f,{value:y.target.checked?y.target.getAttribute("xfaOn"):y.target.getAttribute("xfaOff")})})}else{if(E.value!==null&&c.setAttribute("value",E.value),p==="print")break;c.addEventListener("input",y=>{h.setValue(f,{value:y.target.value})})}break;case"select":if(E.value!==null)for(const y of d.children)y.attributes.value===E.value&&(y.attributes.selected=!0);c.addEventListener("input",y=>{const S=y.target.options,x=S.selectedIndex===-1?"":S[S.selectedIndex].value;h.setValue(f,{value:x})});break}}static setAttributes({html:c,element:f,storage:d=null,intent:h,linkService:p}){const{attributes:E}=f,y=c instanceof HTMLAnchorElement;E.type==="radio"&&(E.name=`${E.name}-${h}`);for(const[S,x]of Object.entries(E))if(x!=null)switch(S){case"class":x.length&&c.setAttribute(S,x.join(" "));break;case"dataId":break;case"id":c.setAttribute("data-element-id",x);break;case"style":Object.assign(c.style,x);break;case"textContent":c.textContent=x;break;default:(!y||S!=="href"&&S!=="newWindow")&&c.setAttribute(S,x)}y&&p.addLinkAttributes(c,E.href,E.newWindow),d&&E.dataId&&this.setupStorage(c,E.dataId,f,d)}static render(c){var g;const f=c.annotationStorage,d=c.linkService,h=c.xfaHtml,p=c.intent||"display",E=document.createElement(h.name);h.attributes&&this.setAttributes({html:E,element:h,intent:p,linkService:d});const y=[[h,-1,E]],S=c.div;if(S.append(E),c.viewport){const m=`matrix(${c.viewport.transform.join(",")})`;S.style.transform=m}p!=="richText"&&S.setAttribute("class","xfaLayer xfaFont");const x=[];for(;y.length>0;){const[m,A,O]=y.at(-1);if(A+1===m.children.length){y.pop();continue}const C=m.children[++y.at(-1)[1]];if(C===null)continue;const{name:R}=C;if(R==="#text"){const w=document.createTextNode(C.value);x.push(w),O.append(w);continue}let T;if((g=C==null?void 0:C.attributes)!=null&&g.xmlns?T=document.createElementNS(C.attributes.xmlns,R):T=document.createElement(R),O.append(T),C.attributes&&this.setAttributes({html:T,element:C,storage:f,intent:p,linkService:d}),C.children&&C.children.length>0)y.push([C,-1,T]);else if(C.value){const w=document.createTextNode(C.value);n.XfaText.shouldBuildText(R)&&x.push(w),T.append(w)}}for(const m of S.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:x}}static update(c){const f=`matrix(${c.viewport.transform.join(",")})`;c.div.style.transform=f,c.div.hidden=!1}}r.XfaLayer=i},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TextLayerRenderTask=void 0,r.renderTextLayer=O;var n=t(1),i=t(8);const l=1e5,c=30,f=.8,d=new Map,h=/^\s+$/g;function p(C,R){const T=d.get(C);if(T)return T;R.save(),R.font=`${c}px ${C}`;const w=R.measureText("");let v=w.fontBoundingBoxAscent,L=Math.abs(w.fontBoundingBoxDescent);if(v){R.restore();const X=v/(v+L);return d.set(C,X),X}R.strokeStyle="red",R.clearRect(0,0,c,c),R.strokeText("g",0,0);let M=R.getImageData(0,0,c,c).data;L=0;for(let X=M.length-1-3;X>=0;X-=4)if(M[X]>0){L=Math.ceil(X/4/c);break}R.clearRect(0,0,c,c),R.strokeText("A",0,c),M=R.getImageData(0,0,c,c).data,v=0;for(let X=0,H=M.length;X<H;X+=4)if(M[X]>0){v=c-Math.floor(X/4/c);break}if(R.restore(),v){const X=v/(v+L);return d.set(C,X),X}return d.set(C,f),f}function E(C,R,T,w){const v=document.createElement("span"),L=C._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:R.str!=="",hasEOL:R.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:R.str!=="",hasEOL:R.hasEOL,fontSize:0};C._textDivs.push(v);const M=n.Util.transform(C._viewport.transform,R.transform);let X=Math.atan2(M[1],M[0]);const H=T[R.fontName];H.vertical&&(X+=Math.PI/2);const ne=Math.hypot(M[2],M[3]),_e=ne*p(H.fontFamily,w);let ge,he;X===0?(ge=M[4],he=M[5]-_e):(ge=M[4]+_e*Math.sin(X),he=M[5]-_e*Math.cos(X)),v.style.left=`${ge}px`,v.style.top=`${he}px`,v.style.fontSize=`${ne}px`,v.style.fontFamily=H.fontFamily,L.fontSize=ne,v.setAttribute("role","presentation"),v.textContent=R.str,v.dir=R.dir,C._fontInspectorEnabled&&(v.dataset.fontName=R.fontName),X!==0&&(L.angle=X*(180/Math.PI));let W=!1;if(R.str.length>1||C._enhanceTextSelection&&h.test(R.str))W=!0;else if(R.str!==" "&&R.transform[0]!==R.transform[3]){const se=Math.abs(R.transform[0]),ue=Math.abs(R.transform[3]);se!==ue&&Math.max(se,ue)/Math.min(se,ue)>1.5&&(W=!0)}if(W&&(H.vertical?L.canvasWidth=R.height*C._viewport.scale:L.canvasWidth=R.width*C._viewport.scale),C._textDivProperties.set(v,L),C._textContentStream&&C._layoutText(v),C._enhanceTextSelection&&L.hasText){let se=1,ue=0;X!==0&&(se=Math.cos(X),ue=Math.sin(X));const re=(H.vertical?R.height:R.width)*C._viewport.scale,q=ne;let me,N;X!==0?(me=[se,ue,-ue,se,ge,he],N=n.Util.getAxialAlignedBoundingBox([0,0,re,q],me)):N=[ge,he,ge+re,he+q],C._bounds.push({left:N[0],top:N[1],right:N[2],bottom:N[3],div:v,size:[re,q],m:me})}}function y(C){if(C._canceled)return;const R=C._textDivs,T=C._capability,w=R.length;if(w>l){C._renderingDone=!0,T.resolve();return}if(!C._textContentStream)for(let v=0;v<w;v++)C._layoutText(R[v]);C._renderingDone=!0,T.resolve()}function S(C,R,T){let w=0;for(let v=0;v<T;v++){const L=C[R++];L>0&&(w=w?Math.min(L,w):L)}return w}function x(C){const R=C._bounds,T=C._viewport,w=g(T.width,T.height,R);for(let v=0;v<w.length;v++){const L=R[v].div,M=C._textDivProperties.get(L);if(M.angle===0){M.paddingLeft=R[v].left-w[v].left,M.paddingTop=R[v].top-w[v].top,M.paddingRight=w[v].right-R[v].right,M.paddingBottom=w[v].bottom-R[v].bottom,C._textDivProperties.set(L,M);continue}const X=w[v],H=R[v],ne=H.m,_e=ne[0],ge=ne[1],he=[[0,0],[0,H.size[1]],[H.size[0],0],H.size],W=new Float64Array(64);for(let ue=0,re=he.length;ue<re;ue++){const q=n.Util.applyTransform(he[ue],ne);W[ue+0]=_e&&(X.left-q[0])/_e,W[ue+4]=ge&&(X.top-q[1])/ge,W[ue+8]=_e&&(X.right-q[0])/_e,W[ue+12]=ge&&(X.bottom-q[1])/ge,W[ue+16]=ge&&(X.left-q[0])/-ge,W[ue+20]=_e&&(X.top-q[1])/_e,W[ue+24]=ge&&(X.right-q[0])/-ge,W[ue+28]=_e&&(X.bottom-q[1])/_e,W[ue+32]=_e&&(X.left-q[0])/-_e,W[ue+36]=ge&&(X.top-q[1])/-ge,W[ue+40]=_e&&(X.right-q[0])/-_e,W[ue+44]=ge&&(X.bottom-q[1])/-ge,W[ue+48]=ge&&(X.left-q[0])/ge,W[ue+52]=_e&&(X.top-q[1])/-_e,W[ue+56]=ge&&(X.right-q[0])/ge,W[ue+60]=_e&&(X.bottom-q[1])/-_e}const se=1+Math.min(Math.abs(_e),Math.abs(ge));M.paddingLeft=S(W,32,16)/se,M.paddingTop=S(W,48,16)/se,M.paddingRight=S(W,0,16)/se,M.paddingBottom=S(W,16,16)/se,C._textDivProperties.set(L,M)}}function g(C,R,T){const w=T.map(function(L,M){return{x1:L.left,y1:L.top,x2:L.right,y2:L.bottom,index:M,x1New:void 0,x2New:void 0}});m(C,w);const v=new Array(T.length);for(const L of w){const M=L.index;v[M]={left:L.x1New,top:0,right:L.x2New,bottom:0}}T.map(function(L,M){const X=v[M],H=w[M];H.x1=L.top,H.y1=C-X.right,H.x2=L.bottom,H.y2=C-X.left,H.index=M,H.x1New=void 0,H.x2New=void 0}),m(R,w);for(const L of w){const M=L.index;v[M].top=L.x1New,v[M].bottom=L.x2New}return v}function m(C,R){R.sort(function(v,L){return v.x1-L.x1||v.index-L.index});const w=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const v of R){let L=0;for(;L<w.length&&w[L].end<=v.y1;)L++;let M=w.length-1;for(;M>=0&&w[M].start>=v.y2;)M--;let X,H,ne,_e,ge=-1/0;for(ne=L;ne<=M;ne++){X=w[ne],H=X.boundary;let se;H.x2>v.x1?se=H.index>v.index?H.x1New:v.x1:H.x2New===void 0?se=(H.x2+v.x1)/2:se=H.x2New,se>ge&&(ge=se)}for(v.x1New=ge,ne=L;ne<=M;ne++)X=w[ne],H=X.boundary,H.x2New===void 0?H.x2>v.x1?H.index>v.index&&(H.x2New=H.x2):H.x2New=ge:H.x2New>ge&&(H.x2New=Math.max(ge,H.x2));const he=[];let W=null;for(ne=L;ne<=M;ne++){X=w[ne],H=X.boundary;const se=H.x2>v.x2?H:v;W===se?he.at(-1).end=X.end:(he.push({start:X.start,end:X.end,boundary:se}),W=se)}for(w[L].start<v.y1&&(he[0].start=v.y1,he.unshift({start:w[L].start,end:v.y1,boundary:w[L].boundary})),v.y2<w[M].end&&(he.at(-1).end=v.y2,he.push({start:v.y2,end:w[M].end,boundary:w[M].boundary})),ne=L;ne<=M;ne++){if(X=w[ne],H=X.boundary,H.x2New!==void 0)continue;let se=!1;for(_e=L-1;!se&&_e>=0&&w[_e].start>=H.y1;_e--)se=w[_e].boundary===H;for(_e=M+1;!se&&_e<w.length&&w[_e].end<=H.y2;_e++)se=w[_e].boundary===H;for(_e=0;!se&&_e<he.length;_e++)se=he[_e].boundary===H;se||(H.x2New=ge)}Array.prototype.splice.apply(w,[L,M-L+1,...he])}for(const v of w){const L=v.boundary;L.x2New===void 0&&(L.x2New=Math.max(C,L.x2))}}class A{constructor({textContent:R,textContentStream:T,container:w,viewport:v,textDivs:L,textContentItemsStr:M,enhanceTextSelection:X}){var H;X&&(0,i.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=R,this._textContentStream=T,this._container=w,this._document=w.ownerDocument,this._viewport=v,this._textDivs=L||[],this._textContentItemsStr=M||[],this._enhanceTextSelection=!!X,this._fontInspectorEnabled=!!((H=globalThis.FontInspector)!=null&&H.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,n.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(R,T){for(let w=0,v=R.length;w<v;w++){if(R[w].str===void 0){if(R[w].type==="beginMarkedContentProps"||R[w].type==="beginMarkedContent"){const L=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),R[w].id!==null&&this._container.setAttribute("id",`${R[w].id}`),L.append(this._container)}else R[w].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(R[w].str),E(this,R[w],T,this._layoutTextCtx)}}_layoutText(R){const T=this._textDivProperties.get(R);let w="";if(T.canvasWidth!==0&&T.hasText){const{fontFamily:v}=R.style,{fontSize:L}=T;(L!==this._layoutTextLastFontSize||v!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${L*this._devicePixelRatio}px ${v}`,this._layoutTextLastFontSize=L,this._layoutTextLastFontFamily=v);const{width:M}=this._layoutTextCtx.measureText(R.textContent);if(M>0){const X=this._devicePixelRatio*T.canvasWidth/M;this._enhanceTextSelection&&(T.scale=X),w=`scaleX(${X})`}}if(T.angle!==0&&(w=`rotate(${T.angle}deg) ${w}`),w.length>0&&(this._enhanceTextSelection&&(T.originalTransform=w),R.style.transform=w),T.hasText&&this._container.append(R),T.hasEOL){const v=document.createElement("br");v.setAttribute("role","presentation"),this._container.append(v)}}_render(R=0){const T=(0,n.createPromiseCapability)();let w=Object.create(null);const v=this._document.createElement("canvas");if(v.height=v.width=c,this._layoutTextCtx=v.getContext("2d",{alpha:!1}),this._textContent){const L=this._textContent.items,M=this._textContent.styles;this._processItems(L,M),T.resolve()}else if(this._textContentStream){const L=()=>{this._reader.read().then(({value:M,done:X})=>{if(X){T.resolve();return}Object.assign(w,M.styles),this._processItems(M.items,w),L()},T.reject)};this._reader=this._textContentStream.getReader(),L()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');T.promise.then(()=>{w=null,R?this._renderTimer=setTimeout(()=>{y(this),this._renderTimer=null},R):y(this)},this._capability.reject)}expandTextDivs(R=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(x(this),this._bounds=null);const T=[],w=[];for(let v=0,L=this._textDivs.length;v<L;v++){const M=this._textDivs[v],X=this._textDivProperties.get(M);X.hasText&&(R?(T.length=0,w.length=0,X.originalTransform&&T.push(X.originalTransform),X.paddingTop>0?(w.push(`${X.paddingTop}px`),T.push(`translateY(${-X.paddingTop}px)`)):w.push(0),X.paddingRight>0?w.push(`${X.paddingRight/X.scale}px`):w.push(0),X.paddingBottom>0?w.push(`${X.paddingBottom}px`):w.push(0),X.paddingLeft>0?(w.push(`${X.paddingLeft/X.scale}px`),T.push(`translateX(${-X.paddingLeft/X.scale}px)`)):w.push(0),M.style.padding=w.join(" "),T.length&&(M.style.transform=T.join(" "))):(M.style.padding=null,M.style.transform=X.originalTransform))}}}r.TextLayerRenderTask=A;function O(C){const R=new A({textContent:C.textContent,textContentStream:C.textContentStream,container:C.container,viewport:C.viewport,textDivs:C.textDivs,textContentItemsStr:C.textContentItemsStr,enhanceTextSelection:C.enhanceTextSelection});return R._render(C.timeout),R}},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.SVGGraphics=void 0;var n=t(8),i=t(1),l=t(3);let c=class{constructor(){(0,i.unreachable)("Not implemented: SVGGraphics")}};r.SVGGraphics=c;{let g=function(T){let w=[];const v=[];for(const L of T){if(L.fn==="save"){w.push({fnId:92,fn:"group",items:[]}),v.push(w),w=w.at(-1).items;continue}L.fn==="restore"?w=v.pop():w.push(L)}return w},m=function(T){if(Number.isInteger(T))return T.toString();const w=T.toFixed(10);let v=w.length-1;if(w[v]!=="0")return w;do v--;while(w[v]==="0");return w.substring(0,w[v]==="."?v:v+1)},A=function(T){if(T[4]===0&&T[5]===0){if(T[1]===0&&T[2]===0)return T[0]===1&&T[3]===1?"":`scale(${m(T[0])} ${m(T[3])})`;if(T[0]===T[3]&&T[1]===-T[2]){const w=Math.acos(T[0])*180/Math.PI;return`rotate(${m(w)})`}}else if(T[0]===1&&T[1]===0&&T[2]===0&&T[3]===1)return`translate(${m(T[4])} ${m(T[5])})`;return`matrix(${m(T[0])} ${m(T[1])} ${m(T[2])} ${m(T[3])} ${m(T[4])} ${m(T[5])})`};const f={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},d="http://www.w3.org/XML/1998/namespace",h="http://www.w3.org/1999/xlink",p=["butt","round","square"],E=["miter","round","bevel"],y=function(T,w="",v=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!v)return URL.createObjectURL(new Blob([T],{type:w}));const L="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let M=`data:${w};base64,`;for(let X=0,H=T.length;X<H;X+=3){const ne=T[X]&255,_e=T[X+1]&255,ge=T[X+2]&255,he=ne>>2,W=(ne&3)<<4|_e>>4,se=X+1<H?(_e&15)<<2|ge>>6:64,ue=X+2<H?ge&63:64;M+=L[he]+L[W]+L[se]+L[ue]}return M},S=function(){const T=new Uint8Array([137,80,78,71,13,10,26,10]),w=12,v=new Int32Array(256);for(let ge=0;ge<256;ge++){let he=ge;for(let W=0;W<8;W++)he&1?he=3988292384^he>>1&2147483647:he=he>>1&2147483647;v[ge]=he}function L(ge,he,W){let se=-1;for(let ue=he;ue<W;ue++){const re=(se^ge[ue])&255,q=v[re];se=se>>>8^q}return se^-1}function M(ge,he,W,se){let ue=se;const re=he.length;W[ue]=re>>24&255,W[ue+1]=re>>16&255,W[ue+2]=re>>8&255,W[ue+3]=re&255,ue+=4,W[ue]=ge.charCodeAt(0)&255,W[ue+1]=ge.charCodeAt(1)&255,W[ue+2]=ge.charCodeAt(2)&255,W[ue+3]=ge.charCodeAt(3)&255,ue+=4,W.set(he,ue),ue+=he.length;const q=L(W,se+4,ue);W[ue]=q>>24&255,W[ue+1]=q>>16&255,W[ue+2]=q>>8&255,W[ue+3]=q&255}function X(ge,he,W){let se=1,ue=0;for(let re=he;re<W;++re)se=(se+(ge[re]&255))%65521,ue=(ue+se)%65521;return ue<<16|se}function H(ge){if(!l.isNodeJS)return ne(ge);try{let he;parseInt(process.versions.node)>=8?he=ge:he=Buffer.from(ge);const W=require$$5.deflateSync(he,{level:9});return W instanceof Uint8Array?W:new Uint8Array(W)}catch(he){(0,i.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+he)}return ne(ge)}function ne(ge){let he=ge.length;const W=65535,se=Math.ceil(he/W),ue=new Uint8Array(2+he+se*5+4);let re=0;ue[re++]=120,ue[re++]=156;let q=0;for(;he>W;)ue[re++]=0,ue[re++]=255,ue[re++]=255,ue[re++]=0,ue[re++]=0,ue.set(ge.subarray(q,q+W),re),re+=W,q+=W,he-=W;ue[re++]=1,ue[re++]=he&255,ue[re++]=he>>8&255,ue[re++]=~he&65535&255,ue[re++]=(~he&65535)>>8&255,ue.set(ge.subarray(q),re),re+=ge.length-q;const me=X(ge,0,ge.length);return ue[re++]=me>>24&255,ue[re++]=me>>16&255,ue[re++]=me>>8&255,ue[re++]=me&255,ue}function _e(ge,he,W,se){const ue=ge.width,re=ge.height;let q,me,N;const P=ge.data;switch(he){case i.ImageKind.GRAYSCALE_1BPP:me=0,q=1,N=ue+7>>3;break;case i.ImageKind.RGB_24BPP:me=2,q=8,N=ue*3;break;case i.ImageKind.RGBA_32BPP:me=6,q=8,N=ue*4;break;default:throw new Error("invalid format")}const k=new Uint8Array((1+N)*re);let B=0,z=0;for(let D=0;D<re;++D)k[B++]=0,k.set(P.subarray(z,z+N),B),z+=N,B+=N;if(he===i.ImageKind.GRAYSCALE_1BPP&&se){B=0;for(let D=0;D<re;D++){B++;for(let Y=0;Y<N;Y++)k[B++]^=255}}const Q=new Uint8Array([ue>>24&255,ue>>16&255,ue>>8&255,ue&255,re>>24&255,re>>16&255,re>>8&255,re&255,q,me,0,0,0]),K=H(k),F=T.length+w*3+Q.length+K.length,I=new Uint8Array(F);let V=0;return I.set(T,V),V+=T.length,M("IHDR",Q,I,V),V+=w+Q.length,M("IDATA",K,I,V),V+=w+K.length,M("IEND",new Uint8Array(0),I,V),y(I,"image/png",W)}return function(he,W,se){const ue=he.kind===void 0?i.ImageKind.GRAYSCALE_1BPP:he.kind;return _e(he,ue,W,se)}}();class x{constructor(){this.fontSizeScale=1,this.fontWeight=f.fontWeight,this.fontSize=0,this.textMatrix=i.IDENTITY_MATRIX,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=i.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=f.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(w,v){this.x=w,this.y=v}}let O=0,C=0,R=0;r.SVGGraphics=c=class{constructor(T,w,v=!1){(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new n.DOMSVGFactory,this.current=new x,this.transformMatrix=i.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=T,this.objs=w,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!v,this._operatorIdMapping=[];for(const L in i.OPS)this._operatorIdMapping[i.OPS[L]]=L}save(){this.transformStack.push(this.transformMatrix);const T=this.current;this.extraStack.push(T),this.current=T.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(T){this.save(),this.executeOpTree(T),this.restore()}loadDependencies(T){const w=T.fnArray,v=T.argsArray;for(let L=0,M=w.length;L<M;L++)if(w[L]===i.OPS.dependency)for(const X of v[L]){const H=X.startsWith("g_")?this.commonObjs:this.objs,ne=new Promise(_e=>{H.get(X,_e)});this.current.dependencies.push(ne)}return Promise.all(this.current.dependencies)}transform(T,w,v,L,M,X){const H=[T,w,v,L,M,X];this.transformMatrix=i.Util.transform(this.transformMatrix,H),this.tgrp=null}getSVG(T,w){this.viewport=w;const v=this._initialize(w);return this.loadDependencies(T).then(()=>(this.transformMatrix=i.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(T)),v))}convertOpList(T){const w=this._operatorIdMapping,v=T.argsArray,L=T.fnArray,M=[];for(let X=0,H=L.length;X<H;X++){const ne=L[X];M.push({fnId:ne,fn:w[ne],args:v[X]})}return g(M)}executeOpTree(T){for(const w of T){const v=w.fn,L=w.fnId,M=w.args;switch(L|0){case i.OPS.beginText:this.beginText();break;case i.OPS.dependency:break;case i.OPS.setLeading:this.setLeading(M);break;case i.OPS.setLeadingMoveText:this.setLeadingMoveText(M[0],M[1]);break;case i.OPS.setFont:this.setFont(M);break;case i.OPS.showText:this.showText(M[0]);break;case i.OPS.showSpacedText:this.showText(M[0]);break;case i.OPS.endText:this.endText();break;case i.OPS.moveText:this.moveText(M[0],M[1]);break;case i.OPS.setCharSpacing:this.setCharSpacing(M[0]);break;case i.OPS.setWordSpacing:this.setWordSpacing(M[0]);break;case i.OPS.setHScale:this.setHScale(M[0]);break;case i.OPS.setTextMatrix:this.setTextMatrix(M[0],M[1],M[2],M[3],M[4],M[5]);break;case i.OPS.setTextRise:this.setTextRise(M[0]);break;case i.OPS.setTextRenderingMode:this.setTextRenderingMode(M[0]);break;case i.OPS.setLineWidth:this.setLineWidth(M[0]);break;case i.OPS.setLineJoin:this.setLineJoin(M[0]);break;case i.OPS.setLineCap:this.setLineCap(M[0]);break;case i.OPS.setMiterLimit:this.setMiterLimit(M[0]);break;case i.OPS.setFillRGBColor:this.setFillRGBColor(M[0],M[1],M[2]);break;case i.OPS.setStrokeRGBColor:this.setStrokeRGBColor(M[0],M[1],M[2]);break;case i.OPS.setStrokeColorN:this.setStrokeColorN(M);break;case i.OPS.setFillColorN:this.setFillColorN(M);break;case i.OPS.shadingFill:this.shadingFill(M[0]);break;case i.OPS.setDash:this.setDash(M[0],M[1]);break;case i.OPS.setRenderingIntent:this.setRenderingIntent(M[0]);break;case i.OPS.setFlatness:this.setFlatness(M[0]);break;case i.OPS.setGState:this.setGState(M[0]);break;case i.OPS.fill:this.fill();break;case i.OPS.eoFill:this.eoFill();break;case i.OPS.stroke:this.stroke();break;case i.OPS.fillStroke:this.fillStroke();break;case i.OPS.eoFillStroke:this.eoFillStroke();break;case i.OPS.clip:this.clip("nonzero");break;case i.OPS.eoClip:this.clip("evenodd");break;case i.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case i.OPS.paintImageXObject:this.paintImageXObject(M[0]);break;case i.OPS.paintInlineImageXObject:this.paintInlineImageXObject(M[0]);break;case i.OPS.paintImageMaskXObject:this.paintImageMaskXObject(M[0]);break;case i.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(M[0],M[1]);break;case i.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case i.OPS.closePath:this.closePath();break;case i.OPS.closeStroke:this.closeStroke();break;case i.OPS.closeFillStroke:this.closeFillStroke();break;case i.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case i.OPS.nextLine:this.nextLine();break;case i.OPS.transform:this.transform(M[0],M[1],M[2],M[3],M[4],M[5]);break;case i.OPS.constructPath:this.constructPath(M[0],M[1]);break;case i.OPS.endPath:this.endPath();break;case 92:this.group(w.items);break;default:(0,i.warn)(`Unimplemented operator ${v}`);break}}}setWordSpacing(T){this.current.wordSpacing=T}setCharSpacing(T){this.current.charSpacing=T}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(T,w,v,L,M,X){const H=this.current;H.textMatrix=H.lineMatrix=[T,w,v,L,M,X],H.textMatrixScale=Math.hypot(T,w),H.x=H.lineX=0,H.y=H.lineY=0,H.xcoords=[],H.ycoords=[],H.tspan=this.svgFactory.createElement("svg:tspan"),H.tspan.setAttributeNS(null,"font-family",H.fontFamily),H.tspan.setAttributeNS(null,"font-size",`${m(H.fontSize)}px`),H.tspan.setAttributeNS(null,"y",m(-H.y)),H.txtElement=this.svgFactory.createElement("svg:text"),H.txtElement.append(H.tspan)}beginText(){const T=this.current;T.x=T.lineX=0,T.y=T.lineY=0,T.textMatrix=i.IDENTITY_MATRIX,T.lineMatrix=i.IDENTITY_MATRIX,T.textMatrixScale=1,T.tspan=this.svgFactory.createElement("svg:tspan"),T.txtElement=this.svgFactory.createElement("svg:text"),T.txtgrp=this.svgFactory.createElement("svg:g"),T.xcoords=[],T.ycoords=[]}moveText(T,w){const v=this.current;v.x=v.lineX+=T,v.y=v.lineY+=w,v.xcoords=[],v.ycoords=[],v.tspan=this.svgFactory.createElement("svg:tspan"),v.tspan.setAttributeNS(null,"font-family",v.fontFamily),v.tspan.setAttributeNS(null,"font-size",`${m(v.fontSize)}px`),v.tspan.setAttributeNS(null,"y",m(-v.y))}showText(T){const w=this.current,v=w.font,L=w.fontSize;if(L===0)return;const M=w.fontSizeScale,X=w.charSpacing,H=w.wordSpacing,ne=w.fontDirection,_e=w.textHScale*ne,ge=v.vertical,he=ge?1:-1,W=v.defaultVMetrics,se=L*w.fontMatrix[0];let ue=0;for(const me of T){if(me===null){ue+=ne*H;continue}else if(typeof me=="number"){ue+=he*me*L/1e3;continue}const N=(me.isSpace?H:0)+X,P=me.fontChar;let k,B,z=me.width;if(ge){let K;const F=me.vmetric||W;K=me.vmetric?F[1]:z*.5,K=-K*se;const I=F[2]*se;z=F?-F[0]:z,k=K/M,B=(ue+I)/M}else k=ue/M,B=0;(me.isInFont||v.missingFile)&&(w.xcoords.push(w.x+k),ge&&w.ycoords.push(-w.y+B),w.tspan.textContent+=P);let Q;ge?Q=z*se-N*ne:Q=z*se+N*ne,ue+=Q}w.tspan.setAttributeNS(null,"x",w.xcoords.map(m).join(" ")),ge?w.tspan.setAttributeNS(null,"y",w.ycoords.map(m).join(" ")):w.tspan.setAttributeNS(null,"y",m(-w.y)),ge?w.y-=ue:w.x+=ue*_e,w.tspan.setAttributeNS(null,"font-family",w.fontFamily),w.tspan.setAttributeNS(null,"font-size",`${m(w.fontSize)}px`),w.fontStyle!==f.fontStyle&&w.tspan.setAttributeNS(null,"font-style",w.fontStyle),w.fontWeight!==f.fontWeight&&w.tspan.setAttributeNS(null,"font-weight",w.fontWeight);const re=w.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;if(re===i.TextRenderingMode.FILL||re===i.TextRenderingMode.FILL_STROKE?(w.fillColor!==f.fillColor&&w.tspan.setAttributeNS(null,"fill",w.fillColor),w.fillAlpha<1&&w.tspan.setAttributeNS(null,"fill-opacity",w.fillAlpha)):w.textRenderingMode===i.TextRenderingMode.ADD_TO_PATH?w.tspan.setAttributeNS(null,"fill","transparent"):w.tspan.setAttributeNS(null,"fill","none"),re===i.TextRenderingMode.STROKE||re===i.TextRenderingMode.FILL_STROKE){const me=1/(w.textMatrixScale||1);this._setStrokeAttributes(w.tspan,me)}let q=w.textMatrix;w.textRise!==0&&(q=q.slice(),q[5]+=w.textRise),w.txtElement.setAttributeNS(null,"transform",`${A(q)} scale(${m(_e)}, -1)`),w.txtElement.setAttributeNS(d,"xml:space","preserve"),w.txtElement.append(w.tspan),w.txtgrp.append(w.txtElement),this._ensureTransformGroup().append(w.txtElement)}setLeadingMoveText(T,w){this.setLeading(-w),this.moveText(T,w)}addFontStyle(T){if(!T.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const w=y(T.data,T.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${T.loadedName}"; src: url(${w}); }
`}setFont(T){const w=this.current,v=this.commonObjs.get(T[0]);let L=T[1];w.font=v,this.embedFonts&&!v.missingFile&&!this.embeddedFonts[v.loadedName]&&(this.addFontStyle(v),this.embeddedFonts[v.loadedName]=v),w.fontMatrix=v.fontMatrix||i.FONT_IDENTITY_MATRIX;let M="normal";v.black?M="900":v.bold&&(M="bold");const X=v.italic?"italic":"normal";L<0?(L=-L,w.fontDirection=-1):w.fontDirection=1,w.fontSize=L,w.fontFamily=v.loadedName,w.fontWeight=M,w.fontStyle=X,w.tspan=this.svgFactory.createElement("svg:tspan"),w.tspan.setAttributeNS(null,"y",m(-w.y)),w.xcoords=[],w.ycoords=[]}endText(){var w;const T=this.current;T.textRenderingMode&i.TextRenderingMode.ADD_TO_PATH_FLAG&&((w=T.txtElement)!=null&&w.hasChildNodes())&&(T.element=T.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(T){T>0&&(this.current.lineWidth=T)}setLineCap(T){this.current.lineCap=p[T]}setLineJoin(T){this.current.lineJoin=E[T]}setMiterLimit(T){this.current.miterLimit=T}setStrokeAlpha(T){this.current.strokeAlpha=T}setStrokeRGBColor(T,w,v){this.current.strokeColor=i.Util.makeHexColor(T,w,v)}setFillAlpha(T){this.current.fillAlpha=T}setFillRGBColor(T,w,v){this.current.fillColor=i.Util.makeHexColor(T,w,v),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(T){this.current.strokeColor=this._makeColorN_Pattern(T)}setFillColorN(T){this.current.fillColor=this._makeColorN_Pattern(T)}shadingFill(T){const w=this.viewport.width,v=this.viewport.height,L=i.Util.inverseTransform(this.transformMatrix),M=i.Util.applyTransform([0,0],L),X=i.Util.applyTransform([0,v],L),H=i.Util.applyTransform([w,0],L),ne=i.Util.applyTransform([w,v],L),_e=Math.min(M[0],X[0],H[0],ne[0]),ge=Math.min(M[1],X[1],H[1],ne[1]),he=Math.max(M[0],X[0],H[0],ne[0]),W=Math.max(M[1],X[1],H[1],ne[1]),se=this.svgFactory.createElement("svg:rect");se.setAttributeNS(null,"x",_e),se.setAttributeNS(null,"y",ge),se.setAttributeNS(null,"width",he-_e),se.setAttributeNS(null,"height",W-ge),se.setAttributeNS(null,"fill",this._makeShadingPattern(T)),this.current.fillAlpha<1&&se.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(se)}_makeColorN_Pattern(T){return T[0]==="TilingPattern"?this._makeTilingPattern(T):this._makeShadingPattern(T)}_makeTilingPattern(T){const w=T[1],v=T[2],L=T[3]||i.IDENTITY_MATRIX,[M,X,H,ne]=T[4],_e=T[5],ge=T[6],he=T[7],W=`shading${R++}`,[se,ue,re,q]=i.Util.normalizeRect([...i.Util.applyTransform([M,X],L),...i.Util.applyTransform([H,ne],L)]),[me,N]=i.Util.singularValueDecompose2dScale(L),P=_e*me,k=ge*N,B=this.svgFactory.createElement("svg:pattern");B.setAttributeNS(null,"id",W),B.setAttributeNS(null,"patternUnits","userSpaceOnUse"),B.setAttributeNS(null,"width",P),B.setAttributeNS(null,"height",k),B.setAttributeNS(null,"x",`${se}`),B.setAttributeNS(null,"y",`${ue}`);const z=this.svg,Q=this.transformMatrix,K=this.current.fillColor,F=this.current.strokeColor,I=this.svgFactory.create(re-se,q-ue);if(this.svg=I,this.transformMatrix=L,he===2){const V=i.Util.makeHexColor(...w);this.current.fillColor=V,this.current.strokeColor=V}return this.executeOpTree(this.convertOpList(v)),this.svg=z,this.transformMatrix=Q,this.current.fillColor=K,this.current.strokeColor=F,B.append(I.childNodes[0]),this.defs.append(B),`url(#${W})`}_makeShadingPattern(T){switch(typeof T=="string"&&(T=this.objs.get(T)),T[0]){case"RadialAxial":const w=`shading${R++}`,v=T[3];let L;switch(T[1]){case"axial":const M=T[4],X=T[5];L=this.svgFactory.createElement("svg:linearGradient"),L.setAttributeNS(null,"id",w),L.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),L.setAttributeNS(null,"x1",M[0]),L.setAttributeNS(null,"y1",M[1]),L.setAttributeNS(null,"x2",X[0]),L.setAttributeNS(null,"y2",X[1]);break;case"radial":const H=T[4],ne=T[5],_e=T[6],ge=T[7];L=this.svgFactory.createElement("svg:radialGradient"),L.setAttributeNS(null,"id",w),L.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),L.setAttributeNS(null,"cx",ne[0]),L.setAttributeNS(null,"cy",ne[1]),L.setAttributeNS(null,"r",ge),L.setAttributeNS(null,"fx",H[0]),L.setAttributeNS(null,"fy",H[1]),L.setAttributeNS(null,"fr",_e);break;default:throw new Error(`Unknown RadialAxial type: ${T[1]}`)}for(const M of v){const X=this.svgFactory.createElement("svg:stop");X.setAttributeNS(null,"offset",M[0]),X.setAttributeNS(null,"stop-color",M[1]),L.append(X)}return this.defs.append(L),`url(#${w})`;case"Mesh":return(0,i.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${T[0]}`)}}setDash(T,w){this.current.dashArray=T,this.current.dashPhase=w}constructPath(T,w){const v=this.current;let L=v.x,M=v.y,X=[],H=0;for(const ne of T)switch(ne|0){case i.OPS.rectangle:L=w[H++],M=w[H++];const _e=w[H++],ge=w[H++],he=L+_e,W=M+ge;X.push("M",m(L),m(M),"L",m(he),m(M),"L",m(he),m(W),"L",m(L),m(W),"Z");break;case i.OPS.moveTo:L=w[H++],M=w[H++],X.push("M",m(L),m(M));break;case i.OPS.lineTo:L=w[H++],M=w[H++],X.push("L",m(L),m(M));break;case i.OPS.curveTo:L=w[H+4],M=w[H+5],X.push("C",m(w[H]),m(w[H+1]),m(w[H+2]),m(w[H+3]),m(L),m(M)),H+=6;break;case i.OPS.curveTo2:X.push("C",m(L),m(M),m(w[H]),m(w[H+1]),m(w[H+2]),m(w[H+3])),L=w[H+2],M=w[H+3],H+=4;break;case i.OPS.curveTo3:L=w[H+2],M=w[H+3],X.push("C",m(w[H]),m(w[H+1]),m(L),m(M),m(L),m(M)),H+=4;break;case i.OPS.closePath:X.push("Z");break}X=X.join(" "),v.path&&T.length>0&&T[0]!==i.OPS.rectangle&&T[0]!==i.OPS.moveTo?X=v.path.getAttributeNS(null,"d")+X:(v.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(v.path)),v.path.setAttributeNS(null,"d",X),v.path.setAttributeNS(null,"fill","none"),v.element=v.path,v.setCurrentPoint(L,M)}endPath(){const T=this.current;if(T.path=null,!this.pendingClip)return;if(!T.element){this.pendingClip=null;return}const w=`clippath${O++}`,v=this.svgFactory.createElement("svg:clipPath");v.setAttributeNS(null,"id",w),v.setAttributeNS(null,"transform",A(this.transformMatrix));const L=T.element.cloneNode(!0);if(this.pendingClip==="evenodd"?L.setAttributeNS(null,"clip-rule","evenodd"):L.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,v.append(L),this.defs.append(v),T.activeClipUrl){T.clipGroup=null;for(const M of this.extraStack)M.clipGroup=null;v.setAttributeNS(null,"clip-path",T.activeClipUrl)}T.activeClipUrl=`url(#${w})`,this.tgrp=null}clip(T){this.pendingClip=T}closePath(){const T=this.current;if(T.path){const w=`${T.path.getAttributeNS(null,"d")}Z`;T.path.setAttributeNS(null,"d",w)}}setLeading(T){this.current.leading=-T}setTextRise(T){this.current.textRise=T}setTextRenderingMode(T){this.current.textRenderingMode=T}setHScale(T){this.current.textHScale=T/100}setRenderingIntent(T){}setFlatness(T){}setGState(T){for(const[w,v]of T)switch(w){case"LW":this.setLineWidth(v);break;case"LC":this.setLineCap(v);break;case"LJ":this.setLineJoin(v);break;case"ML":this.setMiterLimit(v);break;case"D":this.setDash(v[0],v[1]);break;case"RI":this.setRenderingIntent(v);break;case"FL":this.setFlatness(v);break;case"Font":this.setFont(v);break;case"CA":this.setStrokeAlpha(v);break;case"ca":this.setFillAlpha(v);break;default:(0,i.warn)(`Unimplemented graphic state operator ${w}`);break}}fill(){const T=this.current;T.element&&(T.element.setAttributeNS(null,"fill",T.fillColor),T.element.setAttributeNS(null,"fill-opacity",T.fillAlpha),this.endPath())}stroke(){const T=this.current;T.element&&(this._setStrokeAttributes(T.element),T.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(T,w=1){const v=this.current;let L=v.dashArray;w!==1&&L.length>0&&(L=L.map(function(M){return w*M})),T.setAttributeNS(null,"stroke",v.strokeColor),T.setAttributeNS(null,"stroke-opacity",v.strokeAlpha),T.setAttributeNS(null,"stroke-miterlimit",m(v.miterLimit)),T.setAttributeNS(null,"stroke-linecap",v.lineCap),T.setAttributeNS(null,"stroke-linejoin",v.lineJoin),T.setAttributeNS(null,"stroke-width",m(w*v.lineWidth)+"px"),T.setAttributeNS(null,"stroke-dasharray",L.map(m).join(" ")),T.setAttributeNS(null,"stroke-dashoffset",m(w*v.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const T=this.svgFactory.createElement("svg:rect");T.setAttributeNS(null,"x","0"),T.setAttributeNS(null,"y","0"),T.setAttributeNS(null,"width","1px"),T.setAttributeNS(null,"height","1px"),T.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(T)}paintImageXObject(T){const w=T.startsWith("g_")?this.commonObjs.get(T):this.objs.get(T);if(!w){(0,i.warn)(`Dependent image with object ID ${T} is not ready yet`);return}this.paintInlineImageXObject(w)}paintInlineImageXObject(T,w){const v=T.width,L=T.height,M=S(T,this.forceDataSchema,!!w),X=this.svgFactory.createElement("svg:rect");X.setAttributeNS(null,"x","0"),X.setAttributeNS(null,"y","0"),X.setAttributeNS(null,"width",m(v)),X.setAttributeNS(null,"height",m(L)),this.current.element=X,this.clip("nonzero");const H=this.svgFactory.createElement("svg:image");H.setAttributeNS(h,"xlink:href",M),H.setAttributeNS(null,"x","0"),H.setAttributeNS(null,"y",m(-L)),H.setAttributeNS(null,"width",m(v)+"px"),H.setAttributeNS(null,"height",m(L)+"px"),H.setAttributeNS(null,"transform",`scale(${m(1/v)} ${m(-1/L)})`),w?w.append(H):this._ensureTransformGroup().append(H)}paintImageMaskXObject(T){const w=this.current,v=T.width,L=T.height,M=w.fillColor;w.maskId=`mask${C++}`;const X=this.svgFactory.createElement("svg:mask");X.setAttributeNS(null,"id",w.maskId);const H=this.svgFactory.createElement("svg:rect");H.setAttributeNS(null,"x","0"),H.setAttributeNS(null,"y","0"),H.setAttributeNS(null,"width",m(v)),H.setAttributeNS(null,"height",m(L)),H.setAttributeNS(null,"fill",M),H.setAttributeNS(null,"mask",`url(#${w.maskId})`),this.defs.append(X),this._ensureTransformGroup().append(H),this.paintInlineImageXObject(T,X)}paintFormXObjectBegin(T,w){if(Array.isArray(T)&&T.length===6&&this.transform(T[0],T[1],T[2],T[3],T[4],T[5]),w){const v=w[2]-w[0],L=w[3]-w[1],M=this.svgFactory.createElement("svg:rect");M.setAttributeNS(null,"x",w[0]),M.setAttributeNS(null,"y",w[1]),M.setAttributeNS(null,"width",m(v)),M.setAttributeNS(null,"height",m(L)),this.current.element=M,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(T){const w=this.svgFactory.create(T.width,T.height),v=this.svgFactory.createElement("svg:defs");w.append(v),this.defs=v;const L=this.svgFactory.createElement("svg:g");return L.setAttributeNS(null,"transform",A(T.transform)),w.append(L),this.svg=L,w}_ensureClipGroup(){if(!this.current.clipGroup){const T=this.svgFactory.createElement("svg:g");T.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(T),this.current.clipGroup=T}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",A(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFNodeStream=void 0;var n=t(1),i=t(33);const l=require$$5,c=require$$5,f=require$$5,d=require$$5,h=/^file:\/\/\/[a-zA-Z]:\//;function p(C){const R=d.parse(C);return R.protocol==="file:"||R.host?R:/^[a-z]:[/\\]/i.test(C)?d.parse(`file:///${C}`):(R.host||(R.protocol="file:"),R)}class E{constructor(R){this.source=R,this.url=p(R.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&R.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var R;return((R=this._fullRequestReader)==null?void 0:R._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new A(this):new g(this),this._fullRequestReader}getRangeReader(R,T){if(T<=this._progressiveDataLength)return null;const w=this.isFsUrl?new O(this,R,T):new m(this,R,T);return this._rangeRequestReaders.push(w),w}cancelAllRequests(R){this._fullRequestReader&&this._fullRequestReader.cancel(R);for(const T of this._rangeRequestReaders.slice(0))T.cancel(R)}}r.PDFNodeStream=E;class y{constructor(R){this._url=R.url,this._done=!1,this._storedError=null,this.onProgress=null;const T=R.source;this._contentLength=T.length,this._loaded=0,this._filename=null,this._disableRange=T.disableRange||!1,this._rangeChunkSize=T.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!T.disableStream,this._isRangeSupported=!T.disableRange,this._readableStream=null,this._readCapability=(0,n.createPromiseCapability)(),this._headersCapability=(0,n.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const R=this._readableStream.read();return R===null?(this._readCapability=(0,n.createPromiseCapability)(),this.read()):(this._loaded+=R.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(R).buffer,done:!1})}cancel(R){if(!this._readableStream){this._error(R);return}this._readableStream.destroy(R)}_error(R){this._storedError=R,this._readCapability.resolve()}_setReadableStream(R){this._readableStream=R,R.on("readable",()=>{this._readCapability.resolve()}),R.on("end",()=>{R.destroy(),this._done=!0,this._readCapability.resolve()}),R.on("error",T=>{this._error(T)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class S{constructor(R){this._url=R.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,n.createPromiseCapability)();const T=R.source;this._isStreamingSupported=!T.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const R=this._readableStream.read();return R===null?(this._readCapability=(0,n.createPromiseCapability)(),this.read()):(this._loaded+=R.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(R).buffer,done:!1})}cancel(R){if(!this._readableStream){this._error(R);return}this._readableStream.destroy(R)}_error(R){this._storedError=R,this._readCapability.resolve()}_setReadableStream(R){this._readableStream=R,R.on("readable",()=>{this._readCapability.resolve()}),R.on("end",()=>{R.destroy(),this._done=!0,this._readCapability.resolve()}),R.on("error",T=>{this._error(T)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function x(C,R){return{protocol:C.protocol,auth:C.auth,host:C.hostname,port:C.port,path:C.path,method:"GET",headers:R}}class g extends y{constructor(R){super(R);const T=w=>{if(w.statusCode===404){const X=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=X,this._headersCapability.reject(X);return}this._headersCapability.resolve(),this._setReadableStream(w);const v=X=>this._readableStream.headers[X.toLowerCase()],{allowRangeRequests:L,suggestedLength:M}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:v,isHttp:R.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=L,this._contentLength=M||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(v)};this._request=null,this._url.protocol==="http:"?this._request=c.request(x(this._url,R.httpHeaders),T):this._request=f.request(x(this._url,R.httpHeaders),T),this._request.on("error",w=>{this._storedError=w,this._headersCapability.reject(w)}),this._request.end()}}class m extends S{constructor(R,T,w){super(R),this._httpHeaders={};for(const L in R.httpHeaders){const M=R.httpHeaders[L];typeof M>"u"||(this._httpHeaders[L]=M)}this._httpHeaders.Range=`bytes=${T}-${w-1}`;const v=L=>{if(L.statusCode===404){const M=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=M;return}this._setReadableStream(L)};this._request=null,this._url.protocol==="http:"?this._request=c.request(x(this._url,this._httpHeaders),v):this._request=f.request(x(this._url,this._httpHeaders),v),this._request.on("error",L=>{this._storedError=L}),this._request.end()}}class A extends y{constructor(R){super(R);let T=decodeURIComponent(this._url.path);h.test(this._url.href)&&(T=T.replace(/^\//,"")),l.lstat(T,(w,v)=>{if(w){w.code==="ENOENT"&&(w=new n.MissingPDFException(`Missing PDF "${T}".`)),this._storedError=w,this._headersCapability.reject(w);return}this._contentLength=v.size,this._setReadableStream(l.createReadStream(T)),this._headersCapability.resolve()})}}class O extends S{constructor(R,T,w){super(R);let v=decodeURIComponent(this._url.path);h.test(this._url.href)&&(v=v.replace(/^\//,"")),this._setReadableStream(l.createReadStream(v,{start:T,end:w-1}))}}},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.createResponseStatusError=d,r.extractFilenameFromHeader=f,r.validateRangeRequestCapabilities=c,r.validateResponseStatus=h;var n=t(1),i=t(34),l=t(8);function c({getResponseHeader:p,isHttp:E,rangeChunkSize:y,disableRange:S}){const x={allowRangeRequests:!1,suggestedLength:void 0},g=parseInt(p("Content-Length"),10);return!Number.isInteger(g)||(x.suggestedLength=g,g<=2*y)||S||!E||p("Accept-Ranges")!=="bytes"||(p("Content-Encoding")||"identity")!=="identity"||(x.allowRangeRequests=!0),x}function f(p){const E=p("Content-Disposition");if(E){let y=(0,i.getFilenameFromContentDispositionHeader)(E);if(y.includes("%"))try{y=decodeURIComponent(y)}catch{}if((0,l.isPdfFile)(y))return y}return null}function d(p,E){return p===404||p===0&&E.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+E+'".'):new n.UnexpectedResponseException(`Unexpected server response (${p}) while retrieving PDF "${E}".`,p)}function h(p){return p===200||p===206}},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.getFilenameFromContentDispositionHeader=i;var n=t(1);function i(l){let c=!0,f=d("filename\\*","i").exec(l);if(f){f=f[1];let g=y(f);return g=unescape(g),g=S(g),g=x(g),p(g)}if(f=E(l),f){const g=x(f);return p(g)}if(f=d("filename","i").exec(l),f){f=f[1];let g=y(f);return g=x(g),p(g)}function d(g,m){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',m)}function h(g,m){if(g){if(!/^[\x00-\xFF]+$/.test(m))return m;try{const A=new TextDecoder(g,{fatal:!0}),O=(0,n.stringToBytes)(m);m=A.decode(O),c=!1}catch{}}return m}function p(g){return c&&/[\x80-\xff]/.test(g)&&(g=h("utf-8",g),c&&(g=h("iso-8859-1",g))),g}function E(g){const m=[];let A;const O=d("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(A=O.exec(g))!==null;){let[,R,T,w]=A;if(R=parseInt(R,10),R in m){if(R===0)break;continue}m[R]=[T,w]}const C=[];for(let R=0;R<m.length&&R in m;++R){let[T,w]=m[R];w=y(w),T&&(w=unescape(w),R===0&&(w=S(w))),C.push(w)}return C.join("")}function y(g){if(g.startsWith('"')){const m=g.slice(1).split('\\"');for(let A=0;A<m.length;++A){const O=m[A].indexOf('"');O!==-1&&(m[A]=m[A].slice(0,O),m.length=A+1),m[A]=m[A].replace(/\\(.)/g,"$1")}g=m.join('"')}return g}function S(g){const m=g.indexOf("'");if(m===-1)return g;const A=g.slice(0,m),C=g.slice(m+1).replace(/^[^']*'/,"");return h(A,C)}function x(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(m,A,O,C){if(O==="q"||O==="Q")return C=C.replace(/_/g," "),C=C.replace(/=([0-9a-fA-F]{2})/g,function(R,T){return String.fromCharCode(parseInt(T,16))}),h(A,C);try{C=atob(C)}catch{}return h(A,C)})}return""}},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFNetworkStream=void 0;var n=t(1),i=t(33);const l=200,c=206;function f(y){const S=y.response;return typeof S!="string"?S:(0,n.stringToBytes)(S).buffer}class d{constructor(S,x={}){this.url=S,this.isHttp=/^https?:/i.test(S),this.httpHeaders=this.isHttp&&x.httpHeaders||Object.create(null),this.withCredentials=x.withCredentials||!1,this.getXhr=x.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(S,x,g){const m={begin:S,end:x};for(const A in g)m[A]=g[A];return this.request(m)}requestFull(S){return this.request(S)}request(S){const x=this.getXhr(),g=this.currXhrId++,m=this.pendingRequests[g]={xhr:x};x.open("GET",this.url),x.withCredentials=this.withCredentials;for(const A in this.httpHeaders){const O=this.httpHeaders[A];typeof O>"u"||x.setRequestHeader(A,O)}return this.isHttp&&"begin"in S&&"end"in S?(x.setRequestHeader("Range",`bytes=${S.begin}-${S.end-1}`),m.expectedStatus=c):m.expectedStatus=l,x.responseType="arraybuffer",S.onError&&(x.onerror=function(A){S.onError(x.status)}),x.onreadystatechange=this.onStateChange.bind(this,g),x.onprogress=this.onProgress.bind(this,g),m.onHeadersReceived=S.onHeadersReceived,m.onDone=S.onDone,m.onError=S.onError,m.onProgress=S.onProgress,x.send(null),g}onProgress(S,x){var m;const g=this.pendingRequests[S];g&&((m=g.onProgress)==null||m.call(g,x))}onStateChange(S,x){var R,T,w;const g=this.pendingRequests[S];if(!g)return;const m=g.xhr;if(m.readyState>=2&&g.onHeadersReceived&&(g.onHeadersReceived(),delete g.onHeadersReceived),m.readyState!==4||!(S in this.pendingRequests))return;if(delete this.pendingRequests[S],m.status===0&&this.isHttp){(R=g.onError)==null||R.call(g,m.status);return}const A=m.status||l;if(!(A===l&&g.expectedStatus===c)&&A!==g.expectedStatus){(T=g.onError)==null||T.call(g,m.status);return}const C=f(m);if(A===c){const v=m.getResponseHeader("Content-Range"),L=/bytes (\d+)-(\d+)\/(\d+)/.exec(v);g.onDone({begin:parseInt(L[1],10),chunk:C})}else C?g.onDone({begin:0,chunk:C}):(w=g.onError)==null||w.call(g,m.status)}getRequestXhr(S){return this.pendingRequests[S].xhr}isPendingRequest(S){return S in this.pendingRequests}abortRequest(S){const x=this.pendingRequests[S].xhr;delete this.pendingRequests[S],x.abort()}}class h{constructor(S){this._source=S,this._manager=new d(S.url,{httpHeaders:S.httpHeaders,withCredentials:S.withCredentials}),this._rangeChunkSize=S.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(S){const x=this._rangeRequestReaders.indexOf(S);x>=0&&this._rangeRequestReaders.splice(x,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new p(this._manager,this._source),this._fullRequestReader}getRangeReader(S,x){const g=new E(this._manager,S,x);return g.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(g),g}cancelAllRequests(S){var x;(x=this._fullRequestReader)==null||x.cancel(S);for(const g of this._rangeRequestReaders.slice(0))g.cancel(S)}}r.PDFNetworkStream=h;class p{constructor(S,x){this._manager=S;const g={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=x.url,this._fullRequestId=S.requestFull(g),this._headersReceivedCapability=(0,n.createPromiseCapability)(),this._disableRange=x.disableRange||!1,this._contentLength=x.length,this._rangeChunkSize=x.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const S=this._fullRequestId,x=this._manager.getRequestXhr(S),g=O=>x.getResponseHeader(O),{allowRangeRequests:m,suggestedLength:A}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});m&&(this._isRangeSupported=!0),this._contentLength=A||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(g),this._isRangeSupported&&this._manager.abortRequest(S),this._headersReceivedCapability.resolve()}_onDone(S){if(S&&(this._requests.length>0?this._requests.shift().resolve({value:S.chunk,done:!1}):this._cachedChunks.push(S.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const x of this._requests)x.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(S){this._storedError=(0,i.createResponseStatusError)(S,this._url),this._headersReceivedCapability.reject(this._storedError);for(const x of this._requests)x.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(S){var x;(x=this.onProgress)==null||x.call(this,{loaded:S.loaded,total:S.lengthComputable?S.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const S=(0,n.createPromiseCapability)();return this._requests.push(S),S.promise}cancel(S){this._done=!0,this._headersReceivedCapability.reject(S);for(const x of this._requests)x.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class E{constructor(S,x,g){this._manager=S;const m={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=S.url,this._requestId=S.requestRange(x,g,m),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var S;(S=this.onClosed)==null||S.call(this,this)}_onDone(S){const x=S.chunk;this._requests.length>0?this._requests.shift().resolve({value:x,done:!1}):this._queuedChunk=x,this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(S){this._storedError=(0,i.createResponseStatusError)(S,this._url);for(const x of this._requests)x.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(S){var x;this.isStreamingSupported||(x=this.onProgress)==null||x.call(this,{loaded:S.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const x=this._queuedChunk;return this._queuedChunk=null,{value:x,done:!1}}if(this._done)return{value:void 0,done:!0};const S=(0,n.createPromiseCapability)();return this._requests.push(S),S.promise}cancel(S){this._done=!0;for(const x of this._requests)x.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFFetchStream=void 0;var n=t(1),i=t(33);function l(p,E,y){return{method:"GET",headers:p,signal:y.signal,mode:"cors",credentials:E?"include":"same-origin",redirect:"follow"}}function c(p){const E=new Headers;for(const y in p){const S=p[y];typeof S>"u"||E.append(y,S)}return E}class f{constructor(E){this.source=E,this.isHttp=/^https?:/i.test(E.url),this.httpHeaders=this.isHttp&&E.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var E;return((E=this._fullRequestReader)==null?void 0:E._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new d(this),this._fullRequestReader}getRangeReader(E,y){if(y<=this._progressiveDataLength)return null;const S=new h(this,E,y);return this._rangeRequestReaders.push(S),S}cancelAllRequests(E){this._fullRequestReader&&this._fullRequestReader.cancel(E);for(const y of this._rangeRequestReaders.slice(0))y.cancel(E)}}r.PDFFetchStream=f;class d{constructor(E){this._stream=E,this._reader=null,this._loaded=0,this._filename=null;const y=E.source;this._withCredentials=y.withCredentials||!1,this._contentLength=y.length,this._headersCapability=(0,n.createPromiseCapability)(),this._disableRange=y.disableRange||!1,this._rangeChunkSize=y.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!y.disableStream,this._isRangeSupported=!y.disableRange,this._headers=c(this._stream.httpHeaders);const S=y.url;fetch(S,l(this._headers,this._withCredentials,this._abortController)).then(x=>{if(!(0,i.validateResponseStatus)(x.status))throw(0,i.createResponseStatusError)(x.status,S);this._reader=x.body.getReader(),this._headersCapability.resolve();const g=O=>x.headers.get(O),{allowRangeRequests:m,suggestedLength:A}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=m,this._contentLength=A||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(g),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:E,done:y}=await this._reader.read();return y?{value:E,done:y}:(this._loaded+=E.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(E).buffer,done:!1})}cancel(E){this._reader&&this._reader.cancel(E),this._abortController.abort()}}class h{constructor(E,y,S){this._stream=E,this._reader=null,this._loaded=0;const x=E.source;this._withCredentials=x.withCredentials||!1,this._readCapability=(0,n.createPromiseCapability)(),this._isStreamingSupported=!x.disableStream,this._abortController=new AbortController,this._headers=c(this._stream.httpHeaders),this._headers.append("Range",`bytes=${y}-${S-1}`);const g=x.url;fetch(g,l(this._headers,this._withCredentials,this._abortController)).then(m=>{if(!(0,i.validateResponseStatus)(m.status))throw(0,i.createResponseStatusError)(m.status,g);this._readCapability.resolve(),this._reader=m.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:E,done:y}=await this._reader.read();return y?{value:E,done:y}:(this._loaded+=E.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(E).buffer,done:!1})}cancel(E){this._reader&&this._reader.cancel(E),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(e){var r=__webpack_module_cache__[e];if(r!==void 0)return r.exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](t,t.exports,__w_pdfjs_require__),t.exports}var __webpack_exports__={};return(()=>{var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"AnnotationEditorLayer",{enumerable:!0,get:function(){return i.AnnotationEditorLayer}}),Object.defineProperty(e,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return r.AnnotationEditorParamsType}}),Object.defineProperty(e,"AnnotationEditorType",{enumerable:!0,get:function(){return r.AnnotationEditorType}}),Object.defineProperty(e,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return l.AnnotationEditorUIManager}}),Object.defineProperty(e,"AnnotationLayer",{enumerable:!0,get:function(){return c.AnnotationLayer}}),Object.defineProperty(e,"AnnotationMode",{enumerable:!0,get:function(){return r.AnnotationMode}}),Object.defineProperty(e,"CMapCompressionType",{enumerable:!0,get:function(){return r.CMapCompressionType}}),Object.defineProperty(e,"GlobalWorkerOptions",{enumerable:!0,get:function(){return f.GlobalWorkerOptions}}),Object.defineProperty(e,"InvalidPDFException",{enumerable:!0,get:function(){return r.InvalidPDFException}}),Object.defineProperty(e,"LoopbackPort",{enumerable:!0,get:function(){return t.LoopbackPort}}),Object.defineProperty(e,"MissingPDFException",{enumerable:!0,get:function(){return r.MissingPDFException}}),Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return r.OPS}}),Object.defineProperty(e,"PDFDataRangeTransport",{enumerable:!0,get:function(){return t.PDFDataRangeTransport}}),Object.defineProperty(e,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(e,"PDFWorker",{enumerable:!0,get:function(){return t.PDFWorker}}),Object.defineProperty(e,"PasswordResponses",{enumerable:!0,get:function(){return r.PasswordResponses}}),Object.defineProperty(e,"PermissionFlag",{enumerable:!0,get:function(){return r.PermissionFlag}}),Object.defineProperty(e,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty(e,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(e,"SVGGraphics",{enumerable:!0,get:function(){return p.SVGGraphics}}),Object.defineProperty(e,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return r.UNSUPPORTED_FEATURES}}),Object.defineProperty(e,"UnexpectedResponseException",{enumerable:!0,get:function(){return r.UnexpectedResponseException}}),Object.defineProperty(e,"Util",{enumerable:!0,get:function(){return r.Util}}),Object.defineProperty(e,"VerbosityLevel",{enumerable:!0,get:function(){return r.VerbosityLevel}}),Object.defineProperty(e,"XfaLayer",{enumerable:!0,get:function(){return E.XfaLayer}}),Object.defineProperty(e,"build",{enumerable:!0,get:function(){return t.build}}),Object.defineProperty(e,"createPromiseCapability",{enumerable:!0,get:function(){return r.createPromiseCapability}}),Object.defineProperty(e,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return r.createValidAbsoluteUrl}}),Object.defineProperty(e,"getDocument",{enumerable:!0,get:function(){return t.getDocument}}),Object.defineProperty(e,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(e,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(e,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty(e,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(e,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(e,"renderTextLayer",{enumerable:!0,get:function(){return h.renderTextLayer}}),Object.defineProperty(e,"shadow",{enumerable:!0,get:function(){return r.shadow}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return t.version}});var r=__w_pdfjs_require__(1),t=__w_pdfjs_require__(4),n=__w_pdfjs_require__(8),i=__w_pdfjs_require__(22),l=__w_pdfjs_require__(7),c=__w_pdfjs_require__(27),f=__w_pdfjs_require__(15),d=__w_pdfjs_require__(3),h=__w_pdfjs_require__(30),p=__w_pdfjs_require__(31),E=__w_pdfjs_require__(29);if(d.isNodeJS){const{PDFNodeStream:y}=__w_pdfjs_require__(32);(0,t.setPDFNetworkStreamFactory)(S=>new y(S))}else{const{PDFNetworkStream:y}=__w_pdfjs_require__(35),{PDFFetchStream:S}=__w_pdfjs_require__(36);(0,t.setPDFNetworkStreamFactory)(x=>(0,n.isValidFetchUrl)(x.url)?new S(x):new y(x))}})(),__webpack_exports__})())}(pdf)),pdf.exports}var pdfExports=requirePdf();pdfExports.GlobalWorkerOptions.workerSrc="/pdf.worker.min.js";const supabaseUrl$1="https://ydxelzxjsuemylifgwte.supabase.co",supabaseAnonKey$1="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkeGVsenhqc3VlbXlsaWZnd3RlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzY2MDY4MzAsImV4cCI6MjA1MjE4MjgzMH0.Nnbgsp8NvJaD_DyXpsNwnvrdZUwZz4ylWzv7_fglxPo";createClient(supabaseUrl$1,supabaseAnonKey$1);const CommentListener=()=>{const[e,r]=reactExports.useState(()=>JSON.parse(localStorage.getItem("messages"))||[]),[t,n]=reactExports.useState("John"),[i,l]=reactExports.useState(""),[c,f]=reactExports.useState("none");async function d(A){try{const C=p.join(" ");alert(C+`
Based on the previous text, provide a natural and conversational response to the following question :  `+A);var O=atob("c2stcHJvai1iV2Z5UEdZUE80OFZJMGVfQmFaSjM2ZnV1X1c5M3c1eDNhWnF0OE9XS0RObFY3RFZrMWdQQ0xaaFdZTUhKdDI5N1ZIRERZMUEwblQzQmxia0ZKckJVa0lBT0J3MFY3RU9OcXE0bllVYUduYUExVTM3SmVBYTEzNDNNYUlwUDQycEdJX1Rtd2wyTGFxV3ZFV19fWkJQc0tQUlpxWUE=");return(await(await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+O},body:JSON.stringify({model:"gpt-4",messages:[{role:"system",content:"You are a helpful assistant."},{role:"user",content:C+`
Based on the previous text, provide a natural and conversational response to the following question :  `+A}],max_tokens:200})})).json()).choices[0].message.content}catch(C){return console.error("Error fetching ChatGPT response:",C),"Sorry, I couldn't process your request."}}const h=reactExports.useRef(null),[p,E]=reactExports.useState([]);reactExports.useEffect(()=>{(async()=>{try{const C="/files/LISIS FERRERA CV_EN.pdf;/files/Mathematical database development_.pdf".split(";");alert(C);const R=C.map(v=>fetch(v).then(L=>{if(v.endsWith(".txt"))return L.text();if(v.endsWith(".pdf"))return L.arrayBuffer();if(v.endsWith(".xlsx"))return L.arrayBuffer()}).catch(L=>console.error("Error fetching file:",L)));alert("B"+R.length);const T=await Promise.all(R),w=await Promise.all(T.map((v,L)=>{const M=C[L];if(M.endsWith(".txt"))return v;if(M.endsWith(".pdf"))return y(v);if(M.endsWith(".xlsx"))return S(v)}));alert("A"+w.length),E(w)}catch(O){console.error("Error in fetchFiles function:",O)}})()},[]);const y=async A=>{const O=await pdfExports.getDocument({data:A}).promise;let C="";for(let R=1;R<=O.numPages;R++){const v=(await(await O.getPage(R)).getTextContent()).items.map(L=>L.str).join(" ");C+=v+`
`}return C},S=A=>{const O=readSync(A,{type:"array"});let C="";return O.SheetNames.forEach(R=>{const T=O.Sheets[R];C+=utils.sheet_to_csv(T)+`
`}),C};reactExports.useEffect(()=>{localStorage.setItem("messages",JSON.stringify(e))},[e]),reactExports.useEffect(()=>{h.current&&(h.current.scrollTop=h.current.scrollHeight)},[e]);const x=A=>{n(A)},g=async A=>{if(A.preventDefault(),i.trim()==="")return;const O=new Date().toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}),C={sender:t,text:i,timestamp:O};if(r(R=>[...R,C]),t==="John"){console.log("msg : "+i),f("flex");const T={sender:"Jane",text:await d(i),timestamp:O};r(w=>[...w,T]),f("none")}l("")},m=()=>{localStorage.clear(),r([])};return jsxRuntimeExports.jsxs("div",{className:"app-container",children:[jsxRuntimeExports.jsxs("div",{className:"person-selector",children:[jsxRuntimeExports.jsx("button",{className:`button person-selector-button ${t==="John"?"active-person":""}`,onClick:()=>x("John"),children:"John"}),jsxRuntimeExports.jsx("button",{className:`button person-selector-button ${t==="Jane"?"active-person":""}`,onClick:()=>x("Jane"),children:"Jane"})]}),jsxRuntimeExports.jsxs("div",{className:"chat-container",children:[jsxRuntimeExports.jsxs("div",{className:"chat-header typing-indicator",style:{display:c},children:[jsxRuntimeExports.jsxs("h2",{className:"chat-header",children:[t," chatting"]}),jsxRuntimeExports.jsx("span",{className:"dot"}),jsxRuntimeExports.jsx("span",{className:"dot"}),jsxRuntimeExports.jsx("span",{className:"dot"})]}),jsxRuntimeExports.jsx("div",{ref:h,className:"chat-messages",children:e.map((A,O)=>jsxRuntimeExports.jsxs("div",{className:`message ${A.sender==="John"?"blue-bg":"gray-bg"}`,children:[jsxRuntimeExports.jsx("div",{className:"message-sender",children:A.sender}),jsxRuntimeExports.jsx("div",{className:"message-text",children:A.text}),jsxRuntimeExports.jsx("div",{className:"message-timestamp",children:A.timestamp})]},O))}),jsxRuntimeExports.jsxs("form",{className:"chat-input-form",onSubmit:g,children:[jsxRuntimeExports.jsx("textarea",{id:"message",name:"message",rows:"5",cols:"50",className:"chat-input",value:i,placeholder:`Type here, ${t}...`,onChange:A=>l(A.target.value)}),jsxRuntimeExports.jsx("button",{type:"submit",className:"button send-button",children:"Send"})]}),jsxRuntimeExports.jsx("button",{className:"button send-button",onClick:m,children:"Clear Chat"})]})]})},supabaseUrl="https://ydxelzxjsuemylifgwte.supabase.co",supabaseAnonKey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkeGVsenhqc3VlbXlsaWZnd3RlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzY2MDY4MzAsImV4cCI6MjA1MjE4MjgzMH0.Nnbgsp8NvJaD_DyXpsNwnvrdZUwZz4ylWzv7_fglxPo";createClient(supabaseUrl,supabaseAnonKey);const App=()=>jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("main",{children:jsxRuntimeExports.jsx(CommentListener,{})})}),root=ReactDOM.createRoot(document.getElementById("root"));root.render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(BrowserRouter,{basename:"/",children:jsxRuntimeExports.jsx(App,{})})}));export{getDefaultExportFromCjs as g};
