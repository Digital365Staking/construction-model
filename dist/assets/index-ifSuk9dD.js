var EF=Object.defineProperty;var KS=n=>{throw TypeError(n)};var bF=(n,t,e)=>t in n?EF(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var Ve=(n,t,e)=>bF(n,typeof t!="symbol"?t+"":t,e),xy=(n,t,e)=>t.has(n)||KS("Cannot "+e);var g=(n,t,e)=>(xy(n,t,"read from private field"),e?e.call(n):t.get(n)),R=(n,t,e)=>t.has(n)?KS("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),T=(n,t,e,r)=>(xy(n,t,"write to private field"),r?r.call(n,e):t.set(n,e),e),D=(n,t,e)=>(xy(n,t,"access private method"),e);var Ln=(n,t,e,r)=>({set _(a){T(n,t,a,e)},get _(){return g(n,t,r)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function e(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=e(a);fetch(a.href,s)}})();function kA(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function SF(n){if(n.__esModule)return n;var t=n.default;if(typeof t=="function"){var e=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var a=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(e,r,a.get?a:{enumerable:!0,get:function(){return n[r]}})}),e}var vy={exports:{}},s0={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QS;function TF(){if(QS)return s0;QS=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(r,a,s){var l=null;if(s!==void 0&&(l=""+s),a.key!==void 0&&(l=""+a.key),"key"in a){s={};for(var c in a)c!=="key"&&(s[c]=a[c])}else s=a;return a=s.ref,{$$typeof:n,type:r,key:l,ref:a!==void 0?a:null,props:s}}return s0.Fragment=t,s0.jsx=e,s0.jsxs=e,s0}var ZS;function kF(){return ZS||(ZS=1,vy.exports=TF()),vy.exports}var qt=kF(),_y={exports:{}},nt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JS;function CF(){if(JS)return nt;JS=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),m=Symbol.iterator;function x(V){return V===null||typeof V!="object"?null:(V=m&&V[m]||V["@@iterator"],typeof V=="function"?V:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,A={};function E(V,fe,U){this.props=V,this.context=fe,this.refs=A,this.updater=U||_}E.prototype.isReactComponent={},E.prototype.setState=function(V,fe){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,fe,"setState")},E.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function b(){}b.prototype=E.prototype;function C(V,fe,U){this.props=V,this.context=fe,this.refs=A,this.updater=U||_}var S=C.prototype=new b;S.constructor=C,y(S,E.prototype),S.isPureReactComponent=!0;var O=Array.isArray,L={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function F(V,fe,U,Q,X,K){return U=K.ref,{$$typeof:n,type:V,key:fe,ref:U!==void 0?U:null,props:K}}function W(V,fe){return F(V.type,fe,void 0,void 0,void 0,V.props)}function B(V){return typeof V=="object"&&V!==null&&V.$$typeof===n}function ee(V){var fe={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(U){return fe[U]})}var Z=/\/+/g;function te(V,fe){return typeof V=="object"&&V!==null&&V.key!=null?ee(""+V.key):fe.toString(36)}function ve(){}function Ce(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(ve,ve):(V.status="pending",V.then(function(fe){V.status==="pending"&&(V.status="fulfilled",V.value=fe)},function(fe){V.status==="pending"&&(V.status="rejected",V.reason=fe)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function Ee(V,fe,U,Q,X){var K=typeof V;(K==="undefined"||K==="boolean")&&(V=null);var se=!1;if(V===null)se=!0;else switch(K){case"bigint":case"string":case"number":se=!0;break;case"object":switch(V.$$typeof){case n:case t:se=!0;break;case d:return se=V._init,Ee(se(V._payload),fe,U,Q,X)}}if(se)return X=X(V),se=Q===""?"."+te(V,0):Q,O(X)?(U="",se!=null&&(U=se.replace(Z,"$&/")+"/"),Ee(X,fe,U,"",function(Te){return Te})):X!=null&&(B(X)&&(X=W(X,U+(X.key==null||V&&V.key===X.key?"":(""+X.key).replace(Z,"$&/")+"/")+se)),fe.push(X)),1;se=0;var _e=Q===""?".":Q+":";if(O(V))for(var be=0;be<V.length;be++)Q=V[be],K=_e+te(Q,be),se+=Ee(Q,fe,U,K,X);else if(be=x(V),typeof be=="function")for(V=be.call(V),be=0;!(Q=V.next()).done;)Q=Q.value,K=_e+te(Q,be++),se+=Ee(Q,fe,U,K,X);else if(K==="object"){if(typeof V.then=="function")return Ee(Ce(V),fe,U,Q,X);throw fe=String(V),Error("Objects are not valid as a React child (found: "+(fe==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":fe)+"). If you meant to render a collection of children, use an array instead.")}return se}function J(V,fe,U){if(V==null)return V;var Q=[],X=0;return Ee(V,Q,"","",function(K){return fe.call(U,K,X++)}),Q}function oe(V){if(V._status===-1){var fe=V._result;fe=fe(),fe.then(function(U){(V._status===0||V._status===-1)&&(V._status=1,V._result=U)},function(U){(V._status===0||V._status===-1)&&(V._status=2,V._result=U)}),V._status===-1&&(V._status=0,V._result=fe)}if(V._status===1)return V._result.default;throw V._result}var De=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var fe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(fe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)};function ae(){}return nt.Children={map:J,forEach:function(V,fe,U){J(V,function(){fe.apply(this,arguments)},U)},count:function(V){var fe=0;return J(V,function(){fe++}),fe},toArray:function(V){return J(V,function(fe){return fe})||[]},only:function(V){if(!B(V))throw Error("React.Children.only expected to receive a single React element child.");return V}},nt.Component=E,nt.Fragment=e,nt.Profiler=a,nt.PureComponent=C,nt.StrictMode=r,nt.Suspense=h,nt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,nt.act=function(){throw Error("act(...) is not supported in production builds of React.")},nt.cache=function(V){return function(){return V.apply(null,arguments)}},nt.cloneElement=function(V,fe,U){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var Q=y({},V.props),X=V.key,K=void 0;if(fe!=null)for(se in fe.ref!==void 0&&(K=void 0),fe.key!==void 0&&(X=""+fe.key),fe)!I.call(fe,se)||se==="key"||se==="__self"||se==="__source"||se==="ref"&&fe.ref===void 0||(Q[se]=fe[se]);var se=arguments.length-2;if(se===1)Q.children=U;else if(1<se){for(var _e=Array(se),be=0;be<se;be++)_e[be]=arguments[be+2];Q.children=_e}return F(V.type,X,void 0,void 0,K,Q)},nt.createContext=function(V){return V={$$typeof:l,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:s,_context:V},V},nt.createElement=function(V,fe,U){var Q,X={},K=null;if(fe!=null)for(Q in fe.key!==void 0&&(K=""+fe.key),fe)I.call(fe,Q)&&Q!=="key"&&Q!=="__self"&&Q!=="__source"&&(X[Q]=fe[Q]);var se=arguments.length-2;if(se===1)X.children=U;else if(1<se){for(var _e=Array(se),be=0;be<se;be++)_e[be]=arguments[be+2];X.children=_e}if(V&&V.defaultProps)for(Q in se=V.defaultProps,se)X[Q]===void 0&&(X[Q]=se[Q]);return F(V,K,void 0,void 0,null,X)},nt.createRef=function(){return{current:null}},nt.forwardRef=function(V){return{$$typeof:c,render:V}},nt.isValidElement=B,nt.lazy=function(V){return{$$typeof:d,_payload:{_status:-1,_result:V},_init:oe}},nt.memo=function(V,fe){return{$$typeof:f,type:V,compare:fe===void 0?null:fe}},nt.startTransition=function(V){var fe=L.T,U={};L.T=U;try{var Q=V(),X=L.S;X!==null&&X(U,Q),typeof Q=="object"&&Q!==null&&typeof Q.then=="function"&&Q.then(ae,De)}catch(K){De(K)}finally{L.T=fe}},nt.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},nt.use=function(V){return L.H.use(V)},nt.useActionState=function(V,fe,U){return L.H.useActionState(V,fe,U)},nt.useCallback=function(V,fe){return L.H.useCallback(V,fe)},nt.useContext=function(V){return L.H.useContext(V)},nt.useDebugValue=function(){},nt.useDeferredValue=function(V,fe){return L.H.useDeferredValue(V,fe)},nt.useEffect=function(V,fe){return L.H.useEffect(V,fe)},nt.useId=function(){return L.H.useId()},nt.useImperativeHandle=function(V,fe,U){return L.H.useImperativeHandle(V,fe,U)},nt.useInsertionEffect=function(V,fe){return L.H.useInsertionEffect(V,fe)},nt.useLayoutEffect=function(V,fe){return L.H.useLayoutEffect(V,fe)},nt.useMemo=function(V,fe){return L.H.useMemo(V,fe)},nt.useOptimistic=function(V,fe){return L.H.useOptimistic(V,fe)},nt.useReducer=function(V,fe,U){return L.H.useReducer(V,fe,U)},nt.useRef=function(V){return L.H.useRef(V)},nt.useState=function(V){return L.H.useState(V)},nt.useSyncExternalStore=function(V,fe,U){return L.H.useSyncExternalStore(V,fe,U)},nt.useTransition=function(){return L.H.useTransition()},nt.version="19.0.0",nt}var eT;function CA(){return eT||(eT=1,_y.exports=CF()),_y.exports}var we=CA();const RF=kA(we);var yy={exports:{}},o0={},wy={exports:{}},Ay={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tT;function OF(){return tT||(tT=1,function(n){function t(J,oe){var De=J.length;J.push(oe);e:for(;0<De;){var ae=De-1>>>1,V=J[ae];if(0<a(V,oe))J[ae]=oe,J[De]=V,De=ae;else break e}}function e(J){return J.length===0?null:J[0]}function r(J){if(J.length===0)return null;var oe=J[0],De=J.pop();if(De!==oe){J[0]=De;e:for(var ae=0,V=J.length,fe=V>>>1;ae<fe;){var U=2*(ae+1)-1,Q=J[U],X=U+1,K=J[X];if(0>a(Q,De))X<V&&0>a(K,Q)?(J[ae]=K,J[X]=De,ae=X):(J[ae]=Q,J[U]=De,ae=U);else if(X<V&&0>a(K,De))J[ae]=K,J[X]=De,ae=X;else break e}}return oe}function a(J,oe){var De=J.sortIndex-oe.sortIndex;return De!==0?De:J.id-oe.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var l=Date,c=l.now();n.unstable_now=function(){return l.now()-c}}var h=[],f=[],d=1,m=null,x=3,_=!1,y=!1,A=!1,E=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function S(J){for(var oe=e(f);oe!==null;){if(oe.callback===null)r(f);else if(oe.startTime<=J)r(f),oe.sortIndex=oe.expirationTime,t(h,oe);else break;oe=e(f)}}function O(J){if(A=!1,S(J),!y)if(e(h)!==null)y=!0,Ce();else{var oe=e(f);oe!==null&&Ee(O,oe.startTime-J)}}var L=!1,I=-1,F=5,W=-1;function B(){return!(n.unstable_now()-W<F)}function ee(){if(L){var J=n.unstable_now();W=J;var oe=!0;try{e:{y=!1,A&&(A=!1,b(I),I=-1),_=!0;var De=x;try{t:{for(S(J),m=e(h);m!==null&&!(m.expirationTime>J&&B());){var ae=m.callback;if(typeof ae=="function"){m.callback=null,x=m.priorityLevel;var V=ae(m.expirationTime<=J);if(J=n.unstable_now(),typeof V=="function"){m.callback=V,S(J),oe=!0;break t}m===e(h)&&r(h),S(J)}else r(h);m=e(h)}if(m!==null)oe=!0;else{var fe=e(f);fe!==null&&Ee(O,fe.startTime-J),oe=!1}}break e}finally{m=null,x=De,_=!1}oe=void 0}}finally{oe?Z():L=!1}}}var Z;if(typeof C=="function")Z=function(){C(ee)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,ve=te.port2;te.port1.onmessage=ee,Z=function(){ve.postMessage(null)}}else Z=function(){E(ee,0)};function Ce(){L||(L=!0,Z())}function Ee(J,oe){I=E(function(){J(n.unstable_now())},oe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(J){J.callback=null},n.unstable_continueExecution=function(){y||_||(y=!0,Ce())},n.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<J?Math.floor(1e3/J):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_getFirstCallbackNode=function(){return e(h)},n.unstable_next=function(J){switch(x){case 1:case 2:case 3:var oe=3;break;default:oe=x}var De=x;x=oe;try{return J()}finally{x=De}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(J,oe){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var De=x;x=J;try{return oe()}finally{x=De}},n.unstable_scheduleCallback=function(J,oe,De){var ae=n.unstable_now();switch(typeof De=="object"&&De!==null?(De=De.delay,De=typeof De=="number"&&0<De?ae+De:ae):De=ae,J){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=De+V,J={id:d++,callback:oe,priorityLevel:J,startTime:De,expirationTime:V,sortIndex:-1},De>ae?(J.sortIndex=De,t(f,J),e(h)===null&&J===e(f)&&(A?(b(I),I=-1):A=!0,Ee(O,De-ae))):(J.sortIndex=V,t(h,J),y||_||(y=!0,Ce())),J},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(J){var oe=x;return function(){var De=x;x=oe;try{return J.apply(this,arguments)}finally{x=De}}}}(Ay)),Ay}var rT;function DF(){return rT||(rT=1,wy.exports=OF()),wy.exports}var Ey={exports:{}},dn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nT;function FF(){if(nT)return dn;nT=1;var n=CA();function t(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)f+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var r={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},a=Symbol.for("react.portal");function s(h,f,d){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:m==null?null:""+m,children:h,containerInfo:f,implementation:d}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return dn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,dn.createPortal=function(h,f){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return s(h,f,null,d)},dn.flushSync=function(h){var f=l.T,d=r.p;try{if(l.T=null,r.p=2,h)return h()}finally{l.T=f,r.p=d,r.d.f()}},dn.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,r.d.C(h,f))},dn.prefetchDNS=function(h){typeof h=="string"&&r.d.D(h)},dn.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var d=f.as,m=c(d,f.crossOrigin),x=typeof f.integrity=="string"?f.integrity:void 0,_=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;d==="style"?r.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:m,integrity:x,fetchPriority:_}):d==="script"&&r.d.X(h,{crossOrigin:m,integrity:x,fetchPriority:_,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},dn.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var d=c(f.as,f.crossOrigin);r.d.M(h,{crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&r.d.M(h)},dn.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var d=f.as,m=c(d,f.crossOrigin);r.d.L(h,d,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},dn.preloadModule=function(h,f){if(typeof h=="string")if(f){var d=c(f.as,f.crossOrigin);r.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:d,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else r.d.m(h)},dn.requestFormReset=function(h){r.d.r(h)},dn.unstable_batchedUpdates=function(h,f){return h(f)},dn.useFormState=function(h,f,d){return l.H.useFormState(h,f,d)},dn.useFormStatus=function(){return l.H.useHostTransitionStatus()},dn.version="19.0.0",dn}var aT;function MF(){if(aT)return Ey.exports;aT=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),Ey.exports=FF(),Ey.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iT;function LF(){if(iT)return o0;iT=1;var n=DF(),t=CA(),e=MF();function r(i){var o="https://react.dev/errors/"+i;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}var s=Symbol.for("react.element"),l=Symbol.for("react.transitional.element"),c=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),m=Symbol.for("react.provider"),x=Symbol.for("react.consumer"),_=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),S=Symbol.for("react.offscreen"),O=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function I(i){return i===null||typeof i!="object"?null:(i=L&&i[L]||i["@@iterator"],typeof i=="function"?i:null)}var F=Symbol.for("react.client.reference");function W(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===F?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case h:return"Fragment";case c:return"Portal";case d:return"Profiler";case f:return"StrictMode";case A:return"Suspense";case E:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case _:return(i.displayName||"Context")+".Provider";case x:return(i._context.displayName||"Context")+".Consumer";case y:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case b:return o=i.displayName||null,o!==null?o:W(i.type)||"Memo";case C:o=i._payload,i=i._init;try{return W(i(o))}catch{}}return null}var B=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee=Object.assign,Z,te;function ve(i){if(Z===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);Z=o&&o[1]||"",te=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Z+i+te}var Ce=!1;function Ee(i,o){if(!i||Ce)return"";Ce=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(o){var Se=function(){throw Error()};if(Object.defineProperty(Se.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Se,[])}catch(ge){var pe=ge}Reflect.construct(i,[],Se)}else{try{Se.call()}catch(ge){pe=ge}i.call(Se.prototype)}}else{try{throw Error()}catch(ge){pe=ge}(Se=i())&&typeof Se.catch=="function"&&Se.catch(function(){})}}catch(ge){if(ge&&pe&&typeof ge.stack=="string")return[ge.stack,pe.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=p.DetermineComponentFrameRoot(),k=w[0],N=w[1];if(k&&N){var q=k.split(`
`),ne=N.split(`
`);for(v=p=0;p<q.length&&!q[p].includes("DetermineComponentFrameRoot");)p++;for(;v<ne.length&&!ne[v].includes("DetermineComponentFrameRoot");)v++;if(p===q.length||v===ne.length)for(p=q.length-1,v=ne.length-1;1<=p&&0<=v&&q[p]!==ne[v];)v--;for(;1<=p&&0<=v;p--,v--)if(q[p]!==ne[v]){if(p!==1||v!==1)do if(p--,v--,0>v||q[p]!==ne[v]){var xe=`
`+q[p].replace(" at new "," at ");return i.displayName&&xe.includes("<anonymous>")&&(xe=xe.replace("<anonymous>",i.displayName)),xe}while(1<=p&&0<=v);break}}}finally{Ce=!1,Error.prepareStackTrace=u}return(u=i?i.displayName||i.name:"")?ve(u):""}function J(i){switch(i.tag){case 26:case 27:case 5:return ve(i.type);case 16:return ve("Lazy");case 13:return ve("Suspense");case 19:return ve("SuspenseList");case 0:case 15:return i=Ee(i.type,!1),i;case 11:return i=Ee(i.type.render,!1),i;case 1:return i=Ee(i.type,!0),i;default:return""}}function oe(i){try{var o="";do o+=J(i),i=i.return;while(i);return o}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function De(i){var o=i,u=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,o.flags&4098&&(u=o.return),i=o.return;while(i)}return o.tag===3?u:null}function ae(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function V(i){if(De(i)!==i)throw Error(r(188))}function fe(i){var o=i.alternate;if(!o){if(o=De(i),o===null)throw Error(r(188));return o!==i?null:i}for(var u=i,p=o;;){var v=u.return;if(v===null)break;var w=v.alternate;if(w===null){if(p=v.return,p!==null){u=p;continue}break}if(v.child===w.child){for(w=v.child;w;){if(w===u)return V(v),i;if(w===p)return V(v),o;w=w.sibling}throw Error(r(188))}if(u.return!==p.return)u=v,p=w;else{for(var k=!1,N=v.child;N;){if(N===u){k=!0,u=v,p=w;break}if(N===p){k=!0,p=v,u=w;break}N=N.sibling}if(!k){for(N=w.child;N;){if(N===u){k=!0,u=w,p=v;break}if(N===p){k=!0,p=w,u=v;break}N=N.sibling}if(!k)throw Error(r(189))}}if(u.alternate!==p)throw Error(r(190))}if(u.tag!==3)throw Error(r(188));return u.stateNode.current===u?i:o}function U(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i;for(i=i.child;i!==null;){if(o=U(i),o!==null)return o;i=i.sibling}return null}var Q=Array.isArray,X=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K={pending:!1,data:null,method:null,action:null},se=[],_e=-1;function be(i){return{current:i}}function Te(i){0>_e||(i.current=se[_e],se[_e]=null,_e--)}function ye(i,o){_e++,se[_e]=i.current,i.current=o}var Ke=be(null),Y=be(null),Rt=be(null),ft=be(null);function Et(i,o){switch(ye(Rt,o),ye(Y,i),ye(Ke,null),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)&&(o=o.namespaceURI)?SS(o):0;break;default:if(i=i===8?o.parentNode:o,o=i.tagName,i=i.namespaceURI)i=SS(i),o=TS(i,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}Te(Ke),ye(Ke,o)}function Qe(){Te(Ke),Te(Y),Te(Rt)}function Me(i){i.memoizedState!==null&&ye(ft,i);var o=Ke.current,u=TS(o,i.type);o!==u&&(ye(Y,i),ye(Ke,u))}function Bt(i){Y.current===i&&(Te(Ke),Te(Y)),ft.current===i&&(Te(ft),t0._currentValue=K)}var hn=Object.prototype.hasOwnProperty,Yn=n.unstable_scheduleCallback,la=n.unstable_cancelCallback,Yl=n.unstable_shouldYield,Hi=n.unstable_requestPaint,Yt=n.unstable_now,ui=n.unstable_getCurrentPriorityLevel,hi=n.unstable_ImmediatePriority,Ro=n.unstable_UserBlockingPriority,vr=n.unstable_NormalPriority,La=n.unstable_LowPriority,rt=n.unstable_IdlePriority,Jt=n.log,Wn=n.unstable_setDisableYieldValue,$t=null,fr=null;function Jg(i){if(fr&&typeof fr.onCommitFiberRoot=="function")try{fr.onCommitFiberRoot($t,i,void 0,(i.current.flags&128)===128)}catch{}}function zi(i){if(typeof Jt=="function"&&Wn(i),fr&&typeof fr.setStrictMode=="function")try{fr.setStrictMode($t,i)}catch{}}var On=Math.clz32?Math.clz32:rm,em=Math.log,tm=Math.LN2;function rm(i){return i>>>=0,i===0?32:31-(em(i)/tm|0)|0}var Ku=128,Qu=4194304;function Na(i){var o=i&42;if(o!==0)return o;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Zu(i,o){var u=i.pendingLanes;if(u===0)return 0;var p=0,v=i.suspendedLanes,w=i.pingedLanes,k=i.warmLanes;i=i.finishedLanes!==0;var N=u&134217727;return N!==0?(u=N&~v,u!==0?p=Na(u):(w&=N,w!==0?p=Na(w):i||(k=N&~k,k!==0&&(p=Na(k))))):(N=u&~v,N!==0?p=Na(N):w!==0?p=Na(w):i||(k=u&~k,k!==0&&(p=Na(k)))),p===0?0:o!==0&&o!==p&&!(o&v)&&(v=p&-p,k=o&-o,v>=k||v===32&&(k&4194176)!==0)?o:p}function Wl(i,o){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&o)===0}function dv(i,o){switch(i){case 1:case 2:case 4:case 8:return o+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nm(){var i=Ku;return Ku<<=1,!(Ku&4194176)&&(Ku=128),i}function am(){var i=Qu;return Qu<<=1,!(Qu&62914560)&&(Qu=4194304),i}function dd(i){for(var o=[],u=0;31>u;u++)o.push(i);return o}function Kl(i,o){i.pendingLanes|=o,o!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function pv(i,o,u,p,v,w){var k=i.pendingLanes;i.pendingLanes=u,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=u,i.entangledLanes&=u,i.errorRecoveryDisabledLanes&=u,i.shellSuspendCounter=0;var N=i.entanglements,q=i.expirationTimes,ne=i.hiddenUpdates;for(u=k&~u;0<u;){var xe=31-On(u),Se=1<<xe;N[xe]=0,q[xe]=-1;var pe=ne[xe];if(pe!==null)for(ne[xe]=null,xe=0;xe<pe.length;xe++){var ge=pe[xe];ge!==null&&(ge.lane&=-536870913)}u&=~Se}p!==0&&Ju(i,p,0),w!==0&&v===0&&i.tag!==0&&(i.suspendedLanes|=w&~(k&~o))}function Ju(i,o,u){i.pendingLanes|=o,i.suspendedLanes&=~o;var p=31-On(o);i.entangledLanes|=o,i.entanglements[p]=i.entanglements[p]|1073741824|u&4194218}function im(i,o){var u=i.entangledLanes|=o;for(i=i.entanglements;u;){var p=31-On(u),v=1<<p;v&o|i[p]&o&&(i[p]|=o),u&=~v}}function sm(i){return i&=-i,2<i?8<i?i&134217727?32:268435456:8:2}function om(){var i=X.p;return i!==0?i:(i=window.event,i===void 0?32:VS(i.type))}function M(i,o){var u=X.p;try{return X.p=i,o()}finally{X.p=u}}var z=Math.random().toString(36).slice(2),P="__reactFiber$"+z,H="__reactProps$"+z,j="__reactContainer$"+z,G="__reactEvents$"+z,he="__reactListeners$"+z,me="__reactHandles$"+z,ce="__reactResources$"+z,ue="__reactMarker$"+z;function de(i){delete i[P],delete i[H],delete i[G],delete i[he],delete i[me]}function ke(i){var o=i[P];if(o)return o;for(var u=i.parentNode;u;){if(o=u[j]||u[P]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(i=RS(i);i!==null;){if(u=i[P])return u;i=RS(i)}return o}i=u,u=i.parentNode}return null}function Fe(i){if(i=i[P]||i[j]){var o=i.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return i}return null}function Ne(i){var o=i.tag;if(o===5||o===26||o===27||o===6)return i.stateNode;throw Error(r(33))}function Re(i){var o=i[ce];return o||(o=i[ce]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Oe(i){i[ue]=!0}var Ye=new Set,Ut={};function kt(i,o){er(i,o),er(i+"Capture",o)}function er(i,o){for(Ut[i]=o,i=0;i<o.length;i++)Ye.add(o[i])}var Dn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ql=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Oo={},ji={};function pd(i){return hn.call(ji,i)?!0:hn.call(Oo,i)?!1:Ql.test(i)?ji[i]=!0:(Oo[i]=!0,!1)}function Kn(i,o,u){if(pd(o))if(u===null)i.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":i.removeAttribute(o);return;case"boolean":var p=o.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){i.removeAttribute(o);return}}i.setAttribute(o,""+u)}}function lm(i,o,u){if(u===null)i.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(o);return}i.setAttribute(o,""+u)}}function Es(i,o,u,p){if(p===null)i.removeAttribute(u);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(u);return}i.setAttributeNS(o,u,""+p)}}function Pa(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function CE(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function vD(i){var o=CE(i)?"checked":"value",u=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),p=""+i[o];if(!i.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var v=u.get,w=u.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return v.call(this)},set:function(k){p=""+k,w.call(this,k)}}),Object.defineProperty(i,o,{enumerable:u.enumerable}),{getValue:function(){return p},setValue:function(k){p=""+k},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function cm(i){i._valueTracker||(i._valueTracker=vD(i))}function RE(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var u=o.getValue(),p="";return i&&(p=CE(i)?i.checked?"true":"false":i.value),i=p,i!==u?(o.setValue(i),!0):!1}function um(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var _D=/[\n"\\]/g;function Ia(i){return i.replace(_D,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function gv(i,o,u,p,v,w,k,N){i.name="",k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?i.type=k:i.removeAttribute("type"),o!=null?k==="number"?(o===0&&i.value===""||i.value!=o)&&(i.value=""+Pa(o)):i.value!==""+Pa(o)&&(i.value=""+Pa(o)):k!=="submit"&&k!=="reset"||i.removeAttribute("value"),o!=null?mv(i,k,Pa(o)):u!=null?mv(i,k,Pa(u)):p!=null&&i.removeAttribute("value"),v==null&&w!=null&&(i.defaultChecked=!!w),v!=null&&(i.checked=v&&typeof v!="function"&&typeof v!="symbol"),N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?i.name=""+Pa(N):i.removeAttribute("name")}function OE(i,o,u,p,v,w,k,N){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(i.type=w),o!=null||u!=null){if(!(w!=="submit"&&w!=="reset"||o!=null))return;u=u!=null?""+Pa(u):"",o=o!=null?""+Pa(o):u,N||o===i.value||(i.value=o),i.defaultValue=o}p=p??v,p=typeof p!="function"&&typeof p!="symbol"&&!!p,i.checked=N?i.checked:!!p,i.defaultChecked=!!p,k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(i.name=k)}function mv(i,o,u){o==="number"&&um(i.ownerDocument)===i||i.defaultValue===""+u||(i.defaultValue=""+u)}function eh(i,o,u,p){if(i=i.options,o){o={};for(var v=0;v<u.length;v++)o["$"+u[v]]=!0;for(u=0;u<i.length;u++)v=o.hasOwnProperty("$"+i[u].value),i[u].selected!==v&&(i[u].selected=v),v&&p&&(i[u].defaultSelected=!0)}else{for(u=""+Pa(u),o=null,v=0;v<i.length;v++){if(i[v].value===u){i[v].selected=!0,p&&(i[v].defaultSelected=!0);return}o!==null||i[v].disabled||(o=i[v])}o!==null&&(o.selected=!0)}}function DE(i,o,u){if(o!=null&&(o=""+Pa(o),o!==i.value&&(i.value=o),u==null)){i.defaultValue!==o&&(i.defaultValue=o);return}i.defaultValue=u!=null?""+Pa(u):""}function FE(i,o,u,p){if(o==null){if(p!=null){if(u!=null)throw Error(r(92));if(Q(p)){if(1<p.length)throw Error(r(93));p=p[0]}u=p}u==null&&(u=""),o=u}u=Pa(o),i.defaultValue=u,p=i.textContent,p===u&&p!==""&&p!==null&&(i.value=p)}function th(i,o){if(o){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=o;return}}i.textContent=o}var yD=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ME(i,o,u){var p=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?p?i.setProperty(o,""):o==="float"?i.cssFloat="":i[o]="":p?i.setProperty(o,u):typeof u!="number"||u===0||yD.has(o)?o==="float"?i.cssFloat=u:i[o]=(""+u).trim():i[o]=u+"px"}function LE(i,o,u){if(o!=null&&typeof o!="object")throw Error(r(62));if(i=i.style,u!=null){for(var p in u)!u.hasOwnProperty(p)||o!=null&&o.hasOwnProperty(p)||(p.indexOf("--")===0?i.setProperty(p,""):p==="float"?i.cssFloat="":i[p]="");for(var v in o)p=o[v],o.hasOwnProperty(v)&&u[v]!==p&&ME(i,v,p)}else for(var w in o)o.hasOwnProperty(w)&&ME(i,w,o[w])}function xv(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wD=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),AD=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function hm(i){return AD.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var vv=null;function _v(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var rh=null,nh=null;function NE(i){var o=Fe(i);if(o&&(i=o.stateNode)){var u=i[H]||null;e:switch(i=o.stateNode,o.type){case"input":if(gv(i,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Ia(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var p=u[o];if(p!==i&&p.form===i.form){var v=p[H]||null;if(!v)throw Error(r(90));gv(p,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(o=0;o<u.length;o++)p=u[o],p.form===i.form&&RE(p)}break e;case"textarea":DE(i,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&eh(i,!!u.multiple,o,!1)}}}var yv=!1;function PE(i,o,u){if(yv)return i(o,u);yv=!0;try{var p=i(o);return p}finally{if(yv=!1,(rh!==null||nh!==null)&&(Ym(),rh&&(o=rh,i=nh,nh=rh=null,NE(o),i)))for(o=0;o<i.length;o++)NE(i[o])}}function gd(i,o){var u=i.stateNode;if(u===null)return null;var p=u[H]||null;if(p===null)return null;u=p[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(r(231,o,typeof u));return u}var wv=!1;if(Dn)try{var md={};Object.defineProperty(md,"passive",{get:function(){wv=!0}}),window.addEventListener("test",md,md),window.removeEventListener("test",md,md)}catch{wv=!1}var Do=null,Av=null,fm=null;function IE(){if(fm)return fm;var i,o=Av,u=o.length,p,v="value"in Do?Do.value:Do.textContent,w=v.length;for(i=0;i<u&&o[i]===v[i];i++);var k=u-i;for(p=1;p<=k&&o[u-p]===v[w-p];p++);return fm=v.slice(i,1<p?1-p:void 0)}function dm(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function pm(){return!0}function BE(){return!1}function Qn(i){function o(u,p,v,w,k){this._reactName=u,this._targetInst=v,this.type=p,this.nativeEvent=w,this.target=k,this.currentTarget=null;for(var N in i)i.hasOwnProperty(N)&&(u=i[N],this[N]=u?u(w):w[N]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?pm:BE,this.isPropagationStopped=BE,this}return ee(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=pm)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=pm)},persist:function(){},isPersistent:pm}),o}var Zl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gm=Qn(Zl),xd=ee({},Zl,{view:0,detail:0}),ED=Qn(xd),Ev,bv,vd,mm=ee({},xd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tv,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==vd&&(vd&&i.type==="mousemove"?(Ev=i.screenX-vd.screenX,bv=i.screenY-vd.screenY):bv=Ev=0,vd=i),Ev)},movementY:function(i){return"movementY"in i?i.movementY:bv}}),UE=Qn(mm),bD=ee({},mm,{dataTransfer:0}),SD=Qn(bD),TD=ee({},xd,{relatedTarget:0}),Sv=Qn(TD),kD=ee({},Zl,{animationName:0,elapsedTime:0,pseudoElement:0}),CD=Qn(kD),RD=ee({},Zl,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),OD=Qn(RD),DD=ee({},Zl,{data:0}),HE=Qn(DD),FD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},MD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},LD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ND(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=LD[i])?!!o[i]:!1}function Tv(){return ND}var PD=ee({},xd,{key:function(i){if(i.key){var o=FD[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=dm(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?MD[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tv,charCode:function(i){return i.type==="keypress"?dm(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?dm(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),ID=Qn(PD),BD=ee({},mm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zE=Qn(BD),UD=ee({},xd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tv}),HD=Qn(UD),zD=ee({},Zl,{propertyName:0,elapsedTime:0,pseudoElement:0}),jD=Qn(zD),GD=ee({},mm,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),VD=Qn(GD),$D=ee({},Zl,{newState:0,oldState:0}),XD=Qn($D),qD=[9,13,27,32],kv=Dn&&"CompositionEvent"in window,_d=null;Dn&&"documentMode"in document&&(_d=document.documentMode);var YD=Dn&&"TextEvent"in window&&!_d,jE=Dn&&(!kv||_d&&8<_d&&11>=_d),GE=" ",VE=!1;function $E(i,o){switch(i){case"keyup":return qD.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function XE(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ah=!1;function WD(i,o){switch(i){case"compositionend":return XE(o);case"keypress":return o.which!==32?null:(VE=!0,GE);case"textInput":return i=o.data,i===GE&&VE?null:i;default:return null}}function KD(i,o){if(ah)return i==="compositionend"||!kv&&$E(i,o)?(i=IE(),fm=Av=Do=null,ah=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return jE&&o.locale!=="ko"?null:o.data;default:return null}}var QD={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qE(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!QD[i.type]:o==="textarea"}function YE(i,o,u,p){rh?nh?nh.push(p):nh=[p]:rh=p,o=Jm(o,"onChange"),0<o.length&&(u=new gm("onChange","change",null,u,p),i.push({event:u,listeners:o}))}var yd=null,wd=null;function ZD(i){yS(i,0)}function xm(i){var o=Ne(i);if(RE(o))return i}function WE(i,o){if(i==="change")return o}var KE=!1;if(Dn){var Cv;if(Dn){var Rv="oninput"in document;if(!Rv){var QE=document.createElement("div");QE.setAttribute("oninput","return;"),Rv=typeof QE.oninput=="function"}Cv=Rv}else Cv=!1;KE=Cv&&(!document.documentMode||9<document.documentMode)}function ZE(){yd&&(yd.detachEvent("onpropertychange",JE),wd=yd=null)}function JE(i){if(i.propertyName==="value"&&xm(wd)){var o=[];YE(o,wd,i,_v(i)),PE(ZD,o)}}function JD(i,o,u){i==="focusin"?(ZE(),yd=o,wd=u,yd.attachEvent("onpropertychange",JE)):i==="focusout"&&ZE()}function e3(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return xm(wd)}function t3(i,o){if(i==="click")return xm(o)}function r3(i,o){if(i==="input"||i==="change")return xm(o)}function n3(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var ca=typeof Object.is=="function"?Object.is:n3;function Ad(i,o){if(ca(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var u=Object.keys(i),p=Object.keys(o);if(u.length!==p.length)return!1;for(p=0;p<u.length;p++){var v=u[p];if(!hn.call(o,v)||!ca(i[v],o[v]))return!1}return!0}function eb(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function tb(i,o){var u=eb(i);i=0;for(var p;u;){if(u.nodeType===3){if(p=i+u.textContent.length,i<=o&&p>=o)return{node:u,offset:o-i};i=p}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=eb(u)}}function rb(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?rb(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function nb(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var o=um(i.document);o instanceof i.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)i=o.contentWindow;else break;o=um(i.document)}return o}function Ov(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function a3(i,o){var u=nb(o);o=i.focusedElem;var p=i.selectionRange;if(u!==o&&o&&o.ownerDocument&&rb(o.ownerDocument.documentElement,o)){if(p!==null&&Ov(o)){if(i=p.start,u=p.end,u===void 0&&(u=i),"selectionStart"in o)o.selectionStart=i,o.selectionEnd=Math.min(u,o.value.length);else if(u=(i=o.ownerDocument||document)&&i.defaultView||window,u.getSelection){u=u.getSelection();var v=o.textContent.length,w=Math.min(p.start,v);p=p.end===void 0?w:Math.min(p.end,v),!u.extend&&w>p&&(v=p,p=w,w=v),v=tb(o,w);var k=tb(o,p);v&&k&&(u.rangeCount!==1||u.anchorNode!==v.node||u.anchorOffset!==v.offset||u.focusNode!==k.node||u.focusOffset!==k.offset)&&(i=i.createRange(),i.setStart(v.node,v.offset),u.removeAllRanges(),w>p?(u.addRange(i),u.extend(k.node,k.offset)):(i.setEnd(k.node,k.offset),u.addRange(i)))}}for(i=[],u=o;u=u.parentNode;)u.nodeType===1&&i.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<i.length;o++)u=i[o],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var i3=Dn&&"documentMode"in document&&11>=document.documentMode,ih=null,Dv=null,Ed=null,Fv=!1;function ab(i,o,u){var p=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Fv||ih==null||ih!==um(p)||(p=ih,"selectionStart"in p&&Ov(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Ed&&Ad(Ed,p)||(Ed=p,p=Jm(Dv,"onSelect"),0<p.length&&(o=new gm("onSelect","select",null,o,u),i.push({event:o,listeners:p}),o.target=ih)))}function Jl(i,o){var u={};return u[i.toLowerCase()]=o.toLowerCase(),u["Webkit"+i]="webkit"+o,u["Moz"+i]="moz"+o,u}var sh={animationend:Jl("Animation","AnimationEnd"),animationiteration:Jl("Animation","AnimationIteration"),animationstart:Jl("Animation","AnimationStart"),transitionrun:Jl("Transition","TransitionRun"),transitionstart:Jl("Transition","TransitionStart"),transitioncancel:Jl("Transition","TransitionCancel"),transitionend:Jl("Transition","TransitionEnd")},Mv={},ib={};Dn&&(ib=document.createElement("div").style,"AnimationEvent"in window||(delete sh.animationend.animation,delete sh.animationiteration.animation,delete sh.animationstart.animation),"TransitionEvent"in window||delete sh.transitionend.transition);function ec(i){if(Mv[i])return Mv[i];if(!sh[i])return i;var o=sh[i],u;for(u in o)if(o.hasOwnProperty(u)&&u in ib)return Mv[i]=o[u];return i}var sb=ec("animationend"),ob=ec("animationiteration"),lb=ec("animationstart"),s3=ec("transitionrun"),o3=ec("transitionstart"),l3=ec("transitioncancel"),cb=ec("transitionend"),ub=new Map,hb="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function fi(i,o){ub.set(i,o),kt(o,[i])}var Ba=[],oh=0,Lv=0;function vm(){for(var i=oh,o=Lv=oh=0;o<i;){var u=Ba[o];Ba[o++]=null;var p=Ba[o];Ba[o++]=null;var v=Ba[o];Ba[o++]=null;var w=Ba[o];if(Ba[o++]=null,p!==null&&v!==null){var k=p.pending;k===null?v.next=v:(v.next=k.next,k.next=v),p.pending=v}w!==0&&fb(u,v,w)}}function _m(i,o,u,p){Ba[oh++]=i,Ba[oh++]=o,Ba[oh++]=u,Ba[oh++]=p,Lv|=p,i.lanes|=p,i=i.alternate,i!==null&&(i.lanes|=p)}function Nv(i,o,u,p){return _m(i,o,u,p),ym(i)}function Fo(i,o){return _m(i,null,null,o),ym(i)}function fb(i,o,u){i.lanes|=u;var p=i.alternate;p!==null&&(p.lanes|=u);for(var v=!1,w=i.return;w!==null;)w.childLanes|=u,p=w.alternate,p!==null&&(p.childLanes|=u),w.tag===22&&(i=w.stateNode,i===null||i._visibility&1||(v=!0)),i=w,w=w.return;v&&o!==null&&i.tag===3&&(w=i.stateNode,v=31-On(u),w=w.hiddenUpdates,i=w[v],i===null?w[v]=[o]:i.push(o),o.lane=u|536870912)}function ym(i){if(50<Yd)throw Yd=0,z_=null,Error(r(185));for(var o=i.return;o!==null;)i=o,o=i.return;return i.tag===3?i.stateNode:null}var lh={},db=new WeakMap;function Ua(i,o){if(typeof i=="object"&&i!==null){var u=db.get(i);return u!==void 0?u:(o={value:i,source:o,stack:oe(o)},db.set(i,o),o)}return{value:i,source:o,stack:oe(o)}}var ch=[],uh=0,wm=null,Am=0,Ha=[],za=0,tc=null,bs=1,Ss="";function rc(i,o){ch[uh++]=Am,ch[uh++]=wm,wm=i,Am=o}function pb(i,o,u){Ha[za++]=bs,Ha[za++]=Ss,Ha[za++]=tc,tc=i;var p=bs;i=Ss;var v=32-On(p)-1;p&=~(1<<v),u+=1;var w=32-On(o)+v;if(30<w){var k=v-v%5;w=(p&(1<<k)-1).toString(32),p>>=k,v-=k,bs=1<<32-On(o)+v|u<<v|p,Ss=w+i}else bs=1<<w|u<<v|p,Ss=i}function Pv(i){i.return!==null&&(rc(i,1),pb(i,1,0))}function Iv(i){for(;i===wm;)wm=ch[--uh],ch[uh]=null,Am=ch[--uh],ch[uh]=null;for(;i===tc;)tc=Ha[--za],Ha[za]=null,Ss=Ha[--za],Ha[za]=null,bs=Ha[--za],Ha[za]=null}var Fn=null,Qr=null,bt=!1,di=null,Gi=!1,Bv=Error(r(519));function nc(i){var o=Error(r(418,""));throw Td(Ua(o,i)),Bv}function gb(i){var o=i.stateNode,u=i.type,p=i.memoizedProps;switch(o[P]=i,o[H]=p,u){case"dialog":pt("cancel",o),pt("close",o);break;case"iframe":case"object":case"embed":pt("load",o);break;case"video":case"audio":for(u=0;u<Kd.length;u++)pt(Kd[u],o);break;case"source":pt("error",o);break;case"img":case"image":case"link":pt("error",o),pt("load",o);break;case"details":pt("toggle",o);break;case"input":pt("invalid",o),OE(o,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),cm(o);break;case"select":pt("invalid",o);break;case"textarea":pt("invalid",o),FE(o,p.value,p.defaultValue,p.children),cm(o)}u=p.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||p.suppressHydrationWarning===!0||bS(o.textContent,u)?(p.popover!=null&&(pt("beforetoggle",o),pt("toggle",o)),p.onScroll!=null&&pt("scroll",o),p.onScrollEnd!=null&&pt("scrollend",o),p.onClick!=null&&(o.onclick=e1),o=!0):o=!1,o||nc(i)}function mb(i){for(Fn=i.return;Fn;)switch(Fn.tag){case 3:case 27:Gi=!0;return;case 5:case 13:Gi=!1;return;default:Fn=Fn.return}}function bd(i){if(i!==Fn)return!1;if(!bt)return mb(i),bt=!0,!1;var o=!1,u;if((u=i.tag!==3&&i.tag!==27)&&((u=i.tag===5)&&(u=i.type,u=!(u!=="form"&&u!=="button")||ay(i.type,i.memoizedProps)),u=!u),u&&(o=!0),o&&Qr&&nc(i),mb(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8)if(u=i.data,u==="/$"){if(o===0){Qr=gi(i.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++;i=i.nextSibling}Qr=null}}else Qr=Fn?gi(i.stateNode.nextSibling):null;return!0}function Sd(){Qr=Fn=null,bt=!1}function Td(i){di===null?di=[i]:di.push(i)}var kd=Error(r(460)),xb=Error(r(474)),Uv={then:function(){}};function vb(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Em(){}function _b(i,o,u){switch(u=i[u],u===void 0?i.push(o):u!==o&&(o.then(Em,Em),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,i===kd?Error(r(483)):i;default:if(typeof o.status=="string")o.then(Em,Em);else{if(i=Ht,i!==null&&100<i.shellSuspendCounter)throw Error(r(482));i=o,i.status="pending",i.then(function(p){if(o.status==="pending"){var v=o;v.status="fulfilled",v.value=p}},function(p){if(o.status==="pending"){var v=o;v.status="rejected",v.reason=p}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw i=o.reason,i===kd?Error(r(483)):i}throw Cd=o,kd}}var Cd=null;function yb(){if(Cd===null)throw Error(r(459));var i=Cd;return Cd=null,i}var hh=null,Rd=0;function bm(i){var o=Rd;return Rd+=1,hh===null&&(hh=[]),_b(hh,i,o)}function Od(i,o){o=o.props.ref,i.ref=o!==void 0?o:null}function Sm(i,o){throw o.$$typeof===s?Error(r(525)):(i=Object.prototype.toString.call(o),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i)))}function wb(i){var o=i._init;return o(i._payload)}function Ab(i){function o(ie,re){if(i){var le=ie.deletions;le===null?(ie.deletions=[re],ie.flags|=16):le.push(re)}}function u(ie,re){if(!i)return null;for(;re!==null;)o(ie,re),re=re.sibling;return null}function p(ie){for(var re=new Map;ie!==null;)ie.key!==null?re.set(ie.key,ie):re.set(ie.index,ie),ie=ie.sibling;return re}function v(ie,re){return ie=Vo(ie,re),ie.index=0,ie.sibling=null,ie}function w(ie,re,le){return ie.index=le,i?(le=ie.alternate,le!==null?(le=le.index,le<re?(ie.flags|=33554434,re):le):(ie.flags|=33554434,re)):(ie.flags|=1048576,re)}function k(ie){return i&&ie.alternate===null&&(ie.flags|=33554434),ie}function N(ie,re,le,Ae){return re===null||re.tag!==6?(re=M_(le,ie.mode,Ae),re.return=ie,re):(re=v(re,le),re.return=ie,re)}function q(ie,re,le,Ae){var Ue=le.type;return Ue===h?xe(ie,re,le.props.children,Ae,le.key):re!==null&&(re.elementType===Ue||typeof Ue=="object"&&Ue!==null&&Ue.$$typeof===C&&wb(Ue)===re.type)?(re=v(re,le.props),Od(re,le),re.return=ie,re):(re=Gm(le.type,le.key,le.props,null,ie.mode,Ae),Od(re,le),re.return=ie,re)}function ne(ie,re,le,Ae){return re===null||re.tag!==4||re.stateNode.containerInfo!==le.containerInfo||re.stateNode.implementation!==le.implementation?(re=L_(le,ie.mode,Ae),re.return=ie,re):(re=v(re,le.children||[]),re.return=ie,re)}function xe(ie,re,le,Ae,Ue){return re===null||re.tag!==7?(re=dc(le,ie.mode,Ae,Ue),re.return=ie,re):(re=v(re,le),re.return=ie,re)}function Se(ie,re,le){if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return re=M_(""+re,ie.mode,le),re.return=ie,re;if(typeof re=="object"&&re!==null){switch(re.$$typeof){case l:return le=Gm(re.type,re.key,re.props,null,ie.mode,le),Od(le,re),le.return=ie,le;case c:return re=L_(re,ie.mode,le),re.return=ie,re;case C:var Ae=re._init;return re=Ae(re._payload),Se(ie,re,le)}if(Q(re)||I(re))return re=dc(re,ie.mode,le,null),re.return=ie,re;if(typeof re.then=="function")return Se(ie,bm(re),le);if(re.$$typeof===_)return Se(ie,Hm(ie,re),le);Sm(ie,re)}return null}function pe(ie,re,le,Ae){var Ue=re!==null?re.key:null;if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return Ue!==null?null:N(ie,re,""+le,Ae);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case l:return le.key===Ue?q(ie,re,le,Ae):null;case c:return le.key===Ue?ne(ie,re,le,Ae):null;case C:return Ue=le._init,le=Ue(le._payload),pe(ie,re,le,Ae)}if(Q(le)||I(le))return Ue!==null?null:xe(ie,re,le,Ae,null);if(typeof le.then=="function")return pe(ie,re,bm(le),Ae);if(le.$$typeof===_)return pe(ie,re,Hm(ie,le),Ae);Sm(ie,le)}return null}function ge(ie,re,le,Ae,Ue){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint")return ie=ie.get(le)||null,N(re,ie,""+Ae,Ue);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case l:return ie=ie.get(Ae.key===null?le:Ae.key)||null,q(re,ie,Ae,Ue);case c:return ie=ie.get(Ae.key===null?le:Ae.key)||null,ne(re,ie,Ae,Ue);case C:var ct=Ae._init;return Ae=ct(Ae._payload),ge(ie,re,le,Ae,Ue)}if(Q(Ae)||I(Ae))return ie=ie.get(le)||null,xe(re,ie,Ae,Ue,null);if(typeof Ae.then=="function")return ge(ie,re,le,bm(Ae),Ue);if(Ae.$$typeof===_)return ge(ie,re,le,Hm(re,Ae),Ue);Sm(re,Ae)}return null}function He(ie,re,le,Ae){for(var Ue=null,ct=null,Ge=re,Xe=re=0,zr=null;Ge!==null&&Xe<le.length;Xe++){Ge.index>Xe?(zr=Ge,Ge=null):zr=Ge.sibling;var St=pe(ie,Ge,le[Xe],Ae);if(St===null){Ge===null&&(Ge=zr);break}i&&Ge&&St.alternate===null&&o(ie,Ge),re=w(St,re,Xe),ct===null?Ue=St:ct.sibling=St,ct=St,Ge=zr}if(Xe===le.length)return u(ie,Ge),bt&&rc(ie,Xe),Ue;if(Ge===null){for(;Xe<le.length;Xe++)Ge=Se(ie,le[Xe],Ae),Ge!==null&&(re=w(Ge,re,Xe),ct===null?Ue=Ge:ct.sibling=Ge,ct=Ge);return bt&&rc(ie,Xe),Ue}for(Ge=p(Ge);Xe<le.length;Xe++)zr=ge(Ge,ie,Xe,le[Xe],Ae),zr!==null&&(i&&zr.alternate!==null&&Ge.delete(zr.key===null?Xe:zr.key),re=w(zr,re,Xe),ct===null?Ue=zr:ct.sibling=zr,ct=zr);return i&&Ge.forEach(function(Qo){return o(ie,Qo)}),bt&&rc(ie,Xe),Ue}function Ze(ie,re,le,Ae){if(le==null)throw Error(r(151));for(var Ue=null,ct=null,Ge=re,Xe=re=0,zr=null,St=le.next();Ge!==null&&!St.done;Xe++,St=le.next()){Ge.index>Xe?(zr=Ge,Ge=null):zr=Ge.sibling;var Qo=pe(ie,Ge,St.value,Ae);if(Qo===null){Ge===null&&(Ge=zr);break}i&&Ge&&Qo.alternate===null&&o(ie,Ge),re=w(Qo,re,Xe),ct===null?Ue=Qo:ct.sibling=Qo,ct=Qo,Ge=zr}if(St.done)return u(ie,Ge),bt&&rc(ie,Xe),Ue;if(Ge===null){for(;!St.done;Xe++,St=le.next())St=Se(ie,St.value,Ae),St!==null&&(re=w(St,re,Xe),ct===null?Ue=St:ct.sibling=St,ct=St);return bt&&rc(ie,Xe),Ue}for(Ge=p(Ge);!St.done;Xe++,St=le.next())St=ge(Ge,ie,Xe,St.value,Ae),St!==null&&(i&&St.alternate!==null&&Ge.delete(St.key===null?Xe:St.key),re=w(St,re,Xe),ct===null?Ue=St:ct.sibling=St,ct=St);return i&&Ge.forEach(function(AF){return o(ie,AF)}),bt&&rc(ie,Xe),Ue}function lr(ie,re,le,Ae){if(typeof le=="object"&&le!==null&&le.type===h&&le.key===null&&(le=le.props.children),typeof le=="object"&&le!==null){switch(le.$$typeof){case l:e:{for(var Ue=le.key;re!==null;){if(re.key===Ue){if(Ue=le.type,Ue===h){if(re.tag===7){u(ie,re.sibling),Ae=v(re,le.props.children),Ae.return=ie,ie=Ae;break e}}else if(re.elementType===Ue||typeof Ue=="object"&&Ue!==null&&Ue.$$typeof===C&&wb(Ue)===re.type){u(ie,re.sibling),Ae=v(re,le.props),Od(Ae,le),Ae.return=ie,ie=Ae;break e}u(ie,re);break}else o(ie,re);re=re.sibling}le.type===h?(Ae=dc(le.props.children,ie.mode,Ae,le.key),Ae.return=ie,ie=Ae):(Ae=Gm(le.type,le.key,le.props,null,ie.mode,Ae),Od(Ae,le),Ae.return=ie,ie=Ae)}return k(ie);case c:e:{for(Ue=le.key;re!==null;){if(re.key===Ue)if(re.tag===4&&re.stateNode.containerInfo===le.containerInfo&&re.stateNode.implementation===le.implementation){u(ie,re.sibling),Ae=v(re,le.children||[]),Ae.return=ie,ie=Ae;break e}else{u(ie,re);break}else o(ie,re);re=re.sibling}Ae=L_(le,ie.mode,Ae),Ae.return=ie,ie=Ae}return k(ie);case C:return Ue=le._init,le=Ue(le._payload),lr(ie,re,le,Ae)}if(Q(le))return He(ie,re,le,Ae);if(I(le)){if(Ue=I(le),typeof Ue!="function")throw Error(r(150));return le=Ue.call(le),Ze(ie,re,le,Ae)}if(typeof le.then=="function")return lr(ie,re,bm(le),Ae);if(le.$$typeof===_)return lr(ie,re,Hm(ie,le),Ae);Sm(ie,le)}return typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint"?(le=""+le,re!==null&&re.tag===6?(u(ie,re.sibling),Ae=v(re,le),Ae.return=ie,ie=Ae):(u(ie,re),Ae=M_(le,ie.mode,Ae),Ae.return=ie,ie=Ae),k(ie)):u(ie,re)}return function(ie,re,le,Ae){try{Rd=0;var Ue=lr(ie,re,le,Ae);return hh=null,Ue}catch(Ge){if(Ge===kd)throw Ge;var ct=$a(29,Ge,null,ie.mode);return ct.lanes=Ae,ct.return=ie,ct}finally{}}}var ac=Ab(!0),Eb=Ab(!1),fh=be(null),Tm=be(0);function bb(i,o){i=Ps,ye(Tm,i),ye(fh,o),Ps=i|o.baseLanes}function Hv(){ye(Tm,Ps),ye(fh,fh.current)}function zv(){Ps=Tm.current,Te(fh),Te(Tm)}var ja=be(null),Vi=null;function Mo(i){var o=i.alternate;ye(Cr,Cr.current&1),ye(ja,i),Vi===null&&(o===null||fh.current!==null||o.memoizedState!==null)&&(Vi=i)}function Sb(i){if(i.tag===22){if(ye(Cr,Cr.current),ye(ja,i),Vi===null){var o=i.alternate;o!==null&&o.memoizedState!==null&&(Vi=i)}}else Lo()}function Lo(){ye(Cr,Cr.current),ye(ja,ja.current)}function Ts(i){Te(ja),Vi===i&&(Vi=null),Te(Cr)}var Cr=be(0);function km(i){for(var o=i;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var c3=typeof AbortController<"u"?AbortController:function(){var i=[],o=this.signal={aborted:!1,addEventListener:function(u,p){i.push(p)}};this.abort=function(){o.aborted=!0,i.forEach(function(u){return u()})}},u3=n.unstable_scheduleCallback,h3=n.unstable_NormalPriority,Rr={$$typeof:_,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function jv(){return{controller:new c3,data:new Map,refCount:0}}function Dd(i){i.refCount--,i.refCount===0&&u3(h3,function(){i.controller.abort()})}var Fd=null,Gv=0,dh=0,ph=null;function f3(i,o){if(Fd===null){var u=Fd=[];Gv=0,dh=W_(),ph={status:"pending",value:void 0,then:function(p){u.push(p)}}}return Gv++,o.then(Tb,Tb),o}function Tb(){if(--Gv===0&&Fd!==null){ph!==null&&(ph.status="fulfilled");var i=Fd;Fd=null,dh=0,ph=null;for(var o=0;o<i.length;o++)(0,i[o])()}}function d3(i,o){var u=[],p={status:"pending",value:null,reason:null,then:function(v){u.push(v)}};return i.then(function(){p.status="fulfilled",p.value=o;for(var v=0;v<u.length;v++)(0,u[v])(o)},function(v){for(p.status="rejected",p.reason=v,v=0;v<u.length;v++)(0,u[v])(void 0)}),p}var kb=B.S;B.S=function(i,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&f3(i,o),kb!==null&&kb(i,o)};var ic=be(null);function Vv(){var i=ic.current;return i!==null?i:Ht.pooledCache}function Cm(i,o){o===null?ye(ic,ic.current):ye(ic,o.pool)}function Cb(){var i=Vv();return i===null?null:{parent:Rr._currentValue,pool:i}}var No=0,lt=null,Ft=null,_r=null,Rm=!1,gh=!1,sc=!1,Om=0,Md=0,mh=null,p3=0;function dr(){throw Error(r(321))}function $v(i,o){if(o===null)return!1;for(var u=0;u<o.length&&u<i.length;u++)if(!ca(i[u],o[u]))return!1;return!0}function Xv(i,o,u,p,v,w){return No=w,lt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,B.H=i===null||i.memoizedState===null?oc:Po,sc=!1,w=u(p,v),sc=!1,gh&&(w=Ob(o,u,p,v)),Rb(i),w}function Rb(i){B.H=$i;var o=Ft!==null&&Ft.next!==null;if(No=0,_r=Ft=lt=null,Rm=!1,Md=0,mh=null,o)throw Error(r(300));i===null||Ur||(i=i.dependencies,i!==null&&Um(i)&&(Ur=!0))}function Ob(i,o,u,p){lt=i;var v=0;do{if(gh&&(mh=null),Md=0,gh=!1,25<=v)throw Error(r(301));if(v+=1,_r=Ft=null,i.updateQueue!=null){var w=i.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}B.H=lc,w=o(u,p)}while(gh);return w}function g3(){var i=B.H,o=i.useState()[0];return o=typeof o.then=="function"?Ld(o):o,i=i.useState()[0],(Ft!==null?Ft.memoizedState:null)!==i&&(lt.flags|=1024),o}function qv(){var i=Om!==0;return Om=0,i}function Yv(i,o,u){o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~u}function Wv(i){if(Rm){for(i=i.memoizedState;i!==null;){var o=i.queue;o!==null&&(o.pending=null),i=i.next}Rm=!1}No=0,_r=Ft=lt=null,gh=!1,Md=Om=0,mh=null}function Zn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _r===null?lt.memoizedState=_r=i:_r=_r.next=i,_r}function yr(){if(Ft===null){var i=lt.alternate;i=i!==null?i.memoizedState:null}else i=Ft.next;var o=_r===null?lt.memoizedState:_r.next;if(o!==null)_r=o,Ft=i;else{if(i===null)throw lt.alternate===null?Error(r(467)):Error(r(310));Ft=i,i={memoizedState:Ft.memoizedState,baseState:Ft.baseState,baseQueue:Ft.baseQueue,queue:Ft.queue,next:null},_r===null?lt.memoizedState=_r=i:_r=_r.next=i}return _r}var Dm;Dm=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Ld(i){var o=Md;return Md+=1,mh===null&&(mh=[]),i=_b(mh,i,o),o=lt,(_r===null?o.memoizedState:_r.next)===null&&(o=o.alternate,B.H=o===null||o.memoizedState===null?oc:Po),i}function Fm(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Ld(i);if(i.$$typeof===_)return fn(i)}throw Error(r(438,String(i)))}function Kv(i){var o=null,u=lt.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var p=lt.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(o={data:p.data.map(function(v){return v.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=Dm(),lt.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(i),p=0;p<i;p++)u[p]=O;return o.index++,u}function ks(i,o){return typeof o=="function"?o(i):o}function Mm(i){var o=yr();return Qv(o,Ft,i)}function Qv(i,o,u){var p=i.queue;if(p===null)throw Error(r(311));p.lastRenderedReducer=u;var v=i.baseQueue,w=p.pending;if(w!==null){if(v!==null){var k=v.next;v.next=w.next,w.next=k}o.baseQueue=v=w,p.pending=null}if(w=i.baseState,v===null)i.memoizedState=w;else{o=v.next;var N=k=null,q=null,ne=o,xe=!1;do{var Se=ne.lane&-536870913;if(Se!==ne.lane?(vt&Se)===Se:(No&Se)===Se){var pe=ne.revertLane;if(pe===0)q!==null&&(q=q.next={lane:0,revertLane:0,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null}),Se===dh&&(xe=!0);else if((No&pe)===pe){ne=ne.next,pe===dh&&(xe=!0);continue}else Se={lane:0,revertLane:ne.revertLane,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},q===null?(N=q=Se,k=w):q=q.next=Se,lt.lanes|=pe,$o|=pe;Se=ne.action,sc&&u(w,Se),w=ne.hasEagerState?ne.eagerState:u(w,Se)}else pe={lane:Se,revertLane:ne.revertLane,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},q===null?(N=q=pe,k=w):q=q.next=pe,lt.lanes|=Se,$o|=Se;ne=ne.next}while(ne!==null&&ne!==o);if(q===null?k=w:q.next=N,!ca(w,i.memoizedState)&&(Ur=!0,xe&&(u=ph,u!==null)))throw u;i.memoizedState=w,i.baseState=k,i.baseQueue=q,p.lastRenderedState=w}return v===null&&(p.lanes=0),[i.memoizedState,p.dispatch]}function Zv(i){var o=yr(),u=o.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=i;var p=u.dispatch,v=u.pending,w=o.memoizedState;if(v!==null){u.pending=null;var k=v=v.next;do w=i(w,k.action),k=k.next;while(k!==v);ca(w,o.memoizedState)||(Ur=!0),o.memoizedState=w,o.baseQueue===null&&(o.baseState=w),u.lastRenderedState=w}return[w,p]}function Db(i,o,u){var p=lt,v=yr(),w=bt;if(w){if(u===void 0)throw Error(r(407));u=u()}else u=o();var k=!ca((Ft||v).memoizedState,u);if(k&&(v.memoizedState=u,Ur=!0),v=v.queue,t_(Lb.bind(null,p,v,i),[i]),v.getSnapshot!==o||k||_r!==null&&_r.memoizedState.tag&1){if(p.flags|=2048,xh(9,Mb.bind(null,p,v,u,o),{destroy:void 0},null),Ht===null)throw Error(r(349));w||No&60||Fb(p,o,u)}return u}function Fb(i,o,u){i.flags|=16384,i={getSnapshot:o,value:u},o=lt.updateQueue,o===null?(o=Dm(),lt.updateQueue=o,o.stores=[i]):(u=o.stores,u===null?o.stores=[i]:u.push(i))}function Mb(i,o,u,p){o.value=u,o.getSnapshot=p,Nb(o)&&Pb(i)}function Lb(i,o,u){return u(function(){Nb(o)&&Pb(i)})}function Nb(i){var o=i.getSnapshot;i=i.value;try{var u=o();return!ca(i,u)}catch{return!0}}function Pb(i){var o=Fo(i,2);o!==null&&Mn(o,i,2)}function Jv(i){var o=Zn();if(typeof i=="function"){var u=i;if(i=u(),sc){zi(!0);try{u()}finally{zi(!1)}}}return o.memoizedState=o.baseState=i,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ks,lastRenderedState:i},o}function Ib(i,o,u,p){return i.baseState=u,Qv(i,Ft,typeof p=="function"?p:ks)}function m3(i,o,u,p,v){if(Pm(i))throw Error(r(485));if(i=o.action,i!==null){var w={payload:v,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(k){w.listeners.push(k)}};B.T!==null?u(!0):w.isTransition=!1,p(w),u=o.pending,u===null?(w.next=o.pending=w,Bb(o,w)):(w.next=u.next,o.pending=u.next=w)}}function Bb(i,o){var u=o.action,p=o.payload,v=i.state;if(o.isTransition){var w=B.T,k={};B.T=k;try{var N=u(v,p),q=B.S;q!==null&&q(k,N),Ub(i,o,N)}catch(ne){e_(i,o,ne)}finally{B.T=w}}else try{w=u(v,p),Ub(i,o,w)}catch(ne){e_(i,o,ne)}}function Ub(i,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(p){Hb(i,o,p)},function(p){return e_(i,o,p)}):Hb(i,o,u)}function Hb(i,o,u){o.status="fulfilled",o.value=u,zb(o),i.state=u,o=i.pending,o!==null&&(u=o.next,u===o?i.pending=null:(u=u.next,o.next=u,Bb(i,u)))}function e_(i,o,u){var p=i.pending;if(i.pending=null,p!==null){p=p.next;do o.status="rejected",o.reason=u,zb(o),o=o.next;while(o!==p)}i.action=null}function zb(i){i=i.listeners;for(var o=0;o<i.length;o++)(0,i[o])()}function jb(i,o){return o}function Gb(i,o){if(bt){var u=Ht.formState;if(u!==null){e:{var p=lt;if(bt){if(Qr){t:{for(var v=Qr,w=Gi;v.nodeType!==8;){if(!w){v=null;break t}if(v=gi(v.nextSibling),v===null){v=null;break t}}w=v.data,v=w==="F!"||w==="F"?v:null}if(v){Qr=gi(v.nextSibling),p=v.data==="F!";break e}}nc(p)}p=!1}p&&(o=u[0])}}return u=Zn(),u.memoizedState=u.baseState=o,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jb,lastRenderedState:o},u.queue=p,u=o2.bind(null,lt,p),p.dispatch=u,p=Jv(!1),w=s_.bind(null,lt,!1,p.queue),p=Zn(),v={state:o,dispatch:null,action:i,pending:null},p.queue=v,u=m3.bind(null,lt,v,w,u),v.dispatch=u,p.memoizedState=i,[o,u,!1]}function Vb(i){var o=yr();return $b(o,Ft,i)}function $b(i,o,u){o=Qv(i,o,jb)[0],i=Mm(ks)[0],o=typeof o=="object"&&o!==null&&typeof o.then=="function"?Ld(o):o;var p=yr(),v=p.queue,w=v.dispatch;return u!==p.memoizedState&&(lt.flags|=2048,xh(9,x3.bind(null,v,u),{destroy:void 0},null)),[o,w,i]}function x3(i,o){i.action=o}function Xb(i){var o=yr(),u=Ft;if(u!==null)return $b(o,u,i);yr(),o=o.memoizedState,u=yr();var p=u.queue.dispatch;return u.memoizedState=i,[o,p,!1]}function xh(i,o,u,p){return i={tag:i,create:o,inst:u,deps:p,next:null},o=lt.updateQueue,o===null&&(o=Dm(),lt.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=i.next=i:(p=u.next,u.next=i,i.next=p,o.lastEffect=i),i}function qb(){return yr().memoizedState}function Lm(i,o,u,p){var v=Zn();lt.flags|=i,v.memoizedState=xh(1|o,u,{destroy:void 0},p===void 0?null:p)}function Nm(i,o,u,p){var v=yr();p=p===void 0?null:p;var w=v.memoizedState.inst;Ft!==null&&p!==null&&$v(p,Ft.memoizedState.deps)?v.memoizedState=xh(o,u,w,p):(lt.flags|=i,v.memoizedState=xh(1|o,u,w,p))}function Yb(i,o){Lm(8390656,8,i,o)}function t_(i,o){Nm(2048,8,i,o)}function Wb(i,o){return Nm(4,2,i,o)}function Kb(i,o){return Nm(4,4,i,o)}function Qb(i,o){if(typeof o=="function"){i=i();var u=o(i);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function Zb(i,o,u){u=u!=null?u.concat([i]):null,Nm(4,4,Qb.bind(null,o,i),u)}function r_(){}function Jb(i,o){var u=yr();o=o===void 0?null:o;var p=u.memoizedState;return o!==null&&$v(o,p[1])?p[0]:(u.memoizedState=[i,o],i)}function e2(i,o){var u=yr();o=o===void 0?null:o;var p=u.memoizedState;if(o!==null&&$v(o,p[1]))return p[0];if(p=i(),sc){zi(!0);try{i()}finally{zi(!1)}}return u.memoizedState=[p,o],p}function n_(i,o,u){return u===void 0||No&1073741824?i.memoizedState=o:(i.memoizedState=u,i=rS(),lt.lanes|=i,$o|=i,u)}function t2(i,o,u,p){return ca(u,o)?u:fh.current!==null?(i=n_(i,u,p),ca(i,o)||(Ur=!0),i):No&42?(i=rS(),lt.lanes|=i,$o|=i,o):(Ur=!0,i.memoizedState=u)}function r2(i,o,u,p,v){var w=X.p;X.p=w!==0&&8>w?w:8;var k=B.T,N={};B.T=N,s_(i,!1,o,u);try{var q=v(),ne=B.S;if(ne!==null&&ne(N,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var xe=d3(q,p);Nd(i,o,xe,da(i))}else Nd(i,o,p,da(i))}catch(Se){Nd(i,o,{then:function(){},status:"rejected",reason:Se},da())}finally{X.p=w,B.T=k}}function v3(){}function a_(i,o,u,p){if(i.tag!==5)throw Error(r(476));var v=n2(i).queue;r2(i,v,o,K,u===null?v3:function(){return a2(i),u(p)})}function n2(i){var o=i.memoizedState;if(o!==null)return o;o={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ks,lastRenderedState:K},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ks,lastRenderedState:u},next:null},i.memoizedState=o,i=i.alternate,i!==null&&(i.memoizedState=o),o}function a2(i){var o=n2(i).next.queue;Nd(i,o,{},da())}function i_(){return fn(t0)}function i2(){return yr().memoizedState}function s2(){return yr().memoizedState}function _3(i){for(var o=i.return;o!==null;){switch(o.tag){case 24:case 3:var u=da();i=Uo(u);var p=Ho(o,i,u);p!==null&&(Mn(p,o,u),Bd(p,o,u)),o={cache:jv()},i.payload=o;return}o=o.return}}function y3(i,o,u){var p=da();u={lane:p,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},Pm(i)?l2(o,u):(u=Nv(i,o,u,p),u!==null&&(Mn(u,i,p),c2(u,o,p)))}function o2(i,o,u){var p=da();Nd(i,o,u,p)}function Nd(i,o,u,p){var v={lane:p,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(Pm(i))l2(o,v);else{var w=i.alternate;if(i.lanes===0&&(w===null||w.lanes===0)&&(w=o.lastRenderedReducer,w!==null))try{var k=o.lastRenderedState,N=w(k,u);if(v.hasEagerState=!0,v.eagerState=N,ca(N,k))return _m(i,o,v,0),Ht===null&&vm(),!1}catch{}finally{}if(u=Nv(i,o,v,p),u!==null)return Mn(u,i,p),c2(u,o,p),!0}return!1}function s_(i,o,u,p){if(p={lane:2,revertLane:W_(),action:p,hasEagerState:!1,eagerState:null,next:null},Pm(i)){if(o)throw Error(r(479))}else o=Nv(i,u,p,2),o!==null&&Mn(o,i,2)}function Pm(i){var o=i.alternate;return i===lt||o!==null&&o===lt}function l2(i,o){gh=Rm=!0;var u=i.pending;u===null?o.next=o:(o.next=u.next,u.next=o),i.pending=o}function c2(i,o,u){if(u&4194176){var p=o.lanes;p&=i.pendingLanes,u|=p,o.lanes=u,im(i,u)}}var $i={readContext:fn,use:Fm,useCallback:dr,useContext:dr,useEffect:dr,useImperativeHandle:dr,useLayoutEffect:dr,useInsertionEffect:dr,useMemo:dr,useReducer:dr,useRef:dr,useState:dr,useDebugValue:dr,useDeferredValue:dr,useTransition:dr,useSyncExternalStore:dr,useId:dr};$i.useCacheRefresh=dr,$i.useMemoCache=dr,$i.useHostTransitionStatus=dr,$i.useFormState=dr,$i.useActionState=dr,$i.useOptimistic=dr;var oc={readContext:fn,use:Fm,useCallback:function(i,o){return Zn().memoizedState=[i,o===void 0?null:o],i},useContext:fn,useEffect:Yb,useImperativeHandle:function(i,o,u){u=u!=null?u.concat([i]):null,Lm(4194308,4,Qb.bind(null,o,i),u)},useLayoutEffect:function(i,o){return Lm(4194308,4,i,o)},useInsertionEffect:function(i,o){Lm(4,2,i,o)},useMemo:function(i,o){var u=Zn();o=o===void 0?null:o;var p=i();if(sc){zi(!0);try{i()}finally{zi(!1)}}return u.memoizedState=[p,o],p},useReducer:function(i,o,u){var p=Zn();if(u!==void 0){var v=u(o);if(sc){zi(!0);try{u(o)}finally{zi(!1)}}}else v=o;return p.memoizedState=p.baseState=v,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:v},p.queue=i,i=i.dispatch=y3.bind(null,lt,i),[p.memoizedState,i]},useRef:function(i){var o=Zn();return i={current:i},o.memoizedState=i},useState:function(i){i=Jv(i);var o=i.queue,u=o2.bind(null,lt,o);return o.dispatch=u,[i.memoizedState,u]},useDebugValue:r_,useDeferredValue:function(i,o){var u=Zn();return n_(u,i,o)},useTransition:function(){var i=Jv(!1);return i=r2.bind(null,lt,i.queue,!0,!1),Zn().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,o,u){var p=lt,v=Zn();if(bt){if(u===void 0)throw Error(r(407));u=u()}else{if(u=o(),Ht===null)throw Error(r(349));vt&60||Fb(p,o,u)}v.memoizedState=u;var w={value:u,getSnapshot:o};return v.queue=w,Yb(Lb.bind(null,p,w,i),[i]),p.flags|=2048,xh(9,Mb.bind(null,p,w,u,o),{destroy:void 0},null),u},useId:function(){var i=Zn(),o=Ht.identifierPrefix;if(bt){var u=Ss,p=bs;u=(p&~(1<<32-On(p)-1)).toString(32)+u,o=":"+o+"R"+u,u=Om++,0<u&&(o+="H"+u.toString(32)),o+=":"}else u=p3++,o=":"+o+"r"+u.toString(32)+":";return i.memoizedState=o},useCacheRefresh:function(){return Zn().memoizedState=_3.bind(null,lt)}};oc.useMemoCache=Kv,oc.useHostTransitionStatus=i_,oc.useFormState=Gb,oc.useActionState=Gb,oc.useOptimistic=function(i){var o=Zn();o.memoizedState=o.baseState=i;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=s_.bind(null,lt,!0,u),u.dispatch=o,[i,o]};var Po={readContext:fn,use:Fm,useCallback:Jb,useContext:fn,useEffect:t_,useImperativeHandle:Zb,useInsertionEffect:Wb,useLayoutEffect:Kb,useMemo:e2,useReducer:Mm,useRef:qb,useState:function(){return Mm(ks)},useDebugValue:r_,useDeferredValue:function(i,o){var u=yr();return t2(u,Ft.memoizedState,i,o)},useTransition:function(){var i=Mm(ks)[0],o=yr().memoizedState;return[typeof i=="boolean"?i:Ld(i),o]},useSyncExternalStore:Db,useId:i2};Po.useCacheRefresh=s2,Po.useMemoCache=Kv,Po.useHostTransitionStatus=i_,Po.useFormState=Vb,Po.useActionState=Vb,Po.useOptimistic=function(i,o){var u=yr();return Ib(u,Ft,i,o)};var lc={readContext:fn,use:Fm,useCallback:Jb,useContext:fn,useEffect:t_,useImperativeHandle:Zb,useInsertionEffect:Wb,useLayoutEffect:Kb,useMemo:e2,useReducer:Zv,useRef:qb,useState:function(){return Zv(ks)},useDebugValue:r_,useDeferredValue:function(i,o){var u=yr();return Ft===null?n_(u,i,o):t2(u,Ft.memoizedState,i,o)},useTransition:function(){var i=Zv(ks)[0],o=yr().memoizedState;return[typeof i=="boolean"?i:Ld(i),o]},useSyncExternalStore:Db,useId:i2};lc.useCacheRefresh=s2,lc.useMemoCache=Kv,lc.useHostTransitionStatus=i_,lc.useFormState=Xb,lc.useActionState=Xb,lc.useOptimistic=function(i,o){var u=yr();return Ft!==null?Ib(u,Ft,i,o):(u.baseState=i,[i,u.queue.dispatch])};function o_(i,o,u,p){o=i.memoizedState,u=u(p,o),u=u==null?o:ee({},o,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var l_={isMounted:function(i){return(i=i._reactInternals)?De(i)===i:!1},enqueueSetState:function(i,o,u){i=i._reactInternals;var p=da(),v=Uo(p);v.payload=o,u!=null&&(v.callback=u),o=Ho(i,v,p),o!==null&&(Mn(o,i,p),Bd(o,i,p))},enqueueReplaceState:function(i,o,u){i=i._reactInternals;var p=da(),v=Uo(p);v.tag=1,v.payload=o,u!=null&&(v.callback=u),o=Ho(i,v,p),o!==null&&(Mn(o,i,p),Bd(o,i,p))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var u=da(),p=Uo(u);p.tag=2,o!=null&&(p.callback=o),o=Ho(i,p,u),o!==null&&(Mn(o,i,u),Bd(o,i,u))}};function u2(i,o,u,p,v,w,k){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,w,k):o.prototype&&o.prototype.isPureReactComponent?!Ad(u,p)||!Ad(v,w):!0}function h2(i,o,u,p){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,p),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,p),o.state!==i&&l_.enqueueReplaceState(o,o.state,null)}function cc(i,o){var u=o;if("ref"in o){u={};for(var p in o)p!=="ref"&&(u[p]=o[p])}if(i=i.defaultProps){u===o&&(u=ee({},u));for(var v in i)u[v]===void 0&&(u[v]=i[v])}return u}var Im=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function f2(i){Im(i)}function d2(i){console.error(i)}function p2(i){Im(i)}function Bm(i,o){try{var u=i.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(p){setTimeout(function(){throw p})}}function g2(i,o,u){try{var p=i.onCaughtError;p(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function c_(i,o,u){return u=Uo(u),u.tag=3,u.payload={element:null},u.callback=function(){Bm(i,o)},u}function m2(i){return i=Uo(i),i.tag=3,i}function x2(i,o,u,p){var v=u.type.getDerivedStateFromError;if(typeof v=="function"){var w=p.value;i.payload=function(){return v(w)},i.callback=function(){g2(o,u,p)}}var k=u.stateNode;k!==null&&typeof k.componentDidCatch=="function"&&(i.callback=function(){g2(o,u,p),typeof v!="function"&&(Xo===null?Xo=new Set([this]):Xo.add(this));var N=p.stack;this.componentDidCatch(p.value,{componentStack:N!==null?N:""})})}function w3(i,o,u,p,v){if(u.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(o=u.alternate,o!==null&&Id(o,u,v,!0),u=ja.current,u!==null){switch(u.tag){case 13:return Vi===null?V_():u.alternate===null&&or===0&&(or=3),u.flags&=-257,u.flags|=65536,u.lanes=v,p===Uv?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([p]):o.add(p),X_(i,p,v)),!1;case 22:return u.flags|=65536,p===Uv?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([p])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([p]):u.add(p)),X_(i,p,v)),!1}throw Error(r(435,u.tag))}return X_(i,p,v),V_(),!1}if(bt)return o=ja.current,o!==null?(!(o.flags&65536)&&(o.flags|=256),o.flags|=65536,o.lanes=v,p!==Bv&&(i=Error(r(422),{cause:p}),Td(Ua(i,u)))):(p!==Bv&&(o=Error(r(423),{cause:p}),Td(Ua(o,u))),i=i.current.alternate,i.flags|=65536,v&=-v,i.lanes|=v,p=Ua(p,u),v=c_(i.stateNode,p,v),b_(i,v),or!==4&&(or=2)),!1;var w=Error(r(520),{cause:p});if(w=Ua(w,u),Xd===null?Xd=[w]:Xd.push(w),or!==4&&(or=2),o===null)return!0;p=Ua(p,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,i=v&-v,u.lanes|=i,i=c_(u.stateNode,p,i),b_(u,i),!1;case 1:if(o=u.type,w=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Xo===null||!Xo.has(w))))return u.flags|=65536,v&=-v,u.lanes|=v,v=m2(v),x2(v,i,u,p),b_(u,v),!1}u=u.return}while(u!==null);return!1}var v2=Error(r(461)),Ur=!1;function Zr(i,o,u,p){o.child=i===null?Eb(o,null,u,p):ac(o,i.child,u,p)}function _2(i,o,u,p,v){u=u.render;var w=o.ref;if("ref"in p){var k={};for(var N in p)N!=="ref"&&(k[N]=p[N])}else k=p;return hc(o),p=Xv(i,o,u,k,w,v),N=qv(),i!==null&&!Ur?(Yv(i,o,v),Cs(i,o,v)):(bt&&N&&Pv(o),o.flags|=1,Zr(i,o,p,v),o.child)}function y2(i,o,u,p,v){if(i===null){var w=u.type;return typeof w=="function"&&!F_(w)&&w.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=w,w2(i,o,w,p,v)):(i=Gm(u.type,null,p,o,o.mode,v),i.ref=o.ref,i.return=o,o.child=i)}if(w=i.child,!v_(i,v)){var k=w.memoizedProps;if(u=u.compare,u=u!==null?u:Ad,u(k,p)&&i.ref===o.ref)return Cs(i,o,v)}return o.flags|=1,i=Vo(w,p),i.ref=o.ref,i.return=o,o.child=i}function w2(i,o,u,p,v){if(i!==null){var w=i.memoizedProps;if(Ad(w,p)&&i.ref===o.ref)if(Ur=!1,o.pendingProps=p=w,v_(i,v))i.flags&131072&&(Ur=!0);else return o.lanes=i.lanes,Cs(i,o,v)}return u_(i,o,u,p,v)}function A2(i,o,u){var p=o.pendingProps,v=p.children,w=(o.stateNode._pendingVisibility&2)!==0,k=i!==null?i.memoizedState:null;if(Pd(i,o),p.mode==="hidden"||w){if(o.flags&128){if(p=k!==null?k.baseLanes|u:u,i!==null){for(v=o.child=i.child,w=0;v!==null;)w=w|v.lanes|v.childLanes,v=v.sibling;o.childLanes=w&~p}else o.childLanes=0,o.child=null;return E2(i,o,p,u)}if(u&536870912)o.memoizedState={baseLanes:0,cachePool:null},i!==null&&Cm(o,k!==null?k.cachePool:null),k!==null?bb(o,k):Hv(),Sb(o);else return o.lanes=o.childLanes=536870912,E2(i,o,k!==null?k.baseLanes|u:u,u)}else k!==null?(Cm(o,k.cachePool),bb(o,k),Lo(),o.memoizedState=null):(i!==null&&Cm(o,null),Hv(),Lo());return Zr(i,o,v,u),o.child}function E2(i,o,u,p){var v=Vv();return v=v===null?null:{parent:Rr._currentValue,pool:v},o.memoizedState={baseLanes:u,cachePool:v},i!==null&&Cm(o,null),Hv(),Sb(o),i!==null&&Id(i,o,p,!0),null}function Pd(i,o){var u=o.ref;if(u===null)i!==null&&i.ref!==null&&(o.flags|=2097664);else{if(typeof u!="function"&&typeof u!="object")throw Error(r(284));(i===null||i.ref!==u)&&(o.flags|=2097664)}}function u_(i,o,u,p,v){return hc(o),u=Xv(i,o,u,p,void 0,v),p=qv(),i!==null&&!Ur?(Yv(i,o,v),Cs(i,o,v)):(bt&&p&&Pv(o),o.flags|=1,Zr(i,o,u,v),o.child)}function b2(i,o,u,p,v,w){return hc(o),o.updateQueue=null,u=Ob(o,p,u,v),Rb(i),p=qv(),i!==null&&!Ur?(Yv(i,o,w),Cs(i,o,w)):(bt&&p&&Pv(o),o.flags|=1,Zr(i,o,u,w),o.child)}function S2(i,o,u,p,v){if(hc(o),o.stateNode===null){var w=lh,k=u.contextType;typeof k=="object"&&k!==null&&(w=fn(k)),w=new u(p,w),o.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=l_,o.stateNode=w,w._reactInternals=o,w=o.stateNode,w.props=p,w.state=o.memoizedState,w.refs={},A_(o),k=u.contextType,w.context=typeof k=="object"&&k!==null?fn(k):lh,w.state=o.memoizedState,k=u.getDerivedStateFromProps,typeof k=="function"&&(o_(o,u,k,p),w.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(k=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),k!==w.state&&l_.enqueueReplaceState(w,w.state,null),Hd(o,p,w,v),Ud(),w.state=o.memoizedState),typeof w.componentDidMount=="function"&&(o.flags|=4194308),p=!0}else if(i===null){w=o.stateNode;var N=o.memoizedProps,q=cc(u,N);w.props=q;var ne=w.context,xe=u.contextType;k=lh,typeof xe=="object"&&xe!==null&&(k=fn(xe));var Se=u.getDerivedStateFromProps;xe=typeof Se=="function"||typeof w.getSnapshotBeforeUpdate=="function",N=o.pendingProps!==N,xe||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(N||ne!==k)&&h2(o,w,p,k),Bo=!1;var pe=o.memoizedState;w.state=pe,Hd(o,p,w,v),Ud(),ne=o.memoizedState,N||pe!==ne||Bo?(typeof Se=="function"&&(o_(o,u,Se,p),ne=o.memoizedState),(q=Bo||u2(o,u,q,p,pe,ne,k))?(xe||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(o.flags|=4194308)):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=p,o.memoizedState=ne),w.props=p,w.state=ne,w.context=k,p=q):(typeof w.componentDidMount=="function"&&(o.flags|=4194308),p=!1)}else{w=o.stateNode,E_(i,o),k=o.memoizedProps,xe=cc(u,k),w.props=xe,Se=o.pendingProps,pe=w.context,ne=u.contextType,q=lh,typeof ne=="object"&&ne!==null&&(q=fn(ne)),N=u.getDerivedStateFromProps,(ne=typeof N=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(k!==Se||pe!==q)&&h2(o,w,p,q),Bo=!1,pe=o.memoizedState,w.state=pe,Hd(o,p,w,v),Ud();var ge=o.memoizedState;k!==Se||pe!==ge||Bo||i!==null&&i.dependencies!==null&&Um(i.dependencies)?(typeof N=="function"&&(o_(o,u,N,p),ge=o.memoizedState),(xe=Bo||u2(o,u,xe,p,pe,ge,q)||i!==null&&i.dependencies!==null&&Um(i.dependencies))?(ne||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(p,ge,q),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(p,ge,q)),typeof w.componentDidUpdate=="function"&&(o.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof w.componentDidUpdate!="function"||k===i.memoizedProps&&pe===i.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||k===i.memoizedProps&&pe===i.memoizedState||(o.flags|=1024),o.memoizedProps=p,o.memoizedState=ge),w.props=p,w.state=ge,w.context=q,p=xe):(typeof w.componentDidUpdate!="function"||k===i.memoizedProps&&pe===i.memoizedState||(o.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||k===i.memoizedProps&&pe===i.memoizedState||(o.flags|=1024),p=!1)}return w=p,Pd(i,o),p=(o.flags&128)!==0,w||p?(w=o.stateNode,u=p&&typeof u.getDerivedStateFromError!="function"?null:w.render(),o.flags|=1,i!==null&&p?(o.child=ac(o,i.child,null,v),o.child=ac(o,null,u,v)):Zr(i,o,u,v),o.memoizedState=w.state,i=o.child):i=Cs(i,o,v),i}function T2(i,o,u,p){return Sd(),o.flags|=256,Zr(i,o,u,p),o.child}var h_={dehydrated:null,treeContext:null,retryLane:0};function f_(i){return{baseLanes:i,cachePool:Cb()}}function d_(i,o,u){return i=i!==null?i.childLanes&~u:0,o&&(i|=Xa),i}function k2(i,o,u){var p=o.pendingProps,v=!1,w=(o.flags&128)!==0,k;if((k=w)||(k=i!==null&&i.memoizedState===null?!1:(Cr.current&2)!==0),k&&(v=!0,o.flags&=-129),k=(o.flags&32)!==0,o.flags&=-33,i===null){if(bt){if(v?Mo(o):Lo(),bt){var N=Qr,q;if(q=N){e:{for(q=N,N=Gi;q.nodeType!==8;){if(!N){N=null;break e}if(q=gi(q.nextSibling),q===null){N=null;break e}}N=q}N!==null?(o.memoizedState={dehydrated:N,treeContext:tc!==null?{id:bs,overflow:Ss}:null,retryLane:536870912},q=$a(18,null,null,0),q.stateNode=N,q.return=o,o.child=q,Fn=o,Qr=null,q=!0):q=!1}q||nc(o)}if(N=o.memoizedState,N!==null&&(N=N.dehydrated,N!==null))return N.data==="$!"?o.lanes=16:o.lanes=536870912,null;Ts(o)}return N=p.children,p=p.fallback,v?(Lo(),v=o.mode,N=g_({mode:"hidden",children:N},v),p=dc(p,v,u,null),N.return=o,p.return=o,N.sibling=p,o.child=N,v=o.child,v.memoizedState=f_(u),v.childLanes=d_(i,k,u),o.memoizedState=h_,p):(Mo(o),p_(o,N))}if(q=i.memoizedState,q!==null&&(N=q.dehydrated,N!==null)){if(w)o.flags&256?(Mo(o),o.flags&=-257,o=m_(i,o,u)):o.memoizedState!==null?(Lo(),o.child=i.child,o.flags|=128,o=null):(Lo(),v=p.fallback,N=o.mode,p=g_({mode:"visible",children:p.children},N),v=dc(v,N,u,null),v.flags|=2,p.return=o,v.return=o,p.sibling=v,o.child=p,ac(o,i.child,null,u),p=o.child,p.memoizedState=f_(u),p.childLanes=d_(i,k,u),o.memoizedState=h_,o=v);else if(Mo(o),N.data==="$!"){if(k=N.nextSibling&&N.nextSibling.dataset,k)var ne=k.dgst;k=ne,p=Error(r(419)),p.stack="",p.digest=k,Td({value:p,source:null,stack:null}),o=m_(i,o,u)}else if(Ur||Id(i,o,u,!1),k=(u&i.childLanes)!==0,Ur||k){if(k=Ht,k!==null){if(p=u&-u,p&42)p=1;else switch(p){case 2:p=1;break;case 8:p=4;break;case 32:p=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:p=64;break;case 268435456:p=134217728;break;default:p=0}if(p=p&(k.suspendedLanes|u)?0:p,p!==0&&p!==q.retryLane)throw q.retryLane=p,Fo(i,p),Mn(k,i,p),v2}N.data==="$?"||V_(),o=m_(i,o,u)}else N.data==="$?"?(o.flags|=128,o.child=i.child,o=P3.bind(null,i),N._reactRetry=o,o=null):(i=q.treeContext,Qr=gi(N.nextSibling),Fn=o,bt=!0,di=null,Gi=!1,i!==null&&(Ha[za++]=bs,Ha[za++]=Ss,Ha[za++]=tc,bs=i.id,Ss=i.overflow,tc=o),o=p_(o,p.children),o.flags|=4096);return o}return v?(Lo(),v=p.fallback,N=o.mode,q=i.child,ne=q.sibling,p=Vo(q,{mode:"hidden",children:p.children}),p.subtreeFlags=q.subtreeFlags&31457280,ne!==null?v=Vo(ne,v):(v=dc(v,N,u,null),v.flags|=2),v.return=o,p.return=o,p.sibling=v,o.child=p,p=v,v=o.child,N=i.child.memoizedState,N===null?N=f_(u):(q=N.cachePool,q!==null?(ne=Rr._currentValue,q=q.parent!==ne?{parent:ne,pool:ne}:q):q=Cb(),N={baseLanes:N.baseLanes|u,cachePool:q}),v.memoizedState=N,v.childLanes=d_(i,k,u),o.memoizedState=h_,p):(Mo(o),u=i.child,i=u.sibling,u=Vo(u,{mode:"visible",children:p.children}),u.return=o,u.sibling=null,i!==null&&(k=o.deletions,k===null?(o.deletions=[i],o.flags|=16):k.push(i)),o.child=u,o.memoizedState=null,u)}function p_(i,o){return o=g_({mode:"visible",children:o},i.mode),o.return=i,i.child=o}function g_(i,o){return J2(i,o,0,null)}function m_(i,o,u){return ac(o,i.child,null,u),i=p_(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function C2(i,o,u){i.lanes|=o;var p=i.alternate;p!==null&&(p.lanes|=o),y_(i.return,o,u)}function x_(i,o,u,p,v){var w=i.memoizedState;w===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:p,tail:u,tailMode:v}:(w.isBackwards=o,w.rendering=null,w.renderingStartTime=0,w.last=p,w.tail=u,w.tailMode=v)}function R2(i,o,u){var p=o.pendingProps,v=p.revealOrder,w=p.tail;if(Zr(i,o,p.children,u),p=Cr.current,p&2)p=p&1|2,o.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&C2(i,u,o);else if(i.tag===19)C2(i,u,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}p&=1}switch(ye(Cr,p),v){case"forwards":for(u=o.child,v=null;u!==null;)i=u.alternate,i!==null&&km(i)===null&&(v=u),u=u.sibling;u=v,u===null?(v=o.child,o.child=null):(v=u.sibling,u.sibling=null),x_(o,!1,v,u,w);break;case"backwards":for(u=null,v=o.child,o.child=null;v!==null;){if(i=v.alternate,i!==null&&km(i)===null){o.child=v;break}i=v.sibling,v.sibling=u,u=v,v=i}x_(o,!0,u,null,w);break;case"together":x_(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Cs(i,o,u){if(i!==null&&(o.dependencies=i.dependencies),$o|=o.lanes,!(u&o.childLanes))if(i!==null){if(Id(i,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(i!==null&&o.child!==i.child)throw Error(r(153));if(o.child!==null){for(i=o.child,u=Vo(i,i.pendingProps),o.child=u,u.return=o;i.sibling!==null;)i=i.sibling,u=u.sibling=Vo(i,i.pendingProps),u.return=o;u.sibling=null}return o.child}function v_(i,o){return i.lanes&o?!0:(i=i.dependencies,!!(i!==null&&Um(i)))}function A3(i,o,u){switch(o.tag){case 3:Et(o,o.stateNode.containerInfo),Io(o,Rr,i.memoizedState.cache),Sd();break;case 27:case 5:Me(o);break;case 4:Et(o,o.stateNode.containerInfo);break;case 10:Io(o,o.type,o.memoizedProps.value);break;case 13:var p=o.memoizedState;if(p!==null)return p.dehydrated!==null?(Mo(o),o.flags|=128,null):u&o.child.childLanes?k2(i,o,u):(Mo(o),i=Cs(i,o,u),i!==null?i.sibling:null);Mo(o);break;case 19:var v=(i.flags&128)!==0;if(p=(u&o.childLanes)!==0,p||(Id(i,o,u,!1),p=(u&o.childLanes)!==0),v){if(p)return R2(i,o,u);o.flags|=128}if(v=o.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),ye(Cr,Cr.current),p)break;return null;case 22:case 23:return o.lanes=0,A2(i,o,u);case 24:Io(o,Rr,i.memoizedState.cache)}return Cs(i,o,u)}function O2(i,o,u){if(i!==null)if(i.memoizedProps!==o.pendingProps)Ur=!0;else{if(!v_(i,u)&&!(o.flags&128))return Ur=!1,A3(i,o,u);Ur=!!(i.flags&131072)}else Ur=!1,bt&&o.flags&1048576&&pb(o,Am,o.index);switch(o.lanes=0,o.tag){case 16:e:{i=o.pendingProps;var p=o.elementType,v=p._init;if(p=v(p._payload),o.type=p,typeof p=="function")F_(p)?(i=cc(p,i),o.tag=1,o=S2(null,o,p,i,u)):(o.tag=0,o=u_(null,o,p,i,u));else{if(p!=null){if(v=p.$$typeof,v===y){o.tag=11,o=_2(null,o,p,i,u);break e}else if(v===b){o.tag=14,o=y2(null,o,p,i,u);break e}}throw o=W(p)||p,Error(r(306,o,""))}}return o;case 0:return u_(i,o,o.type,o.pendingProps,u);case 1:return p=o.type,v=cc(p,o.pendingProps),S2(i,o,p,v,u);case 3:e:{if(Et(o,o.stateNode.containerInfo),i===null)throw Error(r(387));var w=o.pendingProps;v=o.memoizedState,p=v.element,E_(i,o),Hd(o,w,null,u);var k=o.memoizedState;if(w=k.cache,Io(o,Rr,w),w!==v.cache&&w_(o,[Rr],u,!0),Ud(),w=k.element,v.isDehydrated)if(v={element:w,isDehydrated:!1,cache:k.cache},o.updateQueue.baseState=v,o.memoizedState=v,o.flags&256){o=T2(i,o,w,u);break e}else if(w!==p){p=Ua(Error(r(424)),o),Td(p),o=T2(i,o,w,u);break e}else for(Qr=gi(o.stateNode.containerInfo.firstChild),Fn=o,bt=!0,di=null,Gi=!0,u=Eb(o,null,w,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(Sd(),w===p){o=Cs(i,o,u);break e}Zr(i,o,w,u)}o=o.child}return o;case 26:return Pd(i,o),i===null?(u=MS(o.type,null,o.pendingProps,null))?o.memoizedState=u:bt||(u=o.type,i=o.pendingProps,p=t1(Rt.current).createElement(u),p[P]=o,p[H]=i,Jr(p,u,i),Oe(p),o.stateNode=p):o.memoizedState=MS(o.type,i.memoizedProps,o.pendingProps,i.memoizedState),null;case 27:return Me(o),i===null&&bt&&(p=o.stateNode=OS(o.type,o.pendingProps,Rt.current),Fn=o,Gi=!0,Qr=gi(p.firstChild)),p=o.pendingProps.children,i!==null||bt?Zr(i,o,p,u):o.child=ac(o,null,p,u),Pd(i,o),o.child;case 5:return i===null&&bt&&((v=p=Qr)&&(p=Z3(p,o.type,o.pendingProps,Gi),p!==null?(o.stateNode=p,Fn=o,Qr=gi(p.firstChild),Gi=!1,v=!0):v=!1),v||nc(o)),Me(o),v=o.type,w=o.pendingProps,k=i!==null?i.memoizedProps:null,p=w.children,ay(v,w)?p=null:k!==null&&ay(v,k)&&(o.flags|=32),o.memoizedState!==null&&(v=Xv(i,o,g3,null,null,u),t0._currentValue=v),Pd(i,o),Zr(i,o,p,u),o.child;case 6:return i===null&&bt&&((i=u=Qr)&&(u=J3(u,o.pendingProps,Gi),u!==null?(o.stateNode=u,Fn=o,Qr=null,i=!0):i=!1),i||nc(o)),null;case 13:return k2(i,o,u);case 4:return Et(o,o.stateNode.containerInfo),p=o.pendingProps,i===null?o.child=ac(o,null,p,u):Zr(i,o,p,u),o.child;case 11:return _2(i,o,o.type,o.pendingProps,u);case 7:return Zr(i,o,o.pendingProps,u),o.child;case 8:return Zr(i,o,o.pendingProps.children,u),o.child;case 12:return Zr(i,o,o.pendingProps.children,u),o.child;case 10:return p=o.pendingProps,Io(o,o.type,p.value),Zr(i,o,p.children,u),o.child;case 9:return v=o.type._context,p=o.pendingProps.children,hc(o),v=fn(v),p=p(v),o.flags|=1,Zr(i,o,p,u),o.child;case 14:return y2(i,o,o.type,o.pendingProps,u);case 15:return w2(i,o,o.type,o.pendingProps,u);case 19:return R2(i,o,u);case 22:return A2(i,o,u);case 24:return hc(o),p=fn(Rr),i===null?(v=Vv(),v===null&&(v=Ht,w=jv(),v.pooledCache=w,w.refCount++,w!==null&&(v.pooledCacheLanes|=u),v=w),o.memoizedState={parent:p,cache:v},A_(o),Io(o,Rr,v)):(i.lanes&u&&(E_(i,o),Hd(o,null,null,u),Ud()),v=i.memoizedState,w=o.memoizedState,v.parent!==p?(v={parent:p,cache:p},o.memoizedState=v,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=v),Io(o,Rr,p)):(p=w.cache,Io(o,Rr,p),p!==v.cache&&w_(o,[Rr],u,!0))),Zr(i,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(r(156,o.tag))}var __=be(null),uc=null,Rs=null;function Io(i,o,u){ye(__,o._currentValue),o._currentValue=u}function Os(i){i._currentValue=__.current,Te(__)}function y_(i,o,u){for(;i!==null;){var p=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,p!==null&&(p.childLanes|=o)):p!==null&&(p.childLanes&o)!==o&&(p.childLanes|=o),i===u)break;i=i.return}}function w_(i,o,u,p){var v=i.child;for(v!==null&&(v.return=i);v!==null;){var w=v.dependencies;if(w!==null){var k=v.child;w=w.firstContext;e:for(;w!==null;){var N=w;w=v;for(var q=0;q<o.length;q++)if(N.context===o[q]){w.lanes|=u,N=w.alternate,N!==null&&(N.lanes|=u),y_(w.return,u,i),p||(k=null);break e}w=N.next}}else if(v.tag===18){if(k=v.return,k===null)throw Error(r(341));k.lanes|=u,w=k.alternate,w!==null&&(w.lanes|=u),y_(k,u,i),k=null}else k=v.child;if(k!==null)k.return=v;else for(k=v;k!==null;){if(k===i){k=null;break}if(v=k.sibling,v!==null){v.return=k.return,k=v;break}k=k.return}v=k}}function Id(i,o,u,p){i=null;for(var v=o,w=!1;v!==null;){if(!w){if(v.flags&524288)w=!0;else if(v.flags&262144)break}if(v.tag===10){var k=v.alternate;if(k===null)throw Error(r(387));if(k=k.memoizedProps,k!==null){var N=v.type;ca(v.pendingProps.value,k.value)||(i!==null?i.push(N):i=[N])}}else if(v===ft.current){if(k=v.alternate,k===null)throw Error(r(387));k.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(i!==null?i.push(t0):i=[t0])}v=v.return}i!==null&&w_(o,i,u,p),o.flags|=262144}function Um(i){for(i=i.firstContext;i!==null;){if(!ca(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function hc(i){uc=i,Rs=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function fn(i){return D2(uc,i)}function Hm(i,o){return uc===null&&hc(i),D2(i,o)}function D2(i,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},Rs===null){if(i===null)throw Error(r(308));Rs=o,i.dependencies={lanes:0,firstContext:o},i.flags|=524288}else Rs=Rs.next=o;return u}var Bo=!1;function A_(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function E_(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Uo(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Ho(i,o,u){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,rr&2){var v=p.pending;return v===null?o.next=o:(o.next=v.next,v.next=o),p.pending=o,o=ym(i),fb(i,null,u),o}return _m(i,p,o,u),ym(i)}function Bd(i,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194176)!==0)){var p=o.lanes;p&=i.pendingLanes,u|=p,o.lanes=u,im(i,u)}}function b_(i,o){var u=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,u===p)){var v=null,w=null;if(u=u.firstBaseUpdate,u!==null){do{var k={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};w===null?v=w=k:w=w.next=k,u=u.next}while(u!==null);w===null?v=w=o:w=w.next=o}else v=w=o;u={baseState:p.baseState,firstBaseUpdate:v,lastBaseUpdate:w,shared:p.shared,callbacks:p.callbacks},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=o:i.next=o,u.lastBaseUpdate=o}var S_=!1;function Ud(){if(S_){var i=ph;if(i!==null)throw i}}function Hd(i,o,u,p){S_=!1;var v=i.updateQueue;Bo=!1;var w=v.firstBaseUpdate,k=v.lastBaseUpdate,N=v.shared.pending;if(N!==null){v.shared.pending=null;var q=N,ne=q.next;q.next=null,k===null?w=ne:k.next=ne,k=q;var xe=i.alternate;xe!==null&&(xe=xe.updateQueue,N=xe.lastBaseUpdate,N!==k&&(N===null?xe.firstBaseUpdate=ne:N.next=ne,xe.lastBaseUpdate=q))}if(w!==null){var Se=v.baseState;k=0,xe=ne=q=null,N=w;do{var pe=N.lane&-536870913,ge=pe!==N.lane;if(ge?(vt&pe)===pe:(p&pe)===pe){pe!==0&&pe===dh&&(S_=!0),xe!==null&&(xe=xe.next={lane:0,tag:N.tag,payload:N.payload,callback:null,next:null});e:{var He=i,Ze=N;pe=o;var lr=u;switch(Ze.tag){case 1:if(He=Ze.payload,typeof He=="function"){Se=He.call(lr,Se,pe);break e}Se=He;break e;case 3:He.flags=He.flags&-65537|128;case 0:if(He=Ze.payload,pe=typeof He=="function"?He.call(lr,Se,pe):He,pe==null)break e;Se=ee({},Se,pe);break e;case 2:Bo=!0}}pe=N.callback,pe!==null&&(i.flags|=64,ge&&(i.flags|=8192),ge=v.callbacks,ge===null?v.callbacks=[pe]:ge.push(pe))}else ge={lane:pe,tag:N.tag,payload:N.payload,callback:N.callback,next:null},xe===null?(ne=xe=ge,q=Se):xe=xe.next=ge,k|=pe;if(N=N.next,N===null){if(N=v.shared.pending,N===null)break;ge=N,N=ge.next,ge.next=null,v.lastBaseUpdate=ge,v.shared.pending=null}}while(!0);xe===null&&(q=Se),v.baseState=q,v.firstBaseUpdate=ne,v.lastBaseUpdate=xe,w===null&&(v.shared.lanes=0),$o|=k,i.lanes=k,i.memoizedState=Se}}function F2(i,o){if(typeof i!="function")throw Error(r(191,i));i.call(o)}function M2(i,o){var u=i.callbacks;if(u!==null)for(i.callbacks=null,i=0;i<u.length;i++)F2(u[i],o)}function zd(i,o){try{var u=o.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var v=p.next;u=v;do{if((u.tag&i)===i){p=void 0;var w=u.create,k=u.inst;p=w(),k.destroy=p}u=u.next}while(u!==v)}}catch(N){Pt(o,o.return,N)}}function zo(i,o,u){try{var p=o.updateQueue,v=p!==null?p.lastEffect:null;if(v!==null){var w=v.next;p=w;do{if((p.tag&i)===i){var k=p.inst,N=k.destroy;if(N!==void 0){k.destroy=void 0,v=o;var q=u;try{N()}catch(ne){Pt(v,q,ne)}}}p=p.next}while(p!==w)}}catch(ne){Pt(o,o.return,ne)}}function L2(i){var o=i.updateQueue;if(o!==null){var u=i.stateNode;try{M2(o,u)}catch(p){Pt(i,i.return,p)}}}function N2(i,o,u){u.props=cc(i.type,i.memoizedProps),u.state=i.memoizedState;try{u.componentWillUnmount()}catch(p){Pt(i,o,p)}}function fc(i,o){try{var u=i.ref;if(u!==null){var p=i.stateNode;switch(i.tag){case 26:case 27:case 5:var v=p;break;default:v=p}typeof u=="function"?i.refCleanup=u(v):u.current=v}}catch(w){Pt(i,o,w)}}function ua(i,o){var u=i.ref,p=i.refCleanup;if(u!==null)if(typeof p=="function")try{p()}catch(v){Pt(i,o,v)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(v){Pt(i,o,v)}else u.current=null}function P2(i){var o=i.type,u=i.memoizedProps,p=i.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&p.focus();break e;case"img":u.src?p.src=u.src:u.srcSet&&(p.srcset=u.srcSet)}}catch(v){Pt(i,i.return,v)}}function I2(i,o,u){try{var p=i.stateNode;q3(p,i.type,u,o),p[H]=o}catch(v){Pt(i,i.return,v)}}function B2(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27||i.tag===4}function T_(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||B2(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==27&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function k_(i,o,u){var p=i.tag;if(p===5||p===6)i=i.stateNode,o?u.nodeType===8?u.parentNode.insertBefore(i,o):u.insertBefore(i,o):(u.nodeType===8?(o=u.parentNode,o.insertBefore(i,u)):(o=u,o.appendChild(i)),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=e1));else if(p!==4&&p!==27&&(i=i.child,i!==null))for(k_(i,o,u),i=i.sibling;i!==null;)k_(i,o,u),i=i.sibling}function zm(i,o,u){var p=i.tag;if(p===5||p===6)i=i.stateNode,o?u.insertBefore(i,o):u.appendChild(i);else if(p!==4&&p!==27&&(i=i.child,i!==null))for(zm(i,o,u),i=i.sibling;i!==null;)zm(i,o,u),i=i.sibling}var Ds=!1,sr=!1,C_=!1,U2=typeof WeakSet=="function"?WeakSet:Set,Hr=null,H2=!1;function E3(i,o){if(i=i.containerInfo,ry=o1,i=nb(i),Ov(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var p=u.getSelection&&u.getSelection();if(p&&p.rangeCount!==0){u=p.anchorNode;var v=p.anchorOffset,w=p.focusNode;p=p.focusOffset;try{u.nodeType,w.nodeType}catch{u=null;break e}var k=0,N=-1,q=-1,ne=0,xe=0,Se=i,pe=null;t:for(;;){for(var ge;Se!==u||v!==0&&Se.nodeType!==3||(N=k+v),Se!==w||p!==0&&Se.nodeType!==3||(q=k+p),Se.nodeType===3&&(k+=Se.nodeValue.length),(ge=Se.firstChild)!==null;)pe=Se,Se=ge;for(;;){if(Se===i)break t;if(pe===u&&++ne===v&&(N=k),pe===w&&++xe===p&&(q=k),(ge=Se.nextSibling)!==null)break;Se=pe,pe=Se.parentNode}Se=ge}u=N===-1||q===-1?null:{start:N,end:q}}else u=null}u=u||{start:0,end:0}}else u=null;for(ny={focusedElem:i,selectionRange:u},o1=!1,Hr=o;Hr!==null;)if(o=Hr,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,Hr=i;else for(;Hr!==null;){switch(o=Hr,w=o.alternate,i=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if(i&1024&&w!==null){i=void 0,u=o,v=w.memoizedProps,w=w.memoizedState,p=u.stateNode;try{var He=cc(u.type,v,u.elementType===u.type);i=p.getSnapshotBeforeUpdate(He,w),p.__reactInternalSnapshotBeforeUpdate=i}catch(Ze){Pt(u,u.return,Ze)}}break;case 3:if(i&1024){if(i=o.stateNode.containerInfo,u=i.nodeType,u===9)oy(i);else if(u===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":oy(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(i&1024)throw Error(r(163))}if(i=o.sibling,i!==null){i.return=o.return,Hr=i;break}Hr=o.return}return He=H2,H2=!1,He}function z2(i,o,u){var p=u.flags;switch(u.tag){case 0:case 11:case 15:Ms(i,u),p&4&&zd(5,u);break;case 1:if(Ms(i,u),p&4)if(i=u.stateNode,o===null)try{i.componentDidMount()}catch(N){Pt(u,u.return,N)}else{var v=cc(u.type,o.memoizedProps);o=o.memoizedState;try{i.componentDidUpdate(v,o,i.__reactInternalSnapshotBeforeUpdate)}catch(N){Pt(u,u.return,N)}}p&64&&L2(u),p&512&&fc(u,u.return);break;case 3:if(Ms(i,u),p&64&&(p=u.updateQueue,p!==null)){if(i=null,u.child!==null)switch(u.child.tag){case 27:case 5:i=u.child.stateNode;break;case 1:i=u.child.stateNode}try{M2(p,i)}catch(N){Pt(u,u.return,N)}}break;case 26:Ms(i,u),p&512&&fc(u,u.return);break;case 27:case 5:Ms(i,u),o===null&&p&4&&P2(u),p&512&&fc(u,u.return);break;case 12:Ms(i,u);break;case 13:Ms(i,u),p&4&&V2(i,u);break;case 22:if(v=u.memoizedState!==null||Ds,!v){o=o!==null&&o.memoizedState!==null||sr;var w=Ds,k=sr;Ds=v,(sr=o)&&!k?jo(i,u,(u.subtreeFlags&8772)!==0):Ms(i,u),Ds=w,sr=k}p&512&&(u.memoizedProps.mode==="manual"?fc(u,u.return):ua(u,u.return));break;default:Ms(i,u)}}function j2(i){var o=i.alternate;o!==null&&(i.alternate=null,j2(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&de(o)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var wr=null,ha=!1;function Fs(i,o,u){for(u=u.child;u!==null;)G2(i,o,u),u=u.sibling}function G2(i,o,u){if(fr&&typeof fr.onCommitFiberUnmount=="function")try{fr.onCommitFiberUnmount($t,u)}catch{}switch(u.tag){case 26:sr||ua(u,o),Fs(i,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:sr||ua(u,o);var p=wr,v=ha;for(wr=u.stateNode,Fs(i,o,u),u=u.stateNode,o=u.attributes;o.length;)u.removeAttributeNode(o[0]);de(u),wr=p,ha=v;break;case 5:sr||ua(u,o);case 6:v=wr;var w=ha;if(wr=null,Fs(i,o,u),wr=v,ha=w,wr!==null)if(ha)try{i=wr,p=u.stateNode,i.nodeType===8?i.parentNode.removeChild(p):i.removeChild(p)}catch(k){Pt(u,o,k)}else try{wr.removeChild(u.stateNode)}catch(k){Pt(u,o,k)}break;case 18:wr!==null&&(ha?(o=wr,u=u.stateNode,o.nodeType===8?sy(o.parentNode,u):o.nodeType===1&&sy(o,u),i0(o)):sy(wr,u.stateNode));break;case 4:p=wr,v=ha,wr=u.stateNode.containerInfo,ha=!0,Fs(i,o,u),wr=p,ha=v;break;case 0:case 11:case 14:case 15:sr||zo(2,u,o),sr||zo(4,u,o),Fs(i,o,u);break;case 1:sr||(ua(u,o),p=u.stateNode,typeof p.componentWillUnmount=="function"&&N2(u,o,p)),Fs(i,o,u);break;case 21:Fs(i,o,u);break;case 22:sr||ua(u,o),sr=(p=sr)||u.memoizedState!==null,Fs(i,o,u),sr=p;break;default:Fs(i,o,u)}}function V2(i,o){if(o.memoizedState===null&&(i=o.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{i0(i)}catch(u){Pt(o,o.return,u)}}function b3(i){switch(i.tag){case 13:case 19:var o=i.stateNode;return o===null&&(o=i.stateNode=new U2),o;case 22:return i=i.stateNode,o=i._retryCache,o===null&&(o=i._retryCache=new U2),o;default:throw Error(r(435,i.tag))}}function R_(i,o){var u=b3(i);o.forEach(function(p){var v=I3.bind(null,i,p);u.has(p)||(u.add(p),p.then(v,v))})}function Ga(i,o){var u=o.deletions;if(u!==null)for(var p=0;p<u.length;p++){var v=u[p],w=i,k=o,N=k;e:for(;N!==null;){switch(N.tag){case 27:case 5:wr=N.stateNode,ha=!1;break e;case 3:wr=N.stateNode.containerInfo,ha=!0;break e;case 4:wr=N.stateNode.containerInfo,ha=!0;break e}N=N.return}if(wr===null)throw Error(r(160));G2(w,k,v),wr=null,ha=!1,w=v.alternate,w!==null&&(w.return=null),v.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)$2(o,i),o=o.sibling}var pi=null;function $2(i,o){var u=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Ga(o,i),Va(i),p&4&&(zo(3,i,i.return),zd(3,i),zo(5,i,i.return));break;case 1:Ga(o,i),Va(i),p&512&&(sr||u===null||ua(u,u.return)),p&64&&Ds&&(i=i.updateQueue,i!==null&&(p=i.callbacks,p!==null&&(u=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=u===null?p:u.concat(p))));break;case 26:var v=pi;if(Ga(o,i),Va(i),p&512&&(sr||u===null||ua(u,u.return)),p&4){var w=u!==null?u.memoizedState:null;if(p=i.memoizedState,u===null)if(p===null)if(i.stateNode===null){e:{p=i.type,u=i.memoizedProps,v=v.ownerDocument||v;t:switch(p){case"title":w=v.getElementsByTagName("title")[0],(!w||w[ue]||w[P]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=v.createElement(p),v.head.insertBefore(w,v.querySelector("head > title"))),Jr(w,p,u),w[P]=i,Oe(w),p=w;break e;case"link":var k=PS("link","href",v).get(p+(u.href||""));if(k){for(var N=0;N<k.length;N++)if(w=k[N],w.getAttribute("href")===(u.href==null?null:u.href)&&w.getAttribute("rel")===(u.rel==null?null:u.rel)&&w.getAttribute("title")===(u.title==null?null:u.title)&&w.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){k.splice(N,1);break t}}w=v.createElement(p),Jr(w,p,u),v.head.appendChild(w);break;case"meta":if(k=PS("meta","content",v).get(p+(u.content||""))){for(N=0;N<k.length;N++)if(w=k[N],w.getAttribute("content")===(u.content==null?null:""+u.content)&&w.getAttribute("name")===(u.name==null?null:u.name)&&w.getAttribute("property")===(u.property==null?null:u.property)&&w.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&w.getAttribute("charset")===(u.charSet==null?null:u.charSet)){k.splice(N,1);break t}}w=v.createElement(p),Jr(w,p,u),v.head.appendChild(w);break;default:throw Error(r(468,p))}w[P]=i,Oe(w),p=w}i.stateNode=p}else IS(v,i.type,i.stateNode);else i.stateNode=NS(v,p,i.memoizedProps);else w!==p?(w===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):w.count--,p===null?IS(v,i.type,i.stateNode):NS(v,p,i.memoizedProps)):p===null&&i.stateNode!==null&&I2(i,i.memoizedProps,u.memoizedProps)}break;case 27:if(p&4&&i.alternate===null){v=i.stateNode,w=i.memoizedProps;try{for(var q=v.firstChild;q;){var ne=q.nextSibling,xe=q.nodeName;q[ue]||xe==="HEAD"||xe==="BODY"||xe==="SCRIPT"||xe==="STYLE"||xe==="LINK"&&q.rel.toLowerCase()==="stylesheet"||v.removeChild(q),q=ne}for(var Se=i.type,pe=v.attributes;pe.length;)v.removeAttributeNode(pe[0]);Jr(v,Se,w),v[P]=i,v[H]=w}catch(He){Pt(i,i.return,He)}}case 5:if(Ga(o,i),Va(i),p&512&&(sr||u===null||ua(u,u.return)),i.flags&32){v=i.stateNode;try{th(v,"")}catch(He){Pt(i,i.return,He)}}p&4&&i.stateNode!=null&&(v=i.memoizedProps,I2(i,v,u!==null?u.memoizedProps:v)),p&1024&&(C_=!0);break;case 6:if(Ga(o,i),Va(i),p&4){if(i.stateNode===null)throw Error(r(162));p=i.memoizedProps,u=i.stateNode;try{u.nodeValue=p}catch(He){Pt(i,i.return,He)}}break;case 3:if(a1=null,v=pi,pi=r1(o.containerInfo),Ga(o,i),pi=v,Va(i),p&4&&u!==null&&u.memoizedState.isDehydrated)try{i0(o.containerInfo)}catch(He){Pt(i,i.return,He)}C_&&(C_=!1,X2(i));break;case 4:p=pi,pi=r1(i.stateNode.containerInfo),Ga(o,i),Va(i),pi=p;break;case 12:Ga(o,i),Va(i);break;case 13:Ga(o,i),Va(i),i.child.flags&8192&&i.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(B_=Yt()),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,R_(i,p)));break;case 22:if(p&512&&(sr||u===null||ua(u,u.return)),q=i.memoizedState!==null,ne=u!==null&&u.memoizedState!==null,xe=Ds,Se=sr,Ds=xe||q,sr=Se||ne,Ga(o,i),sr=Se,Ds=xe,Va(i),o=i.stateNode,o._current=i,o._visibility&=-3,o._visibility|=o._pendingVisibility&2,p&8192&&(o._visibility=q?o._visibility&-2:o._visibility|1,q&&(o=Ds||sr,u===null||ne||o||vh(i)),i.memoizedProps===null||i.memoizedProps.mode!=="manual"))e:for(u=null,o=i;;){if(o.tag===5||o.tag===26||o.tag===27){if(u===null){ne=u=o;try{if(v=ne.stateNode,q)w=v.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{k=ne.stateNode,N=ne.memoizedProps.style;var ge=N!=null&&N.hasOwnProperty("display")?N.display:null;k.style.display=ge==null||typeof ge=="boolean"?"":(""+ge).trim()}}catch(He){Pt(ne,ne.return,He)}}}else if(o.tag===6){if(u===null){ne=o;try{ne.stateNode.nodeValue=q?"":ne.memoizedProps}catch(He){Pt(ne,ne.return,He)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===i)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break e;for(;o.sibling===null;){if(o.return===null||o.return===i)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}p&4&&(p=i.updateQueue,p!==null&&(u=p.retryQueue,u!==null&&(p.retryQueue=null,R_(i,u))));break;case 19:Ga(o,i),Va(i),p&4&&(p=i.updateQueue,p!==null&&(i.updateQueue=null,R_(i,p)));break;case 21:break;default:Ga(o,i),Va(i)}}function Va(i){var o=i.flags;if(o&2){try{if(i.tag!==27){e:{for(var u=i.return;u!==null;){if(B2(u)){var p=u;break e}u=u.return}throw Error(r(160))}switch(p.tag){case 27:var v=p.stateNode,w=T_(i);zm(i,w,v);break;case 5:var k=p.stateNode;p.flags&32&&(th(k,""),p.flags&=-33);var N=T_(i);zm(i,N,k);break;case 3:case 4:var q=p.stateNode.containerInfo,ne=T_(i);k_(i,ne,q);break;default:throw Error(r(161))}}}catch(xe){Pt(i,i.return,xe)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function X2(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var o=i;X2(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),i=i.sibling}}function Ms(i,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)z2(i,o.alternate,o),o=o.sibling}function vh(i){for(i=i.child;i!==null;){var o=i;switch(o.tag){case 0:case 11:case 14:case 15:zo(4,o,o.return),vh(o);break;case 1:ua(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&N2(o,o.return,u),vh(o);break;case 26:case 27:case 5:ua(o,o.return),vh(o);break;case 22:ua(o,o.return),o.memoizedState===null&&vh(o);break;default:vh(o)}i=i.sibling}}function jo(i,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var p=o.alternate,v=i,w=o,k=w.flags;switch(w.tag){case 0:case 11:case 15:jo(v,w,u),zd(4,w);break;case 1:if(jo(v,w,u),p=w,v=p.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(ne){Pt(p,p.return,ne)}if(p=w,v=p.updateQueue,v!==null){var N=p.stateNode;try{var q=v.shared.hiddenCallbacks;if(q!==null)for(v.shared.hiddenCallbacks=null,v=0;v<q.length;v++)F2(q[v],N)}catch(ne){Pt(p,p.return,ne)}}u&&k&64&&L2(w),fc(w,w.return);break;case 26:case 27:case 5:jo(v,w,u),u&&p===null&&k&4&&P2(w),fc(w,w.return);break;case 12:jo(v,w,u);break;case 13:jo(v,w,u),u&&k&4&&V2(v,w);break;case 22:w.memoizedState===null&&jo(v,w,u),fc(w,w.return);break;default:jo(v,w,u)}o=o.sibling}}function O_(i,o){var u=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),i=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(i=o.memoizedState.cachePool.pool),i!==u&&(i!=null&&i.refCount++,u!=null&&Dd(u))}function D_(i,o){i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&Dd(i))}function Go(i,o,u,p){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)q2(i,o,u,p),o=o.sibling}function q2(i,o,u,p){var v=o.flags;switch(o.tag){case 0:case 11:case 15:Go(i,o,u,p),v&2048&&zd(9,o);break;case 3:Go(i,o,u,p),v&2048&&(i=null,o.alternate!==null&&(i=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==i&&(o.refCount++,i!=null&&Dd(i)));break;case 12:if(v&2048){Go(i,o,u,p),i=o.stateNode;try{var w=o.memoizedProps,k=w.id,N=w.onPostCommit;typeof N=="function"&&N(k,o.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(q){Pt(o,o.return,q)}}else Go(i,o,u,p);break;case 23:break;case 22:w=o.stateNode,o.memoizedState!==null?w._visibility&4?Go(i,o,u,p):jd(i,o):w._visibility&4?Go(i,o,u,p):(w._visibility|=4,_h(i,o,u,p,(o.subtreeFlags&10256)!==0)),v&2048&&O_(o.alternate,o);break;case 24:Go(i,o,u,p),v&2048&&D_(o.alternate,o);break;default:Go(i,o,u,p)}}function _h(i,o,u,p,v){for(v=v&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var w=i,k=o,N=u,q=p,ne=k.flags;switch(k.tag){case 0:case 11:case 15:_h(w,k,N,q,v),zd(8,k);break;case 23:break;case 22:var xe=k.stateNode;k.memoizedState!==null?xe._visibility&4?_h(w,k,N,q,v):jd(w,k):(xe._visibility|=4,_h(w,k,N,q,v)),v&&ne&2048&&O_(k.alternate,k);break;case 24:_h(w,k,N,q,v),v&&ne&2048&&D_(k.alternate,k);break;default:_h(w,k,N,q,v)}o=o.sibling}}function jd(i,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=i,p=o,v=p.flags;switch(p.tag){case 22:jd(u,p),v&2048&&O_(p.alternate,p);break;case 24:jd(u,p),v&2048&&D_(p.alternate,p);break;default:jd(u,p)}o=o.sibling}}var Gd=8192;function yh(i){if(i.subtreeFlags&Gd)for(i=i.child;i!==null;)Y2(i),i=i.sibling}function Y2(i){switch(i.tag){case 26:yh(i),i.flags&Gd&&i.memoizedState!==null&&fF(pi,i.memoizedState,i.memoizedProps);break;case 5:yh(i);break;case 3:case 4:var o=pi;pi=r1(i.stateNode.containerInfo),yh(i),pi=o;break;case 22:i.memoizedState===null&&(o=i.alternate,o!==null&&o.memoizedState!==null?(o=Gd,Gd=16777216,yh(i),Gd=o):yh(i));break;default:yh(i)}}function W2(i){var o=i.alternate;if(o!==null&&(i=o.child,i!==null)){o.child=null;do o=i.sibling,i.sibling=null,i=o;while(i!==null)}}function Vd(i){var o=i.deletions;if(i.flags&16){if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];Hr=p,Q2(p,i)}W2(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)K2(i),i=i.sibling}function K2(i){switch(i.tag){case 0:case 11:case 15:Vd(i),i.flags&2048&&zo(9,i,i.return);break;case 3:Vd(i);break;case 12:Vd(i);break;case 22:var o=i.stateNode;i.memoizedState!==null&&o._visibility&4&&(i.return===null||i.return.tag!==13)?(o._visibility&=-5,jm(i)):Vd(i);break;default:Vd(i)}}function jm(i){var o=i.deletions;if(i.flags&16){if(o!==null)for(var u=0;u<o.length;u++){var p=o[u];Hr=p,Q2(p,i)}W2(i)}for(i=i.child;i!==null;){switch(o=i,o.tag){case 0:case 11:case 15:zo(8,o,o.return),jm(o);break;case 22:u=o.stateNode,u._visibility&4&&(u._visibility&=-5,jm(o));break;default:jm(o)}i=i.sibling}}function Q2(i,o){for(;Hr!==null;){var u=Hr;switch(u.tag){case 0:case 11:case 15:zo(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var p=u.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:Dd(u.memoizedState.cache)}if(p=u.child,p!==null)p.return=u,Hr=p;else e:for(u=i;Hr!==null;){p=Hr;var v=p.sibling,w=p.return;if(j2(p),p===u){Hr=null;break e}if(v!==null){v.return=w,Hr=v;break e}Hr=w}}}function S3(i,o,u,p){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $a(i,o,u,p){return new S3(i,o,u,p)}function F_(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Vo(i,o){var u=i.alternate;return u===null?(u=$a(i.tag,o,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=o,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&31457280,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,o=i.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u.refCleanup=i.refCleanup,u}function Z2(i,o){i.flags&=31457282;var u=i.alternate;return u===null?(i.childLanes=0,i.lanes=o,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=u.childLanes,i.lanes=u.lanes,i.child=u.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=u.memoizedProps,i.memoizedState=u.memoizedState,i.updateQueue=u.updateQueue,i.type=u.type,o=u.dependencies,i.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),i}function Gm(i,o,u,p,v,w){var k=0;if(p=i,typeof i=="function")F_(i)&&(k=1);else if(typeof i=="string")k=uF(i,u,Ke.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case h:return dc(u.children,v,w,o);case f:k=8,v|=24;break;case d:return i=$a(12,u,o,v|2),i.elementType=d,i.lanes=w,i;case A:return i=$a(13,u,o,v),i.elementType=A,i.lanes=w,i;case E:return i=$a(19,u,o,v),i.elementType=E,i.lanes=w,i;case S:return J2(u,v,w,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case m:case _:k=10;break e;case x:k=9;break e;case y:k=11;break e;case b:k=14;break e;case C:k=16,p=null;break e}k=29,u=Error(r(130,i===null?"null":typeof i,"")),p=null}return o=$a(k,u,o,v),o.elementType=i,o.type=p,o.lanes=w,o}function dc(i,o,u,p){return i=$a(7,i,p,o),i.lanes=u,i}function J2(i,o,u,p){i=$a(22,i,p,o),i.elementType=S,i.lanes=u;var v={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var w=v._current;if(w===null)throw Error(r(456));if(!(v._pendingVisibility&2)){var k=Fo(w,2);k!==null&&(v._pendingVisibility|=2,Mn(k,w,2))}},attach:function(){var w=v._current;if(w===null)throw Error(r(456));if(v._pendingVisibility&2){var k=Fo(w,2);k!==null&&(v._pendingVisibility&=-3,Mn(k,w,2))}}};return i.stateNode=v,i}function M_(i,o,u){return i=$a(6,i,null,o),i.lanes=u,i}function L_(i,o,u){return o=$a(4,i.children!==null?i.children:[],i.key,o),o.lanes=u,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function Ls(i){i.flags|=4}function eS(i,o){if(o.type!=="stylesheet"||o.state.loading&4)i.flags&=-16777217;else if(i.flags|=16777216,!BS(o)){if(o=ja.current,o!==null&&((vt&4194176)===vt?Vi!==null:(vt&62914560)!==vt&&!(vt&536870912)||o!==Vi))throw Cd=Uv,xb;i.flags|=8192}}function Vm(i,o){o!==null&&(i.flags|=4),i.flags&16384&&(o=i.tag!==22?am():536870912,i.lanes|=o,Ah|=o)}function $d(i,o){if(!bt)switch(i.tailMode){case"hidden":o=i.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function tr(i){var o=i.alternate!==null&&i.alternate.child===i.child,u=0,p=0;if(o)for(var v=i.child;v!==null;)u|=v.lanes|v.childLanes,p|=v.subtreeFlags&31457280,p|=v.flags&31457280,v.return=i,v=v.sibling;else for(v=i.child;v!==null;)u|=v.lanes|v.childLanes,p|=v.subtreeFlags,p|=v.flags,v.return=i,v=v.sibling;return i.subtreeFlags|=p,i.childLanes=u,o}function T3(i,o,u){var p=o.pendingProps;switch(Iv(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tr(o),null;case 1:return tr(o),null;case 3:return u=o.stateNode,p=null,i!==null&&(p=i.memoizedState.cache),o.memoizedState.cache!==p&&(o.flags|=2048),Os(Rr),Qe(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(i===null||i.child===null)&&(bd(o)?Ls(o):i===null||i.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,di!==null&&(j_(di),di=null))),tr(o),null;case 26:return u=o.memoizedState,i===null?(Ls(o),u!==null?(tr(o),eS(o,u)):(tr(o),o.flags&=-16777217)):u?u!==i.memoizedState?(Ls(o),tr(o),eS(o,u)):(tr(o),o.flags&=-16777217):(i.memoizedProps!==p&&Ls(o),tr(o),o.flags&=-16777217),null;case 27:Bt(o),u=Rt.current;var v=o.type;if(i!==null&&o.stateNode!=null)i.memoizedProps!==p&&Ls(o);else{if(!p){if(o.stateNode===null)throw Error(r(166));return tr(o),null}i=Ke.current,bd(o)?gb(o):(i=OS(v,p,u),o.stateNode=i,Ls(o))}return tr(o),null;case 5:if(Bt(o),u=o.type,i!==null&&o.stateNode!=null)i.memoizedProps!==p&&Ls(o);else{if(!p){if(o.stateNode===null)throw Error(r(166));return tr(o),null}if(i=Ke.current,bd(o))gb(o);else{switch(v=t1(Rt.current),i){case 1:i=v.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:i=v.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":i=v.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":i=v.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":i=v.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof p.is=="string"?v.createElement("select",{is:p.is}):v.createElement("select"),p.multiple?i.multiple=!0:p.size&&(i.size=p.size);break;default:i=typeof p.is=="string"?v.createElement(u,{is:p.is}):v.createElement(u)}}i[P]=o,i[H]=p;e:for(v=o.child;v!==null;){if(v.tag===5||v.tag===6)i.appendChild(v.stateNode);else if(v.tag!==4&&v.tag!==27&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===o)break e;for(;v.sibling===null;){if(v.return===null||v.return===o)break e;v=v.return}v.sibling.return=v.return,v=v.sibling}o.stateNode=i;e:switch(Jr(i,u,p),u){case"button":case"input":case"select":case"textarea":i=!!p.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Ls(o)}}return tr(o),o.flags&=-16777217,null;case 6:if(i&&o.stateNode!=null)i.memoizedProps!==p&&Ls(o);else{if(typeof p!="string"&&o.stateNode===null)throw Error(r(166));if(i=Rt.current,bd(o)){if(i=o.stateNode,u=o.memoizedProps,p=null,v=Fn,v!==null)switch(v.tag){case 27:case 5:p=v.memoizedProps}i[P]=o,i=!!(i.nodeValue===u||p!==null&&p.suppressHydrationWarning===!0||bS(i.nodeValue,u)),i||nc(o)}else i=t1(i).createTextNode(p),i[P]=o,o.stateNode=i}return tr(o),null;case 13:if(p=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(v=bd(o),p!==null&&p.dehydrated!==null){if(i===null){if(!v)throw Error(r(318));if(v=o.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(r(317));v[P]=o}else Sd(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;tr(o),v=!1}else di!==null&&(j_(di),di=null),v=!0;if(!v)return o.flags&256?(Ts(o),o):(Ts(o),null)}if(Ts(o),o.flags&128)return o.lanes=u,o;if(u=p!==null,i=i!==null&&i.memoizedState!==null,u){p=o.child,v=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(v=p.alternate.memoizedState.cachePool.pool);var w=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(w=p.memoizedState.cachePool.pool),w!==v&&(p.flags|=2048)}return u!==i&&u&&(o.child.flags|=8192),Vm(o,o.updateQueue),tr(o),null;case 4:return Qe(),i===null&&J_(o.stateNode.containerInfo),tr(o),null;case 10:return Os(o.type),tr(o),null;case 19:if(Te(Cr),v=o.memoizedState,v===null)return tr(o),null;if(p=(o.flags&128)!==0,w=v.rendering,w===null)if(p)$d(v,!1);else{if(or!==0||i!==null&&i.flags&128)for(i=o.child;i!==null;){if(w=km(i),w!==null){for(o.flags|=128,$d(v,!1),i=w.updateQueue,o.updateQueue=i,Vm(o,i),o.subtreeFlags=0,i=u,u=o.child;u!==null;)Z2(u,i),u=u.sibling;return ye(Cr,Cr.current&1|2),o.child}i=i.sibling}v.tail!==null&&Yt()>$m&&(o.flags|=128,p=!0,$d(v,!1),o.lanes=4194304)}else{if(!p)if(i=km(w),i!==null){if(o.flags|=128,p=!0,i=i.updateQueue,o.updateQueue=i,Vm(o,i),$d(v,!0),v.tail===null&&v.tailMode==="hidden"&&!w.alternate&&!bt)return tr(o),null}else 2*Yt()-v.renderingStartTime>$m&&u!==536870912&&(o.flags|=128,p=!0,$d(v,!1),o.lanes=4194304);v.isBackwards?(w.sibling=o.child,o.child=w):(i=v.last,i!==null?i.sibling=w:o.child=w,v.last=w)}return v.tail!==null?(o=v.tail,v.rendering=o,v.tail=o.sibling,v.renderingStartTime=Yt(),o.sibling=null,i=Cr.current,ye(Cr,p?i&1|2:i&1),o):(tr(o),null);case 22:case 23:return Ts(o),zv(),p=o.memoizedState!==null,i!==null?i.memoizedState!==null!==p&&(o.flags|=8192):p&&(o.flags|=8192),p?u&536870912&&!(o.flags&128)&&(tr(o),o.subtreeFlags&6&&(o.flags|=8192)):tr(o),u=o.updateQueue,u!==null&&Vm(o,u.retryQueue),u=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),p=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),p!==u&&(o.flags|=2048),i!==null&&Te(ic),null;case 24:return u=null,i!==null&&(u=i.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),Os(Rr),tr(o),null;case 25:return null}throw Error(r(156,o.tag))}function k3(i,o){switch(Iv(o),o.tag){case 1:return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return Os(Rr),Qe(),i=o.flags,i&65536&&!(i&128)?(o.flags=i&-65537|128,o):null;case 26:case 27:case 5:return Bt(o),null;case 13:if(Ts(o),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(r(340));Sd()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return Te(Cr),null;case 4:return Qe(),null;case 10:return Os(o.type),null;case 22:case 23:return Ts(o),zv(),i!==null&&Te(ic),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 24:return Os(Rr),null;case 25:return null;default:return null}}function tS(i,o){switch(Iv(o),o.tag){case 3:Os(Rr),Qe();break;case 26:case 27:case 5:Bt(o);break;case 4:Qe();break;case 13:Ts(o);break;case 19:Te(Cr);break;case 10:Os(o.type);break;case 22:case 23:Ts(o),zv(),i!==null&&Te(ic);break;case 24:Os(Rr)}}var C3={getCacheForType:function(i){var o=fn(Rr),u=o.data.get(i);return u===void 0&&(u=i(),o.data.set(i,u)),u}},R3=typeof WeakMap=="function"?WeakMap:Map,rr=0,Ht=null,dt=null,vt=0,zt=0,fa=null,Ns=!1,wh=!1,N_=!1,Ps=0,or=0,$o=0,pc=0,P_=0,Xa=0,Ah=0,Xd=null,Xi=null,I_=!1,B_=0,$m=1/0,Xm=null,Xo=null,qm=!1,gc=null,qd=0,U_=0,H_=null,Yd=0,z_=null;function da(){if(rr&2&&vt!==0)return vt&-vt;if(B.T!==null){var i=dh;return i!==0?i:W_()}return om()}function rS(){Xa===0&&(Xa=!(vt&536870912)||bt?nm():536870912);var i=ja.current;return i!==null&&(i.flags|=32),Xa}function Mn(i,o,u){(i===Ht&&zt===2||i.cancelPendingCommit!==null)&&(Eh(i,0),Is(i,vt,Xa,!1)),Kl(i,u),(!(rr&2)||i!==Ht)&&(i===Ht&&(!(rr&2)&&(pc|=u),or===4&&Is(i,vt,Xa,!1)),qi(i))}function nS(i,o,u){if(rr&6)throw Error(r(327));var p=!u&&(o&60)===0&&(o&i.expiredLanes)===0||Wl(i,o),v=p?F3(i,o):$_(i,o,!0),w=p;do{if(v===0){wh&&!p&&Is(i,o,0,!1);break}else if(v===6)Is(i,o,0,!Ns);else{if(u=i.current.alternate,w&&!O3(u)){v=$_(i,o,!1),w=!1;continue}if(v===2){if(w=o,i.errorRecoveryDisabledLanes&w)var k=0;else k=i.pendingLanes&-536870913,k=k!==0?k:k&536870912?536870912:0;if(k!==0){o=k;e:{var N=i;v=Xd;var q=N.current.memoizedState.isDehydrated;if(q&&(Eh(N,k).flags|=256),k=$_(N,k,!1),k!==2){if(N_&&!q){N.errorRecoveryDisabledLanes|=w,pc|=w,v=4;break e}w=Xi,Xi=v,w!==null&&j_(w)}v=k}if(w=!1,v!==2)continue}}if(v===1){Eh(i,0),Is(i,o,0,!0);break}e:{switch(p=i,v){case 0:case 1:throw Error(r(345));case 4:if((o&4194176)===o){Is(p,o,Xa,!Ns);break e}break;case 2:Xi=null;break;case 3:case 5:break;default:throw Error(r(329))}if(p.finishedWork=u,p.finishedLanes=o,(o&62914560)===o&&(w=B_+300-Yt(),10<w)){if(Is(p,o,Xa,!Ns),Zu(p,0)!==0)break e;p.timeoutHandle=kS(aS.bind(null,p,u,Xi,Xm,I_,o,Xa,pc,Ah,Ns,2,-0,0),w);break e}aS(p,u,Xi,Xm,I_,o,Xa,pc,Ah,Ns,0,-0,0)}}break}while(!0);qi(i)}function j_(i){Xi===null?Xi=i:Xi.push.apply(Xi,i)}function aS(i,o,u,p,v,w,k,N,q,ne,xe,Se,pe){var ge=o.subtreeFlags;if((ge&8192||(ge&16785408)===16785408)&&(e0={stylesheets:null,count:0,unsuspend:hF},Y2(o),o=dF(),o!==null)){i.cancelPendingCommit=o(hS.bind(null,i,u,p,v,k,N,q,1,Se,pe)),Is(i,w,k,!ne);return}hS(i,u,p,v,k,N,q,xe,Se,pe)}function O3(i){for(var o=i;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var p=0;p<u.length;p++){var v=u[p],w=v.getSnapshot;v=v.value;try{if(!ca(w(),v))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Is(i,o,u,p){o&=~P_,o&=~pc,i.suspendedLanes|=o,i.pingedLanes&=~o,p&&(i.warmLanes|=o),p=i.expirationTimes;for(var v=o;0<v;){var w=31-On(v),k=1<<w;p[w]=-1,v&=~k}u!==0&&Ju(i,u,o)}function Ym(){return rr&6?!0:(Wd(0),!1)}function G_(){if(dt!==null){if(zt===0)var i=dt.return;else i=dt,Rs=uc=null,Wv(i),hh=null,Rd=0,i=dt;for(;i!==null;)tS(i.alternate,i),i=i.return;dt=null}}function Eh(i,o){i.finishedWork=null,i.finishedLanes=0;var u=i.timeoutHandle;u!==-1&&(i.timeoutHandle=-1,W3(u)),u=i.cancelPendingCommit,u!==null&&(i.cancelPendingCommit=null,u()),G_(),Ht=i,dt=u=Vo(i.current,null),vt=o,zt=0,fa=null,Ns=!1,wh=Wl(i,o),N_=!1,Ah=Xa=P_=pc=$o=or=0,Xi=Xd=null,I_=!1,o&8&&(o|=o&32);var p=i.entangledLanes;if(p!==0)for(i=i.entanglements,p&=o;0<p;){var v=31-On(p),w=1<<v;o|=i[v],p&=~w}return Ps=o,vm(),u}function iS(i,o){lt=null,B.H=$i,o===kd?(o=yb(),zt=3):o===xb?(o=yb(),zt=4):zt=o===v2?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,fa=o,dt===null&&(or=1,Bm(i,Ua(o,i.current)))}function sS(){var i=B.H;return B.H=$i,i===null?$i:i}function oS(){var i=B.A;return B.A=C3,i}function V_(){or=4,Ns||(vt&4194176)!==vt&&ja.current!==null||(wh=!0),!($o&134217727)&&!(pc&134217727)||Ht===null||Is(Ht,vt,Xa,!1)}function $_(i,o,u){var p=rr;rr|=2;var v=sS(),w=oS();(Ht!==i||vt!==o)&&(Xm=null,Eh(i,o)),o=!1;var k=or;e:do try{if(zt!==0&&dt!==null){var N=dt,q=fa;switch(zt){case 8:G_(),k=6;break e;case 3:case 2:case 6:ja.current===null&&(o=!0);var ne=zt;if(zt=0,fa=null,bh(i,N,q,ne),u&&wh){k=0;break e}break;default:ne=zt,zt=0,fa=null,bh(i,N,q,ne)}}D3(),k=or;break}catch(xe){iS(i,xe)}while(!0);return o&&i.shellSuspendCounter++,Rs=uc=null,rr=p,B.H=v,B.A=w,dt===null&&(Ht=null,vt=0,vm()),k}function D3(){for(;dt!==null;)lS(dt)}function F3(i,o){var u=rr;rr|=2;var p=sS(),v=oS();Ht!==i||vt!==o?(Xm=null,$m=Yt()+500,Eh(i,o)):wh=Wl(i,o);e:do try{if(zt!==0&&dt!==null){o=dt;var w=fa;t:switch(zt){case 1:zt=0,fa=null,bh(i,o,w,1);break;case 2:if(vb(w)){zt=0,fa=null,cS(o);break}o=function(){zt===2&&Ht===i&&(zt=7),qi(i)},w.then(o,o);break e;case 3:zt=7;break e;case 4:zt=5;break e;case 7:vb(w)?(zt=0,fa=null,cS(o)):(zt=0,fa=null,bh(i,o,w,7));break;case 5:var k=null;switch(dt.tag){case 26:k=dt.memoizedState;case 5:case 27:var N=dt;if(!k||BS(k)){zt=0,fa=null;var q=N.sibling;if(q!==null)dt=q;else{var ne=N.return;ne!==null?(dt=ne,Wm(ne)):dt=null}break t}}zt=0,fa=null,bh(i,o,w,5);break;case 6:zt=0,fa=null,bh(i,o,w,6);break;case 8:G_(),or=6;break e;default:throw Error(r(462))}}M3();break}catch(xe){iS(i,xe)}while(!0);return Rs=uc=null,B.H=p,B.A=v,rr=u,dt!==null?0:(Ht=null,vt=0,vm(),or)}function M3(){for(;dt!==null&&!Yl();)lS(dt)}function lS(i){var o=O2(i.alternate,i,Ps);i.memoizedProps=i.pendingProps,o===null?Wm(i):dt=o}function cS(i){var o=i,u=o.alternate;switch(o.tag){case 15:case 0:o=b2(u,o,o.pendingProps,o.type,void 0,vt);break;case 11:o=b2(u,o,o.pendingProps,o.type.render,o.ref,vt);break;case 5:Wv(o);default:tS(u,o),o=dt=Z2(o,Ps),o=O2(u,o,Ps)}i.memoizedProps=i.pendingProps,o===null?Wm(i):dt=o}function bh(i,o,u,p){Rs=uc=null,Wv(o),hh=null,Rd=0;var v=o.return;try{if(w3(i,v,o,u,vt)){or=1,Bm(i,Ua(u,i.current)),dt=null;return}}catch(w){if(v!==null)throw dt=v,w;or=1,Bm(i,Ua(u,i.current)),dt=null;return}o.flags&32768?(bt||p===1?i=!0:wh||vt&536870912?i=!1:(Ns=i=!0,(p===2||p===3||p===6)&&(p=ja.current,p!==null&&p.tag===13&&(p.flags|=16384))),uS(o,i)):Wm(o)}function Wm(i){var o=i;do{if(o.flags&32768){uS(o,Ns);return}i=o.return;var u=T3(o.alternate,o,Ps);if(u!==null){dt=u;return}if(o=o.sibling,o!==null){dt=o;return}dt=o=i}while(o!==null);or===0&&(or=5)}function uS(i,o){do{var u=k3(i.alternate,i);if(u!==null){u.flags&=32767,dt=u;return}if(u=i.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(i=i.sibling,i!==null)){dt=i;return}dt=i=u}while(i!==null);or=6,dt=null}function hS(i,o,u,p,v,w,k,N,q,ne){var xe=B.T,Se=X.p;try{X.p=2,B.T=null,L3(i,o,u,p,Se,v,w,k,N,q,ne)}finally{B.T=xe,X.p=Se}}function L3(i,o,u,p,v,w,k,N){do Sh();while(gc!==null);if(rr&6)throw Error(r(327));var q=i.finishedWork;if(p=i.finishedLanes,q===null)return null;if(i.finishedWork=null,i.finishedLanes=0,q===i.current)throw Error(r(177));i.callbackNode=null,i.callbackPriority=0,i.cancelPendingCommit=null;var ne=q.lanes|q.childLanes;if(ne|=Lv,pv(i,p,ne,w,k,N),i===Ht&&(dt=Ht=null,vt=0),!(q.subtreeFlags&10256)&&!(q.flags&10256)||qm||(qm=!0,U_=ne,H_=u,B3(vr,function(){return Sh(),null})),u=(q.flags&15990)!==0,q.subtreeFlags&15990||u?(u=B.T,B.T=null,w=X.p,X.p=2,k=rr,rr|=4,E3(i,q),$2(q,i),a3(ny,i.containerInfo),o1=!!ry,ny=ry=null,i.current=q,z2(i,q.alternate,q),Hi(),rr=k,X.p=w,B.T=u):i.current=q,qm?(qm=!1,gc=i,qd=p):fS(i,ne),ne=i.pendingLanes,ne===0&&(Xo=null),Jg(q.stateNode),qi(i),o!==null)for(v=i.onRecoverableError,q=0;q<o.length;q++)ne=o[q],v(ne.value,{componentStack:ne.stack});return qd&3&&Sh(),ne=i.pendingLanes,p&4194218&&ne&42?i===z_?Yd++:(Yd=0,z_=i):Yd=0,Wd(0),null}function fS(i,o){(i.pooledCacheLanes&=o)===0&&(o=i.pooledCache,o!=null&&(i.pooledCache=null,Dd(o)))}function Sh(){if(gc!==null){var i=gc,o=U_;U_=0;var u=sm(qd),p=B.T,v=X.p;try{if(X.p=32>u?32:u,B.T=null,gc===null)var w=!1;else{u=H_,H_=null;var k=gc,N=qd;if(gc=null,qd=0,rr&6)throw Error(r(331));var q=rr;if(rr|=4,K2(k.current),q2(k,k.current,N,u),rr=q,Wd(0,!1),fr&&typeof fr.onPostCommitFiberRoot=="function")try{fr.onPostCommitFiberRoot($t,k)}catch{}w=!0}return w}finally{X.p=v,B.T=p,fS(i,o)}}return!1}function dS(i,o,u){o=Ua(u,o),o=c_(i.stateNode,o,2),i=Ho(i,o,2),i!==null&&(Kl(i,2),qi(i))}function Pt(i,o,u){if(i.tag===3)dS(i,i,u);else for(;o!==null;){if(o.tag===3){dS(o,i,u);break}else if(o.tag===1){var p=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Xo===null||!Xo.has(p))){i=Ua(u,i),u=m2(2),p=Ho(o,u,2),p!==null&&(x2(u,p,o,i),Kl(p,2),qi(p));break}}o=o.return}}function X_(i,o,u){var p=i.pingCache;if(p===null){p=i.pingCache=new R3;var v=new Set;p.set(o,v)}else v=p.get(o),v===void 0&&(v=new Set,p.set(o,v));v.has(u)||(N_=!0,v.add(u),i=N3.bind(null,i,o,u),o.then(i,i))}function N3(i,o,u){var p=i.pingCache;p!==null&&p.delete(o),i.pingedLanes|=i.suspendedLanes&u,i.warmLanes&=~u,Ht===i&&(vt&u)===u&&(or===4||or===3&&(vt&62914560)===vt&&300>Yt()-B_?!(rr&2)&&Eh(i,0):P_|=u,Ah===vt&&(Ah=0)),qi(i)}function pS(i,o){o===0&&(o=am()),i=Fo(i,o),i!==null&&(Kl(i,o),qi(i))}function P3(i){var o=i.memoizedState,u=0;o!==null&&(u=o.retryLane),pS(i,u)}function I3(i,o){var u=0;switch(i.tag){case 13:var p=i.stateNode,v=i.memoizedState;v!==null&&(u=v.retryLane);break;case 19:p=i.stateNode;break;case 22:p=i.stateNode._retryCache;break;default:throw Error(r(314))}p!==null&&p.delete(o),pS(i,u)}function B3(i,o){return Yn(i,o)}var Km=null,Th=null,q_=!1,Qm=!1,Y_=!1,mc=0;function qi(i){i!==Th&&i.next===null&&(Th===null?Km=Th=i:Th=Th.next=i),Qm=!0,q_||(q_=!0,H3(U3))}function Wd(i,o){if(!Y_&&Qm){Y_=!0;do for(var u=!1,p=Km;p!==null;){if(i!==0){var v=p.pendingLanes;if(v===0)var w=0;else{var k=p.suspendedLanes,N=p.pingedLanes;w=(1<<31-On(42|i)+1)-1,w&=v&~(k&~N),w=w&201326677?w&201326677|1:w?w|2:0}w!==0&&(u=!0,xS(p,w))}else w=vt,w=Zu(p,p===Ht?w:0),!(w&3)||Wl(p,w)||(u=!0,xS(p,w));p=p.next}while(u);Y_=!1}}function U3(){Qm=q_=!1;var i=0;mc!==0&&(Y3()&&(i=mc),mc=0);for(var o=Yt(),u=null,p=Km;p!==null;){var v=p.next,w=gS(p,o);w===0?(p.next=null,u===null?Km=v:u.next=v,v===null&&(Th=u)):(u=p,(i!==0||w&3)&&(Qm=!0)),p=v}Wd(i)}function gS(i,o){for(var u=i.suspendedLanes,p=i.pingedLanes,v=i.expirationTimes,w=i.pendingLanes&-62914561;0<w;){var k=31-On(w),N=1<<k,q=v[k];q===-1?(!(N&u)||N&p)&&(v[k]=dv(N,o)):q<=o&&(i.expiredLanes|=N),w&=~N}if(o=Ht,u=vt,u=Zu(i,i===o?u:0),p=i.callbackNode,u===0||i===o&&zt===2||i.cancelPendingCommit!==null)return p!==null&&p!==null&&la(p),i.callbackNode=null,i.callbackPriority=0;if(!(u&3)||Wl(i,u)){if(o=u&-u,o===i.callbackPriority)return o;switch(p!==null&&la(p),sm(u)){case 2:case 8:u=Ro;break;case 32:u=vr;break;case 268435456:u=rt;break;default:u=vr}return p=mS.bind(null,i),u=Yn(u,p),i.callbackPriority=o,i.callbackNode=u,o}return p!==null&&p!==null&&la(p),i.callbackPriority=2,i.callbackNode=null,2}function mS(i,o){var u=i.callbackNode;if(Sh()&&i.callbackNode!==u)return null;var p=vt;return p=Zu(i,i===Ht?p:0),p===0?null:(nS(i,p,o),gS(i,Yt()),i.callbackNode!=null&&i.callbackNode===u?mS.bind(null,i):null)}function xS(i,o){if(Sh())return null;nS(i,o,!0)}function H3(i){K3(function(){rr&6?Yn(hi,i):i()})}function W_(){return mc===0&&(mc=nm()),mc}function vS(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:hm(""+i)}function _S(i,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,i.id&&u.setAttribute("form",i.id),o.parentNode.insertBefore(u,o),i=new FormData(i),u.parentNode.removeChild(u),i}function z3(i,o,u,p,v){if(o==="submit"&&u&&u.stateNode===v){var w=vS((v[H]||null).action),k=p.submitter;k&&(o=(o=k[H]||null)?vS(o.formAction):k.getAttribute("formAction"),o!==null&&(w=o,k=null));var N=new gm("action","action",null,p,v);i.push({event:N,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(mc!==0){var q=k?_S(v,k):new FormData(v);a_(u,{pending:!0,data:q,method:v.method,action:w},null,q)}}else typeof w=="function"&&(N.preventDefault(),q=k?_S(v,k):new FormData(v),a_(u,{pending:!0,data:q,method:v.method,action:w},w,q))},currentTarget:v}]})}}for(var K_=0;K_<hb.length;K_++){var Q_=hb[K_],j3=Q_.toLowerCase(),G3=Q_[0].toUpperCase()+Q_.slice(1);fi(j3,"on"+G3)}fi(sb,"onAnimationEnd"),fi(ob,"onAnimationIteration"),fi(lb,"onAnimationStart"),fi("dblclick","onDoubleClick"),fi("focusin","onFocus"),fi("focusout","onBlur"),fi(s3,"onTransitionRun"),fi(o3,"onTransitionStart"),fi(l3,"onTransitionCancel"),fi(cb,"onTransitionEnd"),er("onMouseEnter",["mouseout","mouseover"]),er("onMouseLeave",["mouseout","mouseover"]),er("onPointerEnter",["pointerout","pointerover"]),er("onPointerLeave",["pointerout","pointerover"]),kt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),kt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),kt("onBeforeInput",["compositionend","keypress","textInput","paste"]),kt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),kt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),kt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),V3=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Kd));function yS(i,o){o=(o&4)!==0;for(var u=0;u<i.length;u++){var p=i[u],v=p.event;p=p.listeners;e:{var w=void 0;if(o)for(var k=p.length-1;0<=k;k--){var N=p[k],q=N.instance,ne=N.currentTarget;if(N=N.listener,q!==w&&v.isPropagationStopped())break e;w=N,v.currentTarget=ne;try{w(v)}catch(xe){Im(xe)}v.currentTarget=null,w=q}else for(k=0;k<p.length;k++){if(N=p[k],q=N.instance,ne=N.currentTarget,N=N.listener,q!==w&&v.isPropagationStopped())break e;w=N,v.currentTarget=ne;try{w(v)}catch(xe){Im(xe)}v.currentTarget=null,w=q}}}}function pt(i,o){var u=o[G];u===void 0&&(u=o[G]=new Set);var p=i+"__bubble";u.has(p)||(wS(o,i,2,!1),u.add(p))}function Z_(i,o,u){var p=0;o&&(p|=4),wS(u,i,p,o)}var Zm="_reactListening"+Math.random().toString(36).slice(2);function J_(i){if(!i[Zm]){i[Zm]=!0,Ye.forEach(function(u){u!=="selectionchange"&&(V3.has(u)||Z_(u,!1,i),Z_(u,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Zm]||(o[Zm]=!0,Z_("selectionchange",!1,o))}}function wS(i,o,u,p){switch(VS(o)){case 2:var v=mF;break;case 8:v=xF;break;default:v=fy}u=v.bind(null,o,u,i),v=void 0,!wv||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(v=!0),p?v!==void 0?i.addEventListener(o,u,{capture:!0,passive:v}):i.addEventListener(o,u,!0):v!==void 0?i.addEventListener(o,u,{passive:v}):i.addEventListener(o,u,!1)}function ey(i,o,u,p,v){var w=p;if(!(o&1)&&!(o&2)&&p!==null)e:for(;;){if(p===null)return;var k=p.tag;if(k===3||k===4){var N=p.stateNode.containerInfo;if(N===v||N.nodeType===8&&N.parentNode===v)break;if(k===4)for(k=p.return;k!==null;){var q=k.tag;if((q===3||q===4)&&(q=k.stateNode.containerInfo,q===v||q.nodeType===8&&q.parentNode===v))return;k=k.return}for(;N!==null;){if(k=ke(N),k===null)return;if(q=k.tag,q===5||q===6||q===26||q===27){p=w=k;continue e}N=N.parentNode}}p=p.return}PE(function(){var ne=w,xe=_v(u),Se=[];e:{var pe=ub.get(i);if(pe!==void 0){var ge=gm,He=i;switch(i){case"keypress":if(dm(u)===0)break e;case"keydown":case"keyup":ge=ID;break;case"focusin":He="focus",ge=Sv;break;case"focusout":He="blur",ge=Sv;break;case"beforeblur":case"afterblur":ge=Sv;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=UE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=SD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=HD;break;case sb:case ob:case lb:ge=CD;break;case cb:ge=jD;break;case"scroll":case"scrollend":ge=ED;break;case"wheel":ge=VD;break;case"copy":case"cut":case"paste":ge=OD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=zE;break;case"toggle":case"beforetoggle":ge=XD}var Ze=(o&4)!==0,lr=!Ze&&(i==="scroll"||i==="scrollend"),ie=Ze?pe!==null?pe+"Capture":null:pe;Ze=[];for(var re=ne,le;re!==null;){var Ae=re;if(le=Ae.stateNode,Ae=Ae.tag,Ae!==5&&Ae!==26&&Ae!==27||le===null||ie===null||(Ae=gd(re,ie),Ae!=null&&Ze.push(Qd(re,Ae,le))),lr)break;re=re.return}0<Ze.length&&(pe=new ge(pe,He,null,u,xe),Se.push({event:pe,listeners:Ze}))}}if(!(o&7)){e:{if(pe=i==="mouseover"||i==="pointerover",ge=i==="mouseout"||i==="pointerout",pe&&u!==vv&&(He=u.relatedTarget||u.fromElement)&&(ke(He)||He[j]))break e;if((ge||pe)&&(pe=xe.window===xe?xe:(pe=xe.ownerDocument)?pe.defaultView||pe.parentWindow:window,ge?(He=u.relatedTarget||u.toElement,ge=ne,He=He?ke(He):null,He!==null&&(lr=De(He),Ze=He.tag,He!==lr||Ze!==5&&Ze!==27&&Ze!==6)&&(He=null)):(ge=null,He=ne),ge!==He)){if(Ze=UE,Ae="onMouseLeave",ie="onMouseEnter",re="mouse",(i==="pointerout"||i==="pointerover")&&(Ze=zE,Ae="onPointerLeave",ie="onPointerEnter",re="pointer"),lr=ge==null?pe:Ne(ge),le=He==null?pe:Ne(He),pe=new Ze(Ae,re+"leave",ge,u,xe),pe.target=lr,pe.relatedTarget=le,Ae=null,ke(xe)===ne&&(Ze=new Ze(ie,re+"enter",He,u,xe),Ze.target=le,Ze.relatedTarget=lr,Ae=Ze),lr=Ae,ge&&He)t:{for(Ze=ge,ie=He,re=0,le=Ze;le;le=kh(le))re++;for(le=0,Ae=ie;Ae;Ae=kh(Ae))le++;for(;0<re-le;)Ze=kh(Ze),re--;for(;0<le-re;)ie=kh(ie),le--;for(;re--;){if(Ze===ie||ie!==null&&Ze===ie.alternate)break t;Ze=kh(Ze),ie=kh(ie)}Ze=null}else Ze=null;ge!==null&&AS(Se,pe,ge,Ze,!1),He!==null&&lr!==null&&AS(Se,lr,He,Ze,!0)}}e:{if(pe=ne?Ne(ne):window,ge=pe.nodeName&&pe.nodeName.toLowerCase(),ge==="select"||ge==="input"&&pe.type==="file")var Ue=WE;else if(qE(pe))if(KE)Ue=r3;else{Ue=e3;var ct=JD}else ge=pe.nodeName,!ge||ge.toLowerCase()!=="input"||pe.type!=="checkbox"&&pe.type!=="radio"?ne&&xv(ne.elementType)&&(Ue=WE):Ue=t3;if(Ue&&(Ue=Ue(i,ne))){YE(Se,Ue,u,xe);break e}ct&&ct(i,pe,ne),i==="focusout"&&ne&&pe.type==="number"&&ne.memoizedProps.value!=null&&mv(pe,"number",pe.value)}switch(ct=ne?Ne(ne):window,i){case"focusin":(qE(ct)||ct.contentEditable==="true")&&(ih=ct,Dv=ne,Ed=null);break;case"focusout":Ed=Dv=ih=null;break;case"mousedown":Fv=!0;break;case"contextmenu":case"mouseup":case"dragend":Fv=!1,ab(Se,u,xe);break;case"selectionchange":if(i3)break;case"keydown":case"keyup":ab(Se,u,xe)}var Ge;if(kv)e:{switch(i){case"compositionstart":var Xe="onCompositionStart";break e;case"compositionend":Xe="onCompositionEnd";break e;case"compositionupdate":Xe="onCompositionUpdate";break e}Xe=void 0}else ah?$E(i,u)&&(Xe="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(Xe="onCompositionStart");Xe&&(jE&&u.locale!=="ko"&&(ah||Xe!=="onCompositionStart"?Xe==="onCompositionEnd"&&ah&&(Ge=IE()):(Do=xe,Av="value"in Do?Do.value:Do.textContent,ah=!0)),ct=Jm(ne,Xe),0<ct.length&&(Xe=new HE(Xe,i,null,u,xe),Se.push({event:Xe,listeners:ct}),Ge?Xe.data=Ge:(Ge=XE(u),Ge!==null&&(Xe.data=Ge)))),(Ge=YD?WD(i,u):KD(i,u))&&(Xe=Jm(ne,"onBeforeInput"),0<Xe.length&&(ct=new HE("onBeforeInput","beforeinput",null,u,xe),Se.push({event:ct,listeners:Xe}),ct.data=Ge)),z3(Se,i,ne,u,xe)}yS(Se,o)})}function Qd(i,o,u){return{instance:i,listener:o,currentTarget:u}}function Jm(i,o){for(var u=o+"Capture",p=[];i!==null;){var v=i,w=v.stateNode;v=v.tag,v!==5&&v!==26&&v!==27||w===null||(v=gd(i,u),v!=null&&p.unshift(Qd(i,v,w)),v=gd(i,o),v!=null&&p.push(Qd(i,v,w))),i=i.return}return p}function kh(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function AS(i,o,u,p,v){for(var w=o._reactName,k=[];u!==null&&u!==p;){var N=u,q=N.alternate,ne=N.stateNode;if(N=N.tag,q!==null&&q===p)break;N!==5&&N!==26&&N!==27||ne===null||(q=ne,v?(ne=gd(u,w),ne!=null&&k.unshift(Qd(u,ne,q))):v||(ne=gd(u,w),ne!=null&&k.push(Qd(u,ne,q)))),u=u.return}k.length!==0&&i.push({event:o,listeners:k})}var $3=/\r\n?/g,X3=/\u0000|\uFFFD/g;function ES(i){return(typeof i=="string"?i:""+i).replace($3,`
`).replace(X3,"")}function bS(i,o){return o=ES(o),ES(i)===o}function e1(){}function Mt(i,o,u,p,v,w){switch(u){case"children":typeof p=="string"?o==="body"||o==="textarea"&&p===""||th(i,p):(typeof p=="number"||typeof p=="bigint")&&o!=="body"&&th(i,""+p);break;case"className":lm(i,"class",p);break;case"tabIndex":lm(i,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":lm(i,u,p);break;case"style":LE(i,p,w);break;case"data":if(o!=="object"){lm(i,"data",p);break}case"src":case"href":if(p===""&&(o!=="a"||u!=="href")){i.removeAttribute(u);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(u);break}p=hm(""+p),i.setAttribute(u,p);break;case"action":case"formAction":if(typeof p=="function"){i.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(u==="formAction"?(o!=="input"&&Mt(i,o,"name",v.name,v,null),Mt(i,o,"formEncType",v.formEncType,v,null),Mt(i,o,"formMethod",v.formMethod,v,null),Mt(i,o,"formTarget",v.formTarget,v,null)):(Mt(i,o,"encType",v.encType,v,null),Mt(i,o,"method",v.method,v,null),Mt(i,o,"target",v.target,v,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){i.removeAttribute(u);break}p=hm(""+p),i.setAttribute(u,p);break;case"onClick":p!=null&&(i.onclick=e1);break;case"onScroll":p!=null&&pt("scroll",i);break;case"onScrollEnd":p!=null&&pt("scrollend",i);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(u=p.__html,u!=null){if(v.children!=null)throw Error(r(60));i.innerHTML=u}}break;case"multiple":i.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":i.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){i.removeAttribute("xlink:href");break}u=hm(""+p),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(u,""+p):i.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(u,""):i.removeAttribute(u);break;case"capture":case"download":p===!0?i.setAttribute(u,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?i.setAttribute(u,p):i.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?i.setAttribute(u,p):i.removeAttribute(u);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?i.removeAttribute(u):i.setAttribute(u,p);break;case"popover":pt("beforetoggle",i),pt("toggle",i),Kn(i,"popover",p);break;case"xlinkActuate":Es(i,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Es(i,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Es(i,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Es(i,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Es(i,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Es(i,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Es(i,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Es(i,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Es(i,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":Kn(i,"is",p);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=wD.get(u)||u,Kn(i,u,p))}}function ty(i,o,u,p,v,w){switch(u){case"style":LE(i,p,w);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(r(61));if(u=p.__html,u!=null){if(v.children!=null)throw Error(r(60));i.innerHTML=u}}break;case"children":typeof p=="string"?th(i,p):(typeof p=="number"||typeof p=="bigint")&&th(i,""+p);break;case"onScroll":p!=null&&pt("scroll",i);break;case"onScrollEnd":p!=null&&pt("scrollend",i);break;case"onClick":p!=null&&(i.onclick=e1);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ut.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(v=u.endsWith("Capture"),o=u.slice(2,v?u.length-7:void 0),w=i[H]||null,w=w!=null?w[u]:null,typeof w=="function"&&i.removeEventListener(o,w,v),typeof p=="function")){typeof w!="function"&&w!==null&&(u in i?i[u]=null:i.hasAttribute(u)&&i.removeAttribute(u)),i.addEventListener(o,p,v);break e}u in i?i[u]=p:p===!0?i.setAttribute(u,""):Kn(i,u,p)}}}function Jr(i,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":pt("error",i),pt("load",i);var p=!1,v=!1,w;for(w in u)if(u.hasOwnProperty(w)){var k=u[w];if(k!=null)switch(w){case"src":p=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:Mt(i,o,w,k,u,null)}}v&&Mt(i,o,"srcSet",u.srcSet,u,null),p&&Mt(i,o,"src",u.src,u,null);return;case"input":pt("invalid",i);var N=w=k=v=null,q=null,ne=null;for(p in u)if(u.hasOwnProperty(p)){var xe=u[p];if(xe!=null)switch(p){case"name":v=xe;break;case"type":k=xe;break;case"checked":q=xe;break;case"defaultChecked":ne=xe;break;case"value":w=xe;break;case"defaultValue":N=xe;break;case"children":case"dangerouslySetInnerHTML":if(xe!=null)throw Error(r(137,o));break;default:Mt(i,o,p,xe,u,null)}}OE(i,w,N,q,ne,k,v,!1),cm(i);return;case"select":pt("invalid",i),p=k=w=null;for(v in u)if(u.hasOwnProperty(v)&&(N=u[v],N!=null))switch(v){case"value":w=N;break;case"defaultValue":k=N;break;case"multiple":p=N;default:Mt(i,o,v,N,u,null)}o=w,u=k,i.multiple=!!p,o!=null?eh(i,!!p,o,!1):u!=null&&eh(i,!!p,u,!0);return;case"textarea":pt("invalid",i),w=v=p=null;for(k in u)if(u.hasOwnProperty(k)&&(N=u[k],N!=null))switch(k){case"value":p=N;break;case"defaultValue":v=N;break;case"children":w=N;break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(r(91));break;default:Mt(i,o,k,N,u,null)}FE(i,p,v,w),cm(i);return;case"option":for(q in u)if(u.hasOwnProperty(q)&&(p=u[q],p!=null))switch(q){case"selected":i.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:Mt(i,o,q,p,u,null)}return;case"dialog":pt("cancel",i),pt("close",i);break;case"iframe":case"object":pt("load",i);break;case"video":case"audio":for(p=0;p<Kd.length;p++)pt(Kd[p],i);break;case"image":pt("error",i),pt("load",i);break;case"details":pt("toggle",i);break;case"embed":case"source":case"link":pt("error",i),pt("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ne in u)if(u.hasOwnProperty(ne)&&(p=u[ne],p!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:Mt(i,o,ne,p,u,null)}return;default:if(xv(o)){for(xe in u)u.hasOwnProperty(xe)&&(p=u[xe],p!==void 0&&ty(i,o,xe,p,u,void 0));return}}for(N in u)u.hasOwnProperty(N)&&(p=u[N],p!=null&&Mt(i,o,N,p,u,null))}function q3(i,o,u,p){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,w=null,k=null,N=null,q=null,ne=null,xe=null;for(ge in u){var Se=u[ge];if(u.hasOwnProperty(ge)&&Se!=null)switch(ge){case"checked":break;case"value":break;case"defaultValue":q=Se;default:p.hasOwnProperty(ge)||Mt(i,o,ge,null,p,Se)}}for(var pe in p){var ge=p[pe];if(Se=u[pe],p.hasOwnProperty(pe)&&(ge!=null||Se!=null))switch(pe){case"type":w=ge;break;case"name":v=ge;break;case"checked":ne=ge;break;case"defaultChecked":xe=ge;break;case"value":k=ge;break;case"defaultValue":N=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(r(137,o));break;default:ge!==Se&&Mt(i,o,pe,ge,p,Se)}}gv(i,k,N,q,ne,xe,w,v);return;case"select":ge=k=N=pe=null;for(w in u)if(q=u[w],u.hasOwnProperty(w)&&q!=null)switch(w){case"value":break;case"multiple":ge=q;default:p.hasOwnProperty(w)||Mt(i,o,w,null,p,q)}for(v in p)if(w=p[v],q=u[v],p.hasOwnProperty(v)&&(w!=null||q!=null))switch(v){case"value":pe=w;break;case"defaultValue":N=w;break;case"multiple":k=w;default:w!==q&&Mt(i,o,v,w,p,q)}o=N,u=k,p=ge,pe!=null?eh(i,!!u,pe,!1):!!p!=!!u&&(o!=null?eh(i,!!u,o,!0):eh(i,!!u,u?[]:"",!1));return;case"textarea":ge=pe=null;for(N in u)if(v=u[N],u.hasOwnProperty(N)&&v!=null&&!p.hasOwnProperty(N))switch(N){case"value":break;case"children":break;default:Mt(i,o,N,null,p,v)}for(k in p)if(v=p[k],w=u[k],p.hasOwnProperty(k)&&(v!=null||w!=null))switch(k){case"value":pe=v;break;case"defaultValue":ge=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(r(91));break;default:v!==w&&Mt(i,o,k,v,p,w)}DE(i,pe,ge);return;case"option":for(var He in u)if(pe=u[He],u.hasOwnProperty(He)&&pe!=null&&!p.hasOwnProperty(He))switch(He){case"selected":i.selected=!1;break;default:Mt(i,o,He,null,p,pe)}for(q in p)if(pe=p[q],ge=u[q],p.hasOwnProperty(q)&&pe!==ge&&(pe!=null||ge!=null))switch(q){case"selected":i.selected=pe&&typeof pe!="function"&&typeof pe!="symbol";break;default:Mt(i,o,q,pe,p,ge)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ze in u)pe=u[Ze],u.hasOwnProperty(Ze)&&pe!=null&&!p.hasOwnProperty(Ze)&&Mt(i,o,Ze,null,p,pe);for(ne in p)if(pe=p[ne],ge=u[ne],p.hasOwnProperty(ne)&&pe!==ge&&(pe!=null||ge!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(r(137,o));break;default:Mt(i,o,ne,pe,p,ge)}return;default:if(xv(o)){for(var lr in u)pe=u[lr],u.hasOwnProperty(lr)&&pe!==void 0&&!p.hasOwnProperty(lr)&&ty(i,o,lr,void 0,p,pe);for(xe in p)pe=p[xe],ge=u[xe],!p.hasOwnProperty(xe)||pe===ge||pe===void 0&&ge===void 0||ty(i,o,xe,pe,p,ge);return}}for(var ie in u)pe=u[ie],u.hasOwnProperty(ie)&&pe!=null&&!p.hasOwnProperty(ie)&&Mt(i,o,ie,null,p,pe);for(Se in p)pe=p[Se],ge=u[Se],!p.hasOwnProperty(Se)||pe===ge||pe==null&&ge==null||Mt(i,o,Se,pe,p,ge)}var ry=null,ny=null;function t1(i){return i.nodeType===9?i:i.ownerDocument}function SS(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function TS(i,o){if(i===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&o==="foreignObject"?0:i}function ay(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var iy=null;function Y3(){var i=window.event;return i&&i.type==="popstate"?i===iy?!1:(iy=i,!0):(iy=null,!1)}var kS=typeof setTimeout=="function"?setTimeout:void 0,W3=typeof clearTimeout=="function"?clearTimeout:void 0,CS=typeof Promise=="function"?Promise:void 0,K3=typeof queueMicrotask=="function"?queueMicrotask:typeof CS<"u"?function(i){return CS.resolve(null).then(i).catch(Q3)}:kS;function Q3(i){setTimeout(function(){throw i})}function sy(i,o){var u=o,p=0;do{var v=u.nextSibling;if(i.removeChild(u),v&&v.nodeType===8)if(u=v.data,u==="/$"){if(p===0){i.removeChild(v),i0(o);return}p--}else u!=="$"&&u!=="$?"&&u!=="$!"||p++;u=v}while(u);i0(o)}function oy(i){var o=i.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":oy(u),de(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}i.removeChild(u)}}function Z3(i,o,u,p){for(;i.nodeType===1;){var v=u;if(i.nodeName.toLowerCase()!==o.toLowerCase()){if(!p&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(p){if(!i[ue])switch(o){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(w=i.getAttribute("rel"),w==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(w!==v.rel||i.getAttribute("href")!==(v.href==null?null:v.href)||i.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||i.getAttribute("title")!==(v.title==null?null:v.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(w=i.getAttribute("src"),(w!==(v.src==null?null:v.src)||i.getAttribute("type")!==(v.type==null?null:v.type)||i.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&w&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(o==="input"&&i.type==="hidden"){var w=v.name==null?null:""+v.name;if(v.type==="hidden"&&i.getAttribute("name")===w)return i}else return i;if(i=gi(i.nextSibling),i===null)break}return null}function J3(i,o,u){if(o==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!u||(i=gi(i.nextSibling),i===null))return null;return i}function gi(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return i}function RS(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return i;o--}else u==="/$"&&o++}i=i.previousSibling}return null}function OS(i,o,u){switch(o=t1(u),i){case"html":if(i=o.documentElement,!i)throw Error(r(452));return i;case"head":if(i=o.head,!i)throw Error(r(453));return i;case"body":if(i=o.body,!i)throw Error(r(454));return i;default:throw Error(r(451))}}var qa=new Map,DS=new Set;function r1(i){return typeof i.getRootNode=="function"?i.getRootNode():i.ownerDocument}var Bs=X.d;X.d={f:eF,r:tF,D:rF,C:nF,L:aF,m:iF,X:oF,S:sF,M:lF};function eF(){var i=Bs.f(),o=Ym();return i||o}function tF(i){var o=Fe(i);o!==null&&o.tag===5&&o.type==="form"?a2(o):Bs.r(i)}var Ch=typeof document>"u"?null:document;function FS(i,o,u){var p=Ch;if(p&&typeof o=="string"&&o){var v=Ia(o);v='link[rel="'+i+'"][href="'+v+'"]',typeof u=="string"&&(v+='[crossorigin="'+u+'"]'),DS.has(v)||(DS.add(v),i={rel:i,crossOrigin:u,href:o},p.querySelector(v)===null&&(o=p.createElement("link"),Jr(o,"link",i),Oe(o),p.head.appendChild(o)))}}function rF(i){Bs.D(i),FS("dns-prefetch",i,null)}function nF(i,o){Bs.C(i,o),FS("preconnect",i,o)}function aF(i,o,u){Bs.L(i,o,u);var p=Ch;if(p&&i&&o){var v='link[rel="preload"][as="'+Ia(o)+'"]';o==="image"&&u&&u.imageSrcSet?(v+='[imagesrcset="'+Ia(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(v+='[imagesizes="'+Ia(u.imageSizes)+'"]')):v+='[href="'+Ia(i)+'"]';var w=v;switch(o){case"style":w=Rh(i);break;case"script":w=Oh(i)}qa.has(w)||(i=ee({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:i,as:o},u),qa.set(w,i),p.querySelector(v)!==null||o==="style"&&p.querySelector(Zd(w))||o==="script"&&p.querySelector(Jd(w))||(o=p.createElement("link"),Jr(o,"link",i),Oe(o),p.head.appendChild(o)))}}function iF(i,o){Bs.m(i,o);var u=Ch;if(u&&i){var p=o&&typeof o.as=="string"?o.as:"script",v='link[rel="modulepreload"][as="'+Ia(p)+'"][href="'+Ia(i)+'"]',w=v;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=Oh(i)}if(!qa.has(w)&&(i=ee({rel:"modulepreload",href:i},o),qa.set(w,i),u.querySelector(v)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Jd(w)))return}p=u.createElement("link"),Jr(p,"link",i),Oe(p),u.head.appendChild(p)}}}function sF(i,o,u){Bs.S(i,o,u);var p=Ch;if(p&&i){var v=Re(p).hoistableStyles,w=Rh(i);o=o||"default";var k=v.get(w);if(!k){var N={loading:0,preload:null};if(k=p.querySelector(Zd(w)))N.loading=5;else{i=ee({rel:"stylesheet",href:i,"data-precedence":o},u),(u=qa.get(w))&&ly(i,u);var q=k=p.createElement("link");Oe(q),Jr(q,"link",i),q._p=new Promise(function(ne,xe){q.onload=ne,q.onerror=xe}),q.addEventListener("load",function(){N.loading|=1}),q.addEventListener("error",function(){N.loading|=2}),N.loading|=4,n1(k,o,p)}k={type:"stylesheet",instance:k,count:1,state:N},v.set(w,k)}}}function oF(i,o){Bs.X(i,o);var u=Ch;if(u&&i){var p=Re(u).hoistableScripts,v=Oh(i),w=p.get(v);w||(w=u.querySelector(Jd(v)),w||(i=ee({src:i,async:!0},o),(o=qa.get(v))&&cy(i,o),w=u.createElement("script"),Oe(w),Jr(w,"link",i),u.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},p.set(v,w))}}function lF(i,o){Bs.M(i,o);var u=Ch;if(u&&i){var p=Re(u).hoistableScripts,v=Oh(i),w=p.get(v);w||(w=u.querySelector(Jd(v)),w||(i=ee({src:i,async:!0,type:"module"},o),(o=qa.get(v))&&cy(i,o),w=u.createElement("script"),Oe(w),Jr(w,"link",i),u.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},p.set(v,w))}}function MS(i,o,u,p){var v=(v=Rt.current)?r1(v):null;if(!v)throw Error(r(446));switch(i){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=Rh(u.href),u=Re(v).hoistableStyles,p=u.get(o),p||(p={type:"style",instance:null,count:0,state:null},u.set(o,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){i=Rh(u.href);var w=Re(v).hoistableStyles,k=w.get(i);if(k||(v=v.ownerDocument||v,k={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(i,k),(w=v.querySelector(Zd(i)))&&!w._p&&(k.instance=w,k.state.loading=5),qa.has(i)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},qa.set(i,u),w||cF(v,i,u,k.state))),o&&p===null)throw Error(r(528,""));return k}if(o&&p!==null)throw Error(r(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Oh(u),u=Re(v).hoistableScripts,p=u.get(o),p||(p={type:"script",instance:null,count:0,state:null},u.set(o,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,i))}}function Rh(i){return'href="'+Ia(i)+'"'}function Zd(i){return'link[rel="stylesheet"]['+i+"]"}function LS(i){return ee({},i,{"data-precedence":i.precedence,precedence:null})}function cF(i,o,u,p){i.querySelector('link[rel="preload"][as="style"]['+o+"]")?p.loading=1:(o=i.createElement("link"),p.preload=o,o.addEventListener("load",function(){return p.loading|=1}),o.addEventListener("error",function(){return p.loading|=2}),Jr(o,"link",u),Oe(o),i.head.appendChild(o))}function Oh(i){return'[src="'+Ia(i)+'"]'}function Jd(i){return"script[async]"+i}function NS(i,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var p=i.querySelector('style[data-href~="'+Ia(u.href)+'"]');if(p)return o.instance=p,Oe(p),p;var v=ee({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return p=(i.ownerDocument||i).createElement("style"),Oe(p),Jr(p,"style",v),n1(p,u.precedence,i),o.instance=p;case"stylesheet":v=Rh(u.href);var w=i.querySelector(Zd(v));if(w)return o.state.loading|=4,o.instance=w,Oe(w),w;p=LS(u),(v=qa.get(v))&&ly(p,v),w=(i.ownerDocument||i).createElement("link"),Oe(w);var k=w;return k._p=new Promise(function(N,q){k.onload=N,k.onerror=q}),Jr(w,"link",p),o.state.loading|=4,n1(w,u.precedence,i),o.instance=w;case"script":return w=Oh(u.src),(v=i.querySelector(Jd(w)))?(o.instance=v,Oe(v),v):(p=u,(v=qa.get(w))&&(p=ee({},u),cy(p,v)),i=i.ownerDocument||i,v=i.createElement("script"),Oe(v),Jr(v,"link",p),i.head.appendChild(v),o.instance=v);case"void":return null;default:throw Error(r(443,o.type))}else o.type==="stylesheet"&&!(o.state.loading&4)&&(p=o.instance,o.state.loading|=4,n1(p,u.precedence,i));return o.instance}function n1(i,o,u){for(var p=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=p.length?p[p.length-1]:null,w=v,k=0;k<p.length;k++){var N=p[k];if(N.dataset.precedence===o)w=N;else if(w!==v)break}w?w.parentNode.insertBefore(i,w.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(i,o.firstChild))}function ly(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.title==null&&(i.title=o.title)}function cy(i,o){i.crossOrigin==null&&(i.crossOrigin=o.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=o.referrerPolicy),i.integrity==null&&(i.integrity=o.integrity)}var a1=null;function PS(i,o,u){if(a1===null){var p=new Map,v=a1=new Map;v.set(u,p)}else v=a1,p=v.get(u),p||(p=new Map,v.set(u,p));if(p.has(i))return p;for(p.set(i,null),u=u.getElementsByTagName(i),v=0;v<u.length;v++){var w=u[v];if(!(w[ue]||w[P]||i==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var k=w.getAttribute(o)||"";k=i+k;var N=p.get(k);N?N.push(w):p.set(k,[w])}}return p}function IS(i,o,u){i=i.ownerDocument||i,i.head.insertBefore(u,o==="title"?i.querySelector("head > title"):null)}function uF(i,o,u){if(u===1||o.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return i=o.disabled,typeof o.precedence=="string"&&i==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function BS(i){return!(i.type==="stylesheet"&&!(i.state.loading&3))}var e0=null;function hF(){}function fF(i,o,u){if(e0===null)throw Error(r(475));var p=e0;if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&!(o.state.loading&4)){if(o.instance===null){var v=Rh(u.href),w=i.querySelector(Zd(v));if(w){i=w._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(p.count++,p=i1.bind(p),i.then(p,p)),o.state.loading|=4,o.instance=w,Oe(w);return}w=i.ownerDocument||i,u=LS(u),(v=qa.get(v))&&ly(u,v),w=w.createElement("link"),Oe(w);var k=w;k._p=new Promise(function(N,q){k.onload=N,k.onerror=q}),Jr(w,"link",u),o.instance=w}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(o,i),(i=o.state.preload)&&!(o.state.loading&3)&&(p.count++,o=i1.bind(p),i.addEventListener("load",o),i.addEventListener("error",o))}}function dF(){if(e0===null)throw Error(r(475));var i=e0;return i.stylesheets&&i.count===0&&uy(i,i.stylesheets),0<i.count?function(o){var u=setTimeout(function(){if(i.stylesheets&&uy(i,i.stylesheets),i.unsuspend){var p=i.unsuspend;i.unsuspend=null,p()}},6e4);return i.unsuspend=o,function(){i.unsuspend=null,clearTimeout(u)}}:null}function i1(){if(this.count--,this.count===0){if(this.stylesheets)uy(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var s1=null;function uy(i,o){i.stylesheets=null,i.unsuspend!==null&&(i.count++,s1=new Map,o.forEach(pF,i),s1=null,i1.call(i))}function pF(i,o){if(!(o.state.loading&4)){var u=s1.get(i);if(u)var p=u.get(null);else{u=new Map,s1.set(i,u);for(var v=i.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<v.length;w++){var k=v[w];(k.nodeName==="LINK"||k.getAttribute("media")!=="not all")&&(u.set(k.dataset.precedence,k),p=k)}p&&u.set(null,p)}v=o.instance,k=v.getAttribute("data-precedence"),w=u.get(k)||p,w===p&&u.set(null,v),u.set(k,v),this.count++,p=i1.bind(this),v.addEventListener("load",p),v.addEventListener("error",p),w?w.parentNode.insertBefore(v,w.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(v,i.firstChild)),o.state.loading|=4}}var t0={$$typeof:_,Provider:null,Consumer:null,_currentValue:K,_currentValue2:K,_threadCount:0};function gF(i,o,u,p,v,w,k,N){this.tag=1,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=dd(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dd(0),this.hiddenUpdates=dd(null),this.identifierPrefix=p,this.onUncaughtError=v,this.onCaughtError=w,this.onRecoverableError=k,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=N,this.incompleteTransitions=new Map}function US(i,o,u,p,v,w,k,N,q,ne,xe,Se){return i=new gF(i,o,u,k,N,q,ne,Se),o=1,w===!0&&(o|=24),w=$a(3,null,null,o),i.current=w,w.stateNode=i,o=jv(),o.refCount++,i.pooledCache=o,o.refCount++,w.memoizedState={element:p,isDehydrated:u,cache:o},A_(w),i}function HS(i){return i?(i=lh,i):lh}function zS(i,o,u,p,v,w){v=HS(v),p.context===null?p.context=v:p.pendingContext=v,p=Uo(o),p.payload={element:u},w=w===void 0?null:w,w!==null&&(p.callback=w),u=Ho(i,p,o),u!==null&&(Mn(u,i,o),Bd(u,i,o))}function jS(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<o?u:o}}function hy(i,o){jS(i,o),(i=i.alternate)&&jS(i,o)}function GS(i){if(i.tag===13){var o=Fo(i,67108864);o!==null&&Mn(o,i,67108864),hy(i,67108864)}}var o1=!0;function mF(i,o,u,p){var v=B.T;B.T=null;var w=X.p;try{X.p=2,fy(i,o,u,p)}finally{X.p=w,B.T=v}}function xF(i,o,u,p){var v=B.T;B.T=null;var w=X.p;try{X.p=8,fy(i,o,u,p)}finally{X.p=w,B.T=v}}function fy(i,o,u,p){if(o1){var v=dy(p);if(v===null)ey(i,o,p,l1,u),$S(i,p);else if(_F(v,i,o,u,p))p.stopPropagation();else if($S(i,p),o&4&&-1<vF.indexOf(i)){for(;v!==null;){var w=Fe(v);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var k=Na(w.pendingLanes);if(k!==0){var N=w;for(N.pendingLanes|=2,N.entangledLanes|=2;k;){var q=1<<31-On(k);N.entanglements[1]|=q,k&=~q}qi(w),!(rr&6)&&($m=Yt()+500,Wd(0))}}break;case 13:N=Fo(w,2),N!==null&&Mn(N,w,2),Ym(),hy(w,2)}if(w=dy(p),w===null&&ey(i,o,p,l1,u),w===v)break;v=w}v!==null&&p.stopPropagation()}else ey(i,o,p,null,u)}}function dy(i){return i=_v(i),py(i)}var l1=null;function py(i){if(l1=null,i=ke(i),i!==null){var o=De(i);if(o===null)i=null;else{var u=o.tag;if(u===13){if(i=ae(o),i!==null)return i;i=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return l1=i,null}function VS(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ui()){case hi:return 2;case Ro:return 8;case vr:case La:return 32;case rt:return 268435456;default:return 32}default:return 32}}var gy=!1,qo=null,Yo=null,Wo=null,r0=new Map,n0=new Map,Ko=[],vF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function $S(i,o){switch(i){case"focusin":case"focusout":qo=null;break;case"dragenter":case"dragleave":Yo=null;break;case"mouseover":case"mouseout":Wo=null;break;case"pointerover":case"pointerout":r0.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":n0.delete(o.pointerId)}}function a0(i,o,u,p,v,w){return i===null||i.nativeEvent!==w?(i={blockedOn:o,domEventName:u,eventSystemFlags:p,nativeEvent:w,targetContainers:[v]},o!==null&&(o=Fe(o),o!==null&&GS(o)),i):(i.eventSystemFlags|=p,o=i.targetContainers,v!==null&&o.indexOf(v)===-1&&o.push(v),i)}function _F(i,o,u,p,v){switch(o){case"focusin":return qo=a0(qo,i,o,u,p,v),!0;case"dragenter":return Yo=a0(Yo,i,o,u,p,v),!0;case"mouseover":return Wo=a0(Wo,i,o,u,p,v),!0;case"pointerover":var w=v.pointerId;return r0.set(w,a0(r0.get(w)||null,i,o,u,p,v)),!0;case"gotpointercapture":return w=v.pointerId,n0.set(w,a0(n0.get(w)||null,i,o,u,p,v)),!0}return!1}function XS(i){var o=ke(i.target);if(o!==null){var u=De(o);if(u!==null){if(o=u.tag,o===13){if(o=ae(u),o!==null){i.blockedOn=o,M(i.priority,function(){if(u.tag===13){var p=da(),v=Fo(u,p);v!==null&&Mn(v,u,p),hy(u,p)}});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function c1(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var u=dy(i.nativeEvent);if(u===null){u=i.nativeEvent;var p=new u.constructor(u.type,u);vv=p,u.target.dispatchEvent(p),vv=null}else return o=Fe(u),o!==null&&GS(o),i.blockedOn=u,!1;o.shift()}return!0}function qS(i,o,u){c1(i)&&u.delete(o)}function yF(){gy=!1,qo!==null&&c1(qo)&&(qo=null),Yo!==null&&c1(Yo)&&(Yo=null),Wo!==null&&c1(Wo)&&(Wo=null),r0.forEach(qS),n0.forEach(qS)}function u1(i,o){i.blockedOn===o&&(i.blockedOn=null,gy||(gy=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,yF)))}var h1=null;function YS(i){h1!==i&&(h1=i,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){h1===i&&(h1=null);for(var o=0;o<i.length;o+=3){var u=i[o],p=i[o+1],v=i[o+2];if(typeof p!="function"){if(py(p||u)===null)continue;break}var w=Fe(u);w!==null&&(i.splice(o,3),o-=3,a_(w,{pending:!0,data:v,method:u.method,action:p},p,v))}}))}function i0(i){function o(q){return u1(q,i)}qo!==null&&u1(qo,i),Yo!==null&&u1(Yo,i),Wo!==null&&u1(Wo,i),r0.forEach(o),n0.forEach(o);for(var u=0;u<Ko.length;u++){var p=Ko[u];p.blockedOn===i&&(p.blockedOn=null)}for(;0<Ko.length&&(u=Ko[0],u.blockedOn===null);)XS(u),u.blockedOn===null&&Ko.shift();if(u=(i.ownerDocument||i).$$reactFormReplay,u!=null)for(p=0;p<u.length;p+=3){var v=u[p],w=u[p+1],k=v[H]||null;if(typeof w=="function")k||YS(u);else if(k){var N=null;if(w&&w.hasAttribute("formAction")){if(v=w,k=w[H]||null)N=k.formAction;else if(py(v)!==null)continue}else N=k.action;typeof N=="function"?u[p+1]=N:(u.splice(p,3),p-=3),YS(u)}}}function my(i){this._internalRoot=i}f1.prototype.render=my.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(r(409));var u=o.current,p=da();zS(u,p,i,o,null,null)},f1.prototype.unmount=my.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;i.tag===0&&Sh(),zS(i.current,2,null,i,null,null),Ym(),o[j]=null}};function f1(i){this._internalRoot=i}f1.prototype.unstable_scheduleHydration=function(i){if(i){var o=om();i={blockedOn:null,target:i,priority:o};for(var u=0;u<Ko.length&&o!==0&&o<Ko[u].priority;u++);Ko.splice(u,0,i),u===0&&XS(i)}};var WS=t.version;if(WS!=="19.0.0")throw Error(r(527,WS,"19.0.0"));X.findDOMNode=function(i){var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=fe(o),i=i!==null?U(i):null,i=i===null?null:i.stateNode,i};var wF={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:B,findFiberByHostInstance:ke,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var d1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!d1.isDisabled&&d1.supportsFiber)try{$t=d1.inject(wF),fr=d1}catch{}}return o0.createRoot=function(i,o){if(!a(i))throw Error(r(299));var u=!1,p="",v=f2,w=d2,k=p2,N=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(v=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(k=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(N=o.unstable_transitionCallbacks)),o=US(i,1,!1,null,null,u,p,v,w,k,N,null),i[j]=o.current,J_(i.nodeType===8?i.parentNode:i),new my(o)},o0.hydrateRoot=function(i,o,u){if(!a(i))throw Error(r(299));var p=!1,v="",w=f2,k=d2,N=p2,q=null,ne=null;return u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(v=u.identifierPrefix),u.onUncaughtError!==void 0&&(w=u.onUncaughtError),u.onCaughtError!==void 0&&(k=u.onCaughtError),u.onRecoverableError!==void 0&&(N=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(q=u.unstable_transitionCallbacks),u.formState!==void 0&&(ne=u.formState)),o=US(i,1,!0,o,u??null,p,v,w,k,N,q,ne),o.context=HS(null),u=o.current,p=da(),v=Uo(p),v.callback=null,Ho(u,v,p),o.current.lanes=p,Kl(o,p),qi(o),i[j]=o.current,J_(i),new f1(o)},o0.version="19.0.0",o0}var sT;function NF(){if(sT)return yy.exports;sT=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),yy.exports=LF(),yy.exports}var PF=NF();const IF=kA(PF);var l0={},oT;function BF(){if(oT)return l0;oT=1,Object.defineProperty(l0,"__esModule",{value:!0}),l0.parse=l,l0.serialize=f;const n=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,e=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,s=(()=>{const x=function(){};return x.prototype=Object.create(null),x})();function l(x,_){const y=new s,A=x.length;if(A<2)return y;const E=(_==null?void 0:_.decode)||d;let b=0;do{const C=x.indexOf("=",b);if(C===-1)break;const S=x.indexOf(";",b),O=S===-1?A:S;if(C>O){b=x.lastIndexOf(";",C-1)+1;continue}const L=c(x,b,C),I=h(x,C,L),F=x.slice(L,I);if(y[F]===void 0){let W=c(x,C+1,O),B=h(x,O,W);const ee=E(x.slice(W,B));y[F]=ee}b=O+1}while(b<A);return y}function c(x,_,y){do{const A=x.charCodeAt(_);if(A!==32&&A!==9)return _}while(++_<y);return y}function h(x,_,y){for(;_>y;){const A=x.charCodeAt(--_);if(A!==32&&A!==9)return _+1}return y}function f(x,_,y){const A=(y==null?void 0:y.encode)||encodeURIComponent;if(!n.test(x))throw new TypeError(`argument name is invalid: ${x}`);const E=A(_);if(!t.test(E))throw new TypeError(`argument val is invalid: ${_}`);let b=x+"="+E;if(!y)return b;if(y.maxAge!==void 0){if(!Number.isInteger(y.maxAge))throw new TypeError(`option maxAge is invalid: ${y.maxAge}`);b+="; Max-Age="+y.maxAge}if(y.domain){if(!e.test(y.domain))throw new TypeError(`option domain is invalid: ${y.domain}`);b+="; Domain="+y.domain}if(y.path){if(!r.test(y.path))throw new TypeError(`option path is invalid: ${y.path}`);b+="; Path="+y.path}if(y.expires){if(!m(y.expires)||!Number.isFinite(y.expires.valueOf()))throw new TypeError(`option expires is invalid: ${y.expires}`);b+="; Expires="+y.expires.toUTCString()}if(y.httpOnly&&(b+="; HttpOnly"),y.secure&&(b+="; Secure"),y.partitioned&&(b+="; Partitioned"),y.priority)switch(typeof y.priority=="string"?y.priority.toLowerCase():void 0){case"low":b+="; Priority=Low";break;case"medium":b+="; Priority=Medium";break;case"high":b+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${y.priority}`)}if(y.sameSite)switch(typeof y.sameSite=="string"?y.sameSite.toLowerCase():y.sameSite){case!0:case"strict":b+="; SameSite=Strict";break;case"lax":b+="; SameSite=Lax";break;case"none":b+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${y.sameSite}`)}return b}function d(x){if(x.indexOf("%")===-1)return x;try{return decodeURIComponent(x)}catch{return x}}function m(x){return a.call(x)==="[object Date]"}return l0}BF();/**
 * react-router v7.1.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var lT="popstate";function UF(n={}){function t(r,a){let{pathname:s,search:l,hash:c}=r.location;return qy("",{pathname:s,search:l,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function e(r,a){return typeof a=="string"?a:rp(a)}return zF(t,e,null,n)}function Ir(n,t){if(n===!1||n===null||typeof n>"u")throw new Error(t)}function xs(n,t){if(!n){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function HF(){return Math.random().toString(36).substring(2,10)}function cT(n,t){return{usr:n.state,key:n.key,idx:t}}function qy(n,t,e=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof t=="string"?Hg(t):t,state:e,key:t&&t.key||r||HF()}}function rp({pathname:n="/",search:t="",hash:e=""}){return t&&t!=="?"&&(n+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(n+=e.charAt(0)==="#"?e:"#"+e),n}function Hg(n){let t={};if(n){let e=n.indexOf("#");e>=0&&(t.hash=n.substring(e),n=n.substring(0,e));let r=n.indexOf("?");r>=0&&(t.search=n.substring(r),n=n.substring(0,r)),n&&(t.pathname=n)}return t}function zF(n,t,e,r={}){let{window:a=document.defaultView,v5Compat:s=!1}=r,l=a.history,c="POP",h=null,f=d();f==null&&(f=0,l.replaceState({...l.state,idx:f},""));function d(){return(l.state||{idx:null}).idx}function m(){c="POP";let E=d(),b=E==null?null:E-f;f=E,h&&h({action:c,location:A.location,delta:b})}function x(E,b){c="PUSH";let C=qy(A.location,E,b);f=d()+1;let S=cT(C,f),O=A.createHref(C);try{l.pushState(S,"",O)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;a.location.assign(O)}s&&h&&h({action:c,location:A.location,delta:1})}function _(E,b){c="REPLACE";let C=qy(A.location,E,b);f=d();let S=cT(C,f),O=A.createHref(C);l.replaceState(S,"",O),s&&h&&h({action:c,location:A.location,delta:0})}function y(E){let b=a.location.origin!=="null"?a.location.origin:a.location.href,C=typeof E=="string"?E:rp(E);return C=C.replace(/ $/,"%20"),Ir(b,`No window.location.(origin|href) available to create URL for href: ${C}`),new URL(C,b)}let A={get action(){return c},get location(){return n(a,l)},listen(E){if(h)throw new Error("A history only accepts one active listener");return a.addEventListener(lT,m),h=E,()=>{a.removeEventListener(lT,m),h=null}},createHref(E){return t(a,E)},createURL:y,encodeLocation(E){let b=y(E);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:x,replace:_,go(E){return l.go(E)}};return A}function sC(n,t,e="/"){return jF(n,t,e,!1)}function jF(n,t,e,r){let a=typeof t=="string"?Hg(t):t,s=Hl(a.pathname||"/",e);if(s==null)return null;let l=oC(n);GF(l);let c=null;for(let h=0;c==null&&h<l.length;++h){let f=eM(s);c=ZF(l[h],f,r)}return c}function oC(n,t=[],e=[],r=""){let a=(s,l,c)=>{let h={relativePath:c===void 0?s.path||"":c,caseSensitive:s.caseSensitive===!0,childrenIndex:l,route:s};h.relativePath.startsWith("/")&&(Ir(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length));let f=_o([r,h.relativePath]),d=e.concat(h);s.children&&s.children.length>0&&(Ir(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),oC(s.children,t,d,f)),!(s.path==null&&!s.index)&&t.push({path:f,score:KF(f,s.index),routesMeta:d})};return n.forEach((s,l)=>{var c;if(s.path===""||!((c=s.path)!=null&&c.includes("?")))a(s,l);else for(let h of lC(s.path))a(s,l,h)}),t}function lC(n){let t=n.split("/");if(t.length===0)return[];let[e,...r]=t,a=e.endsWith("?"),s=e.replace(/\?$/,"");if(r.length===0)return a?[s,""]:[s];let l=lC(r.join("/")),c=[];return c.push(...l.map(h=>h===""?s:[s,h].join("/"))),a&&c.push(...l),c.map(h=>n.startsWith("/")&&h===""?"/":h)}function GF(n){n.sort((t,e)=>t.score!==e.score?e.score-t.score:QF(t.routesMeta.map(r=>r.childrenIndex),e.routesMeta.map(r=>r.childrenIndex)))}var VF=/^:[\w-]+$/,$F=3,XF=2,qF=1,YF=10,WF=-2,uT=n=>n==="*";function KF(n,t){let e=n.split("/"),r=e.length;return e.some(uT)&&(r+=WF),t&&(r+=XF),e.filter(a=>!uT(a)).reduce((a,s)=>a+(VF.test(s)?$F:s===""?qF:YF),r)}function QF(n,t){return n.length===t.length&&n.slice(0,-1).every((r,a)=>r===t[a])?n[n.length-1]-t[t.length-1]:0}function ZF(n,t,e=!1){let{routesMeta:r}=n,a={},s="/",l=[];for(let c=0;c<r.length;++c){let h=r[c],f=c===r.length-1,d=s==="/"?t:t.slice(s.length)||"/",m=hx({path:h.relativePath,caseSensitive:h.caseSensitive,end:f},d),x=h.route;if(!m&&f&&e&&!r[r.length-1].route.index&&(m=hx({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},d)),!m)return null;Object.assign(a,m.params),l.push({params:a,pathname:_o([s,m.pathname]),pathnameBase:aM(_o([s,m.pathnameBase])),route:x}),m.pathnameBase!=="/"&&(s=_o([s,m.pathnameBase]))}return l}function hx(n,t){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[e,r]=JF(n.path,n.caseSensitive,n.end),a=t.match(e);if(!a)return null;let s=a[0],l=s.replace(/(.)\/+$/,"$1"),c=a.slice(1);return{params:r.reduce((f,{paramName:d,isOptional:m},x)=>{if(d==="*"){let y=c[x]||"";l=s.slice(0,s.length-y.length).replace(/(.)\/+$/,"$1")}const _=c[x];return m&&!_?f[d]=void 0:f[d]=(_||"").replace(/%2F/g,"/"),f},{}),pathname:s,pathnameBase:l,pattern:n}}function JF(n,t=!1,e=!0){xs(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],a="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,c,h)=>(r.push({paramName:c,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),a+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?a+="\\/*$":n!==""&&n!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function eM(n){try{return n.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return xs(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),n}}function Hl(n,t){if(t==="/")return n;if(!n.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,r=n.charAt(e);return r&&r!=="/"?null:n.slice(e)||"/"}function tM(n,t="/"){let{pathname:e,search:r="",hash:a=""}=typeof n=="string"?Hg(n):n;return{pathname:e?e.startsWith("/")?e:rM(e,t):t,search:iM(r),hash:sM(a)}}function rM(n,t){let e=t.replace(/\/+$/,"").split("/");return n.split("/").forEach(a=>{a===".."?e.length>1&&e.pop():a!=="."&&e.push(a)}),e.length>1?e.join("/"):"/"}function by(n,t,e,r){return`Cannot include a '${n}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function nM(n){return n.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function cC(n){let t=nM(n);return t.map((e,r)=>r===t.length-1?e.pathname:e.pathnameBase)}function uC(n,t,e,r=!1){let a;typeof n=="string"?a=Hg(n):(a={...n},Ir(!a.pathname||!a.pathname.includes("?"),by("?","pathname","search",a)),Ir(!a.pathname||!a.pathname.includes("#"),by("#","pathname","hash",a)),Ir(!a.search||!a.search.includes("#"),by("#","search","hash",a)));let s=n===""||a.pathname==="",l=s?"/":a.pathname,c;if(l==null)c=e;else{let m=t.length-1;if(!r&&l.startsWith("..")){let x=l.split("/");for(;x[0]==="..";)x.shift(),m-=1;a.pathname=x.join("/")}c=m>=0?t[m]:"/"}let h=tM(a,c),f=l&&l!=="/"&&l.endsWith("/"),d=(s||l===".")&&e.endsWith("/");return!h.pathname.endsWith("/")&&(f||d)&&(h.pathname+="/"),h}var _o=n=>n.join("/").replace(/\/\/+/g,"/"),aM=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),iM=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,sM=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function oM(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var hC=["POST","PUT","PATCH","DELETE"];new Set(hC);var lM=["GET",...hC];new Set(lM);var ld=we.createContext(null);ld.displayName="DataRouter";var Qx=we.createContext(null);Qx.displayName="DataRouterState";var fC=we.createContext({isTransitioning:!1});fC.displayName="ViewTransition";var cM=we.createContext(new Map);cM.displayName="Fetchers";var uM=we.createContext(null);uM.displayName="Await";var ys=we.createContext(null);ys.displayName="Navigation";var Zx=we.createContext(null);Zx.displayName="Location";var ko=we.createContext({outlet:null,matches:[],isDataRoute:!1});ko.displayName="Route";var RA=we.createContext(null);RA.displayName="RouteError";function hM(n,{relative:t}={}){Ir(zg(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:r}=we.useContext(ys),{hash:a,pathname:s,search:l}=jg(n,{relative:t}),c=s;return e!=="/"&&(c=s==="/"?e:_o([e,s])),r.createHref({pathname:c,search:l,hash:a})}function zg(){return we.useContext(Zx)!=null}function Hu(){return Ir(zg(),"useLocation() may be used only in the context of a <Router> component."),we.useContext(Zx).location}var dC="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function pC(n){we.useContext(ys).static||we.useLayoutEffect(n)}function fM(){let{isDataRoute:n}=we.useContext(ko);return n?SM():dM()}function dM(){Ir(zg(),"useNavigate() may be used only in the context of a <Router> component.");let n=we.useContext(ld),{basename:t,navigator:e}=we.useContext(ys),{matches:r}=we.useContext(ko),{pathname:a}=Hu(),s=JSON.stringify(cC(r)),l=we.useRef(!1);return pC(()=>{l.current=!0}),we.useCallback((h,f={})=>{if(xs(l.current,dC),!l.current)return;if(typeof h=="number"){e.go(h);return}let d=uC(h,JSON.parse(s),a,f.relative==="path");n==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:_o([t,d.pathname])),(f.replace?e.replace:e.push)(d,f.state,f)},[t,e,s,a,n])}we.createContext(null);function jg(n,{relative:t}={}){let{matches:e}=we.useContext(ko),{pathname:r}=Hu(),a=JSON.stringify(cC(e));return we.useMemo(()=>uC(n,JSON.parse(a),r,t==="path"),[n,a,r,t])}function pM(n,t,e,r){Ir(zg(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=we.useContext(ys),{matches:s}=we.useContext(ko),l=s[s.length-1],c=l?l.params:{},h=l?l.pathname:"/",f=l?l.pathnameBase:"/",d=l&&l.route;{let b=d&&d.path||"";gC(h,!d||b.endsWith("*")||b.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${b}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${b}"> to <Route path="${b==="/"?"*":`${b}/*`}">.`)}let m=Hu(),x;x=m;let _=x.pathname||"/",y=_;if(f!=="/"){let b=f.replace(/^\//,"").split("/");y="/"+_.replace(/^\//,"").split("/").slice(b.length).join("/")}let A=sC(n,{pathname:y});return xs(d||A!=null,`No routes matched location "${x.pathname}${x.search}${x.hash}" `),xs(A==null||A[A.length-1].route.element!==void 0||A[A.length-1].route.Component!==void 0||A[A.length-1].route.lazy!==void 0,`Matched leaf route at location "${x.pathname}${x.search}${x.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),_M(A&&A.map(b=>Object.assign({},b,{params:Object.assign({},c,b.params),pathname:_o([f,a.encodeLocation?a.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?f:_o([f,a.encodeLocation?a.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),s,e,r)}function gM(){let n=bM(),t=oM(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),e=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",n),l=we.createElement(we.Fragment,null,we.createElement("p",null," Hey developer "),we.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",we.createElement("code",{style:s},"ErrorBoundary")," or"," ",we.createElement("code",{style:s},"errorElement")," prop on your route.")),we.createElement(we.Fragment,null,we.createElement("h2",null,"Unexpected Application Error!"),we.createElement("h3",{style:{fontStyle:"italic"}},t),e?we.createElement("pre",{style:a},e):null,l)}var mM=we.createElement(gM,null),xM=class extends we.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,t){return t.location!==n.location||t.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:t.error,location:t.location,revalidation:n.revalidation||t.revalidation}}componentDidCatch(n,t){console.error("React Router caught the following error during render",n,t)}render(){return this.state.error!==void 0?we.createElement(ko.Provider,{value:this.props.routeContext},we.createElement(RA.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function vM({routeContext:n,match:t,children:e}){let r=we.useContext(ld);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),we.createElement(ko.Provider,{value:n},e)}function _M(n,t=[],e=null,r=null){if(n==null){if(!e)return null;if(e.errors)n=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)n=e.matches;else return null}let a=n,s=e==null?void 0:e.errors;if(s!=null){let h=a.findIndex(f=>f.route.id&&(s==null?void 0:s[f.route.id])!==void 0);Ir(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let l=!1,c=-1;if(e)for(let h=0;h<a.length;h++){let f=a[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(c=h),f.route.id){let{loaderData:d,errors:m}=e,x=f.route.loader&&!d.hasOwnProperty(f.route.id)&&(!m||m[f.route.id]===void 0);if(f.route.lazy||x){l=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((h,f,d)=>{let m,x=!1,_=null,y=null;e&&(m=s&&f.route.id?s[f.route.id]:void 0,_=f.route.errorElement||mM,l&&(c<0&&d===0?(gC("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),x=!0,y=null):c===d&&(x=!0,y=f.route.hydrateFallbackElement||null)));let A=t.concat(a.slice(0,d+1)),E=()=>{let b;return m?b=_:x?b=y:f.route.Component?b=we.createElement(f.route.Component,null):f.route.element?b=f.route.element:b=h,we.createElement(vM,{match:f,routeContext:{outlet:h,matches:A,isDataRoute:e!=null},children:b})};return e&&(f.route.ErrorBoundary||f.route.errorElement||d===0)?we.createElement(xM,{location:e.location,revalidation:e.revalidation,component:_,error:m,children:E(),routeContext:{outlet:null,matches:A,isDataRoute:!0}}):E()},null)}function OA(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function yM(n){let t=we.useContext(ld);return Ir(t,OA(n)),t}function wM(n){let t=we.useContext(Qx);return Ir(t,OA(n)),t}function AM(n){let t=we.useContext(ko);return Ir(t,OA(n)),t}function DA(n){let t=AM(n),e=t.matches[t.matches.length-1];return Ir(e.route.id,`${n} can only be used on routes that contain a unique "id"`),e.route.id}function EM(){return DA("useRouteId")}function bM(){var r;let n=we.useContext(RA),t=wM("useRouteError"),e=DA("useRouteError");return n!==void 0?n:(r=t.errors)==null?void 0:r[e]}function SM(){let{router:n}=yM("useNavigate"),t=DA("useNavigate"),e=we.useRef(!1);return pC(()=>{e.current=!0}),we.useCallback(async(a,s={})=>{xs(e.current,dC),e.current&&(typeof a=="number"?n.navigate(a):await n.navigate(a,{fromRouteId:t,...s}))},[n,t])}var hT={};function gC(n,t,e){!t&&!hT[n]&&(hT[n]=!0,xs(!1,e))}we.memo(TM);function TM({routes:n,future:t,state:e}){return pM(n,void 0,e,t)}function kM({basename:n="/",children:t=null,location:e,navigationType:r="POP",navigator:a,static:s=!1}){Ir(!zg(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=n.replace(/^\/*/,"/"),c=we.useMemo(()=>({basename:l,navigator:a,static:s,future:{}}),[l,a,s]);typeof e=="string"&&(e=Hg(e));let{pathname:h="/",search:f="",hash:d="",state:m=null,key:x="default"}=e,_=we.useMemo(()=>{let y=Hl(h,l);return y==null?null:{location:{pathname:y,search:f,hash:d,state:m,key:x},navigationType:r}},[l,h,f,d,m,x,r]);return xs(_!=null,`<Router basename="${l}"> is not able to match the URL "${h}${f}${d}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:we.createElement(ys.Provider,{value:c},we.createElement(Zx.Provider,{children:t,value:_}))}var M1="get",L1="application/x-www-form-urlencoded";function Jx(n){return n!=null&&typeof n.tagName=="string"}function CM(n){return Jx(n)&&n.tagName.toLowerCase()==="button"}function RM(n){return Jx(n)&&n.tagName.toLowerCase()==="form"}function OM(n){return Jx(n)&&n.tagName.toLowerCase()==="input"}function DM(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function FM(n,t){return n.button===0&&(!t||t==="_self")&&!DM(n)}var p1=null;function MM(){if(p1===null)try{new FormData(document.createElement("form"),0),p1=!1}catch{p1=!0}return p1}var LM=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Sy(n){return n!=null&&!LM.has(n)?(xs(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${L1}"`),null):n}function NM(n,t){let e,r,a,s,l;if(RM(n)){let c=n.getAttribute("action");r=c?Hl(c,t):null,e=n.getAttribute("method")||M1,a=Sy(n.getAttribute("enctype"))||L1,s=new FormData(n)}else if(CM(n)||OM(n)&&(n.type==="submit"||n.type==="image")){let c=n.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=n.getAttribute("formaction")||c.getAttribute("action");if(r=h?Hl(h,t):null,e=n.getAttribute("formmethod")||c.getAttribute("method")||M1,a=Sy(n.getAttribute("formenctype"))||Sy(c.getAttribute("enctype"))||L1,s=new FormData(c,n),!MM()){let{name:f,type:d,value:m}=n;if(d==="image"){let x=f?`${f}.`:"";s.append(`${x}x`,"0"),s.append(`${x}y`,"0")}else f&&s.append(f,m)}}else{if(Jx(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=M1,r=null,a=L1,l=n}return s&&a==="text/plain"&&(l=s,s=void 0),{action:r,method:e.toLowerCase(),encType:a,formData:s,body:l}}function FA(n,t){if(n===!1||n===null||typeof n>"u")throw new Error(t)}async function PM(n,t){if(n.id in t)return t[n.id];try{let e=await import(n.module);return t[n.id]=e,e}catch(e){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function IM(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function BM(n,t,e){let r=await Promise.all(n.map(async a=>{let s=t.routes[a.route.id];if(s){let l=await PM(s,e);return l.links?l.links():[]}return[]}));return jM(r.flat(1).filter(IM).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function fT(n,t,e,r,a,s){let l=(h,f)=>e[f]?h.route.id!==e[f].route.id:!0,c=(h,f)=>{var d;return e[f].pathname!==h.pathname||((d=e[f].route.path)==null?void 0:d.endsWith("*"))&&e[f].params["*"]!==h.params["*"]};return s==="assets"?t.filter((h,f)=>l(h,f)||c(h,f)):s==="data"?t.filter((h,f)=>{var m;let d=r.routes[h.route.id];if(!d||!d.hasLoader)return!1;if(l(h,f)||c(h,f))return!0;if(h.route.shouldRevalidate){let x=h.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((m=e[0])==null?void 0:m.params)||{},nextUrl:new URL(n,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function UM(n,t){return HM(n.map(e=>{let r=t.routes[e.route.id];if(!r)return[];let a=[r.module];return r.imports&&(a=a.concat(r.imports)),a}).flat(1))}function HM(n){return[...new Set(n)]}function zM(n){let t={},e=Object.keys(n).sort();for(let r of e)t[r]=n[r];return t}function jM(n,t){let e=new Set;return new Set(t),n.reduce((r,a)=>{let s=JSON.stringify(zM(a));return e.has(s)||(e.add(s),r.push({key:s,link:a})),r},[])}function GM(n){let t=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return t.pathname==="/"?t.pathname="_root.data":t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function VM(){let n=we.useContext(ld);return FA(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function $M(){let n=we.useContext(Qx);return FA(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var MA=we.createContext(void 0);MA.displayName="FrameworkContext";function mC(){let n=we.useContext(MA);return FA(n,"You must render this element inside a <HydratedRouter> element"),n}function XM(n,t){let e=we.useContext(MA),[r,a]=we.useState(!1),[s,l]=we.useState(!1),{onFocus:c,onBlur:h,onMouseEnter:f,onMouseLeave:d,onTouchStart:m}=t,x=we.useRef(null);we.useEffect(()=>{if(n==="render"&&l(!0),n==="viewport"){let A=b=>{b.forEach(C=>{l(C.isIntersecting)})},E=new IntersectionObserver(A,{threshold:.5});return x.current&&E.observe(x.current),()=>{E.disconnect()}}},[n]),we.useEffect(()=>{if(r){let A=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(A)}}},[r]);let _=()=>{a(!0)},y=()=>{a(!1),l(!1)};return e?n!=="intent"?[s,x,{}]:[s,x,{onFocus:c0(c,_),onBlur:c0(h,y),onMouseEnter:c0(f,_),onMouseLeave:c0(d,y),onTouchStart:c0(m,_)}]:[!1,x,{}]}function c0(n,t){return e=>{n&&n(e),e.defaultPrevented||t(e)}}function qM({page:n,...t}){let{router:e}=VM(),r=we.useMemo(()=>sC(e.routes,n,e.basename),[e.routes,n,e.basename]);return r?we.createElement(WM,{page:n,matches:r,...t}):null}function YM(n){let{manifest:t,routeModules:e}=mC(),[r,a]=we.useState([]);return we.useEffect(()=>{let s=!1;return BM(n,t,e).then(l=>{s||a(l)}),()=>{s=!0}},[n,t,e]),r}function WM({page:n,matches:t,...e}){let r=Hu(),{manifest:a,routeModules:s}=mC(),{loaderData:l,matches:c}=$M(),h=we.useMemo(()=>fT(n,t,c,a,r,"data"),[n,t,c,a,r]),f=we.useMemo(()=>fT(n,t,c,a,r,"assets"),[n,t,c,a,r]),d=we.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let _=new Set,y=!1;if(t.forEach(E=>{var C;let b=a.routes[E.route.id];!b||!b.hasLoader||(!h.some(S=>S.route.id===E.route.id)&&E.route.id in l&&((C=s[E.route.id])!=null&&C.shouldRevalidate)||b.hasClientLoader?y=!0:_.add(E.route.id))}),_.size===0)return[];let A=GM(n);return y&&_.size>0&&A.searchParams.set("_routes",t.filter(E=>_.has(E.route.id)).map(E=>E.route.id).join(",")),[A.pathname+A.search]},[l,r,a,h,t,n,s]),m=we.useMemo(()=>UM(f,a),[f,a]),x=YM(f);return we.createElement(we.Fragment,null,d.map(_=>we.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...e})),m.map(_=>we.createElement("link",{key:_,rel:"modulepreload",href:_,...e})),x.map(({key:_,link:y})=>we.createElement("link",{key:_,...y})))}function KM(...n){return t=>{n.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var xC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{xC&&(window.__reactRouterVersion="7.1.3")}catch{}function QM({basename:n,children:t,window:e}){let r=we.useRef();r.current==null&&(r.current=UF({window:e,v5Compat:!0}));let a=r.current,[s,l]=we.useState({action:a.action,location:a.location}),c=we.useCallback(h=>{we.startTransition(()=>l(h))},[l]);return we.useLayoutEffect(()=>a.listen(c),[a,c]),we.createElement(kM,{basename:n,children:t,location:s.location,navigationType:s.action,navigator:a})}var vC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,_C=we.forwardRef(function({onClick:t,discover:e="render",prefetch:r="none",relative:a,reloadDocument:s,replace:l,state:c,target:h,to:f,preventScrollReset:d,viewTransition:m,...x},_){let{basename:y}=we.useContext(ys),A=typeof f=="string"&&vC.test(f),E,b=!1;if(typeof f=="string"&&A&&(E=f,xC))try{let B=new URL(window.location.href),ee=f.startsWith("//")?new URL(B.protocol+f):new URL(f),Z=Hl(ee.pathname,y);ee.origin===B.origin&&Z!=null?f=Z+ee.search+ee.hash:b=!0}catch{xs(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let C=hM(f,{relative:a}),[S,O,L]=XM(r,x),I=tL(f,{replace:l,state:c,target:h,preventScrollReset:d,relative:a,viewTransition:m});function F(B){t&&t(B),B.defaultPrevented||I(B)}let W=we.createElement("a",{...x,...L,href:E||C,onClick:b||s?t:F,ref:KM(_,O),target:h,"data-discover":!A&&e==="render"?"true":void 0});return S&&!A?we.createElement(we.Fragment,null,W,we.createElement(qM,{page:C})):W});_C.displayName="Link";var ZM=we.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:r="",end:a=!1,style:s,to:l,viewTransition:c,children:h,...f},d){let m=jg(l,{relative:f.relative}),x=Hu(),_=we.useContext(Qx),{navigator:y,basename:A}=we.useContext(ys),E=_!=null&&sL(m)&&c===!0,b=y.encodeLocation?y.encodeLocation(m).pathname:m.pathname,C=x.pathname,S=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;e||(C=C.toLowerCase(),S=S?S.toLowerCase():null,b=b.toLowerCase()),S&&A&&(S=Hl(S,A)||S);const O=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let L=C===b||!a&&C.startsWith(b)&&C.charAt(O)==="/",I=S!=null&&(S===b||!a&&S.startsWith(b)&&S.charAt(b.length)==="/"),F={isActive:L,isPending:I,isTransitioning:E},W=L?t:void 0,B;typeof r=="function"?B=r(F):B=[r,L?"active":null,I?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let ee=typeof s=="function"?s(F):s;return we.createElement(_C,{...f,"aria-current":W,className:B,ref:d,style:ee,to:l,viewTransition:c},typeof h=="function"?h(F):h)});ZM.displayName="NavLink";var JM=we.forwardRef(({discover:n="render",fetcherKey:t,navigate:e,reloadDocument:r,replace:a,state:s,method:l=M1,action:c,onSubmit:h,relative:f,preventScrollReset:d,viewTransition:m,...x},_)=>{let y=aL(),A=iL(c,{relative:f}),E=l.toLowerCase()==="get"?"get":"post",b=typeof c=="string"&&vC.test(c),C=S=>{if(h&&h(S),S.defaultPrevented)return;S.preventDefault();let O=S.nativeEvent.submitter,L=(O==null?void 0:O.getAttribute("formmethod"))||l;y(O||S.currentTarget,{fetcherKey:t,method:L,navigate:e,replace:a,state:s,relative:f,preventScrollReset:d,viewTransition:m})};return we.createElement("form",{ref:_,method:E,action:A,onSubmit:r?h:C,...x,"data-discover":!b&&n==="render"?"true":void 0})});JM.displayName="Form";function eL(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function yC(n){let t=we.useContext(ld);return Ir(t,eL(n)),t}function tL(n,{target:t,replace:e,state:r,preventScrollReset:a,relative:s,viewTransition:l}={}){let c=fM(),h=Hu(),f=jg(n,{relative:s});return we.useCallback(d=>{if(FM(d,t)){d.preventDefault();let m=e!==void 0?e:rp(h)===rp(f);c(n,{replace:m,state:r,preventScrollReset:a,relative:s,viewTransition:l})}},[h,c,f,e,r,t,n,a,s,l])}var rL=0,nL=()=>`__${String(++rL)}__`;function aL(){let{router:n}=yC("useSubmit"),{basename:t}=we.useContext(ys),e=EM();return we.useCallback(async(r,a={})=>{let{action:s,method:l,encType:c,formData:h,body:f}=NM(r,t);if(a.navigate===!1){let d=a.fetcherKey||nL();await n.fetch(d,e,a.action||s,{preventScrollReset:a.preventScrollReset,formData:h,body:f,formMethod:a.method||l,formEncType:a.encType||c,flushSync:a.flushSync})}else await n.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:h,body:f,formMethod:a.method||l,formEncType:a.encType||c,replace:a.replace,state:a.state,fromRouteId:e,flushSync:a.flushSync,viewTransition:a.viewTransition})},[n,t,e])}function iL(n,{relative:t}={}){let{basename:e}=we.useContext(ys),r=we.useContext(ko);Ir(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),s={...jg(n||".",{relative:t})},l=Hu();if(n==null){s.search=l.search;let c=new URLSearchParams(s.search),h=c.getAll("index");if(h.some(d=>d==="")){c.delete("index"),h.filter(m=>m).forEach(m=>c.append("index",m));let d=c.toString();s.search=d?`?${d}`:""}}return(!n||n===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(s.pathname=s.pathname==="/"?e:_o([e,s.pathname])),rp(s)}function sL(n,t={}){let e=we.useContext(fC);Ir(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=yC("useViewTransitionState"),a=jg(n,{relative:t.relative});if(!e.isTransitioning)return!1;let s=Hl(e.currentLocation.pathname,r)||e.currentLocation.pathname,l=Hl(e.nextLocation.pathname,r)||e.nextLocation.pathname;return hx(a.pathname,l)!=null||hx(a.pathname,s)!=null}new TextEncoder;const oL="modulepreload",lL=function(n){return"/"+n},dT={},ad=function(t,e,r){let a=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));a=Promise.allSettled(e.map(h=>{if(h=lL(h),h in dT)return;dT[h]=!0;const f=h.endsWith(".css"),d=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${d}`))return;const m=document.createElement("link");if(m.rel=f?"stylesheet":oL,f||(m.as="script"),m.crossOrigin="",m.href=h,c&&m.setAttribute("nonce",c),document.head.appendChild(m),f)return new Promise((x,_)=>{m.addEventListener("load",x),m.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${h}`)))})}))}function s(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return a.then(l=>{for(const c of l||[])c.status==="rejected"&&s(c.reason);return t().catch(s)})},cL=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...e)=>ad(async()=>{const{default:r}=await Promise.resolve().then(()=>cd);return{default:r}},[]).then(({default:r})=>r(...e)):t=fetch,(...e)=>t(...e)};class LA extends Error{constructor(t,e="FunctionsError",r){super(t),this.name=e,this.context=r}}class uL extends LA{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class hL extends LA{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class fL extends LA{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Yy;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Yy||(Yy={}));var dL=function(n,t,e,r){function a(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function c(d){try{f(r.next(d))}catch(m){l(m)}}function h(d){try{f(r.throw(d))}catch(m){l(m)}}function f(d){d.done?s(d.value):a(d.value).then(c,h)}f((r=r.apply(n,t||[])).next())})};class pL{constructor(t,{headers:e={},customFetch:r,region:a=Yy.Any}={}){this.url=t,this.headers=e,this.region=a,this.fetch=cL(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,e={}){var r;return dL(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:l}=e;let c={},{region:h}=e;h||(h=this.region),h&&h!=="any"&&(c["x-region"]=h);let f;l&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",f=l):typeof l=="string"?(c["Content-Type"]="text/plain",f=l):typeof FormData<"u"&&l instanceof FormData?f=l:(c["Content-Type"]="application/json",f=JSON.stringify(l)));const d=yield this.fetch(`${this.url}/${t}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),a),body:f}).catch(y=>{throw new uL(y)}),m=d.headers.get("x-relay-error");if(m&&m==="true")throw new hL(d);if(!d.ok)throw new fL(d);let x=((r=d.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),_;return x==="application/json"?_=yield d.json():x==="application/octet-stream"?_=yield d.blob():x==="text/event-stream"?_=d:x==="multipart/form-data"?_=yield d.formData():_=yield d.text(),{data:_,error:null}}catch(a){return{data:null,error:a}}})}}var en={},u0={},h0={},f0={},d0={},p0={},gL=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},id=gL();const mL=id.fetch,wC=id.fetch.bind(id),AC=id.Headers,xL=id.Request,vL=id.Response,cd=Object.freeze(Object.defineProperty({__proto__:null,Headers:AC,Request:xL,Response:vL,default:wC,fetch:mL},Symbol.toStringTag,{value:"Module"})),_L=SF(cd);var g1={},pT;function EC(){if(pT)return g1;pT=1,Object.defineProperty(g1,"__esModule",{value:!0});class n extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}return g1.default=n,g1}var gT;function bC(){if(gT)return p0;gT=1;var n=p0.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(p0,"__esModule",{value:!0});const t=n(_L),e=n(EC());class r{constructor(s){this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=s.headers,this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=s.shouldThrowOnError,this.signal=s.signal,this.isMaybeSingle=s.isMaybeSingle,s.fetch?this.fetch=s.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,l){return this.headers=Object.assign({},this.headers),this.headers[s]=l,this}then(s,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const c=this.fetch;let h=c(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async f=>{var d,m,x;let _=null,y=null,A=null,E=f.status,b=f.statusText;if(f.ok){if(this.method!=="HEAD"){const L=await f.text();L===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?y=L:y=JSON.parse(L))}const S=(d=this.headers.Prefer)===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),O=(m=f.headers.get("content-range"))===null||m===void 0?void 0:m.split("/");S&&O&&O.length>1&&(A=parseInt(O[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(y)&&(y.length>1?(_={code:"PGRST116",details:`Results contain ${y.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},y=null,A=null,E=406,b="Not Acceptable"):y.length===1?y=y[0]:y=null)}else{const S=await f.text();try{_=JSON.parse(S),Array.isArray(_)&&f.status===404&&(y=[],_=null,E=200,b="OK")}catch{f.status===404&&S===""?(E=204,b="No Content"):_={message:S}}if(_&&this.isMaybeSingle&&(!((x=_==null?void 0:_.details)===null||x===void 0)&&x.includes("0 rows"))&&(_=null,E=200,b="OK"),_&&this.shouldThrowOnError)throw new e.default(_)}return{error:_,data:y,count:A,status:E,statusText:b}});return this.shouldThrowOnError||(h=h.catch(f=>{var d,m,x;return{error:{message:`${(d=f==null?void 0:f.name)!==null&&d!==void 0?d:"FetchError"}: ${f==null?void 0:f.message}`,details:`${(m=f==null?void 0:f.stack)!==null&&m!==void 0?m:""}`,hint:"",code:`${(x=f==null?void 0:f.code)!==null&&x!==void 0?x:""}`},data:null,count:null,status:0,statusText:""}})),h.then(s,l)}}return p0.default=r,p0}var mT;function SC(){if(mT)return d0;mT=1;var n=d0.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(d0,"__esModule",{value:!0});const t=n(bC());class e extends t.default{select(a){let s=!1;const l=(a??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join("");return this.url.searchParams.set("select",l),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(a,{ascending:s=!0,nullsFirst:l,foreignTable:c,referencedTable:h=c}={}){const f=h?`${h}.order`:"order",d=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${d?`${d},`:""}${a}.${s?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:s,referencedTable:l=s}={}){const c=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${a}`),this}range(a,s,{foreignTable:l,referencedTable:c=l}={}){const h=typeof c>"u"?"offset":`${c}.offset`,f=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(h,`${a}`),this.url.searchParams.set(f,`${s-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:a=!1,verbose:s=!1,settings:l=!1,buffers:c=!1,wal:h=!1,format:f="text"}={}){var d;const m=[a?"analyze":null,s?"verbose":null,l?"settings":null,c?"buffers":null,h?"wal":null].filter(Boolean).join("|"),x=(d=this.headers.Accept)!==null&&d!==void 0?d:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${f}; for="${x}"; options=${m};`,f==="json"?this:this}rollback(){var a;return((a=this.headers.Prefer)!==null&&a!==void 0?a:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return d0.default=e,d0}var xT;function NA(){if(xT)return f0;xT=1;var n=f0.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(f0,"__esModule",{value:!0});const t=n(SC());class e extends t.default{eq(a,s){return this.url.searchParams.append(a,`eq.${s}`),this}neq(a,s){return this.url.searchParams.append(a,`neq.${s}`),this}gt(a,s){return this.url.searchParams.append(a,`gt.${s}`),this}gte(a,s){return this.url.searchParams.append(a,`gte.${s}`),this}lt(a,s){return this.url.searchParams.append(a,`lt.${s}`),this}lte(a,s){return this.url.searchParams.append(a,`lte.${s}`),this}like(a,s){return this.url.searchParams.append(a,`like.${s}`),this}likeAllOf(a,s){return this.url.searchParams.append(a,`like(all).{${s.join(",")}}`),this}likeAnyOf(a,s){return this.url.searchParams.append(a,`like(any).{${s.join(",")}}`),this}ilike(a,s){return this.url.searchParams.append(a,`ilike.${s}`),this}ilikeAllOf(a,s){return this.url.searchParams.append(a,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(a,s){return this.url.searchParams.append(a,`ilike(any).{${s.join(",")}}`),this}is(a,s){return this.url.searchParams.append(a,`is.${s}`),this}in(a,s){const l=Array.from(new Set(s)).map(c=>typeof c=="string"&&new RegExp("[,()]").test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,s){return typeof s=="string"?this.url.searchParams.append(a,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(a,`cs.{${s.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(s)}`),this}containedBy(a,s){return typeof s=="string"?this.url.searchParams.append(a,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(a,`cd.{${s.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(s)}`),this}rangeGt(a,s){return this.url.searchParams.append(a,`sr.${s}`),this}rangeGte(a,s){return this.url.searchParams.append(a,`nxl.${s}`),this}rangeLt(a,s){return this.url.searchParams.append(a,`sl.${s}`),this}rangeLte(a,s){return this.url.searchParams.append(a,`nxr.${s}`),this}rangeAdjacent(a,s){return this.url.searchParams.append(a,`adj.${s}`),this}overlaps(a,s){return typeof s=="string"?this.url.searchParams.append(a,`ov.${s}`):this.url.searchParams.append(a,`ov.{${s.join(",")}}`),this}textSearch(a,s,{config:l,type:c}={}){let h="";c==="plain"?h="pl":c==="phrase"?h="ph":c==="websearch"&&(h="w");const f=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${h}fts${f}.${s}`),this}match(a){return Object.entries(a).forEach(([s,l])=>{this.url.searchParams.append(s,`eq.${l}`)}),this}not(a,s,l){return this.url.searchParams.append(a,`not.${s}.${l}`),this}or(a,{foreignTable:s,referencedTable:l=s}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${a})`),this}filter(a,s,l){return this.url.searchParams.append(a,`${s}.${l}`),this}}return f0.default=e,f0}var vT;function TC(){if(vT)return h0;vT=1;var n=h0.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(h0,"__esModule",{value:!0});const t=n(NA());class e{constructor(a,{headers:s={},schema:l,fetch:c}){this.url=a,this.headers=s,this.schema=l,this.fetch=c}select(a,{head:s=!1,count:l}={}){const c=s?"HEAD":"GET";let h=!1;const f=(a??"*").split("").map(d=>/\s/.test(d)&&!h?"":(d==='"'&&(h=!h),d)).join("");return this.url.searchParams.set("select",f),l&&(this.headers.Prefer=`count=${l}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(a,{count:s,defaultToNull:l=!0}={}){const c="POST",h=[];if(this.headers.Prefer&&h.push(this.headers.Prefer),s&&h.push(`count=${s}`),l||h.push("missing=default"),this.headers.Prefer=h.join(","),Array.isArray(a)){const f=a.reduce((d,m)=>d.concat(Object.keys(m)),[]);if(f.length>0){const d=[...new Set(f)].map(m=>`"${m}"`);this.url.searchParams.set("columns",d.join(","))}}return new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}upsert(a,{onConflict:s,ignoreDuplicates:l=!1,count:c,defaultToNull:h=!0}={}){const f="POST",d=[`resolution=${l?"ignore":"merge"}-duplicates`];if(s!==void 0&&this.url.searchParams.set("on_conflict",s),this.headers.Prefer&&d.push(this.headers.Prefer),c&&d.push(`count=${c}`),h||d.push("missing=default"),this.headers.Prefer=d.join(","),Array.isArray(a)){const m=a.reduce((x,_)=>x.concat(Object.keys(_)),[]);if(m.length>0){const x=[...new Set(m)].map(_=>`"${_}"`);this.url.searchParams.set("columns",x.join(","))}}return new t.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}update(a,{count:s}={}){const l="PATCH",c=[];return this.headers.Prefer&&c.push(this.headers.Prefer),s&&c.push(`count=${s}`),this.headers.Prefer=c.join(","),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:this.fetch,allowEmpty:!1})}delete({count:a}={}){const s="DELETE",l=[];return a&&l.push(`count=${a}`),this.headers.Prefer&&l.unshift(this.headers.Prefer),this.headers.Prefer=l.join(","),new t.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return h0.default=e,h0}var g0={},m0={},_T;function yL(){return _T||(_T=1,Object.defineProperty(m0,"__esModule",{value:!0}),m0.version=void 0,m0.version="0.0.0-automated"),m0}var yT;function wL(){if(yT)return g0;yT=1,Object.defineProperty(g0,"__esModule",{value:!0}),g0.DEFAULT_HEADERS=void 0;const n=yL();return g0.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`},g0}var wT;function AL(){if(wT)return u0;wT=1;var n=u0.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(u0,"__esModule",{value:!0});const t=n(TC()),e=n(NA()),r=wL();class a{constructor(l,{headers:c={},schema:h,fetch:f}={}){this.url=l,this.headers=Object.assign(Object.assign({},r.DEFAULT_HEADERS),c),this.schemaName=h,this.fetch=f}from(l){const c=new URL(`${this.url}/${l}`);return new t.default(c,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new a(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:h=!1,get:f=!1,count:d}={}){let m;const x=new URL(`${this.url}/rpc/${l}`);let _;h||f?(m=h?"HEAD":"GET",Object.entries(c).filter(([A,E])=>E!==void 0).map(([A,E])=>[A,Array.isArray(E)?`{${E.join(",")}}`:`${E}`]).forEach(([A,E])=>{x.searchParams.append(A,E)})):(m="POST",_=c);const y=Object.assign({},this.headers);return d&&(y.Prefer=`count=${d}`),new e.default({method:m,url:x,headers:y,schema:this.schemaName,body:_,fetch:this.fetch,allowEmpty:!1})}}return u0.default=a,u0}var AT;function EL(){if(AT)return en;AT=1;var n=en.__importDefault||function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(en,"__esModule",{value:!0}),en.PostgrestError=en.PostgrestBuilder=en.PostgrestTransformBuilder=en.PostgrestFilterBuilder=en.PostgrestQueryBuilder=en.PostgrestClient=void 0;const t=n(AL());en.PostgrestClient=t.default;const e=n(TC());en.PostgrestQueryBuilder=e.default;const r=n(NA());en.PostgrestFilterBuilder=r.default;const a=n(SC());en.PostgrestTransformBuilder=a.default;const s=n(bC());en.PostgrestBuilder=s.default;const l=n(EC());return en.PostgrestError=l.default,en.default={PostgrestClient:t.default,PostgrestQueryBuilder:e.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:s.default,PostgrestError:l.default},en}var bL=EL();const SL=kA(bL),{PostgrestClient:TL,PostgrestQueryBuilder:fj,PostgrestFilterBuilder:dj,PostgrestTransformBuilder:pj,PostgrestBuilder:gj,PostgrestError:mj}=SL,kL="2.11.2",CL={"X-Client-Info":`realtime-js/${kL}`},RL="1.0.0",kC=1e4,OL=1e3;var Xh;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Xh||(Xh={}));var pa;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(pa||(pa={}));var Fi;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Fi||(Fi={}));var Wy;(function(n){n.websocket="websocket"})(Wy||(Wy={}));var Ac;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Ac||(Ac={}));class DL{constructor(){this.HEADER_LENGTH=1}decode(t,e){return t.constructor===ArrayBuffer?e(this._binaryDecode(t)):e(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const e=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,e,r)}_decodeBroadcast(t,e,r){const a=e.getUint8(1),s=e.getUint8(2);let l=this.HEADER_LENGTH+2;const c=r.decode(t.slice(l,l+a));l=l+a;const h=r.decode(t.slice(l,l+s));l=l+s;const f=JSON.parse(r.decode(t.slice(l,t.byteLength)));return{ref:null,topic:c,event:h,payload:f}}}class CC{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var jt;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(jt||(jt={}));const ET=(n,t,e={})=>{var r;const a=(r=e.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(t).reduce((s,l)=>(s[l]=FL(l,n,t,a),s),{})},FL=(n,t,e,r)=>{const a=t.find(c=>c.name===n),s=a==null?void 0:a.type,l=e[n];return s&&!r.includes(s)?RC(s,l):Ky(l)},RC=(n,t)=>{if(n.charAt(0)==="_"){const e=n.slice(1,n.length);return PL(t,e)}switch(n){case jt.bool:return ML(t);case jt.float4:case jt.float8:case jt.int2:case jt.int4:case jt.int8:case jt.numeric:case jt.oid:return LL(t);case jt.json:case jt.jsonb:return NL(t);case jt.timestamp:return IL(t);case jt.abstime:case jt.date:case jt.daterange:case jt.int4range:case jt.int8range:case jt.money:case jt.reltime:case jt.text:case jt.time:case jt.timestamptz:case jt.timetz:case jt.tsrange:case jt.tstzrange:return Ky(t);default:return Ky(t)}},Ky=n=>n,ML=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},LL=n=>{if(typeof n=="string"){const t=parseFloat(n);if(!Number.isNaN(t))return t}return n},NL=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(t){return console.log(`JSON parse error: ${t}`),n}return n},PL=(n,t)=>{if(typeof n!="string")return n;const e=n.length-1,r=n[e];if(n[0]==="{"&&r==="}"){let s;const l=n.slice(1,e);try{s=JSON.parse("["+l+"]")}catch{s=l?l.split(","):[]}return s.map(c=>RC(t,c))}return n},IL=n=>typeof n=="string"?n.replace(" ","T"):n,OC=n=>{let t=n;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Ty{constructor(t,e,r={},a=kC){this.channel=t,this.event=e,this.payload=r,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,e){var r;return this._hasReceived(t)&&e((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:e}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(e))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var bT;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(bT||(bT={}));class G0{constructor(t,e){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(e==null?void 0:e.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},a=>{const{onJoin:s,onLeave:l,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=G0.syncState(this.state,a,s,l),this.pendingDiffs.forEach(h=>{this.state=G0.syncDiff(this.state,h,s,l)}),this.pendingDiffs=[],c()}),this.channel._on(r.diff,{},a=>{const{onJoin:s,onLeave:l,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=G0.syncDiff(this.state,a,s,l),c())}),this.onJoin((a,s,l)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:l})}),this.onLeave((a,s,l)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,e,r,a){const s=this.cloneDeep(t),l=this.transformState(e),c={},h={};return this.map(s,(f,d)=>{l[f]||(h[f]=d)}),this.map(l,(f,d)=>{const m=s[f];if(m){const x=d.map(E=>E.presence_ref),_=m.map(E=>E.presence_ref),y=d.filter(E=>_.indexOf(E.presence_ref)<0),A=m.filter(E=>x.indexOf(E.presence_ref)<0);y.length>0&&(c[f]=y),A.length>0&&(h[f]=A)}else c[f]=d}),this.syncDiff(s,{joins:c,leaves:h},r,a)}static syncDiff(t,e,r,a){const{joins:s,leaves:l}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return r||(r=()=>{}),a||(a=()=>{}),this.map(s,(c,h)=>{var f;const d=(f=t[c])!==null&&f!==void 0?f:[];if(t[c]=this.cloneDeep(h),d.length>0){const m=t[c].map(_=>_.presence_ref),x=d.filter(_=>m.indexOf(_.presence_ref)<0);t[c].unshift(...x)}r(c,d,h)}),this.map(l,(c,h)=>{let f=t[c];if(!f)return;const d=h.map(m=>m.presence_ref);f=f.filter(m=>d.indexOf(m.presence_ref)<0),t[c]=f,a(c,f,h),f.length===0&&delete t[c]}),t}static map(t,e){return Object.getOwnPropertyNames(t).map(r=>e(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((e,r)=>{const a=t[r];return"metas"in a?e[r]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):e[r]=a,e},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ST;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(ST||(ST={}));var TT;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(TT||(TT={}));var js;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(js||(js={}));class PA{constructor(t,e={config:{}},r){this.topic=t,this.params=e,this.socket=r,this.bindings={},this.state=pa.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new Ty(this,Fi.join,this.params,this.timeout),this.rejoinTimer=new CC(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=pa.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=pa.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=pa.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=pa.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Fi.reply,{},(a,s)=>{this._trigger(this._replyEventName(s),a)}),this.presence=new G0(this),this.broadcastEndpointURL=OC(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,e=this.timeout){var r,a;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:l,private:c}}=this.params;this._onError(d=>t==null?void 0:t(js.CHANNEL_ERROR,d)),this._onClose(()=>t==null?void 0:t(js.CLOSED));const h={},f={broadcast:s,presence:l,postgres_changes:(a=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(d=>d.filter))!==null&&a!==void 0?a:[],private:c};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",async({postgres_changes:d})=>{var m;if(this.socket.setAuth(),d===void 0){t==null||t(js.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,_=(m=x==null?void 0:x.length)!==null&&m!==void 0?m:0,y=[];for(let A=0;A<_;A++){const E=x[A],{filter:{event:b,schema:C,table:S,filter:O}}=E,L=d&&d[A];if(L&&L.event===b&&L.schema===C&&L.table===S&&L.filter===O)y.push(Object.assign(Object.assign({},E),{id:L.id}));else{this.unsubscribe(),t==null||t(js.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,t&&t(js.SUBSCRIBED);return}}).receive("error",d=>{t==null||t(js.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(d).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(js.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,e={}){return await this.send({type:"presence",event:"track",payload:t},e.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,e,r){return this._on(t,e,r)}async send(t,e={}){var r,a;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:l}=t,h={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:l,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(r=e.timeout)!==null&&r!==void 0?r:this.timeout);return await((a=f.body)===null||a===void 0?void 0:a.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var l,c,h;const f=this._push(t.type,t,e.timeout||this.timeout);t.type==="broadcast"&&!(!((h=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||h===void 0)&&h.ack)&&s("ok"),f.receive("ok",()=>s("ok")),f.receive("error",()=>s("error")),f.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=pa.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Fi.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const a=new Ty(this,Fi.leave,{},t);a.receive("ok",()=>{e(),r("ok")}).receive("timeout",()=>{e(),r("timed out")}).receive("error",()=>{r("error")}),a.send(),this._canPush()||a.trigger("ok",{})})}async _fetchWithTimeout(t,e,r){const a=new AbortController,s=setTimeout(()=>a.abort(),r),l=await this.socket.fetch(t,Object.assign(Object.assign({},e),{signal:a.signal}));return clearTimeout(s),l}_push(t,e,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Ty(this,t,e,r);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(t,e,r){return e}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,e,r){var a,s;const l=t.toLocaleLowerCase(),{close:c,error:h,leave:f,join:d}=Fi;if(r&&[c,h,f,d].indexOf(l)>=0&&r!==this._joinRef())return;let x=this._onMessage(l,e,r);if(e&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(_=>{var y,A,E;return((y=_.filter)===null||y===void 0?void 0:y.event)==="*"||((E=(A=_.filter)===null||A===void 0?void 0:A.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===l}).map(_=>_.callback(x,r)):(s=this.bindings[l])===null||s===void 0||s.filter(_=>{var y,A,E,b,C,S;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in _){const O=_.id,L=(y=_.filter)===null||y===void 0?void 0:y.event;return O&&((A=e.ids)===null||A===void 0?void 0:A.includes(O))&&(L==="*"||(L==null?void 0:L.toLocaleLowerCase())===((E=e.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const O=(C=(b=_==null?void 0:_.filter)===null||b===void 0?void 0:b.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return O==="*"||O===((S=e==null?void 0:e.event)===null||S===void 0?void 0:S.toLocaleLowerCase())}else return _.type.toLocaleLowerCase()===l}).map(_=>{if(typeof x=="object"&&"ids"in x){const y=x.data,{schema:A,table:E,commit_timestamp:b,type:C,errors:S}=y;x=Object.assign(Object.assign({},{schema:A,table:E,commit_timestamp:b,eventType:C,new:{},old:{},errors:S}),this._getPayloadRecords(y))}_.callback(x,r)})}_isClosed(){return this.state===pa.closed}_isJoined(){return this.state===pa.joined}_isJoining(){return this.state===pa.joining}_isLeaving(){return this.state===pa.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,e,r){const a=t.toLocaleLowerCase(),s={type:a,filter:e,callback:r};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,e){const r=t.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&PA.isEqual(a.filter,e))}),this}static isEqual(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Fi.close,{},t)}_onError(t){this._on(Fi.error,{},e=>t(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=pa.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const e={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(e.new=ET(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(e.old=ET(t.columns,t.old_record)),e}}const BL=()=>{},UL=typeof WebSocket<"u",HL=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class zL{constructor(t,e){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=CL,this.params={},this.timeout=kC,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=BL,this.conn=null,this.sendBuffer=[],this.serializer=new DL,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let l;return s?l=s:typeof fetch>"u"?l=(...c)=>ad(async()=>{const{default:h}=await Promise.resolve().then(()=>cd);return{default:h}},void 0).then(({default:h})=>h(...c)):l=fetch,(...c)=>l(...c)},this.endPoint=`${t}/${Wy.websocket}`,this.httpEndpoint=OC(t),e!=null&&e.transport?this.transport=e.transport:this.transport=null,e!=null&&e.params&&(this.params=e.params),e!=null&&e.headers&&(this.headers=Object.assign(Object.assign({},this.headers),e.headers)),e!=null&&e.timeout&&(this.timeout=e.timeout),e!=null&&e.logger&&(this.logger=e.logger),e!=null&&e.heartbeatIntervalMs&&(this.heartbeatIntervalMs=e.heartbeatIntervalMs);const a=(r=e==null?void 0:e.params)===null||r===void 0?void 0:r.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=e!=null&&e.reconnectAfterMs?e.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=e!=null&&e.encode?e.encode:(s,l)=>l(JSON.stringify(s)),this.decode=e!=null&&e.decode?e.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new CC(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(e==null?void 0:e.fetch),e!=null&&e.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(e==null?void 0:e.worker)||!1,this.workerUrl=e==null?void 0:e.workerUrl}this.accessToken=(e==null?void 0:e.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(UL){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new jL(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),ad(async()=>{const{default:t}=await import("./browser-B56kzM9K.js").then(e=>e.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:RL}))}disconnect(t,e){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,e??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const e=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),e}async removeAllChannels(){const t=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.disconnect(),t}log(t,e,r){this.logger(t,e,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Xh.connecting:return Ac.Connecting;case Xh.open:return Ac.Open;case Xh.closing:return Ac.Closing;default:return Ac.Closed}}isConnected(){return this.connectionState()===Ac.Open}channel(t,e={config:{}}){const r=new PA(`realtime:${t}`,e,this);return this.channels.push(r),r}push(t){const{topic:e,event:r,payload:a,ref:s}=t,l=()=>{this.encode(t,c=>{var h;(h=this.conn)===null||h===void 0||h.send(c)})};this.log("push",`${e} ${r} (${s})`,a),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){let e=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(e){let r=null;try{r=JSON.parse(atob(e.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=e,this.channels.forEach(a=>{e&&a.updateJoinPayload({access_token:e}),a.joinedOnce&&a._isJoined()&&a._push(Fi.access_token,{access_token:e})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(OL,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let e=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${t}"`),e.unsubscribe())}_remove(t){this.channels=this.channels.filter(e=>e._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,e=>{let{topic:r,event:a,payload:s,ref:l}=e;l&&l===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${r} ${a} ${l&&"("+l+")"||""}`,s),this.channels.filter(c=>c._isMember(r)).forEach(c=>c._trigger(a,s,l)),this.stateChangeCallbacks.message.forEach(c=>c(e))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(e=>e(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(e=>e(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(Fi.error))}_appendParams(t,e){if(Object.keys(e).length===0)return t;const r=t.match(/\?/)?"&":"?",a=new URLSearchParams(e);return`${t}${r}${a}`}_workerObjectUrl(t){let e;if(t)e=t;else{const r=new Blob([HL],{type:"application/javascript"});e=URL.createObjectURL(r)}return e}}class jL{constructor(t,e,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Xh.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=r.close}}class IA extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Yr(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class GL extends IA{constructor(t,e){super(t),this.name="StorageApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Qy extends IA{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}}var VL=function(n,t,e,r){function a(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function c(d){try{f(r.next(d))}catch(m){l(m)}}function h(d){try{f(r.throw(d))}catch(m){l(m)}}function f(d){d.done?s(d.value):a(d.value).then(c,h)}f((r=r.apply(n,t||[])).next())})};const DC=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...e)=>ad(async()=>{const{default:r}=await Promise.resolve().then(()=>cd);return{default:r}},void 0).then(({default:r})=>r(...e)):t=fetch,(...e)=>t(...e)},$L=()=>VL(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ad(()=>Promise.resolve().then(()=>cd),void 0)).Response:Response}),Zy=n=>{if(Array.isArray(n))return n.map(e=>Zy(e));if(typeof n=="function"||n!==Object(n))return n;const t={};return Object.entries(n).forEach(([e,r])=>{const a=e.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=Zy(r)}),t};var zu=function(n,t,e,r){function a(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function c(d){try{f(r.next(d))}catch(m){l(m)}}function h(d){try{f(r.throw(d))}catch(m){l(m)}}function f(d){d.done?s(d.value):a(d.value).then(c,h)}f((r=r.apply(n,t||[])).next())})};const ky=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),XL=(n,t,e)=>zu(void 0,void 0,void 0,function*(){const r=yield $L();n instanceof r&&!(e!=null&&e.noResolveJson)?n.json().then(a=>{t(new GL(ky(a),n.status||500))}).catch(a=>{t(new Qy(ky(a),a))}):t(new Qy(ky(n),n))}),qL=(n,t,e,r)=>{const a={method:n,headers:(t==null?void 0:t.headers)||{}};return n==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),r&&(a.body=JSON.stringify(r)),Object.assign(Object.assign({},a),e))};function Gg(n,t,e,r,a,s){return zu(this,void 0,void 0,function*(){return new Promise((l,c)=>{n(e,qL(t,r,a,s)).then(h=>{if(!h.ok)throw h;return r!=null&&r.noResolveJson?h:h.json()}).then(h=>l(h)).catch(h=>XL(h,c,r))})})}function fx(n,t,e,r){return zu(this,void 0,void 0,function*(){return Gg(n,"GET",t,e,r)})}function rl(n,t,e,r,a){return zu(this,void 0,void 0,function*(){return Gg(n,"POST",t,r,a,e)})}function YL(n,t,e,r,a){return zu(this,void 0,void 0,function*(){return Gg(n,"PUT",t,r,a,e)})}function WL(n,t,e,r){return zu(this,void 0,void 0,function*(){return Gg(n,"HEAD",t,Object.assign(Object.assign({},e),{noResolveJson:!0}),r)})}function FC(n,t,e,r,a){return zu(this,void 0,void 0,function*(){return Gg(n,"DELETE",t,r,a,e)})}var Jn=function(n,t,e,r){function a(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function c(d){try{f(r.next(d))}catch(m){l(m)}}function h(d){try{f(r.throw(d))}catch(m){l(m)}}function f(d){d.done?s(d.value):a(d.value).then(c,h)}f((r=r.apply(n,t||[])).next())})};const KL={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},kT={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class QL{constructor(t,e={},r,a){this.url=t,this.headers=e,this.bucketId=r,this.fetch=DC(a)}uploadOrUpdate(t,e,r,a){return Jn(this,void 0,void 0,function*(){try{let s;const l=Object.assign(Object.assign({},kT),a);let c=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(l.upsert)});const h=l.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",l.cacheControl),h&&s.append("metadata",this.encodeMetadata(h)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",l.cacheControl),h&&s.append("metadata",this.encodeMetadata(h))):(s=r,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType,h&&(c["x-metadata"]=this.toBase64(this.encodeMetadata(h)))),a!=null&&a.headers&&(c=Object.assign(Object.assign({},c),a.headers));const f=this._removeEmptyFolders(e),d=this._getFinalPath(f),m=yield this.fetch(`${this.url}/object/${d}`,Object.assign({method:t,body:s,headers:c},l!=null&&l.duplex?{duplex:l.duplex}:{})),x=yield m.json();return m.ok?{data:{path:f,id:x.Id,fullPath:x.Key},error:null}:{data:null,error:x}}catch(s){if(Yr(s))return{data:null,error:s};throw s}})}upload(t,e,r){return Jn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,e,r)})}uploadToSignedUrl(t,e,r,a){return Jn(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),l=this._getFinalPath(s),c=new URL(this.url+`/object/upload/sign/${l}`);c.searchParams.set("token",e);try{let h;const f=Object.assign({upsert:kT.upsert},a),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&r instanceof Blob?(h=new FormData,h.append("cacheControl",f.cacheControl),h.append("",r)):typeof FormData<"u"&&r instanceof FormData?(h=r,h.append("cacheControl",f.cacheControl)):(h=r,d["cache-control"]=`max-age=${f.cacheControl}`,d["content-type"]=f.contentType);const m=yield this.fetch(c.toString(),{method:"PUT",body:h,headers:d}),x=yield m.json();return m.ok?{data:{path:s,fullPath:x.Key},error:null}:{data:null,error:x}}catch(h){if(Yr(h))return{data:null,error:h};throw h}})}createSignedUploadUrl(t,e){return Jn(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t);const a=Object.assign({},this.headers);e!=null&&e.upsert&&(a["x-upsert"]="true");const s=yield rl(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:a}),l=new URL(this.url+s.url),c=l.searchParams.get("token");if(!c)throw new IA("No token returned by API");return{data:{signedUrl:l.toString(),path:t,token:c},error:null}}catch(r){if(Yr(r))return{data:null,error:r};throw r}})}update(t,e,r){return Jn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,e,r)})}move(t,e,r){return Jn(this,void 0,void 0,function*(){try{return{data:yield rl(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Yr(a))return{data:null,error:a};throw a}})}copy(t,e,r){return Jn(this,void 0,void 0,function*(){try{return{data:{path:(yield rl(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Yr(a))return{data:null,error:a};throw a}})}createSignedUrl(t,e,r){return Jn(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),s=yield rl(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:e},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${l}`)},{data:s,error:null}}catch(a){if(Yr(a))return{data:null,error:a};throw a}})}createSignedUrls(t,e,r){return Jn(this,void 0,void 0,function*(){try{const a=yield rl(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:t},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${s}`):null})),error:null}}catch(a){if(Yr(a))return{data:null,error:a};throw a}})}download(t,e){return Jn(this,void 0,void 0,function*(){const a=typeof(e==null?void 0:e.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((e==null?void 0:e.transform)||{}),l=s?`?${s}`:"";try{const c=this._getFinalPath(t);return{data:yield(yield fx(this.fetch,`${this.url}/${a}/${c}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(c){if(Yr(c))return{data:null,error:c};throw c}})}info(t){return Jn(this,void 0,void 0,function*(){const e=this._getFinalPath(t);try{const r=yield fx(this.fetch,`${this.url}/object/info/${e}`,{headers:this.headers});return{data:Zy(r),error:null}}catch(r){if(Yr(r))return{data:null,error:r};throw r}})}exists(t){return Jn(this,void 0,void 0,function*(){const e=this._getFinalPath(t);try{return yield WL(this.fetch,`${this.url}/object/${e}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(Yr(r)&&r instanceof Qy){const a=r.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:r}}throw r}})}getPublicUrl(t,e){const r=this._getFinalPath(t),a=[],s=e!=null&&e.download?`download=${e.download===!0?"":e.download}`:"";s!==""&&a.push(s);const c=typeof(e==null?void 0:e.transform)<"u"?"render/image":"object",h=this.transformOptsToQueryString((e==null?void 0:e.transform)||{});h!==""&&a.push(h);let f=a.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${c}/public/${r}${f}`)}}}remove(t){return Jn(this,void 0,void 0,function*(){try{return{data:yield FC(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(e){if(Yr(e))return{data:null,error:e};throw e}})}list(t,e,r){return Jn(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},KL),e),{prefix:t||""});return{data:yield rl(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(Yr(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}}const ZL="2.7.1",JL={"X-Client-Info":`storage-js/${ZL}`};var Dh=function(n,t,e,r){function a(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function c(d){try{f(r.next(d))}catch(m){l(m)}}function h(d){try{f(r.throw(d))}catch(m){l(m)}}function f(d){d.done?s(d.value):a(d.value).then(c,h)}f((r=r.apply(n,t||[])).next())})};class eN{constructor(t,e={},r){this.url=t,this.headers=Object.assign(Object.assign({},JL),e),this.fetch=DC(r)}listBuckets(){return Dh(this,void 0,void 0,function*(){try{return{data:yield fx(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Yr(t))return{data:null,error:t};throw t}})}getBucket(t){return Dh(this,void 0,void 0,function*(){try{return{data:yield fx(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(e){if(Yr(e))return{data:null,error:e};throw e}})}createBucket(t,e={public:!1}){return Dh(this,void 0,void 0,function*(){try{return{data:yield rl(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Yr(r))return{data:null,error:r};throw r}})}updateBucket(t,e){return Dh(this,void 0,void 0,function*(){try{return{data:yield YL(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(Yr(r))return{data:null,error:r};throw r}})}emptyBucket(t){return Dh(this,void 0,void 0,function*(){try{return{data:yield rl(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(Yr(e))return{data:null,error:e};throw e}})}deleteBucket(t){return Dh(this,void 0,void 0,function*(){try{return{data:yield FC(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(Yr(e))return{data:null,error:e};throw e}})}}class tN extends eN{constructor(t,e={},r){super(t,e,r)}from(t){return new QL(this.url,this.headers,t,this.fetch)}}const rN="2.48.0";let A0="";typeof Deno<"u"?A0="deno":typeof document<"u"?A0="web":typeof navigator<"u"&&navigator.product==="ReactNative"?A0="react-native":A0="node";const nN={"X-Client-Info":`supabase-js-${A0}/${rN}`},aN={headers:nN},iN={schema:"public"},sN={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},oN={};var lN=function(n,t,e,r){function a(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function c(d){try{f(r.next(d))}catch(m){l(m)}}function h(d){try{f(r.throw(d))}catch(m){l(m)}}function f(d){d.done?s(d.value):a(d.value).then(c,h)}f((r=r.apply(n,t||[])).next())})};const cN=n=>{let t;return n?t=n:typeof fetch>"u"?t=wC:t=fetch,(...e)=>t(...e)},uN=()=>typeof Headers>"u"?AC:Headers,hN=(n,t,e)=>{const r=cN(e),a=uN();return(s,l)=>lN(void 0,void 0,void 0,function*(){var c;const h=(c=yield t())!==null&&c!==void 0?c:n;let f=new a(l==null?void 0:l.headers);return f.has("apikey")||f.set("apikey",n),f.has("Authorization")||f.set("Authorization",`Bearer ${h}`),r(s,Object.assign(Object.assign({},l),{headers:f}))})};var fN=function(n,t,e,r){function a(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function c(d){try{f(r.next(d))}catch(m){l(m)}}function h(d){try{f(r.throw(d))}catch(m){l(m)}}function f(d){d.done?s(d.value):a(d.value).then(c,h)}f((r=r.apply(n,t||[])).next())})};function dN(n){return n.replace(/\/$/,"")}function pN(n,t){const{db:e,auth:r,realtime:a,global:s}=n,{db:l,auth:c,realtime:h,global:f}=t,d={db:Object.assign(Object.assign({},l),e),auth:Object.assign(Object.assign({},c),r),realtime:Object.assign(Object.assign({},h),a),global:Object.assign(Object.assign({},f),s),accessToken:()=>fN(this,void 0,void 0,function*(){return""})};return n.accessToken?d.accessToken=n.accessToken:delete d.accessToken,d}const MC="2.67.3",gN="http://localhost:9999",mN="supabase.auth.token",xN={"X-Client-Info":`gotrue-js/${MC}`},CT=10,Jy="X-Supabase-Api-Version",LC={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function vN(n){return Math.round(Date.now()/1e3)+n}function _N(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const t=Math.random()*16|0;return(n=="x"?t:t&3|8).toString(16)})}const Qi=()=>typeof window<"u"&&typeof document<"u",xc={tested:!1,writable:!1},V0=()=>{if(!Qi())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(xc.tested)return xc.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),xc.tested=!0,xc.writable=!0}catch{xc.tested=!0,xc.writable=!1}return xc.writable};function yN(n){const t={},e=new URL(n);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return e.searchParams.forEach((r,a)=>{t[a]=r}),t}const NC=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...e)=>ad(async()=>{const{default:r}=await Promise.resolve().then(()=>cd);return{default:r}},void 0).then(({default:r})=>r(...e)):t=fetch,(...e)=>t(...e)},wN=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",PC=async(n,t,e)=>{await n.setItem(t,JSON.stringify(e))},m1=async(n,t)=>{const e=await n.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch{return e}},x1=async(n,t)=>{await n.removeItem(t)};function AN(n){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let e="",r,a,s,l,c,h,f,d=0;for(n=n.replace("-","+").replace("_","/");d<n.length;)l=t.indexOf(n.charAt(d++)),c=t.indexOf(n.charAt(d++)),h=t.indexOf(n.charAt(d++)),f=t.indexOf(n.charAt(d++)),r=l<<2|c>>4,a=(c&15)<<4|h>>2,s=(h&3)<<6|f,e=e+String.fromCharCode(r),h!=64&&a!=0&&(e=e+String.fromCharCode(a)),f!=64&&s!=0&&(e=e+String.fromCharCode(s));return e}class ev{constructor(){this.promise=new ev.promiseConstructor((t,e)=>{this.resolve=t,this.reject=e})}}ev.promiseConstructor=Promise;function RT(n){const t=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,e=n.split(".");if(e.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!t.test(e[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=e[1];return JSON.parse(AN(r))}async function EN(n){return await new Promise(t=>{setTimeout(()=>t(null),n)})}function bN(n,t){return new Promise((r,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const l=await n(s);if(!t(s,null,l)){r(l);return}}catch(l){if(!t(s,l)){a(l);return}}})()})}function SN(n){return("0"+n.toString(16)).substr(-2)}function TN(){const t=new Uint32Array(56);if(typeof crypto>"u"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=e.length;let a="";for(let s=0;s<56;s++)a+=e.charAt(Math.floor(Math.random()*r));return a}return crypto.getRandomValues(t),Array.from(t,SN).join("")}async function kN(n){const e=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",e),a=new Uint8Array(r);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}function CN(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function RN(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const e=await kN(n);return CN(e)}async function Fh(n,t,e=!1){const r=TN();let a=r;e&&(a+="/PASSWORD_RECOVERY"),await PC(n,`${t}-code-verifier`,a);const s=await RN(r);return[s,r===s?"plain":"s256"]}const ON=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function DN(n){const t=n.headers.get(Jy);if(!t||!t.match(ON))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}class BA extends Error{constructor(t,e,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=r}}function ot(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class FN extends BA{constructor(t,e,r){super(t,e,r),this.name="AuthApiError",this.status=e,this.code=r}}function MN(n){return ot(n)&&n.name==="AuthApiError"}class IC extends BA{constructor(t,e){super(t),this.name="AuthUnknownError",this.originalError=e}}class ju extends BA{constructor(t,e,r,a){super(t,r,a),this.name=e,this.status=r}}class Jo extends ju{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function LN(n){return ot(n)&&n.name==="AuthSessionMissingError"}class Cy extends ju{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class v1 extends ju{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class _1 extends ju{constructor(t,e=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function NN(n){return ot(n)&&n.name==="AuthImplicitGrantRedirectError"}class OT extends ju{constructor(t,e=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ew extends ju{constructor(t,e){super(t,"AuthRetryableFetchError",e,void 0)}}function Ry(n){return ot(n)&&n.name==="AuthRetryableFetchError"}class DT extends ju{constructor(t,e,r){super(t,"AuthWeakPasswordError",e,"weak_password"),this.reasons=r}}var PN=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(n);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(n,r[a])&&(e[r[a]]=n[r[a]]);return e};const vc=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),IN=[502,503,504];async function FT(n){var t;if(!wN(n))throw new ew(vc(n),0);if(IN.includes(n.status))throw new ew(vc(n),n.status);let e;try{e=await n.json()}catch(s){throw new IC(vc(s),s)}let r;const a=DN(n);if(a&&a.getTime()>=LC["2024-01-01"].timestamp&&typeof e=="object"&&e&&typeof e.code=="string"?r=e.code:typeof e=="object"&&e&&typeof e.error_code=="string"&&(r=e.error_code),r){if(r==="weak_password")throw new DT(vc(e),n.status,((t=e.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new Jo}else if(typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0))throw new DT(vc(e),n.status,e.weak_password.reasons);throw new FN(vc(e),n.status||500,r)}const BN=(n,t,e,r)=>{const a={method:n,headers:(t==null?void 0:t.headers)||{}};return n==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),e))};async function gt(n,t,e,r){var a;const s=Object.assign({},r==null?void 0:r.headers);s[Jy]||(s[Jy]=LC["2024-01-01"].name),r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const l=(a=r==null?void 0:r.query)!==null&&a!==void 0?a:{};r!=null&&r.redirectTo&&(l.redirect_to=r.redirectTo);const c=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",h=await UN(n,t,e+c,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(h):{data:Object.assign({},h),error:null}}async function UN(n,t,e,r,a,s){const l=BN(t,r,a,s);let c;try{c=await n(e,Object.assign({},l))}catch(h){throw console.error(h),new ew(vc(h),0)}if(c.ok||await FT(c),r!=null&&r.noResolveJson)return c;try{return await c.json()}catch(h){await FT(h)}}function el(n){var t;let e=null;GN(n)&&(e=Object.assign({},n),n.expires_at||(e.expires_at=vN(n.expires_in)));const r=(t=n.user)!==null&&t!==void 0?t:n;return{data:{session:e,user:r},error:null}}function MT(n){const t=el(n);return!t.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((e,r)=>e&&typeof r=="string",!0)&&(t.data.weak_password=n.weak_password),t}function nl(n){var t;return{data:{user:(t=n.user)!==null&&t!==void 0?t:n},error:null}}function HN(n){return{data:n,error:null}}function zN(n){const{action_link:t,email_otp:e,hashed_token:r,redirect_to:a,verification_type:s}=n,l=PN(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:t,email_otp:e,hashed_token:r,redirect_to:a,verification_type:s},h=Object.assign({},l);return{data:{properties:c,user:h},error:null}}function jN(n){return n}function GN(n){return n.access_token&&n.refresh_token&&n.expires_in}var VN=function(n,t){var e={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.indexOf(r)<0&&(e[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(n);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(n,r[a])&&(e[r[a]]=n[r[a]]);return e};class $N{constructor({url:t="",headers:e={},fetch:r}){this.url=t,this.headers=e,this.fetch=NC(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,e="global"){try{return await gt(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ot(r))return{data:null,error:r};throw r}}async inviteUserByEmail(t,e={}){try{return await gt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:nl})}catch(r){if(ot(r))return{data:{user:null},error:r};throw r}}async generateLink(t){try{const{options:e}=t,r=VN(t,["options"]),a=Object.assign(Object.assign({},r),e);return"newEmail"in r&&(a.new_email=r==null?void 0:r.newEmail,delete a.newEmail),await gt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:zN,redirectTo:e==null?void 0:e.redirectTo})}catch(e){if(ot(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(t){try{return await gt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:nl})}catch(e){if(ot(e))return{data:{user:null},error:e};throw e}}async listUsers(t){var e,r,a,s,l,c,h;try{const f={nextPage:null,lastPage:0,total:0},d=await gt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(e=t==null?void 0:t.page)===null||e===void 0?void 0:e.toString())!==null&&r!==void 0?r:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:jN});if(d.error)throw d.error;const m=await d.json(),x=(l=d.headers.get("x-total-count"))!==null&&l!==void 0?l:0,_=(h=(c=d.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&h!==void 0?h:[];return _.length>0&&(_.forEach(y=>{const A=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(y.split(";")[1].split("=")[1]);f[`${E}Page`]=A}),f.total=parseInt(x)),{data:Object.assign(Object.assign({},m),f),error:null}}catch(f){if(ot(f))return{data:{users:[]},error:f};throw f}}async getUserById(t){try{return await gt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:nl})}catch(e){if(ot(e))return{data:{user:null},error:e};throw e}}async updateUserById(t,e){try{return await gt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:e,headers:this.headers,xform:nl})}catch(r){if(ot(r))return{data:{user:null},error:r};throw r}}async deleteUser(t,e=!1){try{return await gt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:e},xform:nl})}catch(r){if(ot(r))return{data:{user:null},error:r};throw r}}async _listFactors(t){try{const{data:e,error:r}=await gt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:e,error:r}}catch(e){if(ot(e))return{data:null,error:e};throw e}}async _deleteFactor(t){try{return{data:await gt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(e){if(ot(e))return{data:null,error:e};throw e}}}const XN={getItem:n=>V0()?globalThis.localStorage.getItem(n):null,setItem:(n,t)=>{V0()&&globalThis.localStorage.setItem(n,t)},removeItem:n=>{V0()&&globalThis.localStorage.removeItem(n)}};function LT(n={}){return{getItem:t=>n[t]||null,setItem:(t,e)=>{n[t]=e},removeItem:t=>{delete n[t]}}}function qN(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Mh={debug:!!(globalThis&&V0()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class BC extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class YN extends BC{}async function WN(n,t,e){Mh.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),Mh.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async a=>{if(a){Mh.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,a.name);try{return await e()}finally{Mh.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,a.name)}}else{if(t===0)throw Mh.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new YN(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Mh.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await e()}}))}qN();const KN={url:gN,storageKey:mN,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:xN,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},x0=30*1e3,NT=3;async function PT(n,t,e){return await e()}class np{constructor(t){var e,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=np.nextInstanceID,np.nextInstanceID+=1,this.instanceID>0&&Qi()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},KN),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new $N({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=NC(a.fetch),this.lock=a.lock||PT,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Qi()&&(!((e=globalThis==null?void 0:globalThis.navigator)===null||e===void 0)&&e.locks)?this.lock=WN:this.lock=PT,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:V0()?this.storage=XN:(this.memoryStorage={},this.storage=LT(this.memoryStorage)):(this.memoryStorage={},this.storage=LT(this.memoryStorage)),Qi()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${MC}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const e=yN(window.location.href);let r="none";if(this._isImplicitGrantCallback(e)?r="implicit":await this._isPKCECallback(e)&&(r="pkce"),Qi()&&this.detectSessionInUrl&&r!=="none"){const{data:a,error:s}=await this._getSessionFromURL(e,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),NN(s)){const h=(t=s.details)===null||t===void 0?void 0:t.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:l,redirectType:c}=a;return this._debug("#_initialize()","detected session in URL",l,"redirect type",c),await this._saveSession(l),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return ot(e)?{error:e}:{error:new IC("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var e,r,a;try{const s=await gt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(e=t==null?void 0:t.options)===null||e===void 0?void 0:e.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:el}),{data:l,error:c}=s;if(c||!l)return{data:{user:null,session:null},error:c};const h=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:f,session:h},error:null}}catch(s){if(ot(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var e,r,a;try{let s;if("email"in t){const{email:d,password:m,options:x}=t;let _=null,y=null;this.flowType==="pkce"&&([_,y]=await Fh(this.storage,this.storageKey)),s=await gt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x==null?void 0:x.emailRedirectTo,body:{email:d,password:m,data:(e=x==null?void 0:x.data)!==null&&e!==void 0?e:{},gotrue_meta_security:{captcha_token:x==null?void 0:x.captchaToken},code_challenge:_,code_challenge_method:y},xform:el})}else if("phone"in t){const{phone:d,password:m,options:x}=t;s=await gt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:m,data:(r=x==null?void 0:x.data)!==null&&r!==void 0?r:{},channel:(a=x==null?void 0:x.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:x==null?void 0:x.captchaToken}},xform:el})}else throw new v1("You must provide either an email or phone number and a password");const{data:l,error:c}=s;if(c||!l)return{data:{user:null,session:null},error:c};const h=l.session,f=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:f,session:h},error:null}}catch(s){if(ot(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let e;if("email"in t){const{email:s,password:l,options:c}=t;e=await gt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:MT})}else if("phone"in t){const{phone:s,password:l,options:c}=t;e=await gt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:MT})}else throw new v1("You must provide either an email or phone number and a password");const{data:r,error:a}=e;return a?{data:{user:null,session:null},error:a}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Cy}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:a})}catch(e){if(ot(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(t){var e,r,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(e=t.options)===null||e===void 0?void 0:e.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const e=await m1(this.storage,`${this.storageKey}-code-verifier`),[r,a]=(e??"").split("/");try{const{data:s,error:l}=await gt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:el});if(await x1(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Cy}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:l})}catch(s){if(ot(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:e,provider:r,token:a,access_token:s,nonce:l}=t,c=await gt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:a,access_token:s,nonce:l,gotrue_meta_security:{captcha_token:e==null?void 0:e.captchaToken}},xform:el}),{data:h,error:f}=c;return f?{data:{user:null,session:null},error:f}:!h||!h.session||!h.user?{data:{user:null,session:null},error:new Cy}:(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),{data:h,error:f})}catch(e){if(ot(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(t){var e,r,a,s,l;try{if("email"in t){const{email:c,options:h}=t;let f=null,d=null;this.flowType==="pkce"&&([f,d]=await Fh(this.storage,this.storageKey));const{error:m}=await gt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(e=h==null?void 0:h.data)!==null&&e!==void 0?e:{},create_user:(r=h==null?void 0:h.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:f,code_challenge_method:d},redirectTo:h==null?void 0:h.emailRedirectTo});return{data:{user:null,session:null},error:m}}if("phone"in t){const{phone:c,options:h}=t,{data:f,error:d}=await gt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(a=h==null?void 0:h.data)!==null&&a!==void 0?a:{},create_user:(s=h==null?void 0:h.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},channel:(l=h==null?void 0:h.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:d}}throw new v1("You must provide either an email or phone number.")}catch(c){if(ot(c))return{data:{user:null,session:null},error:c};throw c}}async verifyOtp(t){var e,r;try{let a,s;"options"in t&&(a=(e=t.options)===null||e===void 0?void 0:e.redirectTo,s=(r=t.options)===null||r===void 0?void 0:r.captchaToken);const{data:l,error:c}=await gt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:el});if(c)throw c;if(!l)throw new Error("An error occurred on token verification.");const h=l.session,f=l.user;return h!=null&&h.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),{data:{user:f,session:h},error:null}}catch(a){if(ot(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var e,r,a;try{let s=null,l=null;return this.flowType==="pkce"&&([s,l]=await Fh(this.storage,this.storageKey)),await gt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(e=t.options)===null||e===void 0?void 0:e.redirectTo)!==null&&r!==void 0?r:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:l}),headers:this.headers,xform:HN})}catch(s){if(ot(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:e},error:r}=t;if(r)throw r;if(!e)throw new Jo;const{error:a}=await gt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:e.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(ot(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const e=`${this.url}/resend`;if("email"in t){const{email:r,type:a,options:s}=t,{error:l}=await gt(this.fetch,"POST",e,{headers:this.headers,body:{email:r,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in t){const{phone:r,type:a,options:s}=t,{data:l,error:c}=await gt(this.fetch,"POST",e,{headers:this.headers,body:{phone:r,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:c}}throw new v1("You must provide either an email or phone number and a type")}catch(e){if(ot(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(t,e){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await r,await e()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=e();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const e=await this.__loadSession();return await t(e)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const e=await m1(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",e),e!==null&&(this._isValidSession(e)?t=e:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const r=t.expires_at?t.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r){if(this.storage.isServer){let l=this.suppressGetSessionWarning;t=new Proxy(t,{get:(h,f,d)=>(!l&&f==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(h,f,d))})}return{data:{session:t},error:null}}const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await gt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:nl}):await this._useSession(async e=>{var r,a,s;const{data:l,error:c}=e;if(c)throw c;return!(!((r=l.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Jo}:await gt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:nl})})}catch(e){if(ot(e))return LN(e)&&(await this._removeSession(),await x1(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:e};throw e}}async updateUser(t,e={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,e))}async _updateUser(t,e={}){try{return await this._useSession(async r=>{const{data:a,error:s}=r;if(s)throw s;if(!a.session)throw new Jo;const l=a.session;let c=null,h=null;this.flowType==="pkce"&&t.email!=null&&([c,h]=await Fh(this.storage,this.storageKey));const{data:f,error:d}=await gt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:e==null?void 0:e.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:c,code_challenge_method:h}),jwt:l.access_token,xform:nl});if(d)throw d;return l.user=f.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(r){if(ot(r))return{data:{user:null},error:r};throw r}}_decodeJWT(t){return RT(t)}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Jo;const e=Date.now()/1e3;let r=e,a=!0,s=null;const l=RT(t.access_token);if(l.exp&&(r=l.exp,a=r<=e),a){const{session:c,error:h}=await this._callRefreshToken(t.refresh_token);if(h)return{data:{user:null,session:null},error:h};if(!c)return{data:{user:null,session:null},error:null};s=c}else{const{data:c,error:h}=await this._getUser(t.access_token);if(h)throw h;s={access_token:t.access_token,refresh_token:t.refresh_token,user:c.user,token_type:"bearer",expires_in:r-e,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(e){if(ot(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async e=>{var r;if(!t){const{data:l,error:c}=e;if(c)throw c;t=(r=l.session)!==null&&r!==void 0?r:void 0}if(!(t!=null&&t.refresh_token))throw new Jo;const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(ot(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(t,e){try{if(!Qi())throw new _1("No browser detected.");if(t.error||t.error_description||t.error_code)throw new _1(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(e){case"implicit":if(this.flowType==="pkce")throw new OT("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new _1("Not a valid implicit grant flow url.");break;default:}if(e==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new OT("No code detected.");const{data:C,error:S}=await this._exchangeCodeForSession(t.code);if(S)throw S;const O=new URL(window.location.href);return O.searchParams.delete("code"),window.history.replaceState(window.history.state,"",O.toString()),{data:{session:C.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:a,access_token:s,refresh_token:l,expires_in:c,expires_at:h,token_type:f}=t;if(!s||!c||!l||!f)throw new _1("No session defined in URL");const d=Math.round(Date.now()/1e3),m=parseInt(c);let x=d+m;h&&(x=parseInt(h));const _=x-d;_*1e3<=x0&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${_}s, should have been closer to ${m}s`);const y=x-m;d-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,x,d):d-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,x,d);const{data:A,error:E}=await this._getUser(s);if(E)throw E;const b={provider_token:r,provider_refresh_token:a,access_token:s,expires_in:m,expires_at:x,refresh_token:l,token_type:f,user:A.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:t.type},error:null}}catch(r){if(ot(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const e=await m1(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&e)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async e=>{var r;const{data:a,error:s}=e;if(s)return{error:s};const l=(r=a.session)===null||r===void 0?void 0:r.access_token;if(l){const{error:c}=await this.admin.signOut(l,t);if(c&&!(MN(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return t!=="others"&&(await this._removeSession(),await x1(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const e=_N(),r={id:e,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",e),this.stateChangeEmitters.delete(e)}};return this._debug("#onAuthStateChange()","registered callback with id",e),this.stateChangeEmitters.set(e,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(e)})))(),{data:{subscription:r}}}async _emitInitialSession(t){return await this._useSession(async e=>{var r,a;try{const{data:{session:s},error:l}=e;if(l)throw l;await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,e={}){let r=null,a=null;this.flowType==="pkce"&&([r,a]=await Fh(this.storage,this.storageKey,!0));try{return await gt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:a,gotrue_meta_security:{captcha_token:e.captchaToken}},headers:this.headers,redirectTo:e.redirectTo})}catch(s){if(ot(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:e,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(t=e.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(e){if(ot(e))return{data:null,error:e};throw e}}async linkIdentity(t){var e;try{const{data:r,error:a}=await this._useSession(async s=>{var l,c,h,f,d;const{data:m,error:x}=s;if(x)throw x;const _=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(c=t.options)===null||c===void 0?void 0:c.scopes,queryParams:(h=t.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await gt(this.fetch,"GET",_,{headers:this.headers,jwt:(d=(f=m.session)===null||f===void 0?void 0:f.access_token)!==null&&d!==void 0?d:void 0})});if(a)throw a;return Qi()&&!(!((e=t.options)===null||e===void 0)&&e.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:t.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(ot(r))return{data:{provider:t.provider,url:null},error:r};throw r}}async unlinkIdentity(t){try{return await this._useSession(async e=>{var r,a;const{data:s,error:l}=e;if(l)throw l;return await gt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&a!==void 0?a:void 0})})}catch(e){if(ot(e))return{data:null,error:e};throw e}}async _refreshAccessToken(t){const e=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(e,"begin");try{const r=Date.now();return await bN(async a=>(a>0&&await EN(200*Math.pow(2,a-1)),this._debug(e,"refreshing attempt",a),await gt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:el})),(a,s)=>{const l=200*Math.pow(2,a);return s&&Ry(s)&&Date.now()+l-r<x0})}catch(r){if(this._debug(e,"error",r),ot(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(e,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,e){const r=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",e,"url",r),Qi()&&!e.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}}async _recoverAndRefresh(){var t;const e="#_recoverAndRefresh()";this._debug(e,"begin");try{const r=await m1(this.storage,this.storageKey);if(this._debug(e,"session from storage",r),!this._isValidSession(r)){this._debug(e,"session is not valid"),r!==null&&await this._removeSession();return}const a=Math.round(Date.now()/1e3),s=((t=r.expires_at)!==null&&t!==void 0?t:1/0)<a+CT;if(this._debug(e,`session has${s?"":" not"} expired with margin of ${CT}s`),s){if(this.autoRefreshToken&&r.refresh_token){const{error:l}=await this._callRefreshToken(r.refresh_token);l&&(console.error(l),Ry(l)||(this._debug(e,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(e,"error",r),console.error(r);return}finally{this._debug(e,"end")}}async _callRefreshToken(t){var e,r;if(!t)throw new Jo;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new ev;const{data:s,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!s.session)throw new Jo;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const c={session:s.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(s){if(this._debug(a,"error",s),ot(s)){const l={session:null,error:s};return Ry(s)||await this._removeSession(),(e=this.refreshingDeferred)===null||e===void 0||e.resolve(l),l}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,e,r=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",e,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:e});const s=[],l=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(t,e)}catch(h){s.push(h)}});if(await Promise.all(l),s.length>0){for(let c=0;c<s.length;c+=1)console.error(s[c]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await PC(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await x1(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Qi()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),x0);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:r}}=e;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((r.expires_at*1e3-t)/x0);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${x0}ms, refresh threshold is ${NT} ticks`),a<=NT&&await this._callRefreshToken(r.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof BC)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Qi()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const e=`#_onVisibilityChanged(${t})`;this._debug(e,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(e,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,e,r){const a=[`provider=${encodeURIComponent(e)}`];if(r!=null&&r.redirectTo&&a.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&a.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,l]=await Fh(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(l)}`});a.push(c.toString())}if(r!=null&&r.queryParams){const s=new URLSearchParams(r.queryParams);a.push(s.toString())}return r!=null&&r.skipBrowserRedirect&&a.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async e=>{var r;const{data:a,error:s}=e;return s?{data:null,error:s}:await gt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(e){if(ot(e))return{data:null,error:e};throw e}}async _enroll(t){try{return await this._useSession(async e=>{var r,a;const{data:s,error:l}=e;if(l)return{data:null,error:l};const c=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:h,error:f}=await gt(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return f?{data:null,error:f}:(t.factorType==="totp"&&(!((a=h==null?void 0:h.totp)===null||a===void 0)&&a.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),{data:h,error:null})})}catch(e){if(ot(e))return{data:null,error:e};throw e}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var r;const{data:a,error:s}=e;if(s)return{data:null,error:s};const{data:l,error:c}=await gt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:c})})}catch(e){if(ot(e))return{data:null,error:e};throw e}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async e=>{var r;const{data:a,error:s}=e;return s?{data:null,error:s}:await gt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token})})}catch(e){if(ot(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(t){const{data:e,error:r}=await this._challenge({factorId:t.factorId});return r?{data:null,error:r}:await this._verify({factorId:t.factorId,challengeId:e.id,code:t.code})}async _listFactors(){const{data:{user:t},error:e}=await this.getUser();if(e)return{data:null,error:e};const r=(t==null?void 0:t.factors)||[],a=r.filter(l=>l.factor_type==="totp"&&l.status==="verified"),s=r.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:r,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var e,r;const{data:{session:a},error:s}=t;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const l=this._decodeJWT(a.access_token);let c=null;l.aal&&(c=l.aal);let h=c;((r=(e=a.user.factors)===null||e===void 0?void 0:e.filter(m=>m.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(h="aal2");const d=l.amr||[];return{data:{currentLevel:c,nextLevel:h,currentAuthenticationMethods:d},error:null}}))}}np.nextInstanceID=0;const QN=np;class ZN extends QN{constructor(t){super(t)}}var JN=function(n,t,e,r){function a(s){return s instanceof e?s:new e(function(l){l(s)})}return new(e||(e=Promise))(function(s,l){function c(d){try{f(r.next(d))}catch(m){l(m)}}function h(d){try{f(r.throw(d))}catch(m){l(m)}}function f(d){d.done?s(d.value):a(d.value).then(c,h)}f((r=r.apply(n,t||[])).next())})};class eP{constructor(t,e,r){var a,s,l;if(this.supabaseUrl=t,this.supabaseKey=e,!t)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");const c=dN(t);this.realtimeUrl=`${c}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${c}/auth/v1`,this.storageUrl=`${c}/storage/v1`,this.functionsUrl=`${c}/functions/v1`;const h=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,f={db:iN,realtime:oN,auth:Object.assign(Object.assign({},sN),{storageKey:h}),global:aN},d=pN(r??{},f);this.storageKey=(a=d.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=d.global.headers)!==null&&s!==void 0?s:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(m,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=d.auth)!==null&&l!==void 0?l:{},this.headers,d.global.fetch),this.fetch=hN(e,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new TL(`${c}/rest/v1`,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new pL(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new tN(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},r={}){return this.rest.rpc(t,e,r)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,e;return JN(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(e=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:a,storageKey:s,flowType:l,lock:c,debug:h},f,d){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ZN({url:this.authUrl,headers:Object.assign(Object.assign({},m),f),storageKey:s,autoRefreshToken:t,persistSession:e,detectSessionInUrl:r,storage:a,flowType:l,lock:c,debug:h,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new zL(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,r)=>{this._handleTokenChanged(e,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(t,e,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const UC=(n,t,e)=>new eP(n,t,e);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var HC=1252,tP=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],UA={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},HA=function(n){tP.indexOf(n)!=-1&&(HC=UA[0]=n)};function rP(){HA(1252)}var Li=function(n){HA(n)};function zC(){Li(1200),rP()}function IT(n){for(var t=[],e=0,r=n.length;e<r;++e)t[e]=n.charCodeAt(e);return t}function nP(n){for(var t=[],e=0;e<n.length>>1;++e)t[e]=String.fromCharCode(n.charCodeAt(2*e)+(n.charCodeAt(2*e+1)<<8));return t.join("")}function jC(n){for(var t=[],e=0;e<n.length>>1;++e)t[e]=String.fromCharCode(n.charCodeAt(2*e+1)+(n.charCodeAt(2*e)<<8));return t.join("")}var E0=function(n){var t=n.charCodeAt(0),e=n.charCodeAt(1);return t==255&&e==254?nP(n.slice(2)):t==254&&e==255?jC(n.slice(2)):t==65279?n.slice(1):n},y1=function(t){return String.fromCharCode(t)},BT=function(t){return String.fromCharCode(t)},tw,Pl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function UT(n){for(var t="",e=0,r=0,a=0,s=0,l=0,c=0,h=0,f=0;f<n.length;)e=n.charCodeAt(f++),s=e>>2,r=n.charCodeAt(f++),l=(e&3)<<4|r>>4,a=n.charCodeAt(f++),c=(r&15)<<2|a>>6,h=a&63,isNaN(r)?c=h=64:isNaN(a)&&(h=64),t+=Pl.charAt(s)+Pl.charAt(l)+Pl.charAt(c)+Pl.charAt(h);return t}function Ma(n){var t="",e=0,r=0,a=0,s=0,l=0,c=0,h=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<n.length;)s=Pl.indexOf(n.charAt(f++)),l=Pl.indexOf(n.charAt(f++)),e=s<<2|l>>4,t+=String.fromCharCode(e),c=Pl.indexOf(n.charAt(f++)),r=(l&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(r)),h=Pl.indexOf(n.charAt(f++)),a=(c&3)<<6|h,h!==64&&(t+=String.fromCharCode(a));return t}var xt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Gu=function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(t,e){return e?new Buffer(t,e):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function zl(n){return xt?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function HT(n){return xt?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var Mi=function(t){return xt?Gu(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)&255})};function Vu(n){if(Array.isArray(n))return n.map(function(r){return String.fromCharCode(r)}).join("");for(var t=[],e=0;e<n.length;++e)t[e]=String.fromCharCode(n[e]);return t.join("")}function zA(n){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(n instanceof ArrayBuffer)return zA(new Uint8Array(n));for(var t=new Array(n.length),e=0;e<n.length;++e)t[e]=n[e];return t}var al=xt?function(n){return Buffer.concat(n.map(function(t){return Buffer.isBuffer(t)?t:Gu(t)}))}:function(n){if(typeof Uint8Array<"u"){var t=0,e=0;for(t=0;t<n.length;++t)e+=n[t].length;var r=new Uint8Array(e),a=0;for(t=0,e=0;t<n.length;e+=a,++t)if(a=n[t].length,n[t]instanceof Uint8Array)r.set(n[t],e);else{if(typeof n[t]=="string")throw"wtf";r.set(new Uint8Array(n[t]),e)}return r}return[].concat.apply([],n.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function aP(n){for(var t=[],e=0,r=n.length+250,a=zl(n.length+255),s=0;s<n.length;++s){var l=n.charCodeAt(s);if(l<128)a[e++]=l;else if(l<2048)a[e++]=192|l>>6&31,a[e++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=n.charCodeAt(++s)&1023;a[e++]=240|l>>8&7,a[e++]=128|l>>2&63,a[e++]=128|c>>6&15|(l&3)<<4,a[e++]=128|c&63}else a[e++]=224|l>>12&15,a[e++]=128|l>>6&63,a[e++]=128|l&63;e>r&&(t.push(a.slice(0,e)),e=0,a=zl(65535),r=65530)}return t.push(a.slice(0,e)),al(t)}var Gn=/\u0000/g,b0=/[\u0001-\u0006]/g;function qh(n){for(var t="",e=n.length-1;e>=0;)t+=n.charAt(e--);return t}function Ni(n,t){var e=""+n;return e.length>=t?e:ur("0",t-e.length)+e}function jA(n,t){var e=""+n;return e.length>=t?e:ur(" ",t-e.length)+e}function dx(n,t){var e=""+n;return e.length>=t?e:e+ur(" ",t-e.length)}function iP(n,t){var e=""+Math.round(n);return e.length>=t?e:ur("0",t-e.length)+e}function sP(n,t){var e=""+n;return e.length>=t?e:ur("0",t-e.length)+e}var zT=Math.pow(2,32);function Lh(n,t){if(n>zT||n<-zT)return iP(n,t);var e=Math.round(n);return sP(e,t)}function px(n,t){return t=t||0,n.length>=7+t&&(n.charCodeAt(t)|32)===103&&(n.charCodeAt(t+1)|32)===101&&(n.charCodeAt(t+2)|32)===110&&(n.charCodeAt(t+3)|32)===101&&(n.charCodeAt(t+4)|32)===114&&(n.charCodeAt(t+5)|32)===97&&(n.charCodeAt(t+6)|32)===108}var jT=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Oy=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function oP(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"/ "hh""mm""ss" "',n}var et={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},GT={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},lP={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function gx(n,t,e){for(var r=n<0?-1:1,a=n*r,s=0,l=1,c=0,h=1,f=0,d=0,m=Math.floor(a);f<t&&(m=Math.floor(a),c=m*l+s,d=m*f+h,!(a-m<5e-8));)a=1/(a-m),s=l,l=c,h=f,f=d;if(d>t&&(f>t?(d=h,c=s):(d=f,c=l)),!e)return[0,r*c,d];var x=Math.floor(r*c/d);return[x,r*c-x*d,d]}function Tc(n,t,e){if(n>2958465||n<0)return null;var r=n|0,a=Math.floor(86400*(n-r)),s=0,l=[],c={D:r,T:a,u:86400*(n-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(r+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++r,++c.D)),r===60)l=e?[1317,10,29]:[1900,2,29],s=3;else if(r===0)l=e?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var h=new Date(1900,0,1);h.setDate(h.getDate()+r-1),l=[h.getFullYear(),h.getMonth()+1,h.getDate()],s=h.getDay(),r<60&&(s=(s+6)%7),e&&(s=pP(h,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=s,c}var GC=new Date(1899,11,31,0,0,0),cP=GC.getTime(),uP=new Date(1900,2,1,0,0,0);function VC(n,t){var e=n.getTime();return t?e-=1461*24*60*60*1e3:n>=uP&&(e+=24*60*60*1e3),(e-(cP+(n.getTimezoneOffset()-GC.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function GA(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function hP(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function fP(n){var t=n<0?12:11,e=GA(n.toFixed(12));return e.length<=t||(e=n.toPrecision(10),e.length<=t)?e:n.toExponential(5)}function dP(n){var t=GA(n.toFixed(11));return t.length>(n<0?12:11)||t==="0"||t==="-0"?n.toPrecision(6):t}function ap(n){var t=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),e;return t>=-4&&t<=-1?e=n.toPrecision(10+t):Math.abs(t)<=9?e=fP(n):t===10?e=n.toFixed(10).substr(0,12):e=dP(n),GA(hP(e.toUpperCase()))}function Mu(n,t){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):ap(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return li(14,VC(n,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+n)}function pP(n,t){t[0]-=581;var e=n.getDay();return n<60&&(e=(e+6)%7),e}function gP(n,t,e,r){var a="",s=0,l=0,c=e.y,h,f=0;switch(n){case 98:c=e.y+543;case 121:switch(t.length){case 1:case 2:h=c%100,f=2;break;default:h=c%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:h=e.m,f=t.length;break;case 3:return Oy[e.m-1][1];case 5:return Oy[e.m-1][0];default:return Oy[e.m-1][2]}break;case 100:switch(t.length){case 1:case 2:h=e.d,f=t.length;break;case 3:return jT[e.q][0];default:return jT[e.q][1]}break;case 104:switch(t.length){case 1:case 2:h=1+(e.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:h=e.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:h=e.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return e.u===0&&(t=="s"||t=="ss")?Ni(e.S,t.length):(r>=2?l=r===3?1e3:100:l=r===1?10:1,s=Math.round(l*(e.S+e.u)),s>=60*l&&(s=0),t==="s"?s===0?"0":""+s/l:(a=Ni(s,2+r),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":h=e.D*24+e.H;break;case"[m]":case"[mm]":h=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":h=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:h=c,f=1;break}var d=f>0?Ni(h,f):"";return d}function Il(n){var t=3;if(n.length<=t)return n;for(var e=n.length%t,r=n.substr(0,e);e!=n.length;e+=t)r+=(r.length>0?",":"")+n.substr(e,t);return r}var $C=/%/g;function mP(n,t,e){var r=t.replace($C,""),a=t.length-r.length;return yo(n,r,e*Math.pow(10,2*a))+ur("%",a)}function xP(n,t,e){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return yo(n,t.substr(0,r),e/Math.pow(10,3*(t.length-r)))}function XC(n,t){var e,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+XC(n,-t);var a=n.indexOf(".");a===-1&&(a=n.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),e=(t/Math.pow(10,s)).toPrecision(r+1+(a+s)%a),e.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(l-e.length+s):e+="E+"+(l-s);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,a)+"."+e.substr(2+a),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,h,f,d){return h+f+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else e=t.toExponential(r);return n.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),n.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var qC=/# (\?+)( ?)\/( ?)(\d+)/;function vP(n,t,e){var r=parseInt(n[4],10),a=Math.round(t*r),s=Math.floor(a/r),l=a-s*r,c=r;return e+(s===0?"":""+s)+" "+(l===0?ur(" ",n[1].length+1+n[4].length):jA(l,n[1].length)+n[2]+"/"+n[3]+Ni(c,n[4].length))}function _P(n,t,e){return e+(t===0?"":""+t)+ur(" ",n[1].length+2+n[4].length)}var YC=/^#*0*\.([0#]+)/,WC=/\).*[0#]/,KC=/\(###\) ###\\?-####/;function Hn(n){for(var t="",e,r=0;r!=n.length;++r)switch(e=n.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(e)}return t}function VT(n,t){var e=Math.pow(10,t);return""+Math.round(n*e)/e}function $T(n,t){var e=n-Math.floor(n),r=Math.pow(10,t);return t<(""+Math.round(e*r)).length?0:Math.round(e*r)}function yP(n,t){return t<(""+Math.round((n-Math.floor(n))*Math.pow(10,t))).length?1:0}function wP(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function Ka(n,t,e){if(n.charCodeAt(0)===40&&!t.match(WC)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Ka("n",r,e):"("+Ka("n",r,-e)+")"}if(t.charCodeAt(t.length-1)===44)return xP(n,t,e);if(t.indexOf("%")!==-1)return mP(n,t,e);if(t.indexOf("E")!==-1)return XC(t,e);if(t.charCodeAt(0)===36)return"$"+Ka(n,t.substr(t.charAt(1)==" "?2:1),e);var a,s,l,c,h=Math.abs(e),f=e<0?"-":"";if(t.match(/^00+$/))return f+Lh(h,t.length);if(t.match(/^[#?]+$/))return a=Lh(e,0),a==="0"&&(a=""),a.length>t.length?a:Hn(t.substr(0,t.length-a.length))+a;if(s=t.match(qC))return vP(s,h,f);if(t.match(/^#+0+$/))return f+Lh(h,t.length-t.indexOf("0"));if(s=t.match(YC))return a=VT(e,s[1].length).replace(/^([^\.]+)$/,"$1."+Hn(s[1])).replace(/\.$/,"."+Hn(s[1])).replace(/\.(\d*)$/,function(y,A){return"."+A+ur("0",Hn(s[1]).length-A.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return f+VT(h,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return f+Il(Lh(h,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Ka(n,t,-e):Il(""+(Math.floor(e)+yP(e,s[1].length)))+"."+Ni($T(e,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Ka(n,t.replace(/^#,#*,/,""),e);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=qh(Ka(n,t.replace(/[\\-]/g,""),e)),l=0,qh(qh(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return l<a.length?a.charAt(l++):y==="0"?"0":""}));if(t.match(KC))return a=Ka(n,"##########",e),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),c=gx(h,Math.pow(10,l)-1,!1),a=""+f,d=yo("n",s[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=dx(c[2],l),d.length<s[4].length&&(d=Hn(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),c=gx(h,Math.pow(10,l)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?jA(c[1],l)+s[2]+"/"+s[3]+dx(c[2],l):ur(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=Lh(e,0),t.length<=a.length?a:Hn(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+e.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var m=t.indexOf(".")-l,x=t.length-a.length-m;return Hn(t.substr(0,m)+a+t.substr(t.length-x))}if(s=t.match(/^00,000\.([#0]*0)$/))return l=$T(e,s[1].length),e<0?"-"+Ka(n,t,-e):Il(wP(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Ni(0,3-y.length):"")+y})+"."+Ni(l,s[1].length);switch(t){case"###,##0.00":return Ka(n,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var _=Il(Lh(h,0));return _!=="0"?f+_:"";case"###,###.00":return Ka(n,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Ka(n,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function AP(n,t,e){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return yo(n,t.substr(0,r),e/Math.pow(10,3*(t.length-r)))}function EP(n,t,e){var r=t.replace($C,""),a=t.length-r.length;return yo(n,r,e*Math.pow(10,2*a))+ur("%",a)}function QC(n,t){var e,r=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+QC(n,-t);var a=n.indexOf(".");a===-1&&(a=n.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),e=(t/Math.pow(10,s)).toPrecision(r+1+(a+s)%a),!e.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(l-e.length+s):e+="E+"+(l-s),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,h,f,d){return h+f+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else e=t.toExponential(r);return n.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),n.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function Zi(n,t,e){if(n.charCodeAt(0)===40&&!t.match(WC)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Zi("n",r,e):"("+Zi("n",r,-e)+")"}if(t.charCodeAt(t.length-1)===44)return AP(n,t,e);if(t.indexOf("%")!==-1)return EP(n,t,e);if(t.indexOf("E")!==-1)return QC(t,e);if(t.charCodeAt(0)===36)return"$"+Zi(n,t.substr(t.charAt(1)==" "?2:1),e);var a,s,l,c,h=Math.abs(e),f=e<0?"-":"";if(t.match(/^00+$/))return f+Ni(h,t.length);if(t.match(/^[#?]+$/))return a=""+e,e===0&&(a=""),a.length>t.length?a:Hn(t.substr(0,t.length-a.length))+a;if(s=t.match(qC))return _P(s,h,f);if(t.match(/^#+0+$/))return f+Ni(h,t.length-t.indexOf("0"));if(s=t.match(YC))return a=(""+e).replace(/^([^\.]+)$/,"$1."+Hn(s[1])).replace(/\.$/,"."+Hn(s[1])),a=a.replace(/\.(\d*)$/,function(y,A){return"."+A+ur("0",Hn(s[1]).length-A.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return f+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return f+Il(""+h);if(s=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Zi(n,t,-e):Il(""+e)+"."+ur("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Zi(n,t.replace(/^#,#*,/,""),e);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=qh(Zi(n,t.replace(/[\\-]/g,""),e)),l=0,qh(qh(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return l<a.length?a.charAt(l++):y==="0"?"0":""}));if(t.match(KC))return a=Zi(n,"##########",e),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),c=gx(h,Math.pow(10,l)-1,!1),a=""+f,d=yo("n",s[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=dx(c[2],l),d.length<s[4].length&&(d=Hn(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),c=gx(h,Math.pow(10,l)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?jA(c[1],l)+s[2]+"/"+s[3]+dx(c[2],l):ur(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+e,t.length<=a.length?a:Hn(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+e.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var m=t.indexOf(".")-l,x=t.length-a.length-m;return Hn(t.substr(0,m)+a+t.substr(t.length-x))}if(s=t.match(/^00,000\.([#0]*0)$/))return e<0?"-"+Zi(n,t,-e):Il(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?Ni(0,3-y.length):"")+y})+"."+Ni(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var _=Il(""+h);return _!=="0"?f+_:"";default:if(t.match(/\.[0#?]*$/))return Zi(n,t.slice(0,t.lastIndexOf(".")),e)+Hn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function yo(n,t,e){return(e|0)===e?Zi(n,t,e):Ka(n,t,e)}function bP(n){for(var t=[],e=!1,r=0,a=0;r<n.length;++r)switch(n.charCodeAt(r)){case 34:e=!e;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=n.substr(a,r-a),a=r+1}if(t[t.length]=n.substr(a),e===!0)throw new Error("Format |"+n+"| unterminated string ");return t}var ZC=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ud(n){for(var t=0,e="",r="";t<n.length;)switch(e=n.charAt(t)){case"G":px(n,t)&&(t+=6),t++;break;case'"':for(;n.charCodeAt(++t)!==34&&t<n.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(n.charAt(t+1)==="1"||n.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(n.substr(t,3).toUpperCase()==="A/P"||n.substr(t,5).toUpperCase()==="AM/PM"||n.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(r=e;n.charAt(t++)!=="]"&&t<n.length;)r+=n.charAt(t);if(r.match(ZC))return!0;break;case".":case"0":case"#":for(;t<n.length&&("0#?.,E+-%".indexOf(e=n.charAt(++t))>-1||e=="\\"&&n.charAt(t+1)=="-"&&"0#".indexOf(n.charAt(t+2))>-1););break;case"?":for(;n.charAt(++t)===e;);break;case"*":++t,(n.charAt(t)==" "||n.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<n.length&&"0123456789".indexOf(n.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function SP(n,t,e,r){for(var a=[],s="",l=0,c="",h="t",f,d,m,x="H";l<n.length;)switch(c=n.charAt(l)){case"G":if(!px(n,l))throw new Error("unrecognized character "+c+" in "+n);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(m=n.charCodeAt(++l))!==34&&l<n.length;)s+=String.fromCharCode(m);a[a.length]={t:"t",v:s},++l;break;case"\\":var _=n.charAt(++l),y=_==="("||_===")"?_:"t";a[a.length]={t:y,v:_},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:t},++l;break;case"B":case"b":if(n.charAt(l+1)==="1"||n.charAt(l+1)==="2"){if(f==null&&(f=Tc(t,e,n.charAt(l+1)==="2"),f==null))return"";a[a.length]={t:"X",v:n.substr(l,2)},h=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=Tc(t,e),f==null))return"";for(s=c;++l<n.length&&n.charAt(l).toLowerCase()===c;)s+=c;c==="m"&&h.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=x),a[a.length]={t:c,v:s},h=c;break;case"A":case"a":case"":var A={t:c,v:c};if(f==null&&(f=Tc(t,e)),n.substr(l,3).toUpperCase()==="A/P"?(f!=null&&(A.v=f.H>=12?"P":"A"),A.t="T",x="h",l+=3):n.substr(l,5).toUpperCase()==="AM/PM"?(f!=null&&(A.v=f.H>=12?"PM":"AM"),A.t="T",l+=5,x="h"):n.substr(l,5).toUpperCase()==="/"?(f!=null&&(A.v=f.H>=12?"":""),A.t="T",l+=5,x="h"):(A.t="t",++l),f==null&&A.t==="T")return"";a[a.length]=A,h=c;break;case"[":for(s=c;n.charAt(l++)!=="]"&&l<n.length;)s+=n.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(ZC)){if(f==null&&(f=Tc(t,e),f==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},h=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ud(n)||(a[a.length]={t:"t",v:s}));break;case".":if(f!=null){for(s=c;++l<n.length&&(c=n.charAt(l))==="0";)s+=c;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=c;++l<n.length&&"0#?.,E+-%".indexOf(c=n.charAt(l))>-1;)s+=c;a[a.length]={t:"n",v:s};break;case"?":for(s=c;n.charAt(++l)===c;)s+=c;a[a.length]={t:c,v:s},h=c;break;case"*":++l,(n.charAt(l)==" "||n.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:r===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=c;l<n.length&&"0123456789".indexOf(n.charAt(++l))>-1;)s+=n.charAt(l);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:c,v:c},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+n);a[a.length]={t:"t",v:c},++l;break}var E=0,b=0,C;for(l=a.length-1,h="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=x,h="h",E<1&&(E=1);break;case"s":(C=a[l].v.match(/\.0+$/))&&(b=Math.max(b,C[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":h=a[l].t;break;case"m":h==="s"&&(a[l].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&a[l].v.match(/[Hh]/)&&(E=1),E<2&&a[l].v.match(/[Mm]/)&&(E=2),E<3&&a[l].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var S="",O;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=gP(a[l].t.charCodeAt(0),a[l].v,f,b),a[l].t="t";break;case"n":case"?":for(O=l+1;a[O]!=null&&((c=a[O].t)==="?"||c==="D"||(c===" "||c==="t")&&a[O+1]!=null&&(a[O+1].t==="?"||a[O+1].t==="t"&&a[O+1].v==="/")||a[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[O].v==="/"||a[O].v===" "&&a[O+1]!=null&&a[O+1].t=="?"));)a[l].v+=a[O].v,a[O]={v:"",t:";"},++O;S+=a[l].v,l=O-1;break;case"G":a[l].t="t",a[l].v=Mu(t,e);break}var L="",I,F;if(S.length>0){S.charCodeAt(0)==40?(I=t<0&&S.charCodeAt(0)===45?-t:t,F=yo("n",S,I)):(I=t<0&&r>1?-t:t,F=yo("n",S,I),I<0&&a[0]&&a[0].t=="t"&&(F=F.substr(1),a[0].v="-"+a[0].v)),O=F.length-1;var W=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){W=l;break}var B=a.length;if(W===a.length&&F.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(O>=a[l].v.length-1?(O-=a[l].v.length,a[l].v=F.substr(O+1,a[l].v.length)):O<0?a[l].v="":(a[l].v=F.substr(0,O+1),O=-1),a[l].t="t",B=l);O>=0&&B<a.length&&(a[B].v=F.substr(0,O+1)+a[B].v)}else if(W!==a.length&&F.indexOf("E")===-1){for(O=F.indexOf(".")-1,l=W;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(d=a[l].v.indexOf(".")>-1&&l===W?a[l].v.indexOf(".")-1:a[l].v.length-1,L=a[l].v.substr(d+1);d>=0;--d)O>=0&&(a[l].v.charAt(d)==="0"||a[l].v.charAt(d)==="#")&&(L=F.charAt(O--)+L);a[l].v=L,a[l].t="t",B=l}for(O>=0&&B<a.length&&(a[B].v=F.substr(0,O+1)+a[B].v),O=F.indexOf(".")+1,l=W;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==W)){for(d=a[l].v.indexOf(".")>-1&&l===W?a[l].v.indexOf(".")+1:0,L=a[l].v.substr(0,d);d<a[l].v.length;++d)O<F.length&&(L+=F.charAt(O++));a[l].v=L,a[l].t="t",B=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(I=r>1&&t<0&&l>0&&a[l-1].v==="-"?-t:t,a[l].v=yo(a[l].t,a[l].v,I),a[l].t="t");var ee="";for(l=0;l!==a.length;++l)a[l]!=null&&(ee+=a[l].v);return ee}var XT=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function qT(n,t){if(t==null)return!1;var e=parseFloat(t[2]);switch(t[1]){case"=":if(n==e)return!0;break;case">":if(n>e)return!0;break;case"<":if(n<e)return!0;break;case"<>":if(n!=e)return!0;break;case">=":if(n>=e)return!0;break;case"<=":if(n<=e)return!0;break}return!1}function TP(n,t){var e=bP(n),r=e.length,a=e[r-1].indexOf("@");if(r<4&&a>-1&&--r,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof t!="number")return[4,e.length===4||a>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=a>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=a>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=a>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var s=t>0?e[0]:t<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[r,s];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var l=e[0].match(XT),c=e[1].match(XT);return qT(t,l)?[r,e[0]]:qT(t,c)?[r,e[1]]:[r,e[l!=null&&c!=null?2:1]]}return[r,s]}function li(n,t,e){e==null&&(e={});var r="";switch(typeof n){case"string":n=="m/d/yy"&&e.dateNF?r=e.dateNF:r=n;break;case"number":n==14&&e.dateNF?r=e.dateNF:r=(e.table!=null?e.table:et)[n],r==null&&(r=e.table&&e.table[GT[n]]||et[GT[n]]),r==null&&(r=lP[n]||"General");break}if(px(r,0))return Mu(t,e);t instanceof Date&&(t=VC(t,e.date1904));var a=TP(r,t);if(px(a[1]))return Mu(t,e);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return SP(a[1],t,e,a[0])}function Du(n,t){if(typeof t!="number"){t=+t||-1;for(var e=0;e<392;++e){if(et[e]==null){t<0&&(t=e);continue}if(et[e]==n){t=e;break}}t<0&&(t=391)}return et[t]=n,t}function JC(){et=oP()}var kP={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},eR=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function CP(n){var t=typeof n=="number"?et[n]:n;return t=t.replace(eR,"(\\d+)"),new RegExp("^"+t+"$")}function RP(n,t,e){var r=-1,a=-1,s=-1,l=-1,c=-1,h=-1;(t.match(eR)||[]).forEach(function(m,x){var _=parseInt(e[x+1],10);switch(m.toLowerCase().charAt(0)){case"y":r=_;break;case"d":s=_;break;case"h":l=_;break;case"s":h=_;break;case"m":l>=0?c=_:a=_;break}}),h>=0&&c==-1&&a>=0&&(c=a,a=-1);var f=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var d=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return l==-1&&c==-1&&h==-1?f:r==-1&&a==-1&&s==-1?d:f+"T"+d}var OP=function(){var n={};n.version="1.2.0";function t(){for(var F=0,W=new Array(256),B=0;B!=256;++B)F=B,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,W[B]=F;return typeof Int32Array<"u"?new Int32Array(W):W}var e=t();function r(F){var W=0,B=0,ee=0,Z=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ee=0;ee!=256;++ee)Z[ee]=F[ee];for(ee=0;ee!=256;++ee)for(B=F[ee],W=256+ee;W<4096;W+=256)B=Z[W]=B>>>8^F[B&255];var te=[];for(ee=1;ee!=16;++ee)te[ee-1]=typeof Int32Array<"u"?Z.subarray(ee*256,ee*256+256):Z.slice(ee*256,ee*256+256);return te}var a=r(e),s=a[0],l=a[1],c=a[2],h=a[3],f=a[4],d=a[5],m=a[6],x=a[7],_=a[8],y=a[9],A=a[10],E=a[11],b=a[12],C=a[13],S=a[14];function O(F,W){for(var B=W^-1,ee=0,Z=F.length;ee<Z;)B=B>>>8^e[(B^F.charCodeAt(ee++))&255];return~B}function L(F,W){for(var B=W^-1,ee=F.length-15,Z=0;Z<ee;)B=S[F[Z++]^B&255]^C[F[Z++]^B>>8&255]^b[F[Z++]^B>>16&255]^E[F[Z++]^B>>>24]^A[F[Z++]]^y[F[Z++]]^_[F[Z++]]^x[F[Z++]]^m[F[Z++]]^d[F[Z++]]^f[F[Z++]]^h[F[Z++]]^c[F[Z++]]^l[F[Z++]]^s[F[Z++]]^e[F[Z++]];for(ee+=15;Z<ee;)B=B>>>8^e[(B^F[Z++])&255];return~B}function I(F,W){for(var B=W^-1,ee=0,Z=F.length,te=0,ve=0;ee<Z;)te=F.charCodeAt(ee++),te<128?B=B>>>8^e[(B^te)&255]:te<2048?(B=B>>>8^e[(B^(192|te>>6&31))&255],B=B>>>8^e[(B^(128|te&63))&255]):te>=55296&&te<57344?(te=(te&1023)+64,ve=F.charCodeAt(ee++)&1023,B=B>>>8^e[(B^(240|te>>8&7))&255],B=B>>>8^e[(B^(128|te>>2&63))&255],B=B>>>8^e[(B^(128|ve>>6&15|(te&3)<<4))&255],B=B>>>8^e[(B^(128|ve&63))&255]):(B=B>>>8^e[(B^(224|te>>12&15))&255],B=B>>>8^e[(B^(128|te>>6&63))&255],B=B>>>8^e[(B^(128|te&63))&255]);return~B}return n.table=e,n.bstr=O,n.buf=L,n.str=I,n}(),_t=function(){var t={};t.version="1.2.1";function e(M,z){for(var P=M.split("/"),H=z.split("/"),j=0,G=0,he=Math.min(P.length,H.length);j<he;++j){if(G=P[j].length-H[j].length)return G;if(P[j]!=H[j])return P[j]<H[j]?-1:1}return P.length-H.length}function r(M){if(M.charAt(M.length-1)=="/")return M.slice(0,-1).indexOf("/")===-1?M:r(M.slice(0,-1));var z=M.lastIndexOf("/");return z===-1?M:M.slice(0,z+1)}function a(M){if(M.charAt(M.length-1)=="/")return a(M.slice(0,-1));var z=M.lastIndexOf("/");return z===-1?M:M.slice(z+1)}function s(M,z){typeof z=="string"&&(z=new Date(z));var P=z.getHours();P=P<<6|z.getMinutes(),P=P<<5|z.getSeconds()>>>1,M.write_shift(2,P);var H=z.getFullYear()-1980;H=H<<4|z.getMonth()+1,H=H<<5|z.getDate(),M.write_shift(2,H)}function l(M){var z=M.read_shift(2)&65535,P=M.read_shift(2)&65535,H=new Date,j=P&31;P>>>=5;var G=P&15;P>>>=4,H.setMilliseconds(0),H.setFullYear(P+1980),H.setMonth(G-1),H.setDate(j);var he=z&31;z>>>=5;var me=z&63;return z>>>=6,H.setHours(z),H.setMinutes(me),H.setSeconds(he<<1),H}function c(M){ln(M,0);for(var z={},P=0;M.l<=M.length-4;){var H=M.read_shift(2),j=M.read_shift(2),G=M.l+j,he={};switch(H){case 21589:P=M.read_shift(1),P&1&&(he.mtime=M.read_shift(4)),j>5&&(P&2&&(he.atime=M.read_shift(4)),P&4&&(he.ctime=M.read_shift(4))),he.mtime&&(he.mt=new Date(he.mtime*1e3));break}M.l=G,z[H]=he}return z}var h;function f(){return h||(h={})}function d(M,z){if(M[0]==80&&M[1]==75)return rm(M,z);if((M[0]|32)==109&&(M[1]|32)==105)return dd(M,z);if(M.length<512)throw new Error("CFB file size "+M.length+" < 512");var P=3,H=512,j=0,G=0,he=0,me=0,ce=0,ue=[],de=M.slice(0,512);ln(de,0);var ke=m(de);switch(P=ke[0],P){case 3:H=512;break;case 4:H=4096;break;case 0:if(ke[1]==0)return rm(M,z);default:throw new Error("Major Version: Expected 3 or 4 saw "+P)}H!==512&&(de=M.slice(0,H),ln(de,28));var Fe=M.slice(0,H);x(de,P);var Ne=de.read_shift(4,"i");if(P===3&&Ne!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ne);de.l+=4,he=de.read_shift(4,"i"),de.l+=4,de.chk("00100000","Mini Stream Cutoff Size: "),me=de.read_shift(4,"i"),j=de.read_shift(4,"i"),ce=de.read_shift(4,"i"),G=de.read_shift(4,"i");for(var Re=-1,Oe=0;Oe<109&&(Re=de.read_shift(4,"i"),!(Re<0));++Oe)ue[Oe]=Re;var Ye=_(M,H);E(ce,G,Ye,H,ue);var Ut=C(Ye,he,ue,H);Ut[he].name="!Directory",j>0&&me!==ve&&(Ut[me].name="!MiniFAT"),Ut[ue[0]].name="!FAT",Ut.fat_addrs=ue,Ut.ssz=H;var kt={},er=[],Dn=[],Ql=[];S(he,Ut,Ye,er,j,kt,Dn,me),y(Dn,Ql,er),er.shift();var Oo={FileIndex:Dn,FullPaths:Ql};return z&&z.raw&&(Oo.raw={header:Fe,sectors:Ye}),Oo}function m(M){if(M[M.l]==80&&M[M.l+1]==75)return[0,0];M.chk(Ce,"Header Signature: "),M.l+=16;var z=M.read_shift(2,"u");return[M.read_shift(2,"u"),z]}function x(M,z){var P=9;switch(M.l+=2,P=M.read_shift(2)){case 9:if(z!=3)throw new Error("Sector Shift: Expected 9 saw "+P);break;case 12:if(z!=4)throw new Error("Sector Shift: Expected 12 saw "+P);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+P)}M.chk("0600","Mini Sector Shift: "),M.chk("000000000000","Reserved: ")}function _(M,z){for(var P=Math.ceil(M.length/z)-1,H=[],j=1;j<P;++j)H[j-1]=M.slice(j*z,(j+1)*z);return H[P-1]=M.slice(P*z),H}function y(M,z,P){for(var H=0,j=0,G=0,he=0,me=0,ce=P.length,ue=[],de=[];H<ce;++H)ue[H]=de[H]=H,z[H]=P[H];for(;me<de.length;++me)H=de[me],j=M[H].L,G=M[H].R,he=M[H].C,ue[H]===H&&(j!==-1&&ue[j]!==j&&(ue[H]=ue[j]),G!==-1&&ue[G]!==G&&(ue[H]=ue[G])),he!==-1&&(ue[he]=H),j!==-1&&H!=ue[H]&&(ue[j]=ue[H],de.lastIndexOf(j)<me&&de.push(j)),G!==-1&&H!=ue[H]&&(ue[G]=ue[H],de.lastIndexOf(G)<me&&de.push(G));for(H=1;H<ce;++H)ue[H]===H&&(G!==-1&&ue[G]!==G?ue[H]=ue[G]:j!==-1&&ue[j]!==j&&(ue[H]=ue[j]));for(H=1;H<ce;++H)if(M[H].type!==0){if(me=H,me!=ue[me])do me=ue[me],z[H]=z[me]+"/"+z[H];while(me!==0&&ue[me]!==-1&&me!=ue[me]);ue[H]=-1}for(z[0]+="/",H=1;H<ce;++H)M[H].type!==2&&(z[H]+="/")}function A(M,z,P){for(var H=M.start,j=M.size,G=[],he=H;P&&j>0&&he>=0;)G.push(z.slice(he*te,he*te+te)),j-=te,he=Ec(P,he*4);return G.length===0?Lr(0):al(G).slice(0,M.size)}function E(M,z,P,H,j){var G=ve;if(M===ve){if(z!==0)throw new Error("DIFAT chain shorter than expected")}else if(M!==-1){var he=P[M],me=(H>>>2)-1;if(!he)return;for(var ce=0;ce<me&&(G=Ec(he,ce*4))!==ve;++ce)j.push(G);E(Ec(he,H-4),z-1,P,H,j)}}function b(M,z,P,H,j){var G=[],he=[];j||(j=[]);var me=H-1,ce=0,ue=0;for(ce=z;ce>=0;){j[ce]=!0,G[G.length]=ce,he.push(M[ce]);var de=P[Math.floor(ce*4/H)];if(ue=ce*4&me,H<4+ue)throw new Error("FAT boundary crossed: "+ce+" 4 "+H);if(!M[de])break;ce=Ec(M[de],ue)}return{nodes:G,data:nk([he])}}function C(M,z,P,H){var j=M.length,G=[],he=[],me=[],ce=[],ue=H-1,de=0,ke=0,Fe=0,Ne=0;for(de=0;de<j;++de)if(me=[],Fe=de+z,Fe>=j&&(Fe-=j),!he[Fe]){ce=[];var Re=[];for(ke=Fe;ke>=0;){Re[ke]=!0,he[ke]=!0,me[me.length]=ke,ce.push(M[ke]);var Oe=P[Math.floor(ke*4/H)];if(Ne=ke*4&ue,H<4+Ne)throw new Error("FAT boundary crossed: "+ke+" 4 "+H);if(!M[Oe]||(ke=Ec(M[Oe],Ne),Re[ke]))break}G[Fe]={nodes:me,data:nk([ce])}}return G}function S(M,z,P,H,j,G,he,me){for(var ce=0,ue=H.length?2:0,de=z[M].data,ke=0,Fe=0,Ne;ke<de.length;ke+=128){var Re=de.slice(ke,ke+128);ln(Re,64),Fe=Re.read_shift(2),Ne=YA(Re,0,Fe-ue),H.push(Ne);var Oe={name:Ne,type:Re.read_shift(1),color:Re.read_shift(1),L:Re.read_shift(4,"i"),R:Re.read_shift(4,"i"),C:Re.read_shift(4,"i"),clsid:Re.read_shift(16),state:Re.read_shift(4,"i"),start:0,size:0},Ye=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);Ye!==0&&(Oe.ct=O(Re,Re.l-8));var Ut=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);Ut!==0&&(Oe.mt=O(Re,Re.l-8)),Oe.start=Re.read_shift(4,"i"),Oe.size=Re.read_shift(4,"i"),Oe.size<0&&Oe.start<0&&(Oe.size=Oe.type=0,Oe.start=ve,Oe.name=""),Oe.type===5?(ce=Oe.start,j>0&&ce!==ve&&(z[ce].name="!StreamData")):Oe.size>=4096?(Oe.storage="fat",z[Oe.start]===void 0&&(z[Oe.start]=b(P,Oe.start,z.fat_addrs,z.ssz)),z[Oe.start].name=Oe.name,Oe.content=z[Oe.start].data.slice(0,Oe.size)):(Oe.storage="minifat",Oe.size<0?Oe.size=0:ce!==ve&&Oe.start!==ve&&z[ce]&&(Oe.content=A(Oe,z[ce].data,(z[me]||{}).data))),Oe.content&&ln(Oe.content,0),G[Ne]=Oe,he.push(Oe)}}function O(M,z){return new Date((Ca(M,z+4)/1e7*Math.pow(2,32)+Ca(M,z)/1e7-11644473600)*1e3)}function L(M,z){return f(),d(h.readFileSync(M),z)}function I(M,z){var P=z&&z.type;switch(P||xt&&Buffer.isBuffer(M)&&(P="buffer"),P||"base64"){case"file":return L(M,z);case"base64":return d(Mi(Ma(M)),z);case"binary":return d(Mi(M),z)}return d(M,z)}function F(M,z){var P=z||{},H=P.root||"Root Entry";if(M.FullPaths||(M.FullPaths=[]),M.FileIndex||(M.FileIndex=[]),M.FullPaths.length!==M.FileIndex.length)throw new Error("inconsistent CFB structure");M.FullPaths.length===0&&(M.FullPaths[0]=H+"/",M.FileIndex[0]={name:H,type:5}),P.CLSID&&(M.FileIndex[0].clsid=P.CLSID),W(M)}function W(M){var z="Sh33tJ5";if(!_t.find(M,"/"+z)){var P=Lr(4);P[0]=55,P[1]=P[3]=50,P[2]=54,M.FileIndex.push({name:z,type:2,content:P,size:4,L:69,R:69,C:69}),M.FullPaths.push(M.FullPaths[0]+z),B(M)}}function B(M,z){F(M);for(var P=!1,H=!1,j=M.FullPaths.length-1;j>=0;--j){var G=M.FileIndex[j];switch(G.type){case 0:H?P=!0:(M.FileIndex.pop(),M.FullPaths.pop());break;case 1:case 2:case 5:H=!0,isNaN(G.R*G.L*G.C)&&(P=!0),G.R>-1&&G.L>-1&&G.R==G.L&&(P=!0);break;default:P=!0;break}}if(!(!P&&!z)){var he=new Date(1987,1,19),me=0,ce=Object.create?Object.create(null):{},ue=[];for(j=0;j<M.FullPaths.length;++j)ce[M.FullPaths[j]]=!0,M.FileIndex[j].type!==0&&ue.push([M.FullPaths[j],M.FileIndex[j]]);for(j=0;j<ue.length;++j){var de=r(ue[j][0]);H=ce[de],H||(ue.push([de,{name:a(de).replace("/",""),type:1,clsid:J,ct:he,mt:he,content:null}]),ce[de]=!0)}for(ue.sort(function(Ne,Re){return e(Ne[0],Re[0])}),M.FullPaths=[],M.FileIndex=[],j=0;j<ue.length;++j)M.FullPaths[j]=ue[j][0],M.FileIndex[j]=ue[j][1];for(j=0;j<ue.length;++j){var ke=M.FileIndex[j],Fe=M.FullPaths[j];if(ke.name=a(Fe).replace("/",""),ke.L=ke.R=ke.C=-(ke.color=1),ke.size=ke.content?ke.content.length:0,ke.start=0,ke.clsid=ke.clsid||J,j===0)ke.C=ue.length>1?1:-1,ke.size=0,ke.type=5;else if(Fe.slice(-1)=="/"){for(me=j+1;me<ue.length&&r(M.FullPaths[me])!=Fe;++me);for(ke.C=me>=ue.length?-1:me,me=j+1;me<ue.length&&r(M.FullPaths[me])!=r(Fe);++me);ke.R=me>=ue.length?-1:me,ke.type=1}else r(M.FullPaths[j+1]||"")==r(Fe)&&(ke.R=j+1),ke.type=2}}}function ee(M,z){var P=z||{};if(P.fileType=="mad")return Kl(M,P);switch(B(M),P.fileType){case"zip":return Qu(M,P)}var H=function(Ne){for(var Re=0,Oe=0,Ye=0;Ye<Ne.FileIndex.length;++Ye){var Ut=Ne.FileIndex[Ye];if(Ut.content){var kt=Ut.content.length;kt>0&&(kt<4096?Re+=kt+63>>6:Oe+=kt+511>>9)}}for(var er=Ne.FullPaths.length+3>>2,Dn=Re+7>>3,Ql=Re+127>>7,Oo=Dn+Oe+er+Ql,ji=Oo+127>>7,pd=ji<=109?0:Math.ceil((ji-109)/127);Oo+ji+pd+127>>7>ji;)pd=++ji<=109?0:Math.ceil((ji-109)/127);var Kn=[1,pd,ji,Ql,er,Oe,Re,0];return Ne.FileIndex[0].size=Re<<6,Kn[7]=(Ne.FileIndex[0].start=Kn[0]+Kn[1]+Kn[2]+Kn[3]+Kn[4]+Kn[5])+(Kn[6]+7>>3),Kn}(M),j=Lr(H[7]<<9),G=0,he=0;{for(G=0;G<8;++G)j.write_shift(1,Ee[G]);for(G=0;G<8;++G)j.write_shift(2,0);for(j.write_shift(2,62),j.write_shift(2,3),j.write_shift(2,65534),j.write_shift(2,9),j.write_shift(2,6),G=0;G<3;++G)j.write_shift(2,0);for(j.write_shift(4,0),j.write_shift(4,H[2]),j.write_shift(4,H[0]+H[1]+H[2]+H[3]-1),j.write_shift(4,0),j.write_shift(4,4096),j.write_shift(4,H[3]?H[0]+H[1]+H[2]-1:ve),j.write_shift(4,H[3]),j.write_shift(-4,H[1]?H[0]-1:ve),j.write_shift(4,H[1]),G=0;G<109;++G)j.write_shift(-4,G<H[2]?H[1]+G:-1)}if(H[1])for(he=0;he<H[1];++he){for(;G<236+he*127;++G)j.write_shift(-4,G<H[2]?H[1]+G:-1);j.write_shift(-4,he===H[1]-1?ve:he+1)}var me=function(Ne){for(he+=Ne;G<he-1;++G)j.write_shift(-4,G+1);Ne&&(++G,j.write_shift(-4,ve))};for(he=G=0,he+=H[1];G<he;++G)j.write_shift(-4,oe.DIFSECT);for(he+=H[2];G<he;++G)j.write_shift(-4,oe.FATSECT);me(H[3]),me(H[4]);for(var ce=0,ue=0,de=M.FileIndex[0];ce<M.FileIndex.length;++ce)de=M.FileIndex[ce],de.content&&(ue=de.content.length,!(ue<4096)&&(de.start=he,me(ue+511>>9)));for(me(H[6]+7>>3);j.l&511;)j.write_shift(-4,oe.ENDOFCHAIN);for(he=G=0,ce=0;ce<M.FileIndex.length;++ce)de=M.FileIndex[ce],de.content&&(ue=de.content.length,!(!ue||ue>=4096)&&(de.start=he,me(ue+63>>6)));for(;j.l&511;)j.write_shift(-4,oe.ENDOFCHAIN);for(G=0;G<H[4]<<2;++G){var ke=M.FullPaths[G];if(!ke||ke.length===0){for(ce=0;ce<17;++ce)j.write_shift(4,0);for(ce=0;ce<3;++ce)j.write_shift(4,-1);for(ce=0;ce<12;++ce)j.write_shift(4,0);continue}de=M.FileIndex[G],G===0&&(de.start=de.size?de.start-1:ve);var Fe=G===0&&P.root||de.name;if(ue=2*(Fe.length+1),j.write_shift(64,Fe,"utf16le"),j.write_shift(2,ue),j.write_shift(1,de.type),j.write_shift(1,de.color),j.write_shift(-4,de.L),j.write_shift(-4,de.R),j.write_shift(-4,de.C),de.clsid)j.write_shift(16,de.clsid,"hex");else for(ce=0;ce<4;++ce)j.write_shift(4,0);j.write_shift(4,de.state||0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,de.start),j.write_shift(4,de.size),j.write_shift(4,0)}for(G=1;G<M.FileIndex.length;++G)if(de=M.FileIndex[G],de.size>=4096)if(j.l=de.start+1<<9,xt&&Buffer.isBuffer(de.content))de.content.copy(j,j.l,0,de.size),j.l+=de.size+511&-512;else{for(ce=0;ce<de.size;++ce)j.write_shift(1,de.content[ce]);for(;ce&511;++ce)j.write_shift(1,0)}for(G=1;G<M.FileIndex.length;++G)if(de=M.FileIndex[G],de.size>0&&de.size<4096)if(xt&&Buffer.isBuffer(de.content))de.content.copy(j,j.l,0,de.size),j.l+=de.size+63&-64;else{for(ce=0;ce<de.size;++ce)j.write_shift(1,de.content[ce]);for(;ce&63;++ce)j.write_shift(1,0)}if(xt)j.l=j.length;else for(;j.l<j.length;)j.write_shift(1,0);return j}function Z(M,z){var P=M.FullPaths.map(function(ce){return ce.toUpperCase()}),H=P.map(function(ce){var ue=ce.split("/");return ue[ue.length-(ce.slice(-1)=="/"?2:1)]}),j=!1;z.charCodeAt(0)===47?(j=!0,z=P[0].slice(0,-1)+z):j=z.indexOf("/")!==-1;var G=z.toUpperCase(),he=j===!0?P.indexOf(G):H.indexOf(G);if(he!==-1)return M.FileIndex[he];var me=!G.match(b0);for(G=G.replace(Gn,""),me&&(G=G.replace(b0,"!")),he=0;he<P.length;++he)if((me?P[he].replace(b0,"!"):P[he]).replace(Gn,"")==G||(me?H[he].replace(b0,"!"):H[he]).replace(Gn,"")==G)return M.FileIndex[he];return null}var te=64,ve=-2,Ce="d0cf11e0a1b11ae1",Ee=[208,207,17,224,161,177,26,225],J="00000000000000000000000000000000",oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ve,FREESECT:-1,HEADER_SIGNATURE:Ce,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:J,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function De(M,z,P){f();var H=ee(M,P);h.writeFileSync(z,H)}function ae(M){for(var z=new Array(M.length),P=0;P<M.length;++P)z[P]=String.fromCharCode(M[P]);return z.join("")}function V(M,z){var P=ee(M,z);switch(z&&z.type||"buffer"){case"file":return f(),h.writeFileSync(z.filename,P),P;case"binary":return typeof P=="string"?P:ae(P);case"base64":return UT(typeof P=="string"?P:ae(P));case"buffer":if(xt)return Buffer.isBuffer(P)?P:Gu(P);case"array":return typeof P=="string"?Mi(P):P}return P}var fe;function U(M){try{var z=M.InflateRaw,P=new z;if(P._processChunk(new Uint8Array([3,0]),P._finishFlushFlag),P.bytesRead)fe=M;else throw new Error("zlib does not expose bytesRead")}catch(H){console.error("cannot use native zlib: "+(H.message||H))}}function Q(M,z){if(!fe)return em(M,z);var P=fe.InflateRaw,H=new P,j=H._processChunk(M.slice(M.l),H._finishFlushFlag);return M.l+=H.bytesRead,j}function X(M){return fe?fe.deflateRawSync(M):rt(M)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],_e=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function be(M){var z=(M<<1|M<<11)&139536|(M<<5|M<<15)&558144;return(z>>16|z>>8|z)&255}for(var Te=typeof Uint8Array<"u",ye=Te?new Uint8Array(256):[],Ke=0;Ke<256;++Ke)ye[Ke]=be(Ke);function Y(M,z){var P=ye[M&255];return z<=8?P>>>8-z:(P=P<<8|ye[M>>8&255],z<=16?P>>>16-z:(P=P<<8|ye[M>>16&255],P>>>24-z))}function Rt(M,z){var P=z&7,H=z>>>3;return(M[H]|(P<=6?0:M[H+1]<<8))>>>P&3}function ft(M,z){var P=z&7,H=z>>>3;return(M[H]|(P<=5?0:M[H+1]<<8))>>>P&7}function Et(M,z){var P=z&7,H=z>>>3;return(M[H]|(P<=4?0:M[H+1]<<8))>>>P&15}function Qe(M,z){var P=z&7,H=z>>>3;return(M[H]|(P<=3?0:M[H+1]<<8))>>>P&31}function Me(M,z){var P=z&7,H=z>>>3;return(M[H]|(P<=1?0:M[H+1]<<8))>>>P&127}function Bt(M,z,P){var H=z&7,j=z>>>3,G=(1<<P)-1,he=M[j]>>>H;return P<8-H||(he|=M[j+1]<<8-H,P<16-H)||(he|=M[j+2]<<16-H,P<24-H)||(he|=M[j+3]<<24-H),he&G}function hn(M,z,P){var H=z&7,j=z>>>3;return H<=5?M[j]|=(P&7)<<H:(M[j]|=P<<H&255,M[j+1]=(P&7)>>8-H),z+3}function Yn(M,z,P){var H=z&7,j=z>>>3;return P=(P&1)<<H,M[j]|=P,z+1}function la(M,z,P){var H=z&7,j=z>>>3;return P<<=H,M[j]|=P&255,P>>>=8,M[j+1]=P,z+8}function Yl(M,z,P){var H=z&7,j=z>>>3;return P<<=H,M[j]|=P&255,P>>>=8,M[j+1]=P&255,M[j+2]=P>>>8,z+16}function Hi(M,z){var P=M.length,H=2*P>z?2*P:z+5,j=0;if(P>=z)return M;if(xt){var G=HT(H);if(M.copy)M.copy(G);else for(;j<M.length;++j)G[j]=M[j];return G}else if(Te){var he=new Uint8Array(H);if(he.set)he.set(M);else for(;j<P;++j)he[j]=M[j];return he}return M.length=H,M}function Yt(M){for(var z=new Array(M),P=0;P<M;++P)z[P]=0;return z}function ui(M,z,P){var H=1,j=0,G=0,he=0,me=0,ce=M.length,ue=Te?new Uint16Array(32):Yt(32);for(G=0;G<32;++G)ue[G]=0;for(G=ce;G<P;++G)M[G]=0;ce=M.length;var de=Te?new Uint16Array(ce):Yt(ce);for(G=0;G<ce;++G)ue[j=M[G]]++,H<j&&(H=j),de[G]=0;for(ue[0]=0,G=1;G<=H;++G)ue[G+16]=me=me+ue[G-1]<<1;for(G=0;G<ce;++G)me=M[G],me!=0&&(de[G]=ue[me+16]++);var ke=0;for(G=0;G<ce;++G)if(ke=M[G],ke!=0)for(me=Y(de[G],H)>>H-ke,he=(1<<H+4-ke)-1;he>=0;--he)z[me|he<<ke]=ke&15|G<<4;return H}var hi=Te?new Uint16Array(512):Yt(512),Ro=Te?new Uint16Array(32):Yt(32);if(!Te){for(var vr=0;vr<512;++vr)hi[vr]=0;for(vr=0;vr<32;++vr)Ro[vr]=0}(function(){for(var M=[],z=0;z<32;z++)M.push(5);ui(M,Ro,32);var P=[];for(z=0;z<=143;z++)P.push(8);for(;z<=255;z++)P.push(9);for(;z<=279;z++)P.push(7);for(;z<=287;z++)P.push(8);ui(P,hi,288)})();var La=function(){for(var z=Te?new Uint8Array(32768):[],P=0,H=0;P<_e.length-1;++P)for(;H<_e[P+1];++H)z[H]=P;for(;H<32768;++H)z[H]=29;var j=Te?new Uint8Array(259):[];for(P=0,H=0;P<se.length-1;++P)for(;H<se[P+1];++H)j[H]=P;function G(me,ce){for(var ue=0;ue<me.length;){var de=Math.min(65535,me.length-ue),ke=ue+de==me.length;for(ce.write_shift(1,+ke),ce.write_shift(2,de),ce.write_shift(2,~de&65535);de-- >0;)ce[ce.l++]=me[ue++]}return ce.l}function he(me,ce){for(var ue=0,de=0,ke=Te?new Uint16Array(32768):[];de<me.length;){var Fe=Math.min(65535,me.length-de);if(Fe<10){for(ue=hn(ce,ue,+(de+Fe==me.length)),ue&7&&(ue+=8-(ue&7)),ce.l=ue/8|0,ce.write_shift(2,Fe),ce.write_shift(2,~Fe&65535);Fe-- >0;)ce[ce.l++]=me[de++];ue=ce.l*8;continue}ue=hn(ce,ue,+(de+Fe==me.length)+2);for(var Ne=0;Fe-- >0;){var Re=me[de];Ne=(Ne<<5^Re)&32767;var Oe=-1,Ye=0;if((Oe=ke[Ne])&&(Oe|=de&-32768,Oe>de&&(Oe-=32768),Oe<de))for(;me[Oe+Ye]==me[de+Ye]&&Ye<250;)++Ye;if(Ye>2){Re=j[Ye],Re<=22?ue=la(ce,ue,ye[Re+1]>>1)-1:(la(ce,ue,3),ue+=5,la(ce,ue,ye[Re-23]>>5),ue+=3);var Ut=Re<8?0:Re-4>>2;Ut>0&&(Yl(ce,ue,Ye-se[Re]),ue+=Ut),Re=z[de-Oe],ue=la(ce,ue,ye[Re]>>3),ue-=3;var kt=Re<4?0:Re-2>>1;kt>0&&(Yl(ce,ue,de-Oe-_e[Re]),ue+=kt);for(var er=0;er<Ye;++er)ke[Ne]=de&32767,Ne=(Ne<<5^me[de])&32767,++de;Fe-=Ye-1}else Re<=143?Re=Re+48:ue=Yn(ce,ue,1),ue=la(ce,ue,ye[Re]),ke[Ne]=de&32767,++de}ue=la(ce,ue,0)-1}return ce.l=(ue+7)/8|0,ce.l}return function(ce,ue){return ce.length<8?G(ce,ue):he(ce,ue)}}();function rt(M){var z=Lr(50+Math.floor(M.length*1.1)),P=La(M,z);return z.slice(0,P)}var Jt=Te?new Uint16Array(32768):Yt(32768),Wn=Te?new Uint16Array(32768):Yt(32768),$t=Te?new Uint16Array(128):Yt(128),fr=1,Jg=1;function zi(M,z){var P=Qe(M,z)+257;z+=5;var H=Qe(M,z)+1;z+=5;var j=Et(M,z)+4;z+=4;for(var G=0,he=Te?new Uint8Array(19):Yt(19),me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ce=1,ue=Te?new Uint8Array(8):Yt(8),de=Te?new Uint8Array(8):Yt(8),ke=he.length,Fe=0;Fe<j;++Fe)he[K[Fe]]=G=ft(M,z),ce<G&&(ce=G),ue[G]++,z+=3;var Ne=0;for(ue[0]=0,Fe=1;Fe<=ce;++Fe)de[Fe]=Ne=Ne+ue[Fe-1]<<1;for(Fe=0;Fe<ke;++Fe)(Ne=he[Fe])!=0&&(me[Fe]=de[Ne]++);var Re=0;for(Fe=0;Fe<ke;++Fe)if(Re=he[Fe],Re!=0){Ne=ye[me[Fe]]>>8-Re;for(var Oe=(1<<7-Re)-1;Oe>=0;--Oe)$t[Ne|Oe<<Re]=Re&7|Fe<<3}var Ye=[];for(ce=1;Ye.length<P+H;)switch(Ne=$t[Me(M,z)],z+=Ne&7,Ne>>>=3){case 16:for(G=3+Rt(M,z),z+=2,Ne=Ye[Ye.length-1];G-- >0;)Ye.push(Ne);break;case 17:for(G=3+ft(M,z),z+=3;G-- >0;)Ye.push(0);break;case 18:for(G=11+Me(M,z),z+=7;G-- >0;)Ye.push(0);break;default:Ye.push(Ne),ce<Ne&&(ce=Ne);break}var Ut=Ye.slice(0,P),kt=Ye.slice(P);for(Fe=P;Fe<286;++Fe)Ut[Fe]=0;for(Fe=H;Fe<30;++Fe)kt[Fe]=0;return fr=ui(Ut,Jt,286),Jg=ui(kt,Wn,30),z}function On(M,z){if(M[0]==3&&!(M[1]&3))return[zl(z),2];for(var P=0,H=0,j=HT(z||1<<18),G=0,he=j.length>>>0,me=0,ce=0;!(H&1);){if(H=ft(M,P),P+=3,H>>>1)H>>1==1?(me=9,ce=5):(P=zi(M,P),me=fr,ce=Jg);else{P&7&&(P+=8-(P&7));var ue=M[P>>>3]|M[(P>>>3)+1]<<8;if(P+=32,ue>0)for(!z&&he<G+ue&&(j=Hi(j,G+ue),he=j.length);ue-- >0;)j[G++]=M[P>>>3],P+=8;continue}for(;;){!z&&he<G+32767&&(j=Hi(j,G+32767),he=j.length);var de=Bt(M,P,me),ke=H>>>1==1?hi[de]:Jt[de];if(P+=ke&15,ke>>>=4,!(ke>>>8&255))j[G++]=ke;else{if(ke==256)break;ke-=257;var Fe=ke<8?0:ke-4>>2;Fe>5&&(Fe=0);var Ne=G+se[ke];Fe>0&&(Ne+=Bt(M,P,Fe),P+=Fe),de=Bt(M,P,ce),ke=H>>>1==1?Ro[de]:Wn[de],P+=ke&15,ke>>>=4;var Re=ke<4?0:ke-2>>1,Oe=_e[ke];for(Re>0&&(Oe+=Bt(M,P,Re),P+=Re),!z&&he<Ne&&(j=Hi(j,Ne+100),he=j.length);G<Ne;)j[G]=j[G-Oe],++G}}}return z?[j,P+7>>>3]:[j.slice(0,G),P+7>>>3]}function em(M,z){var P=M.slice(M.l||0),H=On(P,z);return M.l+=H[1],H[0]}function tm(M,z){if(M)typeof console<"u"&&console.error(z);else throw new Error(z)}function rm(M,z){var P=M;ln(P,0);var H=[],j=[],G={FileIndex:H,FullPaths:j};F(G,{root:z.root});for(var he=P.length-4;(P[he]!=80||P[he+1]!=75||P[he+2]!=5||P[he+3]!=6)&&he>=0;)--he;P.l=he+4,P.l+=4;var me=P.read_shift(2);P.l+=6;var ce=P.read_shift(4);for(P.l=ce,he=0;he<me;++he){P.l+=20;var ue=P.read_shift(4),de=P.read_shift(4),ke=P.read_shift(2),Fe=P.read_shift(2),Ne=P.read_shift(2);P.l+=8;var Re=P.read_shift(4),Oe=c(P.slice(P.l+ke,P.l+ke+Fe));P.l+=ke+Fe+Ne;var Ye=P.l;P.l=Re+4,Ku(P,ue,de,G,Oe),P.l=Ye}return G}function Ku(M,z,P,H,j){M.l+=2;var G=M.read_shift(2),he=M.read_shift(2),me=l(M);if(G&8257)throw new Error("Unsupported ZIP encryption");for(var ce=M.read_shift(4),ue=M.read_shift(4),de=M.read_shift(4),ke=M.read_shift(2),Fe=M.read_shift(2),Ne="",Re=0;Re<ke;++Re)Ne+=String.fromCharCode(M[M.l++]);if(Fe){var Oe=c(M.slice(M.l,M.l+Fe));(Oe[21589]||{}).mt&&(me=Oe[21589].mt),((j||{})[21589]||{}).mt&&(me=j[21589].mt)}M.l+=Fe;var Ye=M.slice(M.l,M.l+ue);switch(he){case 8:Ye=Q(M,de);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+he)}var Ut=!1;G&8&&(ce=M.read_shift(4),ce==134695760&&(ce=M.read_shift(4),Ut=!0),ue=M.read_shift(4),de=M.read_shift(4)),ue!=z&&tm(Ut,"Bad compressed size: "+z+" != "+ue),de!=P&&tm(Ut,"Bad uncompressed size: "+P+" != "+de),Ju(H,Ne,Ye,{unsafe:!0,mt:me})}function Qu(M,z){var P=z||{},H=[],j=[],G=Lr(1),he=P.compression?8:0,me=0,ce=0,ue=0,de=0,ke=0,Fe=M.FullPaths[0],Ne=Fe,Re=M.FileIndex[0],Oe=[],Ye=0;for(ce=1;ce<M.FullPaths.length;++ce)if(Ne=M.FullPaths[ce].slice(Fe.length),Re=M.FileIndex[ce],!(!Re.size||!Re.content||Ne=="Sh33tJ5")){var Ut=de,kt=Lr(Ne.length);for(ue=0;ue<Ne.length;++ue)kt.write_shift(1,Ne.charCodeAt(ue)&127);kt=kt.slice(0,kt.l),Oe[ke]=OP.buf(Re.content,0);var er=Re.content;he==8&&(er=X(er)),G=Lr(30),G.write_shift(4,67324752),G.write_shift(2,20),G.write_shift(2,me),G.write_shift(2,he),Re.mt?s(G,Re.mt):G.write_shift(4,0),G.write_shift(-4,Oe[ke]),G.write_shift(4,er.length),G.write_shift(4,Re.content.length),G.write_shift(2,kt.length),G.write_shift(2,0),de+=G.length,H.push(G),de+=kt.length,H.push(kt),de+=er.length,H.push(er),G=Lr(46),G.write_shift(4,33639248),G.write_shift(2,0),G.write_shift(2,20),G.write_shift(2,me),G.write_shift(2,he),G.write_shift(4,0),G.write_shift(-4,Oe[ke]),G.write_shift(4,er.length),G.write_shift(4,Re.content.length),G.write_shift(2,kt.length),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(4,0),G.write_shift(4,Ut),Ye+=G.l,j.push(G),Ye+=kt.length,j.push(kt),++ke}return G=Lr(22),G.write_shift(4,101010256),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,ke),G.write_shift(2,ke),G.write_shift(4,Ye),G.write_shift(4,de),G.write_shift(2,0),al([al(H),al(j),G])}var Na={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Zu(M,z){if(M.ctype)return M.ctype;var P=M.name||"",H=P.match(/\.([^\.]+)$/);return H&&Na[H[1]]||z&&(H=(P=z).match(/[\.\\]([^\.\\])+$/),H&&Na[H[1]])?Na[H[1]]:"application/octet-stream"}function Wl(M){for(var z=UT(M),P=[],H=0;H<z.length;H+=76)P.push(z.slice(H,H+76));return P.join(`\r
`)+`\r
`}function dv(M){var z=M.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ue){var de=ue.charCodeAt(0).toString(16).toUpperCase();return"="+(de.length==1?"0"+de:de)});z=z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),z.charAt(0)==`
`&&(z="=0D"+z.slice(1)),z=z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var P=[],H=z.split(`\r
`),j=0;j<H.length;++j){var G=H[j];if(G.length==0){P.push("");continue}for(var he=0;he<G.length;){var me=76,ce=G.slice(he,he+me);ce.charAt(me-1)=="="?me--:ce.charAt(me-2)=="="?me-=2:ce.charAt(me-3)=="="&&(me-=3),ce=G.slice(he,he+me),he+=me,he<G.length&&(ce+="="),P.push(ce)}}return P.join(`\r
`)}function nm(M){for(var z=[],P=0;P<M.length;++P){for(var H=M[P];P<=M.length&&H.charAt(H.length-1)=="=";)H=H.slice(0,H.length-1)+M[++P];z.push(H)}for(var j=0;j<z.length;++j)z[j]=z[j].replace(/[=][0-9A-Fa-f]{2}/g,function(G){return String.fromCharCode(parseInt(G.slice(1),16))});return Mi(z.join(`\r
`))}function am(M,z,P){for(var H="",j="",G="",he,me=0;me<10;++me){var ce=z[me];if(!ce||ce.match(/^\s*$/))break;var ue=ce.match(/^(.*?):\s*([^\s].*)$/);if(ue)switch(ue[1].toLowerCase()){case"content-location":H=ue[2].trim();break;case"content-type":G=ue[2].trim();break;case"content-transfer-encoding":j=ue[2].trim();break}}switch(++me,j.toLowerCase()){case"base64":he=Mi(Ma(z.slice(me).join("")));break;case"quoted-printable":he=nm(z.slice(me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+j)}var de=Ju(M,H.slice(P.length),he,{unsafe:!0});G&&(de.ctype=G)}function dd(M,z){if(ae(M.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var P=z&&z.root||"",H=(xt&&Buffer.isBuffer(M)?M.toString("binary"):ae(M)).split(`\r
`),j=0,G="";for(j=0;j<H.length;++j)if(G=H[j],!!/^Content-Location:/i.test(G)&&(G=G.slice(G.indexOf("file")),P||(P=G.slice(0,G.lastIndexOf("/")+1)),G.slice(0,P.length)!=P))for(;P.length>0&&(P=P.slice(0,P.length-1),P=P.slice(0,P.lastIndexOf("/")+1),G.slice(0,P.length)!=P););var he=(H[1]||"").match(/boundary="(.*?)"/);if(!he)throw new Error("MAD cannot find boundary");var me="--"+(he[1]||""),ce=[],ue=[],de={FileIndex:ce,FullPaths:ue};F(de);var ke,Fe=0;for(j=0;j<H.length;++j){var Ne=H[j];Ne!==me&&Ne!==me+"--"||(Fe++&&am(de,H.slice(ke,j),P),ke=j)}return de}function Kl(M,z){var P=z||{},H=P.boundary||"SheetJS";H="------="+H;for(var j=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+H.slice(2)+'"',"","",""],G=M.FullPaths[0],he=G,me=M.FileIndex[0],ce=1;ce<M.FullPaths.length;++ce)if(he=M.FullPaths[ce].slice(G.length),me=M.FileIndex[ce],!(!me.size||!me.content||he=="Sh33tJ5")){he=he.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ye){return"_x"+Ye.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ye){return"_u"+Ye.charCodeAt(0).toString(16)+"_"});for(var ue=me.content,de=xt&&Buffer.isBuffer(ue)?ue.toString("binary"):ae(ue),ke=0,Fe=Math.min(1024,de.length),Ne=0,Re=0;Re<=Fe;++Re)(Ne=de.charCodeAt(Re))>=32&&Ne<128&&++ke;var Oe=ke>=Fe*4/5;j.push(H),j.push("Content-Location: "+(P.root||"file:///C:/SheetJS/")+he),j.push("Content-Transfer-Encoding: "+(Oe?"quoted-printable":"base64")),j.push("Content-Type: "+Zu(me,he)),j.push(""),j.push(Oe?dv(de):Wl(de))}return j.push(H+`--\r
`),j.join(`\r
`)}function pv(M){var z={};return F(z,M),z}function Ju(M,z,P,H){var j=H&&H.unsafe;j||F(M);var G=!j&&_t.find(M,z);if(!G){var he=M.FullPaths[0];z.slice(0,he.length)==he?he=z:(he.slice(-1)!="/"&&(he+="/"),he=(he+z).replace("//","/")),G={name:a(z),type:2},M.FileIndex.push(G),M.FullPaths.push(he),j||_t.utils.cfb_gc(M)}return G.content=P,G.size=P?P.length:0,H&&(H.CLSID&&(G.clsid=H.CLSID),H.mt&&(G.mt=H.mt),H.ct&&(G.ct=H.ct)),G}function im(M,z){F(M);var P=_t.find(M,z);if(P){for(var H=0;H<M.FileIndex.length;++H)if(M.FileIndex[H]==P)return M.FileIndex.splice(H,1),M.FullPaths.splice(H,1),!0}return!1}function sm(M,z,P){F(M);var H=_t.find(M,z);if(H){for(var j=0;j<M.FileIndex.length;++j)if(M.FileIndex[j]==H)return M.FileIndex[j].name=a(P),M.FullPaths[j]=P,!0}return!1}function om(M){B(M,!0)}return t.find=Z,t.read=I,t.parse=d,t.write=V,t.writeFile=De,t.utils={cfb_new:pv,cfb_add:Ju,cfb_del:im,cfb_mov:sm,cfb_gc:om,ReadShift:$0,CheckField:AR,prep_blob:ln,bconcat:al,use_zlib:U,_deflateRaw:rt,_inflateRaw:em,consts:oe},t}();function DP(n){if(typeof Deno<"u")return Deno.readFileSync(n);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(n);t.open("r"),t.encoding="binary";var e=t.read();return t.close(),e}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+n)}function vs(n){for(var t=Object.keys(n),e=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(n,t[r])&&e.push(t[r]);return e}function VA(n){for(var t=[],e=vs(n),r=0;r!==e.length;++r)t[n[e[r]]]=e[r];return t}var mx=new Date(1899,11,30,0,0,0);function qn(n,t){var e=n.getTime(),r=mx.getTime()+(n.getTimezoneOffset()-mx.getTimezoneOffset())*6e4;return(e-r)/(24*60*60*1e3)}var tR=new Date,FP=mx.getTime()+(tR.getTimezoneOffset()-mx.getTimezoneOffset())*6e4,YT=tR.getTimezoneOffset();function tv(n){var t=new Date;return t.setTime(n*24*60*60*1e3+FP),t.getTimezoneOffset()!==YT&&t.setTime(t.getTime()+(t.getTimezoneOffset()-YT)*6e4),t}function MP(n){var t=0,e=0,r=!1,a=n.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+n+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(e=1,s>3&&(r=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":e*=24;case"H":e*=60;case"M":if(r)e*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=e*parseInt(a[s],10)}return t}var WT=new Date("2017-02-19T19:06:09.000Z"),rR=isNaN(WT.getFullYear())?new Date("2/19/17"):WT,LP=rR.getFullYear()==2017;function Kr(n,t){var e=new Date(n);if(LP)return t>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):t<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(n instanceof Date)return n;if(rR.getFullYear()==1917&&!isNaN(e.getFullYear())){var r=e.getFullYear();return n.indexOf(""+r)>-1||e.setFullYear(e.getFullYear()+100),e}var a=n.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return n.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Lu(n,t){if(xt&&Buffer.isBuffer(n)){if(t){if(n[0]==255&&n[1]==254)return T0(n.slice(2).toString("utf16le"));if(n[1]==254&&n[2]==255)return T0(jC(n.slice(2).toString("binary")))}return n.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(n[0]==255&&n[1]==254)return T0(new TextDecoder("utf-16le").decode(n.slice(2)));if(n[0]==254&&n[1]==255)return T0(new TextDecoder("utf-16be").decode(n.slice(2)))}var e={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(s){return e[s]||s})}catch{}for(var r=[],a=0;a!=n.length;++a)r.push(String.fromCharCode(n[a]));return r.join("")}function cn(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var t={};for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=cn(n[e]));return t}function ur(n,t){for(var e="";e.length<t;)e+=n;return e}function Ii(n){var t=Number(n);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(n))return t;var e=1,r=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(t=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,s){return e=-e,s}),!isNaN(t=Number(r)))?t/e:t}var NP=["january","february","march","april","may","june","july","august","september","october","november","december"];function sd(n){var t=new Date(n),e=new Date(NaN),r=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return e;var l=n.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&NP.indexOf(l)==-1)return e}else if(l.match(/[a-z]/))return e;return r<0||r>8099?e:(a>0||s>1)&&r!=101?t:n.match(/[^-0-9:,\/\\]/)?e:t}var PP=function(){var n="abacaba".split(/(:?b)/i).length==5;return function(e,r,a){if(n||typeof r=="string")return e.split(r);for(var s=e.split(r),l=[s[0]],c=1;c<s.length;++c)l.push(a),l.push(s[c]);return l}}();function nR(n){return n?n.content&&n.type?Lu(n.content,!0):n.data?E0(n.data):n.asNodeBuffer&&xt?E0(n.asNodeBuffer().toString("binary")):n.asBinary?E0(n.asBinary()):n._data&&n._data.getContent?E0(Lu(Array.prototype.slice.call(n._data.getContent(),0))):null:null}function aR(n){if(!n)return null;if(n.data)return IT(n.data);if(n.asNodeBuffer&&xt)return n.asNodeBuffer();if(n._data&&n._data.getContent){var t=n._data.getContent();return typeof t=="string"?IT(t):Array.prototype.slice.call(t)}return n.content&&n.type?n.content:null}function IP(n){return n&&n.name.slice(-4)===".bin"?aR(n):nR(n)}function Qa(n,t){for(var e=n.FullPaths||vs(n.files),r=t.toLowerCase().replace(/[\/]/g,"\\"),a=r.replace(/\\/g,"/"),s=0;s<e.length;++s){var l=e[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==l||a==l)return n.files?n.files[e[s]]:n.FileIndex[s]}return null}function $A(n,t){var e=Qa(n,t);if(e==null)throw new Error("Cannot find file "+t+" in zip");return e}function br(n,t,e){if(!e)return IP($A(n,t));if(!t)return null;try{return br(n,t)}catch{return null}}function Oa(n,t,e){if(!e)return nR($A(n,t));if(!t)return null;try{return Oa(n,t)}catch{return null}}function BP(n,t,e){return aR($A(n,t))}function KT(n){for(var t=n.FullPaths||vs(n.files),e=[],r=0;r<t.length;++r)t[r].slice(-1)!="/"&&e.push(t[r].replace(/^Root Entry[\/]/,""));return e.sort()}function UP(n,t,e){if(n.FullPaths){if(typeof e=="string"){var r;return xt?r=Gu(e):r=aP(e),_t.utils.cfb_add(n,t,r)}_t.utils.cfb_add(n,t,e)}else n.file(t,e)}function iR(n,t){switch(t.type){case"base64":return _t.read(n,{type:"base64"});case"binary":return _t.read(n,{type:"binary"});case"buffer":case"array":return _t.read(n,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function S0(n,t){if(n.charAt(0)=="/")return n.slice(1);var e=t.split("/");t.slice(-1)!="/"&&e.pop();for(var r=n.split("/");r.length!==0;){var a=r.shift();a===".."?e.pop():a!=="."&&e.push(a)}return e.join("/")}var sR=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,HP=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,QT=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,zP=/<[^>]*>/g,Rn=sR.match(QT)?QT:zP,jP=/<\w*:/,GP=/<(\/?)\w+:/;function qe(n,t,e){for(var r={},a=0,s=0;a!==n.length&&!((s=n.charCodeAt(a))===32||s===10||s===13);++a);if(t||(r[0]=n.slice(0,a)),a===n.length)return r;var l=n.match(HP),c=0,h="",f=0,d="",m="",x=1;if(l)for(f=0;f!=l.length;++f){for(m=l[f],s=0;s!=m.length&&m.charCodeAt(s)!==61;++s);for(d=m.slice(0,s).trim();m.charCodeAt(s+1)==32;)++s;for(x=(a=m.charCodeAt(s+1))==34||a==39?1:0,h=m.slice(s+1+x,m.length-x),c=0;c!=d.length&&d.charCodeAt(c)!==58;++c);if(c===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),r[d]=h,r[d.toLowerCase()]=h;else{var _=(c===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(c+1);if(r[_]&&d.slice(c-3,c)=="ext")continue;r[_]=h,r[_.toLowerCase()]=h}}return r}function ws(n){return n.replace(GP,"<$1")}var oR={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},VP=VA(oR),wt=function(){var n=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function e(r){var a=r+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(n,function(c,h){return oR[c]||String.fromCharCode(parseInt(h,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,h){return String.fromCharCode(parseInt(h,16))});var l=a.indexOf("]]>");return e(a.slice(0,s))+a.slice(s+9,l)+e(a.slice(l+3))}}(),$P=/[&<>'"]/g,XP=/[\u0000-\u001f]/g;function XA(n){var t=n+"";return t.replace($P,function(e){return VP[e]}).replace(/\n/g,"<br/>").replace(XP,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var ZT=function(){var n=/&#(\d+);/g;function t(e,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(n,t)}}();function Zt(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Dy(n){for(var t="",e=0,r=0,a=0,s=0,l=0,c=0;e<n.length;){if(r=n.charCodeAt(e++),r<128){t+=String.fromCharCode(r);continue}if(a=n.charCodeAt(e++),r>191&&r<224){l=(r&31)<<6,l|=a&63,t+=String.fromCharCode(l);continue}if(s=n.charCodeAt(e++),r<240){t+=String.fromCharCode((r&15)<<12|(a&63)<<6|s&63);continue}l=n.charCodeAt(e++),c=((r&7)<<18|(a&63)<<12|(s&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function JT(n){var t=zl(2*n.length),e,r,a=1,s=0,l=0,c;for(r=0;r<n.length;r+=a)a=1,(c=n.charCodeAt(r))<128?e=c:c<224?(e=(c&31)*64+(n.charCodeAt(r+1)&63),a=2):c<240?(e=(c&15)*4096+(n.charCodeAt(r+1)&63)*64+(n.charCodeAt(r+2)&63),a=3):(a=4,e=(c&7)*262144+(n.charCodeAt(r+1)&63)*4096+(n.charCodeAt(r+2)&63)*64+(n.charCodeAt(r+3)&63),e-=65536,l=55296+(e>>>10&1023),e=56320+(e&1023)),l!==0&&(t[s++]=l&255,t[s++]=l>>>8,l=0),t[s++]=e%256,t[s++]=e>>>8;return t.slice(0,s).toString("ucs2")}function ek(n){return Gu(n,"binary").toString("utf8")}var w1="foo bar baz",Vt=xt&&(ek(w1)==Dy(w1)&&ek||JT(w1)==Dy(w1)&&JT)||Dy,T0=xt?function(n){return Gu(n,"utf8").toString("binary")}:function(n){for(var t=[],e=0,r=0,a=0;e<n.length;)switch(r=n.charCodeAt(e++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=n.charCodeAt(e++)-56320+(r<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)))}return t.join("")},ip=function(){var n={};return function(e,r){var a=e+"|"+(r||"");return n[a]?n[a]:n[a]=new RegExp("<(?:\\w+:)?"+e+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+e+">",r||"")}}(),lR=function(){var n=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(e){for(var r=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<n.length;++a)r=r.replace(n[a][0],n[a][1]);return r}}(),qP=function(){var n={};return function(e){return n[e]!==void 0?n[e]:n[e]=new RegExp("<(?:vt:)?"+e+">([\\s\\S]*?)</(?:vt:)?"+e+">","g")}}(),YP=/<\/?(?:vt:)?variant>/g,WP=/<(?:vt:)([^>]*)>([\s\S]*)</;function tk(n,t){var e=qe(n),r=n.match(qP(e.baseType))||[],a=[];if(r.length!=e.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+e.size);return a}return r.forEach(function(s){var l=s.replace(YP,"").match(WP);l&&a.push({v:Vt(l[2]),t:l[1]})}),a}var KP=/(^\s|\s$|\n)/;function QP(n){return vs(n).map(function(t){return" "+t+'="'+n[t]+'"'}).join("")}function ZP(n,t,e){return"<"+n+(e!=null?QP(e):"")+(t!=null?(t.match(KP)?' xml:space="preserve"':"")+">"+t+"</"+n:"/")+">"}function qA(n){if(xt&&Buffer.isBuffer(n))return n.toString("utf8");if(typeof n=="string")return n;if(typeof Uint8Array<"u"&&n instanceof Uint8Array)return Vt(Vu(zA(n)));throw new Error("Bad input format: expected Buffer or string")}var sp=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,JP={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},e6=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function t6(n,t){for(var e=1-2*(n[t+7]>>>7),r=((n[t+7]&127)<<4)+(n[t+6]>>>4&15),a=n[t+6]&15,s=5;s>=0;--s)a=a*256+n[t+s];return r==2047?a==0?e*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),e*Math.pow(2,r-52)*a)}function r6(n,t,e){var r=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,l=r?-t:t;isFinite(l)?l==0?a=s=0:(a=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var c=0;c<=5;++c,s/=256)n[e+c]=s&255;n[e+6]=(a&15)<<4|s&15,n[e+7]=a>>4|r}var rk=function(n){for(var t=[],e=10240,r=0;r<n[0].length;++r)if(n[0][r])for(var a=0,s=n[0][r].length;a<s;a+=e)t.push.apply(t,n[0][r].slice(a,a+e));return t},nk=xt?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(t){return Buffer.isBuffer(t)?t:Gu(t)})):rk(n)}:rk,ak=function(n,t,e){for(var r=[],a=t;a<e;a+=2)r.push(String.fromCharCode(vo(n,a)));return r.join("").replace(Gn,"")},YA=xt?function(n,t,e){return Buffer.isBuffer(n)?n.toString("utf16le",t,e).replace(Gn,""):ak(n,t,e)}:ak,ik=function(n,t,e){for(var r=[],a=t;a<t+e;++a)r.push(("0"+n[a].toString(16)).slice(-2));return r.join("")},cR=xt?function(n,t,e){return Buffer.isBuffer(n)?n.toString("hex",t,t+e):ik(n,t,e)}:ik,sk=function(n,t,e){for(var r=[],a=t;a<e;a++)r.push(String.fromCharCode(Nh(n,a)));return r.join("")},Vg=xt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf8",e,r):sk(t,e,r)}:sk,uR=function(n,t){var e=Ca(n,t);return e>0?Vg(n,t+4,t+4+e-1):""},hR=uR,fR=function(n,t){var e=Ca(n,t);return e>0?Vg(n,t+4,t+4+e-1):""},dR=fR,pR=function(n,t){var e=2*Ca(n,t);return e>0?Vg(n,t+4,t+4+e-1):""},gR=pR,mR=function(t,e){var r=Ca(t,e);return r>0?YA(t,e+4,e+4+r):""},xR=mR,vR=function(n,t){var e=Ca(n,t);return e>0?Vg(n,t+4,t+4+e):""},_R=vR,yR=function(n,t){return t6(n,t)},xx=yR,wR=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};xt&&(hR=function(t,e){if(!Buffer.isBuffer(t))return uR(t,e);var r=t.readUInt32LE(e);return r>0?t.toString("utf8",e+4,e+4+r-1):""},dR=function(t,e){if(!Buffer.isBuffer(t))return fR(t,e);var r=t.readUInt32LE(e);return r>0?t.toString("utf8",e+4,e+4+r-1):""},gR=function(t,e){if(!Buffer.isBuffer(t))return pR(t,e);var r=2*t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+r-1)},xR=function(t,e){if(!Buffer.isBuffer(t))return mR(t,e);var r=t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+r)},_R=function(t,e){if(!Buffer.isBuffer(t))return vR(t,e);var r=t.readUInt32LE(e);return t.toString("utf8",e+4,e+4+r)},xx=function(t,e){return Buffer.isBuffer(t)?t.readDoubleLE(e):yR(t,e)},wR=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Nh=function(n,t){return n[t]},vo=function(n,t){return n[t+1]*256+n[t]},n6=function(n,t){var e=n[t+1]*256+n[t];return e<32768?e:(65535-e+1)*-1},Ca=function(n,t){return n[t+3]*(1<<24)+(n[t+2]<<16)+(n[t+1]<<8)+n[t]},Ec=function(n,t){return n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t]},a6=function(n,t){return n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3]};function $0(n,t){var e="",r,a,s=[],l,c,h,f;switch(t){case"dbcs":if(f=this.l,xt&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*n).toString("utf16le");else for(h=0;h<n;++h)e+=String.fromCharCode(vo(this,f)),f+=2;n*=2;break;case"utf8":e=Vg(this,this.l,this.l+n);break;case"utf16le":n*=2,e=YA(this,this.l,this.l+n);break;case"wstr":return $0.call(this,n,"dbcs");case"lpstr-ansi":e=hR(this,this.l),n=4+Ca(this,this.l);break;case"lpstr-cp":e=dR(this,this.l),n=4+Ca(this,this.l);break;case"lpwstr":e=gR(this,this.l),n=4+2*Ca(this,this.l);break;case"lpp4":n=4+Ca(this,this.l),e=xR(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+Ca(this,this.l),e=_R(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,e="";(l=Nh(this,this.l+n++))!==0;)s.push(y1(l));e=s.join("");break;case"_wstr":for(n=0,e="";(l=vo(this,this.l+n))!==0;)s.push(y1(l)),n+=2;n+=2,e=s.join("");break;case"dbcs-cont":for(e="",f=this.l,h=0;h<n;++h){if(this.lens&&this.lens.indexOf(f)!==-1)return l=Nh(this,f),this.l=f+1,c=$0.call(this,n-h,l?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(y1(vo(this,f))),f+=2}e=s.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(e="",f=this.l,h=0;h!=n;++h){if(this.lens&&this.lens.indexOf(f)!==-1)return l=Nh(this,f),this.l=f+1,c=$0.call(this,n-h,l?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(y1(Nh(this,f))),f+=1}e=s.join("");break;default:switch(n){case 1:return r=Nh(this,this.l),this.l++,r;case 2:return r=(t==="i"?n6:vo)(this,this.l),this.l+=2,r;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(r=(n>0?Ec:a6)(this,this.l),this.l+=4,r):(a=Ca(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return n==8?a=xx(this,this.l):a=xx([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;n=8;case 16:e=cR(this,this.l,n);break}}return this.l+=n,e}var i6=function(n,t,e){n[e]=t&255,n[e+1]=t>>>8&255,n[e+2]=t>>>16&255,n[e+3]=t>>>24&255},s6=function(n,t,e){n[e]=t&255,n[e+1]=t>>8&255,n[e+2]=t>>16&255,n[e+3]=t>>24&255},o6=function(n,t,e){n[e]=t&255,n[e+1]=t>>>8&255};function l6(n,t,e){var r=0,a=0;if(e==="dbcs"){for(a=0;a!=t.length;++a)o6(this,t.charCodeAt(a),this.l+2*a);r=2*t.length}else if(e==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;r=t.length}else if(e==="hex"){for(;a<n;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(e==="utf16le"){var s=Math.min(this.l+n,this.length);for(a=0;a<Math.min(t.length,n);++a){var l=t.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(n){case 1:r=1,this[this.l]=t&255;break;case 2:r=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:r=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:r=4,i6(this,t,this.l);break;case 8:if(r=8,e==="f"){r6(this,t,this.l);break}case 16:break;case-4:r=4,s6(this,t,this.l);break}return this.l+=r,this}function AR(n,t){var e=cR(this,this.l,n.length>>1);if(e!==n)throw new Error(t+"Expected "+n+" saw "+e);this.l+=n.length>>1}function ln(n,t){n.l=t,n.read_shift=$0,n.chk=AR,n.write_shift=l6}function Cn(n,t){n.l+=t}function Lr(n){var t=zl(n);return ln(t,0),t}function Co(n,t,e){if(n){var r,a,s;ln(n,n.l||0);for(var l=n.length,c=0,h=0;n.l<l;){c=n.read_shift(1),c&128&&(c=(c&127)+((n.read_shift(1)&127)<<7));var f=Ex[c]||Ex[65535];for(r=n.read_shift(1),s=r&127,a=1;a<4&&r&128;++a)s+=((r=n.read_shift(1))&127)<<7*a;h=n.l+s;var d=f.f&&f.f(n,s,e);if(n.l=h,t(d,f,c))return}}}function rw(){var n=[],t=xt?256:2048,e=function(f){var d=Lr(f);return ln(d,0),d},r=e(t),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&n.push(r),r=null)},s=function(f){return r&&f<r.length-r.l?r:(a(),r=e(Math.max(f+1,t)))},l=function(){return a(),al(n)},c=function(f){a(),r=f,r.l==null&&(r.l=r.length),s(t)};return{next:s,push:c,end:l,_bufs:n}}function X0(n,t,e){var r=cn(n);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!e||e.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function ok(n,t,e){var r=cn(n);return r.s=X0(r.s,t.s,e),r.e=X0(r.e,t.s,e),r}function q0(n,t){if(n.cRel&&n.c<0)for(n=cn(n);n.c<0;)n.c+=t>8?16384:256;if(n.rRel&&n.r<0)for(n=cn(n);n.r<0;)n.r+=t>8?1048576:t>5?65536:16384;var e=Je(n);return!n.cRel&&n.cRel!=null&&(e=h6(e)),!n.rRel&&n.rRel!=null&&(e=c6(e)),e}function Fy(n,t){return n.s.r==0&&!n.s.rRel&&n.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+Nr(n.s.c)+":"+(n.e.cRel?"":"$")+Nr(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(t.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+un(n.s.r)+":"+(n.e.rRel?"":"$")+un(n.e.r):q0(n.s,t.biff)+":"+q0(n.e,t.biff)}function WA(n){return parseInt(u6(n),10)-1}function un(n){return""+(n+1)}function c6(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function u6(n){return n.replace(/\$(\d+)$/,"$1")}function KA(n){for(var t=f6(n),e=0,r=0;r!==t.length;++r)e=26*e+t.charCodeAt(r)-64;return e-1}function Nr(n){if(n<0)throw new Error("invalid column "+n);var t="";for(++n;n;n=Math.floor((n-1)/26))t=String.fromCharCode((n-1)%26+65)+t;return t}function h6(n){return n.replace(/^([A-Z])/,"$$$1")}function f6(n){return n.replace(/^\$([A-Z])/,"$1")}function d6(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function jn(n){for(var t=0,e=0,r=0;r<n.length;++r){var a=n.charCodeAt(r);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(e=26*e+(a-64))}return{c:e-1,r:t-1}}function Je(n){for(var t=n.c+1,e="";t;t=(t-1)/26|0)e=String.fromCharCode((t-1)%26+65)+e;return e+(n.r+1)}function hd(n){var t=n.indexOf(":");return t==-1?{s:jn(n),e:jn(n)}:{s:jn(n.slice(0,t)),e:jn(n.slice(t+1))}}function yt(n,t){return typeof t>"u"||typeof t=="number"?yt(n.s,n.e):(typeof n!="string"&&(n=Je(n)),typeof t!="string"&&(t=Je(t)),n==t?n:n+":"+t)}function hr(n){var t={s:{c:0,r:0},e:{c:0,r:0}},e=0,r=0,a=0,s=n.length;for(e=0;r<s&&!((a=n.charCodeAt(r)-64)<1||a>26);++r)e=26*e+a;for(t.s.c=--e,e=0;r<s&&!((a=n.charCodeAt(r)-48)<0||a>9);++r)e=10*e+a;if(t.s.r=--e,r===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,e=0;r!=s&&!((a=n.charCodeAt(r)-64)<1||a>26);++r)e=26*e+a;for(t.e.c=--e,e=0;r!=s&&!((a=n.charCodeAt(r)-48)<0||a>9);++r)e=10*e+a;return t.e.r=--e,t}function lk(n,t){var e=n.t=="d"&&t instanceof Date;if(n.z!=null)try{return n.w=li(n.z,e?qn(t):t)}catch{}try{return n.w=li((n.XF||{}).numFmtId||(e?14:0),e?qn(t):t)}catch{return""+t}}function bo(n,t,e){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&e&&e.dateNF&&(n.z=e.dateNF),n.t=="e"?qu[n.v]||n.v:t==null?lk(n,n.v):lk(n,t))}function Xl(n,t){var e=t&&t.sheet?t.sheet:"Sheet1",r={};return r[e]=n,{SheetNames:[e],Sheets:r}}function ER(n,t,e){var r=e||{},a=n?Array.isArray(n):r.dense,s=n||(a?[]:{}),l=0,c=0;if(s&&r.origin!=null){if(typeof r.origin=="number")l=r.origin;else{var h=typeof r.origin=="string"?jn(r.origin):r.origin;l=h.r,c=h.c}s["!ref"]||(s["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=hr(s["!ref"]);f.s.c=d.s.c,f.s.r=d.s.r,f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),l==-1&&(f.e.r=l=d.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=t[m].length;++x)if(!(typeof t[m][x]>"u")){var _={v:t[m][x]},y=l+m,A=c+x;if(f.s.r>y&&(f.s.r=y),f.s.c>A&&(f.s.c=A),f.e.r<y&&(f.e.r=y),f.e.c<A&&(f.e.c=A),t[m][x]&&typeof t[m][x]=="object"&&!Array.isArray(t[m][x])&&!(t[m][x]instanceof Date))_=t[m][x];else if(Array.isArray(_.v)&&(_.f=t[m][x][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(r.nullError)_.t="e",_.v=0;else if(r.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=r.dateNF||et[14],r.cellDates?(_.t="d",_.w=li(_.z,qn(_.v))):(_.t="n",_.v=qn(_.v),_.w=li(_.z,_.v))):_.t="s";if(a)s[y]||(s[y]=[]),s[y][A]&&s[y][A].z&&(_.z=s[y][A].z),s[y][A]=_;else{var E=Je({c:A,r:y});s[E]&&s[E].z&&(_.z=s[E].z),s[E]=_}}}return f.s.c<1e7&&(s["!ref"]=yt(f)),s}function fd(n,t){return ER(null,n,t)}function p6(n){return n.read_shift(4,"i")}function kn(n){var t=n.read_shift(4);return t===0?"":n.read_shift(t,"dbcs")}function g6(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function QA(n,t){var e=n.l,r=n.read_shift(1),a=kn(n),s=[],l={t:a,h:a};if(r&1){for(var c=n.read_shift(4),h=0;h!=c;++h)s.push(g6(n));l.r=s}else l.r=[{ich:0,ifnt:0}];return n.l=e+t,l}var m6=QA;function ci(n){var t=n.read_shift(4),e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:t,iStyleRef:e}}function $u(n){var t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:t}}var x6=kn;function ZA(n){var t=n.read_shift(4);return t===0||t===4294967295?"":n.read_shift(t,"dbcs")}var v6=kn,nw=ZA;function JA(n){var t=n.slice(n.l,n.l+4),e=t[0]&1,r=t[0]&2;n.l+=4;var a=r===0?xx([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ec(t,0)>>2;return e?a/100:a}function bR(n){var t={s:{},e:{}};return t.s.r=n.read_shift(4),t.e.r=n.read_shift(4),t.s.c=n.read_shift(4),t.e.c=n.read_shift(4),t}var Xu=bR;function bn(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function _6(n){var t={},e=n.read_shift(1),r=e>>>1,a=n.read_shift(1),s=n.read_shift(2,"i"),l=n.read_shift(1),c=n.read_shift(1),h=n.read_shift(1);switch(n.l++,r){case 0:t.auto=1;break;case 1:t.index=a;var f=Fu[a];f&&(t.rgb=lp(f));break;case 2:t.rgb=lp([l,c,h]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function y6(n){var t=n.read_shift(1);n.l++;var e={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return e}function SR(n,t){var e={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=n.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return e[n.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return n.l-=4,n.read_shift(0,t==1?"lpstr":"lpwstr")}function w6(n){return SR(n,1)}function A6(n){return SR(n,2)}var eE=2,sa=3,A1=11,ck=12,vx=19,E1=64,E6=65,b6=71,S6=4108,T6=4126,Wr=80,TR=81,k6=[Wr,TR],C6={1:{n:"CodePage",t:eE},2:{n:"Category",t:Wr},3:{n:"PresentationFormat",t:Wr},4:{n:"ByteCount",t:sa},5:{n:"LineCount",t:sa},6:{n:"ParagraphCount",t:sa},7:{n:"SlideCount",t:sa},8:{n:"NoteCount",t:sa},9:{n:"HiddenCount",t:sa},10:{n:"MultimediaClipCount",t:sa},11:{n:"ScaleCrop",t:A1},12:{n:"HeadingPairs",t:S6},13:{n:"TitlesOfParts",t:T6},14:{n:"Manager",t:Wr},15:{n:"Company",t:Wr},16:{n:"LinksUpToDate",t:A1},17:{n:"CharacterCount",t:sa},19:{n:"SharedDoc",t:A1},22:{n:"HyperlinksChanged",t:A1},23:{n:"AppVersion",t:sa,p:"version"},24:{n:"DigSig",t:E6},26:{n:"ContentType",t:Wr},27:{n:"ContentStatus",t:Wr},28:{n:"Language",t:Wr},29:{n:"Version",t:Wr},255:{},2147483648:{n:"Locale",t:vx},2147483651:{n:"Behavior",t:vx},1919054434:{}},R6={1:{n:"CodePage",t:eE},2:{n:"Title",t:Wr},3:{n:"Subject",t:Wr},4:{n:"Author",t:Wr},5:{n:"Keywords",t:Wr},6:{n:"Comments",t:Wr},7:{n:"Template",t:Wr},8:{n:"LastAuthor",t:Wr},9:{n:"RevNumber",t:Wr},10:{n:"EditTime",t:E1},11:{n:"LastPrinted",t:E1},12:{n:"CreatedDate",t:E1},13:{n:"ModifiedDate",t:E1},14:{n:"PageCount",t:sa},15:{n:"WordCount",t:sa},16:{n:"CharCount",t:sa},17:{n:"Thumbnail",t:b6},18:{n:"Application",t:Wr},19:{n:"DocSecurity",t:sa},255:{},2147483648:{n:"Locale",t:vx},2147483651:{n:"Behavior",t:vx},1919054434:{}},uk={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},O6=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function D6(n){return n.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var F6=D6([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Fu=cn(F6),qu={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},kR={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},hk={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function M6(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function L6(n){var t=M6();if(!n||!n.match)return t;var e={};if((n.match(Rn)||[]).forEach(function(r){var a=qe(r);switch(a[0].replace(jP,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":e[a.Extension]=a.ContentType;break;case"<Override":t[hk[a.ContentType]]!==void 0&&t[hk[a.ContentType]].push(a.PartName);break}}),t.xmlns!==JP.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=e,delete t.calcchains,t}var Gh={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function aw(n){var t=n.lastIndexOf("/");return n.slice(0,t+1)+"_rels/"+n.slice(t+1)+".rels"}function Y0(n,t){var e={"!id":{}};if(!n)return e;t.charAt(0)!=="/"&&(t="/"+t);var r={};return(n.match(Rn)||[]).forEach(function(a){var s=qe(a);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var c=s.TargetMode==="External"?s.Target:S0(s.Target,t);e[c]=l,r[s.Id]=l}}),e["!id"]=r,e}var N6="application/vnd.oasis.opendocument.spreadsheet";function P6(n,t){for(var e=qA(n),r,a;r=sp.exec(e);)switch(r[3]){case"manifest":break;case"file-entry":if(a=qe(r[0],!1),a.path=="/"&&a.type!==N6)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}var W0=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],I6=function(){for(var n=new Array(W0.length),t=0;t<W0.length;++t){var e=W0[t],r="(?:"+e[0].slice(0,e[0].indexOf(":"))+":)"+e[0].slice(e[0].indexOf(":")+1);n[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return n}();function CR(n){var t={};n=Vt(n);for(var e=0;e<W0.length;++e){var r=W0[e],a=n.match(I6[e]);a!=null&&a.length>0&&(t[r[1]]=wt(a[1])),r[2]==="date"&&t[r[1]]&&(t[r[1]]=Kr(t[r[1]]))}return t}var B6=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function RR(n,t,e,r){var a=[];if(typeof n=="string")a=tk(n,r);else for(var s=0;s<n.length;++s)a=a.concat(n[s].map(function(d){return{v:d}}));var l=typeof t=="string"?tk(t,r).map(function(d){return d.v}):t,c=0,h=0;if(l.length>0)for(var f=0;f!==a.length;f+=2){switch(h=+a[f+1].v,a[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":e.Worksheets=h,e.SheetNames=l.slice(c,c+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":e.NamedRanges=h,e.DefinedNames=l.slice(c,c+h);break;case"Charts":case"Diagramme":e.Chartsheets=h,e.ChartNames=l.slice(c,c+h);break}c+=h}}function U6(n,t,e){var r={};return t||(t={}),n=Vt(n),B6.forEach(function(a){var s=(n.match(ip(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=wt(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var l=n.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(r[a[1]]=l[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&RR(r.HeadingPairs,r.TitlesOfParts,t,e),t}var H6=/<[^>]+>[^<]*/g;function z6(n,t){var e={},r="",a=n.match(H6);if(a)for(var s=0;s!=a.length;++s){var l=a[s],c=qe(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":r=wt(c.name);break;case"</property>":r=null;break;default:if(l.indexOf("<vt:")===0){var h=l.split(">"),f=h[0].slice(4),d=h[1];switch(f){case"lpstr":case"bstr":case"lpwstr":e[r]=wt(d);break;case"bool":e[r]=Zt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":e[r]=parseInt(d,10);break;case"r4":case"r8":case"decimal":e[r]=parseFloat(d);break;case"filetime":case"date":e[r]=Kr(d);break;case"cy":case"error":e[r]=wt(d);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,f,h)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return e}var j6={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},My;function G6(n,t,e){My||(My=VA(j6)),t=My[t]||t,n[t]=e}function tE(n){var t=n.read_shift(4),e=n.read_shift(4);return new Date((e/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function OR(n,t,e){var r=n.l,a=n.read_shift(0,"lpstr-cp");if(e)for(;n.l-r&3;)++n.l;return a}function DR(n,t,e){var r=n.read_shift(0,"lpwstr");return r}function FR(n,t,e){return t===31?DR(n):OR(n,t,e)}function iw(n,t,e){return FR(n,t,e===!1?0:4)}function V6(n,t){if(!t)throw new Error("VtUnalignedString must have positive length");return FR(n,t,0)}function $6(n){for(var t=n.read_shift(4),e=[],r=0;r!=t;++r){var a=n.l;e[r]=n.read_shift(0,"lpwstr").replace(Gn,""),n.l-a&2&&(n.l+=2)}return e}function X6(n){for(var t=n.read_shift(4),e=[],r=0;r!=t;++r)e[r]=n.read_shift(0,"lpstr-cp").replace(Gn,"");return e}function q6(n){var t=n.l,e=_x(n,TR);n[n.l]==0&&n[n.l+1]==0&&n.l-t&2&&(n.l+=2);var r=_x(n,sa);return[e,r]}function Y6(n){for(var t=n.read_shift(4),e=[],r=0;r<t/2;++r)e.push(q6(n));return e}function fk(n,t){for(var e=n.read_shift(4),r={},a=0;a!=e;++a){var s=n.read_shift(4),l=n.read_shift(4);r[s]=n.read_shift(l,t===1200?"utf16le":"utf8").replace(Gn,"").replace(b0,"!"),t===1200&&l%2&&(n.l+=2)}return n.l&3&&(n.l=n.l>>3<<2),r}function MR(n){var t=n.read_shift(4),e=n.slice(n.l,n.l+t);return n.l+=t,(t&3)>0&&(n.l+=4-(t&3)&3),e}function W6(n){var t={};return t.Size=n.read_shift(4),n.l+=t.Size+3-(t.Size-1)%4,t}function _x(n,t,e){var r=n.read_shift(2),a,s=e||{};if(n.l+=2,t!==ck&&r!==t&&k6.indexOf(t)===-1&&!((t&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+t+" saw "+r);switch(t===ck?r:t){case 2:return a=n.read_shift(2,"i"),s.raw||(n.l+=2),a;case 3:return a=n.read_shift(4,"i"),a;case 11:return n.read_shift(4)!==0;case 19:return a=n.read_shift(4),a;case 30:return OR(n,r,4).replace(Gn,"");case 31:return DR(n);case 64:return tE(n);case 65:return MR(n);case 71:return W6(n);case 80:return iw(n,r,!s.raw).replace(Gn,"");case 81:return V6(n,r).replace(Gn,"");case 4108:return Y6(n);case 4126:case 4127:return r==4127?$6(n):X6(n);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}}function dk(n,t){var e=n.l,r=n.read_shift(4),a=n.read_shift(4),s=[],l=0,c=0,h=-1,f={};for(l=0;l!=a;++l){var d=n.read_shift(4),m=n.read_shift(4);s[l]=[d,m+e]}s.sort(function(C,S){return C[1]-S[1]});var x={};for(l=0;l!=a;++l){if(n.l!==s[l][1]){var _=!0;if(l>0&&t)switch(t[s[l-1][0]].t){case 2:n.l+2===s[l][1]&&(n.l+=2,_=!1);break;case 80:n.l<=s[l][1]&&(n.l=s[l][1],_=!1);break;case 4108:n.l<=s[l][1]&&(n.l=s[l][1],_=!1);break}if((!t||l==0)&&n.l<=s[l][1]&&(_=!1,n.l=s[l][1]),_)throw new Error("Read Error: Expected address "+s[l][1]+" at "+n.l+" :"+l)}if(t){var y=t[s[l][0]];if(x[y.n]=_x(n,y.t,{raw:!0}),y.p==="version"&&(x[y.n]=String(x[y.n]>>16)+"."+("0000"+String(x[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(x[y.n]){case 0:x[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Li(c=x[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[y.n])}}else if(s[l][0]===1){if(c=x.CodePage=_x(n,eE),Li(c),h!==-1){var A=n.l;n.l=s[h][1],f=fk(n,c),n.l=A}}else if(s[l][0]===0){if(c===0){h=l,n.l=s[l+1][1];continue}f=fk(n,c)}else{var E=f[s[l][0]],b;switch(n[n.l]){case 65:n.l+=4,b=MR(n);break;case 30:n.l+=4,b=iw(n,n[n.l-4]).replace(/\u0000+$/,"");break;case 31:n.l+=4,b=iw(n,n[n.l-4]).replace(/\u0000+$/,"");break;case 3:n.l+=4,b=n.read_shift(4,"i");break;case 19:n.l+=4,b=n.read_shift(4);break;case 5:n.l+=4,b=n.read_shift(8,"f");break;case 11:n.l+=4,b=pr(n,4);break;case 64:n.l+=4,b=Kr(tE(n));break;default:throw new Error("unparsed value: "+n[n.l])}x[E]=b}}return n.l=e+r,x}function pk(n,t,e){var r=n.content;if(!r)return{};ln(r,0);var a,s,l,c,h=0;r.chk("feff","Byte Order: "),r.read_shift(2);var f=r.read_shift(4),d=r.read_shift(16);if(d!==_t.utils.consts.HEADER_CLSID&&d!==e)throw new Error("Bad PropertySet CLSID "+d);if(a=r.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=r.read_shift(16),c=r.read_shift(4),a===1&&c!==r.l)throw new Error("Length mismatch: "+c+" !== "+r.l);a===2&&(l=r.read_shift(16),h=r.read_shift(4));var m=dk(r,t),x={SystemIdentifier:f};for(var _ in m)x[_]=m[_];if(x.FMTID=s,a===1)return x;if(h-r.l==2&&(r.l+=2),r.l!==h)throw new Error("Length mismatch 2: "+r.l+" !== "+h);var y;try{y=dk(r,null)}catch{}for(_ in y)x[_]=y[_];return x.FMTID=[s,l],x}function Zo(n,t){return n.read_shift(t),null}function K6(n,t,e){for(var r=[],a=n.l+t;n.l<a;)r.push(e(n,a-n.l));if(a!==n.l)throw new Error("Slurp error");return r}function pr(n,t){return n.read_shift(t)===1}function Sr(n){return n.read_shift(2,"u")}function LR(n,t){return K6(n,t,Sr)}function Q6(n){var t=n.read_shift(1),e=n.read_shift(1);return e===1?t:t===1}function $g(n,t,e){var r=n.read_shift(e&&e.biff>=12?2:1),a="sbcs-cont";if(e&&e.biff>=8,!e||e.biff==8){var s=n.read_shift(1);s&&(a="dbcs-cont")}else e.biff==12&&(a="wstr");e.biff>=2&&e.biff<=5&&(a="cpstr");var l=r?n.read_shift(r,a):"";return l}function Z6(n){var t=n.read_shift(2),e=n.read_shift(1),r=e&4,a=e&8,s=1+(e&1),l=0,c,h={};a&&(l=n.read_shift(2)),r&&(c=n.read_shift(4));var f=s==2?"dbcs-cont":"sbcs-cont",d=t===0?"":n.read_shift(t,f);return a&&(n.l+=4*l),r&&(n.l+=c),h.t=d,a||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function Nu(n,t,e){var r;if(e){if(e.biff>=2&&e.biff<=5)return n.read_shift(t,"cpstr");if(e.biff>=12)return n.read_shift(t,"dbcs-cont")}var a=n.read_shift(1);return a===0?r=n.read_shift(t,"sbcs-cont"):r=n.read_shift(t,"dbcs-cont"),r}function Xg(n,t,e){var r=n.read_shift(e&&e.biff==2?1:2);return r===0?(n.l++,""):Nu(n,r,e)}function Yu(n,t,e){if(e.biff>5)return Xg(n,t,e);var r=n.read_shift(1);return r===0?(n.l++,""):n.read_shift(r,e.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function J6(n){var t=n.read_shift(1);n.l++;var e=n.read_shift(2);return n.l+=2,[t,e]}function e8(n){var t=n.read_shift(4),e=n.l,r=!1;t>24&&(n.l+=t-24,n.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),n.l=e);var a=n.read_shift((r?t-24:t)>>1,"utf16le").replace(Gn,"");return r&&(n.l+=24),a}function t8(n){for(var t=n.read_shift(2),e="";t-- >0;)e+="../";var r=n.read_shift(0,"lpstr-ansi");if(n.l+=2,n.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=n.read_shift(4);if(a===0)return e+r.replace(/\\/g,"/");var s=n.read_shift(4);if(n.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=n.read_shift(s>>1,"utf16le").replace(Gn,"");return e+l}function r8(n,t){var e=n.read_shift(16);switch(e){case"e0c9ea79f9bace118c8200aa004ba90b":return e8(n);case"0303000000000000c000000000000046":return t8(n);default:throw new Error("Unsupported Moniker "+e)}}function b1(n){var t=n.read_shift(4),e=t>0?n.read_shift(t,"utf16le").replace(Gn,""):"";return e}function n8(n,t){var e=n.l+t,r=n.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var a=n.read_shift(2);n.l+=2;var s,l,c,h,f="",d,m;a&16&&(s=b1(n,e-n.l)),a&128&&(l=b1(n,e-n.l)),(a&257)===257&&(c=b1(n,e-n.l)),(a&257)===1&&(h=r8(n,e-n.l)),a&8&&(f=b1(n,e-n.l)),a&32&&(d=n.read_shift(16)),a&64&&(m=tE(n)),n.l=e;var x=l||c||h||"";x&&f&&(x+="#"+f),x||(x="#"+f),a&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var _={Target:x};return d&&(_.guid=d),m&&(_.time=m),s&&(_.Tooltip=s),_}function NR(n){var t=n.read_shift(1),e=n.read_shift(1),r=n.read_shift(1),a=n.read_shift(1);return[t,e,r,a]}function PR(n,t){var e=NR(n);return e[3]=0,e}function As(n){var t=n.read_shift(2),e=n.read_shift(2),r=n.read_shift(2);return{r:t,c:e,ixfe:r}}function a8(n){var t=n.read_shift(2),e=n.read_shift(2);return n.l+=8,{type:t,flags:e}}function i8(n,t,e){return t===0?"":Yu(n,t,e)}function s8(n,t,e){var r=e.biff>8?4:2,a=n.read_shift(r),s=n.read_shift(r,"i"),l=n.read_shift(r,"i");return[a,s,l]}function IR(n){var t=n.read_shift(2),e=JA(n);return[t,e]}function o8(n,t,e){n.l+=4,t-=4;var r=n.l+t,a=$g(n,t,e),s=n.read_shift(2);if(r-=n.l,s!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+s);return n.l+=s,a}function rv(n){var t=n.read_shift(2),e=n.read_shift(2),r=n.read_shift(2),a=n.read_shift(2);return{s:{c:r,r:t},e:{c:a,r:e}}}function BR(n){var t=n.read_shift(2),e=n.read_shift(2),r=n.read_shift(1),a=n.read_shift(1);return{s:{c:r,r:t},e:{c:a,r:e}}}var l8=BR;function UR(n){n.l+=4;var t=n.read_shift(2),e=n.read_shift(2),r=n.read_shift(2);return n.l+=12,[e,t,r]}function c8(n){var t={};return n.l+=4,n.l+=16,t.fSharedNote=n.read_shift(2),n.l+=4,t}function u8(n){var t={};return n.l+=4,n.cf=n.read_shift(2),t}function pn(n){n.l+=2,n.l+=n.read_shift(2)}var h8={0:pn,4:pn,5:pn,6:pn,7:u8,8:pn,9:pn,10:pn,11:pn,12:pn,13:c8,14:pn,15:pn,16:pn,17:pn,18:pn,19:pn,20:pn,21:UR};function f8(n,t){for(var e=n.l+t,r=[];n.l<e;){var a=n.read_shift(2);n.l-=2;try{r.push(h8[a](n,e-n.l))}catch{return n.l=e,r}}return n.l!=e&&(n.l=e),r}function S1(n,t){var e={BIFFVer:0,dt:0};switch(e.BIFFVer=n.read_shift(2),t-=2,t>=2&&(e.dt=n.read_shift(2),n.l-=2),e.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+e.BIFFVer)}return n.read_shift(t),e}function d8(n,t){return t===0||n.read_shift(2),1200}function p8(n,t,e){if(e.enc)return n.l+=t,"";var r=n.l,a=Yu(n,0,e);return n.read_shift(t+r-n.l),a}function g8(n,t,e){var r=e&&e.biff==8||t==2?n.read_shift(2):(n.l+=t,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function m8(n,t,e){var r=n.read_shift(4),a=n.read_shift(1)&3,s=n.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=$g(n,0,e);return l.length===0&&(l="Sheet1"),{pos:r,hs:a,dt:s,name:l}}function x8(n,t){for(var e=n.l+t,r=n.read_shift(4),a=n.read_shift(4),s=[],l=0;l!=a&&n.l<e;++l)s.push(Z6(n));return s.Count=r,s.Unique=a,s}function v8(n,t){var e={};return e.dsst=n.read_shift(2),n.l+=t-2,e}function _8(n){var t={};t.r=n.read_shift(2),t.c=n.read_shift(2),t.cnt=n.read_shift(2)-t.c;var e=n.read_shift(2);n.l+=4;var r=n.read_shift(1);return n.l+=3,r&7&&(t.level=r&7),r&32&&(t.hidden=!0),r&64&&(t.hpt=e/20),t}function y8(n){var t=a8(n);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var e=n.read_shift(4);return e!==0}function w8(n){return n.read_shift(2),n.read_shift(4)}function gk(n,t,e){var r=0;e&&e.biff==2||(r=n.read_shift(2));var a=n.read_shift(2);e&&e.biff==2&&(r=1-(a>>15),a&=32767);var s={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[s,a]}function A8(n){var t=n.read_shift(2),e=n.read_shift(2),r=n.read_shift(2),a=n.read_shift(2),s=n.read_shift(2),l=n.read_shift(2),c=n.read_shift(2),h=n.read_shift(2),f=n.read_shift(2);return{Pos:[t,e],Dim:[r,a],Flags:s,CurTab:l,FirstTab:c,Selected:h,TabRatio:f}}function E8(n,t,e){if(e&&e.biff>=2&&e.biff<5)return{};var r=n.read_shift(2);return{RTL:r&64}}function b8(){}function S8(n,t,e){var r={dyHeight:n.read_shift(2),fl:n.read_shift(2)};switch(e&&e.biff||8){case 2:break;case 3:case 4:n.l+=2;break;default:n.l+=10;break}return r.name=$g(n,0,e),r}function T8(n){var t=As(n);return t.isst=n.read_shift(4),t}function k8(n,t,e){e.biffguess&&e.biff==2&&(e.biff=5);var r=n.l+t,a=As(n);e.biff==2&&n.l++;var s=Xg(n,r-n.l,e);return a.val=s,a}function C8(n,t,e){var r=n.read_shift(2),a=Yu(n,0,e);return[r,a]}var R8=Yu;function mk(n,t,e){var r=n.l+t,a=e.biff==8||!e.biff?4:2,s=n.read_shift(a),l=n.read_shift(a),c=n.read_shift(2),h=n.read_shift(2);return n.l=r,{s:{r:s,c},e:{r:l,c:h}}}function O8(n){var t=n.read_shift(2),e=n.read_shift(2),r=IR(n);return{r:t,c:e,ixfe:r[0],rknum:r[1]}}function D8(n,t){for(var e=n.l+t-2,r=n.read_shift(2),a=n.read_shift(2),s=[];n.l<e;)s.push(IR(n));if(n.l!==e)throw new Error("MulRK read error");var l=n.read_shift(2);if(s.length!=l-a+1)throw new Error("MulRK length mismatch");return{r,c:a,C:l,rkrec:s}}function F8(n,t){for(var e=n.l+t-2,r=n.read_shift(2),a=n.read_shift(2),s=[];n.l<e;)s.push(n.read_shift(2));if(n.l!==e)throw new Error("MulBlank read error");var l=n.read_shift(2);if(s.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r,c:a,C:l,ixfe:s}}function M8(n,t,e,r){var a={},s=n.read_shift(4),l=n.read_shift(4),c=n.read_shift(4),h=n.read_shift(2);return a.patternType=O6[c>>26],r.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=h&127,a.icvBack=h>>7&127,a.fsxButton=h>>14&1),a}function L8(n,t,e){var r={};return r.ifnt=n.read_shift(2),r.numFmtId=n.read_shift(2),r.flags=n.read_shift(2),r.fStyle=r.flags>>2&1,t-=6,r.data=M8(n,t,r.fStyle,e),r}function N8(n){n.l+=4;var t=[n.read_shift(2),n.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function xk(n,t,e){var r=As(n);(e.biff==2||t==9)&&++n.l;var a=Q6(n);return r.val=a,r.t=a===!0||a===!1?"b":"e",r}function P8(n,t,e){e.biffguess&&e.biff==2&&(e.biff=5);var r=As(n),a=bn(n);return r.val=a,r}var vk=i8;function I8(n,t,e){var r=n.l+t,a=n.read_shift(2),s=n.read_shift(2);if(e.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=Nu(n,s),c=[];r>n.l;)c.push(Xg(n));return[s,a,l,c]}function _k(n,t,e){var r=n.read_shift(2),a,s={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return e.sbcch===14849&&(a=o8(n,t-2,e)),s.body=a||n.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var B8=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function yk(n,t,e){var r=n.l+t,a=n.read_shift(2),s=n.read_shift(1),l=n.read_shift(1),c=n.read_shift(e&&e.biff==2?1:2),h=0;(!e||e.biff>=5)&&(e.biff!=5&&(n.l+=2),h=n.read_shift(2),e.biff==5&&(n.l+=2),n.l+=4);var f=Nu(n,l,e);a&32&&(f=B8[f.charCodeAt(0)]);var d=r-n.l;e&&e.biff==2&&--d;var m=r==n.l||c===0||!(d>0)?[]:_U(n,d,e,c);return{chKey:s,Name:f,itab:h,rgce:m}}function HR(n,t,e){if(e.biff<8)return U8(n,t,e);for(var r=[],a=n.l+t,s=n.read_shift(e.biff>8?4:2);s--!==0;)r.push(s8(n,e.biff>8?12:6,e));if(n.l!=a)throw new Error("Bad ExternSheet: "+n.l+" != "+a);return r}function U8(n,t,e){n[n.l+1]==3&&n[n.l]++;var r=$g(n,t,e);return r.charCodeAt(0)==3?r.slice(1):r}function H8(n,t,e){if(e.biff<8){n.l+=t;return}var r=n.read_shift(2),a=n.read_shift(2),s=Nu(n,r,e),l=Nu(n,a,e);return[s,l]}function z8(n,t,e){var r=BR(n);n.l++;var a=n.read_shift(1);return t-=8,[yU(n,t,e),a,r]}function wk(n,t,e){var r=l8(n);switch(e.biff){case 2:n.l++,t-=7;break;case 3:case 4:n.l+=2,t-=8;break;default:n.l+=6,t-=12}return[r,xU(n,t,e)]}function j8(n){var t=n.read_shift(4)!==0,e=n.read_shift(4)!==0,r=n.read_shift(4);return[t,e,r]}function G8(n,t,e){if(!(e.biff<8)){var r=n.read_shift(2),a=n.read_shift(2),s=n.read_shift(2),l=n.read_shift(2),c=Yu(n,0,e);return e.biff<8&&n.read_shift(1),[{r,c:a},c,l,s]}}function V8(n,t,e){return G8(n,t,e)}function $8(n,t){for(var e=[],r=n.read_shift(2);r--;)e.push(rv(n));return e}function X8(n,t,e){if(e&&e.biff<8)return Y8(n,t,e);var r=UR(n),a=f8(n,t-22,r[1]);return{cmo:r,ft:a}}var q8={8:function(n,t){var e=n.l+t;n.l+=10;var r=n.read_shift(2);n.l+=4,n.l+=2,n.l+=2,n.l+=2,n.l+=4;var a=n.read_shift(1);return n.l+=a,n.l=e,{fmt:r}}};function Y8(n,t,e){n.l+=4;var r=n.read_shift(2),a=n.read_shift(2),s=n.read_shift(2);n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=6,t-=36;var l=[];return l.push((q8[r]||Cn)(n,t,e)),{cmo:[a,r,s],ft:l}}function W8(n,t,e){var r=n.l,a="";try{n.l+=4;var s=(e.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?n.l+=6:l=J6(n,6,e);var c=n.read_shift(2);n.read_shift(2),Sr(n,2);var h=n.read_shift(2);n.l+=h;for(var f=1;f<n.lens.length-1;++f){if(n.l-r!=n.lens[f])throw new Error("TxO: bad continue record");var d=n[n.l],m=Nu(n,n.lens[f+1]-n.lens[f]-1);if(a+=m,a.length>=(d?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return n.l=r+t,{t:a}}catch{return n.l=r+t,{t:a}}}function K8(n,t){var e=rv(n);n.l+=16;var r=n8(n,t-24);return[e,r]}function Q8(n,t){n.read_shift(2);var e=rv(n),r=n.read_shift((t-10)/2,"dbcs-cont");return r=r.replace(Gn,""),[e,r]}function Z8(n){var t=[0,0],e;return e=n.read_shift(2),t[0]=uk[e]||e,e=n.read_shift(2),t[1]=uk[e]||e,t}function J8(n){for(var t=n.read_shift(2),e=[];t-- >0;)e.push(PR(n));return e}function eI(n){for(var t=n.read_shift(2),e=[];t-- >0;)e.push(PR(n));return e}function tI(n){n.l+=2;var t={cxfs:0,crc:0};return t.cxfs=n.read_shift(2),t.crc=n.read_shift(4),t}function zR(n,t,e){if(!e.cellStyles)return Cn(n,t);var r=e&&e.biff>=12?4:2,a=n.read_shift(r),s=n.read_shift(r),l=n.read_shift(r),c=n.read_shift(r),h=n.read_shift(2);r==2&&(n.l+=2);var f={s:a,e:s,w:l,ixfe:c,flags:h};return(e.biff>=5||!e.biff)&&(f.level=h>>8&7),f}function rI(n,t){var e={};return t<32||(n.l+=16,e.header=bn(n),e.footer=bn(n),n.l+=2),e}function nI(n,t,e){var r={area:!1};if(e.biff!=5)return n.l+=t,r;var a=n.read_shift(1);return n.l+=3,a&16&&(r.area=!0),r}var aI=As,iI=LR,sI=Xg;function oI(n){var t=n.read_shift(2),e=n.read_shift(2),r=n.read_shift(4),a={fmt:t,env:e,len:r,data:n.slice(n.l,n.l+r)};return n.l+=r,a}function lI(n,t,e){e.biffguess&&e.biff==5&&(e.biff=2);var r=As(n);++n.l;var a=Yu(n,t-7,e);return r.t="str",r.val=a,r}function cI(n){var t=As(n);++n.l;var e=bn(n);return t.t="n",t.val=e,t}function uI(n){var t=As(n);++n.l;var e=n.read_shift(2);return t.t="n",t.val=e,t}function hI(n){var t=n.read_shift(1);return t===0?(n.l++,""):n.read_shift(t,"sbcs-cont")}function fI(n,t){n.l+=6,n.l+=2,n.l+=1,n.l+=3,n.l+=1,n.l+=t-13}function dI(n,t,e){var r=n.l+t,a=As(n),s=n.read_shift(2),l=Nu(n,s,e);return n.l=r,a.t="str",a.val=l,a}var pI=[2,3,48,49,131,139,140,245],Ak=function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=VA({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(c,h){var f=[],d=zl(1);switch(h.type){case"base64":d=Mi(Ma(c));break;case"binary":d=Mi(c);break;case"buffer":case"array":d=c;break}ln(d,0);var m=d.read_shift(1),x=!!(m&136),_=!1,y=!1;switch(m){case 2:break;case 3:break;case 48:_=!0,x=!0;break;case 49:_=!0,x=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var A=0,E=521;m==2&&(A=d.read_shift(2)),d.l+=3,m!=2&&(A=d.read_shift(4)),A>1048576&&(A=1e6),m!=2&&(E=d.read_shift(2));var b=d.read_shift(2),C=h.codepage||1252;m!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(C=n[d[d.l]]),d.l+=1,d.l+=2),y&&(d.l+=36);for(var S=[],O={},L=Math.min(d.length,m==2?521:E-10-(_?264:0)),I=y?32:11;d.l<L&&d[d.l]!=13;)switch(O={},O.name=tw.utils.decode(C,d.slice(d.l,d.l+I)).replace(/[\u0000\r\n].*$/g,""),d.l+=I,O.type=String.fromCharCode(d.read_shift(1)),m!=2&&!y&&(O.offset=d.read_shift(4)),O.len=d.read_shift(1),m==2&&(O.offset=d.read_shift(2)),O.dec=d.read_shift(1),O.name.length&&S.push(O),m!=2&&(d.l+=y?13:14),O.type){case"B":(!_||O.len!=8)&&h.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(d[d.l]!==13&&(d.l=E-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=E;var F=0,W=0;for(f[0]=[],W=0;W!=S.length;++W)f[0][W]=S[W].name;for(;A-- >0;){if(d[d.l]===42){d.l+=b;continue}for(++d.l,f[++F]=[],W=0,W=0;W!=S.length;++W){var B=d.slice(d.l,d.l+S[W].len);d.l+=S[W].len,ln(B,0);var ee=tw.utils.decode(C,B);switch(S[W].type){case"C":ee.trim().length&&(f[F][W]=ee.replace(/\s+$/,""));break;case"D":ee.length===8?f[F][W]=new Date(+ee.slice(0,4),+ee.slice(4,6)-1,+ee.slice(6,8)):f[F][W]=ee;break;case"F":f[F][W]=parseFloat(ee.trim());break;case"+":case"I":f[F][W]=y?B.read_shift(-4,"i")^2147483648:B.read_shift(4,"i");break;case"L":switch(ee.trim().toUpperCase()){case"Y":case"T":f[F][W]=!0;break;case"N":case"F":f[F][W]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ee+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));f[F][W]="##MEMO##"+(y?parseInt(ee.trim(),10):B.read_shift(4));break;case"N":ee=ee.replace(/\u0000/g,"").trim(),ee&&ee!="."&&(f[F][W]=+ee||0);break;case"@":f[F][W]=new Date(B.read_shift(-8,"f")-621356832e5);break;case"T":f[F][W]=new Date((B.read_shift(4)-2440588)*864e5+B.read_shift(4));break;case"Y":f[F][W]=B.read_shift(4,"i")/1e4+B.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[F][W]=-B.read_shift(-8,"f");break;case"B":if(_&&S[W].len==8){f[F][W]=B.read_shift(8,"f");break}case"G":case"P":B.l+=S[W].len;break;case"0":if(S[W].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[W].type)}}}if(m!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return h.sheetRows&&(f=f.slice(0,h.sheetRows)),h.DBF=S,f}function r(c,h){var f=h||{};f.dateNF||(f.dateNF="yyyymmdd");var d=fd(e(c,f),f);return d["!cols"]=f.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete f.DBF,d}function a(c,h){try{return Xl(r(c,h),h)}catch(f){if(h&&h.WTF)throw f}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,h){var f=h||{};if(+f.codepage>=0&&Li(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var d=rw(),m=fw(c,{header:1,raw:!0,cellDates:!0}),x=m[0],_=m.slice(1),y=c["!cols"]||[],A=0,E=0,b=0,C=1;for(A=0;A<x.length;++A){if(((y[A]||{}).DBF||{}).name){x[A]=y[A].DBF.name,++b;continue}if(x[A]!=null){if(++b,typeof x[A]=="number"&&(x[A]=x[A].toString(10)),typeof x[A]!="string")throw new Error("DBF Invalid column name "+x[A]+" |"+typeof x[A]+"|");if(x.indexOf(x[A])!==A){for(E=0;E<1024;++E)if(x.indexOf(x[A]+"_"+E)==-1){x[A]+="_"+E;break}}}}var S=hr(c["!ref"]),O=[],L=[],I=[];for(A=0;A<=S.e.c-S.s.c;++A){var F="",W="",B=0,ee=[];for(E=0;E<_.length;++E)_[E][A]!=null&&ee.push(_[E][A]);if(ee.length==0||x[A]==null){O[A]="?";continue}for(E=0;E<ee.length;++E){switch(typeof ee[E]){case"number":W="B";break;case"string":W="C";break;case"boolean":W="L";break;case"object":W=ee[E]instanceof Date?"D":"C";break;default:W="C"}B=Math.max(B,String(ee[E]).length),F=F&&F!=W?"C":W}B>250&&(B=250),W=((y[A]||{}).DBF||{}).type,W=="C"&&y[A].DBF.len>B&&(B=y[A].DBF.len),F=="B"&&W=="N"&&(F="N",I[A]=y[A].DBF.dec,B=y[A].DBF.len),L[A]=F=="C"||W=="N"?B:s[F]||0,C+=L[A],O[A]=F}var Z=d.next(32);for(Z.write_shift(4,318902576),Z.write_shift(4,_.length),Z.write_shift(2,296+32*b),Z.write_shift(2,C),A=0;A<4;++A)Z.write_shift(4,0);for(Z.write_shift(4,0|(+t[HC]||3)<<8),A=0,E=0;A<x.length;++A)if(x[A]!=null){var te=d.next(32),ve=(x[A].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);te.write_shift(1,ve,"sbcs"),te.write_shift(1,O[A]=="?"?"C":O[A],"sbcs"),te.write_shift(4,E),te.write_shift(1,L[A]||s[O[A]]||0),te.write_shift(1,I[A]||0),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(1,0),te.write_shift(4,0),te.write_shift(4,0),E+=L[A]||s[O[A]]||0}var Ce=d.next(264);for(Ce.write_shift(4,13),A=0;A<65;++A)Ce.write_shift(4,0);for(A=0;A<_.length;++A){var Ee=d.next(C);for(Ee.write_shift(1,0),E=0;E<x.length;++E)if(x[E]!=null)switch(O[E]){case"L":Ee.write_shift(1,_[A][E]==null?63:_[A][E]?84:70);break;case"B":Ee.write_shift(8,_[A][E]||0,"f");break;case"N":var J="0";for(typeof _[A][E]=="number"&&(J=_[A][E].toFixed(I[E]||0)),b=0;b<L[E]-J.length;++b)Ee.write_shift(1,32);Ee.write_shift(1,J,"sbcs");break;case"D":_[A][E]?(Ee.write_shift(4,("0000"+_[A][E].getFullYear()).slice(-4),"sbcs"),Ee.write_shift(2,("00"+(_[A][E].getMonth()+1)).slice(-2),"sbcs"),Ee.write_shift(2,("00"+_[A][E].getDate()).slice(-2),"sbcs")):Ee.write_shift(8,"00000000","sbcs");break;case"C":var oe=String(_[A][E]!=null?_[A][E]:"").slice(0,L[E]);for(Ee.write_shift(1,oe,"sbcs"),b=0;b<L[E]-oe.length;++b)Ee.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:r,from_sheet:l}}(),gI=function(){var n={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+vs(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(x,_){var y=n[_];return typeof y=="number"?BT(y):y},r=function(x,_,y){var A=_.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return A==59?x:BT(A)};n["|"]=254;function a(x,_){switch(_.type){case"base64":return s(Ma(x),_);case"binary":return s(x,_);case"buffer":return s(xt&&Buffer.isBuffer(x)?x.toString("binary"):Vu(x),_);case"array":return s(Lu(x),_)}throw new Error("Unrecognized type "+_.type)}function s(x,_){var y=x.split(/[\n\r]+/),A=-1,E=-1,b=0,C=0,S=[],O=[],L=null,I={},F=[],W=[],B=[],ee=0,Z;for(+_.codepage>=0&&Li(+_.codepage);b!==y.length;++b){ee=0;var te=y[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,e),ve=te.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),Ce=ve[0],Ee;if(te.length>0)switch(Ce){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ve[1].charAt(0)=="P"&&O.push(te.slice(3).replace(/;;/g,";"));break;case"C":var J=!1,oe=!1,De=!1,ae=!1,V=-1,fe=-1;for(C=1;C<ve.length;++C)switch(ve[C].charAt(0)){case"A":break;case"X":E=parseInt(ve[C].slice(1))-1,oe=!0;break;case"Y":for(A=parseInt(ve[C].slice(1))-1,oe||(E=0),Z=S.length;Z<=A;++Z)S[Z]=[];break;case"K":Ee=ve[C].slice(1),Ee.charAt(0)==='"'?Ee=Ee.slice(1,Ee.length-1):Ee==="TRUE"?Ee=!0:Ee==="FALSE"?Ee=!1:isNaN(Ii(Ee))?isNaN(sd(Ee).getDate())||(Ee=Kr(Ee)):(Ee=Ii(Ee),L!==null&&ud(L)&&(Ee=tv(Ee))),J=!0;break;case"E":ae=!0;var U=Yh(ve[C].slice(1),{r:A,c:E});S[A][E]=[S[A][E],U];break;case"S":De=!0,S[A][E]=[S[A][E],"S5S"];break;case"G":break;case"R":V=parseInt(ve[C].slice(1))-1;break;case"C":fe=parseInt(ve[C].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+te)}if(J&&(S[A][E]&&S[A][E].length==2?S[A][E][0]=Ee:S[A][E]=Ee,L=null),De){if(ae)throw new Error("SYLK shared formula cannot have own formula");var Q=V>-1&&S[V][fe];if(!Q||!Q[1])throw new Error("SYLK shared formula cannot find base");S[A][E][1]=QR(Q[1],{r:A-V,c:E-fe})}break;case"F":var X=0;for(C=1;C<ve.length;++C)switch(ve[C].charAt(0)){case"X":E=parseInt(ve[C].slice(1))-1,++X;break;case"Y":for(A=parseInt(ve[C].slice(1))-1,Z=S.length;Z<=A;++Z)S[Z]=[];break;case"M":ee=parseInt(ve[C].slice(1))/20;break;case"F":break;case"G":break;case"P":L=O[parseInt(ve[C].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(B=ve[C].slice(1).split(" "),Z=parseInt(B[0],10);Z<=parseInt(B[1],10);++Z)ee=parseInt(B[2],10),W[Z-1]=ee===0?{hidden:!0}:{wch:ee},od(W[Z-1]);break;case"C":E=parseInt(ve[C].slice(1))-1,W[E]||(W[E]={});break;case"R":A=parseInt(ve[C].slice(1))-1,F[A]||(F[A]={}),ee>0?(F[A].hpt=ee,F[A].hpx=cp(ee)):ee===0&&(F[A].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+te)}X<1&&(L=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+te)}}return F.length>0&&(I["!rows"]=F),W.length>0&&(I["!cols"]=W),_&&_.sheetRows&&(S=S.slice(0,_.sheetRows)),[S,I]}function l(x,_){var y=a(x,_),A=y[0],E=y[1],b=fd(A,_);return vs(E).forEach(function(C){b[C]=E[C]}),b}function c(x,_){return Xl(l(x,_),_)}function h(x,_,y,A){var E="C;Y"+(y+1)+";X"+(A+1)+";K";switch(x.t){case"n":E+=x.v||0,x.f&&!x.F&&(E+=";E"+tB(x.f,{r:y,c:A}));break;case"b":E+=x.v?"TRUE":"FALSE";break;case"e":E+=x.w||x.v;break;case"d":E+='"'+(x.w||x.v)+'"';break;case"s":E+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function f(x,_){_.forEach(function(y,A){var E="F;W"+(A+1)+" "+(A+1)+" ";y.hidden?E+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=wx(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=Ax(y.wpx)),typeof y.wch=="number"&&(E+=Math.round(y.wch))),E.charAt(E.length-1)!=" "&&x.push(E)})}function d(x,_){_.forEach(function(y,A){var E="F;";y.hidden?E+="M0;":y.hpt?E+="M"+20*y.hpt+";":y.hpx&&(E+="M"+20*YR(y.hpx)+";"),E.length>2&&x.push(E+"R"+(A+1))})}function m(x,_){var y=["ID;PWXL;N;E"],A=[],E=hr(x["!ref"]),b,C=Array.isArray(x),S=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),x["!cols"]&&f(y,x["!cols"]),x["!rows"]&&d(y,x["!rows"]),y.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var O=E.s.r;O<=E.e.r;++O)for(var L=E.s.c;L<=E.e.c;++L){var I=Je({r:O,c:L});b=C?(x[O]||[])[L]:x[I],!(!b||b.v==null&&(!b.f||b.F))&&A.push(h(b,x,O,L))}return y.join(S)+S+A.join(S)+S+"E"+S}return{to_workbook:c,to_sheet:l,from_sheet:m}}(),mI=function(){function n(s,l){switch(l.type){case"base64":return t(Ma(s),l);case"binary":return t(s,l);case"buffer":return t(xt&&Buffer.isBuffer(s)?s.toString("binary"):Vu(s),l);case"array":return t(Lu(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){for(var c=s.split(`
`),h=-1,f=-1,d=0,m=[];d!==c.length;++d){if(c[d].trim()==="BOT"){m[++h]=[],f=0;continue}if(!(h<0)){var x=c[d].trim().split(","),_=x[0],y=x[1];++d;for(var A=c[d]||"";(A.match(/["]/g)||[]).length&1&&d<c.length-1;)A+=`
`+c[++d];switch(A=A.trim(),+_){case-1:if(A==="BOT"){m[++h]=[],f=0;continue}else if(A!=="EOD")throw new Error("Unrecognized DIF special command "+A);break;case 0:A==="TRUE"?m[h][f]=!0:A==="FALSE"?m[h][f]=!1:isNaN(Ii(y))?isNaN(sd(y).getDate())?m[h][f]=y:m[h][f]=Kr(y):m[h][f]=Ii(y),++f;break;case 1:A=A.slice(1,A.length-1),A=A.replace(/""/g,'"'),A&&A.match(/^=".*"$/)&&(A=A.slice(2,-1)),m[h][f++]=A!==""?A:null;break}if(A==="EOD")break}}return l&&l.sheetRows&&(m=m.slice(0,l.sheetRows)),m}function e(s,l){return fd(n(s,l),l)}function r(s,l){return Xl(e(s,l),l)}var a=function(){var s=function(h,f,d,m,x){h.push(f),h.push(d+","+m),h.push('"'+x.replace(/"/g,'""')+'"')},l=function(h,f,d,m){h.push(f+","+d),h.push(f==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(h){var f=[],d=hr(h["!ref"]),m,x=Array.isArray(h);s(f,"TABLE",0,1,"sheetjs"),s(f,"VECTORS",0,d.e.r-d.s.r+1,""),s(f,"TUPLES",0,d.e.c-d.s.c+1,""),s(f,"DATA",0,0,"");for(var _=d.s.r;_<=d.e.r;++_){l(f,-1,0,"BOT");for(var y=d.s.c;y<=d.e.c;++y){var A=Je({r:_,c:y});if(m=x?(h[_]||[])[y]:h[A],!m){l(f,1,0,"");continue}switch(m.t){case"n":var E=m.w;!E&&m.v!=null&&(E=m.v),E==null?m.f&&!m.F?l(f,1,0,"="+m.f):l(f,1,0,""):l(f,0,E,"V");break;case"b":l(f,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":l(f,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=li(m.z||et[14],qn(Kr(m.v)))),l(f,0,m.w,"V");break;default:l(f,1,0,"")}}}l(f,-1,0,"EOD");var b=`\r
`,C=f.join(b);return C}}();return{to_workbook:r,to_sheet:e,from_sheet:a}}(),xI=function(){function n(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(m,x){for(var _=m.split(`
`),y=-1,A=-1,E=0,b=[];E!==_.length;++E){var C=_[E].trim().split(":");if(C[0]==="cell"){var S=jn(C[1]);if(b.length<=S.r)for(y=b.length;y<=S.r;++y)b[y]||(b[y]=[]);switch(y=S.r,A=S.c,C[2]){case"t":b[y][A]=n(C[3]);break;case"v":b[y][A]=+C[3];break;case"vtf":var O=C[C.length-1];case"vtc":switch(C[3]){case"nl":b[y][A]=!!+C[4];break;default:b[y][A]=+C[4];break}C[2]=="vtf"&&(b[y][A]=[b[y][A],O])}}}return x&&x.sheetRows&&(b=b.slice(0,x.sheetRows)),b}function r(m,x){return fd(e(m,x),x)}function a(m,x){return Xl(r(m,x),x)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function f(m){if(!m||!m["!ref"])return"";for(var x=[],_=[],y,A="",E=hd(m["!ref"]),b=Array.isArray(m),C=E.s.r;C<=E.e.r;++C)for(var S=E.s.c;S<=E.e.c;++S)if(A=Je({r:C,c:S}),y=b?(m[C]||[])[S]:m[A],!(!y||y.v==null||y.t==="z")){switch(_=["cell",A,"t"],y.t){case"s":case"str":_.push(t(y.v));break;case"n":y.f?(_[2]="vtf",_[3]="n",_[4]=y.v,_[5]=t(y.f)):(_[2]="v",_[3]=y.v);break;case"b":_[2]="vt"+(y.f?"f":"c"),_[3]="nl",_[4]=y.v?"1":"0",_[5]=t(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var O=qn(Kr(y.v));_[2]="vtc",_[3]="nd",_[4]=""+O,_[5]=y.w||li(y.z||et[14],O);break;case"e":continue}x.push(_.join(":"))}return x.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function d(m){return[s,l,c,l,f(m),h].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:d}}(),op=function(){function n(d,m,x,_,y){y.raw?m[x][_]=d:d===""||(d==="TRUE"?m[x][_]=!0:d==="FALSE"?m[x][_]=!1:isNaN(Ii(d))?isNaN(sd(d).getDate())?m[x][_]=d:m[x][_]=Kr(d):m[x][_]=Ii(d))}function t(d,m){var x=m||{},_=[];if(!d||d.length===0)return _;for(var y=d.split(/[\r\n]/),A=y.length-1;A>=0&&y[A].length===0;)--A;for(var E=10,b=0,C=0;C<=A;++C)b=y[C].indexOf(" "),b==-1?b=y[C].length:b++,E=Math.max(E,b);for(C=0;C<=A;++C){_[C]=[];var S=0;for(n(y[C].slice(0,E).trim(),_,C,S,x),S=1;S<=(y[C].length-E)/10+1;++S)n(y[C].slice(E+(S-1)*10,E+S*10).trim(),_,C,S,x)}return x.sheetRows&&(_=_.slice(0,x.sheetRows)),_}var e={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(d){for(var m={},x=!1,_=0,y=0;_<d.length;++_)(y=d.charCodeAt(_))==34?x=!x:!x&&y in e&&(m[y]=(m[y]||0)+1);y=[];for(_ in m)Object.prototype.hasOwnProperty.call(m,_)&&y.push([m[_],_]);if(!y.length){m=r;for(_ in m)Object.prototype.hasOwnProperty.call(m,_)&&y.push([m[_],_])}return y.sort(function(A,E){return A[0]-E[0]||r[A[1]]-r[E[1]]}),e[y.pop()[1]]||44}function s(d,m){var x=m||{},_="",y=x.dense?[]:{},A={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(_=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(_=d.charAt(4),d=d.slice(6)):_=a(d.slice(0,1024)):x.FS?_=x.FS:_=a(d.slice(0,1024));var E=0,b=0,C=0,S=0,O=0,L=_.charCodeAt(0),I=!1,F=0,W=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var B=x.dateNF!=null?CP(x.dateNF):null;function ee(){var Z=d.slice(S,O),te={};if(Z.charAt(0)=='"'&&Z.charAt(Z.length-1)=='"'&&(Z=Z.slice(1,-1).replace(/""/g,'"')),Z.length===0)te.t="z";else if(x.raw)te.t="s",te.v=Z;else if(Z.trim().length===0)te.t="s",te.v=Z;else if(Z.charCodeAt(0)==61)Z.charCodeAt(1)==34&&Z.charCodeAt(Z.length-1)==34?(te.t="s",te.v=Z.slice(2,-1).replace(/""/g,'"')):nB(Z)?(te.t="n",te.f=Z.slice(1)):(te.t="s",te.v=Z);else if(Z=="TRUE")te.t="b",te.v=!0;else if(Z=="FALSE")te.t="b",te.v=!1;else if(!isNaN(C=Ii(Z)))te.t="n",x.cellText!==!1&&(te.w=Z),te.v=C;else if(!isNaN(sd(Z).getDate())||B&&Z.match(B)){te.z=x.dateNF||et[14];var ve=0;B&&Z.match(B)&&(Z=RP(Z,x.dateNF,Z.match(B)||[]),ve=1),x.cellDates?(te.t="d",te.v=Kr(Z,ve)):(te.t="n",te.v=qn(Kr(Z,ve))),x.cellText!==!1&&(te.w=li(te.z,te.v instanceof Date?qn(te.v):te.v)),x.cellNF||delete te.z}else te.t="s",te.v=Z;if(te.t=="z"||(x.dense?(y[E]||(y[E]=[]),y[E][b]=te):y[Je({c:b,r:E})]=te),S=O+1,W=d.charCodeAt(S),A.e.c<b&&(A.e.c=b),A.e.r<E&&(A.e.r=E),F==L)++b;else if(b=0,++E,x.sheetRows&&x.sheetRows<=E)return!0}e:for(;O<d.length;++O)switch(F=d.charCodeAt(O)){case 34:W===34&&(I=!I);break;case L:case 10:case 13:if(!I&&ee())break e;break}return O-S>0&&ee(),y["!ref"]=yt(A),y}function l(d,m){return!(m&&m.PRN)||m.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,m):fd(t(d,m),m)}function c(d,m){var x="",_=m.type=="string"?[0,0,0,0]:cE(d,m);switch(m.type){case"base64":x=Ma(d);break;case"binary":x=d;break;case"buffer":m.codepage==65001?x=d.toString("utf8"):(m.codepage,x=xt&&Buffer.isBuffer(d)?d.toString("binary"):Vu(d));break;case"array":x=Lu(d);break;case"string":x=d;break;default:throw new Error("Unrecognized type "+m.type)}return _[0]==239&&_[1]==187&&_[2]==191?x=Vt(x.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?x=Vt(x):m.type=="binary",x.slice(0,19)=="socialcalc:version:"?xI.to_sheet(m.type=="string"?x:Vt(x),m):l(x,m)}function h(d,m){return Xl(c(d,m),m)}function f(d){for(var m=[],x=hr(d["!ref"]),_,y=Array.isArray(d),A=x.s.r;A<=x.e.r;++A){for(var E=[],b=x.s.c;b<=x.e.c;++b){var C=Je({r:A,c:b});if(_=y?(d[A]||[])[b]:d[C],!_||_.v==null){E.push("          ");continue}for(var S=(_.w||(bo(_),_.w)||"").slice(0,10);S.length<10;)S+=" ";E.push(S+(b===0?" ":""))}m.push(E.join(""))}return m.join(`
`)}return{to_workbook:h,to_sheet:c,from_sheet:f}}();function vI(n,t){var e=t||{},r=!!e.WTF;e.WTF=!0;try{var a=gI.to_workbook(n,e);return e.WTF=r,a}catch(s){if(e.WTF=r,!s.message.match(/SYLK bad record ID/)&&r)throw s;return op.to_workbook(n,t)}}var K0=function(){function n(U,Q,X){if(U){ln(U,U.l||0);for(var K=X.Enum||V;U.l<U.length;){var se=U.read_shift(2),_e=K[se]||K[65535],be=U.read_shift(2),Te=U.l+be,ye=_e.f&&_e.f(U,be,X);if(U.l=Te,Q(ye,_e,se))return}}}function t(U,Q){switch(Q.type){case"base64":return e(Mi(Ma(U)),Q);case"binary":return e(Mi(U),Q);case"buffer":case"array":return e(U,Q)}throw"Unsupported type "+Q.type}function e(U,Q){if(!U)return U;var X=Q||{},K=X.dense?[]:{},se="Sheet1",_e="",be=0,Te={},ye=[],Ke=[],Y={s:{r:0,c:0},e:{r:0,c:0}},Rt=X.sheetRows||0;if(U[2]==0&&(U[3]==8||U[3]==9)&&U.length>=16&&U[14]==5&&U[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(U[2]==2)X.Enum=V,n(U,function(Me,Bt,hn){switch(hn){case 0:X.vers=Me,Me>=4096&&(X.qpro=!0);break;case 6:Y=Me;break;case 204:Me&&(_e=Me);break;case 222:_e=Me;break;case 15:case 51:X.qpro||(Me[1].v=Me[1].v.slice(1));case 13:case 14:case 16:hn==14&&(Me[2]&112)==112&&(Me[2]&15)>1&&(Me[2]&15)<15&&(Me[1].z=X.dateNF||et[14],X.cellDates&&(Me[1].t="d",Me[1].v=tv(Me[1].v))),X.qpro&&Me[3]>be&&(K["!ref"]=yt(Y),Te[se]=K,ye.push(se),K=X.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},be=Me[3],se=_e||"Sheet"+(be+1),_e="");var Yn=X.dense?(K[Me[0].r]||[])[Me[0].c]:K[Je(Me[0])];if(Yn){Yn.t=Me[1].t,Yn.v=Me[1].v,Me[1].z!=null&&(Yn.z=Me[1].z),Me[1].f!=null&&(Yn.f=Me[1].f);break}X.dense?(K[Me[0].r]||(K[Me[0].r]=[]),K[Me[0].r][Me[0].c]=Me[1]):K[Je(Me[0])]=Me[1];break}},X);else if(U[2]==26||U[2]==14)X.Enum=fe,U[2]==14&&(X.qpro=!0,U.l=0),n(U,function(Me,Bt,hn){switch(hn){case 204:se=Me;break;case 22:Me[1].v=Me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Me[3]>be&&(K["!ref"]=yt(Y),Te[se]=K,ye.push(se),K=X.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},be=Me[3],se="Sheet"+(be+1)),Rt>0&&Me[0].r>=Rt)break;X.dense?(K[Me[0].r]||(K[Me[0].r]=[]),K[Me[0].r][Me[0].c]=Me[1]):K[Je(Me[0])]=Me[1],Y.e.c<Me[0].c&&(Y.e.c=Me[0].c),Y.e.r<Me[0].r&&(Y.e.r=Me[0].r);break;case 27:Me[14e3]&&(Ke[Me[14e3][0]]=Me[14e3][1]);break;case 1537:Ke[Me[0]]=Me[1],Me[0]==be&&(se=Me[1]);break}},X);else throw new Error("Unrecognized LOTUS BOF "+U[2]);if(K["!ref"]=yt(Y),Te[_e||se]=K,ye.push(_e||se),!Ke.length)return{SheetNames:ye,Sheets:Te};for(var ft={},Et=[],Qe=0;Qe<Ke.length;++Qe)Te[ye[Qe]]?(Et.push(Ke[Qe]||ye[Qe]),ft[Ke[Qe]]=Te[Ke[Qe]]||Te[ye[Qe]]):(Et.push(Ke[Qe]),ft[Ke[Qe]]={"!ref":"A1"});return{SheetNames:Et,Sheets:ft}}function r(U,Q){var X=Q||{};if(+X.codepage>=0&&Li(+X.codepage),X.type=="string")throw new Error("Cannot write WK1 to JS string");var K=rw(),se=hr(U["!ref"]),_e=Array.isArray(U),be=[];xi(K,0,s(1030)),xi(K,6,h(se));for(var Te=Math.min(se.e.r,8191),ye=se.s.r;ye<=Te;++ye)for(var Ke=un(ye),Y=se.s.c;Y<=se.e.c;++Y){ye===se.s.r&&(be[Y]=Nr(Y));var Rt=be[Y]+Ke,ft=_e?(U[ye]||[])[Y]:U[Rt];if(!(!ft||ft.t=="z"))if(ft.t=="n")(ft.v|0)==ft.v&&ft.v>=-32768&&ft.v<=32767?xi(K,13,_(ye,Y,ft.v)):xi(K,14,A(ye,Y,ft.v));else{var Et=bo(ft);xi(K,15,m(ye,Y,Et.slice(0,239)))}}return xi(K,1),K.end()}function a(U,Q){var X=Q||{};if(+X.codepage>=0&&Li(+X.codepage),X.type=="string")throw new Error("Cannot write WK3 to JS string");var K=rw();xi(K,0,l(U));for(var se=0,_e=0;se<U.SheetNames.length;++se)(U.Sheets[U.SheetNames[se]]||{})["!ref"]&&xi(K,27,ae(U.SheetNames[se],_e++));var be=0;for(se=0;se<U.SheetNames.length;++se){var Te=U.Sheets[U.SheetNames[se]];if(!(!Te||!Te["!ref"])){for(var ye=hr(Te["!ref"]),Ke=Array.isArray(Te),Y=[],Rt=Math.min(ye.e.r,8191),ft=ye.s.r;ft<=Rt;++ft)for(var Et=un(ft),Qe=ye.s.c;Qe<=ye.e.c;++Qe){ft===ye.s.r&&(Y[Qe]=Nr(Qe));var Me=Y[Qe]+Et,Bt=Ke?(Te[ft]||[])[Qe]:Te[Me];if(!(!Bt||Bt.t=="z"))if(Bt.t=="n")xi(K,23,ee(ft,Qe,be,Bt.v));else{var hn=bo(Bt);xi(K,22,F(ft,Qe,be,hn.slice(0,239)))}}++be}}return xi(K,1),K.end()}function s(U){var Q=Lr(2);return Q.write_shift(2,U),Q}function l(U){var Q=Lr(26);Q.write_shift(2,4096),Q.write_shift(2,4),Q.write_shift(4,0);for(var X=0,K=0,se=0,_e=0;_e<U.SheetNames.length;++_e){var be=U.SheetNames[_e],Te=U.Sheets[be];if(!(!Te||!Te["!ref"])){++se;var ye=hd(Te["!ref"]);X<ye.e.r&&(X=ye.e.r),K<ye.e.c&&(K=ye.e.c)}}return X>8191&&(X=8191),Q.write_shift(2,X),Q.write_shift(1,se),Q.write_shift(1,K),Q.write_shift(2,0),Q.write_shift(2,0),Q.write_shift(1,1),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(4,0),Q}function c(U,Q,X){var K={s:{c:0,r:0},e:{c:0,r:0}};return Q==8&&X.qpro?(K.s.c=U.read_shift(1),U.l++,K.s.r=U.read_shift(2),K.e.c=U.read_shift(1),U.l++,K.e.r=U.read_shift(2),K):(K.s.c=U.read_shift(2),K.s.r=U.read_shift(2),Q==12&&X.qpro&&(U.l+=2),K.e.c=U.read_shift(2),K.e.r=U.read_shift(2),Q==12&&X.qpro&&(U.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function h(U){var Q=Lr(8);return Q.write_shift(2,U.s.c),Q.write_shift(2,U.s.r),Q.write_shift(2,U.e.c),Q.write_shift(2,U.e.r),Q}function f(U,Q,X){var K=[{c:0,r:0},{t:"n",v:0},0,0];return X.qpro&&X.vers!=20768?(K[0].c=U.read_shift(1),K[3]=U.read_shift(1),K[0].r=U.read_shift(2),U.l+=2):(K[2]=U.read_shift(1),K[0].c=U.read_shift(2),K[0].r=U.read_shift(2)),K}function d(U,Q,X){var K=U.l+Q,se=f(U,Q,X);if(se[1].t="s",X.vers==20768){U.l++;var _e=U.read_shift(1);return se[1].v=U.read_shift(_e,"utf8"),se}return X.qpro&&U.l++,se[1].v=U.read_shift(K-U.l,"cstr"),se}function m(U,Q,X){var K=Lr(7+X.length);K.write_shift(1,255),K.write_shift(2,Q),K.write_shift(2,U),K.write_shift(1,39);for(var se=0;se<K.length;++se){var _e=X.charCodeAt(se);K.write_shift(1,_e>=128?95:_e)}return K.write_shift(1,0),K}function x(U,Q,X){var K=f(U,Q,X);return K[1].v=U.read_shift(2,"i"),K}function _(U,Q,X){var K=Lr(7);return K.write_shift(1,255),K.write_shift(2,Q),K.write_shift(2,U),K.write_shift(2,X,"i"),K}function y(U,Q,X){var K=f(U,Q,X);return K[1].v=U.read_shift(8,"f"),K}function A(U,Q,X){var K=Lr(13);return K.write_shift(1,255),K.write_shift(2,Q),K.write_shift(2,U),K.write_shift(8,X,"f"),K}function E(U,Q,X){var K=U.l+Q,se=f(U,Q,X);if(se[1].v=U.read_shift(8,"f"),X.qpro)U.l=K;else{var _e=U.read_shift(2);O(U.slice(U.l,U.l+_e),se),U.l+=_e}return se}function b(U,Q,X){var K=Q&32768;return Q&=-32769,Q=(K?U:0)+(Q>=8192?Q-16384:Q),(K?"":"$")+(X?Nr(Q):un(Q))}var C={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(U,Q){ln(U,0);for(var X=[],K=0,se="",_e="",be="",Te="";U.l<U.length;){var ye=U[U.l++];switch(ye){case 0:X.push(U.read_shift(8,"f"));break;case 1:_e=b(Q[0].c,U.read_shift(2),!0),se=b(Q[0].r,U.read_shift(2),!1),X.push(_e+se);break;case 2:{var Ke=b(Q[0].c,U.read_shift(2),!0),Y=b(Q[0].r,U.read_shift(2),!1);_e=b(Q[0].c,U.read_shift(2),!0),se=b(Q[0].r,U.read_shift(2),!1),X.push(Ke+Y+":"+_e+se)}break;case 3:if(U.l<U.length){console.error("WK1 premature formula end");return}break;case 4:X.push("("+X.pop()+")");break;case 5:X.push(U.read_shift(2));break;case 6:{for(var Rt="";ye=U[U.l++];)Rt+=String.fromCharCode(ye);X.push('"'+Rt.replace(/"/g,'""')+'"')}break;case 8:X.push("-"+X.pop());break;case 23:X.push("+"+X.pop());break;case 22:X.push("NOT("+X.pop()+")");break;case 20:case 21:Te=X.pop(),be=X.pop(),X.push(["AND","OR"][ye-20]+"("+be+","+Te+")");break;default:if(ye<32&&S[ye])Te=X.pop(),be=X.pop(),X.push(be+S[ye]+Te);else if(C[ye]){if(K=C[ye][1],K==69&&(K=U[U.l++]),K>X.length){console.error("WK1 bad formula parse 0x"+ye.toString(16)+":|"+X.join("|")+"|");return}var ft=X.slice(-K);X.length-=K,X.push(C[ye][0]+"("+ft.join(",")+")")}else return ye<=7?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=24?console.error("WK1 unsupported op "+ye.toString(16)):ye<=30?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=115?console.error("WK1 unsupported function opcode "+ye.toString(16)):console.error("WK1 unrecognized opcode "+ye.toString(16))}}X.length==1?Q[1].f=""+X[0]:console.error("WK1 bad formula parse |"+X.join("|")+"|")}function L(U){var Q=[{c:0,r:0},{t:"n",v:0},0];return Q[0].r=U.read_shift(2),Q[3]=U[U.l++],Q[0].c=U[U.l++],Q}function I(U,Q){var X=L(U);return X[1].t="s",X[1].v=U.read_shift(Q-4,"cstr"),X}function F(U,Q,X,K){var se=Lr(6+K.length);se.write_shift(2,U),se.write_shift(1,X),se.write_shift(1,Q),se.write_shift(1,39);for(var _e=0;_e<K.length;++_e){var be=K.charCodeAt(_e);se.write_shift(1,be>=128?95:be)}return se.write_shift(1,0),se}function W(U,Q){var X=L(U);X[1].v=U.read_shift(2);var K=X[1].v>>1;if(X[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return X[1].v=K,X}function B(U,Q){var X=L(U),K=U.read_shift(4),se=U.read_shift(4),_e=U.read_shift(2);if(_e==65535)return K===0&&se===3221225472?(X[1].t="e",X[1].v=15):K===0&&se===3489660928?(X[1].t="e",X[1].v=42):X[1].v=0,X;var be=_e&32768;return _e=(_e&32767)-16446,X[1].v=(1-be*2)*(se*Math.pow(2,_e+32)+K*Math.pow(2,_e)),X}function ee(U,Q,X,K){var se=Lr(14);if(se.write_shift(2,U),se.write_shift(1,X),se.write_shift(1,Q),K==0)return se.write_shift(4,0),se.write_shift(4,0),se.write_shift(2,65535),se;var _e=0,be=0,Te=0,ye=0;return K<0&&(_e=1,K=-K),be=Math.log2(K)|0,K/=Math.pow(2,be-31),ye=K>>>0,ye&2147483648||(K/=2,++be,ye=K>>>0),K-=ye,ye|=2147483648,ye>>>=0,K*=Math.pow(2,32),Te=K>>>0,se.write_shift(4,Te),se.write_shift(4,ye),be+=16383+(_e?32768:0),se.write_shift(2,be),se}function Z(U,Q){var X=B(U);return U.l+=Q-14,X}function te(U,Q){var X=L(U),K=U.read_shift(4);return X[1].v=K>>6,X}function ve(U,Q){var X=L(U),K=U.read_shift(8,"f");return X[1].v=K,X}function Ce(U,Q){var X=ve(U);return U.l+=Q-10,X}function Ee(U,Q){return U[U.l+Q-1]==0?U.read_shift(Q,"cstr"):""}function J(U,Q){var X=U[U.l++];X>Q-1&&(X=Q-1);for(var K="";K.length<X;)K+=String.fromCharCode(U[U.l++]);return K}function oe(U,Q,X){if(!(!X.qpro||Q<21)){var K=U.read_shift(1);U.l+=17,U.l+=1,U.l+=2;var se=U.read_shift(Q-21,"cstr");return[K,se]}}function De(U,Q){for(var X={},K=U.l+Q;U.l<K;){var se=U.read_shift(2);if(se==14e3){for(X[se]=[0,""],X[se][0]=U.read_shift(2);U[U.l];)X[se][1]+=String.fromCharCode(U[U.l]),U.l++;U.l++}}return X}function ae(U,Q){var X=Lr(5+U.length);X.write_shift(2,14e3),X.write_shift(2,Q);for(var K=0;K<U.length;++K){var se=U.charCodeAt(K);X[X.l++]=se>127?95:se}return X[X.l++]=0,X}var V={0:{n:"BOF",f:Sr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ee},222:{n:"SHEETNAMELP",f:J},65535:{n:""}},fe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:B},24:{n:"NUMBER18",f:W},25:{n:"FORMULA19",f:Z},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:De},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:te},38:{n:"??"},39:{n:"NUMBER27",f:ve},40:{n:"FORMULA28",f:Ce},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:t}}();function _I(n){var t={},e=n.match(Rn),r=0,a=!1;if(e)for(;r!=e.length;++r){var s=qe(e[r]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=UA[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var yI=function(){var n=ip("t"),t=ip("rPr");function e(s){var l=s.match(n);if(!l)return{t:"s",v:""};var c={t:"s",v:wt(l[1])},h=s.match(t);return h&&(c.s=_I(h[1])),c}var r=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(r,"").split(a).map(e).filter(function(c){return c.v})}}(),wI=function(){var t=/(\r\n|\n)/g;function e(a,s,l){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),s.push('<span style="'+c.join("")+'">'),a.b&&(s.push("<b>"),l.push("</b>")),a.i&&(s.push("<i>"),l.push("</i>")),a.strike&&(s.push("<s>"),l.push("</s>"));var h=a.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(s.push("<"+h+">"),l.push("</"+h+">")),l.push("</span>"),a}function r(a){var s=[[],a.v,[]];return a.v?(a.s&&e(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(r).join("")}}(),AI=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,EI=/<(?:\w+:)?r>/,bI=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function rE(n,t){var e=t?t.cellHTML:!0,r={};return n?(n.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=wt(Vt(n.slice(n.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Vt(n),e&&(r.h=XA(r.t))):n.match(EI)&&(r.r=Vt(n),r.t=wt(Vt((n.replace(bI,"").match(AI)||[]).join("").replace(Rn,""))),e&&(r.h=wI(yI(r.r)))),r):{t:""}}var SI=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,TI=/<(?:\w+:)?(?:si|sstItem)>/g,kI=/<\/(?:\w+:)?(?:si|sstItem)>/;function CI(n,t){var e=[],r="";if(!n)return e;var a=n.match(SI);if(a){r=a[2].replace(TI,"").split(kI);for(var s=0;s!=r.length;++s){var l=rE(r[s].trim(),t);l!=null&&(e[e.length]=l)}a=qe(a[1]),e.Count=a.count,e.Unique=a.uniqueCount}return e}function RI(n){return[n.read_shift(4),n.read_shift(4)]}function OI(n,t){var e=[],r=!1;return Co(n,function(s,l,c){switch(c){case 159:e.Count=s[0],e.Unique=s[1];break;case 19:e.push(s);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(l.T,!r||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),e}function jR(n){for(var t=[],e=n.split(""),r=0;r<e.length;++r)t[r]=e[r].charCodeAt(0);return t}function wo(n,t){var e={};return e.Major=n.read_shift(2),e.Minor=n.read_shift(2),t>=4&&(n.l+=t-4),e}function DI(n){var t={};return t.id=n.read_shift(0,"lpp4"),t.R=wo(n,4),t.U=wo(n,4),t.W=wo(n,4),t}function FI(n){for(var t=n.read_shift(4),e=n.l+t-4,r={},a=n.read_shift(4),s=[];a-- >0;)s.push({t:n.read_shift(4),v:n.read_shift(0,"lpp4")});if(r.name=n.read_shift(0,"lpp4"),r.comps=s,n.l!=e)throw new Error("Bad DataSpaceMapEntry: "+n.l+" != "+e);return r}function MI(n){var t=[];n.l+=4;for(var e=n.read_shift(4);e-- >0;)t.push(FI(n));return t}function LI(n){var t=[];n.l+=4;for(var e=n.read_shift(4);e-- >0;)t.push(n.read_shift(0,"lpp4"));return t}function NI(n){var t={};return n.read_shift(4),n.l+=4,t.id=n.read_shift(0,"lpp4"),t.name=n.read_shift(0,"lpp4"),t.R=wo(n,4),t.U=wo(n,4),t.W=wo(n,4),t}function PI(n){var t=NI(n);if(t.ename=n.read_shift(0,"8lpp4"),t.blksz=n.read_shift(4),t.cmode=n.read_shift(4),n.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function GR(n,t){var e=n.l+t,r={};r.Flags=n.read_shift(4)&63,n.l+=4,r.AlgID=n.read_shift(4);var a=!1;switch(r.AlgID){case 26126:case 26127:case 26128:a=r.Flags==36;break;case 26625:a=r.Flags==4;break;case 0:a=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=n.read_shift(4),r.KeySize=n.read_shift(4),r.ProviderType=n.read_shift(4),n.l+=8,r.CSPName=n.read_shift(e-n.l>>1,"utf16le"),n.l=e,r}function VR(n,t){var e={},r=n.l+t;return n.l+=4,e.Salt=n.slice(n.l,n.l+16),n.l+=16,e.Verifier=n.slice(n.l,n.l+16),n.l+=16,n.read_shift(4),e.VerifierHash=n.slice(n.l,r),n.l=r,e}function II(n){var t=wo(n);switch(t.Minor){case 2:return[t.Minor,BI(n)];case 3:return[t.Minor,UI()];case 4:return[t.Minor,HI(n)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function BI(n){var t=n.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var e=n.read_shift(4),r=GR(n,e),a=VR(n,n.length-n.l);return{t:"Std",h:r,v:a}}function UI(){throw new Error("File is password-protected: ECMA-376 Extensible")}function HI(n){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];n.l+=4;var e=n.read_shift(n.length-n.l,"utf8"),r={};return e.replace(Rn,function(s){var l=qe(s);switch(ws(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){r[c]=l[c]});break;case"<dataIntegrity":r.encryptedHmacKey=l.encryptedHmacKey,r.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(l);break;default:throw l[0]}}),r}function zI(n,t){var e={},r=e.EncryptionVersionInfo=wo(n,4);if(t-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);e.Flags=n.read_shift(4),t-=4;var a=n.read_shift(4);return t-=4,e.EncryptionHeader=GR(n,a),t-=a,e.EncryptionVerifier=VR(n,t),e}function jI(n){var t={},e=t.EncryptionVersionInfo=wo(n,4);if(e.Major!=1||e.Minor!=1)throw"unrecognized version code "+e.Major+" : "+e.Minor;return t.Salt=n.read_shift(16),t.EncryptedVerifier=n.read_shift(16),t.EncryptedVerifierHash=n.read_shift(16),t}function GI(n){var t=0,e,r=jR(n),a=r.length+1,s,l,c,h,f;for(e=zl(a),e[0]=r.length,s=1;s!=a;++s)e[s]=r[s-1];for(s=a-1;s>=0;--s)l=e[s],c=t&16384?1:0,h=t<<1&32767,f=c|h,t=f^l;return t^52811}var $R=function(){var n=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],e=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(l){return(l/2|l*128)&255},a=function(l,c){return r(l^c)},s=function(l){for(var c=t[l.length-1],h=104,f=l.length-1;f>=0;--f)for(var d=l[f],m=0;m!=7;++m)d&64&&(c^=e[h]),d*=2,--h;return c};return function(l){for(var c=jR(l),h=s(c),f=c.length,d=zl(16),m=0;m!=16;++m)d[m]=0;var x,_,y;for((f&1)===1&&(x=h>>8,d[f]=a(n[0],x),--f,x=h&255,_=c[c.length-1],d[f]=a(_,x));f>0;)--f,x=h>>8,d[f]=a(c[f],x),--f,x=h&255,d[f]=a(c[f],x);for(f=15,y=15-c.length;y>0;)x=h>>8,d[f]=a(n[y],x),--f,--y,x=h&255,d[f]=a(c[f],x),--f,--y;return d}}(),VI=function(n,t,e,r,a){a||(a=t),r||(r=$R(n));var s,l;for(s=0;s!=t.length;++s)l=t[s],l^=r[e],l=(l>>5|l<<3)&255,a[s]=l,++e;return[a,e,r]},$I=function(n){var t=0,e=$R(n);return function(r){var a=VI("",r,t,e);return t=a[1],a[0]}};function XI(n,t,e,r){var a={key:Sr(n),verificationBytes:Sr(n)};return e.password&&(a.verifier=GI(e.password)),r.valid=a.verificationBytes===a.verifier,r.valid&&(r.insitu=$I(e.password)),a}function qI(n,t,e){var r=e;return r.Info=n.read_shift(2),n.l-=2,r.Info===1?r.Data=jI(n):r.Data=zI(n,t),r}function YI(n,t,e){var r={Type:e.biff>=8?n.read_shift(2):0};return r.Type?qI(n,t-2,r):XI(n,e.biff>=8?t:t-2,e,r),r}var WI=function(){function n(a,s){switch(s.type){case"base64":return t(Ma(a),s);case"binary":return t(a,s);case"buffer":return t(xt&&Buffer.isBuffer(a)?a.toString("binary"):Vu(a),s);case"array":return t(Lu(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var l=s||{},c=l.dense?[]:{},h=a.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(d,m){Array.isArray(c)&&(c[m]=[]);for(var x=/\\\w+\b/g,_=0,y,A=-1;y=x.exec(d);){switch(y[0]){case"\\cell":var E=d.slice(_,x.lastIndex-y[0].length);if(E[0]==" "&&(E=E.slice(1)),++A,E.length){var b={v:E,t:"s"};Array.isArray(c)?c[m][A]=b:c[Je({r:m,c:A})]=b}break}_=x.lastIndex}A>f.e.c&&(f.e.c=A)}),c["!ref"]=yt(f),c}function e(a,s){return Xl(n(a,s),s)}function r(a){for(var s=["{\\rtf1\\ansi"],l=hr(a["!ref"]),c,h=Array.isArray(a),f=l.s.r;f<=l.e.r;++f){s.push("\\trowd\\trautofit1");for(var d=l.s.c;d<=l.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=l.s.c;d<=l.e.c;++d){var m=Je({r:f,c:d});c=h?(a[f]||[])[d]:a[m],!(!c||c.v==null&&(!c.f||c.F))&&(s.push(" "+(c.w||(bo(c),c.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:e,to_sheet:n,from_sheet:r}}();function KI(n){var t=n.slice(n[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function lp(n){for(var t=0,e=1;t!=3;++t)e=e*256+(n[t]>255?255:n[t]<0?0:n[t]);return e.toString(16).toUpperCase().slice(1)}function QI(n){var t=n[0]/255,e=n[1]/255,r=n[2]/255,a=Math.max(t,e,r),s=Math.min(t,e,r),l=a-s;if(l===0)return[0,0,t];var c=0,h=0,f=a+s;switch(h=l/(f>1?2-f:f),a){case t:c=((e-r)/l+6)%6;break;case e:c=(r-t)/l+2;break;case r:c=(t-e)/l+4;break}return[c/6,h,f/2]}function ZI(n){var t=n[0],e=n[1],r=n[2],a=e*2*(r<.5?r:1-r),s=r-a/2,l=[s,s,s],c=6*t,h;if(e!==0)switch(c|0){case 0:case 6:h=a*c,l[0]+=a,l[1]+=h;break;case 1:h=a*(2-c),l[0]+=h,l[1]+=a;break;case 2:h=a*(c-2),l[1]+=a,l[2]+=h;break;case 3:h=a*(4-c),l[1]+=h,l[2]+=a;break;case 4:h=a*(c-4),l[2]+=a,l[0]+=h;break;case 5:h=a*(6-c),l[2]+=h,l[0]+=a;break}for(var f=0;f!=3;++f)l[f]=Math.round(l[f]*255);return l}function yx(n,t){if(t===0)return n;var e=QI(KI(n));return t<0?e[2]=e[2]*(1+t):e[2]=1-(1-e[2])*(1-t),lp(ZI(e))}var XR=6,JI=15,e5=1,zn=XR;function wx(n){return Math.floor((n+Math.round(128/zn)/256)*zn)}function Ax(n){return Math.floor((n-5)/zn*100+.5)/100}function sw(n){return Math.round((n*zn+5)/zn*256)/256}function Ly(n){return sw(Ax(wx(n)))}function nE(n){var t=Math.abs(n-Ly(n)),e=zn;if(t>.005)for(zn=e5;zn<JI;++zn)Math.abs(n-Ly(n))<=t&&(t=Math.abs(n-Ly(n)),e=zn);zn=e}function od(n){n.width?(n.wpx=wx(n.width),n.wch=Ax(n.wpx),n.MDW=zn):n.wpx?(n.wch=Ax(n.wpx),n.width=sw(n.wch),n.MDW=zn):typeof n.wch=="number"&&(n.width=sw(n.wch),n.wpx=wx(n.width),n.MDW=zn),n.customWidth&&delete n.customWidth}var t5=96,qR=t5;function YR(n){return n*96/qR}function cp(n){return n*qR/96}var r5={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function n5(n,t,e,r){t.Borders=[];var a={},s=!1;(n[0].match(Rn)||[]).forEach(function(l){var c=qe(l);switch(ws(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=Zt(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=Zt(c.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+c[0]+" in borders")}})}function a5(n,t,e,r){t.Fills=[];var a={},s=!1;(n[0].match(Rn)||[]).forEach(function(l){var c=qe(l);switch(ws(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fills")}})}function i5(n,t,e,r){t.Fonts=[];var a={},s=!1;(n[0].match(Rn)||[]).forEach(function(l){var c=qe(l);switch(ws(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=Vt(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?Zt(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?Zt(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?Zt(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?Zt(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?Zt(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?Zt(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?Zt(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=UA[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=Zt(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var h=Fu[a.color.index];a.color.index==81&&(h=Fu[1]),h||(h=Fu[1]),a.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&e.themeElements&&e.themeElements.clrScheme&&(a.color.rgb=yx(e.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fonts")}})}function s5(n,t,e){t.NumberFmt=[];for(var r=vs(et),a=0;a<r.length;++a)t.NumberFmt[r[a]]=et[r[a]];var s=n[0].match(Rn);if(s)for(a=0;a<s.length;++a){var l=qe(s[a]);switch(ws(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=wt(Vt(l.formatCode)),h=parseInt(l.numFmtId,10);if(t.NumberFmt[h]=c,h>0){if(h>392){for(h=392;h>60&&t.NumberFmt[h]!=null;--h);t.NumberFmt[h]=c}Du(c,h)}}break;case"</numFmt>":break;default:if(e.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}var T1=["numFmtId","fillId","fontId","borderId","xfId"],k1=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function o5(n,t,e){t.CellXf=[];var r,a=!1;(n[0].match(Rn)||[]).forEach(function(s){var l=qe(s),c=0;switch(ws(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=l,delete r[0],c=0;c<T1.length;++c)r[T1[c]]&&(r[T1[c]]=parseInt(r[T1[c]],10));for(c=0;c<k1.length;++c)r[k1[c]]&&(r[k1[c]]=Zt(r[k1[c]]));if(t.NumberFmt&&r.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[c]){r.numFmtId=c;break}}t.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};l.vertical&&(h.vertical=l.vertical),l.horizontal&&(h.horizontal=l.horizontal),l.textRotation!=null&&(h.textRotation=l.textRotation),l.indent&&(h.indent=l.indent),l.wrapText&&(h.wrapText=Zt(l.wrapText)),r.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(e&&e.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}var l5=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,e=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,h,f){var d={};if(!c)return d;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var m;return(m=c.match(t))&&s5(m,d,f),(m=c.match(a))&&i5(m,d,h,f),(m=c.match(r))&&a5(m,d,h,f),(m=c.match(s))&&n5(m,d,h,f),(m=c.match(e))&&o5(m,d,f),d}}();function c5(n,t){var e=n.read_shift(2),r=kn(n);return[e,r]}function u5(n,t,e){var r={};r.sz=n.read_shift(2)/20;var a=y6(n);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var s=n.read_shift(2);switch(s===700&&(r.bold=1),n.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var l=n.read_shift(1);l!=0&&(r.underline=l);var c=n.read_shift(1);c>0&&(r.family=c);var h=n.read_shift(1);switch(h>0&&(r.charset=h),n.l++,r.color=_6(n),n.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=kn(n),r}var h5=Cn;function f5(n,t){var e=n.l+t,r=n.read_shift(2),a=n.read_shift(2);return n.l=e,{ixfe:r,numFmtId:a}}var d5=Cn;function p5(n,t,e){var r={};r.NumberFmt=[];for(var a in et)r.NumberFmt[a]=et[a];r.CellXf=[],r.Fonts=[];var s=[],l=!1;return Co(n,function(h,f,d){switch(d){case 44:r.NumberFmt[h[0]]=h[1],Du(h[1],h[0]);break;case 43:r.Fonts.push(h),h.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(h.color.rgb=yx(t.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&r.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(d),l=!0;break;case 38:s.pop(),l=!1;break;default:if(f.T>0)s.push(d);else if(f.T<0)s.pop();else if(!l||e.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),r}var g5=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function m5(n,t,e){t.themeElements.clrScheme=[];var r={};(n[0].match(Rn)||[]).forEach(function(a){var s=qe(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=s.val;break;case"<a:sysClr":r.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[g5.indexOf(s[0])]=r,r={}):r.name=s[0].slice(3,s[0].length-1);break;default:if(e&&e.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function x5(){}function v5(){}var _5=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,y5=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,w5=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function A5(n,t,e){t.themeElements={};var r;[["clrScheme",_5,m5],["fontScheme",y5,x5],["fmtScheme",w5,v5]].forEach(function(a){if(!(r=n.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](r,t,e)})}var E5=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function WR(n,t){(!n||n.length===0)&&(n=b5());var e,r={};if(!(e=n.match(E5)))throw new Error("themeElements not found in theme");return A5(e[0],r,t),r.raw=n,r}function b5(n,t){var e=[sR];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function S5(n,t,e){var r=n.l+t,a=n.read_shift(4);if(a!==124226){if(!e.cellStyles){n.l=r;return}var s=n.slice(n.l);n.l=r;var l;try{l=iR(s,{type:"array"})}catch{return}var c=Oa(l,"theme/theme/theme1.xml",!0);if(c)return WR(c,e)}}function T5(n){return n.read_shift(4)}function k5(n){var t={};switch(t.xclrType=n.read_shift(2),t.nTintShade=n.read_shift(2),t.xclrType){case 0:n.l+=4;break;case 1:t.xclrValue=C5(n,4);break;case 2:t.xclrValue=NR(n);break;case 3:t.xclrValue=T5(n);break;case 4:n.l+=4;break}return n.l+=8,t}function C5(n,t){return Cn(n,t)}function R5(n,t){return Cn(n,t)}function O5(n){var t=n.read_shift(2),e=n.read_shift(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=k5(n);break;case 6:r[1]=R5(n,e);break;case 14:case 15:r[1]=n.read_shift(e===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+e)}return r}function D5(n,t){var e=n.l+t;n.l+=2;var r=n.read_shift(2);n.l+=2;for(var a=n.read_shift(2),s=[];a-- >0;)s.push(O5(n,e-n.l));return{ixfe:r,ext:s}}function F5(n,t){t.forEach(function(e){switch(e[0]){}})}function M5(n,t){return{flags:n.read_shift(4),version:n.read_shift(4),name:kn(n)}}function L5(n){for(var t=[],e=n.read_shift(4);e-- >0;)t.push([n.read_shift(4),n.read_shift(4)]);return t}function N5(n){return n.l+=4,n.read_shift(4)!=0}function P5(n,t,e){var r={Types:[],Cell:[],Value:[]},a=e||{},s=[],l=!1,c=2;return Co(n,function(h,f,d){switch(d){case 335:r.Types.push({name:h.name});break;case 51:h.forEach(function(m){c==1?r.Cell.push({type:r.Types[m[0]-1].name,index:m[1]}):c==0&&r.Value.push({type:r.Types[m[0]-1].name,index:m[1]})});break;case 337:c=h?1:0;break;case 338:c=2;break;case 35:s.push(d),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!f.T){if(!l||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function I5(n,t,e){var r={Types:[],Cell:[],Value:[]};if(!n)return r;var a=!1,s=2,l;return n.replace(Rn,function(c){var h=qe(c);switch(ws(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<r.Types.length;++f)r.Types[f].name==h.name&&(l=r.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?r.Cell.push({type:r.Types[h.t-1].name,index:+h.v}):s==0&&r.Value.push({type:r.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+h.i);break;default:if(!a&&e.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return c}),r}function B5(n){var t=[];if(!n)return t;var e=1;return(n.match(Rn)||[]).forEach(function(r){var a=qe(r);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?e=a.i:a.i=e,t.push(a);break}}),t}function U5(n){var t={};t.i=n.read_shift(4);var e={};e.r=n.read_shift(4),e.c=n.read_shift(4),t.r=Je(e);var r=n.read_shift(1);return r&2&&(t.l="1"),r&8&&(t.a="1"),t}function H5(n,t,e){var r=[];return Co(n,function(s,l,c){switch(c){case 63:r.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function z5(n,t,e,r){if(!n)return n;var a=r||{},s=!1;Co(n,function(c,h,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!h.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},a)}function j5(n,t){if(!n)return"??";var e=(n.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][e].Target}function Ek(n,t,e,r){var a=Array.isArray(n),s;t.forEach(function(l){var c=jn(l.ref);if(a?(n[c.r]||(n[c.r]=[]),s=n[c.r][c.c]):s=n[l.ref],!s){s={t:"z"},a?n[c.r][c.c]=s:n[l.ref]=s;var h=hr(n["!ref"]||"BDWGO1000001:A1");h.s.r>c.r&&(h.s.r=c.r),h.e.r<c.r&&(h.e.r=c.r),h.s.c>c.c&&(h.s.c=c.c),h.e.c<c.c&&(h.e.c=c.c);var f=yt(h);f!==n["!ref"]&&(n["!ref"]=f)}s.c||(s.c=[]);var d={a:l.author,t:l.t,r:l.r,T:e};l.h&&(d.h=l.h);for(var m=s.c.length-1;m>=0;--m){if(!e&&s.c[m].T)return;e&&!s.c[m].T&&s.c.splice(m,1)}if(e&&r){for(m=0;m<r.length;++m)if(d.a==r[m].id){d.a=r[m].name||d.a;break}}s.c.push(d)})}function G5(n,t){if(n.match(/<(?:\w+:)?comments *\/>/))return[];var e=[],r=[],a=n.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&e.push(c[1])}});var s=n.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var h=qe(c[0]),f={author:h.authorId&&e[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},d=jn(h.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var m=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!m&&!!m[1]&&rE(m[1])||{r:"",t:"",h:""};f.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),f.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=x.h),r.push(f)}}}}),r}function V5(n,t){var e=[],r=!1,a={},s=0;return n.replace(Rn,function(c,h){var f=qe(c);switch(ws(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":a.t!=null&&e.push(a);break;case"<text>":case"<text":s=h+c.length;break;case"</text>":a.t=n.slice(s,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return c}),e}function $5(n,t){var e=[],r=!1;return n.replace(Rn,function(s){var l=qe(s);switch(ws(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":e.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),e}function X5(n){var t={};t.iauthor=n.read_shift(4);var e=Xu(n);return t.rfx=e.s,t.ref=Je(e.s),n.l+=16,t}var q5=kn;function Y5(n,t){var e=[],r=[],a={},s=!1;return Co(n,function(c,h,f){switch(f){case 632:r.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=r[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,e.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),e}var W5="application/vnd.ms-office.vbaProject";function K5(n){var t=_t.utils.cfb_new({root:"R"});return n.FullPaths.forEach(function(e,r){if(!(e.slice(-1)==="/"||!e.match(/_VBA_PROJECT_CUR/))){var a=e.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");_t.utils.cfb_add(t,a,n.FileIndex[r].content)}}),_t.write(t)}function Q5(){return{"!type":"dialog"}}function Z5(){return{"!type":"dialog"}}function J5(){return{"!type":"macro"}}function eB(){return{"!type":"macro"}}var Yh=function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function e(r,a,s,l){var c=!1,h=!1;s.length==0?h=!0:s.charAt(0)=="["&&(h=!0,s=s.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var f=s.length>0?parseInt(s,10)|0:0,d=l.length>0?parseInt(l,10)|0:0;return c?d+=t.c:--d,h?f+=t.r:--f,a+(c?"":"$")+Nr(d)+(h?"":"$")+un(f)}return function(a,s){return t=s,a.replace(n,e)}}(),KR=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,tB=function(){return function(t,e){return t.replace(KR,function(r,a,s,l,c,h){var f=KA(l)-(s?0:e.c),d=WA(h)-(c?0:e.r),m=d==0?"":c?d+1:"["+d+"]",x=f==0?"":s?f+1:"["+f+"]";return a+"R"+m+"C"+x})}}();function QR(n,t){return n.replace(KR,function(e,r,a,s,l,c){return r+(a=="$"?a+s:Nr(KA(s)+t.c))+(l=="$"?l+c:un(WA(c)+t.r))})}function rB(n,t,e){var r=hd(t),a=r.s,s=jn(e),l={r:s.r-a.r,c:s.c-a.c};return QR(n,l)}function nB(n){return n.length!=1}function bk(n){return n.replace(/_xlfn\./g,"")}function Ar(n){n.l+=1}function jl(n,t){var e=n.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function ZR(n,t,e){var r=2;if(e){if(e.biff>=2&&e.biff<=5)return JR(n);e.biff==12&&(r=4)}var a=n.read_shift(r),s=n.read_shift(r),l=jl(n),c=jl(n);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function JR(n){var t=jl(n),e=jl(n),r=n.read_shift(1),a=n.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:e[0],c:a,cRel:e[1],rRel:e[2]}}}function aB(n,t,e){if(e.biff<8)return JR(n);var r=n.read_shift(e.biff==12?4:2),a=n.read_shift(e.biff==12?4:2),s=jl(n),l=jl(n);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function e4(n,t,e){if(e&&e.biff>=2&&e.biff<=5)return iB(n);var r=n.read_shift(e&&e.biff==12?4:2),a=jl(n);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function iB(n){var t=jl(n),e=n.read_shift(1);return{r:t[0],c:e,cRel:t[1],rRel:t[2]}}function sB(n){var t=n.read_shift(2),e=n.read_shift(2);return{r:t,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function oB(n,t,e){var r=e&&e.biff?e.biff:8;if(r>=2&&r<=5)return lB(n);var a=n.read_shift(r>=12?4:2),s=n.read_shift(2),l=(s&16384)>>14,c=(s&32768)>>15;if(s&=16383,c==1)for(;a>524287;)a-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:l,rRel:c}}function lB(n){var t=n.read_shift(2),e=n.read_shift(1),r=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,r==1&&t>=8192&&(t=t-16384),a==1&&e>=128&&(e=e-256),{r:t,c:e,cRel:a,rRel:r}}function cB(n,t,e){var r=(n[n.l++]&96)>>5,a=ZR(n,e.biff>=2&&e.biff<=5?6:8,e);return[r,a]}function uB(n,t,e){var r=(n[n.l++]&96)>>5,a=n.read_shift(2,"i"),s=8;if(e)switch(e.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}var l=ZR(n,s,e);return[r,a,l]}function hB(n,t,e){var r=(n[n.l++]&96)>>5;return n.l+=e&&e.biff>8?12:e.biff<8?6:8,[r]}function fB(n,t,e){var r=(n[n.l++]&96)>>5,a=n.read_shift(2),s=8;if(e)switch(e.biff){case 5:n.l+=12,s=6;break;case 12:s=12;break}return n.l+=s,[r,a]}function dB(n,t,e){var r=(n[n.l++]&96)>>5,a=aB(n,t-1,e);return[r,a]}function pB(n,t,e){var r=(n[n.l++]&96)>>5;return n.l+=e.biff==2?6:e.biff==12?14:7,[r]}function Sk(n){var t=n[n.l+1]&1,e=1;return n.l+=4,[t,e]}function gB(n,t,e){n.l+=2;for(var r=n.read_shift(e&&e.biff==2?1:2),a=[],s=0;s<=r;++s)a.push(n.read_shift(e&&e.biff==2?1:2));return a}function mB(n,t,e){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(e&&e.biff==2?1:2)]}function xB(n,t,e){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(e&&e.biff==2?1:2)]}function vB(n){var t=n[n.l+1]&255?1:0;return n.l+=2,[t,n.read_shift(2)]}function _B(n,t,e){var r=n[n.l+1]&255?1:0;return n.l+=e&&e.biff==2?3:4,[r]}function t4(n){var t=n.read_shift(1),e=n.read_shift(1);return[t,e]}function yB(n){return n.read_shift(2),t4(n)}function wB(n){return n.read_shift(2),t4(n)}function AB(n,t,e){var r=(n[n.l]&96)>>5;n.l+=1;var a=e4(n,0,e);return[r,a]}function EB(n,t,e){var r=(n[n.l]&96)>>5;n.l+=1;var a=oB(n,0,e);return[r,a]}function bB(n,t,e){var r=(n[n.l]&96)>>5;n.l+=1;var a=n.read_shift(2);e&&e.biff==5&&(n.l+=12);var s=e4(n,0,e);return[r,a,s]}function SB(n,t,e){var r=(n[n.l]&96)>>5;n.l+=1;var a=n.read_shift(e&&e.biff<=3?1:2);return[TU[a],a4[a],r]}function TB(n,t,e){var r=n[n.l++],a=n.read_shift(1),s=e&&e.biff<=3?[r==88?-1:0,n.read_shift(1)]:kB(n);return[a,(s[0]===0?a4:SU)[s[1]]]}function kB(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function CB(n,t,e){n.l+=e&&e.biff==2?3:4}function RB(n,t,e){if(n.l++,e&&e.biff==12)return[n.read_shift(4,"i"),0];var r=n.read_shift(2),a=n.read_shift(e&&e.biff==2?1:2);return[r,a]}function OB(n){return n.l++,qu[n.read_shift(1)]}function DB(n){return n.l++,n.read_shift(2)}function FB(n){return n.l++,n.read_shift(1)!==0}function MB(n){return n.l++,bn(n)}function LB(n,t,e){return n.l++,$g(n,t-1,e)}function NB(n,t){var e=[n.read_shift(1)];if(t==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=pr(n,1)?"TRUE":"FALSE",t!=12&&(n.l+=7);break;case 37:case 16:e[1]=qu[n[n.l]],n.l+=t==12?4:8;break;case 0:n.l+=8;break;case 1:e[1]=bn(n);break;case 2:e[1]=Yu(n,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function PB(n,t,e){for(var r=n.read_shift(e.biff==12?4:2),a=[],s=0;s!=r;++s)a.push((e.biff==12?Xu:rv)(n));return a}function IB(n,t,e){var r=0,a=0;e.biff==12?(r=n.read_shift(4),a=n.read_shift(4)):(a=1+n.read_shift(1),r=1+n.read_shift(2)),e.biff>=2&&e.biff<8&&(--r,--a==0&&(a=256));for(var s=0,l=[];s!=r&&(l[s]=[]);++s)for(var c=0;c!=a;++c)l[s][c]=NB(n,e.biff);return l}function BB(n,t,e){var r=n.read_shift(1)>>>5&3,a=!e||e.biff>=8?4:2,s=n.read_shift(a);switch(e.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[r,0,s]}function UB(n,t,e){if(e.biff==5)return HB(n);var r=n.read_shift(1)>>>5&3,a=n.read_shift(2),s=n.read_shift(4);return[r,a,s]}function HB(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2,"i");n.l+=8;var r=n.read_shift(2);return n.l+=12,[t,e,r]}function zB(n,t,e){var r=n.read_shift(1)>>>5&3;n.l+=e&&e.biff==2?3:4;var a=n.read_shift(e&&e.biff==2?1:2);return[r,a]}function jB(n,t,e){var r=n.read_shift(1)>>>5&3,a=n.read_shift(e&&e.biff==2?1:2);return[r,a]}function GB(n,t,e){var r=n.read_shift(1)>>>5&3;return n.l+=4,e.biff<8&&n.l--,e.biff==12&&(n.l+=2),[r]}function VB(n,t,e){var r=(n[n.l++]&96)>>5,a=n.read_shift(2),s=4;if(e)switch(e.biff){case 5:s=15;break;case 12:s=6;break}return n.l+=s,[r,a]}var $B=Cn,XB=Cn,qB=Cn;function qg(n,t,e){return n.l+=2,[sB(n)]}function aE(n){return n.l+=6,[]}var YB=qg,WB=aE,KB=aE,QB=qg;function r4(n){return n.l+=2,[Sr(n),n.read_shift(2)&1]}var ZB=qg,JB=r4,eU=aE,tU=qg,rU=qg,nU=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function aU(n){n.l+=2;var t=n.read_shift(2),e=n.read_shift(2),r=n.read_shift(4),a=n.read_shift(2),s=n.read_shift(2),l=nU[e>>2&31];return{ixti:t,coltype:e&3,rt:l,idx:r,c:a,C:s}}function iU(n){return n.l+=2,[n.read_shift(4)]}function sU(n,t,e){return n.l+=5,n.l+=2,n.l+=e.biff==2?1:4,["PTGSHEET"]}function oU(n,t,e){return n.l+=e.biff==2?4:5,["PTGENDSHEET"]}function lU(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2);return[t,e]}function cU(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2);return[t,e]}function uU(n){return n.l+=4,[0,0]}var Tk={1:{n:"PtgExp",f:RB},2:{n:"PtgTbl",f:qB},3:{n:"PtgAdd",f:Ar},4:{n:"PtgSub",f:Ar},5:{n:"PtgMul",f:Ar},6:{n:"PtgDiv",f:Ar},7:{n:"PtgPower",f:Ar},8:{n:"PtgConcat",f:Ar},9:{n:"PtgLt",f:Ar},10:{n:"PtgLe",f:Ar},11:{n:"PtgEq",f:Ar},12:{n:"PtgGe",f:Ar},13:{n:"PtgGt",f:Ar},14:{n:"PtgNe",f:Ar},15:{n:"PtgIsect",f:Ar},16:{n:"PtgUnion",f:Ar},17:{n:"PtgRange",f:Ar},18:{n:"PtgUplus",f:Ar},19:{n:"PtgUminus",f:Ar},20:{n:"PtgPercent",f:Ar},21:{n:"PtgParen",f:Ar},22:{n:"PtgMissArg",f:Ar},23:{n:"PtgStr",f:LB},26:{n:"PtgSheet",f:sU},27:{n:"PtgEndSheet",f:oU},28:{n:"PtgErr",f:OB},29:{n:"PtgBool",f:FB},30:{n:"PtgInt",f:DB},31:{n:"PtgNum",f:MB},32:{n:"PtgArray",f:pB},33:{n:"PtgFunc",f:SB},34:{n:"PtgFuncVar",f:TB},35:{n:"PtgName",f:BB},36:{n:"PtgRef",f:AB},37:{n:"PtgArea",f:cB},38:{n:"PtgMemArea",f:zB},39:{n:"PtgMemErr",f:$B},40:{n:"PtgMemNoMem",f:XB},41:{n:"PtgMemFunc",f:jB},42:{n:"PtgRefErr",f:GB},43:{n:"PtgAreaErr",f:hB},44:{n:"PtgRefN",f:EB},45:{n:"PtgAreaN",f:dB},46:{n:"PtgMemAreaN",f:lU},47:{n:"PtgMemNoMemN",f:cU},57:{n:"PtgNameX",f:UB},58:{n:"PtgRef3d",f:bB},59:{n:"PtgArea3d",f:uB},60:{n:"PtgRefErr3d",f:VB},61:{n:"PtgAreaErr3d",f:fB},255:{}},hU={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},fU={1:{n:"PtgElfLel",f:r4},2:{n:"PtgElfRw",f:tU},3:{n:"PtgElfCol",f:YB},6:{n:"PtgElfRwV",f:rU},7:{n:"PtgElfColV",f:QB},10:{n:"PtgElfRadical",f:ZB},11:{n:"PtgElfRadicalS",f:eU},13:{n:"PtgElfColS",f:WB},15:{n:"PtgElfColSV",f:KB},16:{n:"PtgElfRadicalLel",f:JB},25:{n:"PtgList",f:aU},29:{n:"PtgSxName",f:iU},255:{}},dU={0:{n:"PtgAttrNoop",f:uU},1:{n:"PtgAttrSemi",f:_B},2:{n:"PtgAttrIf",f:xB},4:{n:"PtgAttrChoose",f:gB},8:{n:"PtgAttrGoto",f:mB},16:{n:"PtgAttrSum",f:CB},32:{n:"PtgAttrBaxcel",f:Sk},33:{n:"PtgAttrBaxcel",f:Sk},64:{n:"PtgAttrSpace",f:yB},65:{n:"PtgAttrSpaceSemi",f:wB},128:{n:"PtgAttrIfError",f:vB},255:{}};function Yg(n,t,e,r){if(r.biff<8)return Cn(n,t);for(var a=n.l+t,s=[],l=0;l!==e.length;++l)switch(e[l][0]){case"PtgArray":e[l][1]=IB(n,0,r),s.push(e[l][1]);break;case"PtgMemArea":e[l][2]=PB(n,e[l][1],r),s.push(e[l][2]);break;case"PtgExp":r&&r.biff==12&&(e[l][1][1]=n.read_shift(4),s.push(e[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[l][0]}return t=a-n.l,t!==0&&s.push(Cn(n,t)),s}function Wg(n,t,e){for(var r=n.l+t,a,s,l=[];r!=n.l;)t=r-n.l,s=n[n.l],a=Tk[s]||Tk[hU[s]],(s===24||s===25)&&(a=(s===24?fU:dU)[n[n.l+1]]),!a||!a.f?Cn(n,t):l.push([a.n,a.f(n,t,e)]);return l}function pU(n){for(var t=[],e=0;e<n.length;++e){for(var r=n[e],a=[],s=0;s<r.length;++s){var l=r[s];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var gU={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function mU(n,t){if(!n&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function n4(n,t,e){if(!n)return"SH33TJSERR0";if(e.biff>8&&(!n.XTI||!n.XTI[t]))return n.SheetNames[t];if(!n.XTI)return"SH33TJSERR6";var r=n.XTI[t];if(e.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":n.XTI[t-1];if(!r)return"SH33TJSERR1";var a="";if(e.biff>8)switch(n[r[0]][0]){case 357:return a=r[1]==-1?"#REF":n.SheetNames[r[1]],r[1]==r[2]?a:a+":"+n.SheetNames[r[2]];case 358:return e.SID!=null?n.SheetNames[e.SID]:"SH33TJSSAME"+n[r[0]][0];case 355:default:return"SH33TJSSRC"+n[r[0]][0]}switch(n[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":n.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+n.SheetNames[r[2]];case 14849:return n[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return n[r[0]][0][3]?(a=r[1]==-1?"#REF":n[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+n[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function kk(n,t,e){var r=n4(n,t,e);return r=="#REF"?r:mU(r,e)}function An(n,t,e,r,a){var s=a&&a.biff||8,l={s:{c:0,r:0},e:{c:0,r:0}},c=[],h,f,d,m=0,x=0,_,y="";if(!n[0]||!n[0][0])return"";for(var A=-1,E="",b=0,C=n[0].length;b<C;++b){var S=n[0][b];switch(S[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=c.pop(),f=c.pop(),A>=0){switch(n[0][A][1][0]){case 0:E=ur(" ",n[0][A][1][1]);break;case 1:E=ur("\r",n[0][A][1][1]);break;default:if(E="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][A][1][0])}f=f+E,A=-1}c.push(f+gU[S[0]]+h);break;case"PtgIsect":h=c.pop(),f=c.pop(),c.push(f+" "+h);break;case"PtgUnion":h=c.pop(),f=c.pop(),c.push(f+","+h);break;case"PtgRange":h=c.pop(),f=c.pop(),c.push(f+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=X0(S[1][1],l,a),c.push(q0(d,s));break;case"PtgRefN":d=e?X0(S[1][1],e,a):S[1][1],c.push(q0(d,s));break;case"PtgRef3d":m=S[1][1],d=X0(S[1][2],l,a),y=kk(r,m,a),c.push(y+"!"+q0(d,s));break;case"PtgFunc":case"PtgFuncVar":var O=S[1][0],L=S[1][1];O||(O=0),O&=127;var I=O==0?[]:c.slice(-O);c.length-=O,L==="User"&&(L=I.shift()),c.push(L+"("+I.join(",")+")");break;case"PtgBool":c.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(S[1]);break;case"PtgNum":c.push(String(S[1]));break;case"PtgStr":c.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(S[1]);break;case"PtgAreaN":_=ok(S[1][1],e?{s:e}:l,a),c.push(Fy(_,a));break;case"PtgArea":_=ok(S[1][1],l,a),c.push(Fy(_,a));break;case"PtgArea3d":m=S[1][1],_=S[1][2],y=kk(r,m,a),c.push(y+"!"+Fy(_,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=S[1][2];var F=(r.names||[])[x-1]||(r[0]||[])[x],W=F?F.Name:"SH33TJSNAME"+String(x);W&&W.slice(0,6)=="_xlfn."&&!a.xlfn&&(W=W.slice(6)),c.push(W);break;case"PtgNameX":var B=S[1][1];x=S[1][2];var ee;if(a.biff<=5)B<0&&(B=-B),r[B]&&(ee=r[B][x]);else{var Z="";if(((r[B]||[])[0]||[])[0]==14849||(((r[B]||[])[0]||[])[0]==1025?r[B][x]&&r[B][x].itab>0&&(Z=r.SheetNames[r[B][x].itab-1]+"!"):Z=r.SheetNames[x-1]+"!"),r[B]&&r[B][x])Z+=r[B][x].Name;else if(r[0]&&r[0][x])Z+=r[0][x].Name;else{var te=(n4(r,B,a)||"").split(";;");te[x-1]?Z=te[x-1]:Z+="SH33TJSERRX"}c.push(Z);break}ee||(ee={Name:"SH33TJSERRY"}),c.push(ee.Name);break;case"PtgParen":var ve="(",Ce=")";if(A>=0){switch(E="",n[0][A][1][0]){case 2:ve=ur(" ",n[0][A][1][1])+ve;break;case 3:ve=ur("\r",n[0][A][1][1])+ve;break;case 4:Ce=ur(" ",n[0][A][1][1])+Ce;break;case 5:Ce=ur("\r",n[0][A][1][1])+Ce;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][A][1][0])}A=-1}c.push(ve+c.pop()+Ce);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:S[1][1],r:S[1][0]};var Ee={c:e.c,r:e.r};if(r.sharedf[Je(d)]){var J=r.sharedf[Je(d)];c.push(An(J,l,Ee,r,a))}else{var oe=!1;for(h=0;h!=r.arrayf.length;++h)if(f=r.arrayf[h],!(d.c<f[0].s.c||d.c>f[0].e.c)&&!(d.r<f[0].s.r||d.r>f[0].e.r)){c.push(An(f[1],l,Ee,r,a)),oe=!0;break}oe||c.push(S[1])}break;case"PtgArray":c.push("{"+pU(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":A=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var De=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&A>=0&&De.indexOf(n[0][b][0])==-1){S=n[0][A];var ae=!0;switch(S[1][0]){case 4:ae=!1;case 0:E=ur(" ",S[1][1]);break;case 5:ae=!1;case 1:E=ur("\r",S[1][1]);break;default:if(E="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}c.push((ae?E:"")+c.pop()+(ae?"":E)),A=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function xU(n,t,e){var r=n.l+t,a=e.biff==2?1:2,s,l=n.read_shift(a);if(l==65535)return[[],Cn(n,t-2)];var c=Wg(n,l,e);return t!==l+a&&(s=Yg(n,t-l-a,c,e)),n.l=r,[c,s]}function vU(n,t,e){var r=n.l+t,a=e.biff==2?1:2,s,l=n.read_shift(a);if(l==65535)return[[],Cn(n,t-2)];var c=Wg(n,l,e);return t!==l+a&&(s=Yg(n,t-l-a,c,e)),n.l=r,[c,s]}function _U(n,t,e,r){var a=n.l+t,s=Wg(n,r,e),l;return a!==n.l&&(l=Yg(n,a-n.l,s,e)),[s,l]}function yU(n,t,e){var r=n.l+t,a,s=n.read_shift(2),l=Wg(n,s,e);return s==65535?[[],Cn(n,t-2)]:(t!==s+2&&(a=Yg(n,r-s-2,l,e)),[l,a])}function wU(n){var t;if(vo(n,n.l+6)!==65535)return[bn(n),"n"];switch(n[n.l]){case 0:return n.l+=8,["String","s"];case 1:return t=n[n.l+2]===1,n.l+=8,[t,"b"];case 2:return t=n[n.l+2],n.l+=8,[t,"e"];case 3:return n.l+=8,["","s"]}return[]}function Ny(n,t,e){var r=n.l+t,a=As(n);e.biff==2&&++n.l;var s=wU(n),l=n.read_shift(1);e.biff!=2&&(n.read_shift(1),e.biff>=5&&n.read_shift(4));var c=vU(n,r-n.l,e);return{cell:a,val:s[0],formula:c,shared:l>>3&1,tt:s[1]}}function nv(n,t,e){var r=n.read_shift(4),a=Wg(n,r,e),s=n.read_shift(4),l=s>0?Yg(n,s,a,e):null;return[a,l]}var AU=nv,av=nv,EU=nv,bU=nv,SU={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},a4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},TU={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Ck(n){return n.slice(0,3)=="of:"&&(n=n.slice(3)),n.charCodeAt(0)==61&&(n=n.slice(1),n.charCodeAt(0)==61&&(n=n.slice(1))),n=n.replace(/COM\.MICROSOFT\./g,""),n=n.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,e){return e.replace(/\./g,"")}),n=n.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),n.replace(/[;~]/g,",").replace(/\|/g,";")}function Py(n){var t=n.split(":"),e=t[0].split(".")[0];return[e,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Q0={},Wh={};function Z0(n,t){if(n){var e=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(e=[1,1,1,1,.5,.5]),n.left==null&&(n.left=e[0]),n.right==null&&(n.right=e[1]),n.top==null&&(n.top=e[2]),n.bottom==null&&(n.bottom=e[3]),n.header==null&&(n.header=e[4]),n.footer==null&&(n.footer=e[5])}}function i4(n,t,e,r,a,s){try{r.cellNF&&(n.z=et[t])}catch(c){if(r.WTF)throw c}if(!(n.t==="z"&&!r.cellStyles)){if(n.t==="d"&&typeof n.v=="string"&&(n.v=Kr(n.v)),(!r||r.cellText!==!1)&&n.t!=="z")try{if(et[t]==null&&Du(kP[t]||"General",t),n.t==="e")n.w=n.w||qu[n.v];else if(t===0)if(n.t==="n")(n.v|0)===n.v?n.w=n.v.toString(10):n.w=ap(n.v);else if(n.t==="d"){var l=qn(n.v);(l|0)===l?n.w=l.toString(10):n.w=ap(l)}else{if(n.v===void 0)return"";n.w=Mu(n.v,Wh)}else n.t==="d"?n.w=li(t,qn(n.v),Wh):n.w=li(t,n.v,Wh)}catch(c){if(r.WTF)throw c}if(r.cellStyles&&e!=null)try{n.s=s.Fills[e],n.s.fgColor&&n.s.fgColor.theme&&!n.s.fgColor.rgb&&(n.s.fgColor.rgb=yx(a.themeElements.clrScheme[n.s.fgColor.theme].rgb,n.s.fgColor.tint||0),r.WTF&&(n.s.fgColor.raw_rgb=a.themeElements.clrScheme[n.s.fgColor.theme].rgb)),n.s.bgColor&&n.s.bgColor.theme&&(n.s.bgColor.rgb=yx(a.themeElements.clrScheme[n.s.bgColor.theme].rgb,n.s.bgColor.tint||0),r.WTF&&(n.s.bgColor.raw_rgb=a.themeElements.clrScheme[n.s.bgColor.theme].rgb))}catch(c){if(r.WTF&&s.Fills)throw c}}}function kU(n,t){var e=hr(t);e.s.r<=e.e.r&&e.s.c<=e.e.c&&e.s.r>=0&&e.s.c>=0&&(n["!ref"]=yt(e))}var CU=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,RU=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,OU=/<(?:\w:)?hyperlink [^>]*>/mg,DU=/"(\w*:\w*)"/,FU=/<(?:\w:)?col\b[^>]*[\/]?>/g,MU=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,LU=/<(?:\w:)?pageMargins[^>]*\/>/g,s4=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,NU=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,PU=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function IU(n,t,e,r,a,s,l){if(!n)return n;r||(r={"!id":{}});var c=t.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",d="",m=n.match(RU);m?(f=n.slice(0,m.index),d=n.slice(m.index+m[0].length)):f=d=n;var x=f.match(s4);x?iE(x[0],c,a,e):(x=f.match(NU))&&BU(x[0],x[1]||"",c,a,e);var _=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var y=f.slice(_,_+50).match(DU);y&&kU(c,y[1])}var A=f.match(PU);A&&A[1]&&VU(A[1],a);var E=[];if(t.cellStyles){var b=f.match(FU);b&&zU(E,b)}m&&$U(m[1],c,t,h,s,l);var C=d.match(MU);C&&(c["!autofilter"]=jU(C[0]));var S=[],O=d.match(CU);if(O)for(_=0;_!=O.length;++_)S[_]=hr(O[_].slice(O[_].indexOf('"')+1));var L=d.match(OU);L&&UU(c,L,r);var I=d.match(LU);if(I&&(c["!margins"]=HU(qe(I[0]))),!c["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(c["!ref"]=yt(h)),t.sheetRows>0&&c["!ref"]){var F=hr(c["!ref"]);t.sheetRows<=+F.e.r&&(F.e.r=t.sheetRows-1,F.e.r>h.e.r&&(F.e.r=h.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>h.e.c&&(F.e.c=h.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),c["!fullref"]=c["!ref"],c["!ref"]=yt(F))}return E.length>0&&(c["!cols"]=E),S.length>0&&(c["!merges"]=S),c}function iE(n,t,e,r){var a=qe(n);e.Sheets[r]||(e.Sheets[r]={}),a.codeName&&(e.Sheets[r].CodeName=wt(Vt(a.codeName)))}function BU(n,t,e,r,a){iE(n.slice(0,n.indexOf(">")),e,r,a)}function UU(n,t,e){for(var r=Array.isArray(n),a=0;a!=t.length;++a){var s=qe(Vt(t[a]),!0);if(!s.ref)return;var l=((e||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+wt(s.location))):(s.Target="#"+wt(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var c=hr(s.ref),h=c.s.r;h<=c.e.r;++h)for(var f=c.s.c;f<=c.e.c;++f){var d=Je({c:f,r:h});r?(n[h]||(n[h]=[]),n[h][f]||(n[h][f]={t:"z",v:void 0}),n[h][f].l=s):(n[d]||(n[d]={t:"z",v:void 0}),n[d].l=s)}}}function HU(n){var t={};return["left","right","top","bottom","header","footer"].forEach(function(e){n[e]&&(t[e]=parseFloat(n[e]))}),t}function zU(n,t){for(var e=!1,r=0;r!=t.length;++r){var a=qe(t[r],!0);a.hidden&&(a.hidden=Zt(a.hidden));var s=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!e&&a.width&&(e=!0,nE(a.width)),od(a);s<=l;)n[s++]=cn(a)}}function jU(n){var t={ref:(n.match(/ref="([^"]*)"/)||[])[1]};return t}var GU=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function VU(n,t){t.Views||(t.Views=[{}]),(n.match(GU)||[]).forEach(function(e,r){var a=qe(e);t.Views[r]||(t.Views[r]={}),+a.zoomScale&&(t.Views[r].zoom=+a.zoomScale),Zt(a.rightToLeft)&&(t.Views[r].RTL=!0)})}var $U=function(){var n=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,e=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=ip("v"),l=ip("f");return function(h,f,d,m,x,_){for(var y=0,A="",E=[],b=[],C=0,S=0,O=0,L="",I,F,W=0,B=0,ee,Z,te=0,ve=0,Ce=Array.isArray(_.CellXf),Ee,J=[],oe=[],De=Array.isArray(f),ae=[],V={},fe=!1,U=!!d.sheetStubs,Q=h.split(t),X=0,K=Q.length;X!=K;++X){A=Q[X].trim();var se=A.length;if(se!==0){var _e=0;e:for(y=0;y<se;++y)switch(A[y]){case">":if(A[y-1]!="/"){++y;break e}if(d&&d.cellStyles){if(F=qe(A.slice(_e,y),!0),W=F.r!=null?parseInt(F.r,10):W+1,B=-1,d.sheetRows&&d.sheetRows<W)continue;V={},fe=!1,F.ht&&(fe=!0,V.hpt=parseFloat(F.ht),V.hpx=cp(V.hpt)),F.hidden=="1"&&(fe=!0,V.hidden=!0),F.outlineLevel!=null&&(fe=!0,V.level=+F.outlineLevel),fe&&(ae[W-1]=V)}break;case"<":_e=y;break}if(_e>=y)break;if(F=qe(A.slice(_e,y),!0),W=F.r!=null?parseInt(F.r,10):W+1,B=-1,!(d.sheetRows&&d.sheetRows<W)){m.s.r>W-1&&(m.s.r=W-1),m.e.r<W-1&&(m.e.r=W-1),d&&d.cellStyles&&(V={},fe=!1,F.ht&&(fe=!0,V.hpt=parseFloat(F.ht),V.hpx=cp(V.hpt)),F.hidden=="1"&&(fe=!0,V.hidden=!0),F.outlineLevel!=null&&(fe=!0,V.level=+F.outlineLevel),fe&&(ae[W-1]=V)),E=A.slice(y).split(n);for(var be=0;be!=E.length&&E[be].trim().charAt(0)=="<";++be);for(E=E.slice(be),y=0;y!=E.length;++y)if(A=E[y].trim(),A.length!==0){if(b=A.match(e),C=y,S=0,O=0,A="<c "+(A.slice(0,1)=="<"?">":"")+A,b!=null&&b.length===2){for(C=0,L=b[1],S=0;S!=L.length&&!((O=L.charCodeAt(S)-64)<1||O>26);++S)C=26*C+O;--C,B=C}else++B;for(S=0;S!=A.length&&A.charCodeAt(S)!==62;++S);if(++S,F=qe(A.slice(0,S),!0),F.r||(F.r=Je({r:W-1,c:B})),L=A.slice(S),I={t:""},(b=L.match(s))!=null&&b[1]!==""&&(I.v=wt(b[1])),d.cellFormula){if((b=L.match(l))!=null&&b[1]!==""){if(I.f=wt(Vt(b[1])).replace(/\r\n/g,`
`),d.xlfn||(I.f=bk(I.f)),b[0].indexOf('t="array"')>-1)I.F=(L.match(a)||[])[1],I.F.indexOf(":")>-1&&J.push([hr(I.F),I.F]);else if(b[0].indexOf('t="shared"')>-1){Z=qe(b[0]);var Te=wt(Vt(b[1]));d.xlfn||(Te=bk(Te)),oe[parseInt(Z.si,10)]=[Z,Te,F.r]}}else(b=L.match(/<f[^>]*\/>/))&&(Z=qe(b[0]),oe[Z.si]&&(I.f=rB(oe[Z.si][1],oe[Z.si][2],F.r)));var ye=jn(F.r);for(S=0;S<J.length;++S)ye.r>=J[S][0].s.r&&ye.r<=J[S][0].e.r&&ye.c>=J[S][0].s.c&&ye.c<=J[S][0].e.c&&(I.F=J[S][1])}if(F.t==null&&I.v===void 0)if(I.f||I.F)I.v=0,I.t="n";else if(U)I.t="z";else continue;else I.t=F.t||"n";switch(m.s.c>B&&(m.s.c=B),m.e.c<B&&(m.e.c=B),I.t){case"n":if(I.v==""||I.v==null){if(!U)continue;I.t="z"}else I.v=parseFloat(I.v);break;case"s":if(typeof I.v>"u"){if(!U)continue;I.t="z"}else ee=Q0[parseInt(I.v,10)],I.v=ee.t,I.r=ee.r,d.cellHTML&&(I.h=ee.h);break;case"str":I.t="s",I.v=I.v!=null?Vt(I.v):"",d.cellHTML&&(I.h=XA(I.v));break;case"inlineStr":b=L.match(r),I.t="s",b!=null&&(ee=rE(b[1]))?(I.v=ee.t,d.cellHTML&&(I.h=ee.h)):I.v="";break;case"b":I.v=Zt(I.v);break;case"d":d.cellDates?I.v=Kr(I.v,1):(I.v=qn(Kr(I.v,1)),I.t="n");break;case"e":(!d||d.cellText!==!1)&&(I.w=I.v),I.v=kR[I.v];break}if(te=ve=0,Ee=null,Ce&&F.s!==void 0&&(Ee=_.CellXf[F.s],Ee!=null&&(Ee.numFmtId!=null&&(te=Ee.numFmtId),d.cellStyles&&Ee.fillId!=null&&(ve=Ee.fillId))),i4(I,te,ve,d,x,_),d.cellDates&&Ce&&I.t=="n"&&ud(et[te])&&(I.t="d",I.v=tv(I.v)),F.cm&&d.xlmeta){var Ke=(d.xlmeta.Cell||[])[+F.cm-1];Ke&&Ke.type=="XLDAPR"&&(I.D=!0)}if(De){var Y=jn(F.r);f[Y.r]||(f[Y.r]=[]),f[Y.r][Y.c]=I}else f[F.r]=I}}}}ae.length>0&&(f["!rows"]=ae)}}();function XU(n,t){var e={},r=n.l+t;e.r=n.read_shift(4),n.l+=4;var a=n.read_shift(2);n.l+=1;var s=n.read_shift(1);return n.l=r,s&7&&(e.level=s&7),s&16&&(e.hidden=!0),s&32&&(e.hpt=a/20),e}var qU=Xu;function YU(){}function WU(n,t){var e={},r=n[n.l];return++n.l,e.above=!(r&64),e.left=!(r&128),n.l+=18,e.name=x6(n),e}function KU(n){var t=ci(n);return[t]}function QU(n){var t=$u(n);return[t]}function ZU(n){var t=ci(n),e=n.read_shift(1);return[t,e,"b"]}function JU(n){var t=$u(n),e=n.read_shift(1);return[t,e,"b"]}function e7(n){var t=ci(n),e=n.read_shift(1);return[t,e,"e"]}function t7(n){var t=$u(n),e=n.read_shift(1);return[t,e,"e"]}function r7(n){var t=ci(n),e=n.read_shift(4);return[t,e,"s"]}function n7(n){var t=$u(n),e=n.read_shift(4);return[t,e,"s"]}function a7(n){var t=ci(n),e=bn(n);return[t,e,"n"]}function o4(n){var t=$u(n),e=bn(n);return[t,e,"n"]}function i7(n){var t=ci(n),e=JA(n);return[t,e,"n"]}function s7(n){var t=$u(n),e=JA(n);return[t,e,"n"]}function o7(n){var t=ci(n),e=QA(n);return[t,e,"is"]}function l7(n){var t=ci(n),e=kn(n);return[t,e,"str"]}function c7(n){var t=$u(n),e=kn(n);return[t,e,"str"]}function u7(n,t,e){var r=n.l+t,a=ci(n);a.r=e["!row"];var s=n.read_shift(1),l=[a,s,"b"];if(e.cellFormula){n.l+=2;var c=av(n,r-n.l,e);l[3]=An(c,null,a,e.supbooks,e)}else n.l=r;return l}function h7(n,t,e){var r=n.l+t,a=ci(n);a.r=e["!row"];var s=n.read_shift(1),l=[a,s,"e"];if(e.cellFormula){n.l+=2;var c=av(n,r-n.l,e);l[3]=An(c,null,a,e.supbooks,e)}else n.l=r;return l}function f7(n,t,e){var r=n.l+t,a=ci(n);a.r=e["!row"];var s=bn(n),l=[a,s,"n"];if(e.cellFormula){n.l+=2;var c=av(n,r-n.l,e);l[3]=An(c,null,a,e.supbooks,e)}else n.l=r;return l}function d7(n,t,e){var r=n.l+t,a=ci(n);a.r=e["!row"];var s=kn(n),l=[a,s,"str"];if(e.cellFormula){n.l+=2;var c=av(n,r-n.l,e);l[3]=An(c,null,a,e.supbooks,e)}else n.l=r;return l}var p7=Xu;function g7(n,t){var e=n.l+t,r=Xu(n),a=ZA(n),s=kn(n),l=kn(n),c=kn(n);n.l=e;var h={rfx:r,relId:a,loc:s,display:c};return l&&(h.Tooltip=l),h}function m7(){}function x7(n,t,e){var r=n.l+t,a=bR(n),s=n.read_shift(1),l=[a];if(l[2]=s,e.cellFormula){var c=AU(n,r-n.l,e);l[1]=c}else n.l=r;return l}function v7(n,t,e){var r=n.l+t,a=Xu(n),s=[a];if(e.cellFormula){var l=bU(n,r-n.l,e);s[1]=l,n.l=r}else n.l=r;return s}var _7=["left","right","top","bottom","header","footer"];function y7(n){var t={};return _7.forEach(function(e){t[e]=bn(n)}),t}function w7(n){var t=n.read_shift(2);return n.l+=28,{RTL:t&32}}function A7(){}function E7(){}function b7(n,t,e,r,a,s,l){if(!n)return n;var c=t||{};r||(r={"!id":{}});var h=c.dense?[]:{},f,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},m=!1,x=!1,_,y,A,E,b,C,S,O,L,I=[];c.biff=12,c["!row"]=0;var F=0,W=!1,B=[],ee={},Z=c.supbooks||a.supbooks||[[]];if(Z.sharedf=ee,Z.arrayf=B,Z.SheetNames=a.SheetNames||a.Sheets.map(function(De){return De.name}),!c.supbooks&&(c.supbooks=Z,a.Names))for(var te=0;te<a.Names.length;++te)Z[0][te+1]=a.Names[te];var ve=[],Ce=[],Ee=!1;Ex[16]={n:"BrtShortReal",f:o4};var J;if(Co(n,function(ae,V,fe){if(!x)switch(fe){case 148:f=ae;break;case 0:_=ae,c.sheetRows&&c.sheetRows<=_.r&&(x=!0),O=un(E=_.r),c["!row"]=_.r,(ae.hidden||ae.hpt||ae.level!=null)&&(ae.hpt&&(ae.hpx=cp(ae.hpt)),Ce[ae.r]=ae);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:ae[2]},ae[2]){case"n":y.v=ae[1];break;case"s":S=Q0[ae[1]],y.v=S.t,y.r=S.r;break;case"b":y.v=!!ae[1];break;case"e":y.v=ae[1],c.cellText!==!1&&(y.w=qu[y.v]);break;case"str":y.t="s",y.v=ae[1];break;case"is":y.t="s",y.v=ae[1].t;break}if((A=l.CellXf[ae[0].iStyleRef])&&i4(y,A.numFmtId,null,c,s,l),b=ae[0].c==-1?b+1:ae[0].c,c.dense?(h[E]||(h[E]=[]),h[E][b]=y):h[Nr(b)+O]=y,c.cellFormula){for(W=!1,F=0;F<B.length;++F){var U=B[F];_.r>=U[0].s.r&&_.r<=U[0].e.r&&b>=U[0].s.c&&b<=U[0].e.c&&(y.F=yt(U[0]),W=!0)}!W&&ae.length>3&&(y.f=ae[3])}if(d.s.r>_.r&&(d.s.r=_.r),d.s.c>b&&(d.s.c=b),d.e.r<_.r&&(d.e.r=_.r),d.e.c<b&&(d.e.c=b),c.cellDates&&A&&y.t=="n"&&ud(et[A.numFmtId])){var Q=Tc(y.v);Q&&(y.t="d",y.v=new Date(Q.y,Q.m-1,Q.d,Q.H,Q.M,Q.S,Q.u))}J&&(J.type=="XLDAPR"&&(y.D=!0),J=void 0);break;case 1:case 12:if(!c.sheetStubs||m)break;y={t:"z",v:void 0},b=ae[0].c==-1?b+1:ae[0].c,c.dense?(h[E]||(h[E]=[]),h[E][b]=y):h[Nr(b)+O]=y,d.s.r>_.r&&(d.s.r=_.r),d.s.c>b&&(d.s.c=b),d.e.r<_.r&&(d.e.r=_.r),d.e.c<b&&(d.e.c=b),J&&(J.type=="XLDAPR"&&(y.D=!0),J=void 0);break;case 176:I.push(ae);break;case 49:J=((c.xlmeta||{}).Cell||[])[ae-1];break;case 494:var X=r["!id"][ae.relId];for(X?(ae.Target=X.Target,ae.loc&&(ae.Target+="#"+ae.loc),ae.Rel=X):ae.relId==""&&(ae.Target="#"+ae.loc),E=ae.rfx.s.r;E<=ae.rfx.e.r;++E)for(b=ae.rfx.s.c;b<=ae.rfx.e.c;++b)c.dense?(h[E]||(h[E]=[]),h[E][b]||(h[E][b]={t:"z",v:void 0}),h[E][b].l=ae):(C=Je({c:b,r:E}),h[C]||(h[C]={t:"z",v:void 0}),h[C].l=ae);break;case 426:if(!c.cellFormula)break;B.push(ae),L=c.dense?h[E][b]:h[Nr(b)+O],L.f=An(ae[1],d,{r:_.r,c:b},Z,c),L.F=yt(ae[0]);break;case 427:if(!c.cellFormula)break;ee[Je(ae[0].s)]=ae[1],L=c.dense?h[E][b]:h[Nr(b)+O],L.f=An(ae[1],d,{r:_.r,c:b},Z,c);break;case 60:if(!c.cellStyles)break;for(;ae.e>=ae.s;)ve[ae.e--]={width:ae.w/256,hidden:!!(ae.flags&1),level:ae.level},Ee||(Ee=!0,nE(ae.w/256)),od(ve[ae.e+1]);break;case 161:h["!autofilter"]={ref:yt(ae)};break;case 476:h["!margins"]=ae;break;case 147:a.Sheets[e]||(a.Sheets[e]={}),ae.name&&(a.Sheets[e].CodeName=ae.name),(ae.above||ae.left)&&(h["!outline"]={above:ae.above,left:ae.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ae.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:m=!0;break;case 36:m=!1;break;case 37:m=!0;break;case 38:m=!1;break;default:if(!V.T){if(!m||c.WTF)throw new Error("Unexpected record 0x"+fe.toString(16))}}},c),delete c.supbooks,delete c["!row"],!h["!ref"]&&(d.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(h["!ref"]=yt(f||d)),c.sheetRows&&h["!ref"]){var oe=hr(h["!ref"]);c.sheetRows<=+oe.e.r&&(oe.e.r=c.sheetRows-1,oe.e.r>d.e.r&&(oe.e.r=d.e.r),oe.e.r<oe.s.r&&(oe.s.r=oe.e.r),oe.e.c>d.e.c&&(oe.e.c=d.e.c),oe.e.c<oe.s.c&&(oe.s.c=oe.e.c),h["!fullref"]=h["!ref"],h["!ref"]=yt(oe))}return I.length>0&&(h["!merges"]=I),ve.length>0&&(h["!cols"]=ve),Ce.length>0&&(h["!rows"]=Ce),h}function S7(n){var t=[],e=n.match(/^<c:numCache>/),r;(n.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=e?+l[2]:l[2])});var a=wt((n.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(n.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){r=s.replace(/<.*?>/g,"")}),[t,a,r]}function T7(n,t,e,r,a,s){var l=s||{"!type":"chart"};if(!n)return s;var c=0,h=0,f="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(n.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(m){var x=S7(m);d.s.r=d.s.c=0,d.e.c=c,f=Nr(c),x[0].forEach(function(_,y){l[f+un(y)]={t:"n",v:_,z:x[1]},h=y}),d.e.r<h&&(d.e.r=h),++c}),c>0&&(l["!ref"]=yt(d)),l}function k7(n,t,e,r,a){if(!n)return n;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,c=n.match(s4);return c&&iE(c[0],s,a,e),(l=n.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}function C7(n,t){n.l+=10;var e=kn(n);return{name:e}}function R7(n,t,e,r,a){if(!n)return n;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return Co(n,function(h,f,d){switch(d){case 550:s["!rel"]=h;break;case 651:a.Sheets[e]||(a.Sheets[e]={}),h.name&&(a.Sheets[e].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}var l4=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],O7=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],D7=[],F7=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Rk(n,t){for(var e=0;e!=n.length;++e)for(var r=n[e],a=0;a!=t.length;++a){var s=t[a];if(r[s[0]]==null)r[s[0]]=s[1];else switch(s[2]){case"bool":typeof r[s[0]]=="string"&&(r[s[0]]=Zt(r[s[0]]));break;case"int":typeof r[s[0]]=="string"&&(r[s[0]]=parseInt(r[s[0]],10));break}}}function Ok(n,t){for(var e=0;e!=t.length;++e){var r=t[e];if(n[r[0]]==null)n[r[0]]=r[1];else switch(r[2]){case"bool":typeof n[r[0]]=="string"&&(n[r[0]]=Zt(n[r[0]]));break;case"int":typeof n[r[0]]=="string"&&(n[r[0]]=parseInt(n[r[0]],10));break}}}function c4(n){Ok(n.WBProps,l4),Ok(n.CalcPr,F7),Rk(n.WBView,O7),Rk(n.Sheets,D7),Wh.date1904=Zt(n.WBProps.date1904)}var M7="][*?/\\".split("");function L7(n,t){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var e=!0;return M7.forEach(function(r){if(n.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),e}var N7=/<\w+:workbook/;function P7(n,t){if(!n)throw new Error("Could not find file");var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,a="xmlns",s={},l=0;if(n.replace(Rn,function(h,f){var d=qe(h);switch(ws(d[0])){case"<?xml":break;case"<workbook":h.match(N7)&&(a="xmlns"+h.match(/<(\w+):/)[1]),e.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],e.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":l4.forEach(function(m){if(d[m[0]]!=null)switch(m[2]){case"bool":e.WBProps[m[0]]=Zt(d[m[0]]);break;case"int":e.WBProps[m[0]]=parseInt(d[m[0]],10);break;default:e.WBProps[m[0]]=d[m[0]]}}),d.codeName&&(e.WBProps.CodeName=Vt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],e.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=wt(Vt(d.name)),delete d[0],e.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":s={},s.Name=Vt(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),Zt(d.hidden||"0")&&(s.Hidden=!0),l=f+h.length;break;case"</definedName>":s.Ref=wt(Vt(n.slice(l,f))),e.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],e.CalcPr=d;break;case"<calcPr/>":delete d[0],e.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return h}),e6.indexOf(e.xmlns)===-1)throw new Error("Unknown Namespace: "+e.xmlns);return c4(e),e}function I7(n,t){var e={};return e.Hidden=n.read_shift(4),e.iTabID=n.read_shift(4),e.strRelID=nw(n),e.name=kn(n),e}function B7(n,t){var e={},r=n.read_shift(4);e.defaultThemeVersion=n.read_shift(4);var a=t>8?kn(n):"";return a.length>0&&(e.CodeName=a),e.autoCompressPictures=!!(r&65536),e.backupFile=!!(r&64),e.checkCompatibility=!!(r&4096),e.date1904=!!(r&1),e.filterPrivacy=!!(r&8),e.hidePivotFieldList=!!(r&1024),e.promptedSolutions=!!(r&16),e.publishItems=!!(r&2048),e.refreshAllConnections=!!(r&262144),e.saveExternalLinkValues=!!(r&128),e.showBorderUnselectedTables=!!(r&4),e.showInkAnnotation=!!(r&32),e.showObjects=["all","placeholders","none"][r>>13&3],e.showPivotChartFilter=!!(r&32768),e.updateLinks=["userSet","never","always"][r>>8&3],e}function U7(n,t){var e={};return n.read_shift(4),e.ArchID=n.read_shift(4),n.l+=t-8,e}function H7(n,t,e){var r=n.l+t;n.l+=4,n.l+=1;var a=n.read_shift(4),s=v6(n),l=EU(n,0,e),c=ZA(n);n.l=r;var h={Name:s,Ptg:l};return a<268435455&&(h.Sheet=a),c&&(h.Comment=c),h}function z7(n,t){var e={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],a=!1;t||(t={}),t.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],Ex[16]={n:"BrtFRTArchID$",f:U7},Co(n,function(h,f,d){switch(d){case 156:l.SheetNames.push(h.name),e.Sheets.push(h);break;case 153:e.WBProps=h;break;case 39:h.Sheet!=null&&(t.SID=h.Sheet),h.Ref=An(h.Ptg,null,null,l,t),delete t.SID,delete h.Ptg,s.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([d,h]):l[0]=[d,h],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(h),l.XTI=l.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(d),a=!0;break;case 36:r.pop(),a=!1;break;case 37:r.push(d),a=!0;break;case 38:r.pop(),a=!1;break;case 16:break;default:if(!f.T){if(!a||t.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),c4(e),e.Names=s,e.supbooks=l,e}function j7(n,t,e){return t.slice(-4)===".bin"?z7(n,e):P7(n,e)}function G7(n,t,e,r,a,s,l,c){return t.slice(-4)===".bin"?b7(n,r,e,a,s,l,c):IU(n,r,e,a,s,l,c)}function V7(n,t,e,r,a,s,l,c){return t.slice(-4)===".bin"?R7(n,r,e,a,s):k7(n,r,e,a,s)}function $7(n,t,e,r,a,s,l,c){return t.slice(-4)===".bin"?J5():eB()}function X7(n,t,e,r,a,s,l,c){return t.slice(-4)===".bin"?Q5():Z5()}function q7(n,t,e,r){return t.slice(-4)===".bin"?p5(n,e,r):l5(n,e,r)}function Y7(n,t,e){return WR(n,e)}function W7(n,t,e){return t.slice(-4)===".bin"?OI(n,e):CI(n,e)}function K7(n,t,e){return t.slice(-4)===".bin"?Y5(n,e):G5(n,e)}function Q7(n,t,e){return t.slice(-4)===".bin"?H5(n):B5(n)}function Z7(n,t,e,r){return e.slice(-4)===".bin"?z5(n,t,e,r):void 0}function J7(n,t,e){return t.slice(-4)===".bin"?P5(n,t,e):I5(n,t,e)}var u4=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,h4=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function mi(n,t){var e=n.split(/\s+/),r=[];if(r[0]=e[0],e.length===1)return r;var a=n.match(u4),s,l,c,h;if(a)for(h=0;h!=a.length;++h)s=a[h].match(h4),(l=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(l+1),r[c]=s[2].slice(1,s[2].length-1));return r}function e9(n){var t=n.split(/\s+/),e={};if(t.length===1)return e;var r=n.match(u4),a,s,l,c;if(r)for(c=0;c!=r.length;++c)a=r[c].match(h4),(s=a[1].indexOf(":"))===-1?e[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(s+1),e[l]=a[2].slice(1,a[2].length-1));return e}var J0;function t9(n,t){var e=J0[n]||wt(n);return e==="General"?Mu(t):li(e,t)}function r9(n,t,e,r){var a=r;switch((e[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Zt(r);break;case"i2":case"int":a=parseInt(r,10);break;case"r4":case"float":a=parseFloat(r);break;case"date":case"dateTime.tz":a=Kr(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+e[0])}n[wt(t)]=a}function n9(n,t,e){if(n.t!=="z"){if(!e||e.cellText!==!1)try{n.t==="e"?n.w=n.w||qu[n.v]:t==="General"?n.t==="n"?(n.v|0)===n.v?n.w=n.v.toString(10):n.w=ap(n.v):n.w=Mu(n.v):n.w=t9(t||"General",n.v)}catch(s){if(e.WTF)throw s}try{var r=J0[t]||t||"General";if(e.cellNF&&(n.z=r),e.cellDates&&n.t=="n"&&ud(r)){var a=Tc(n.v);a&&(n.t="d",n.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(e.WTF)throw s}}}function a9(n,t,e){if(e.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=r5[r.Pattern]||r.Pattern)}n[t.ID]=t}function i9(n,t,e,r,a,s,l,c,h,f){var d="General",m=r.StyleID,x={};f=f||{};var _=[],y=0;for(m===void 0&&c&&(m=c.StyleID),m===void 0&&l&&(m=l.StyleID);s[m]!==void 0&&(s[m].nf&&(d=s[m].nf),s[m].Interior&&_.push(s[m].Interior),!!s[m].Parent);)m=s[m].Parent;switch(e.Type){case"Boolean":r.t="b",r.v=Zt(n);break;case"String":r.t="s",r.r=ZT(wt(n)),r.v=n.indexOf("<")>-1?wt(t||n).replace(/<.*?>/g,""):r.r;break;case"DateTime":n.slice(-1)!="Z"&&(n+="Z"),r.v=(Kr(n)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),r.v!==r.v?r.v=wt(n):r.v<60&&(r.v=r.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+n),r.t||(r.t="n");break;case"Error":r.t="e",r.v=kR[n],f.cellText!==!1&&(r.w=n);break;default:n==""&&t==""?r.t="z":(r.t="s",r.v=ZT(t||n));break}if(n9(r,d,f),f.cellFormula!==!1)if(r.Formula){var A=wt(r.Formula);A.charCodeAt(0)==61&&(A=A.slice(1)),r.f=Yh(A,a),delete r.Formula,r.ArrayRange=="RC"?r.F=Yh("RC:RC",a):r.ArrayRange&&(r.F=Yh(r.ArrayRange,a),h.push([hr(r.F),r.F]))}else for(y=0;y<h.length;++y)a.r>=h[y][0].s.r&&a.r<=h[y][0].e.r&&a.c>=h[y][0].s.c&&a.c<=h[y][0].e.c&&(r.F=h[y][1]);f.cellStyles&&(_.forEach(function(E){!x.patternType&&E.patternType&&(x.patternType=E.patternType)}),r.s=x),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function s9(n){n.t=n.v||"",n.t=n.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.v=n.w=n.ixfe=void 0}function Iy(n,t){var e=t||{};JC();var r=E0(qA(n));(e.type=="binary"||e.type=="array"||e.type=="base64")&&(r=Vt(r));var a=r.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=cn(e);return l.type="string",op.to_workbook(r,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Bt){a.indexOf("<"+Bt)>=0&&(s=!0)}),s)return g9(r,e);J0={"General Number":"General","General Date":et[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":et[15],"Short Date":et[14],"Long Time":et[19],"Medium Time":et[18],"Short Time":et[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:et[2],Standard:et[4],Percent:et[10],Scientific:et[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,h=[],f,d={},m=[],x=e.dense?[]:{},_="",y={},A={},E=mi('<Data ss:Type="String">'),b=0,C=0,S=0,O={s:{r:2e6,c:2e6},e:{r:0,c:0}},L={},I={},F="",W=0,B=[],ee={},Z={},te=0,ve=[],Ce=[],Ee={},J=[],oe,De=!1,ae=[],V=[],fe={},U=0,Q=0,X={Sheets:[],WBProps:{date1904:!1}},K={};sp.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var se="";c=sp.exec(r);)switch(c[3]=(se=c[3]).toLowerCase()){case"data":if(se=="data"){if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&h.push([c[3],!0]);break}if(h[h.length-1][1])break;c[1]==="/"?i9(r.slice(b,c.index),F,E,h[h.length-1][0]=="comment"?Ee:y,{c:C,r:S},L,J[C],A,ae,e):(F="",E=mi(c[0]),b=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(Ce.length>0&&(y.c=Ce),(!e.sheetRows||e.sheetRows>S)&&y.v!==void 0&&(e.dense?(x[S]||(x[S]=[]),x[S][C]=y):x[Nr(C)+un(S)]=y),y.HRef&&(y.l={Target:wt(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(U=C+(parseInt(y.MergeAcross,10)|0),Q=S+(parseInt(y.MergeDown,10)|0),B.push({s:{c:C,r:S},e:{c:U,r:Q}})),!e.sheetStubs)y.MergeAcross?C=U+1:++C;else if(y.MergeAcross||y.MergeDown){for(var _e=C;_e<=U;++_e)for(var be=S;be<=Q;++be)(_e>C||be>S)&&(e.dense?(x[be]||(x[be]=[]),x[be][_e]={t:"z"}):x[Nr(_e)+un(be)]={t:"z"});C=U+1}else++C;else y=e9(c[0]),y.Index&&(C=+y.Index-1),C<O.s.c&&(O.s.c=C),C>O.e.c&&(O.e.c=C),c[0].slice(-2)==="/>"&&++C,Ce=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(S<O.s.r&&(O.s.r=S),S>O.e.r&&(O.e.r=S),c[0].slice(-2)==="/>"&&(A=mi(c[0]),A.Index&&(S=+A.Index-1)),C=0,++S):(A=mi(c[0]),A.Index&&(S=+A.Index-1),fe={},(A.AutoFitHeight=="0"||A.Height)&&(fe.hpx=parseInt(A.Height,10),fe.hpt=YR(fe.hpx),V[S]=fe),A.Hidden=="1"&&(fe.hidden=!0,V[S]=fe));break;case"worksheet":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));m.push(_),O.s.r<=O.e.r&&O.s.c<=O.e.c&&(x["!ref"]=yt(O),e.sheetRows&&e.sheetRows<=O.e.r&&(x["!fullref"]=x["!ref"],O.e.r=e.sheetRows-1,x["!ref"]=yt(O))),B.length&&(x["!merges"]=B),J.length>0&&(x["!cols"]=J),V.length>0&&(x["!rows"]=V),d[_]=x}else O={s:{r:2e6,c:2e6},e:{r:0,c:0}},S=C=0,h.push([c[3],!1]),f=mi(c[0]),_=wt(f.Name),x=e.dense?[]:{},B=[],ae=[],V=[],K={name:_,Hidden:0},X.Sheets.push(K);break;case"table":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else{if(c[0].slice(-2)=="/>")break;h.push([c[3],!1]),J=[],De=!1}break;case"style":c[1]==="/"?a9(L,I,e):I=mi(c[0]);break;case"numberformat":I.nf=wt(mi(c[0]).Format||"General"),J0[I.nf]&&(I.nf=J0[I.nf]);for(var Te=0;Te!=392&&et[Te]!=I.nf;++Te);if(Te==392){for(Te=57;Te!=392;++Te)if(et[Te]==null){Du(I.nf,Te);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(oe=mi(c[0]),oe.Hidden&&(oe.hidden=!0,delete oe.Hidden),oe.Width&&(oe.wpx=parseInt(oe.Width,10)),!De&&oe.wpx>10){De=!0,zn=XR;for(var ye=0;ye<J.length;++ye)J[ye]&&od(J[ye])}De&&od(oe),J[oe.Index-1||J.length]=oe;for(var Ke=0;Ke<+oe.Span;++Ke)J[J.length]=cn(oe);break;case"namedrange":if(c[1]==="/")break;X.Names||(X.Names=[]);var Y=qe(c[0]),Rt={Name:Y.Name,Ref:Yh(Y.RefersTo.slice(1),{r:0,c:0})};X.Sheets.length>0&&(Rt.Sheet=X.Sheets.length-1),X.Names.push(Rt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?F+=r.slice(W,c.index):W=c.index+c[0].length;break;case"interior":if(!e.cellStyles)break;I.Interior=mi(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?G6(ee,se,r.slice(te,c.index)):te=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else h.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"));s9(Ee),Ce.push(Ee)}else h.push([c[3],!1]),f=mi(c[0]),Ee={a:f.Author};break;case"autofilter":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var ft=mi(c[0]);x["!autofilter"]={ref:Yh(ft.Range).replace(/\$/g,"")},h.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&h.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((f=h.pop())[0]!==c[3])throw new Error("Bad state: "+f.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&h.push([c[3],!0]);break;case"null":break;default:if(h.length==0&&c[3]=="document"||h.length==0&&c[3]=="uof")return Pk(r,e);var Et=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Et=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Et=!1}break;case"excelworkbook":switch(c[3]){case"date1904":X.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Et=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Et=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(r.slice(te,c.index)){case"SheetHidden":K.Hidden=1;break;case"SheetVeryHidden":K.Hidden=2;break}else te=c.index+c[0].length;break;case"header":x["!margins"]||Z0(x["!margins"]={},"xlml"),isNaN(+qe(c[0]).Margin)||(x["!margins"].header=+qe(c[0]).Margin);break;case"footer":x["!margins"]||Z0(x["!margins"]={},"xlml"),isNaN(+qe(c[0]).Margin)||(x["!margins"].footer=+qe(c[0]).Margin);break;case"pagemargins":var Qe=qe(c[0]);x["!margins"]||Z0(x["!margins"]={},"xlml"),isNaN(+Qe.Top)||(x["!margins"].top=+Qe.Top),isNaN(+Qe.Left)||(x["!margins"].left=+Qe.Left),isNaN(+Qe.Right)||(x["!margins"].right=+Qe.Right),isNaN(+Qe.Bottom)||(x["!margins"].bottom=+Qe.Bottom);break;case"displayrighttoleft":X.Views||(X.Views=[]),X.Views[0]||(X.Views[0]={}),X.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Et=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Et=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Et=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Et=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Et=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Et=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Et=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Et=!1}break;case"smarttags":break;default:Et=!1;break}if(Et||c[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?r9(Z,se,ve,r.slice(te,c.index)):(ve=c,te=c.index+c[0].length);break}if(e.WTF)throw"Unrecognized tag: "+c[3]+"|"+h.join("|")}var Me={};return!e.bookSheets&&!e.bookProps&&(Me.Sheets=d),Me.SheetNames=m,Me.Workbook=X,Me.SSF=cn(et),Me.Props=ee,Me.Custprops=Z,Me}function ow(n,t){switch(lE(t=t||{}),t.type||"base64"){case"base64":return Iy(Ma(n),t);case"binary":case"buffer":case"file":return Iy(n,t);case"array":return Iy(Vu(n),t)}}function o9(n){var t={},e=n.content;if(e.l=28,t.AnsiUserType=e.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=w6(e),e.length-e.l<=4)return t;var r=e.read_shift(4);if(r==0||r>40||(e.l-=4,t.Reserved1=e.read_shift(0,"lpstr-ansi"),e.length-e.l<=4)||(r=e.read_shift(4),r!==1907505652)||(t.UnicodeClipboardFormat=A6(e),r=e.read_shift(4),r==0||r>40))return t;e.l-=4,t.Reserved2=e.read_shift(0,"lpwstr")}var l9=[60,1084,2066,2165,2175];function c9(n,t,e,r,a){var s=r,l=[],c=e.slice(e.l,e.l+s);if(a.enc&&a.enc.insitu&&c.length>0)switch(n){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}l.push(c),e.l+=s;for(var h=vo(e,e.l),f=lw[h],d=0;f!=null&&l9.indexOf(h)>-1;)s=vo(e,e.l+2),d=e.l+4,h==2066?d+=4:(h==2165||h==2175)&&(d+=12),c=e.slice(d,e.l+4+s),l.push(c),e.l+=4+s,f=lw[h=vo(e,e.l)];var m=al(l);ln(m,0);var x=0;m.lens=[];for(var _=0;_<l.length;++_)m.lens.push(x),x+=l[_].length;if(m.length<r)throw"XLS Record 0x"+n.toString(16)+" Truncated: "+m.length+" < "+r;return t.f(m,m.length,a)}function Yi(n,t,e){if(n.t!=="z"&&n.XF){var r=0;try{r=n.z||n.XF.numFmtId||0,t.cellNF&&(n.z=et[r])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{n.t==="e"?n.w=n.w||qu[n.v]:r===0||r=="General"?n.t==="n"?(n.v|0)===n.v?n.w=n.v.toString(10):n.w=ap(n.v):n.w=Mu(n.v):n.w=li(r,n.v,{date1904:!!e,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&r&&n.t=="n"&&ud(et[r]||String(r))){var a=Tc(n.v);a&&(n.t="d",n.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function C1(n,t,e){return{v:n,ixfe:t,t:e}}function u9(n,t){var e={opts:{}},r={},a=t.dense?[]:{},s={},l={},c=null,h=[],f="",d={},m,x="",_,y,A,E,b={},C=[],S,O,L=[],I=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},W={},B=function(rt){return rt<8?Fu[rt]:rt<64&&I[rt-8]||Fu[rt]},ee=function(rt,Jt,Wn){var $t=Jt.XF.data;if(!(!$t||!$t.patternType||!Wn||!Wn.cellStyles)){Jt.s={},Jt.s.patternType=$t.patternType;var fr;(fr=lp(B($t.icvFore)))&&(Jt.s.fgColor={rgb:fr}),(fr=lp(B($t.icvBack)))&&(Jt.s.bgColor={rgb:fr})}},Z=function(rt,Jt,Wn){if(!(fe>1)&&!(Wn.sheetRows&&rt.r>=Wn.sheetRows)){if(Wn.cellStyles&&Jt.XF&&Jt.XF.data&&ee(rt,Jt,Wn),delete Jt.ixfe,delete Jt.XF,m=rt,x=Je(rt),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),rt.r<l.s.r&&(l.s.r=rt.r),rt.c<l.s.c&&(l.s.c=rt.c),rt.r+1>l.e.r&&(l.e.r=rt.r+1),rt.c+1>l.e.c&&(l.e.c=rt.c+1),Wn.cellFormula&&Jt.f){for(var $t=0;$t<C.length;++$t)if(!(C[$t][0].s.c>rt.c||C[$t][0].s.r>rt.r)&&!(C[$t][0].e.c<rt.c||C[$t][0].e.r<rt.r)){Jt.F=yt(C[$t][0]),(C[$t][0].s.c!=rt.c||C[$t][0].s.r!=rt.r)&&delete Jt.f,Jt.f&&(Jt.f=""+An(C[$t][1],l,rt,ae,te));break}}Wn.dense?(a[rt.r]||(a[rt.r]=[]),a[rt.r][rt.c]=Jt):a[x]=Jt}},te={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:C,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(te.password=t.password);var ve,Ce=[],Ee=[],J=[],oe=[],De=!1,ae=[];ae.SheetNames=te.snames,ae.sharedf=te.sharedf,ae.arrayf=te.arrayf,ae.names=[],ae.XTI=[];var V=0,fe=0,U=0,Q=[],X=[],K;te.codepage=1200,Li(1200);for(var se=!1;n.l<n.length-1;){var _e=n.l,be=n.read_shift(2);if(be===0&&V===10)break;var Te=n.l===n.length?0:n.read_shift(2),ye=lw[be];if(ye&&ye.f){if(t.bookSheets&&V===133&&be!==133)break;if(V=be,ye.r===2||ye.r==12){var Ke=n.read_shift(2);if(Te-=2,!te.enc&&Ke!==be&&((Ke&255)<<8|Ke>>8)!==be)throw new Error("rt mismatch: "+Ke+"!="+be);ye.r==12&&(n.l+=10,Te-=10)}var Y={};if(be===10?Y=ye.f(n,Te,te):Y=c9(be,ye,n,Te,te),fe==0&&[9,521,1033,2057].indexOf(V)===-1)continue;switch(be){case 34:e.opts.Date1904=F.WBProps.date1904=Y;break;case 134:e.opts.WriteProtect=!0;break;case 47:if(te.enc||(n.l=0),te.enc=Y,!t.password)throw new Error("File is password-protected");if(Y.valid==null)throw new Error("Encryption scheme unsupported");if(!Y.valid)throw new Error("Password is incorrect");break;case 92:te.lastuser=Y;break;case 66:var Rt=Number(Y);switch(Rt){case 21010:Rt=1200;break;case 32768:Rt=1e4;break;case 32769:Rt=1252;break}Li(te.codepage=Rt),se=!0;break;case 317:te.rrtabid=Y;break;case 25:te.winlocked=Y;break;case 439:e.opts.RefreshAll=Y;break;case 12:e.opts.CalcCount=Y;break;case 16:e.opts.CalcDelta=Y;break;case 17:e.opts.CalcIter=Y;break;case 13:e.opts.CalcMode=Y;break;case 14:e.opts.CalcPrecision=Y;break;case 95:e.opts.CalcSaveRecalc=Y;break;case 15:te.CalcRefMode=Y;break;case 2211:e.opts.FullCalc=Y;break;case 129:Y.fDialog&&(a["!type"]="dialog"),Y.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),Y.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:L.push(Y);break;case 430:ae.push([Y]),ae[ae.length-1].XTI=[];break;case 35:case 547:ae[ae.length-1].push(Y);break;case 24:case 536:K={Name:Y.Name,Ref:An(Y.rgce,l,null,ae,te)},Y.itab>0&&(K.Sheet=Y.itab-1),ae.names.push(K),ae[0]||(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].push(Y),Y.Name=="_xlnm._FilterDatabase"&&Y.itab>0&&Y.rgce&&Y.rgce[0]&&Y.rgce[0][0]&&Y.rgce[0][0][0]=="PtgArea3d"&&(X[Y.itab-1]={ref:yt(Y.rgce[0][0][1][2])});break;case 22:te.ExternCount=Y;break;case 23:ae.length==0&&(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].XTI=ae[ae.length-1].XTI.concat(Y),ae.XTI=ae.XTI.concat(Y);break;case 2196:if(te.biff<8)break;K!=null&&(K.Comment=Y[1]);break;case 18:a["!protect"]=Y;break;case 19:Y!==0&&te.WTF&&console.error("Password verifier: "+Y);break;case 133:s[Y.pos]=Y,te.snames.push(Y.name);break;case 10:{if(--fe)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=yt(l),t.sheetRows&&t.sheetRows<=l.e.r){var ft=l.e.r;l.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=yt(l),l.e.r=ft}l.e.r++,l.e.c++}Ce.length>0&&(a["!merges"]=Ce),Ee.length>0&&(a["!objects"]=Ee),J.length>0&&(a["!cols"]=J),oe.length>0&&(a["!rows"]=oe),F.Sheets.push(W)}f===""?d=a:r[f]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(te.biff===8&&(te.biff={9:2,521:3,1033:4}[be]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Y.BIFFVer]||8),te.biffguess=Y.BIFFVer==0,Y.BIFFVer==0&&Y.dt==4096&&(te.biff=5,se=!0,Li(te.codepage=28591)),te.biff==8&&Y.BIFFVer==0&&Y.dt==16&&(te.biff=2),fe++)break;if(a=t.dense?[]:{},te.biff<8&&!se&&(se=!0,Li(te.codepage=t.codepage||1252)),te.biff<5||Y.BIFFVer==0&&Y.dt==4096){f===""&&(f="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Et={pos:n.l-Te,name:f};s[Et.pos]=Et,te.snames.push(f)}else f=(s[_e]||{name:""}).name;Y.dt==32&&(a["!type"]="chart"),Y.dt==64&&(a["!type"]="macro"),Ce=[],Ee=[],te.arrayf=C=[],J=[],oe=[],De=!1,W={Hidden:(s[_e]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[Y.r]||[])[Y.c]:a[Je({c:Y.c,r:Y.r})])&&++Y.c,S={ixfe:Y.ixfe,XF:L[Y.ixfe]||{},v:Y.val,t:"n"},U>0&&(S.z=Q[S.ixfe>>8&63]),Yi(S,t,e.opts.Date1904),Z({c:Y.c,r:Y.r},S,t);break;case 5:case 517:S={ixfe:Y.ixfe,XF:L[Y.ixfe],v:Y.val,t:Y.t},U>0&&(S.z=Q[S.ixfe>>8&63]),Yi(S,t,e.opts.Date1904),Z({c:Y.c,r:Y.r},S,t);break;case 638:S={ixfe:Y.ixfe,XF:L[Y.ixfe],v:Y.rknum,t:"n"},U>0&&(S.z=Q[S.ixfe>>8&63]),Yi(S,t,e.opts.Date1904),Z({c:Y.c,r:Y.r},S,t);break;case 189:for(var Qe=Y.c;Qe<=Y.C;++Qe){var Me=Y.rkrec[Qe-Y.c][0];S={ixfe:Me,XF:L[Me],v:Y.rkrec[Qe-Y.c][1],t:"n"},U>0&&(S.z=Q[S.ixfe>>8&63]),Yi(S,t,e.opts.Date1904),Z({c:Qe,r:Y.r},S,t)}break;case 6:case 518:case 1030:{if(Y.val=="String"){c=Y;break}if(S=C1(Y.val,Y.cell.ixfe,Y.tt),S.XF=L[S.ixfe],t.cellFormula){var Bt=Y.formula;if(Bt&&Bt[0]&&Bt[0][0]&&Bt[0][0][0]=="PtgExp"){var hn=Bt[0][0][1][0],Yn=Bt[0][0][1][1],la=Je({r:hn,c:Yn});b[la]?S.f=""+An(Y.formula,l,Y.cell,ae,te):S.F=((t.dense?(a[hn]||[])[Yn]:a[la])||{}).F}else S.f=""+An(Y.formula,l,Y.cell,ae,te)}U>0&&(S.z=Q[S.ixfe>>8&63]),Yi(S,t,e.opts.Date1904),Z(Y.cell,S,t),c=Y}break;case 7:case 519:if(c)c.val=Y,S=C1(Y,c.cell.ixfe,"s"),S.XF=L[S.ixfe],t.cellFormula&&(S.f=""+An(c.formula,l,c.cell,ae,te)),U>0&&(S.z=Q[S.ixfe>>8&63]),Yi(S,t,e.opts.Date1904),Z(c.cell,S,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{C.push(Y);var Yl=Je(Y[0].s);if(_=t.dense?(a[Y[0].s.r]||[])[Y[0].s.c]:a[Yl],t.cellFormula&&_){if(!c||!Yl||!_)break;_.f=""+An(Y[1],l,Y[0],ae,te),_.F=yt(Y[0])}}break;case 1212:{if(!t.cellFormula)break;if(x){if(!c)break;b[Je(c.cell)]=Y[0],_=t.dense?(a[c.cell.r]||[])[c.cell.c]:a[Je(c.cell)],(_||{}).f=""+An(Y[0],l,m,ae,te)}}break;case 253:S=C1(h[Y.isst].t,Y.ixfe,"s"),h[Y.isst].h&&(S.h=h[Y.isst].h),S.XF=L[S.ixfe],U>0&&(S.z=Q[S.ixfe>>8&63]),Yi(S,t,e.opts.Date1904),Z({c:Y.c,r:Y.r},S,t);break;case 513:t.sheetStubs&&(S={ixfe:Y.ixfe,XF:L[Y.ixfe],t:"z"},U>0&&(S.z=Q[S.ixfe>>8&63]),Yi(S,t,e.opts.Date1904),Z({c:Y.c,r:Y.r},S,t));break;case 190:if(t.sheetStubs)for(var Hi=Y.c;Hi<=Y.C;++Hi){var Yt=Y.ixfe[Hi-Y.c];S={ixfe:Yt,XF:L[Yt],t:"z"},U>0&&(S.z=Q[S.ixfe>>8&63]),Yi(S,t,e.opts.Date1904),Z({c:Hi,r:Y.r},S,t)}break;case 214:case 516:case 4:S=C1(Y.val,Y.ixfe,"s"),S.XF=L[S.ixfe],U>0&&(S.z=Q[S.ixfe>>8&63]),Yi(S,t,e.opts.Date1904),Z({c:Y.c,r:Y.r},S,t);break;case 0:case 512:fe===1&&(l=Y);break;case 252:h=Y;break;case 1054:if(te.biff==4){Q[U++]=Y[1];for(var ui=0;ui<U+163&&et[ui]!=Y[1];++ui);ui>=163&&Du(Y[1],U+163)}else Du(Y[1],Y[0]);break;case 30:{Q[U++]=Y;for(var hi=0;hi<U+163&&et[hi]!=Y;++hi);hi>=163&&Du(Y,U+163)}break;case 229:Ce=Ce.concat(Y);break;case 93:Ee[Y.cmo[0]]=te.lastobj=Y;break;case 438:te.lastobj.TxO=Y;break;case 127:te.lastobj.ImData=Y;break;case 440:for(E=Y[0].s.r;E<=Y[0].e.r;++E)for(A=Y[0].s.c;A<=Y[0].e.c;++A)_=t.dense?(a[E]||[])[A]:a[Je({c:A,r:E})],_&&(_.l=Y[1]);break;case 2048:for(E=Y[0].s.r;E<=Y[0].e.r;++E)for(A=Y[0].s.c;A<=Y[0].e.c;++A)_=t.dense?(a[E]||[])[A]:a[Je({c:A,r:E})],_&&_.l&&(_.l.Tooltip=Y[1]);break;case 28:{if(te.biff<=5&&te.biff>=2)break;_=t.dense?(a[Y[0].r]||[])[Y[0].c]:a[Je(Y[0])];var Ro=Ee[Y[2]];_||(t.dense?(a[Y[0].r]||(a[Y[0].r]=[]),_=a[Y[0].r][Y[0].c]={t:"z"}):_=a[Je(Y[0])]={t:"z"},l.e.r=Math.max(l.e.r,Y[0].r),l.s.r=Math.min(l.s.r,Y[0].r),l.e.c=Math.max(l.e.c,Y[0].c),l.s.c=Math.min(l.s.c,Y[0].c)),_.c||(_.c=[]),y={a:Y[1],t:Ro.TxO.t},_.c.push(y)}break;case 2173:F5(L[Y.ixfe],Y.ext);break;case 125:{if(!te.cellStyles)break;for(;Y.e>=Y.s;)J[Y.e--]={width:Y.w/256,level:Y.level||0,hidden:!!(Y.flags&1)},De||(De=!0,nE(Y.w/256)),od(J[Y.e+1])}break;case 520:{var vr={};Y.level!=null&&(oe[Y.r]=vr,vr.level=Y.level),Y.hidden&&(oe[Y.r]=vr,vr.hidden=!0),Y.hpt&&(oe[Y.r]=vr,vr.hpt=Y.hpt,vr.hpx=cp(Y.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Z0(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[be]]=Y;break;case 161:a["!margins"]||Z0(a["!margins"]={}),a["!margins"].header=Y.header,a["!margins"].footer=Y.footer;break;case 574:Y.RTL&&(F.Views[0].RTL=!0);break;case 146:I=Y;break;case 2198:ve=Y;break;case 140:O=Y;break;case 442:f?W.CodeName=Y||W.name:F.WBProps.CodeName=Y||"ThisWorkbook";break}}else ye||console.error("Missing Info for XLS Record 0x"+be.toString(16)),n.l+=Te}return e.SheetNames=vs(s).sort(function(La,rt){return Number(La)-Number(rt)}).map(function(La){return s[La].name}),t.bookSheets||(e.Sheets=r),!e.SheetNames.length&&d["!ref"]?(e.SheetNames.push("Sheet1"),e.Sheets&&(e.Sheets.Sheet1=d)):e.Preamble=d,e.Sheets&&X.forEach(function(La,rt){e.Sheets[e.SheetNames[rt]]["!autofilter"]=La}),e.Strings=h,e.SSF=cn(et),te.enc&&(e.Encryption=te.enc),ve&&(e.Themes=ve),e.Metadata={},O!==void 0&&(e.Metadata.Country=O),ae.names.length>0&&(F.Names=ae.names),e.Workbook=F,e}var Dk={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function h9(n,t,e){var r=_t.find(n,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var a=pk(r,C6,Dk.DSI);for(var s in a)t[s]=a[s]}catch(f){if(e.WTF)throw f}var l=_t.find(n,"/!SummaryInformation");if(l&&l.size>0)try{var c=pk(l,R6,Dk.SI);for(var h in c)t[h]==null&&(t[h]=c[h])}catch(f){if(e.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(RR(t.HeadingPairs,t.TitlesOfParts,t,e),delete t.HeadingPairs,delete t.TitlesOfParts)}function f4(n,t){t||(t={}),lE(t),zC(),t.codepage&&HA(t.codepage);var e,r;if(n.FullPaths){if(_t.find(n,"/encryption"))throw new Error("File is password-protected");e=_t.find(n,"!CompObj"),r=_t.find(n,"/Workbook")||_t.find(n,"/Book")}else{switch(t.type){case"base64":n=Mi(Ma(n));break;case"binary":n=Mi(n);break;case"buffer":break;case"array":Array.isArray(n)||(n=Array.prototype.slice.call(n));break}ln(n,0),r={content:n}}var a,s;if(e&&o9(e),t.bookProps&&!t.bookSheets)a={};else{var l=xt?"buffer":"array";if(r&&r.content)a=u9(r.content,t);else if((s=_t.find(n,"PerfectOffice_MAIN"))&&s.content)a=K0.to_workbook(s.content,(t.type=l,t));else if((s=_t.find(n,"NativeContent_MAIN"))&&s.content)a=K0.to_workbook(s.content,(t.type=l,t));else throw(s=_t.find(n,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&n.FullPaths&&_t.find(n,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=K5(n))}var c={};return n.FullPaths&&h9(n,c,t),a.Props=a.Custprops=c,t.bookFiles&&(a.cfb=n),a}var Ex={0:{f:XU},1:{f:KU},2:{f:i7},3:{f:e7},4:{f:ZU},5:{f:a7},6:{f:l7},7:{f:r7},8:{f:d7},9:{f:f7},10:{f:u7},11:{f:h7},12:{f:QU},13:{f:s7},14:{f:t7},15:{f:JU},16:{f:o4},17:{f:c7},18:{f:n7},19:{f:QA},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:H7},40:{},42:{},43:{f:u5},44:{f:c5},45:{f:h5},46:{f:d5},47:{f:f5},48:{},49:{f:p6},50:{},51:{f:L5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:zR},62:{f:o7},63:{f:U5},64:{f:A7},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Cn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:w7},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:WU},148:{f:qU,p:16},151:{f:m7},152:{},153:{f:B7},154:{},155:{},156:{f:I7},157:{},158:{},159:{T:1,f:RI},160:{T:-1},161:{T:1,f:Xu},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:p7},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:M5},336:{T:-1},337:{f:N5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:nw},357:{},358:{},359:{},360:{T:1},361:{},362:{f:HR},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:x7},427:{f:v7},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:y7},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:YU},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:g7},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:nw},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:q5},633:{T:1},634:{T:-1},635:{T:1,f:X5},636:{T:-1},637:{f:m6},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:C7},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:E7},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},lw={6:{f:Ny},10:{f:Zo},12:{f:Sr},13:{f:Sr},14:{f:pr},15:{f:pr},16:{f:bn},17:{f:pr},18:{f:pr},19:{f:Sr},20:{f:vk},21:{f:vk},23:{f:HR},24:{f:yk},25:{f:pr},26:{},27:{},28:{f:V8},29:{},34:{f:pr},35:{f:_k},38:{f:bn},39:{f:bn},40:{f:bn},41:{f:bn},42:{f:pr},43:{f:pr},47:{f:YI},49:{f:S8},51:{f:Sr},60:{},61:{f:A8},64:{f:pr},65:{f:b8},66:{f:Sr},77:{},80:{},81:{},82:{},85:{f:Sr},89:{},90:{},91:{},92:{f:p8},93:{f:X8},94:{},95:{f:pr},96:{},97:{},99:{f:pr},125:{f:zR},128:{f:N8},129:{f:g8},130:{f:Sr},131:{f:pr},132:{f:pr},133:{f:m8},134:{},140:{f:Z8},141:{f:Sr},144:{},146:{f:eI},151:{},152:{},153:{},154:{},155:{},156:{f:Sr},157:{},158:{},160:{f:iI},161:{f:rI},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:D8},190:{f:F8},193:{f:Zo},197:{},198:{},199:{},200:{},201:{},202:{f:pr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Sr},220:{},221:{f:pr},222:{},224:{f:L8},225:{f:d8},226:{f:Zo},227:{},229:{f:$8},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:x8},253:{f:T8},255:{f:v8},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:LR},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:pr},353:{f:Zo},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:I8},431:{f:pr},432:{},433:{},434:{},437:{},438:{f:W8},439:{f:pr},440:{f:K8},441:{},442:{f:Xg},443:{},444:{f:Sr},445:{},446:{},448:{f:Zo},449:{f:w8,r:2},450:{f:Zo},512:{f:mk},513:{f:aI},515:{f:P8},516:{f:k8},517:{f:xk},519:{f:sI},520:{f:_8},523:{},545:{f:wk},549:{f:gk},566:{},574:{f:E8},638:{f:O8},659:{},1048:{},1054:{f:C8},1084:{},1212:{f:z8},2048:{f:Q8},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:S1},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Zo},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:tI,r:12},2173:{f:D5,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:pr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:H8,r:12},2197:{},2198:{f:S5,r:12},2199:{},2200:{},2201:{},2202:{f:j8,r:12},2203:{f:Zo},2204:{},2205:{},2206:{},2207:{},2211:{f:y8},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Sr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:nI},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:J8},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:mk},1:{},2:{f:uI},3:{f:cI},4:{f:lI},5:{f:xk},7:{f:hI},8:{},9:{f:S1},11:{},22:{f:Sr},30:{f:R8},31:{},32:{},33:{f:wk},36:{},37:{f:gk},50:{f:fI},62:{},52:{},67:{},68:{f:Sr},69:{},86:{},126:{},127:{f:oI},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:dI},223:{},234:{},354:{},421:{},518:{f:Ny},521:{f:S1},536:{f:yk},547:{f:_k},561:{},579:{},1030:{f:Ny},1033:{f:S1},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function xi(n,t,e,r){var a=t;if(!isNaN(a)){var s=(e||[]).length||0,l=n.next(4);l.write_shift(2,a),l.write_shift(2,s),s>0&&wR(e)&&n.push(e)}}function Fk(n,t){var e=t,r=e.dense?[]:{};n=n.replace(/<!--.*?-->/g,"");var a=n.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=n.match(/<\/table/i),l=a.index,c=s&&s.index||n.length,h=PP(n.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,d=0,m=0,x=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(l=0;l<h.length;++l){var A=h[l].trim(),E=A.slice(0,3).toLowerCase();if(E=="<tr"){if(++f,e.sheetRows&&e.sheetRows<=f){--f;break}d=0;continue}if(!(E!="<td"&&E!="<th")){var b=A.split(/<\/t[dh]>/i);for(c=0;c<b.length;++c){var C=b[c].trim();if(C.match(/<t[dh]/i)){for(var S=C,O=0;S.charAt(0)=="<"&&(O=S.indexOf(">"))>-1;)S=S.slice(O+1);for(var L=0;L<y.length;++L){var I=y[L];I.s.c==d&&I.s.r<f&&f<=I.e.r&&(d=I.e.c+1,L=-1)}var F=qe(C.slice(0,C.indexOf(">")));x=F.colspan?+F.colspan:1,((m=+F.rowspan)>1||x>1)&&y.push({s:{r:f,c:d},e:{r:f+(m||1)-1,c:d+x-1}});var W=F.t||F["data-t"]||"";if(!S.length){d+=x;continue}if(S=lR(S),_.s.r>f&&(_.s.r=f),_.e.r<f&&(_.e.r=f),_.s.c>d&&(_.s.c=d),_.e.c<d&&(_.e.c=d),!S.length){d+=x;continue}var B={t:"s",v:S};e.raw||!S.trim().length||W=="s"||(S==="TRUE"?B={t:"b",v:!0}:S==="FALSE"?B={t:"b",v:!1}:isNaN(Ii(S))?isNaN(sd(S).getDate())||(B={t:"d",v:Kr(S)},e.cellDates||(B={t:"n",v:qn(B.v)}),B.z=e.dateNF||et[14]):B={t:"n",v:Ii(S)}),e.dense?(r[f]||(r[f]=[]),r[f][d]=B):r[Je({r:f,c:d})]=B,d+=x}}}}return r["!ref"]=yt(_),y.length&&(r["!merges"]=y),r}function f9(n,t,e,r){for(var a=n["!merges"]||[],s=[],l=t.s.c;l<=t.e.c;++l){for(var c=0,h=0,f=0;f<a.length;++f)if(!(a[f].s.r>e||a[f].s.c>l)&&!(a[f].e.r<e||a[f].e.c<l)){if(a[f].s.r<e||a[f].s.c<l){c=-1;break}c=a[f].e.r-a[f].s.r+1,h=a[f].e.c-a[f].s.c+1;break}if(!(c<0)){var d=Je({r:e,c:l}),m=r.dense?(n[e]||[])[l]:n[d],x=m&&m.v!=null&&(m.h||XA(m.w||(bo(m),m.w)||""))||"",_={};c>1&&(_.rowspan=c),h>1&&(_.colspan=h),r.editable?x='<span contenteditable="true">'+x+"</span>":m&&(_["data-t"]=m&&m.t||"z",m.v!=null&&(_["data-v"]=m.v),m.z!=null&&(_["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+m.l.Target+'">'+x+"</a>")),_.id=(r.id||"sjs")+"-"+d,s.push(ZP("td",x,_))}}var y="<tr>";return y+s.join("")+"</tr>"}var d9='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',p9="</body></html>";function g9(n,t){var e=n.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!e||e.length==0)throw new Error("Invalid HTML: could not find <table>");if(e.length==1)return Xl(Fk(e[0],t),t);var r=uE();return e.forEach(function(a,s){hE(r,Fk(a,t),"Sheet"+(s+1))}),r}function m9(n,t,e){var r=[];return r.join("")+"<table"+(e.id?' id="'+e.id+'"':"")+">"}function x9(n,t){var e=t||{},r=e.header!=null?e.header:d9,a=e.footer!=null?e.footer:p9,s=[r],l=hd(n["!ref"]);e.dense=Array.isArray(n),s.push(m9(n,l,e));for(var c=l.s.r;c<=l.e.r;++c)s.push(f9(n,l,c,e));return s.push("</table>"+a),s.join("")}function d4(n,t,e){var r=e||{},a=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?jn(r.origin):r.origin;a=l.r,s=l.c}var c=t.getElementsByTagName("tr"),h=Math.min(r.sheetRows||1e7,c.length),f={s:{r:0,c:0},e:{r:a,c:s}};if(n["!ref"]){var d=hd(n["!ref"]);f.s.r=Math.min(f.s.r,d.s.r),f.s.c=Math.min(f.s.c,d.s.c),f.e.r=Math.max(f.e.r,d.e.r),f.e.c=Math.max(f.e.c,d.e.c),a==-1&&(f.e.r=a=d.e.r+1)}var m=[],x=0,_=n["!rows"]||(n["!rows"]=[]),y=0,A=0,E=0,b=0,C=0,S=0;for(n["!cols"]||(n["!cols"]=[]);y<c.length&&A<h;++y){var O=c[y];if(Mk(O)){if(r.display)continue;_[A]={hidden:!0}}var L=O.children;for(E=b=0;E<L.length;++E){var I=L[E];if(!(r.display&&Mk(I))){var F=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):lR(I.innerHTML),W=I.getAttribute("data-z")||I.getAttribute("z");for(x=0;x<m.length;++x){var B=m[x];B.s.c==b+s&&B.s.r<A+a&&A+a<=B.e.r&&(b=B.e.c+1-s,x=-1)}S=+I.getAttribute("colspan")||1,((C=+I.getAttribute("rowspan")||1)>1||S>1)&&m.push({s:{r:A+a,c:b+s},e:{r:A+a+(C||1)-1,c:b+s+(S||1)-1}});var ee={t:"s",v:F},Z=I.getAttribute("data-t")||I.getAttribute("t")||"";F!=null&&(F.length==0?ee.t=Z||"z":r.raw||F.trim().length==0||Z=="s"||(F==="TRUE"?ee={t:"b",v:!0}:F==="FALSE"?ee={t:"b",v:!1}:isNaN(Ii(F))?isNaN(sd(F).getDate())||(ee={t:"d",v:Kr(F)},r.cellDates||(ee={t:"n",v:qn(ee.v)}),ee.z=r.dateNF||et[14]):ee={t:"n",v:Ii(F)})),ee.z===void 0&&W!=null&&(ee.z=W);var te="",ve=I.getElementsByTagName("A");if(ve&&ve.length)for(var Ce=0;Ce<ve.length&&!(ve[Ce].hasAttribute("href")&&(te=ve[Ce].getAttribute("href"),te.charAt(0)!="#"));++Ce);te&&te.charAt(0)!="#"&&(ee.l={Target:te}),r.dense?(n[A+a]||(n[A+a]=[]),n[A+a][b+s]=ee):n[Je({c:b+s,r:A+a})]=ee,f.e.c<b+s&&(f.e.c=b+s),b+=S}}++A}return m.length&&(n["!merges"]=(n["!merges"]||[]).concat(m)),f.e.r=Math.max(f.e.r,A-1+a),n["!ref"]=yt(f),A>=h&&(n["!fullref"]=yt((f.e.r=c.length-y+A-1+a,f))),n}function p4(n,t){var e=t||{},r=e.dense?[]:{};return d4(r,n,t)}function v9(n,t){return Xl(p4(n,t),t)}function Mk(n){var t="",e=_9(n);return e&&(t=e(n).getPropertyValue("display")),t||(t=n.style&&n.style.display),t==="none"}function _9(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function y9(n){var t=n.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),e=wt(t.replace(/<[^>]*>/g,""));return[e]}var Lk={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function g4(n,t){var e=t||{},r=qA(n),a=[],s,l,c={name:""},h="",f=0,d,m,x={},_=[],y=e.dense?[]:{},A,E,b={value:""},C="",S=0,O=[],L=-1,I=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},W=0,B={},ee=[],Z={},te=0,ve=0,Ce=[],Ee=1,J=1,oe=[],De={Names:[]},ae={},V=["",""],fe=[],U={},Q="",X=0,K=!1,se=!1,_e=0;for(sp.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");A=sp.exec(r);)switch(A[3]=A[3].replace(/_.*$/,"")){case"table":case"":A[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?y["!ref"]=yt(F):y["!ref"]="A1:A1",e.sheetRows>0&&e.sheetRows<=F.e.r&&(y["!fullref"]=y["!ref"],F.e.r=e.sheetRows-1,y["!ref"]=yt(F)),ee.length&&(y["!merges"]=ee),Ce.length&&(y["!rows"]=Ce),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),_.push(d.name),x[d.name]=y,se=!1):A[0].charAt(A[0].length-2)!=="/"&&(d=qe(A[0],!1),L=I=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,y=e.dense?[]:{},ee=[],Ce=[],se=!0);break;case"table-row-group":A[1]==="/"?--W:++W;break;case"table-row":case"":if(A[1]==="/"){L+=Ee,Ee=1;break}if(m=qe(A[0],!1),m.?L=m.-1:L==-1&&(L=0),Ee=+m["number-rows-repeated"]||1,Ee<10)for(_e=0;_e<Ee;++_e)W>0&&(Ce[L+_e]={level:W});I=-1;break;case"covered-table-cell":A[1]!=="/"&&++I,e.sheetStubs&&(e.dense?(y[L]||(y[L]=[]),y[L][I]={t:"z"}):y[Je({r:L,c:I})]={t:"z"}),C="",O=[];break;case"table-cell":case"":if(A[0].charAt(A[0].length-2)==="/")++I,b=qe(A[0],!1),J=parseInt(b["number-columns-repeated"]||"1",10),E={t:"z",v:null},b.formula&&e.cellFormula!=!1&&(E.f=Ck(wt(b.formula))),(b.||b["value-type"])=="string"&&(E.t="s",E.v=wt(b["string-value"]||""),e.dense?(y[L]||(y[L]=[]),y[L][I]=E):y[Je({r:L,c:I})]=E),I+=J-1;else if(A[1]!=="/"){++I,C="",S=0,O=[],J=1;var be=Ee?L+Ee-1:L;if(I>F.e.c&&(F.e.c=I),I<F.s.c&&(F.s.c=I),L<F.s.r&&(F.s.r=L),be>F.e.r&&(F.e.r=be),b=qe(A[0],!1),fe=[],U={},E={t:b.||b["value-type"],v:null},e.cellFormula)if(b.formula&&(b.formula=wt(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(te=parseInt(b["number-matrix-rows-spanned"],10)||0,ve=parseInt(b["number-matrix-columns-spanned"],10)||0,Z={s:{r:L,c:I},e:{r:L+te-1,c:I+ve-1}},E.F=yt(Z),oe.push([Z,E.F])),b.formula)E.f=Ck(b.formula);else for(_e=0;_e<oe.length;++_e)L>=oe[_e][0].s.r&&L<=oe[_e][0].e.r&&I>=oe[_e][0].s.c&&I<=oe[_e][0].e.c&&(E.F=oe[_e][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(te=parseInt(b["number-rows-spanned"],10)||0,ve=parseInt(b["number-columns-spanned"],10)||0,Z={s:{r:L,c:I},e:{r:L+te-1,c:I+ve-1}},ee.push(Z)),b["number-columns-repeated"]&&(J=parseInt(b["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=Zt(b["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(b.value);break;case"percentage":E.t="n",E.v=parseFloat(b.value);break;case"currency":E.t="n",E.v=parseFloat(b.value);break;case"date":E.t="d",E.v=Kr(b["date-value"]),e.cellDates||(E.t="n",E.v=qn(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=MP(b["time-value"])/86400,e.cellDates&&(E.t="d",E.v=tv(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(b.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",b["string-value"]!=null&&(C=wt(b["string-value"]),O=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(K=!1,E.t==="s"&&(E.v=C||"",O.length&&(E.R=O),K=S==0),ae.Target&&(E.l=ae),fe.length>0&&(E.c=fe,fe=[]),C&&e.cellText!==!1&&(E.w=C),K&&(E.t="z",delete E.v),(!K||e.sheetStubs)&&!(e.sheetRows&&e.sheetRows<=L))for(var Te=0;Te<Ee;++Te){if(J=parseInt(b["number-columns-repeated"]||"1",10),e.dense)for(y[L+Te]||(y[L+Te]=[]),y[L+Te][I]=Te==0?E:cn(E);--J>0;)y[L+Te][I+J]=cn(E);else for(y[Je({r:L+Te,c:I})]=E;--J>0;)y[Je({r:L+Te,c:I+J})]=cn(E);F.e.c<=I&&(F.e.c=I)}J=parseInt(b["number-columns-repeated"]||"1",10),I+=J-1,J=0,E={},C="",O=[]}ae={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(A[1]==="/"){if((s=a.pop())[0]!==A[3])throw"Bad state: "+s}else A[0].charAt(A[0].length-2)!=="/"&&a.push([A[3],!0]);break;case"annotation":if(A[1]==="/"){if((s=a.pop())[0]!==A[3])throw"Bad state: "+s;U.t=C,O.length&&(U.R=O),U.a=Q,fe.push(U)}else A[0].charAt(A[0].length-2)!=="/"&&a.push([A[3],!1]);Q="",X=0,C="",S=0,O=[];break;case"creator":A[1]==="/"?Q=r.slice(X,A.index):X=A.index+A[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(A[1]==="/"){if((s=a.pop())[0]!==A[3])throw"Bad state: "+s}else A[0].charAt(A[0].length-2)!=="/"&&a.push([A[3],!1]);C="",S=0,O=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(A[1]==="/"){if(B[c.name]=h,(s=a.pop())[0]!==A[3])throw"Bad state: "+s}else A[0].charAt(A[0].length-2)!=="/"&&(h="",c=qe(A[0],!1),a.push([A[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=qe(A[0],!1),h+=Lk[A[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=qe(A[0],!1),h+=Lk[A[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(A[0].slice(-2)==="/>")break;if(A[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":h+=r.slice(f,A.index);break}else f=A.index+A[0].length;break;case"named-range":l=qe(A[0],!1),V=Py(l["cell-range-address"]);var ye={Name:l.name,Ref:V[0]+"!"+V[1]};se&&(ye.Sheet=_.length),De.Names.push(ye);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(A[1]==="/"&&(!b||!b["string-value"])){var Ke=y9(r.slice(S,A.index));C=(C.length>0?C+`
`:"")+Ke[0]}else qe(A[0],!1),S=A.index+A[0].length;break;case"s":break;case"database-range":if(A[1]==="/")break;try{V=Py(qe(A[0])["target-range-address"]),x[V[0]]["!autofilter"]={ref:V[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(A[1]!=="/"){if(ae=qe(A[0],!1),!ae.href)break;ae.Target=wt(ae.href),delete ae.href,ae.Target.charAt(0)=="#"&&ae.Target.indexOf(".")>-1?(V=Py(ae.Target.slice(1)),ae.Target="#"+V[0]+"!"+V[1]):ae.Target.match(/^\.\.[\\\/]/)&&(ae.Target=ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(A[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(e.WTF)throw new Error(A)}}var Y={Sheets:x,SheetNames:_,Workbook:De};return e.bookSheets&&delete Y.Sheets,Y}function Nk(n,t){t=t||{},Qa(n,"META-INF/manifest.xml")&&P6(br(n,"META-INF/manifest.xml"),t);var e=Oa(n,"content.xml");if(!e)throw new Error("Missing content.xml in ODS / UOF file");var r=g4(Vt(e),t);return Qa(n,"meta.xml")&&(r.Props=CR(br(n,"meta.xml"))),r}function Pk(n,t){return g4(n,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function sE(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function cw(n){return typeof TextDecoder<"u"?new TextDecoder().decode(n):Vt(Vu(n))}function uw(n){var t=n.reduce(function(a,s){return a+s.length},0),e=new Uint8Array(t),r=0;return n.forEach(function(a){e.set(a,r),r+=a.length}),e}function Ik(n){return n-=n>>1&1431655765,n=(n&858993459)+(n>>2&858993459),(n+(n>>4)&252645135)*16843009>>>24}function w9(n,t){for(var e=(n[t+15]&127)<<7|n[t+14]>>1,r=n[t+14]&1,a=t+13;a>=t;--a)r=r*256+n[a];return(n[t+15]&128?-r:r)*Math.pow(10,e-6176)}function up(n,t){var e=t?t[0]:0,r=n[e]&127;e:if(n[e++]>=128&&(r|=(n[e]&127)<<7,n[e++]<128||(r|=(n[e]&127)<<14,n[e++]<128)||(r|=(n[e]&127)<<21,n[e++]<128)||(r+=(n[e]&127)*Math.pow(2,28),++e,n[e++]<128)||(r+=(n[e]&127)*Math.pow(2,35),++e,n[e++]<128)||(r+=(n[e]&127)*Math.pow(2,42),++e,n[e++]<128)))break e;return t&&(t[0]=e),r}function Br(n){var t=0,e=n[t]&127;e:if(n[t++]>=128){if(e|=(n[t]&127)<<7,n[t++]<128||(e|=(n[t]&127)<<14,n[t++]<128)||(e|=(n[t]&127)<<21,n[t++]<128))break e;e|=(n[t]&127)<<28}return e}function Tn(n){for(var t=[],e=[0];e[0]<n.length;){var r=e[0],a=up(n,e),s=a&7;a=Math.floor(a/8);var l=0,c;if(a==0)break;switch(s){case 0:{for(var h=e[0];n[e[0]++]>=128;);c=n.slice(h,e[0])}break;case 5:l=4,c=n.slice(e[0],e[0]+l),e[0]+=l;break;case 1:l=8,c=n.slice(e[0],e[0]+l),e[0]+=l;break;case 2:l=up(n,e),c=n.slice(e[0],e[0]+l),e[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(r))}var f={data:c,type:s};t[a]==null?t[a]=[f]:t[a].push(f)}return t}function oE(n,t){return(n==null?void 0:n.map(function(e){return t(e.data)}))||[]}function A9(n){for(var t,e=[],r=[0];r[0]<n.length;){var a=up(n,r),s=Tn(n.slice(r[0],r[0]+a));r[0]+=a;var l={id:Br(s[1][0].data),messages:[]};s[2].forEach(function(c){var h=Tn(c.data),f=Br(h[3][0].data);l.messages.push({meta:h,data:n.slice(r[0],r[0]+f)}),r[0]+=f}),(t=s[3])!=null&&t[0]&&(l.merge=Br(s[3][0].data)>>>0>0),e.push(l)}return e}function E9(n,t){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var e=[0],r=up(t,e),a=[];e[0]<t.length;){var s=t[e[0]]&3;if(s==0){var l=t[e[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[e[0]],c>1&&(l|=t[e[0]+1]<<8),c>2&&(l|=t[e[0]+2]<<16),c>3&&(l|=t[e[0]+3]<<24),l>>>=0,l++,e[0]+=c}a.push(t.slice(e[0],e[0]+l)),e[0]+=l;continue}else{var h=0,f=0;if(s==1?(f=(t[e[0]]>>2&7)+4,h=(t[e[0]++]&224)<<3,h|=t[e[0]++]):(f=(t[e[0]++]>>2)+1,s==2?(h=t[e[0]]|t[e[0]+1]<<8,e[0]+=2):(h=(t[e[0]]|t[e[0]+1]<<8|t[e[0]+2]<<16|t[e[0]+3]<<24)>>>0,e[0]+=4)),a=[uw(a)],h==0)throw new Error("Invalid offset 0");if(h>a[0].length)throw new Error("Invalid offset beyond length");if(f>=h)for(a.push(a[0].slice(-h)),f-=h;f>=a[a.length-1].length;)a.push(a[a.length-1]),f-=a[a.length-1].length;a.push(a[0].slice(-h,-h+f))}}var d=uw(a);if(d.length!=r)throw new Error("Unexpected length: ".concat(d.length," != ").concat(r));return d}function b9(n){for(var t=[],e=0;e<n.length;){var r=n[e++],a=n[e]|n[e+1]<<8|n[e+2]<<16;e+=3,t.push(E9(r,n.slice(e,e+a))),e+=a}if(e!==n.length)throw new Error("data is not a valid framed stream!");return uw(t)}function S9(n,t,e,r){var a=sE(n),s=a.getUint32(4,!0),l=(r>1?12:8)+Ik(s&(r>1?3470:398))*4,c=-1,h=-1,f=NaN,d=new Date(2001,0,1);s&512&&(c=a.getUint32(l,!0),l+=4),l+=Ik(s&(r>1?12288:4096))*4,s&16&&(h=a.getUint32(l,!0),l+=4),s&32&&(f=a.getFloat64(l,!0),l+=8),s&64&&(d.setTime(d.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var m;switch(n[2]){case 0:break;case 2:m={t:"n",v:f};break;case 3:m={t:"s",v:t[h]};break;case 5:m={t:"d",v:d};break;case 6:m={t:"b",v:f>0};break;case 7:m={t:"n",v:f/86400};break;case 8:m={t:"e",v:0};break;case 9:if(c>-1)m={t:"s",v:e[c]};else if(h>-1)m={t:"s",v:t[h]};else if(!isNaN(f))m={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(n.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(n.slice(0,4)))}return m}function T9(n,t,e){var r=sE(n),a=r.getUint32(8,!0),s=12,l=-1,c=-1,h=NaN,f=NaN,d=new Date(2001,0,1);a&1&&(h=w9(n,s),s+=16),a&2&&(f=r.getFloat64(s,!0),s+=8),a&4&&(d.setTime(d.getTime()+r.getFloat64(s,!0)*1e3),s+=8),a&8&&(c=r.getUint32(s,!0),s+=4),a&16&&(l=r.getUint32(s,!0),s+=4);var m;switch(n[1]){case 0:break;case 2:m={t:"n",v:h};break;case 3:m={t:"s",v:t[c]};break;case 5:m={t:"d",v:d};break;case 6:m={t:"b",v:f>0};break;case 7:m={t:"n",v:f/86400};break;case 8:m={t:"e",v:0};break;case 9:if(l>-1)m={t:"s",v:e[l]};else throw new Error("Unsupported cell type ".concat(n[1]," : ").concat(a&31," : ").concat(n.slice(0,4)));break;case 10:m={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(n[1]," : ").concat(a&31," : ").concat(n.slice(0,4)))}return m}function k9(n,t,e){switch(n[0]){case 0:case 1:case 2:case 3:return S9(n,t,e,n[0]);case 5:return T9(n,t,e);default:throw new Error("Unsupported payload version ".concat(n[0]))}}function Bl(n){var t=Tn(n);return up(t[1][0].data)}function Bk(n,t){var e=Tn(t.data),r=Br(e[1][0].data),a=e[3],s=[];return(a||[]).forEach(function(l){var c=Tn(l.data),h=Br(c[1][0].data)>>>0;switch(r){case 1:s[h]=cw(c[3][0].data);break;case 8:{var f=n[Bl(c[9][0].data)][0],d=Tn(f.data),m=n[Bl(d[1][0].data)][0],x=Br(m.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var _=Tn(m.data);s[h]=_[3].map(function(y){return cw(y.data)}).join("")}break}}),s}function C9(n,t){var e,r,a,s,l,c,h,f,d,m,x,_,y,A,E=Tn(n),b=Br(E[1][0].data)>>>0,C=Br(E[2][0].data)>>>0,S=((r=(e=E[8])==null?void 0:e[0])==null?void 0:r.data)&&Br(E[8][0].data)>0||!1,O,L;if((s=(a=E[7])==null?void 0:a[0])!=null&&s.data&&t!=0)O=(c=(l=E[7])==null?void 0:l[0])==null?void 0:c.data,L=(f=(h=E[6])==null?void 0:h[0])==null?void 0:f.data;else if((m=(d=E[4])==null?void 0:d[0])!=null&&m.data&&t!=1)O=(_=(x=E[4])==null?void 0:x[0])==null?void 0:_.data,L=(A=(y=E[3])==null?void 0:y[0])==null?void 0:A.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var I=S?4:1,F=sE(O),W=[],B=0;B<O.length/2;++B){var ee=F.getUint16(B*2,!0);ee<65535&&W.push([B,ee])}if(W.length!=C)throw"Expected ".concat(C," cells, found ").concat(W.length);var Z=[];for(B=0;B<W.length-1;++B)Z[W[B][0]]=L.subarray(W[B][1]*I,W[B+1][1]*I);return W.length>=1&&(Z[W[W.length-1][0]]=L.subarray(W[W.length-1][1]*I)),{R:b,cells:Z}}function R9(n,t){var e,r=Tn(t.data),a=(e=r==null?void 0:r[7])!=null&&e[0]?Br(r[7][0].data)>>>0>0?1:0:-1,s=oE(r[5],function(l){return C9(l,a)});return{nrows:Br(r[4][0].data)>>>0,data:s.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(h,f){if(l[c.R][f])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(f));l[c.R][f]=h}),l},[])}}function O9(n,t,e){var r,a=Tn(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Br(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Br(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));e["!ref"]=yt(s);var l=Tn(a[4][0].data),c=Bk(n,n[Bl(l[4][0].data)][0]),h=(r=l[17])!=null&&r[0]?Bk(n,n[Bl(l[17][0].data)][0]):[],f=Tn(l[3][0].data),d=0;f[1].forEach(function(m){var x=Tn(m.data),_=n[Bl(x[2][0].data)][0],y=Br(_.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var A=R9(n,_);A.data.forEach(function(E,b){E.forEach(function(C,S){var O=Je({r:d+b,c:S}),L=k9(C,c,h);L&&(e[O]=L)})}),d+=A.nrows})}function D9(n,t){var e=Tn(t.data),r={"!ref":"A1"},a=n[Bl(e[2][0].data)],s=Br(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return O9(n,a[0],r),r}function F9(n,t){var e,r=Tn(t.data),a={name:(e=r[1])!=null&&e[0]?cw(r[1][0].data):"",sheets:[]},s=oE(r[2],Bl);return s.forEach(function(l){n[l].forEach(function(c){var h=Br(c.meta[1][0].data);h==6e3&&a.sheets.push(D9(n,c))})}),a}function M9(n,t){var e=uE(),r=Tn(t.data),a=oE(r[1],Bl);if(a.forEach(function(s){n[s].forEach(function(l){var c=Br(l.meta[1][0].data);if(c==2){var h=F9(n,l);h.sheets.forEach(function(f,d){hE(e,f,d==0?h.name:h.name+"_"+d,!0)})}})}),e.SheetNames.length==0)throw new Error("Empty NUMBERS file");return e}function By(n){var t,e,r,a,s={},l=[];if(n.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),n.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var f;try{f=b9(h.content)}catch(m){return console.log("?? "+h.content.length+" "+(m.message||m))}var d;try{d=A9(f)}catch(m){return console.log("## "+(m.message||m))}d.forEach(function(m){s[m.id]=m.messages,l.push(m.id)})}}),!l.length)throw new Error("File has no messages");var c=((a=(r=(e=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:e.meta)==null?void 0:r[1])==null?void 0:a[0].data)&&Br(s[1][0].meta[1][0].data)==1&&s[1][0];if(c||l.forEach(function(h){s[h].forEach(function(f){var d=Br(f.meta[1][0].data)>>>0;if(d==1)if(!c)c=f;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return M9(s,c)}function L9(n){return function(e){for(var r=0;r!=n.length;++r){var a=n[r];e[a[0]]===void 0&&(e[a[0]]=a[1]),a[2]==="n"&&(e[a[0]]=Number(e[a[0]]))}}}function lE(n){L9([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(n)}function N9(n){return Gh.WS.indexOf(n)>-1?"sheet":n==Gh.CS?"chart":n==Gh.DS?"dialog":n==Gh.MS?"macro":n&&n.length?n:"sheet"}function P9(n,t){if(!n)return 0;try{n=t.map(function(r){return r.id||(r.id=r.strRelID),[r.name,n["!id"][r.id].Target,N9(n["!id"][r.id].Type)]})}catch{return null}return!n||n.length===0?null:n}function I9(n,t,e,r,a,s,l,c,h,f,d,m){try{s[r]=Y0(Oa(n,e,!0),t);var x=br(n,t),_;switch(c){case"sheet":_=G7(x,t,a,h,s[r],f,d,m);break;case"chart":if(_=V7(x,t,a,h,s[r],f,d,m),!_||!_["!drawel"])break;var y=S0(_["!drawel"].Target,t),A=aw(y),E=j5(Oa(n,y,!0),Y0(Oa(n,A,!0),y)),b=S0(E,y),C=aw(b);_=T7(Oa(n,b,!0),b,h,Y0(Oa(n,C,!0),b),f,_);break;case"macro":_=$7(x,t,a,h,s[r],f,d,m);break;case"dialog":_=X7(x,t,a,h,s[r],f,d,m);break;default:throw new Error("Unrecognized sheet type "+c)}l[r]=_;var S=[];s&&s[r]&&vs(s[r]).forEach(function(O){var L="";if(s[r][O].Type==Gh.CMNT){L=S0(s[r][O].Target,t);var I=K7(br(n,L,!0),L,h);if(!I||!I.length)return;Ek(_,I,!1)}s[r][O].Type==Gh.TCMNT&&(L=S0(s[r][O].Target,t),S=S.concat(V5(br(n,L,!0),h)))}),S&&S.length&&Ek(_,S,!0,h.people||[])}catch(O){if(h.WTF)throw O}}function Ya(n){return n.charAt(0)=="/"?n.slice(1):n}function B9(n,t){if(JC(),t=t||{},lE(t),Qa(n,"META-INF/manifest.xml")||Qa(n,"objectdata.xml"))return Nk(n,t);if(Qa(n,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof By<"u"){if(n.FileIndex)return By(n);var e=_t.utils.cfb_new();return KT(n).forEach(function(Ce){UP(e,Ce,BP(n,Ce))}),By(e)}throw new Error("Unsupported NUMBERS file")}if(!Qa(n,"[Content_Types].xml"))throw Qa(n,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Qa(n,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=KT(n),a=L6(Oa(n,"[Content_Types].xml")),s=!1,l,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",br(n,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!br(n,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var h={},f={};if(!t.bookSheets&&!t.bookProps){if(Q0=[],a.sst)try{Q0=W7(br(n,Ya(a.sst)),a.sst,t)}catch(Ce){if(t.WTF)throw Ce}t.cellStyles&&a.themes.length&&(h=Y7(Oa(n,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(f=q7(br(n,Ya(a.style)),a.style,h,t))}a.links.map(function(Ce){try{var Ee=Y0(Oa(n,aw(Ya(Ce))),Ce);return Z7(br(n,Ya(Ce)),Ee,Ce,t)}catch{}});var d=j7(br(n,Ya(a.workbooks[0])),a.workbooks[0],t),m={},x="";a.coreprops.length&&(x=br(n,Ya(a.coreprops[0]),!0),x&&(m=CR(x)),a.extprops.length!==0&&(x=br(n,Ya(a.extprops[0]),!0),x&&U6(x,m,t)));var _={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(x=Oa(n,Ya(a.custprops[0]),!0),x&&(_=z6(x,t)));var y={};if((t.bookSheets||t.bookProps)&&(d.Sheets?l=d.Sheets.map(function(Ee){return Ee.name}):m.Worksheets&&m.SheetNames.length>0&&(l=m.SheetNames),t.bookProps&&(y.Props=m,y.Custprops=_),t.bookSheets&&typeof l<"u"&&(y.SheetNames=l),t.bookSheets?y.SheetNames:t.bookProps))return y;l={};var A={};t.bookDeps&&a.calcchain&&(A=Q7(br(n,Ya(a.calcchain)),a.calcchain));var E=0,b={},C,S;{var O=d.Sheets;m.Worksheets=O.length,m.SheetNames=[];for(var L=0;L!=O.length;++L)m.SheetNames[L]=O[L].name}var I=s?"bin":"xml",F=a.workbooks[0].lastIndexOf("/"),W=(a.workbooks[0].slice(0,F+1)+"_rels/"+a.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");Qa(n,W)||(W="xl/_rels/workbook."+I+".rels");var B=Y0(Oa(n,W,!0),W.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=J7(br(n,Ya(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=$5(br(n,Ya(a.people[0])),t)),B&&(B=P9(B,d.Sheets));var ee=br(n,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=m.Worksheets;++E){var Z="sheet";if(B&&B[E]?(C="xl/"+B[E][1].replace(/[\/]?xl\//,""),Qa(n,C)||(C=B[E][1]),Qa(n,C)||(C=W.replace(/_rels\/.*$/,"")+B[E][1]),Z=B[E][2]):(C="xl/worksheets/sheet"+(E+1-ee)+"."+I,C=C.replace(/sheet0\./,"sheet.")),S=C.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(E!=t.sheets)continue e;break;case"string":if(m.SheetNames[E].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var te=!1,ve=0;ve!=t.sheets.length;++ve)typeof t.sheets[ve]=="number"&&t.sheets[ve]==E&&(te=1),typeof t.sheets[ve]=="string"&&t.sheets[ve].toLowerCase()==m.SheetNames[E].toLowerCase()&&(te=1);if(!te)continue e}}I9(n,C,S,m.SheetNames[E],E,b,l,Z,t,d,h,f)}return y={Directory:a,Workbook:d,Props:m,Custprops:_,Deps:A,Sheets:l,SheetNames:m.SheetNames,Strings:Q0,Styles:f,Themes:h,SSF:cn(et)},t&&t.bookFiles&&(n.files?(y.keys=r,y.files=n.files):(y.keys=[],y.files={},n.FullPaths.forEach(function(Ce,Ee){Ce=Ce.replace(/^Root Entry[\/]/,""),y.keys.push(Ce),y.files[Ce]=n.FileIndex[Ee]}))),t&&t.bookVBA&&(a.vba.length>0?y.vbaraw=br(n,Ya(a.vba[0]),!0):a.defaults&&a.defaults.bin===W5&&(y.vbaraw=br(n,"xl/vbaProject.bin",!0))),y}function U9(n,t){var e=t||{},r="Workbook",a=_t.find(n,r);try{if(r="/!DataSpaces/Version",a=_t.find(n,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(DI(a.content),r="/!DataSpaces/DataSpaceMap",a=_t.find(n,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=MI(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=_t.find(n,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var l=LI(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=_t.find(n,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);PI(a.content)}catch{}if(r="/EncryptionInfo",a=_t.find(n,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);var c=II(a.content);if(r="/EncryptedPackage",a=_t.find(n,r),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,e.password||"",e);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,e.password||"",e);throw new Error("File is password-protected")}function cE(n,t){var e="";switch((t||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":e=Ma(n.slice(0,12));break;case"binary":e=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function H9(n,t){return _t.find(n,"EncryptedPackage")?U9(n,t):f4(n,t)}function z9(n,t){var e,r=n,a=t||{};return a.type||(a.type=xt&&Buffer.isBuffer(n)?"buffer":"base64"),e=iR(r,a),B9(e,a)}function m4(n,t){var e=0;e:for(;e<n.length;)switch(n.charCodeAt(e)){case 10:case 13:case 32:++e;break;case 60:return ow(n.slice(e),t);default:break e}return op.to_workbook(n,t)}function j9(n,t){var e="",r=cE(n,t);switch(t.type){case"base64":e=Ma(n);break;case"binary":e=n;break;case"buffer":e=n.toString("binary");break;case"array":e=Lu(n);break;default:throw new Error("Unrecognized type "+t.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(e=Vt(e)),t.type="binary",m4(e,t)}function G9(n,t){var e=n;return t.type=="base64"&&(e=Ma(e)),e=tw.utils.decode(1200,e.slice(2),"str"),t.type="binary",m4(e,t)}function V9(n){return n.match(/[^\x00-\x7F]/)?T0(n):n}function Uy(n,t,e,r){return r?(e.type="string",op.to_workbook(n,e)):op.to_workbook(t,e)}function hw(n,t){zC();var e=t||{};if(typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer)return hw(new Uint8Array(n),(e=cn(e),e.type="array",e));typeof Uint8Array<"u"&&n instanceof Uint8Array&&!e.type&&(e.type=typeof Deno<"u"?"buffer":"array");var r=n,a=[0,0,0,0],s=!1;if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),Wh={},e.dateNF&&(Wh.dateNF=e.dateNF),e.type||(e.type=xt&&Buffer.isBuffer(n)?"buffer":"base64"),e.type=="file"&&(e.type=xt?"buffer":"binary",r=DP(n),typeof Uint8Array<"u"&&!xt&&(e.type="array")),e.type=="string"&&(s=!0,e.type="binary",e.codepage=65001,r=V9(n)),e.type=="array"&&typeof Uint8Array<"u"&&n instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return e=cn(e),e.type="array",hw(zA(r),e)}switch((a=cE(r,e))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return H9(_t.read(r,e),e);break;case 9:if(a[1]<=8)return f4(r,e);break;case 60:return ow(r,e);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return vI(r,e);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return mI.to_workbook(r,e);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?z9(r,e):Uy(n,r,e,s);case 239:return a[3]===60?ow(r,e):Uy(n,r,e,s);case 255:if(a[1]===254)return G9(r,e);if(a[1]===0&&a[2]===2&&a[3]===0)return K0.to_workbook(r,e);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return K0.to_workbook(r,e);break;case 3:case 131:case 139:case 140:return Ak.to_workbook(r,e);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return WI.to_workbook(r,e);break;case 10:case 13:case 32:return j9(r,e);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return pI.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Ak.to_workbook(r,e):Uy(n,r,e,s)}function $9(n,t,e,r,a,s,l,c){var h=un(e),f=c.defval,d=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),m=!0,x=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:e,enumerable:!1})}catch{x.__rowNum__=e}else x.__rowNum__=e;if(!l||n[e])for(var _=t.s.c;_<=t.e.c;++_){var y=l?n[e][_]:n[r[_]+h];if(y===void 0||y.t===void 0){if(f===void 0)continue;s[_]!=null&&(x[s[_]]=f);continue}var A=y.v;switch(y.t){case"z":if(A==null)break;continue;case"e":A=A==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(s[_]!=null){if(A==null)if(y.t=="e"&&A===null)x[s[_]]=null;else if(f!==void 0)x[s[_]]=f;else if(d&&A===null)x[s[_]]=null;else continue;else x[s[_]]=d&&(y.t!=="n"||y.t==="n"&&c.rawNumbers!==!1)?A:bo(y,A,c);A!=null&&(m=!1)}}return{row:x,isempty:m}}function fw(n,t){if(n==null||n["!ref"]==null)return[];var e={t:"n",v:0},r=0,a=1,s=[],l=0,c="",h={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},d=f.range!=null?f.range:n["!ref"];switch(f.header===1?r=1:f.header==="A"?r=2:Array.isArray(f.header)?r=3:f.header==null&&(r=0),typeof d){case"string":h=hr(d);break;case"number":h=hr(n["!ref"]),h.s.r=d;break;default:h=d}r>0&&(a=0);var m=un(h.s.r),x=[],_=[],y=0,A=0,E=Array.isArray(n),b=h.s.r,C=0,S={};E&&!n[b]&&(n[b]=[]);var O=f.skipHidden&&n["!cols"]||[],L=f.skipHidden&&n["!rows"]||[];for(C=h.s.c;C<=h.e.c;++C)if(!(O[C]||{}).hidden)switch(x[C]=Nr(C),e=E?n[b][C]:n[x[C]+m],r){case 1:s[C]=C-h.s.c;break;case 2:s[C]=x[C];break;case 3:s[C]=f.header[C-h.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),c=l=bo(e,null,f),A=S[l]||0,!A)S[l]=1;else{do c=l+"_"+A++;while(S[c]);S[l]=A,S[c]=1}s[C]=c}for(b=h.s.r+a;b<=h.e.r;++b)if(!(L[b]||{}).hidden){var I=$9(n,h,b,x,r,s,E,f);(I.isempty===!1||(r===1?f.blankrows!==!1:f.blankrows))&&(_[y++]=I.row)}return _.length=y,_}var Uk=/"/g;function X9(n,t,e,r,a,s,l,c){for(var h=!0,f=[],d="",m=un(e),x=t.s.c;x<=t.e.c;++x)if(r[x]){var _=c.dense?(n[e]||[])[x]:n[r[x]+m];if(_==null)d="";else if(_.v!=null){h=!1,d=""+(c.rawNumbers&&_.t=="n"?_.v:bo(_,null,c));for(var y=0,A=0;y!==d.length;++y)if((A=d.charCodeAt(y))===a||A===s||A===34||c.forceQuotes){d='"'+d.replace(Uk,'""')+'"';break}d=="ID"&&(d='"ID"')}else _.f!=null&&!_.F?(h=!1,d="="+_.f,d.indexOf(",")>=0&&(d='"'+d.replace(Uk,'""')+'"')):d="";f.push(d)}return c.blankrows===!1&&h?null:f.join(l)}function x4(n,t){var e=[],r=t??{};if(n==null||n["!ref"]==null)return"";var a=hr(n["!ref"]),s=r.FS!==void 0?r.FS:",",l=s.charCodeAt(0),c=r.RS!==void 0?r.RS:`
`,h=c.charCodeAt(0),f=new RegExp((s=="|"?"\\|":s)+"+$"),d="",m=[];r.dense=Array.isArray(n);for(var x=r.skipHidden&&n["!cols"]||[],_=r.skipHidden&&n["!rows"]||[],y=a.s.c;y<=a.e.c;++y)(x[y]||{}).hidden||(m[y]=Nr(y));for(var A=0,E=a.s.r;E<=a.e.r;++E)(_[E]||{}).hidden||(d=X9(n,a,E,m,l,h,s,r),d!=null&&(r.strip&&(d=d.replace(f,"")),(d||r.blankrows!==!1)&&e.push((A++?c:"")+d)));return delete r.dense,e.join("")}function q9(n,t){t||(t={}),t.FS="	",t.RS=`
`;var e=x4(n,t);return e}function Y9(n){var t="",e,r="";if(n==null||n["!ref"]==null)return[];var a=hr(n["!ref"]),s="",l=[],c,h=[],f=Array.isArray(n);for(c=a.s.c;c<=a.e.c;++c)l[c]=Nr(c);for(var d=a.s.r;d<=a.e.r;++d)for(s=un(d),c=a.s.c;c<=a.e.c;++c)if(t=l[c]+s,e=f?(n[d]||[])[c]:n[t],r="",e!==void 0){if(e.F!=null){if(t=e.F,!e.f)continue;r=e.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(e.f!=null)r=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)r=""+e.v;else if(e.t=="b")r=e.v?"TRUE":"FALSE";else if(e.w!==void 0)r="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?r="'"+e.v:r=""+e.v}}h[h.length]=t+"="+r}return h}function v4(n,t,e){var r=e||{},a=+!r.skipHeader,s=n||{},l=0,c=0;if(r.origin!=null)if(typeof r.origin=="number")l=r.origin;else{var h=typeof r.origin=="string"?jn(r.origin):r.origin;l=h.r,c=h.c}var f,d={s:{c:0,r:0},e:{c,r:l+t.length-1+a}};if(s["!ref"]){var m=hr(s["!ref"]);d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),l==-1&&(l=m.e.r+1,d.e.r=l+t.length-1+a)}else l==-1&&(l=0,d.e.r=t.length-1+a);var x=r.header||[],_=0;t.forEach(function(A,E){vs(A).forEach(function(b){(_=x.indexOf(b))==-1&&(x[_=x.length]=b);var C=A[b],S="z",O="",L=Je({c:c+_,r:l+E+a});f=hp(s,L),C&&typeof C=="object"&&!(C instanceof Date)?s[L]=C:(typeof C=="number"?S="n":typeof C=="boolean"?S="b":typeof C=="string"?S="s":C instanceof Date?(S="d",r.cellDates||(S="n",C=qn(C)),O=r.dateNF||et[14]):C===null&&r.nullError&&(S="e",C=0),f?(f.t=S,f.v=C,delete f.w,delete f.R,O&&(f.z=O)):s[L]=f={t:S,v:C},O&&(f.z=O))})}),d.e.c=Math.max(d.e.c,c+x.length-1);var y=un(l);if(a)for(_=0;_<x.length;++_)s[Nr(_+c)+y]={t:"s",v:x[_]};return s["!ref"]=yt(d),s}function W9(n,t){return v4(null,n,t)}function hp(n,t,e){if(typeof t=="string"){if(Array.isArray(n)){var r=jn(t);return n[r.r]||(n[r.r]=[]),n[r.r][r.c]||(n[r.r][r.c]={t:"z"})}return n[t]||(n[t]={t:"z"})}return typeof t!="number"?hp(n,Je(t)):hp(n,Je({r:t,c:e||0}))}function K9(n,t){if(typeof t=="number"){if(t>=0&&n.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var e=n.SheetNames.indexOf(t);if(e>-1)return e;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function uE(){return{SheetNames:[],Sheets:{}}}function hE(n,t,e,r){var a=1;if(!e)for(;a<=65535&&n.SheetNames.indexOf(e="Sheet"+a)!=-1;++a,e=void 0);if(!e||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&n.SheetNames.indexOf(e)>=0){var s=e.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var l=s&&s[1]||e;for(++a;a<=65535&&n.SheetNames.indexOf(e=l+a)!=-1;++a);}if(L7(e),n.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return n.SheetNames.push(e),n.Sheets[e]=t,e}function Q9(n,t,e){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var r=K9(n,t);switch(n.Workbook.Sheets[r]||(n.Workbook.Sheets[r]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}n.Workbook.Sheets[r].Hidden=e}function Z9(n,t){return n.z=t,n}function _4(n,t,e){return t?(n.l={Target:t},e&&(n.l.Tooltip=e)):delete n.l,n}function J9(n,t,e){return _4(n,"#"+t,e)}function eH(n,t,e){n.c||(n.c=[]),n.c.push({t,a:e||"SheetJS"})}function tH(n,t,e,r){for(var a=typeof t!="string"?t:hr(t),s=typeof t=="string"?t:yt(t),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var h=hp(n,l,c);h.t="n",h.F=s,delete h.v,l==a.s.r&&c==a.s.c&&(h.f=e,r&&(h.D=!0))}return n}var rH={encode_col:Nr,encode_row:un,encode_cell:Je,encode_range:yt,decode_col:KA,decode_row:WA,split_cell:d6,decode_cell:jn,decode_range:hd,format_cell:bo,sheet_add_aoa:ER,sheet_add_json:v4,sheet_add_dom:d4,aoa_to_sheet:fd,json_to_sheet:W9,table_to_sheet:p4,table_to_book:v9,sheet_to_csv:x4,sheet_to_txt:q9,sheet_to_json:fw,sheet_to_html:x9,sheet_to_formulae:Y9,sheet_to_row_object_array:fw,sheet_get_cell:hp,book_new:uE,book_append_sheet:hE,book_set_sheet_visibility:Q9,cell_set_number_format:Z9,cell_set_hyperlink:_4,cell_set_internal_link:J9,cell_add_comment:eH,sheet_set_array_formula:tH,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},ep={};ep.d=(n,t)=>{for(var e in t)ep.o(t,e)&&!ep.o(n,e)&&Object.defineProperty(n,e,{enumerable:!0,get:t[e]})};ep.o=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);var We=globalThis.pdfjsLib={};ep.d(We,{AbortException:()=>Gl,AnnotationEditorLayer:()=>wA,AnnotationEditorParamsType:()=>mt,AnnotationEditorType:()=>at,AnnotationEditorUIManager:()=>Iu,AnnotationLayer:()=>Qz,AnnotationMode:()=>il,ColorPicker:()=>Rx,DOMSVGFactory:()=>yE,DrawLayer:()=>bA,FeatureTest:()=>Vn,GlobalWorkerOptions:()=>xo,ImageKind:()=>N1,InvalidPDFException:()=>pw,MissingPDFException:()=>fp,OPS:()=>_i,OutputScale:()=>mw,PDFDataRangeTransport:()=>wO,PDFDateString:()=>mE,PDFWorker:()=>Qh,PasswordResponses:()=>sH,PermissionFlag:()=>iH,PixelsPerInch:()=>Vl,RenderingCancelledException:()=>pE,TextLayer:()=>dp,TouchManager:()=>kx,UnexpectedResponseException:()=>bx,Util:()=>je,VerbosityLevel:()=>iv,XfaLayer:()=>EO,build:()=>Dz,createValidAbsoluteUrl:()=>uH,fetchData:()=>cv,getDocument:()=>Az,getFilenameFromUrl:()=>_H,getPdfFilenameFromUrl:()=>yH,getXfaPageViewport:()=>wH,isDataScheme:()=>uv,isPdfFile:()=>gE,noContextMenu:()=>Bi,normalizeUnicode:()=>mH,setLayerDimensions:()=>Pu,shadow:()=>ht,stopEvent:()=>Da,version:()=>Oz});const Sn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),y4=[1,0,0,1,0,0],dw=[.001,0,0,.001,0,0],nH=1e7,Hy=1.35,ka={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},il={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},aH="pdfjs_internal_editor_",at={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},mt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},iH={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},gn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},N1={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Or={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},v0={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},iv={ERRORS:0,WARNINGS:1,INFOS:5},_i={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},sH={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let sv=iv.WARNINGS;function oH(n){Number.isInteger(n)&&(sv=n)}function lH(){return sv}function ov(n){sv>=iv.INFOS&&console.log(`Info: ${n}`)}function it(n){sv>=iv.WARNINGS&&console.log(`Warning: ${n}`)}function It(n){throw new Error(n)}function Tr(n,t){n||It(t)}function cH(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function uH(n,t=null,e=null){if(!n)return null;try{if(e&&typeof n=="string"){if(e.addDefaultProtocol&&n.startsWith("www.")){const a=n.match(/\./g);(a==null?void 0:a.length)>=2&&(n=`http://${n}`)}if(e.tryConvertEncoding)try{n=gH(n)}catch{}}const r=t?new URL(n,t):new URL(n);if(cH(r))return r}catch{}return null}function ht(n,t,e,r=!1){return Object.defineProperty(n,t,{value:e,enumerable:!r,configurable:!0,writable:!1}),e}const ql=function(){function t(e,r){this.message=e,this.name=r}return t.prototype=new Error,t.constructor=t,t}();class Hk extends ql{constructor(t,e){super(t,"PasswordException"),this.code=e}}class zy extends ql{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class pw extends ql{constructor(t){super(t,"InvalidPDFException")}}class fp extends ql{constructor(t){super(t,"MissingPDFException")}}class bx extends ql{constructor(t,e){super(t,"UnexpectedResponseException"),this.status=e}}class hH extends ql{constructor(t){super(t,"FormatError")}}class Gl extends ql{constructor(t){super(t,"AbortException")}}function w4(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&It("Invalid argument for bytesToString");const t=n.length,e=8192;if(t<e)return String.fromCharCode.apply(null,n);const r=[];for(let a=0;a<t;a+=e){const s=Math.min(a+e,t),l=n.subarray(a,s);r.push(String.fromCharCode.apply(null,l))}return r.join("")}function lv(n){typeof n!="string"&&It("Invalid argument for stringToBytes");const t=n.length,e=new Uint8Array(t);for(let r=0;r<t;++r)e[r]=n.charCodeAt(r)&255;return e}function fH(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function fE(n){const t=Object.create(null);for(const[e,r]of n)t[e]=r;return t}function dH(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function pH(){try{return new Function(""),!0}catch{return!1}}class Vn{static get isLittleEndian(){return ht(this,"isLittleEndian",dH())}static get isEvalSupported(){return ht(this,"isEvalSupported",pH())}static get isOffscreenCanvasSupported(){return ht(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ht(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?ht(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):ht(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var t,e;return ht(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}}const jy=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var Ao,P1,gw;class je{static makeHexColor(t,e,r){return`#${jy[t]}${jy[e]}${jy[r]}`}static scaleMinMax(t,e){let r;t[0]?(t[0]<0&&(r=e[0],e[0]=e[2],e[2]=r),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(r=e[1],e[1]=e[3],e[3]=r),e[1]*=t[3],e[3]*=t[3]):(r=e[0],e[0]=e[1],e[1]=r,r=e[2],e[2]=e[3],e[3]=r,t[1]<0&&(r=e[1],e[1]=e[3],e[3]=r),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(r=e[0],e[0]=e[2],e[2]=r),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static applyTransform(t,e){const r=t[0]*e[0]+t[1]*e[2]+e[4],a=t[0]*e[1]+t[1]*e[3]+e[5];return[r,a]}static applyInverseTransform(t,e){const r=e[0]*e[3]-e[1]*e[2],a=(t[0]*e[3]-t[1]*e[2]+e[2]*e[5]-e[4]*e[3])/r,s=(-t[0]*e[1]+t[1]*e[0]+e[4]*e[1]-e[5]*e[0])/r;return[a,s]}static getAxialAlignedBoundingBox(t,e){const r=this.applyTransform(t,e),a=this.applyTransform(t.slice(2,4),e),s=this.applyTransform([t[0],t[3]],e),l=this.applyTransform([t[2],t[1]],e);return[Math.min(r[0],a[0],s[0],l[0]),Math.min(r[1],a[1],s[1],l[1]),Math.max(r[0],a[0],s[0],l[0]),Math.max(r[1],a[1],s[1],l[1])]}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t){const e=[t[0],t[2],t[1],t[3]],r=t[0]*e[0]+t[1]*e[2],a=t[0]*e[1]+t[1]*e[3],s=t[2]*e[0]+t[3]*e[2],l=t[2]*e[1]+t[3]*e[3],c=(r+l)/2,h=Math.sqrt((r+l)**2-4*(r*l-s*a))/2,f=c+h||1,d=c-h||1;return[Math.sqrt(f),Math.sqrt(d)]}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const r=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),a=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(r>a)return null;const s=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),l=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return s>l?null:[r,s,a,l]}static bezierBoundingBox(t,e,r,a,s,l,c,h,f){return f?(f[0]=Math.min(f[0],t,c),f[1]=Math.min(f[1],e,h),f[2]=Math.max(f[2],t,c),f[3]=Math.max(f[3],e,h)):f=[Math.min(t,c),Math.min(e,h),Math.max(t,c),Math.max(e,h)],D(this,Ao,gw).call(this,t,r,s,c,e,a,l,h,3*(-t+3*(r-s)+c),6*(t-2*r+s),3*(r-t),f),D(this,Ao,gw).call(this,t,r,s,c,e,a,l,h,3*(-e+3*(a-l)+h),6*(e-2*a+l),3*(a-e),f),f}}Ao=new WeakSet,P1=function(t,e,r,a,s,l,c,h,f,d){if(f<=0||f>=1)return;const m=1-f,x=f*f,_=x*f,y=m*(m*(m*t+3*f*e)+3*x*r)+_*a,A=m*(m*(m*s+3*f*l)+3*x*c)+_*h;d[0]=Math.min(d[0],y),d[1]=Math.min(d[1],A),d[2]=Math.max(d[2],y),d[3]=Math.max(d[3],A)},gw=function(t,e,r,a,s,l,c,h,f,d,m,x){if(Math.abs(f)<1e-12){Math.abs(d)>=1e-12&&D(this,Ao,P1).call(this,t,e,r,a,s,l,c,h,-m/d,x);return}const _=d**2-4*m*f;if(_<0)return;const y=Math.sqrt(_),A=2*f;D(this,Ao,P1).call(this,t,e,r,a,s,l,c,h,(-d+y)/A,x),D(this,Ao,P1).call(this,t,e,r,a,s,l,c,h,(-d-y)/A,x)},R(je,Ao);function gH(n){return decodeURIComponent(escape(n))}let Gy=null,zk=null;function mH(n){return Gy||(Gy=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,zk=new Map([["","t"]])),n.replaceAll(Gy,(t,e,r)=>e?e.normalize("NFKC"):zk.get(r))}function xH(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),w4(n)}const dE="pdfjs_internal_id_";function vH(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(w4(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...t){return new Promise(e=>{e(n(...t))})});const Us="http://www.w3.org/2000/svg",bc=class bc{};Ve(bc,"CSS",96),Ve(bc,"PDF",72),Ve(bc,"PDF_TO_CSS_UNITS",bc.CSS/bc.PDF);let Vl=bc;async function cv(n,t="text"){if(k0(n,document.baseURI)){const e=await fetch(n);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,r)=>{const a=new XMLHttpRequest;a.open("GET",n,!0),a.responseType=t,a.onreadystatechange=()=>{if(a.readyState===XMLHttpRequest.DONE){if(a.status===200||a.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(a.response);return}e(a.responseText);return}r(new Error(a.statusText))}},a.send(null)})}class Kg{constructor({viewBox:t,userUnit:e,scale:r,rotation:a,offsetX:s=0,offsetY:l=0,dontFlip:c=!1}){this.viewBox=t,this.userUnit=e,this.scale=r,this.rotation=a,this.offsetX=s,this.offsetY=l,r*=e;const h=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let d,m,x,_;switch(a%=360,a<0&&(a+=360),a){case 180:d=-1,m=0,x=0,_=1;break;case 90:d=0,m=1,x=1,_=0;break;case 270:d=0,m=-1,x=-1,_=0;break;case 0:d=1,m=0,x=0,_=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(x=-x,_=-_);let y,A,E,b;d===0?(y=Math.abs(f-t[1])*r+s,A=Math.abs(h-t[0])*r+l,E=(t[3]-t[1])*r,b=(t[2]-t[0])*r):(y=Math.abs(h-t[0])*r+s,A=Math.abs(f-t[1])*r+l,E=(t[2]-t[0])*r,b=(t[3]-t[1])*r),this.transform=[d*r,m*r,x*r,_*r,y-d*r*h-x*r*f,A-m*r*h-_*r*f],this.width=E,this.height=b}get rawDims(){const{userUnit:t,viewBox:e}=this,r=e.map(a=>a*t);return ht(this,"rawDims",{pageWidth:r[2]-r[0],pageHeight:r[3]-r[1],pageX:r[0],pageY:r[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:r=this.offsetX,offsetY:a=this.offsetY,dontFlip:s=!1}={}){return new Kg({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:r,offsetY:a,dontFlip:s})}convertToViewportPoint(t,e){return je.applyTransform([t,e],this.transform)}convertToViewportRectangle(t){const e=je.applyTransform([t[0],t[1]],this.transform),r=je.applyTransform([t[2],t[3]],this.transform);return[e[0],e[1],r[0],r[1]]}convertToPdfPoint(t,e){return je.applyInverseTransform([t,e],this.transform)}}class pE extends ql{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function uv(n){const t=n.length;let e=0;for(;e<t&&n[e].trim()==="";)e++;return n.substring(e,e+5).toLowerCase()==="data:"}function gE(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function _H(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function yH(n,t="document.pdf"){if(typeof n!="string")return t;if(uv(n))return it('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const e=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,r=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,a=e.exec(n);let s=r.exec(a[1])||r.exec(a[2])||r.exec(a[3]);if(s&&(s=s[0],s.includes("%")))try{s=r.exec(decodeURIComponent(s))[0]}catch{}return s||t}class jk{constructor(){Ve(this,"started",Object.create(null));Ve(this,"times",[])}time(t){t in this.started&&it(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||it(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:r}of this.times)e=Math.max(r.length,e);for(const{name:r,start:a,end:s}of this.times)t.push(`${r.padEnd(e)} ${s-a}ms
`);return t.join("")}}function k0(n,t){try{const{protocol:e}=t?new URL(n,t):new URL(n);return e==="http:"||e==="https:"}catch{return!1}}function Bi(n){n.preventDefault()}function Da(n){n.preventDefault(),n.stopPropagation()}var gp;class mE{static toDateObject(t){if(!t||typeof t!="string")return null;g(this,gp)||T(this,gp,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=g(this,gp).exec(t);if(!e)return null;const r=parseInt(e[1],10);let a=parseInt(e[2],10);a=a>=1&&a<=12?a-1:0;let s=parseInt(e[3],10);s=s>=1&&s<=31?s:1;let l=parseInt(e[4],10);l=l>=0&&l<=23?l:0;let c=parseInt(e[5],10);c=c>=0&&c<=59?c:0;let h=parseInt(e[6],10);h=h>=0&&h<=59?h:0;const f=e[7]||"Z";let d=parseInt(e[8],10);d=d>=0&&d<=23?d:0;let m=parseInt(e[9],10)||0;return m=m>=0&&m<=59?m:0,f==="-"?(l+=d,c+=m):f==="+"&&(l-=d,c-=m),new Date(Date.UTC(r,a,s,l,c,h))}}gp=new WeakMap,R(mE,gp);function wH(n,{scale:t=1,rotation:e=0}){const{width:r,height:a}=n.attributes.style,s=[0,0,parseInt(r),parseInt(a)];return new Kg({viewBox:s,userUnit:1,scale:t,rotation:e})}function xE(n){if(n.startsWith("#")){const t=parseInt(n.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(t=>parseInt(t)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(it(`Not a valid color format: "${n}"`),[0,0,0])}function AH(n){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const e of n.keys()){t.style.color=e;const r=window.getComputedStyle(t).color;n.set(e,xE(r))}t.remove()}function Kt(n){const{a:t,b:e,c:r,d:a,e:s,f:l}=n.getTransform();return[t,e,r,a,s,l]}function Wi(n){const{a:t,b:e,c:r,d:a,e:s,f:l}=n.getTransform().invertSelf();return[t,e,r,a,s,l]}function Pu(n,t,e=!1,r=!0){if(t instanceof Kg){const{pageWidth:a,pageHeight:s}=t.rawDims,{style:l}=n,c=Vn.isCSSRoundSupported,h=`var(--scale-factor) * ${a}px`,f=`var(--scale-factor) * ${s}px`,d=c?`round(down, ${h}, var(--scale-round-x, 1px))`:`calc(${h})`,m=c?`round(down, ${f}, var(--scale-round-y, 1px))`:`calc(${f})`;!e||t.rotation%180===0?(l.width=d,l.height=m):(l.width=m,l.height=d)}r&&n.setAttribute("data-main-rotation",t.rotation)}class mw{constructor(){const t=window.devicePixelRatio||1;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var sl,kc,yi,Cc,mp,xp,Fx,A4,$n,E4,b4,I1,S4,vw;const Gs=class Gs{constructor(t){R(this,$n);R(this,sl,null);R(this,kc,null);R(this,yi);R(this,Cc,null);R(this,mp,null);T(this,yi,t),g(Gs,xp)||T(Gs,xp,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const t=T(this,sl,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=g(this,yi)._uiManager._signal;t.addEventListener("contextmenu",Bi,{signal:e}),t.addEventListener("pointerdown",D(Gs,Fx,A4),{signal:e});const r=T(this,Cc,document.createElement("div"));r.className="buttons",t.append(r);const a=g(this,yi).toolbarPosition;if(a){const{style:s}=t,l=g(this,yi)._uiManager.direction==="ltr"?1-a[0]:a[0];s.insetInlineEnd=`${100*l}%`,s.top=`calc(${100*a[1]}% + var(--editor-toolbar-vert-offset))`}return D(this,$n,S4).call(this),t}get div(){return g(this,sl)}hide(){var t;g(this,sl).classList.add("hidden"),(t=g(this,kc))==null||t.hideDropdown()}show(){var t;g(this,sl).classList.remove("hidden"),(t=g(this,mp))==null||t.shown()}async addAltText(t){const e=await t.render();D(this,$n,I1).call(this,e),g(this,Cc).prepend(e,g(this,$n,vw)),T(this,mp,t)}addColorPicker(t){T(this,kc,t);const e=t.renderButton();D(this,$n,I1).call(this,e),g(this,Cc).prepend(e,g(this,$n,vw))}remove(){var t;g(this,sl).remove(),(t=g(this,kc))==null||t.destroy(),T(this,kc,null)}};sl=new WeakMap,kc=new WeakMap,yi=new WeakMap,Cc=new WeakMap,mp=new WeakMap,xp=new WeakMap,Fx=new WeakSet,A4=function(t){t.stopPropagation()},$n=new WeakSet,E4=function(t){g(this,yi)._focusEventsAllowed=!1,Da(t)},b4=function(t){g(this,yi)._focusEventsAllowed=!0,Da(t)},I1=function(t){const e=g(this,yi)._uiManager._signal;t.addEventListener("focusin",D(this,$n,E4).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",D(this,$n,b4).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Bi,{signal:e})},S4=function(){const{editorType:t,_uiManager:e}=g(this,yi),r=document.createElement("button");r.className="delete",r.tabIndex=0,r.setAttribute("data-l10n-id",g(Gs,xp)[t]),D(this,$n,I1).call(this,r),r.addEventListener("click",a=>{e.delete()},{signal:e._signal}),g(this,Cc).append(r)},vw=function(){const t=document.createElement("div");return t.className="divider",t},R(Gs,Fx),R(Gs,xp,null);let xw=Gs;var vp,Rc,Oc,$l,T4,k4,C4;class EH{constructor(t){R(this,$l);R(this,vp,null);R(this,Rc,null);R(this,Oc);T(this,Oc,t)}show(t,e,r){const[a,s]=D(this,$l,k4).call(this,e,r),{style:l}=g(this,Rc)||T(this,Rc,D(this,$l,T4).call(this));t.append(g(this,Rc)),l.insetInlineEnd=`${100*a}%`,l.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){g(this,Rc).remove()}}vp=new WeakMap,Rc=new WeakMap,Oc=new WeakMap,$l=new WeakSet,T4=function(){const t=T(this,Rc,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar"),t.addEventListener("contextmenu",Bi,{signal:g(this,Oc)._signal});const e=T(this,vp,document.createElement("div"));return e.className="buttons",t.append(e),D(this,$l,C4).call(this),t},k4=function(t,e){let r=0,a=0;for(const s of t){const l=s.y+s.height;if(l<r)continue;const c=s.x+(e?s.width:0);if(l>r){a=c,r=l;continue}e?c>a&&(a=c):c<a&&(a=c)}return[e?1-a:a,r]},C4=function(){const t=document.createElement("button");t.className="highlightButton",t.tabIndex=0,t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const e=document.createElement("span");t.append(e),e.className="visuallyHidden",e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const r=g(this,Oc)._signal;t.addEventListener("contextmenu",Bi,{signal:r}),t.addEventListener("click",()=>{g(this,Oc).highlightSelection("floating_button")},{signal:r}),g(this,vp).append(t)};function Sx(n,t,e){for(const r of e)t.addEventListener(r,n[r].bind(n))}var Mx;class bH{constructor(){R(this,Mx,0)}get id(){return`${aH}${Ln(this,Mx)._++}`}}Mx=new WeakMap;var Zh,_p,vn,Jh,B1;const AE=class AE{constructor(){R(this,Jh);R(this,Zh,xH());R(this,_p,0);R(this,vn,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',r=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),a=new Image;a.src=t;const s=a.decode().then(()=>(r.drawImage(a,0,0,1,1,0,0,1,3),new Uint32Array(r.getImageData(0,0,1,1).data.buffer)[0]===0));return ht(this,"_isSVGFittingCanvas",s)}async getFromFile(t){const{lastModified:e,name:r,size:a,type:s}=t;return D(this,Jh,B1).call(this,`${e}_${r}_${a}_${s}`,t)}async getFromUrl(t){return D(this,Jh,B1).call(this,t,t)}async getFromBlob(t,e){const r=await e;return D(this,Jh,B1).call(this,t,r)}async getFromId(t){g(this,vn)||T(this,vn,new Map);const e=g(this,vn).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:r}=e;return delete e.blobPromise,this.getFromBlob(e.id,r)}return this.getFromUrl(e.url)}getFromCanvas(t,e){g(this,vn)||T(this,vn,new Map);let r=g(this,vn).get(t);if(r!=null&&r.bitmap)return r.refCounter+=1,r;const a=new OffscreenCanvas(e.width,e.height);return a.getContext("2d").drawImage(e,0,0),r={bitmap:a.transferToImageBitmap(),id:`image_${g(this,Zh)}_${Ln(this,_p)._++}`,refCounter:1,isSvg:!1},g(this,vn).set(t,r),g(this,vn).set(r.id,r),r}getSvgUrl(t){const e=g(this,vn).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){var a;g(this,vn)||T(this,vn,new Map);const e=g(this,vn).get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:r}=e;if(!e.url&&!e.file){const s=new OffscreenCanvas(r.width,r.height);s.getContext("bitmaprenderer").transferFromImageBitmap(r),e.blobPromise=s.convertToBlob()}(a=r.close)==null||a.call(r),e.bitmap=null}isValidId(t){return t.startsWith(`image_${g(this,Zh)}_`)}};Zh=new WeakMap,_p=new WeakMap,vn=new WeakMap,Jh=new WeakSet,B1=async function(t,e){g(this,vn)||T(this,vn,new Map);let r=g(this,vn).get(t);if(r===null)return null;if(r!=null&&r.bitmap)return r.refCounter+=1,r;try{r||(r={bitmap:null,id:`image_${g(this,Zh)}_${Ln(this,_p)._++}`,refCounter:0,isSvg:!1});let a;if(typeof e=="string"?(r.url=e,a=await cv(e,"blob")):e instanceof File?a=r.file=e:e instanceof Blob&&(a=e),a.type==="image/svg+xml"){const s=AE._isSVGFittingCanvas,l=new FileReader,c=new Image,h=new Promise((f,d)=>{c.onload=()=>{r.bitmap=c,r.isSvg=!0,f()},l.onload=async()=>{const m=r.svgUrl=l.result;c.src=await s?`${m}#svgView(preserveAspectRatio(none))`:m},c.onerror=l.onerror=d});l.readAsDataURL(a),await h}else r.bitmap=await createImageBitmap(a);r.refCounter=1}catch(a){it(a),r=null}return g(this,vn).set(t,r),r&&g(this,vn).set(r.id,r),r};let _w=AE;var gr,ol,yp,nr;class SH{constructor(t=128){R(this,gr,[]);R(this,ol,!1);R(this,yp);R(this,nr,-1);T(this,yp,t)}add({cmd:t,undo:e,post:r,mustExec:a,type:s=NaN,overwriteIfSameType:l=!1,keepUndo:c=!1}){if(a&&t(),g(this,ol))return;const h={cmd:t,undo:e,post:r,type:s};if(g(this,nr)===-1){g(this,gr).length>0&&(g(this,gr).length=0),T(this,nr,0),g(this,gr).push(h);return}if(l&&g(this,gr)[g(this,nr)].type===s){c&&(h.undo=g(this,gr)[g(this,nr)].undo),g(this,gr)[g(this,nr)]=h;return}const f=g(this,nr)+1;f===g(this,yp)?g(this,gr).splice(0,1):(T(this,nr,f),f<g(this,gr).length&&g(this,gr).splice(f)),g(this,gr).push(h)}undo(){if(g(this,nr)===-1)return;T(this,ol,!0);const{undo:t,post:e}=g(this,gr)[g(this,nr)];t(),e==null||e(),T(this,ol,!1),T(this,nr,g(this,nr)-1)}redo(){if(g(this,nr)<g(this,gr).length-1){T(this,nr,g(this,nr)+1),T(this,ol,!0);const{cmd:t,post:e}=g(this,gr)[g(this,nr)];t(),e==null||e(),T(this,ol,!1)}}hasSomethingToUndo(){return g(this,nr)!==-1}hasSomethingToRedo(){return g(this,nr)<g(this,gr).length-1}cleanType(t){if(g(this,nr)!==-1){for(let e=g(this,nr);e>=0;e--)if(g(this,gr)[e].type!==t){g(this,gr).splice(e+1,g(this,nr)-e),T(this,nr,e);return}g(this,gr).length=0,T(this,nr,-1)}}destroy(){T(this,gr,null)}}gr=new WeakMap,ol=new WeakMap,yp=new WeakMap,nr=new WeakMap;var Lx,R4;class Qg{constructor(t){R(this,Lx);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Vn.platform;for(const[r,a,s={}]of t)for(const l of r){const c=l.startsWith("mac+");e&&c?(this.callbacks.set(l.slice(4),{callback:a,options:s}),this.allKeys.add(l.split("+").at(-1))):!e&&!c&&(this.callbacks.set(l,{callback:a,options:s}),this.allKeys.add(l.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const r=this.callbacks.get(D(this,Lx,R4).call(this,e));if(!r)return;const{callback:a,options:{bubbles:s=!1,args:l=[],checker:c=null}}=r;c&&!c(t,e)||(a.bind(t,...l,e)(),s||Da(e))}}Lx=new WeakSet,R4=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const Nx=class Nx{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return AH(t),ht(this,"_colors",t)}convert(t){const e=xE(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[r,a]of this._colors)if(a.every((s,l)=>s===e[l]))return Nx._colorsMapping.get(r);return e}getHexCode(t){const e=this._colors.get(t);return e?je.makeHexColor(...e):t}};Ve(Nx,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let yw=Nx;var ef,ga,Fr,tn,tf,$s,rf,Za,ll,Dc,nf,Fc,es,wi,Mc,wp,Ap,af,Ep,ts,cl,sf,ul,rs,Px,hl,bp,fl,Lc,Sp,Tp,jr,Ot,Xs,Nc,kp,Cp,dl,ns,qs,Rp,Ja,Le,U1,ww,O4,D4,H1,F4,M4,L4,Aw,N4,Ew,bw,P4,Nn,Hs,I4,B4,Sw,U4,C0,Tw;const Vh=class Vh{constructor(t,e,r,a,s,l,c,h,f,d,m,x,_){R(this,Le);R(this,ef,new AbortController);R(this,ga,null);R(this,Fr,new Map);R(this,tn,new Map);R(this,tf,null);R(this,$s,null);R(this,rf,null);R(this,Za,new SH);R(this,ll,null);R(this,Dc,null);R(this,nf,0);R(this,Fc,new Set);R(this,es,null);R(this,wi,null);R(this,Mc,new Set);Ve(this,"_editorUndoBar",null);R(this,wp,!1);R(this,Ap,!1);R(this,af,!1);R(this,Ep,null);R(this,ts,null);R(this,cl,null);R(this,sf,null);R(this,ul,!1);R(this,rs,null);R(this,Px,new bH);R(this,hl,!1);R(this,bp,!1);R(this,fl,null);R(this,Lc,null);R(this,Sp,null);R(this,Tp,null);R(this,jr,at.NONE);R(this,Ot,new Set);R(this,Xs,null);R(this,Nc,null);R(this,kp,null);R(this,Cp,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});R(this,dl,[0,0]);R(this,ns,null);R(this,qs,null);R(this,Rp,null);R(this,Ja,null);const y=this._signal=g(this,ef).signal;T(this,qs,t),T(this,Rp,e),T(this,tf,r),this._eventBus=a,a._on("editingaction",this.onEditingAction.bind(this),{signal:y}),a._on("pagechanging",this.onPageChanging.bind(this),{signal:y}),a._on("scalechanging",this.onScaleChanging.bind(this),{signal:y}),a._on("rotationchanging",this.onRotationChanging.bind(this),{signal:y}),a._on("setpreference",this.onSetPreference.bind(this),{signal:y}),a._on("switchannotationeditorparams",A=>this.updateParams(A.type,A.value),{signal:y}),D(this,Le,F4).call(this),D(this,Le,P4).call(this),D(this,Le,Aw).call(this),T(this,$s,s.annotationStorage),T(this,Ep,s.filterFactory),T(this,Nc,l),T(this,sf,c||null),T(this,wp,h),T(this,Ap,f),T(this,af,d),T(this,Tp,m||null),this.viewParameters={realScale:Vl.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=x||null,this._supportsPinchToZoom=_!==!1}static get _keyboardManager(){const t=Vh.prototype,e=l=>g(l,qs).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),r=(l,{target:c})=>{if(c instanceof HTMLInputElement){const{type:h}=c;return h!=="text"&&h!=="number"}return!0},a=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return ht(this,"_keyboardManager",new Qg([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:r}],[["ctrl+z","mac+meta+z"],t.undo,{checker:r}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:r}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:r}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&g(l,qs).contains(c)&&!l.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&g(l,qs).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}]]))}destroy(){var t,e,r,a,s;(t=g(this,Ja))==null||t.resolve(),T(this,Ja,null),(e=g(this,ef))==null||e.abort(),T(this,ef,null),this._signal=null;for(const l of g(this,tn).values())l.destroy();g(this,tn).clear(),g(this,Fr).clear(),g(this,Mc).clear(),T(this,ga,null),g(this,Ot).clear(),g(this,Za).destroy(),(r=g(this,tf))==null||r.destroy(),(a=g(this,rs))==null||a.hide(),T(this,rs,null),g(this,ts)&&(clearTimeout(g(this,ts)),T(this,ts,null)),g(this,ns)&&(clearTimeout(g(this,ns)),T(this,ns,null)),(s=this._editorUndoBar)==null||s.destroy()}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return g(this,Tp)}get useNewAltTextFlow(){return g(this,Ap)}get useNewAltTextWhenAddingImage(){return g(this,af)}get hcmFilter(){return ht(this,"hcmFilter",g(this,Nc)?g(this,Ep).addHCMFilter(g(this,Nc).foreground,g(this,Nc).background):"none")}get direction(){return ht(this,"direction",getComputedStyle(g(this,qs)).direction)}get highlightColors(){return ht(this,"highlightColors",g(this,sf)?new Map(g(this,sf).split(",").map(t=>t.split("=").map(e=>e.trim()))):null)}get highlightColorNames(){return ht(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),T(this,Dc,t)}setMainHighlightColorPicker(t){T(this,Sp,t)}editAltText(t,e=!1){var r;(r=g(this,tf))==null||r.editAltText(this,t,e)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":T(this,af,e);break}}onPageChanging({pageNumber:t}){T(this,nf,t-1)}focusMainContainer(){g(this,qs).focus()}findParent(t,e){for(const r of g(this,tn).values()){const{x:a,y:s,width:l,height:c}=r.div.getBoundingClientRect();if(t>=a&&t<=a+l&&e>=s&&e<=s+c)return r}return null}disableUserSelect(t=!1){g(this,Rp).classList.toggle("noUserSelect",t)}addShouldRescale(t){g(this,Mc).add(t)}removeShouldRescale(t){g(this,Mc).delete(t)}onScaleChanging({scale:t}){var e;this.commitOrRemove(),this.viewParameters.realScale=t*Vl.PDF_TO_CSS_UNITS;for(const r of g(this,Mc))r.onScaleChanging();(e=g(this,Dc))==null||e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t=""){const e=document.getSelection();if(!e||e.isCollapsed)return;const{anchorNode:r,anchorOffset:a,focusNode:s,focusOffset:l}=e,c=e.toString(),f=D(this,Le,U1).call(this,e).closest(".textLayer"),d=this.getSelectionBoxes(f);if(!d)return;e.empty();const m=D(this,Le,ww).call(this,f),x=g(this,jr)===at.NONE,_=()=>{m==null||m.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:d,anchorNode:r,anchorOffset:a,focusNode:s,focusOffset:l,text:c}),x&&this.showAllEditors("highlight",!0,!0)};if(x){this.switchToMode(at.HIGHLIGHT,_);return}_()}addToAnnotationStorage(t){!t.isEmpty()&&g(this,$s)&&!g(this,$s).has(t.id)&&g(this,$s).setValue(t.id,t)}blur(){if(this.isShiftKeyDown=!1,g(this,ul)&&(T(this,ul,!1),D(this,Le,H1).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of g(this,Ot))if(e.div.contains(t)){T(this,Lc,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!g(this,Lc))return;const[t,e]=g(this,Lc);T(this,Lc,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){D(this,Le,Aw).call(this),D(this,Le,Ew).call(this)}removeEditListeners(){D(this,Le,N4).call(this),D(this,Le,bw).call(this)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const r of g(this,wi))if(r.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const r of g(this,wi))if(r.isHandlingMimeForPasting(e.type)){r.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){var r;if(t.preventDefault(),(r=g(this,ga))==null||r.commitOrRemove(),!this.hasSelection)return;const e=[];for(const a of g(this,Ot)){const s=a.serialize(!0);s&&e.push(s)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const s of e.items)for(const l of g(this,wi))if(l.isHandlingMimeForPasting(s.type)){l.paste(s,this.currentLayer);return}let r=e.getData("application/pdfjs");if(!r)return;try{r=JSON.parse(r)}catch(s){it(`paste: "${s.message}".`);return}if(!Array.isArray(r))return;this.unselectAll();const a=this.currentLayer;try{const s=[];for(const h of r){const f=await a.deserialize(h);if(!f)return;s.push(f)}const l=()=>{for(const h of s)D(this,Le,Sw).call(this,h);D(this,Le,Tw).call(this,s)},c=()=>{for(const h of s)h.remove()};this.addCommands({cmd:l,undo:c,mustExec:!0})}catch(s){it(`paste: "${s.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),g(this,jr)!==at.NONE&&!this.isEditorHandlingKeyboard&&Vh._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,g(this,ul)&&(T(this,ul,!1),D(this,Le,H1).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(t){t?(D(this,Le,M4).call(this),D(this,Le,Ew).call(this),D(this,Le,Nn).call(this,{isEditing:g(this,jr)!==at.NONE,isEmpty:D(this,Le,C0).call(this),hasSomethingToUndo:g(this,Za).hasSomethingToUndo(),hasSomethingToRedo:g(this,Za).hasSomethingToRedo(),hasSelectedEditor:!1})):(D(this,Le,L4).call(this),D(this,Le,bw).call(this),D(this,Le,Nn).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!g(this,wi)){T(this,wi,t);for(const e of g(this,wi))D(this,Le,Hs).call(this,e.defaultPropertiesToUpdate)}}getId(){return g(this,Px).id}get currentLayer(){return g(this,tn).get(g(this,nf))}getLayer(t){return g(this,tn).get(t)}get currentPageIndex(){return g(this,nf)}addLayer(t){g(this,tn).set(t.pageIndex,t),g(this,hl)?t.enable():t.disable()}removeLayer(t){g(this,tn).delete(t.pageIndex)}async updateMode(t,e=null,r=!1){var a;if(g(this,jr)!==t&&!(g(this,Ja)&&(await g(this,Ja).promise,!g(this,Ja)))){if(T(this,Ja,Promise.withResolvers()),T(this,jr,t),t===at.NONE){this.setEditingState(!1),D(this,Le,B4).call(this),(a=this._editorUndoBar)==null||a.hide(),g(this,Ja).resolve();return}this.setEditingState(!0),await D(this,Le,I4).call(this),this.unselectAll();for(const s of g(this,tn).values())s.updateMode(t);if(!e){r&&this.addNewEditorFromKeyboard(),g(this,Ja).resolve();return}for(const s of g(this,Fr).values())s.annotationElementId===e?(this.setSelected(s),s.enterInEditMode()):s.unselect();g(this,Ja).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t!==g(this,jr)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:t})}updateParams(t,e){var r;if(g(this,wi)){switch(t){case mt.CREATE:this.currentLayer.addNewEditor();return;case mt.HIGHLIGHT_DEFAULT_COLOR:(r=g(this,Sp))==null||r.updateColor(e);break;case mt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(g(this,kp)||T(this,kp,new Map)).set(t,e),this.showAllEditors("highlight",e);break}for(const a of g(this,Ot))a.updateParams(t,e);for(const a of g(this,wi))a.updateDefaultParams(t,e)}}showAllEditors(t,e,r=!1){var s;for(const l of g(this,Fr).values())l.editorType===t&&l.show(e);(((s=g(this,kp))==null?void 0:s.get(mt.HIGHLIGHT_SHOW_ALL))??!0)!==e&&D(this,Le,Hs).call(this,[[mt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(g(this,bp)!==t){T(this,bp,t);for(const e of g(this,tn).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}getEditors(t){const e=[];for(const r of g(this,Fr).values())r.pageIndex===t&&e.push(r);return e}getEditor(t){return g(this,Fr).get(t)}addEditor(t){g(this,Fr).set(t.id,t)}removeEditor(t){var e;t.div.contains(document.activeElement)&&(g(this,ts)&&clearTimeout(g(this,ts)),T(this,ts,setTimeout(()=>{this.focusMainContainer(),T(this,ts,null)},0))),g(this,Fr).delete(t.id),this.unselect(t),(!t.annotationElementId||!g(this,Fc).has(t.annotationElementId))&&((e=g(this,$s))==null||e.remove(t.id))}addDeletedAnnotationElement(t){g(this,Fc).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return g(this,Fc).has(t)}removeDeletedAnnotationElement(t){g(this,Fc).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){g(this,ga)!==t&&(T(this,ga,t),t&&D(this,Le,Hs).call(this,t.propertiesToUpdate))}updateUI(t){g(this,Le,U4)===t&&D(this,Le,Hs).call(this,t.propertiesToUpdate)}updateUIForDefaultProperties(t){D(this,Le,Hs).call(this,t.defaultPropertiesToUpdate)}toggleSelected(t){if(g(this,Ot).has(t)){g(this,Ot).delete(t),t.unselect(),D(this,Le,Nn).call(this,{hasSelectedEditor:this.hasSelection});return}g(this,Ot).add(t),t.select(),D(this,Le,Hs).call(this,t.propertiesToUpdate),D(this,Le,Nn).call(this,{hasSelectedEditor:!0})}setSelected(t){var e;(e=g(this,Dc))==null||e.commitOrRemove();for(const r of g(this,Ot))r!==t&&r.unselect();g(this,Ot).clear(),g(this,Ot).add(t),t.select(),D(this,Le,Hs).call(this,t.propertiesToUpdate),D(this,Le,Nn).call(this,{hasSelectedEditor:!0})}isSelected(t){return g(this,Ot).has(t)}get firstSelectedEditor(){return g(this,Ot).values().next().value}unselect(t){t.unselect(),g(this,Ot).delete(t),D(this,Le,Nn).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return g(this,Ot).size!==0}get isEnterHandled(){return g(this,Ot).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var t;g(this,Za).undo(),D(this,Le,Nn).call(this,{hasSomethingToUndo:g(this,Za).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:D(this,Le,C0).call(this)}),(t=this._editorUndoBar)==null||t.hide()}redo(){g(this,Za).redo(),D(this,Le,Nn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:g(this,Za).hasSomethingToRedo(),isEmpty:D(this,Le,C0).call(this)})}addCommands(t){g(this,Za).add(t),D(this,Le,Nn).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:D(this,Le,C0).call(this)})}cleanUndoStack(t){g(this,Za).cleanType(t)}delete(){var s;this.commitOrRemove();const t=(s=this.currentLayer)==null?void 0:s.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...g(this,Ot)],r=()=>{var l;(l=this._editorUndoBar)==null||l.show(a,e.length===1?e[0].editorType:e.length);for(const c of e)c.remove()},a=()=>{for(const l of e)D(this,Le,Sw).call(this,l)};this.addCommands({cmd:r,undo:a,mustExec:!0})}commitOrRemove(){var t;(t=g(this,ga))==null||t.commitOrRemove()}hasSomethingToControl(){return g(this,ga)||this.hasSelection}selectAll(){for(const t of g(this,Ot))t.commit();D(this,Le,Tw).call(this,g(this,Fr).values())}unselectAll(){var t;if(!(g(this,ga)&&(g(this,ga).commitOrRemove(),g(this,jr)!==at.NONE))&&!((t=g(this,Dc))!=null&&t.commitOrRemove())&&this.hasSelection){for(const e of g(this,Ot))e.unselect();g(this,Ot).clear(),D(this,Le,Nn).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,r=!1){if(r||this.commitOrRemove(),!this.hasSelection)return;g(this,dl)[0]+=t,g(this,dl)[1]+=e;const[a,s]=g(this,dl),l=[...g(this,Ot)],c=1e3;g(this,ns)&&clearTimeout(g(this,ns)),T(this,ns,setTimeout(()=>{T(this,ns,null),g(this,dl)[0]=g(this,dl)[1]=0,this.addCommands({cmd:()=>{for(const h of l)g(this,Fr).has(h.id)&&h.translateInPage(a,s)},undo:()=>{for(const h of l)g(this,Fr).has(h.id)&&h.translateInPage(-a,-s)},mustExec:!1})},c));for(const h of l)h.translateInPage(t,e)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),T(this,es,new Map);for(const t of g(this,Ot))g(this,es).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!g(this,es))return!1;this.disableUserSelect(!1);const t=g(this,es);T(this,es,null);let e=!1;for(const[{x:a,y:s,pageIndex:l},c]of t)c.newX=a,c.newY=s,c.newPageIndex=l,e||(e=a!==c.savedX||s!==c.savedY||l!==c.savedPageIndex);if(!e)return!1;const r=(a,s,l,c)=>{if(g(this,Fr).has(a.id)){const h=g(this,tn).get(c);h?a._setParentAndPosition(h,s,l):(a.pageIndex=c,a.x=s,a.y=l)}};return this.addCommands({cmd:()=>{for(const[a,{newX:s,newY:l,newPageIndex:c}]of t)r(a,s,l,c)},undo:()=>{for(const[a,{savedX:s,savedY:l,savedPageIndex:c}]of t)r(a,s,l,c)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(g(this,es))for(const r of g(this,es).keys())r.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||g(this,Ot).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return g(this,ga)===t}getActive(){return g(this,ga)}getMode(){return g(this,jr)}get imageManager(){return ht(this,"imageManager",new _w)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,d=e.rangeCount;f<d;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:r,y:a,width:s,height:l}=t.getBoundingClientRect();let c;switch(t.getAttribute("data-main-rotation")){case"90":c=(f,d,m,x)=>({x:(d-a)/l,y:1-(f+m-r)/s,width:x/l,height:m/s});break;case"180":c=(f,d,m,x)=>({x:1-(f+m-r)/s,y:1-(d+x-a)/l,width:m/s,height:x/l});break;case"270":c=(f,d,m,x)=>({x:1-(d+x-a)/l,y:(f-r)/s,width:x/l,height:m/s});break;default:c=(f,d,m,x)=>({x:(f-r)/s,y:(d-a)/l,width:m/s,height:x/l});break}const h=[];for(let f=0,d=e.rangeCount;f<d;f++){const m=e.getRangeAt(f);if(!m.collapsed)for(const{x,y:_,width:y,height:A}of m.getClientRects())y===0||A===0||h.push(c(x,_,y,A))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:e}){(g(this,rf)||T(this,rf,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=g(this,rf))==null||e.delete(t)}renderAnnotationElement(t){var a;const e=(a=g(this,rf))==null?void 0:a.get(t.data.id);if(!e)return;const r=g(this,$s).getRawValue(e);r&&(g(this,jr)===at.NONE&&!r.hasBeenModified||r.renderAnnotationElement(t))}};ef=new WeakMap,ga=new WeakMap,Fr=new WeakMap,tn=new WeakMap,tf=new WeakMap,$s=new WeakMap,rf=new WeakMap,Za=new WeakMap,ll=new WeakMap,Dc=new WeakMap,nf=new WeakMap,Fc=new WeakMap,es=new WeakMap,wi=new WeakMap,Mc=new WeakMap,wp=new WeakMap,Ap=new WeakMap,af=new WeakMap,Ep=new WeakMap,ts=new WeakMap,cl=new WeakMap,sf=new WeakMap,ul=new WeakMap,rs=new WeakMap,Px=new WeakMap,hl=new WeakMap,bp=new WeakMap,fl=new WeakMap,Lc=new WeakMap,Sp=new WeakMap,Tp=new WeakMap,jr=new WeakMap,Ot=new WeakMap,Xs=new WeakMap,Nc=new WeakMap,kp=new WeakMap,Cp=new WeakMap,dl=new WeakMap,ns=new WeakMap,qs=new WeakMap,Rp=new WeakMap,Ja=new WeakMap,Le=new WeakSet,U1=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},ww=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const r of g(this,tn).values())if(r.hasTextLayer(t))return r;return null},O4=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const r=D(this,Le,U1).call(this,t).closest(".textLayer"),a=this.getSelectionBoxes(r);a&&(g(this,rs)||T(this,rs,new EH(this)),g(this,rs).show(r,a,this.direction==="ltr"))},D4=function(){var s,l,c;const t=document.getSelection();if(!t||t.isCollapsed){g(this,Xs)&&((s=g(this,rs))==null||s.hide(),T(this,Xs,null),D(this,Le,Nn).call(this,{hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===g(this,Xs))return;const a=D(this,Le,U1).call(this,t).closest(".textLayer");if(!a){g(this,Xs)&&((l=g(this,rs))==null||l.hide(),T(this,Xs,null),D(this,Le,Nn).call(this,{hasSelectedText:!1}));return}if((c=g(this,rs))==null||c.hide(),T(this,Xs,e),D(this,Le,Nn).call(this,{hasSelectedText:!0}),!(g(this,jr)!==at.HIGHLIGHT&&g(this,jr)!==at.NONE)&&(g(this,jr)===at.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),T(this,ul,this.isShiftKeyDown),!this.isShiftKeyDown)){const h=g(this,jr)===at.HIGHLIGHT?D(this,Le,ww).call(this,a):null;h==null||h.toggleDrawing();const f=new AbortController,d=this.combinedSignal(f),m=x=>{x.type==="pointerup"&&x.button!==0||(f.abort(),h==null||h.toggleDrawing(!0),x.type==="pointerup"&&D(this,Le,H1).call(this,"main_toolbar"))};window.addEventListener("pointerup",m,{signal:d}),window.addEventListener("blur",m,{signal:d})}},H1=function(t=""){g(this,jr)===at.HIGHLIGHT?this.highlightSelection(t):g(this,wp)&&D(this,Le,O4).call(this)},F4=function(){document.addEventListener("selectionchange",D(this,Le,D4).bind(this),{signal:this._signal})},M4=function(){if(g(this,cl))return;T(this,cl,new AbortController);const t=this.combinedSignal(g(this,cl));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},L4=function(){var t;(t=g(this,cl))==null||t.abort(),T(this,cl,null)},Aw=function(){if(g(this,fl))return;T(this,fl,new AbortController);const t=this.combinedSignal(g(this,fl));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},N4=function(){var t;(t=g(this,fl))==null||t.abort(),T(this,fl,null)},Ew=function(){if(g(this,ll))return;T(this,ll,new AbortController);const t=this.combinedSignal(g(this,ll));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},bw=function(){var t;(t=g(this,ll))==null||t.abort(),T(this,ll,null)},P4=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},Nn=function(t){Object.entries(t).some(([r,a])=>g(this,Cp)[r]!==a)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(g(this,Cp),t)}),g(this,jr)===at.HIGHLIGHT&&t.hasSelectedEditor===!1&&D(this,Le,Hs).call(this,[[mt.HIGHLIGHT_FREE,!0]]))},Hs=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},I4=async function(){if(!g(this,hl)){T(this,hl,!0);const t=[];for(const e of g(this,tn).values())t.push(e.enable());await Promise.all(t);for(const e of g(this,Fr).values())e.enable()}},B4=function(){if(this.unselectAll(),g(this,hl)){T(this,hl,!1);for(const t of g(this,tn).values())t.disable();for(const t of g(this,Fr).values())t.disable()}},Sw=function(t){const e=g(this,tn).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},U4=function(){let t=null;for(t of g(this,Ot));return t},C0=function(){if(g(this,Fr).size===0)return!0;if(g(this,Fr).size===1)for(const t of g(this,Fr).values())return t.isEmpty();return!1},Tw=function(t){for(const e of g(this,Ot))e.unselect();g(this,Ot).clear();for(const e of t)e.isEmpty()||(g(this,Ot).add(e),e.select());D(this,Le,Nn).call(this,{hasSelectedEditor:this.hasSelection})},Ve(Vh,"TRANSLATE_SMALL",1),Ve(Vh,"TRANSLATE_BIG",10);let Iu=Vh;var Gr,as,Ai,of,is,ma,lf,ss,na,Ys,Pc,os,pl,Pi,R0,z1;const Pn=class Pn{constructor(t){R(this,Pi);R(this,Gr,null);R(this,as,!1);R(this,Ai,null);R(this,of,null);R(this,is,null);R(this,ma,null);R(this,lf,!1);R(this,ss,null);R(this,na,null);R(this,Ys,null);R(this,Pc,null);R(this,os,!1);T(this,na,t),T(this,os,t._uiManager.useNewAltTextFlow),g(Pn,pl)||T(Pn,pl,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){Pn._l10n??(Pn._l10n=t)}async render(){const t=T(this,Ai,document.createElement("button"));t.className="altText",t.tabIndex="0";const e=T(this,of,document.createElement("span"));t.append(e),g(this,os)?(t.classList.add("new"),t.setAttribute("data-l10n-id",g(Pn,pl).missing),e.setAttribute("data-l10n-id",g(Pn,pl)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const r=g(this,na)._uiManager._signal;t.addEventListener("contextmenu",Bi,{signal:r}),t.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:r});const a=s=>{s.preventDefault(),g(this,na)._uiManager.editAltText(g(this,na)),g(this,os)&&g(this,na)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:g(this,Pi,R0)}})};return t.addEventListener("click",a,{capture:!0,signal:r}),t.addEventListener("keydown",s=>{s.target===t&&s.key==="Enter"&&(T(this,lf,!0),a(s))},{signal:r}),await D(this,Pi,z1).call(this),t}finish(){g(this,Ai)&&(g(this,Ai).focus({focusVisible:g(this,lf)}),T(this,lf,!1))}isEmpty(){return g(this,os)?g(this,Gr)===null:!g(this,Gr)&&!g(this,as)}hasData(){return g(this,os)?g(this,Gr)!==null||!!g(this,Ys):this.isEmpty()}get guessedText(){return g(this,Ys)}async setGuessedText(t){g(this,Gr)===null&&(T(this,Ys,t),T(this,Pc,await Pn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),D(this,Pi,z1).call(this))}toggleAltTextBadge(t=!1){var e;if(!g(this,os)||g(this,Gr)){(e=g(this,ss))==null||e.remove(),T(this,ss,null);return}if(!g(this,ss)){const r=T(this,ss,document.createElement("div"));r.className="noAltTextBadge",g(this,na).div.append(r)}g(this,ss).classList.toggle("hidden",!t)}serialize(t){let e=g(this,Gr);return!t&&g(this,Ys)===e&&(e=g(this,Pc)),{altText:e,decorative:g(this,as),guessedText:g(this,Ys),textWithDisclaimer:g(this,Pc)}}get data(){return{altText:g(this,Gr),decorative:g(this,as)}}set data({altText:t,decorative:e,guessedText:r,textWithDisclaimer:a,cancel:s=!1}){r&&(T(this,Ys,r),T(this,Pc,a)),!(g(this,Gr)===t&&g(this,as)===e)&&(s||(T(this,Gr,t),T(this,as,e)),D(this,Pi,z1).call(this))}toggle(t=!1){g(this,Ai)&&(!t&&g(this,ma)&&(clearTimeout(g(this,ma)),T(this,ma,null)),g(this,Ai).disabled=!t)}shown(){g(this,na)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:g(this,Pi,R0)}})}destroy(){var t,e;(t=g(this,Ai))==null||t.remove(),T(this,Ai,null),T(this,of,null),T(this,is,null),(e=g(this,ss))==null||e.remove(),T(this,ss,null)}};Gr=new WeakMap,as=new WeakMap,Ai=new WeakMap,of=new WeakMap,is=new WeakMap,ma=new WeakMap,lf=new WeakMap,ss=new WeakMap,na=new WeakMap,Ys=new WeakMap,Pc=new WeakMap,os=new WeakMap,pl=new WeakMap,Pi=new WeakSet,R0=function(){return g(this,Gr)&&"added"||g(this,Gr)===null&&this.guessedText&&"review"||"missing"},z1=async function(){var a,s,l;const t=g(this,Ai);if(!t)return;if(g(this,os)){if(t.classList.toggle("done",!!g(this,Gr)),t.setAttribute("data-l10n-id",g(Pn,pl)[g(this,Pi,R0)]),(a=g(this,of))==null||a.setAttribute("data-l10n-id",g(Pn,pl)[`${g(this,Pi,R0)}-label`]),!g(this,Gr)){(s=g(this,is))==null||s.remove();return}}else{if(!g(this,Gr)&&!g(this,as)){t.classList.remove("done"),(l=g(this,is))==null||l.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=g(this,is);if(!e){T(this,is,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${g(this,na).id}`;const c=100,h=g(this,na)._uiManager._signal;h.addEventListener("abort",()=>{clearTimeout(g(this,ma)),T(this,ma,null)},{once:!0}),t.addEventListener("mouseenter",()=>{T(this,ma,setTimeout(()=>{T(this,ma,null),g(this,is).classList.add("show"),g(this,na)._reportTelemetry({action:"alt_text_tooltip"})},c))},{signal:h}),t.addEventListener("mouseleave",()=>{var f;g(this,ma)&&(clearTimeout(g(this,ma)),T(this,ma,null)),(f=g(this,is))==null||f.classList.remove("show")},{signal:h})}g(this,as)?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=g(this,Gr)),e.parentNode||t.append(e);const r=g(this,na).getImageForAltText();r==null||r.setAttribute("aria-describedby",e.id)},R(Pn,pl,null),Ve(Pn,"_l10n",null);let Tx=Pn;var Op,Ic,Dp,Fp,Mp,Lp,Np,cf,Ws,Bc,gl,So,H4,z4,kw;const EE=class EE{constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:r=null,onPinchStart:a=null,onPinching:s=null,onPinchEnd:l=null,signal:c}){R(this,So);R(this,Op);R(this,Ic,!1);R(this,Dp,null);R(this,Fp);R(this,Mp);R(this,Lp);R(this,Np);R(this,cf);R(this,Ws,null);R(this,Bc);R(this,gl,null);T(this,Op,t),T(this,Dp,r),T(this,Fp,e),T(this,Mp,a),T(this,Lp,s),T(this,Np,l),T(this,Bc,new AbortController),T(this,cf,AbortSignal.any([c,g(this,Bc).signal])),t.addEventListener("touchstart",D(this,So,H4).bind(this),{passive:!1,signal:g(this,cf)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return ht(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var t;(t=g(this,Bc))==null||t.abort(),T(this,Bc,null)}};Op=new WeakMap,Ic=new WeakMap,Dp=new WeakMap,Fp=new WeakMap,Mp=new WeakMap,Lp=new WeakMap,Np=new WeakMap,cf=new WeakMap,Ws=new WeakMap,Bc=new WeakMap,gl=new WeakMap,So=new WeakSet,H4=function(t){var a,s,l;if((a=g(this,Fp))!=null&&a.call(this)||t.touches.length<2)return;if(!g(this,gl)){T(this,gl,new AbortController);const c=AbortSignal.any([g(this,cf),g(this,gl).signal]),h=g(this,Op),f={signal:c,passive:!1};h.addEventListener("touchmove",D(this,So,z4).bind(this),f),h.addEventListener("touchend",D(this,So,kw).bind(this),f),h.addEventListener("touchcancel",D(this,So,kw).bind(this),f),(s=g(this,Mp))==null||s.call(this)}if(Da(t),t.touches.length!==2||(l=g(this,Dp))!=null&&l.call(this)){T(this,Ws,null);return}let[e,r]=t.touches;e.identifier>r.identifier&&([e,r]=[r,e]),T(this,Ws,{touch0X:e.screenX,touch0Y:e.screenY,touch1X:r.screenX,touch1Y:r.screenY})},z4=function(t){var O;if(!g(this,Ws)||t.touches.length!==2)return;let[e,r]=t.touches;e.identifier>r.identifier&&([e,r]=[r,e]);const{screenX:a,screenY:s}=e,{screenX:l,screenY:c}=r,h=g(this,Ws),{touch0X:f,touch0Y:d,touch1X:m,touch1Y:x}=h,_=m-f,y=x-d,A=l-a,E=c-s,b=Math.hypot(A,E)||1,C=Math.hypot(_,y)||1;if(!g(this,Ic)&&Math.abs(C-b)<=EE.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=a,h.touch0Y=s,h.touch1X=l,h.touch1Y=c,t.preventDefault(),!g(this,Ic)){T(this,Ic,!0);return}const S=[(a+l)/2,(s+c)/2];(O=g(this,Lp))==null||O.call(this,S,C,b)},kw=function(t){var e;g(this,gl).abort(),T(this,gl,null),(e=g(this,Np))==null||e.call(this),g(this,Ws)&&(t.preventDefault(),T(this,Ws,null),T(this,Ic,!1))};let kx=EE;var Uc,Ei,Xt,uf,ml,Pp,Hc,rn,zc,Ks,xl,Ip,jc,xa,Bp,Gc,Qs,ls,hf,ff,ei,Vc,Up,Ix,$e,Cw,Hp,Rw,j1,j4,G4,Ow,G1,Dw,V4,$4,X4,Fw,q4,Mw,Y4,W4,K4,Lw,O0;const st=class st{constructor(t){R(this,$e);R(this,Uc,null);R(this,Ei,null);R(this,Xt,null);R(this,uf,!1);R(this,ml,null);R(this,Pp,"");R(this,Hc,!1);R(this,rn,null);R(this,zc,null);R(this,Ks,null);R(this,xl,null);R(this,Ip,"");R(this,jc,!1);R(this,xa,null);R(this,Bp,!1);R(this,Gc,!1);R(this,Qs,!1);R(this,ls,null);R(this,hf,0);R(this,ff,0);R(this,ei,null);R(this,Vc,null);Ve(this,"_editToolbar",null);Ve(this,"_initialOptions",Object.create(null));Ve(this,"_initialData",null);Ve(this,"_isVisible",!0);Ve(this,"_uiManager",null);Ve(this,"_focusEventsAllowed",!0);R(this,Up,!1);R(this,Ix,st._zIndex++);this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null;const{rotation:e,rawDims:{pageWidth:r,pageHeight:a,pageX:s,pageY:l}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[r,a],this.pageTranslation=[s,l];const[c,h]=this.parentDimensions;this.x=t.x/c,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=st.prototype._resizeWithKeyboard,e=Iu.TRANSLATE_SMALL,r=Iu.TRANSLATE_BIG;return ht(this,"_resizerKeyboardManager",new Qg([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-r,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[r,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-r]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,r]}],[["Escape","mac+Escape"],st.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return ht(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new TH({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(st._l10n??(st._l10n=t),st._l10nResizer||(st._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),st._borderLineWidth!==-1)return;const r=getComputedStyle(document.documentElement);st._borderLineWidth=parseFloat(r.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){It("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return g(this,Up)}set _isDraggable(t){var e;T(this,Up,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=g(this,Ix)}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):D(this,$e,O0).call(this),this.parent=t}focusin(t){this._focusEventsAllowed&&(g(this,jc)?T(this,jc,!1):this.parent.setSelected(this))}focusout(t){var r;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const e=t.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(t.preventDefault(),(r=this.parent)!=null&&r.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,r,a){const[s,l]=this.parentDimensions;[r,a]=this.screenToPageTranslation(r,a),this.x=(t+r)/s,this.y=(e+a)/l,this.fixAndSetPosition()}translate(t,e){D(this,$e,Cw).call(this,this.parentDimensions,t,e)}translateInPage(t,e){g(this,xa)||T(this,xa,[this.x,this.y,this.width,this.height]),D(this,$e,Cw).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}drag(t,e){g(this,xa)||T(this,xa,[this.x,this.y,this.width,this.height]);const{div:r,parentDimensions:[a,s]}=this;if(this.x+=t/a,this.y+=e/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:m,y:x}=this.div.getBoundingClientRect();this.parent.findNewParent(this,m,x)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:c}=this;const[h,f]=this.getBaseTranslation();l+=h,c+=f;const{style:d}=r;d.left=`${(100*l).toFixed(2)}%`,d.top=`${(100*c).toFixed(2)}%`,this._onTranslating(l,c),r.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!g(this,xa)&&(g(this,xa)[0]!==this.x||g(this,xa)[1]!==this.y)}get _hasBeenResized(){return!!g(this,xa)&&(g(this,xa)[2]!==this.width||g(this,xa)[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:r}=st,a=r/t,s=r/e;switch(this.rotation){case 90:return[-a,s];case 180:return[a,s];case 270:return[a,-s];default:return[-a,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[r,a]}=this;let{x:s,y:l,width:c,height:h}=this;if(c*=r,h*=a,s*=r,l*=a,this._mustFixPosition)switch(t){case 0:s=Math.max(0,Math.min(r-c,s)),l=Math.max(0,Math.min(a-h,l));break;case 90:s=Math.max(0,Math.min(r-h,s)),l=Math.min(a,Math.max(c,l));break;case 180:s=Math.min(r,Math.max(c,s)),l=Math.min(a,Math.max(h,l));break;case 270:s=Math.min(r,Math.max(h,s)),l=Math.max(0,Math.min(a-c,l));break}this.x=s/=r,this.y=l/=a;const[f,d]=this.getBaseTranslation();s+=f,l+=d,e.left=`${(100*s).toFixed(2)}%`,e.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var r;return D(r=st,Hp,Rw).call(r,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var r;return D(r=st,Hp,Rw).call(r,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,r]}=this;return[e*t,r*t]}setDims(t,e){const[r,a]=this.parentDimensions,{style:s}=this.div;s.width=`${(100*t/r).toFixed(2)}%`,g(this,Hc)||(s.height=`${(100*e/a).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:r}=t,a=r.endsWith("%"),s=!g(this,Hc)&&e.endsWith("%");if(a&&s)return;const[l,c]=this.parentDimensions;a||(t.width=`${(100*parseFloat(r)/l).toFixed(2)}%`),!g(this,Hc)&&!s&&(t.height=`${(100*parseFloat(e)/c).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(t){return Math.round(t*1e4)/1e4}_onResizing(){}altTextFinish(){var t;(t=g(this,Xt))==null||t.finish()}async addEditToolbar(){return this._editToolbar||g(this,Gc)?this._editToolbar:(this._editToolbar=new xw(this),this.div.append(this._editToolbar.render()),g(this,Xt)&&await this._editToolbar.addAltText(g(this,Xt)),this._editToolbar)}removeEditToolbar(){var t;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(t=g(this,Xt))==null||t.destroy())}addContainer(t){var r;const e=(r=this._editToolbar)==null?void 0:r.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){g(this,Xt)||(Tx.initialize(st._l10n),T(this,Xt,new Tx(this)),g(this,Uc)&&(g(this,Xt).data=g(this,Uc),T(this,Uc,null)),await this.addEditToolbar())}get altTextData(){var t;return(t=g(this,Xt))==null?void 0:t.data}set altTextData(t){g(this,Xt)&&(g(this,Xt).data=t)}get guessedAltText(){var t;return(t=g(this,Xt))==null?void 0:t.guessedText}async setGuessedAltText(t){var e;await((e=g(this,Xt))==null?void 0:e.setGuessedText(t))}serializeAltText(t){var e;return(e=g(this,Xt))==null?void 0:e.serialize(t)}hasAltText(){return!!g(this,Xt)&&!g(this,Xt).isEmpty()}hasAltTextData(){var t;return((t=g(this,Xt))==null?void 0:t.hasData())??!1}render(){var s;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=g(this,uf)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),D(this,$e,Mw).call(this);const[t,e]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*e/t).toFixed(2)}%`,this.div.style.maxHeight=`${(100*t/e).toFixed(2)}%`);const[r,a]=this.getInitialTranslation();return this.translate(r,a),Sx(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(g(this,Vc)||T(this,Vc,new kx({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:D(this,$e,V4).bind(this),onPinching:D(this,$e,$4).bind(this),onPinchEnd:D(this,$e,X4).bind(this),signal:this._uiManager._signal}))),(s=this._uiManager._editorUndoBar)==null||s.hide(),this.div}pointerdown(t){const{isMac:e}=Vn.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(T(this,jc,!0),this._isDraggable){D(this,$e,q4).call(this,t);return}D(this,$e,Fw).call(this,t)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){g(this,ls)&&clearTimeout(g(this,ls)),T(this,ls,setTimeout(()=>{var t;T(this,ls,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,r){t.changeParent(this),this.x=e,this.y=r,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,r=this.rotation){const a=this.parentScale,[s,l]=this.pageDimensions,[c,h]=this.pageTranslation,f=t/a,d=e/a,m=this.x*s,x=this.y*l,_=this.width*s,y=this.height*l;switch(r){case 0:return[m+f+c,l-x-d-y+h,m+f+_+c,l-x-d+h];case 90:return[m+d+c,l-x+f+h,m+d+y+c,l-x+f+_+h];case 180:return[m-f-_+c,l-x+d+h,m-f+c,l-x+d+y+h];case 270:return[m-d-y+c,l-x-f-_+h,m-d+c,l-x-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[r,a,s,l]=t,c=s-r,h=l-a;switch(this.rotation){case 0:return[r,e-l,c,h];case 90:return[r,e-a,h,c];case 180:return[s,e-a,c,h];case 270:return[s,e-l,h,c];default:throw new Error("Invalid rotation")}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){T(this,Gc,!0)}disableEditMode(){T(this,Gc,!1)}isInEditMode(){return g(this,Gc)}shouldGetKeyboardEvents(){return g(this,Qs)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:r,right:a}=this.getClientDimensions(),{innerHeight:s,innerWidth:l}=window;return e<l&&a>0&&t<s&&r>0}rebuild(){D(this,$e,Mw).call(this)}rotate(t){}resize(){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,e=null){It("An editor must be serializable")}static async deserialize(t,e,r){const a=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:r});a.rotation=t.rotation,T(a,Uc,t.accessibilityData);const[s,l]=a.pageDimensions,[c,h,f,d]=a.getRectInCurrentCoords(t.rect,l);return a.x=c/s,a.y=h/l,a.width=f/s,a.height=d/l,a}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t,e;if((t=g(this,xl))==null||t.abort(),T(this,xl,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),g(this,ls)&&(clearTimeout(g(this,ls)),T(this,ls,null)),D(this,$e,O0).call(this),this.removeEditToolbar(),g(this,ei)){for(const r of g(this,ei).values())clearTimeout(r);T(this,ei,null)}this.parent=null,(e=g(this,Vc))==null||e.destroy(),T(this,Vc,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(D(this,$e,j4).call(this),g(this,rn).classList.remove("hidden"),Sx(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),T(this,Ks,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=g(this,rn).children;if(!g(this,Ei)){T(this,Ei,Array.from(e));const l=D(this,$e,Y4).bind(this),c=D(this,$e,W4).bind(this),h=this._uiManager._signal;for(const f of g(this,Ei)){const d=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",l,{signal:h}),f.addEventListener("blur",c,{signal:h}),f.addEventListener("focus",D(this,$e,K4).bind(this,d),{signal:h}),f.setAttribute("data-l10n-id",st._l10nResizer[d])}}const r=g(this,Ei)[0];let a=0;for(const l of e){if(l===r)break;a++}const s=(360-this.rotation+this.parentRotation)%360/90*(g(this,Ei).length/4);if(s!==a){if(s<a)for(let c=0;c<a-s;c++)g(this,rn).append(g(this,rn).firstChild);else if(s>a)for(let c=0;c<s-a;c++)g(this,rn).firstChild.before(g(this,rn).lastChild);let l=0;for(const c of e){const f=g(this,Ei)[l++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",st._l10nResizer[f])}}D(this,$e,Lw).call(this,0),T(this,Qs,!0),g(this,rn).firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){g(this,Qs)&&D(this,$e,Dw).call(this,g(this,Ip),{deltaX:t,deltaY:e,fromKeyboard:!0})}_stopResizingWithKeyboard(){D(this,$e,O0).call(this),this.div.focus()}select(){var t,e,r;if(this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var a,s;(a=this.div)!=null&&a.classList.contains("selectedEditor")&&((s=this._editToolbar)==null||s.show())});return}(e=this._editToolbar)==null||e.show(),(r=g(this,Xt))==null||r.toggleAltTextBadge(!1)}unselect(){var t,e,r,a,s;(t=g(this,rn))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(r=this.div)!=null&&r.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(a=this._editToolbar)==null||a.hide(),(s=g(this,Xt))==null||s.toggleAltTextBadge(!0)}updateParams(t,e){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return g(this,Bp)}set isEditing(t){T(this,Bp,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){T(this,Hc,!0);const r=t/e,{style:a}=this.div;a.aspectRatio=r,a.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){g(this,ei)||T(this,ei,new Map);const{action:r}=t;let a=g(this,ei).get(r);a&&clearTimeout(a),a=setTimeout(()=>{this._reportTelemetry(t),g(this,ei).delete(r),g(this,ei).size===0&&T(this,ei,null)},st._telemetryTimeout),g(this,ei).set(r,a);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),T(this,uf,!1)}disable(){this.div&&(this.div.tabIndex=-1),T(this,uf,!0)}renderAnnotationElement(t){let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const r=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),r.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;(e==null?void 0:e.nodeName)==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}};Uc=new WeakMap,Ei=new WeakMap,Xt=new WeakMap,uf=new WeakMap,ml=new WeakMap,Pp=new WeakMap,Hc=new WeakMap,rn=new WeakMap,zc=new WeakMap,Ks=new WeakMap,xl=new WeakMap,Ip=new WeakMap,jc=new WeakMap,xa=new WeakMap,Bp=new WeakMap,Gc=new WeakMap,Qs=new WeakMap,ls=new WeakMap,hf=new WeakMap,ff=new WeakMap,ei=new WeakMap,Vc=new WeakMap,Up=new WeakMap,Ix=new WeakMap,$e=new WeakSet,Cw=function([t,e],r,a){[r,a]=this.screenToPageTranslation(r,a),this.x+=r/t,this.y+=a/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Hp=new WeakSet,Rw=function(t,e,r){switch(r){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},j1=function(t){switch(t){case 90:{const[e,r]=this.pageDimensions;return[0,-e/r,r/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,r]=this.pageDimensions;return[0,e/r,-r/e,0]}default:return[1,0,0,1]}},j4=function(){if(g(this,rn))return;T(this,rn,document.createElement("div")),g(this,rn).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const r of t){const a=document.createElement("div");g(this,rn).append(a),a.classList.add("resizer",r),a.setAttribute("data-resizer-name",r),a.addEventListener("pointerdown",D(this,$e,G4).bind(this,r),{signal:e}),a.addEventListener("contextmenu",Bi,{signal:e}),a.tabIndex=-1}this.div.prepend(g(this,rn))},G4=function(t,e){var d;e.preventDefault();const{isMac:r}=Vn.platform;if(e.button!==0||e.ctrlKey&&r)return;(d=g(this,Xt))==null||d.toggle(!1);const a=this._isDraggable;this._isDraggable=!1,T(this,zc,[e.screenX,e.screenY]);const s=new AbortController,l=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",D(this,$e,Dw).bind(this,t),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",Da,{passive:!1,signal:l}),window.addEventListener("contextmenu",Bi,{signal:l}),T(this,Ks,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const c=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{var m;s.abort(),this.parent.togglePointerEvents(!0),(m=g(this,Xt))==null||m.toggle(!0),this._isDraggable=a,this.parent.div.style.cursor=c,this.div.style.cursor=h,D(this,$e,G1).call(this)};window.addEventListener("pointerup",f,{signal:l}),window.addEventListener("blur",f,{signal:l})},Ow=function(t,e,r,a){this.width=r,this.height=a,this.x=t,this.y=e;const[s,l]=this.parentDimensions;this.setDims(s*r,l*a),this.fixAndSetPosition(),this._onResized()},G1=function(){if(!g(this,Ks))return;const{savedX:t,savedY:e,savedWidth:r,savedHeight:a}=g(this,Ks);T(this,Ks,null);const s=this.x,l=this.y,c=this.width,h=this.height;s===t&&l===e&&c===r&&h===a||this.addCommands({cmd:D(this,$e,Ow).bind(this,s,l,c,h),undo:D(this,$e,Ow).bind(this,t,e,r,a),mustExec:!0})},Dw=function(t,e){const[r,a]=this.parentDimensions,s=this.x,l=this.y,c=this.width,h=this.height,f=st.MIN_SIZE/r,d=st.MIN_SIZE/a,m=D(this,$e,j1).call(this,this.rotation),x=(J,oe)=>[m[0]*J+m[2]*oe,m[1]*J+m[3]*oe],_=D(this,$e,j1).call(this,360-this.rotation),y=(J,oe)=>[_[0]*J+_[2]*oe,_[1]*J+_[3]*oe];let A,E,b=!1,C=!1;switch(t){case"topLeft":b=!0,A=(J,oe)=>[0,0],E=(J,oe)=>[J,oe];break;case"topMiddle":A=(J,oe)=>[J/2,0],E=(J,oe)=>[J/2,oe];break;case"topRight":b=!0,A=(J,oe)=>[J,0],E=(J,oe)=>[0,oe];break;case"middleRight":C=!0,A=(J,oe)=>[J,oe/2],E=(J,oe)=>[0,oe/2];break;case"bottomRight":b=!0,A=(J,oe)=>[J,oe],E=(J,oe)=>[0,0];break;case"bottomMiddle":A=(J,oe)=>[J/2,oe],E=(J,oe)=>[J/2,0];break;case"bottomLeft":b=!0,A=(J,oe)=>[0,oe],E=(J,oe)=>[J,0];break;case"middleLeft":C=!0,A=(J,oe)=>[0,oe/2],E=(J,oe)=>[J,oe/2];break}const S=A(c,h),O=E(c,h);let L=x(...O);const I=st._round(s+L[0]),F=st._round(l+L[1]);let W=1,B=1,ee,Z;if(e.fromKeyboard)({deltaX:ee,deltaY:Z}=e);else{const{screenX:J,screenY:oe}=e,[De,ae]=g(this,zc);[ee,Z]=this.screenToPageTranslation(J-De,oe-ae),g(this,zc)[0]=J,g(this,zc)[1]=oe}if([ee,Z]=y(ee/r,Z/a),b){const J=Math.hypot(c,h);W=B=Math.max(Math.min(Math.hypot(O[0]-S[0]-ee,O[1]-S[1]-Z)/J,1/c,1/h),f/c,d/h)}else C?W=Math.max(f,Math.min(1,Math.abs(O[0]-S[0]-ee)))/c:B=Math.max(d,Math.min(1,Math.abs(O[1]-S[1]-Z)))/h;const te=st._round(c*W),ve=st._round(h*B);L=x(...E(te,ve));const Ce=I-L[0],Ee=F-L[1];g(this,xa)||T(this,xa,[this.x,this.y,this.width,this.height]),this.width=te,this.height=ve,this.x=Ce,this.y=Ee,this.setDims(r*te,a*ve),this.fixAndSetPosition(),this._onResizing()},V4=function(){var t;T(this,Ks,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(t=g(this,Xt))==null||t.toggle(!1),this.parent.togglePointerEvents(!1)},$4=function(t,e,r){let s=.7*(r/e)+1-.7;if(s===1)return;const l=D(this,$e,j1).call(this,this.rotation),c=(I,F)=>[l[0]*I+l[2]*F,l[1]*I+l[3]*F],[h,f]=this.parentDimensions,d=this.x,m=this.y,x=this.width,_=this.height,y=st.MIN_SIZE/h,A=st.MIN_SIZE/f;s=Math.max(Math.min(s,1/x,1/_),y/x,A/_);const E=st._round(x*s),b=st._round(_*s);if(E===x&&b===_)return;g(this,xa)||T(this,xa,[d,m,x,_]);const C=c(x/2,_/2),S=st._round(d+C[0]),O=st._round(m+C[1]),L=c(E/2,b/2);this.x=S-L[0],this.y=O-L[1],this.width=E,this.height=b,this.setDims(h*E,f*b),this.fixAndSetPosition(),this._onResizing()},X4=function(){var t;(t=g(this,Xt))==null||t.toggle(!0),this.parent.togglePointerEvents(!0),D(this,$e,G1).call(this)},Fw=function(t){const{isMac:e}=Vn.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},q4=function(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let r=!1;const a=new AbortController,s=this._uiManager.combinedSignal(a),l={capture:!0,passive:!1,signal:s},c=f=>{a.abort(),T(this,ml,null),T(this,jc,!1),this._uiManager.endDragSession()||D(this,$e,Fw).call(this,f),r&&this._onStopDragging()};e&&(T(this,hf,t.clientX),T(this,ff,t.clientY),T(this,ml,t.pointerId),T(this,Pp,t.pointerType),window.addEventListener("pointermove",f=>{r||(r=!0,this._onStartDragging());const{clientX:d,clientY:m,pointerId:x}=f;if(x!==g(this,ml)){Da(f);return}const[_,y]=this.screenToPageTranslation(d-g(this,hf),m-g(this,ff));T(this,hf,d),T(this,ff,m),this._uiManager.dragSelectedEditors(_,y)},l),window.addEventListener("touchmove",Da,l),window.addEventListener("pointerdown",f=>{f.pointerType===g(this,Pp)&&(g(this,Vc)||f.isPrimary)&&c(f),Da(f)},l));const h=f=>{if(!g(this,ml)||g(this,ml)===f.pointerId){c(f);return}Da(f)};window.addEventListener("pointerup",h,{signal:s}),window.addEventListener("blur",h,{signal:s})},Mw=function(){if(g(this,xl)||!this.div)return;T(this,xl,new AbortController);const t=this._uiManager.combinedSignal(g(this,xl));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},Y4=function(t){st._resizerKeyboardManager.exec(this,t)},W4=function(t){var e;g(this,Qs)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==g(this,rn)&&D(this,$e,O0).call(this)},K4=function(t){T(this,Ip,g(this,Qs)?t:"")},Lw=function(t){if(g(this,Ei))for(const e of g(this,Ei))e.tabIndex=t},O0=function(){T(this,Qs,!1),D(this,$e,Lw).call(this,-1),D(this,$e,G1).call(this)},R(st,Hp),Ve(st,"_l10n",null),Ve(st,"_l10nResizer",null),Ve(st,"_borderLineWidth",-1),Ve(st,"_colorManager",new yw),Ve(st,"_zIndex",1),Ve(st,"_telemetryTimeout",1e3);let ir=st;class TH extends ir{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Gk=3285377520,Wa=4294901760,Ki=65535;class Q4{constructor(t){this.h1=t?t&4294967295:Gk,this.h2=t?t&4294967295:Gk}update(t){let e,r;if(typeof t=="string"){e=new Uint8Array(t.length*2),r=0;for(let A=0,E=t.length;A<E;A++){const b=t.charCodeAt(A);b<=255?e[r++]=b:(e[r++]=b>>>8,e[r++]=b&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),r=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const a=r>>2,s=r-a*4,l=new Uint32Array(e.buffer,0,a);let c=0,h=0,f=this.h1,d=this.h2;const m=3432918353,x=461845907,_=m&Ki,y=x&Ki;for(let A=0;A<a;A++)A&1?(c=l[A],c=c*m&Wa|c*_&Ki,c=c<<15|c>>>17,c=c*x&Wa|c*y&Ki,f^=c,f=f<<13|f>>>19,f=f*5+3864292196):(h=l[A],h=h*m&Wa|h*_&Ki,h=h<<15|h>>>17,h=h*x&Wa|h*y&Ki,d^=h,d=d<<13|d>>>19,d=d*5+3864292196);switch(c=0,s){case 3:c^=e[a*4+2]<<16;case 2:c^=e[a*4+1]<<8;case 1:c^=e[a*4],c=c*m&Wa|c*_&Ki,c=c<<15|c>>>17,c=c*x&Wa|c*y&Ki,a&1?f^=c:d^=c}this.h1=f,this.h2=d}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Wa|t*36045&Ki,e=e*4283543511&Wa|((e<<16|t>>>16)*2950163797&Wa)>>>16,t^=e>>>1,t=t*444984403&Wa|t*60499&Ki,e=e*3301882366&Wa|((e<<16|t>>>16)*3120437893&Wa)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const Nw=Object.freeze({map:null,hash:"",transfer:void 0});var $c,Xc,Vr,Bx,Z4;class vE{constructor(){R(this,Bx);R(this,$c,!1);R(this,Xc,null);R(this,Vr,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const r=g(this,Vr).get(t);return r===void 0?e:Object.assign(e,r)}getRawValue(t){return g(this,Vr).get(t)}remove(t){if(g(this,Vr).delete(t),g(this,Vr).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of g(this,Vr).values())if(e instanceof ir)return;this.onAnnotationEditor(null)}}setValue(t,e){const r=g(this,Vr).get(t);let a=!1;if(r!==void 0)for(const[s,l]of Object.entries(e))r[s]!==l&&(a=!0,r[s]=l);else a=!0,g(this,Vr).set(t,e);a&&D(this,Bx,Z4).call(this),e instanceof ir&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return g(this,Vr).has(t)}getAll(){return g(this,Vr).size>0?fE(g(this,Vr)):null}setAll(t){for(const[e,r]of Object.entries(t))this.setValue(e,r)}get size(){return g(this,Vr).size}resetModified(){g(this,$c)&&(T(this,$c,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new J4(this)}get serializable(){if(g(this,Vr).size===0)return Nw;const t=new Map,e=new Q4,r=[],a=Object.create(null);let s=!1;for(const[l,c]of g(this,Vr)){const h=c instanceof ir?c.serialize(!1,a):c;h&&(t.set(l,h),e.update(`${l}:${JSON.stringify(h)}`),s||(s=!!h.bitmap))}if(s)for(const l of t.values())l.bitmap&&r.push(l.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:r}:Nw}get editorStats(){let t=null;const e=new Map;for(const r of g(this,Vr).values()){if(!(r instanceof ir))continue;const a=r.telemetryFinalData;if(!a)continue;const{type:s}=a;e.has(s)||e.set(s,Object.getPrototypeOf(r).constructor),t||(t=Object.create(null));const l=t[s]||(t[s]=new Map);for(const[c,h]of Object.entries(a)){if(c==="type")continue;let f=l.get(c);f||(f=new Map,l.set(c,f));const d=f.get(h)??0;f.set(h,d+1)}}for(const[r,a]of e)t[r]=a.computeTelemetryFinalData(t[r]);return t}resetModifiedIds(){T(this,Xc,null)}get modifiedIds(){if(g(this,Xc))return g(this,Xc);const t=[];for(const e of g(this,Vr).values())!(e instanceof ir)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return T(this,Xc,{ids:new Set(t),hash:t.join(",")})}}$c=new WeakMap,Xc=new WeakMap,Vr=new WeakMap,Bx=new WeakSet,Z4=function(){g(this,$c)||(T(this,$c,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var zp;class J4 extends vE{constructor(e){super();R(this,zp);const{map:r,hash:a,transfer:s}=e.serializable,l=structuredClone(r,s?{transfer:s}:null);T(this,zp,{map:l,hash:a,transfer:s})}get print(){It("Should not call PrintAnnotationStorage.print")}get serializable(){return g(this,zp)}get modifiedIds(){return ht(this,"modifiedIds",{ids:new Set,hash:""})}}zp=new WeakMap;var df;class kH{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){R(this,df,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),g(this,df).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,_inspectFont:e}){if(!(!t||g(this,df).has(t.loadedName))){if(Tr(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:a,style:s}=t,l=new FontFace(r,a,s);this.addNativeFontFace(l);try{await l.load(),g(this,df).add(r),e==null||e(t)}catch{it(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}It("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const r=t.createNativeFontFace();if(r){this.addNativeFontFace(r);try{await r.loaded}catch(a){throw it(`Failed to load font '${r.family}': '${a}'.`),t.disableFontFace=!0,a}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(r=>{const a=this._queueLoadingCallback(r);this._prepareFontLoadEvent(t,a)})}}get isFontLoadingAPISupported(){var e;const t=!!((e=this._document)!=null&&e.fonts);return ht(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){let t=!1;return(Sn||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(t=!0),ht(this,"isSyncFontLoadingSupported",t)}_queueLoadingCallback(t){function e(){for(Tr(!a.done,"completeRequest() cannot be called twice."),a.done=!0;r.length>0&&r[0].done;){const s=r.shift();setTimeout(s.callback,0)}}const{loadingRequests:r}=this,a={done:!1,complete:e,callback:t};return r.push(a),a}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ht(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function r(O,L){return O.charCodeAt(L)<<24|O.charCodeAt(L+1)<<16|O.charCodeAt(L+2)<<8|O.charCodeAt(L+3)&255}function a(O,L,I,F){const W=O.substring(0,L),B=O.substring(L+I);return W+F+B}let s,l;const c=this._document.createElement("canvas");c.width=1,c.height=1;const h=c.getContext("2d");let f=0;function d(O,L){if(++f>30){it("Load test font never loaded."),L();return}if(h.font="30px "+O,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){L();return}setTimeout(d.bind(null,O,L))}const m=`lt${Date.now()}${this.loadTestFontId++}`;let x=this._loadTestFont;x=a(x,976,m.length,m);const y=16,A=1482184792;let E=r(x,y);for(s=0,l=m.length-3;s<l;s+=4)E=E-A+r(m,s)|0;s<m.length&&(E=E-A+r(m+"XXX",s)|0),x=a(x,y,4,fH(E));const b=`url(data:font/opentype;base64,${btoa(x)});`,C=`@font-face {font-family:"${m}";src:${b}}`;this.insertRule(C);const S=this._document.createElement("div");S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px";for(const O of[t.loadedName,m]){const L=this._document.createElement("span");L.textContent="Hi",L.style.fontFamily=O,S.append(L)}this._document.body.append(S),d(m,()=>{S.remove(),e.complete()})}}df=new WeakMap;class CH{constructor(t,{disableFontFace:e=!1,fontExtraProperties:r=!1,inspectFont:a=null}){this.compiledGlyphs=Object.create(null);for(const s in t)this[s]=t[s];this.disableFontFace=e===!0,this.fontExtraProperties=r===!0,this._inspectFont=a}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const r={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(r.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,r)}return(e=this._inspectFont)==null||e.call(this,this),t}createFontFaceRule(){var r;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${vH(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let a=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(a+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${a}src:${t}}`}return(r=this._inspectFont)==null||r.call(this,this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const r=this.loadedName+"_path_"+e;let a;try{a=t.get(r)}catch(l){it(`getPathGenerator - ignoring character: "${l}".`)}const s=new Path2D(a||"");return this.fontExtraProperties||t.delete(r),this.compiledGlyphs[e]=s}}const R1={DATA:1,ERROR:2},Er={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Vk(){}function ta(n){if(n instanceof Gl||n instanceof pw||n instanceof fp||n instanceof Hk||n instanceof bx||n instanceof zy)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||It('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Gl(n.message);case"InvalidPDFException":return new pw(n.message);case"MissingPDFException":return new fp(n.message);case"PasswordException":return new Hk(n.message,n.code);case"UnexpectedResponseException":return new bx(n.message,n.status);case"UnknownErrorException":return new zy(n.message,n.details)}return new zy(n.message,n.toString())}var pf,oi,eO,tO,rO,V1;class D0{constructor(t,e,r){R(this,oi);R(this,pf,new AbortController);this.sourceName=t,this.targetName=e,this.comObj=r,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),r.addEventListener("message",D(this,oi,eO).bind(this),{signal:g(this,pf).signal})}on(t,e){const r=this.actionHandler;if(r[t])throw new Error(`There is already an actionName called "${t}"`);r[t]=e}send(t,e,r){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},r)}sendWithPromise(t,e,r){const a=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[a]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:a,data:e},r)}catch(l){s.reject(l)}return s.promise}sendWithStream(t,e,r,a){const s=this.streamId++,l=this.sourceName,c=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const d=Promise.withResolvers();return this.streamControllers[s]={controller:f,startCall:d,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:l,targetName:c,action:t,streamId:s,data:e,desiredSize:f.desiredSize},a),d.promise},pull:f=>{const d=Promise.withResolvers();return this.streamControllers[s].pullCall=d,h.postMessage({sourceName:l,targetName:c,stream:Er.PULL,streamId:s,desiredSize:f.desiredSize}),d.promise},cancel:f=>{Tr(f instanceof Error,"cancel must have a valid reason");const d=Promise.withResolvers();return this.streamControllers[s].cancelCall=d,this.streamControllers[s].isClosed=!0,h.postMessage({sourceName:l,targetName:c,stream:Er.CANCEL,streamId:s,reason:ta(f)}),d.promise}},r)}destroy(){var t;(t=g(this,pf))==null||t.abort(),T(this,pf,null)}}pf=new WeakMap,oi=new WeakSet,eO=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){D(this,oi,rO).call(this,t);return}if(t.callback){const r=t.callbackId,a=this.callbackCapabilities[r];if(!a)throw new Error(`Cannot resolve callback ${r}`);if(delete this.callbackCapabilities[r],t.callback===R1.DATA)a.resolve(t.data);else if(t.callback===R1.ERROR)a.reject(ta(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const r=this.sourceName,a=t.sourceName,s=this.comObj;Promise.try(e,t.data).then(function(l){s.postMessage({sourceName:r,targetName:a,callback:R1.DATA,callbackId:t.callbackId,data:l})},function(l){s.postMessage({sourceName:r,targetName:a,callback:R1.ERROR,callbackId:t.callbackId,reason:ta(l)})});return}if(t.streamId){D(this,oi,tO).call(this,t);return}e(t.data)},tO=function(t){const e=t.streamId,r=this.sourceName,a=t.sourceName,s=this.comObj,l=this,c=this.actionHandler[t.action],h={enqueue(f,d=1,m){if(this.isCancelled)return;const x=this.desiredSize;this.desiredSize-=d,x>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:r,targetName:a,stream:Er.ENQUEUE,streamId:e,chunk:f},m)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:a,stream:Er.CLOSE,streamId:e}),delete l.streamSinks[e])},error(f){Tr(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:r,targetName:a,stream:Er.ERROR,streamId:e,reason:ta(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[e]=h,Promise.try(c,t.data,h).then(function(){s.postMessage({sourceName:r,targetName:a,stream:Er.START_COMPLETE,streamId:e,success:!0})},function(f){s.postMessage({sourceName:r,targetName:a,stream:Er.START_COMPLETE,streamId:e,reason:ta(f)})})},rO=function(t){const e=t.streamId,r=this.sourceName,a=t.sourceName,s=this.comObj,l=this.streamControllers[e],c=this.streamSinks[e];switch(t.stream){case Er.START_COMPLETE:t.success?l.startCall.resolve():l.startCall.reject(ta(t.reason));break;case Er.PULL_COMPLETE:t.success?l.pullCall.resolve():l.pullCall.reject(ta(t.reason));break;case Er.PULL:if(!c){s.postMessage({sourceName:r,targetName:a,stream:Er.PULL_COMPLETE,streamId:e,success:!0});break}c.desiredSize<=0&&t.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=t.desiredSize,Promise.try(c.onPull||Vk).then(function(){s.postMessage({sourceName:r,targetName:a,stream:Er.PULL_COMPLETE,streamId:e,success:!0})},function(f){s.postMessage({sourceName:r,targetName:a,stream:Er.PULL_COMPLETE,streamId:e,reason:ta(f)})});break;case Er.ENQUEUE:if(Tr(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(t.chunk);break;case Er.CLOSE:if(Tr(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),D(this,oi,V1).call(this,l,e);break;case Er.ERROR:Tr(l,"error should have stream controller"),l.controller.error(ta(t.reason)),D(this,oi,V1).call(this,l,e);break;case Er.CANCEL_COMPLETE:t.success?l.cancelCall.resolve():l.cancelCall.reject(ta(t.reason)),D(this,oi,V1).call(this,l,e);break;case Er.CANCEL:if(!c)break;const h=ta(t.reason);Promise.try(c.onCancel||Vk,h).then(function(){s.postMessage({sourceName:r,targetName:a,stream:Er.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){s.postMessage({sourceName:r,targetName:a,stream:Er.CANCEL_COMPLETE,streamId:e,reason:ta(f)})}),c.sinkCapability.reject(h),c.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},V1=async function(t,e){var r,a,s;await Promise.allSettled([(r=t.startCall)==null?void 0:r.promise,(a=t.pullCall)==null?void 0:a.promise,(s=t.cancelCall)==null?void 0:s.promise]),delete this.streamControllers[e]};var jp;class nO{constructor({enableHWA:t=!1}){R(this,jp,!1);T(this,jp,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const r=this._createCanvas(t,e);return{canvas:r,context:r.getContext("2d",{willReadFrequently:!g(this,jp)})}}reset(t,e,r){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||r<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=r}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){It("Abstract method `_createCanvas` called.")}}jp=new WeakMap;class RH extends nO{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const r=this._document.createElement("canvas");return r.width=t,r.height=e,r}}class aO{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(r=>({cMapData:r,isCompressed:this.isCompressed})).catch(r=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){It("Abstract method `_fetch` called.")}}class iO extends aO{async _fetch(t){const e=await cv(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):lv(e)}}class sO{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,r,a,s){return"none"}destroy(t=!1){}}var qc,gf,Zs,Js,_n,Yc,Wc,Pe,mn,F0,Ph,$1,Ih,oO,Pw,Bh,M0,L0,Iw,N0;class OH extends sO{constructor({docId:e,ownerDocument:r=globalThis.document}){super();R(this,Pe);R(this,qc);R(this,gf);R(this,Zs);R(this,Js);R(this,_n);R(this,Yc);R(this,Wc,0);T(this,Js,e),T(this,_n,r)}addFilter(e){if(!e)return"none";let r=g(this,Pe,mn).get(e);if(r)return r;const[a,s,l]=D(this,Pe,$1).call(this,e),c=e.length===1?a:`${a}${s}${l}`;if(r=g(this,Pe,mn).get(c),r)return g(this,Pe,mn).set(e,r),r;const h=`g_${g(this,Js)}_transfer_map_${Ln(this,Wc)._++}`,f=D(this,Pe,Ih).call(this,h);g(this,Pe,mn).set(e,f),g(this,Pe,mn).set(c,f);const d=D(this,Pe,Bh).call(this,h);return D(this,Pe,L0).call(this,a,s,l,d),f}addHCMFilter(e,r){var y;const a=`${e}-${r}`,s="base";let l=g(this,Pe,F0).get(s);if((l==null?void 0:l.key)===a||(l?((y=l.filter)==null||y.remove(),l.key=a,l.url="none",l.filter=null):(l={key:a,url:"none",filter:null},g(this,Pe,F0).set(s,l)),!e||!r))return l.url;const c=D(this,Pe,N0).call(this,e);e=je.makeHexColor(...c);const h=D(this,Pe,N0).call(this,r);if(r=je.makeHexColor(...h),g(this,Pe,Ph).style.color="",e==="#000000"&&r==="#ffffff"||e===r)return l.url;const f=new Array(256);for(let A=0;A<=255;A++){const E=A/255;f[A]=E<=.03928?E/12.92:((E+.055)/1.055)**2.4}const d=f.join(","),m=`g_${g(this,Js)}_hcm_filter`,x=l.filter=D(this,Pe,Bh).call(this,m);D(this,Pe,L0).call(this,d,d,d,x),D(this,Pe,Pw).call(this,x);const _=(A,E)=>{const b=c[A]/255,C=h[A]/255,S=new Array(E+1);for(let O=0;O<=E;O++)S[O]=b+O/E*(C-b);return S.join(",")};return D(this,Pe,L0).call(this,_(0,5),_(1,5),_(2,5),x),l.url=D(this,Pe,Ih).call(this,m),l.url}addAlphaFilter(e){let r=g(this,Pe,mn).get(e);if(r)return r;const[a]=D(this,Pe,$1).call(this,[e]),s=`alpha_${a}`;if(r=g(this,Pe,mn).get(s),r)return g(this,Pe,mn).set(e,r),r;const l=`g_${g(this,Js)}_alpha_map_${Ln(this,Wc)._++}`,c=D(this,Pe,Ih).call(this,l);g(this,Pe,mn).set(e,c),g(this,Pe,mn).set(s,c);const h=D(this,Pe,Bh).call(this,l);return D(this,Pe,Iw).call(this,a,h),c}addLuminosityFilter(e){let r=g(this,Pe,mn).get(e||"luminosity");if(r)return r;let a,s;if(e?([a]=D(this,Pe,$1).call(this,[e]),s=`luminosity_${a}`):s="luminosity",r=g(this,Pe,mn).get(s),r)return g(this,Pe,mn).set(e,r),r;const l=`g_${g(this,Js)}_luminosity_map_${Ln(this,Wc)._++}`,c=D(this,Pe,Ih).call(this,l);g(this,Pe,mn).set(e,c),g(this,Pe,mn).set(s,c);const h=D(this,Pe,Bh).call(this,l);return D(this,Pe,oO).call(this,h),e&&D(this,Pe,Iw).call(this,a,h),c}addHighlightHCMFilter(e,r,a,s,l){var C;const c=`${r}-${a}-${s}-${l}`;let h=g(this,Pe,F0).get(e);if((h==null?void 0:h.key)===c||(h?((C=h.filter)==null||C.remove(),h.key=c,h.url="none",h.filter=null):(h={key:c,url:"none",filter:null},g(this,Pe,F0).set(e,h)),!r||!a))return h.url;const[f,d]=[r,a].map(D(this,Pe,N0).bind(this));let m=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),x=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[_,y]=[s,l].map(D(this,Pe,N0).bind(this));x<m&&([m,x,_,y]=[x,m,y,_]),g(this,Pe,Ph).style.color="";const A=(S,O,L)=>{const I=new Array(256),F=(x-m)/L,W=S/255,B=(O-S)/(255*L);let ee=0;for(let Z=0;Z<=L;Z++){const te=Math.round(m+Z*F),ve=W+Z*B;for(let Ce=ee;Ce<=te;Ce++)I[Ce]=ve;ee=te+1}for(let Z=ee;Z<256;Z++)I[Z]=I[ee-1];return I.join(",")},E=`g_${g(this,Js)}_hcm_${e}_filter`,b=h.filter=D(this,Pe,Bh).call(this,E);return D(this,Pe,Pw).call(this,b),D(this,Pe,L0).call(this,A(_[0],y[0],5),A(_[1],y[1],5),A(_[2],y[2],5),b),h.url=D(this,Pe,Ih).call(this,E),h.url}destroy(e=!1){var r,a,s,l;e&&((r=g(this,Yc))!=null&&r.size)||((a=g(this,Zs))==null||a.parentNode.parentNode.remove(),T(this,Zs,null),(s=g(this,gf))==null||s.clear(),T(this,gf,null),(l=g(this,Yc))==null||l.clear(),T(this,Yc,null),T(this,Wc,0))}}qc=new WeakMap,gf=new WeakMap,Zs=new WeakMap,Js=new WeakMap,_n=new WeakMap,Yc=new WeakMap,Wc=new WeakMap,Pe=new WeakSet,mn=function(){return g(this,gf)||T(this,gf,new Map)},F0=function(){return g(this,Yc)||T(this,Yc,new Map)},Ph=function(){if(!g(this,Zs)){const e=g(this,_n).createElement("div"),{style:r}=e;r.visibility="hidden",r.contain="strict",r.width=r.height=0,r.position="absolute",r.top=r.left=0,r.zIndex=-1;const a=g(this,_n).createElementNS(Us,"svg");a.setAttribute("width",0),a.setAttribute("height",0),T(this,Zs,g(this,_n).createElementNS(Us,"defs")),e.append(a),a.append(g(this,Zs)),g(this,_n).body.append(e)}return g(this,Zs)},$1=function(e){if(e.length===1){const f=e[0],d=new Array(256);for(let x=0;x<256;x++)d[x]=f[x]/255;const m=d.join(",");return[m,m,m]}const[r,a,s]=e,l=new Array(256),c=new Array(256),h=new Array(256);for(let f=0;f<256;f++)l[f]=r[f]/255,c[f]=a[f]/255,h[f]=s[f]/255;return[l.join(","),c.join(","),h.join(",")]},Ih=function(e){if(g(this,qc)===void 0){T(this,qc,"");const r=g(this,_n).URL;r!==g(this,_n).baseURI&&(uv(r)?it('#createUrl: ignore "data:"-URL for performance reasons.'):T(this,qc,r.split("#",1)[0]))}return`url(${g(this,qc)}#${e})`},oO=function(e){const r=g(this,_n).createElementNS(Us,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(r)},Pw=function(e){const r=g(this,_n).createElementNS(Us,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(r)},Bh=function(e){const r=g(this,_n).createElementNS(Us,"filter");return r.setAttribute("color-interpolation-filters","sRGB"),r.setAttribute("id",e),g(this,Pe,Ph).append(r),r},M0=function(e,r,a){const s=g(this,_n).createElementNS(Us,r);s.setAttribute("type","discrete"),s.setAttribute("tableValues",a),e.append(s)},L0=function(e,r,a,s){const l=g(this,_n).createElementNS(Us,"feComponentTransfer");s.append(l),D(this,Pe,M0).call(this,l,"feFuncR",e),D(this,Pe,M0).call(this,l,"feFuncG",r),D(this,Pe,M0).call(this,l,"feFuncB",a)},Iw=function(e,r){const a=g(this,_n).createElementNS(Us,"feComponentTransfer");r.append(a),D(this,Pe,M0).call(this,a,"feFuncA",e)},N0=function(e){return g(this,Pe,Ph).style.color=e,xE(getComputedStyle(g(this,Pe,Ph)).getPropertyValue("color"))};class lO{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(r=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){It("Abstract method `_fetch` called.")}}class cO extends lO{async _fetch(t){const e=await cv(t,"arraybuffer");return new Uint8Array(e)}}Sn&&it("Please use the `legacy` build in Node.js environments.");async function uO(n){const e=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(e)}class DH extends sO{}class FH extends nO{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class MH extends aO{async _fetch(t){return uO(t)}}class LH extends lO{async _fetch(t){return uO(t)}}const En={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Bw(n,t){if(!t)return;const e=t[2]-t[0],r=t[3]-t[1],a=new Path2D;a.rect(t[0],t[1],e,r),n.clip(a)}class _E{getPattern(){It("Abstract method `getPattern` called.")}}class NH extends _E{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const r of this._colorStops)e.addColorStop(r[0],r[1]);return e}getPattern(t,e,r,a){let s;if(a===En.STROKE||a===En.FILL){const l=e.current.getClippedPathBoundingBox(a,Kt(t))||[0,0,0,0],c=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,f=e.cachedCanvases.getCanvas("pattern",c,h),d=f.context;d.clearRect(0,0,d.canvas.width,d.canvas.height),d.beginPath(),d.rect(0,0,d.canvas.width,d.canvas.height),d.translate(-l[0],-l[1]),r=je.transform(r,[1,0,0,1,l[0],l[1]]),d.transform(...e.baseTransform),this.matrix&&d.transform(...this.matrix),Bw(d,this._bbox),d.fillStyle=this._createGradient(d),d.fill(),s=t.createPattern(f.canvas,"no-repeat");const m=new DOMMatrix(r);s.setTransform(m)}else Bw(t,this._bbox),s=this._createGradient(t);return s}}function Vy(n,t,e,r,a,s,l,c){const h=t.coords,f=t.colors,d=n.data,m=n.width*4;let x;h[e+1]>h[r+1]&&(x=e,e=r,r=x,x=s,s=l,l=x),h[r+1]>h[a+1]&&(x=r,r=a,a=x,x=l,l=c,c=x),h[e+1]>h[r+1]&&(x=e,e=r,r=x,x=s,s=l,l=x);const _=(h[e]+t.offsetX)*t.scaleX,y=(h[e+1]+t.offsetY)*t.scaleY,A=(h[r]+t.offsetX)*t.scaleX,E=(h[r+1]+t.offsetY)*t.scaleY,b=(h[a]+t.offsetX)*t.scaleX,C=(h[a+1]+t.offsetY)*t.scaleY;if(y>=C)return;const S=f[s],O=f[s+1],L=f[s+2],I=f[l],F=f[l+1],W=f[l+2],B=f[c],ee=f[c+1],Z=f[c+2],te=Math.round(y),ve=Math.round(C);let Ce,Ee,J,oe,De,ae,V,fe;for(let U=te;U<=ve;U++){if(U<E){const _e=U<y?0:(y-U)/(y-E);Ce=_-(_-A)*_e,Ee=S-(S-I)*_e,J=O-(O-F)*_e,oe=L-(L-W)*_e}else{let _e;U>C?_e=1:E===C?_e=0:_e=(E-U)/(E-C),Ce=A-(A-b)*_e,Ee=I-(I-B)*_e,J=F-(F-ee)*_e,oe=W-(W-Z)*_e}let Q;U<y?Q=0:U>C?Q=1:Q=(y-U)/(y-C),De=_-(_-b)*Q,ae=S-(S-B)*Q,V=O-(O-ee)*Q,fe=L-(L-Z)*Q;const X=Math.round(Math.min(Ce,De)),K=Math.round(Math.max(Ce,De));let se=m*U+X*4;for(let _e=X;_e<=K;_e++)Q=(Ce-_e)/(Ce-De),Q<0?Q=0:Q>1&&(Q=1),d[se++]=Ee-(Ee-ae)*Q|0,d[se++]=J-(J-V)*Q|0,d[se++]=oe-(oe-fe)*Q|0,d[se++]=255}}function PH(n,t,e){const r=t.coords,a=t.colors;let s,l;switch(t.type){case"lattice":const c=t.verticesPerRow,h=Math.floor(r.length/c)-1,f=c-1;for(s=0;s<h;s++){let d=s*c;for(let m=0;m<f;m++,d++)Vy(n,e,r[d],r[d+1],r[d+c],a[d],a[d+1],a[d+c]),Vy(n,e,r[d+c+1],r[d+1],r[d+c],a[d+c+1],a[d+1],a[d+c])}break;case"triangles":for(s=0,l=r.length;s<l;s+=3)Vy(n,e,r[s],r[s+1],r[s+2],a[s],a[s+1],a[s+2]);break;default:throw new Error("illegal figure")}}class IH extends _E{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[7],this._background=t[8],this.matrix=null}_createMeshCanvas(t,e,r){const c=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-c,d=Math.ceil(this._bounds[3])-h,m=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),x=Math.min(Math.ceil(Math.abs(d*t[1]*1.1)),3e3),_=f/m,y=d/x,A={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-h,scaleX:1/_,scaleY:1/y},E=m+2*2,b=x+2*2,C=r.getCanvas("mesh",E,b),S=C.context,O=S.createImageData(m,x);if(e){const I=O.data;for(let F=0,W=I.length;F<W;F+=4)I[F]=e[0],I[F+1]=e[1],I[F+2]=e[2],I[F+3]=255}for(const I of this._figures)PH(O,I,A);return S.putImageData(O,2,2),{canvas:C.canvas,offsetX:c-2*_,offsetY:h-2*y,scaleX:_,scaleY:y}}getPattern(t,e,r,a){Bw(t,this._bbox);let s;if(a===En.SHADING)s=je.singularValueDecompose2dScale(Kt(t));else if(s=je.singularValueDecompose2dScale(e.baseTransform),this.matrix){const c=je.singularValueDecompose2dScale(this.matrix);s=[s[0]*c[0],s[1]*c[1]]}const l=this._createMeshCanvas(s,a===En.SHADING?null:this._background,e.cachedCanvases);return a!==En.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(l.offsetX,l.offsetY),t.scale(l.scaleX,l.scaleY),t.createPattern(l.canvas,"no-repeat")}}class BH extends _E{getPattern(){return"hotpink"}}function UH(n){switch(n[0]){case"RadialAxial":return new NH(n);case"Mesh":return new IH(n);case"Dummy":return new BH}throw new Error(`Unknown IR type: ${n[0]}`)}const $k={COLORED:1,UNCOLORED:2},Ux=class Ux{constructor(t,e,r,a,s){this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.color=e,this.ctx=r,this.canvasGraphicsFactory=a,this.baseTransform=s}createPatternCanvas(t){const{bbox:e,operatorList:r,paintType:a,tilingType:s,color:l,canvasGraphicsFactory:c}=this;let{xstep:h,ystep:f}=this;h=Math.abs(h),f=Math.abs(f),ov("TilingType: "+s);const d=e[0],m=e[1],x=e[2],_=e[3],y=x-d,A=_-m,E=je.singularValueDecompose2dScale(this.matrix),b=je.singularValueDecompose2dScale(this.baseTransform),C=E[0]*b[0],S=E[1]*b[1];let O=y,L=A,I=!1,F=!1;const W=Math.ceil(h*C),B=Math.ceil(f*S),ee=Math.ceil(y*C),Z=Math.ceil(A*S);W>=ee?O=h:I=!0,B>=Z?L=f:F=!0;const te=this.getSizeAndScale(O,this.ctx.canvas.width,C),ve=this.getSizeAndScale(L,this.ctx.canvas.height,S),Ce=t.cachedCanvases.getCanvas("pattern",te.size,ve.size),Ee=Ce.context,J=c.createCanvasGraphics(Ee);if(J.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(J,a,l),Ee.translate(-te.scale*d,-ve.scale*m),J.transform(te.scale,0,0,ve.scale,0,0),Ee.save(),this.clipBbox(J,d,m,x,_),J.baseTransform=Kt(J.ctx),J.executeOperatorList(r),J.endDrawing(),Ee.restore(),I||F){const oe=Ce.canvas;I&&(O=h),F&&(L=f);const De=this.getSizeAndScale(O,this.ctx.canvas.width,C),ae=this.getSizeAndScale(L,this.ctx.canvas.height,S),V=De.size,fe=ae.size,U=t.cachedCanvases.getCanvas("pattern-workaround",V,fe),Q=U.context,X=I?Math.floor(y/h):0,K=F?Math.floor(A/f):0;for(let se=0;se<=X;se++)for(let _e=0;_e<=K;_e++)Q.drawImage(oe,V*se,fe*_e,V,fe,0,0,V,fe);return{canvas:U.canvas,scaleX:De.scale,scaleY:ae.scale,offsetX:d,offsetY:m}}return{canvas:Ce.canvas,scaleX:te.scale,scaleY:ve.scale,offsetX:d,offsetY:m}}getSizeAndScale(t,e,r){const a=Math.max(Ux.MAX_PATTERN_SIZE,e);let s=Math.ceil(t*r);return s>=a?s=a:r=s/t,{scale:r,size:s}}clipBbox(t,e,r,a,s){const l=a-e,c=s-r;t.ctx.rect(e,r,l,c),t.current.updateRectMinMax(Kt(t.ctx),[e,r,a,s]),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,r){const a=t.ctx,s=t.current;switch(e){case $k.COLORED:const l=this.ctx;a.fillStyle=l.fillStyle,a.strokeStyle=l.strokeStyle,s.fillColor=l.fillStyle,s.strokeColor=l.strokeStyle;break;case $k.UNCOLORED:const c=je.makeHexColor(r[0],r[1],r[2]);a.fillStyle=c,a.strokeStyle=c,s.fillColor=c,s.strokeColor=c;break;default:throw new hH(`Unsupported paint type: ${e}`)}}getPattern(t,e,r,a){let s=r;a!==En.SHADING&&(s=je.transform(s,e.baseTransform),this.matrix&&(s=je.transform(s,this.matrix)));const l=this.createPatternCanvas(e);let c=new DOMMatrix(s);c=c.translate(l.offsetX,l.offsetY),c=c.scale(1/l.scaleX,1/l.scaleY);const h=t.createPattern(l.canvas,"repeat");return h.setTransform(c),h}};Ve(Ux,"MAX_PATTERN_SIZE",3e3);let Uw=Ux;function HH({src:n,srcPos:t=0,dest:e,width:r,height:a,nonBlackColor:s=4294967295,inverseDecode:l=!1}){const c=Vn.isLittleEndian?4278190080:255,[h,f]=l?[s,c]:[c,s],d=r>>3,m=r&7,x=n.length;e=new Uint32Array(e.buffer);let _=0;for(let y=0;y<a;y++){for(const E=t+d;t<E;t++){const b=t<x?n[t]:255;e[_++]=b&128?f:h,e[_++]=b&64?f:h,e[_++]=b&32?f:h,e[_++]=b&16?f:h,e[_++]=b&8?f:h,e[_++]=b&4?f:h,e[_++]=b&2?f:h,e[_++]=b&1?f:h}if(m===0)continue;const A=t<x?n[t++]:255;for(let E=0;E<m;E++)e[_++]=A&1<<7-E?f:h}return{srcPos:t,destPos:_}}const Xk=16,qk=100,zH=15,Yk=10,Wk=1e3,oa=16;function jH(n,t){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){t.save(),this.__originalSave()},n.restore=function(){t.restore(),this.__originalRestore()},n.translate=function(r,a){t.translate(r,a),this.__originalTranslate(r,a)},n.scale=function(r,a){t.scale(r,a),this.__originalScale(r,a)},n.transform=function(r,a,s,l,c,h){t.transform(r,a,s,l,c,h),this.__originalTransform(r,a,s,l,c,h)},n.setTransform=function(r,a,s,l,c,h){t.setTransform(r,a,s,l,c,h),this.__originalSetTransform(r,a,s,l,c,h)},n.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},n.rotate=function(r){t.rotate(r),this.__originalRotate(r)},n.clip=function(r){t.clip(r),this.__originalClip(r)},n.moveTo=function(e,r){t.moveTo(e,r),this.__originalMoveTo(e,r)},n.lineTo=function(e,r){t.lineTo(e,r),this.__originalLineTo(e,r)},n.bezierCurveTo=function(e,r,a,s,l,c){t.bezierCurveTo(e,r,a,s,l,c),this.__originalBezierCurveTo(e,r,a,s,l,c)},n.rect=function(e,r,a,s){t.rect(e,r,a,s),this.__originalRect(e,r,a,s)},n.closePath=function(){t.closePath(),this.__originalClosePath()},n.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class GH{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,r){let a;return this.cache[t]!==void 0?(a=this.cache[t],this.canvasFactory.reset(a,e,r)):(a=this.canvasFactory.create(e,r),this.cache[t]=a),a}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function O1(n,t,e,r,a,s,l,c,h,f){const[d,m,x,_,y,A]=Kt(n);if(m===0&&x===0){const C=l*d+y,S=Math.round(C),O=c*_+A,L=Math.round(O),I=(l+h)*d+y,F=Math.abs(Math.round(I)-S)||1,W=(c+f)*_+A,B=Math.abs(Math.round(W)-L)||1;return n.setTransform(Math.sign(d),0,0,Math.sign(_),S,L),n.drawImage(t,e,r,a,s,0,0,F,B),n.setTransform(d,m,x,_,y,A),[F,B]}if(d===0&&_===0){const C=c*x+y,S=Math.round(C),O=l*m+A,L=Math.round(O),I=(c+f)*x+y,F=Math.abs(Math.round(I)-S)||1,W=(l+h)*m+A,B=Math.abs(Math.round(W)-L)||1;return n.setTransform(0,Math.sign(m),Math.sign(x),0,S,L),n.drawImage(t,e,r,a,s,0,0,B,F),n.setTransform(d,m,x,_,y,A),[B,F]}n.drawImage(t,e,r,a,s,l,c,h,f);const E=Math.hypot(d,m),b=Math.hypot(x,_);return[E*h,b*f]}function VH(n){const{width:t,height:e}=n;if(t>Wk||e>Wk)return null;const r=1e3,a=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),s=t+1;let l=new Uint8Array(s*(e+1)),c,h,f;const d=t+7&-8;let m=new Uint8Array(d*e),x=0;for(const b of n.data){let C=128;for(;C>0;)m[x++]=b&C?0:255,C>>=1}let _=0;for(x=0,m[x]!==0&&(l[0]=1,++_),h=1;h<t;h++)m[x]!==m[x+1]&&(l[h]=m[x]?2:1,++_),x++;for(m[x]!==0&&(l[h]=2,++_),c=1;c<e;c++){x=c*d,f=c*s,m[x-d]!==m[x]&&(l[f]=m[x]?1:8,++_);let b=(m[x]?4:0)+(m[x-d]?8:0);for(h=1;h<t;h++)b=(b>>2)+(m[x+1]?4:0)+(m[x-d+1]?8:0),a[b]&&(l[f+h]=a[b],++_),x++;if(m[x-d]!==m[x]&&(l[f+h]=m[x]?2:4,++_),_>r)return null}for(x=d*(e-1),f=c*s,m[x]!==0&&(l[f]=8,++_),h=1;h<t;h++)m[x]!==m[x+1]&&(l[f+h]=m[x]?4:8,++_),x++;if(m[x]!==0&&(l[f+h]=4,++_),_>r)return null;const y=new Int32Array([0,s,-1,0,-s,0,0,0,1]),A=new Path2D;for(c=0;_&&c<=e;c++){let b=c*s;const C=b+t;for(;b<C&&!l[b];)b++;if(b===C)continue;A.moveTo(b%s,c);const S=b;let O=l[b];do{const L=y[O];do b+=L;while(!l[b]);const I=l[b];I!==5&&I!==10?(O=I,l[b]=0):(O=I&51*O>>4,l[b]&=O>>2|O<<2),A.lineTo(b%s,b/s|0),l[b]||--_}while(S!==b);--c}return m=null,l=null,function(b){b.save(),b.scale(1/t,-1/e),b.translate(0,-e),b.fill(A),b.beginPath(),b.restore()}}class Kk{constructor(t,e){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=y4,this.textMatrixScale=1,this.fontMatrix=dw,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=gn.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,t,e])}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t}setCurrentPoint(t,e){this.x=t,this.y=e}updatePathMinMax(t,e,r){[e,r]=je.applyTransform([e,r],t),this.minX=Math.min(this.minX,e),this.minY=Math.min(this.minY,r),this.maxX=Math.max(this.maxX,e),this.maxY=Math.max(this.maxY,r)}updateRectMinMax(t,e){const r=je.applyTransform(e,t),a=je.applyTransform(e.slice(2),t),s=je.applyTransform([e[0],e[3]],t),l=je.applyTransform([e[2],e[1]],t);this.minX=Math.min(this.minX,r[0],a[0],s[0],l[0]),this.minY=Math.min(this.minY,r[1],a[1],s[1],l[1]),this.maxX=Math.max(this.maxX,r[0],a[0],s[0],l[0]),this.maxY=Math.max(this.maxY,r[1],a[1],s[1],l[1])}updateScalingPathMinMax(t,e){je.scaleMinMax(t,e),this.minX=Math.min(this.minX,e[0]),this.minY=Math.min(this.minY,e[1]),this.maxX=Math.max(this.maxX,e[2]),this.maxY=Math.max(this.maxY,e[3])}updateCurvePathMinMax(t,e,r,a,s,l,c,h,f,d){const m=je.bezierBoundingBox(e,r,a,s,l,c,h,f,d);d||this.updateRectMinMax(t,m)}getPathBoundingBox(t=En.FILL,e=null){const r=[this.minX,this.minY,this.maxX,this.maxY];if(t===En.STROKE){e||It("Stroke bounding box must include transform.");const a=je.singularValueDecompose2dScale(e),s=a[0]*this.lineWidth/2,l=a[1]*this.lineWidth/2;r[0]-=s,r[1]-=l,r[2]+=s,r[3]+=l}return r}updateClipFromPath(){const t=je.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(t){this.clipBox=t,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(t=En.FILL,e=null){return je.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function Qk(n,t){if(t instanceof ImageData){n.putImageData(t,0,0);return}const e=t.height,r=t.width,a=e%oa,s=(e-a)/oa,l=a===0?s:s+1,c=n.createImageData(r,oa);let h=0,f;const d=t.data,m=c.data;let x,_,y,A;if(t.kind===N1.GRAYSCALE_1BPP){const E=d.byteLength,b=new Uint32Array(m.buffer,0,m.byteLength>>2),C=b.length,S=r+7>>3,O=4294967295,L=Vn.isLittleEndian?4278190080:255;for(x=0;x<l;x++){for(y=x<s?oa:a,f=0,_=0;_<y;_++){const I=E-h;let F=0;const W=I>S?r:I*8-7,B=W&-8;let ee=0,Z=0;for(;F<B;F+=8)Z=d[h++],b[f++]=Z&128?O:L,b[f++]=Z&64?O:L,b[f++]=Z&32?O:L,b[f++]=Z&16?O:L,b[f++]=Z&8?O:L,b[f++]=Z&4?O:L,b[f++]=Z&2?O:L,b[f++]=Z&1?O:L;for(;F<W;F++)ee===0&&(Z=d[h++],ee=128),b[f++]=Z&ee?O:L,ee>>=1}for(;f<C;)b[f++]=0;n.putImageData(c,0,x*oa)}}else if(t.kind===N1.RGBA_32BPP){for(_=0,A=r*oa*4,x=0;x<s;x++)m.set(d.subarray(h,h+A)),h+=A,n.putImageData(c,0,_),_+=oa;x<l&&(A=r*a*4,m.set(d.subarray(h,h+A)),n.putImageData(c,0,_))}else if(t.kind===N1.RGB_24BPP)for(y=oa,A=r*y,x=0;x<l;x++){for(x>=s&&(y=a,A=r*y),f=0,_=A;_--;)m[f++]=d[h++],m[f++]=d[h++],m[f++]=d[h++],m[f++]=255;n.putImageData(c,0,x*oa)}else throw new Error(`bad image kind: ${t.kind}`)}function Zk(n,t){if(t.bitmap){n.drawImage(t.bitmap,0,0);return}const e=t.height,r=t.width,a=e%oa,s=(e-a)/oa,l=a===0?s:s+1,c=n.createImageData(r,oa);let h=0;const f=t.data,d=c.data;for(let m=0;m<l;m++){const x=m<s?oa:a;({srcPos:h}=HH({src:f,srcPos:h,dest:d,width:r,height:x,nonBlackColor:0})),n.putImageData(c,0,m*oa)}}function _0(n,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const r of e)n[r]!==void 0&&(t[r]=n[r]);n.setLineDash!==void 0&&(t.setLineDash(n.getLineDash()),t.lineDashOffset=n.lineDashOffset)}function D1(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!Sn){const{filter:t}=n;t!=="none"&&t!==""&&(n.filter="none")}}function Jk(n,t){if(t)return!0;const e=je.singularValueDecompose2dScale(n);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const r=Math.fround((globalThis.devicePixelRatio||1)*Vl.PDF_TO_CSS_UNITS);return e[0]<=r&&e[1]<=r}const $H=["butt","round","square"],XH=["miter","round","bevel"],qH={},eC={};var Ui,Hw,zw,jw;const bE=class bE{constructor(t,e,r,a,s,{optionalContentConfig:l,markedContentStack:c=null},h,f){R(this,Ui);this.ctx=t,this.current=new Kk(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=r,this.canvasFactory=a,this.filterFactory=s,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=l,this.cachedCanvases=new GH(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(t,e=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):e}beginDrawing({transform:t,viewport:e,transparency:r=!1,background:a=null}){const s=this.ctx.canvas.width,l=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=a||"#ffffff",this.ctx.fillRect(0,0,s,l),this.ctx.fillStyle=c,r){const h=this.cachedCanvases.getCanvas("transparent",s,l);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Kt(this.compositeCtx))}this.ctx.save(),D1(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Kt(this.ctx)}executeOperatorList(t,e,r,a){const s=t.argsArray,l=t.fnArray;let c=e||0;const h=s.length;if(h===c)return c;const f=h-c>Yk&&typeof r=="function",d=f?Date.now()+zH:0;let m=0;const x=this.commonObjs,_=this.objs;let y;for(;;){if(a!==void 0&&c===a.nextBreakPoint)return a.breakIt(c,r),c;if(y=l[c],y!==_i.dependency)this[y].apply(this,s[c]);else for(const A of s[c]){const E=A.startsWith("g_")?x:_;if(!E.has(A))return E.get(A,r),c}if(c++,c===h)return c;if(f&&++m>Yk){if(Date.now()>d)return r(),c;m=0}}}endDrawing(){D(this,Ui,Hw).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),D(this,Ui,zw).call(this)}_scaleImage(t,e){const r=t.width??t.displayWidth,a=t.height??t.displayHeight;let s=Math.max(Math.hypot(e[0],e[1]),1),l=Math.max(Math.hypot(e[2],e[3]),1),c=r,h=a,f="prescale1",d,m;for(;s>2&&c>1||l>2&&h>1;){let x=c,_=h;s>2&&c>1&&(x=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),s/=c/x),l>2&&h>1&&(_=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,l/=h/_),d=this.cachedCanvases.getCanvas(f,x,_),m=d.context,m.clearRect(0,0,x,_),m.drawImage(t,0,0,c,h,0,0,x,_),t=d.canvas,c=x,h=_,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:c,paintHeight:h}}_createMaskCanvas(t){const e=this.ctx,{width:r,height:a}=t,s=this.current.fillColor,l=this.current.patternFill,c=Kt(e);let h,f,d,m;if((t.bitmap||t.data)&&t.count>1){const W=t.bitmap||t.data.buffer;f=JSON.stringify(l?c:[c.slice(0,4),s]),h=this._cachedBitmapsMap.get(W),h||(h=new Map,this._cachedBitmapsMap.set(W,h));const B=h.get(f);if(B&&!l){const ee=Math.round(Math.min(c[0],c[2])+c[4]),Z=Math.round(Math.min(c[1],c[3])+c[5]);return{canvas:B,offsetX:ee,offsetY:Z}}d=B}d||(m=this.cachedCanvases.getCanvas("maskCanvas",r,a),Zk(m.context,t));let x=je.transform(c,[1/r,0,0,-1/a,0,0]);x=je.transform(x,[1,0,0,1,0,-a]);const[_,y,A,E]=je.getAxialAlignedBoundingBox([0,0,r,a],x),b=Math.round(A-_)||1,C=Math.round(E-y)||1,S=this.cachedCanvases.getCanvas("fillCanvas",b,C),O=S.context,L=_,I=y;O.translate(-L,-I),O.transform(...x),d||(d=this._scaleImage(m.canvas,Wi(O)),d=d.img,h&&l&&h.set(f,d)),O.imageSmoothingEnabled=Jk(Kt(O),t.interpolate),O1(O,d,0,0,d.width,d.height,0,0,r,a),O.globalCompositeOperation="source-in";const F=je.transform(Wi(O),[1,0,0,1,-L,-I]);return O.fillStyle=l?s.getPattern(e,this,F,En.FILL):s,O.fillRect(0,0,r,a),h&&!l&&(this.cachedCanvases.delete("fillCanvas"),h.set(f,S.canvas)),{canvas:S.canvas,offsetX:Math.round(L),offsetY:Math.round(I)}}setLineWidth(t){t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(t){this.ctx.lineCap=$H[t]}setLineJoin(t){this.ctx.lineJoin=XH[t]}setMiterLimit(t){this.ctx.miterLimit=t}setDash(t,e){const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(t),r.lineDashOffset=e)}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[e,r]of t)switch(e){case"LW":this.setLineWidth(r);break;case"LC":this.setLineCap(r);break;case"LJ":this.setLineJoin(r);break;case"ML":this.setMiterLimit(r);break;case"D":this.setDash(r[0],r[1]);break;case"RI":this.setRenderingIntent(r);break;case"FL":this.setFlatness(r);break;case"Font":this.setFont(r[0],r[1]);break;case"CA":this.current.strokeAlpha=r;break;case"ca":this.current.fillAlpha=r,this.ctx.globalAlpha=r;break;case"BM":this.ctx.globalCompositeOperation=r;break;case"SMask":this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,e=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,a=this.cachedCanvases.getCanvas(r,t,e);this.suspendedCtx=this.ctx,this.ctx=a.context;const s=this.ctx;s.setTransform(...Kt(this.suspendedCtx)),_0(this.suspendedCtx,s),jH(s,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),_0(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,r=this.suspendedCtx;this.composeSMask(r,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,r,a){const s=a[0],l=a[1],c=a[2]-s,h=a[3]-l;c===0||h===0||(this.genericComposeSMask(e.context,r,c,h,e.subtype,e.backdrop,e.transferMap,s,l,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(r.canvas,0,0),t.restore())}genericComposeSMask(t,e,r,a,s,l,c,h,f,d,m){let x=t.canvas,_=h-d,y=f-m;if(l){const E=je.makeHexColor(...l);if(_<0||y<0||_+r>x.width||y+a>x.height){const b=this.cachedCanvases.getCanvas("maskExtension",r,a),C=b.context;C.drawImage(x,-_,-y),C.globalCompositeOperation="destination-atop",C.fillStyle=E,C.fillRect(0,0,r,a),C.globalCompositeOperation="source-over",x=b.canvas,_=y=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const b=new Path2D;b.rect(_,y,r,a),t.clip(b),t.globalCompositeOperation="destination-atop",t.fillStyle=E,t.fillRect(_,y,r,a),t.restore()}}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),s==="Alpha"&&c?e.filter=this.filterFactory.addAlphaFilter(c):s==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(c));const A=new Path2D;A.rect(h,f,r,a),e.clip(A),e.globalCompositeOperation="destination-in",e.drawImage(x,_,y,r,a,h,f,r,a),e.restore()}save(){this.inSMaskMode?(_0(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),_0(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(t,e,r,a,s,l){this.ctx.transform(t,e,r,a,s,l),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,r){const a=this.ctx,s=this.current;let l=s.x,c=s.y,h,f;const d=Kt(a),m=d[0]===0&&d[3]===0||d[1]===0&&d[2]===0,x=m?r.slice(0):null;for(let _=0,y=0,A=t.length;_<A;_++)switch(t[_]|0){case _i.rectangle:l=e[y++],c=e[y++];const E=e[y++],b=e[y++],C=l+E,S=c+b;a.moveTo(l,c),E===0||b===0?a.lineTo(C,S):(a.lineTo(C,c),a.lineTo(C,S),a.lineTo(l,S)),m||s.updateRectMinMax(d,[l,c,C,S]),a.closePath();break;case _i.moveTo:l=e[y++],c=e[y++],a.moveTo(l,c),m||s.updatePathMinMax(d,l,c);break;case _i.lineTo:l=e[y++],c=e[y++],a.lineTo(l,c),m||s.updatePathMinMax(d,l,c);break;case _i.curveTo:h=l,f=c,l=e[y+4],c=e[y+5],a.bezierCurveTo(e[y],e[y+1],e[y+2],e[y+3],l,c),s.updateCurvePathMinMax(d,h,f,e[y],e[y+1],e[y+2],e[y+3],l,c,x),y+=6;break;case _i.curveTo2:h=l,f=c,a.bezierCurveTo(l,c,e[y],e[y+1],e[y+2],e[y+3]),s.updateCurvePathMinMax(d,h,f,l,c,e[y],e[y+1],e[y+2],e[y+3],x),l=e[y+2],c=e[y+3],y+=4;break;case _i.curveTo3:h=l,f=c,l=e[y+2],c=e[y+3],a.bezierCurveTo(e[y],e[y+1],l,c,l,c),s.updateCurvePathMinMax(d,h,f,e[y],e[y+1],l,c,l,c,x),y+=4;break;case _i.closePath:a.closePath();break}m&&s.updateScalingPathMinMax(d,x),s.setCurrentPoint(l,c)}closePath(){this.ctx.closePath()}stroke(t=!0){const e=this.ctx,r=this.current.strokeColor;e.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof r=="object"&&(r!=null&&r.getPattern)?(e.save(),e.strokeStyle=r.getPattern(e,this,Wi(e),En.STROKE),this.rescaleAndStroke(!1),e.restore()):this.rescaleAndStroke(!0)),t&&this.consumePath(this.current.getClippedPathBoundingBox()),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(t=!0){const e=this.ctx,r=this.current.fillColor,a=this.current.patternFill;let s=!1;a&&(e.save(),e.fillStyle=r.getPattern(e,this,Wi(e),En.FILL),s=!0);const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),s&&e.restore(),t&&this.consumePath(l)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=qH}eoClip(){this.pendingClip=eC}beginText(){this.current.textMatrix=y4,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const t=this.pendingTextPaths,e=this.ctx;if(t===void 0){e.beginPath();return}const r=new Path2D,a=e.getTransform().invertSelf();for(const{transform:s,x:l,y:c,fontSize:h,path:f}of t)r.addPath(f,new DOMMatrix(s).preMultiplySelf(a).translate(l,c).scale(h,-h));e.clip(r),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(t){this.current.charSpacing=t}setWordSpacing(t){this.current.wordSpacing=t}setHScale(t){this.current.textHScale=t/100}setLeading(t){this.current.leading=-t}setFont(t,e){var d;const r=this.commonObjs.get(t),a=this.current;if(!r)throw new Error(`Can't find font for ${t}`);if(a.fontMatrix=r.fontMatrix||dw,(a.fontMatrix[0]===0||a.fontMatrix[3]===0)&&it("Invalid font matrix for font "+t),e<0?(e=-e,a.fontDirection=-1):a.fontDirection=1,this.current.font=r,this.current.fontSize=e,r.isType3Font)return;const s=r.loadedName||"sans-serif",l=((d=r.systemFontInfo)==null?void 0:d.css)||`"${s}", ${r.fallbackName}`;let c="normal";r.black?c="900":r.bold&&(c="bold");const h=r.italic?"italic":"normal";let f=e;e<Xk?f=Xk:e>qk&&(f=qk),this.current.fontSizeScale=e/f,this.ctx.font=`${h} ${c} ${f}px ${l}`}setTextRenderingMode(t){this.current.textRenderingMode=t}setTextRise(t){this.current.textRise=t}moveText(t,e){this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=e}setLeadingMoveText(t,e){this.setLeading(-e),this.moveText(t,e)}setTextMatrix(t,e,r,a,s,l){this.current.textMatrix=[t,e,r,a,s,l],this.current.textMatrixScale=Math.hypot(t,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(t,e,r,a,s){const l=this.ctx,c=this.current,h=c.font,f=c.textRenderingMode,d=c.fontSize/c.fontSizeScale,m=f&gn.FILL_STROKE_MASK,x=!!(f&gn.ADD_TO_PATH_FLAG),_=c.patternFill&&!h.missingFile,y=c.patternStroke&&!h.missingFile;let A;if((h.disableFontFace||x||_||y)&&(A=h.getPathGenerator(this.commonObjs,t)),h.disableFontFace||_||y){if(l.save(),l.translate(e,r),l.scale(d,-d),m===gn.FILL||m===gn.FILL_STROKE)if(a){const E=l.getTransform();l.setTransform(...a),l.fill(D(this,Ui,jw).call(this,A,E,a))}else l.fill(A);if(m===gn.STROKE||m===gn.FILL_STROKE)if(s){const E=l.getTransform();l.setTransform(...s),l.stroke(D(this,Ui,jw).call(this,A,E,s))}else l.lineWidth/=d,l.stroke(A);l.restore()}else(m===gn.FILL||m===gn.FILL_STROKE)&&l.fillText(t,e,r),(m===gn.STROKE||m===gn.FILL_STROKE)&&l.strokeText(t,e,r);x&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Kt(l),x:e,y:r,fontSize:d,path:A})}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let r=!1;for(let a=3;a<e.length;a+=4)if(e[a]>0&&e[a]<255){r=!0;break}return ht(this,"isFontSubpixelAAEnabled",r)}showText(t){const e=this.current,r=e.font;if(r.isType3Font)return this.showType3Text(t);const a=e.fontSize;if(a===0)return;const s=this.ctx,l=e.fontSizeScale,c=e.charSpacing,h=e.wordSpacing,f=e.fontDirection,d=e.textHScale*f,m=t.length,x=r.vertical,_=x?1:-1,y=r.defaultVMetrics,A=a*e.fontMatrix[0],E=e.textRenderingMode===gn.FILL&&!r.disableFontFace&&!e.patternFill;s.save(),s.transform(...e.textMatrix),s.translate(e.x,e.y+e.textRise),f>0?s.scale(d,-1):s.scale(d,1);let b,C;if(e.patternFill){s.save();const F=e.fillColor.getPattern(s,this,Wi(s),En.FILL);b=Kt(s),s.restore(),s.fillStyle=F}if(e.patternStroke){s.save();const F=e.strokeColor.getPattern(s,this,Wi(s),En.STROKE);C=Kt(s),s.restore(),s.strokeStyle=F}let S=e.lineWidth;const O=e.textMatrixScale;if(O===0||S===0){const F=e.textRenderingMode&gn.FILL_STROKE_MASK;(F===gn.STROKE||F===gn.FILL_STROKE)&&(S=this.getSinglePixelWidth())}else S/=O;if(l!==1&&(s.scale(l,l),S/=l),s.lineWidth=S,r.isInvalidPDFjsFont){const F=[];let W=0;for(const B of t)F.push(B.unicode),W+=B.width;s.fillText(F.join(""),0,0),e.x+=W*A*d,s.restore(),this.compose();return}let L=0,I;for(I=0;I<m;++I){const F=t[I];if(typeof F=="number"){L+=_*F*a/1e3;continue}let W=!1;const B=(F.isSpace?h:0)+c,ee=F.fontChar,Z=F.accent;let te,ve,Ce=F.width;if(x){const J=F.vmetric||y,oe=-(F.vmetric?J[1]:Ce*.5)*A,De=J[2]*A;Ce=J?-J[0]:Ce,te=oe/l,ve=(L+De)/l}else te=L/l,ve=0;if(r.remeasure&&Ce>0){const J=s.measureText(ee).width*1e3/a*l;if(Ce<J&&this.isFontSubpixelAAEnabled){const oe=Ce/J;W=!0,s.save(),s.scale(oe,1),te/=oe}else Ce!==J&&(te+=(Ce-J)/2e3*a/l)}if(this.contentVisible&&(F.isInFont||r.missingFile)){if(E&&!Z)s.fillText(ee,te,ve);else if(this.paintChar(ee,te,ve,b,C),Z){const J=te+a*Z.offset.x/l,oe=ve-a*Z.offset.y/l;this.paintChar(Z.fontChar,J,oe,b,C)}}const Ee=x?Ce*A-B*f:Ce*A+B*f;L+=Ee,W&&s.restore()}x?e.y-=L:e.x+=L*d,s.restore(),this.compose()}showType3Text(t){const e=this.ctx,r=this.current,a=r.font,s=r.fontSize,l=r.fontDirection,c=a.vertical?1:-1,h=r.charSpacing,f=r.wordSpacing,d=r.textHScale*l,m=r.fontMatrix||dw,x=t.length,_=r.textRenderingMode===gn.INVISIBLE;let y,A,E,b;if(!(_||s===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,e.save(),e.transform(...r.textMatrix),e.translate(r.x,r.y),e.scale(d,l),y=0;y<x;++y){if(A=t[y],typeof A=="number"){b=c*A*s/1e3,this.ctx.translate(b,0),r.x+=b*d;continue}const C=(A.isSpace?f:0)+h,S=a.charProcOperatorList[A.operatorListId];if(!S){it(`Type3 character "${A.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=A,this.save(),e.scale(s,s),e.transform(...m),this.executeOperatorList(S),this.restore()),E=je.applyTransform([A.width,0],m)[0]*s+C,e.translate(E,0),r.x+=E*d}e.restore(),this.processingType3=null}}setCharWidth(t,e){}setCharWidthAndBounds(t,e,r,a,s,l){this.ctx.rect(r,a,s-r,l-a),this.ctx.clip(),this.endPath()}getColorN_Pattern(t){let e;if(t[0]==="TilingPattern"){const r=t[1],a=this.baseTransform||Kt(this.ctx),s={createCanvasGraphics:l=>new bE(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};e=new Uw(t,r,this.ctx,s,a)}else e=this._getPattern(t[1],t[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(t,e,r){this.ctx.strokeStyle=this.current.strokeColor=je.makeHexColor(t,e,r),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e,r){this.ctx.fillStyle=this.current.fillColor=je.makeHexColor(t,e,r),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e=null){let r;return this.cachedPatterns.has(t)?r=this.cachedPatterns.get(t):(r=UH(this.getObject(t)),this.cachedPatterns.set(t,r)),e&&(r.matrix=e),r}shadingFill(t){if(!this.contentVisible)return;const e=this.ctx;this.save();const r=this._getPattern(t);e.fillStyle=r.getPattern(e,this,Wi(e),En.SHADING);const a=Wi(e);{const{width:s,height:l}=e.canvas,[c,h,f,d]=je.getAxialAlignedBoundingBox([0,0,s,l],a);this.ctx.fillRect(c,h,f-c,d-h)}this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){It("Should not call beginInlineImage")}beginImageData(){It("Should not call beginImageData")}paintFormXObjectBegin(t,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),t&&this.transform(...t),this.baseTransform=Kt(this.ctx),e)){const r=e[2]-e[0],a=e[3]-e[1];this.ctx.rect(e[0],e[1],r,a),this.current.updateRectMinMax(Kt(this.ctx),e),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const e=this.ctx;t.isolated||ov("TODO: Support non-isolated groups."),t.knockout&&it("Knockout groups not supported.");const r=Kt(e);if(t.matrix&&e.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let a=je.getAxialAlignedBoundingBox(t.bbox,Kt(e));const s=[0,0,e.canvas.width,e.canvas.height];a=je.intersect(a,s)||[0,0,0,0];const l=Math.floor(a[0]),c=Math.floor(a[1]),h=Math.max(Math.ceil(a[2])-l,1),f=Math.max(Math.ceil(a[3])-c,1);this.current.startNewPathAndClipBox([0,0,h,f]);let d="groupAt"+this.groupLevel;t.smask&&(d+="_smask_"+this.smaskCounter++%2);const m=this.cachedCanvases.getCanvas(d,h,f),x=m.context;x.translate(-l,-c),x.transform(...r),t.smask?this.smaskStack.push({canvas:m.canvas,context:x,offsetX:l,offsetY:c,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(l,c),e.save()),_0(e,x),this.ctx=x,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++}endGroup(t){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,t.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const a=Kt(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...a);const s=je.getAxialAlignedBoundingBox([0,0,e.canvas.width,e.canvas.height],a);this.ctx.drawImage(e.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(t,e,r,a,s){if(D(this,Ui,Hw).call(this),D1(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),e){const l=e[2]-e[0],c=e[3]-e[1];if(s&&this.annotationCanvasMap){r=r.slice(),r[4]-=e[0],r[5]-=e[1],e=e.slice(),e[0]=e[1]=0,e[2]=l,e[3]=c;const[h,f]=je.singularValueDecompose2dScale(Kt(this.ctx)),{viewportScale:d}=this,m=Math.ceil(l*this.outputScaleX*d),x=Math.ceil(c*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(m,x);const{canvas:_,context:y}=this.annotationCanvas;this.annotationCanvasMap.set(t,_),this.annotationCanvas.savedCtx=this.ctx,this.ctx=y,this.ctx.save(),this.ctx.setTransform(h,0,0,-f,0,c*f),D1(this.ctx)}else D1(this.ctx),this.endPath(),this.ctx.rect(e[0],e[1],l,c),this.ctx.clip(),this.ctx.beginPath()}this.current=new Kk(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...r),this.transform(...a)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),D(this,Ui,zw).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t){if(!this.contentVisible)return;const e=t.count;t=this.getObject(t.data,t),t.count=e;const r=this.ctx,a=this.processingType3;if(a&&(a.compiled===void 0&&(a.compiled=VH(t)),a.compiled)){a.compiled(r);return}const s=this._createMaskCanvas(t),l=s.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(l,s.offsetX,s.offsetY),r.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,r=0,a=0,s,l){if(!this.contentVisible)return;t=this.getObject(t.data,t);const c=this.ctx;c.save();const h=Kt(c);c.transform(e,r,a,s,0,0);const f=this._createMaskCanvas(t);c.setTransform(1,0,0,1,f.offsetX-h[4],f.offsetY-h[5]);for(let d=0,m=l.length;d<m;d+=2){const x=je.transform(h,[e,r,a,s,l[d],l[d+1]]),[_,y]=je.applyTransform([0,0],x);c.drawImage(f.canvas,_,y)}c.restore(),this.compose()}paintImageMaskXObjectGroup(t){if(!this.contentVisible)return;const e=this.ctx,r=this.current.fillColor,a=this.current.patternFill;for(const s of t){const{data:l,width:c,height:h,transform:f}=s,d=this.cachedCanvases.getCanvas("maskCanvas",c,h),m=d.context;m.save();const x=this.getObject(l,s);Zk(m,x),m.globalCompositeOperation="source-in",m.fillStyle=a?r.getPattern(m,this,Wi(e),En.FILL):r,m.fillRect(0,0,c,h),m.restore(),e.save(),e.transform(...f),e.scale(1,-1),O1(e,d.canvas,0,0,c,h,0,-1,1,1),e.restore()}this.compose()}paintImageXObject(t){if(!this.contentVisible)return;const e=this.getObject(t);if(!e){it("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(t,e,r,a){if(!this.contentVisible)return;const s=this.getObject(t);if(!s){it("Dependent image isn't ready yet");return}const l=s.width,c=s.height,h=[];for(let f=0,d=a.length;f<d;f+=2)h.push({transform:[e,0,0,r,a[f],a[f+1]],x:0,y:0,w:l,h:c});this.paintInlineImageXObjectGroup(s,h)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:r,height:a}=t,s=this.cachedCanvases.getCanvas("inlineImage",r,a),l=s.context;return l.filter=this.current.transferMaps,l.drawImage(e,0,0),l.filter="none",s.canvas}paintInlineImageXObject(t){if(!this.contentVisible)return;const e=t.width,r=t.height,a=this.ctx;if(this.save(),!Sn){const{filter:c}=a;c!=="none"&&c!==""&&(a.filter="none")}a.scale(1/e,-1/r);let s;if(t.bitmap)s=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)s=t;else{const h=this.cachedCanvases.getCanvas("inlineImage",e,r).context;Qk(h,t),s=this.applyTransferMapsToCanvas(h)}const l=this._scaleImage(s,Wi(a));a.imageSmoothingEnabled=Jk(Kt(a),t.interpolate),O1(a,l.img,0,0,l.paintWidth,l.paintHeight,0,-r,e,r),this.compose(),this.restore()}paintInlineImageXObjectGroup(t,e){if(!this.contentVisible)return;const r=this.ctx;let a;if(t.bitmap)a=t.bitmap;else{const s=t.width,l=t.height,h=this.cachedCanvases.getCanvas("inlineImage",s,l).context;Qk(h,t),a=this.applyTransferMapsToCanvas(h)}for(const s of e)r.save(),r.transform(...s.transform),r.scale(1,-1),O1(r,a,s.x,s.y,s.w,s.h,0,-1,1,1),r.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t){}markPointProps(t,e){}beginMarkedContent(t){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e){t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(t){const e=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(t);const r=this.ctx;this.pendingClip&&(e||(this.pendingClip===eC?r.clip("evenodd"):r.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),r.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Kt(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),r=Math.hypot(t[0],t[2]),a=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(r,a)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:r,c:a,d:s}=this.ctx.getTransform();let l,c;if(r===0&&a===0){const h=Math.abs(e),f=Math.abs(s);if(h===f)if(t===0)l=c=1/h;else{const d=h*t;l=c=d<1?1/d:1}else if(t===0)l=1/h,c=1/f;else{const d=h*t,m=f*t;l=d<1?1/d:1,c=m<1?1/m:1}}else{const h=Math.abs(e*s-r*a),f=Math.hypot(e,r),d=Math.hypot(a,s);if(t===0)l=d/h,c=f/h;else{const m=t*h;l=d>m?d/m:1,c=f>m?f/m:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(t){const{ctx:e}=this,{lineWidth:r}=this.current,[a,s]=this.getScaleForStroking();if(e.lineWidth=r||1,a===1&&s===1){e.stroke();return}const l=e.getLineDash();if(t&&e.save(),e.scale(a,s),l.length>0){const c=Math.max(a,s);e.setLineDash(l.map(h=>h/c)),e.lineDashOffset/=c}e.stroke(),t&&e.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};Ui=new WeakSet,Hw=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},zw=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}},jw=function(t,e,r){const a=new Path2D;return a.addPath(t,new DOMMatrix(r).invertSelf().multiplySelf(e)),a};let Kh=bE;for(const n in _i)Kh.prototype[n]!==void 0&&(Kh.prototype[_i[n]]=Kh.prototype[n]);var Gp,Vp;class xo{static get workerPort(){return g(this,Gp)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");T(this,Gp,t)}static get workerSrc(){return g(this,Vp)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");T(this,Vp,t)}}Gp=new WeakMap,Vp=new WeakMap,R(xo,Gp,null),R(xo,Vp,"");var Kc,$p;class YH{constructor({parsedData:t,rawData:e}){R(this,Kc);R(this,$p);T(this,Kc,t),T(this,$p,e)}getRaw(){return g(this,$p)}get(t){return g(this,Kc).get(t)??null}getAll(){return fE(g(this,Kc))}has(t){return g(this,Kc).has(t)}}Kc=new WeakMap,$p=new WeakMap;const Uh=Symbol("INTERNAL");var Xp,qp,Yp,mf;class WH{constructor(t,{name:e,intent:r,usage:a,rbGroups:s}){R(this,Xp,!1);R(this,qp,!1);R(this,Yp,!1);R(this,mf,!0);T(this,Xp,!!(t&ka.DISPLAY)),T(this,qp,!!(t&ka.PRINT)),this.name=e,this.intent=r,this.usage=a,this.rbGroups=s}get visible(){if(g(this,Yp))return g(this,mf);if(!g(this,mf))return!1;const{print:t,view:e}=this.usage;return g(this,Xp)?(e==null?void 0:e.viewState)!=="OFF":g(this,qp)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,r=!1){t!==Uh&&It("Internal method `_setVisible` called."),T(this,Yp,r),T(this,mf,e)}}Xp=new WeakMap,qp=new WeakMap,Yp=new WeakMap,mf=new WeakMap;var vl,Dt,xf,vf,Wp,Gw;class KH{constructor(t,e=ka.DISPLAY){R(this,Wp);R(this,vl,null);R(this,Dt,new Map);R(this,xf,null);R(this,vf,null);if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,T(this,vf,t.order);for(const r of t.groups)g(this,Dt).set(r.id,new WH(e,r));if(t.baseState==="OFF")for(const r of g(this,Dt).values())r._setVisible(Uh,!1);for(const r of t.on)g(this,Dt).get(r)._setVisible(Uh,!0);for(const r of t.off)g(this,Dt).get(r)._setVisible(Uh,!1);T(this,xf,this.getHash())}}isVisible(t){if(g(this,Dt).size===0)return!0;if(!t)return ov("Optional content group not defined."),!0;if(t.type==="OCG")return g(this,Dt).has(t.id)?g(this,Dt).get(t.id).visible:(it(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return D(this,Wp,Gw).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!g(this,Dt).has(e))return it(`Optional content group not found: ${e}`),!0;if(g(this,Dt).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!g(this,Dt).has(e))return it(`Optional content group not found: ${e}`),!0;if(!g(this,Dt).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!g(this,Dt).has(e))return it(`Optional content group not found: ${e}`),!0;if(!g(this,Dt).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!g(this,Dt).has(e))return it(`Optional content group not found: ${e}`),!0;if(g(this,Dt).get(e).visible)return!1}return!0}return it(`Unknown optional content policy ${t.policy}.`),!0}return it(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,r=!0){var s;const a=g(this,Dt).get(t);if(!a){it(`Optional content group not found: ${t}`);return}if(r&&e&&a.rbGroups.length)for(const l of a.rbGroups)for(const c of l)c!==t&&((s=g(this,Dt).get(c))==null||s._setVisible(Uh,!1,!0));a._setVisible(Uh,!!e,!0),T(this,vl,null)}setOCGState({state:t,preserveRB:e}){let r;for(const a of t){switch(a){case"ON":case"OFF":case"Toggle":r=a;continue}const s=g(this,Dt).get(a);if(s)switch(r){case"ON":this.setVisibility(a,!0,e);break;case"OFF":this.setVisibility(a,!1,e);break;case"Toggle":this.setVisibility(a,!s.visible,e);break}}T(this,vl,null)}get hasInitialVisibility(){return g(this,xf)===null||this.getHash()===g(this,xf)}getOrder(){return g(this,Dt).size?g(this,vf)?g(this,vf).slice():[...g(this,Dt).keys()]:null}getGroups(){return g(this,Dt).size>0?fE(g(this,Dt)):null}getGroup(t){return g(this,Dt).get(t)||null}getHash(){if(g(this,vl)!==null)return g(this,vl);const t=new Q4;for(const[e,r]of g(this,Dt))t.update(`${e}:${r.visible}`);return T(this,vl,t.hexdigest())}}vl=new WeakMap,Dt=new WeakMap,xf=new WeakMap,vf=new WeakMap,Wp=new WeakSet,Gw=function(t){const e=t.length;if(e<2)return!0;const r=t[0];for(let a=1;a<e;a++){const s=t[a];let l;if(Array.isArray(s))l=D(this,Wp,Gw).call(this,s);else if(g(this,Dt).has(s))l=g(this,Dt).get(s).visible;else return it(`Optional content group not found: ${s}`),!0;switch(r){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return r==="And"};class QH{constructor(t,{disableRange:e=!1,disableStream:r=!1}){Tr(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:a,initialData:s,progressiveDone:l,contentDispositionFilename:c}=t;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=c,(s==null?void 0:s.length)>0){const h=s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!r,this._isRangeSupported=!e,this._contentLength=a,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),t.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const r=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(r):this._queuedChunks.push(r);else{const a=this._rangeReaders.some(function(s){return s._begin!==t?!1:(s._enqueue(r),!0)});Tr(a,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,r,a,s;t.total===void 0?(r=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||r.call(e,{loaded:t.loaded}):(s=(a=this._fullRequestReader)==null?void 0:a.onProgress)==null||s.call(a,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Tr(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new ZH(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const r=new JH(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(r),r}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const r of this._rangeReaders.slice(0))r.cancel(t);this._pdfDataRangeTransport.abort()}}class ZH{constructor(t,e,r=!1,a=null){this._stream=t,this._done=r||!1,this._filename=gE(a)?a:null,this._queuedChunks=e||[],this._loaded=0;for(const s of this._queuedChunks)this._loaded+=s.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class JH{constructor(t,e,r){this._stream=t,this._begin=e,this._end=r,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function ez(n){let t=!0,e=r("filename\\*","i").exec(n);if(e){e=e[1];let d=c(e);return d=unescape(d),d=h(d),d=f(d),s(d)}if(e=l(n),e){const d=f(e);return s(d)}if(e=r("filename","i").exec(n),e){e=e[1];let d=c(e);return d=f(d),s(d)}function r(d,m){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',m)}function a(d,m){if(d){if(!/^[\x00-\xFF]+$/.test(m))return m;try{const x=new TextDecoder(d,{fatal:!0}),_=lv(m);m=x.decode(_),t=!1}catch{}}return m}function s(d){return t&&/[\x80-\xff]/.test(d)&&(d=a("utf-8",d),t&&(d=a("iso-8859-1",d))),d}function l(d){const m=[];let x;const _=r("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(x=_.exec(d))!==null;){let[,A,E,b]=x;if(A=parseInt(A,10),A in m){if(A===0)break;continue}m[A]=[E,b]}const y=[];for(let A=0;A<m.length&&A in m;++A){let[E,b]=m[A];b=c(b),E&&(b=unescape(b),A===0&&(b=h(b))),y.push(b)}return y.join("")}function c(d){if(d.startsWith('"')){const m=d.slice(1).split('\\"');for(let x=0;x<m.length;++x){const _=m[x].indexOf('"');_!==-1&&(m[x]=m[x].slice(0,_),m.length=x+1),m[x]=m[x].replaceAll(/\\(.)/g,"$1")}d=m.join('"')}return d}function h(d){const m=d.indexOf("'");if(m===-1)return d;const x=d.slice(0,m),y=d.slice(m+1).replace(/^[^']*'/,"");return a(x,y)}function f(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(m,x,_,y){if(_==="q"||_==="Q")return y=y.replaceAll("_"," "),y=y.replaceAll(/=([0-9a-fA-F]{2})/g,function(A,E){return String.fromCharCode(parseInt(E,16))}),a(x,y);try{y=atob(y)}catch{}return a(x,y)})}return""}function hO(n,t){const e=new Headers;if(!n||!t||typeof t!="object")return e;for(const r in t){const a=t[r];a!==void 0&&e.append(r,a)}return e}function hv(n){try{return new URL(n).origin}catch{}return null}function fO({responseHeaders:n,isHttp:t,rangeChunkSize:e,disableRange:r}){const a={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(n.get("Content-Length"),10);return!Number.isInteger(s)||(a.suggestedLength=s,s<=2*e)||r||!t||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(a.allowRangeRequests=!0),a}function dO(n){const t=n.get("Content-Disposition");if(t){let e=ez(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(gE(e))return e}return null}function fv(n,t){return n===404||n===0&&t.startsWith("file:")?new fp('Missing PDF "'+t+'".'):new bx(`Unexpected server response (${n}) while retrieving PDF "${t}".`,n)}function pO(n){return n===200||n===206}function gO(n,t,e){return{method:"GET",headers:n,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function mO(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(it(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class tC{constructor(t){Ve(this,"_responseOrigin",null);this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=hO(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Tr(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new tz(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const r=new rz(this,t,e);return this._rangeRequestReaders.push(r),r}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const r of this._rangeRequestReaders.slice(0))r.cancel(t)}}class tz{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const r=new Headers(t.headers),a=e.url;fetch(a,gO(r,this._withCredentials,this._abortController)).then(s=>{if(t._responseOrigin=hv(s.url),!pO(s.status))throw fv(s.status,a);this._reader=s.body.getReader(),this._headersCapability.resolve();const l=s.headers,{allowRangeRequests:c,suggestedLength:h}=fO({responseHeaders:l,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=h||this._contentLength,this._filename=dO(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Gl("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:mO(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}class rz{constructor(t,e,r){this._stream=t,this._reader=null,this._loaded=0;const a=t.source;this._withCredentials=a.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!a.disableStream,this._abortController=new AbortController;const s=new Headers(t.headers);s.append("Range",`bytes=${e}-${r-1}`);const l=a.url;fetch(l,gO(s,this._withCredentials,this._abortController)).then(c=>{const h=hv(c.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!pO(c.status))throw fv(c.status,l);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded}),{value:mO(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}const $y=200,Xy=206;function nz(n){const t=n.response;return typeof t!="string"?t:lv(t).buffer}class az{constructor({url:t,httpHeaders:e,withCredentials:r}){Ve(this,"_responseOrigin",null);this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=hO(this.isHttp,e),this.withCredentials=r||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,r=this.currXhrId++,a=this.pendingRequests[r]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[s,l]of this.headers)e.setRequestHeader(s,l);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),a.expectedStatus=Xy):a.expectedStatus=$y,e.responseType="arraybuffer",Tr(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,r),e.onprogress=this.onProgress.bind(this,r),a.onHeadersReceived=t.onHeadersReceived,a.onDone=t.onDone,a.onError=t.onError,a.onProgress=t.onProgress,e.send(null),r}onProgress(t,e){var a;const r=this.pendingRequests[t];r&&((a=r.onProgress)==null||a.call(r,e))}onStateChange(t,e){const r=this.pendingRequests[t];if(!r)return;const a=r.xhr;if(a.readyState>=2&&r.onHeadersReceived&&(r.onHeadersReceived(),delete r.onHeadersReceived),a.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],a.status===0&&this.isHttp){r.onError(a.status);return}const s=a.status||$y;if(!(s===$y&&r.expectedStatus===Xy)&&s!==r.expectedStatus){r.onError(a.status);return}const c=nz(a);if(s===Xy){const h=a.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?r.onDone({begin:parseInt(f[1],10),chunk:c}):(it('Missing or invalid "Content-Range" header.'),r.onError(0))}else c?r.onDone({begin:0,chunk:c}):r.onError(a.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class iz{constructor(t){this._source=t,this._manager=new az(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Tr(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new sz(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const r=new oz(this._manager,t,e);return r.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(r),r}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const r of this._rangeRequestReaders.slice(0))r.cancel(t)}}class sz{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=hv(e.responseURL);const r=e.getAllResponseHeaders(),a=new Headers(r?r.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[h,...f]=c.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:s,suggestedLength:l}=fO({responseHeaders:a,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});s&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=dO(a),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=fv(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class oz{constructor(t,e,r){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:r,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var e;const t=hv((e=this._manager.getRequestXhr(this._requestId))==null?void 0:e.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??(this._storedError=fv(t,this._url));for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const lz=/^[a-z][a-z0-9\-+.]+:/i;function cz(n){if(lz.test(n))return new URL(n);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(n))}class uz{constructor(t){this.source=t,this.url=cz(t.url),Tr(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Tr(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new hz(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const r=new fz(this,t,e);return this._rangeRequestReaders.push(r),r}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const r of this._rangeRequestReaders.slice(0))r.cancel(t)}}class hz{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const r=process.getBuiltinModule("fs");r.promises.lstat(this._url).then(a=>{this._contentLength=a.size,this._setReadableStream(r.createReadStream(this._url)),this._headersCapability.resolve()},a=>{a.code==="ENOENT"&&(a=new fp(`Missing PDF "${this._url}".`)),this._storedError=a,this._headersCapability.reject(a)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Gl("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class fz{constructor(t,e,r){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const a=t.source;this._isStreamingSupported=!a.disableStream;const s=process.getBuiltinModule("fs");this._setReadableStream(s.createReadStream(this._url,{start:e,end:r-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const dz=1e5,ea=30,pz=.8;var iC,_l,aa,Kp,Qp,Qc,eo,Zp,Jp,Zc,_f,yf,yl,wf,eg,Af,Jc,tg,rg,eu,tu,ng,wl,Ef,To,xO,vO,Vw,Fa,X1,$w,_O,yO;const Dr=class Dr{constructor({textContentSource:t,container:e,viewport:r}){R(this,To);R(this,_l,Promise.withResolvers());R(this,aa,null);R(this,Kp,!1);R(this,Qp,!!((iC=globalThis.FontInspector)!=null&&iC.enabled));R(this,Qc,null);R(this,eo,null);R(this,Zp,0);R(this,Jp,0);R(this,Zc,null);R(this,_f,null);R(this,yf,0);R(this,yl,0);R(this,wf,Object.create(null));R(this,eg,[]);R(this,Af,null);R(this,Jc,[]);R(this,tg,new WeakMap);R(this,rg,null);var h;if(t instanceof ReadableStream)T(this,Af,t);else if(typeof t=="object")T(this,Af,new ReadableStream({start(f){f.enqueue(t),f.close()}}));else throw new Error('No "textContentSource" parameter specified.');T(this,aa,T(this,_f,e)),T(this,yl,r.scale*(globalThis.devicePixelRatio||1)),T(this,yf,r.rotation),T(this,eo,{div:null,properties:null,ctx:null});const{pageWidth:a,pageHeight:s,pageX:l,pageY:c}=r.rawDims;T(this,rg,[1,0,0,-1,-l,c+s]),T(this,Jp,a),T(this,Zp,s),D(h=Dr,Fa,_O).call(h),Pu(e,r),g(this,_l).promise.finally(()=>{g(Dr,Ef).delete(this),T(this,eo,null),T(this,wf,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Vn.platform;return ht(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{g(this,Zc).read().then(({value:e,done:r})=>{if(r){g(this,_l).resolve();return}g(this,Qc)??T(this,Qc,e.lang),Object.assign(g(this,wf),e.styles),D(this,To,xO).call(this,e.items),t()},g(this,_l).reject)};return T(this,Zc,g(this,Af).getReader()),g(Dr,Ef).add(this),t(),g(this,_l).promise}update({viewport:t,onBefore:e=null}){var s;const r=t.scale*(globalThis.devicePixelRatio||1),a=t.rotation;if(a!==g(this,yf)&&(e==null||e(),T(this,yf,a),Pu(g(this,_f),{rotation:a})),r!==g(this,yl)){e==null||e(),T(this,yl,r);const l={div:null,properties:null,ctx:D(s=Dr,Fa,X1).call(s,g(this,Qc))};for(const c of g(this,Jc))l.properties=g(this,tg).get(c),l.div=c,D(this,To,Vw).call(this,l)}}cancel(){var e;const t=new Gl("TextLayer task cancelled.");(e=g(this,Zc))==null||e.cancel(t).catch(()=>{}),T(this,Zc,null),g(this,_l).reject(t)}get textDivs(){return g(this,Jc)}get textContentItemsStr(){return g(this,eg)}static cleanup(){if(!(g(this,Ef).size>0)){g(this,eu).clear();for(const{canvas:t}of g(this,tu).values())t.remove();g(this,tu).clear()}}};_l=new WeakMap,aa=new WeakMap,Kp=new WeakMap,Qp=new WeakMap,Qc=new WeakMap,eo=new WeakMap,Zp=new WeakMap,Jp=new WeakMap,Zc=new WeakMap,_f=new WeakMap,yf=new WeakMap,yl=new WeakMap,wf=new WeakMap,eg=new WeakMap,Af=new WeakMap,Jc=new WeakMap,tg=new WeakMap,rg=new WeakMap,eu=new WeakMap,tu=new WeakMap,ng=new WeakMap,wl=new WeakMap,Ef=new WeakMap,To=new WeakSet,xO=function(t){var a,s;if(g(this,Kp))return;(s=g(this,eo)).ctx??(s.ctx=D(a=Dr,Fa,X1).call(a,g(this,Qc)));const e=g(this,Jc),r=g(this,eg);for(const l of t){if(e.length>dz){it("Ignoring additional textDivs for performance reasons."),T(this,Kp,!0);return}if(l.str===void 0){if(l.type==="beginMarkedContentProps"||l.type==="beginMarkedContent"){const c=g(this,aa);T(this,aa,document.createElement("span")),g(this,aa).classList.add("markedContent"),l.id!==null&&g(this,aa).setAttribute("id",`${l.id}`),c.append(g(this,aa))}else l.type==="endMarkedContent"&&T(this,aa,g(this,aa).parentNode);continue}r.push(l.str),D(this,To,vO).call(this,l)}},vO=function(t){var A;const e=document.createElement("span"),r={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};g(this,Jc).push(e);const a=je.transform(g(this,rg),t.transform);let s=Math.atan2(a[1],a[0]);const l=g(this,wf)[t.fontName];l.vertical&&(s+=Math.PI/2);let c=g(this,Qp)&&l.fontSubstitution||l.fontFamily;c=Dr.fontFamilyMap.get(c)||c;const h=Math.hypot(a[2],a[3]),f=h*D(A=Dr,Fa,yO).call(A,c,g(this,Qc));let d,m;s===0?(d=a[4],m=a[5]-f):(d=a[4]+f*Math.sin(s),m=a[5]-f*Math.cos(s));const x="calc(var(--scale-factor)*",_=e.style;g(this,aa)===g(this,_f)?(_.left=`${(100*d/g(this,Jp)).toFixed(2)}%`,_.top=`${(100*m/g(this,Zp)).toFixed(2)}%`):(_.left=`${x}${d.toFixed(2)}px)`,_.top=`${x}${m.toFixed(2)}px)`),_.fontSize=`${x}${(g(Dr,wl)*h).toFixed(2)}px)`,_.fontFamily=c,r.fontSize=h,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,g(this,Qp)&&(e.dataset.fontName=l.fontSubstitutionLoadedName||t.fontName),s!==0&&(r.angle=s*(180/Math.PI));let y=!1;if(t.str.length>1)y=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const E=Math.abs(t.transform[0]),b=Math.abs(t.transform[3]);E!==b&&Math.max(E,b)/Math.min(E,b)>1.5&&(y=!0)}if(y&&(r.canvasWidth=l.vertical?t.height:t.width),g(this,tg).set(e,r),g(this,eo).div=e,g(this,eo).properties=r,D(this,To,Vw).call(this,g(this,eo)),r.hasText&&g(this,aa).append(e),r.hasEOL){const E=document.createElement("br");E.setAttribute("role","presentation"),g(this,aa).append(E)}},Vw=function(t){var c;const{div:e,properties:r,ctx:a}=t,{style:s}=e;let l="";if(g(Dr,wl)>1&&(l=`scale(${1/g(Dr,wl)})`),r.canvasWidth!==0&&r.hasText){const{fontFamily:h}=s,{canvasWidth:f,fontSize:d}=r;D(c=Dr,Fa,$w).call(c,a,d*g(this,yl),h);const{width:m}=a.measureText(e.textContent);m>0&&(l=`scaleX(${f*g(this,yl)/m}) ${l}`)}r.angle!==0&&(l=`rotate(${r.angle}deg) ${l}`),l.length>0&&(s.transform=l)},Fa=new WeakSet,X1=function(t=null){let e=g(this,tu).get(t||(t=""));if(!e){const r=document.createElement("canvas");r.className="hiddenCanvasElement",r.lang=t,document.body.append(r),e=r.getContext("2d",{alpha:!1,willReadFrequently:!0}),g(this,tu).set(t,e),g(this,ng).set(e,{size:0,family:""})}return e},$w=function(t,e,r){const a=g(this,ng).get(t);e===a.size&&r===a.family||(t.font=`${e}px ${r}`,a.size=e,a.family=r)},_O=function(){if(g(this,wl)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),T(this,wl,t.getBoundingClientRect().height),t.remove()},yO=function(t,e){const r=g(this,eu).get(t);if(r)return r;const a=D(this,Fa,X1).call(this,e);a.canvas.width=a.canvas.height=ea,D(this,Fa,$w).call(this,a,ea,t);const s=a.measureText("");let l=s.fontBoundingBoxAscent,c=Math.abs(s.fontBoundingBoxDescent);if(l){const d=l/(l+c);return g(this,eu).set(t,d),a.canvas.width=a.canvas.height=0,d}a.strokeStyle="red",a.clearRect(0,0,ea,ea),a.strokeText("g",0,0);let h=a.getImageData(0,0,ea,ea).data;c=0;for(let d=h.length-1-3;d>=0;d-=4)if(h[d]>0){c=Math.ceil(d/4/ea);break}a.clearRect(0,0,ea,ea),a.strokeText("A",0,ea),h=a.getImageData(0,0,ea,ea).data,l=0;for(let d=0,m=h.length;d<m;d+=4)if(h[d]>0){l=ea-Math.floor(d/4/ea);break}a.canvas.width=a.canvas.height=0;const f=l?l/(l+c):pz;return g(this,eu).set(t,f),f},R(Dr,Fa),R(Dr,eu,new Map),R(Dr,tu,new Map),R(Dr,ng,new WeakMap),R(Dr,wl,null),R(Dr,Ef,new Set);let dp=Dr;class pp{static textContent(t){const e=[],r={items:e,styles:Object.create(null)};function a(s){var h;if(!s)return;let l=null;const c=s.name;if(c==="#text")l=s.value;else if(pp.shouldBuildText(c))(h=s==null?void 0:s.attributes)!=null&&h.textContent?l=s.attributes.textContent:s.value&&(l=s.value);else return;if(l!==null&&e.push({str:l}),!!s.children)for(const f of s.children)a(f)}return a(t),r}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const gz=65536,mz=100,xz=5e3,vz=Sn?FH:RH,_z=Sn?MH:iO,yz=Sn?DH:OH,wz=Sn?LH:cO;function Az(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const t=new Xw,{docId:e}=t,r=n.url?Ez(n.url):null,a=n.data?bz(n.data):null,s=n.httpHeaders||null,l=n.withCredentials===!0,c=n.password??null,h=n.range instanceof wO?n.range:null,f=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:gz;let d=n.worker instanceof Qh?n.worker:null;const m=n.verbosity,x=typeof n.docBaseUrl=="string"&&!uv(n.docBaseUrl)?n.docBaseUrl:null,_=typeof n.cMapUrl=="string"?n.cMapUrl:null,y=n.cMapPacked!==!1,A=n.CMapReaderFactory||_z,E=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,b=n.StandardFontDataFactory||wz,C=n.stopAtErrors!==!0,S=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,O=n.isEvalSupported!==!1,L=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Sn,I=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Sn&&(Vn.platform.isFirefox||!globalThis.chrome),F=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,W=typeof n.disableFontFace=="boolean"?n.disableFontFace:Sn,B=n.fontExtraProperties===!0,ee=n.enableXfa===!0,Z=n.ownerDocument||globalThis.document,te=n.disableRange===!0,ve=n.disableStream===!0,Ce=n.disableAutoFetch===!0,Ee=n.pdfBug===!0,J=n.CanvasFactory||vz,oe=n.FilterFactory||yz,De=n.enableHWA===!0,ae=h?h.length:n.length??NaN,V=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Sn&&!W,fe=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:A===iO&&b===cO&&_&&E&&k0(_,document.baseURI)&&k0(E,document.baseURI),U=null;oH(m);const Q={canvasFactory:new J({ownerDocument:Z,enableHWA:De}),filterFactory:new oe({docId:e,ownerDocument:Z}),cMapReaderFactory:fe?null:new A({baseUrl:_,isCompressed:y}),standardFontDataFactory:fe?null:new b({baseUrl:E})};if(!d){const se={verbosity:m,port:xo.workerPort};d=se.port?Qh.fromPort(se):new Qh(se),t._worker=d}const X={docId:e,apiVersion:"4.10.38",data:a,password:c,disableAutoFetch:Ce,rangeChunkSize:f,length:ae,docBaseUrl:x,enableXfa:ee,evaluatorOptions:{maxImageSize:S,disableFontFace:W,ignoreErrors:C,isEvalSupported:O,isOffscreenCanvasSupported:L,isImageDecoderSupported:I,canvasMaxAreaInBytes:F,fontExtraProperties:B,useSystemFonts:V,cMapUrl:fe?_:null,standardFontDataUrl:fe?E:null}},K={disableFontFace:W,fontExtraProperties:B,ownerDocument:Z,pdfBug:Ee,styleElement:U,loadingParams:{disableAutoFetch:Ce,enableXfa:ee}};return d.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const se=d.messageHandler.sendWithPromise("GetDocRequest",X,a?[a.buffer]:null);let _e;if(h)_e=new QH(h,{disableRange:te,disableStream:ve});else if(!a){if(!r)throw new Error("getDocument - no `url` parameter provided.");let be;if(Sn)if(k0(r)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");be=tC}else be=uz;else be=k0(r)?tC:iz;_e=new be({url:r,length:ae,httpHeaders:s,withCredentials:l,rangeChunkSize:f,disableRange:te,disableStream:ve})}return se.then(be=>{if(t.destroyed)throw new Error("Loading aborted");if(d.destroyed)throw new Error("Worker was destroyed");const Te=new D0(e,be,d.port),ye=new Cz(Te,t,_e,K,Q);t._transport=ye,Te.send("Ready",null)})}).catch(t._capability.reject),t}function Ez(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if(Sn&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function bz(n){if(Sn&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return lv(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function rC(n){return typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0}var Hx;const zx=class zx{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Ln(zx,Hx)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var t,e,r,a;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(s){throw(r=this._worker)!=null&&r.port&&delete this._worker._pendingDestroy,s}this._transport=null,(a=this._worker)==null||a.destroy(),this._worker=null}};Hx=new WeakMap,R(zx,Hx,0);let Xw=zx;class wO{constructor(t,e,r=!1,a=null){this.length=t,this.initialData=e,this.progressiveDone=r,this.contentDispositionFilename=a,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,e){for(const r of this._rangeListeners)r(t,e)}onDataProgress(t,e){this._readyCapability.promise.then(()=>{for(const r of this._progressListeners)r(t,e)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const e of this._progressiveReadListeners)e(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,e){It("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class Sz{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ht(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var Al,to,ii,Hh,q1;class Tz{constructor(t,e,r,a=!1){R(this,ii);R(this,Al,null);R(this,to,!1);this._pageIndex=t,this._pageInfo=e,this._transport=r,this._stats=a?new jk:null,this._pdfBug=a,this.commonObjs=r.commonObjs,this.objs=new AO,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:r=0,offsetY:a=0,dontFlip:s=!1}={}){return new Kg({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:r,offsetY:a,dontFlip:s})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ht(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,viewport:e,intent:r="display",annotationMode:a=il.ENABLE,transform:s=null,background:l=null,optionalContentConfigPromise:c=null,annotationCanvasMap:h=null,pageColors:f=null,printAnnotationStorage:d=null,isEditing:m=!1}){var O,L;(O=this._stats)==null||O.time("Overall");const x=this._transport.getRenderingIntent(r,a,d,m),{renderingIntent:_,cacheKey:y}=x;T(this,to,!1),D(this,ii,q1).call(this),c||(c=this._transport.getOptionalContentConfig(_));let A=this._intentStates.get(y);A||(A=Object.create(null),this._intentStates.set(y,A)),A.streamReaderCancelTimeout&&(clearTimeout(A.streamReaderCancelTimeout),A.streamReaderCancelTimeout=null);const E=!!(_&ka.PRINT);A.displayReadyCapability||(A.displayReadyCapability=Promise.withResolvers(),A.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(L=this._stats)==null||L.time("Page Request"),this._pumpOperatorList(x));const b=I=>{var F;A.renderTasks.delete(C),(this._maybeCleanupAfterRender||E)&&T(this,to,!0),D(this,ii,Hh).call(this,!E),I?(C.capability.reject(I),this._abortOperatorList({intentState:A,reason:I instanceof Error?I:new Error(I)})):C.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(F=globalThis.Stats)!=null&&F.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},C=new Yw({callback:b,params:{canvasContext:t,viewport:e,transform:s,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:A.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!E,pdfBug:this._pdfBug,pageColors:f});(A.renderTasks||(A.renderTasks=new Set)).add(C);const S=C.task;return Promise.all([A.displayReadyCapability.promise,c]).then(([I,F])=>{var W;if(this.destroyed){b();return}if((W=this._stats)==null||W.time("Rendering"),!(F.renderingIntent&_))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");C.initializeGraphics({transparency:I,optionalContentConfig:F}),C.operatorListChanged()}).catch(b),S}getOperatorList({intent:t="display",annotationMode:e=il.ENABLE,printAnnotationStorage:r=null,isEditing:a=!1}={}){var f;function s(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(h))}const l=this._transport.getRenderingIntent(t,e,r,a,!0);let c=this._intentStates.get(l.cacheKey);c||(c=Object.create(null),this._intentStates.set(l.cacheKey,c));let h;return c.opListReadCapability||(h=Object.create(null),h.operatorListChanged=s,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||(c.renderTasks=new Set)).add(h),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(f=this._stats)==null||f.time("Page Request"),this._pumpOperatorList(l)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(a){return a.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>pp.textContent(r));const e=this.streamTextContent(t);return new Promise(function(r,a){function s(){l.read().then(function({value:h,done:f}){if(f){r(c);return}c.lang??(c.lang=h.lang),Object.assign(c.styles,h.styles),c.items.push(...h.items),s()},a)}const l=e.getReader(),c={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const r of e.renderTasks)t.push(r.completed),r.cancel();return this.objs.clear(),T(this,to,!1),D(this,ii,q1).call(this),Promise.all(t)}cleanup(t=!1){T(this,to,!0);const e=D(this,ii,Hh).call(this,!1);return t&&e&&this._stats&&(this._stats=new jk),e}_startRenderPage(t,e){var a,s;const r=this._intentStates.get(e);r&&((a=this._stats)==null||a.timeEnd("Page Request"),(s=r.displayReadyCapability)==null||s.resolve(t))}_renderPageChunk(t,e){for(let r=0,a=t.length;r<a;r++)e.operatorList.fnArray.push(t.fnArray[r]),e.operatorList.argsArray.push(t.argsArray[r]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const r of e.renderTasks)r.operatorListChanged();t.lastChunk&&D(this,ii,Hh).call(this,!0)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:r,modifiedIds:a}){const{map:s,transfer:l}=r,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:s,modifiedIds:a},l).getReader(),f=this._intentStates.get(e);f.streamReader=h;const d=()=>{h.read().then(({value:m,done:x})=>{if(x){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(m,f),d())},m=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const x of f.renderTasks)x.operatorListChanged();D(this,ii,Hh).call(this,!0)}if(f.displayReadyCapability)f.displayReadyCapability.reject(m);else if(f.opListReadCapability)f.opListReadCapability.reject(m);else throw m}})};d()}_abortOperatorList({intentState:t,reason:e,force:r=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!r){if(t.renderTasks.size>0)return;if(e instanceof pE){let a=mz;e.extraDelay>0&&e.extraDelay<1e3&&(a+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},a);return}}if(t.streamReader.cancel(new Gl(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[a,s]of this._intentStates)if(s===t){this._intentStates.delete(a);break}this.cleanup()}}}get stats(){return this._stats}}Al=new WeakMap,to=new WeakMap,ii=new WeakSet,Hh=function(t=!1){if(D(this,ii,q1).call(this),!g(this,to)||this.destroyed)return!1;if(t)return T(this,Al,setTimeout(()=>{T(this,Al,null),D(this,ii,Hh).call(this,!1)},xz)),!1;for(const{renderTasks:e,operatorList:r}of this._intentStates.values())if(e.size>0||!r.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),T(this,to,!1),!0},q1=function(){g(this,Al)&&(clearTimeout(g(this,Al)),T(this,Al,null))};var ro,jx;class kz{constructor(){R(this,ro,new Map);R(this,jx,Promise.resolve())}postMessage(t,e){const r={data:structuredClone(t,e?{transfer:e}:null)};g(this,jx).then(()=>{for(const[a]of g(this,ro))a.call(this,r)})}addEventListener(t,e,r=null){let a=null;if((r==null?void 0:r.signal)instanceof AbortSignal){const{signal:s}=r;if(s.aborted){it("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(t,e);a=()=>s.removeEventListener("abort",l),s.addEventListener("abort",l)}g(this,ro).set(e,a)}removeEventListener(t,e){const r=g(this,ro).get(e);r==null||r(),g(this,ro).delete(e)}terminate(){for(const[,t]of g(this,ro))t==null||t();g(this,ro).clear()}}ro=new WeakMap,jx=new WeakMap;var Gx,ru,nu,bf,Y1,Sf,W1;const Wt=class Wt{constructor({name:t=null,port:e=null,verbosity:r=lH()}={}){R(this,bf);var a;if(this.name=t,this.destroyed=!1,this.verbosity=r,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,e){if((a=g(Wt,nu))!=null&&a.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(g(Wt,nu)||T(Wt,nu,new WeakMap)).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(t){this._port=t,this._messageHandler=new D0("main","worker",t),this._messageHandler.on("ready",function(){}),D(this,bf,Y1).call(this)}_initialize(){if(g(Wt,ru)||g(Wt,Sf,W1)){this._setupFakeWorker();return}let{workerSrc:t}=Wt;try{Wt._isSameOrigin(window.location.href,t)||(t=Wt._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),r=new D0("main","worker",e),a=()=>{s.abort(),r.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},s=new AbortController;e.addEventListener("error",()=>{this._webWorker||a()},{signal:s.signal}),r.on("test",c=>{if(s.abort(),this.destroyed||!c){a();return}this._messageHandler=r,this._port=e,this._webWorker=e,D(this,bf,Y1).call(this)}),r.on("ready",c=>{if(s.abort(),this.destroyed){a();return}try{l()}catch{this._setupFakeWorker()}});const l=()=>{const c=new Uint8Array;r.send("test",c,[c.buffer])};l();return}catch{ov("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){g(Wt,ru)||(it("Setting up fake worker."),T(Wt,ru,!0)),Wt._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new kz;this._port=e;const r=`fake${Ln(Wt,Gx)._++}`,a=new D0(r+"_worker",r,e);t.setup(a,e),this._messageHandler=new D0(r,r+"_worker",e),D(this,bf,Y1).call(this)}).catch(t=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${t.message}".`))})}destroy(){var t,e,r;this.destroyed=!0,(t=this._webWorker)==null||t.terminate(),this._webWorker=null,(e=g(Wt,nu))==null||e.delete(this._port),this._port=null,(r=this._messageHandler)==null||r.destroy(),this._messageHandler=null}static fromPort(t){var r;if(!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const e=(r=g(this,nu))==null?void 0:r.get(t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Wt(t)}static get workerSrc(){if(xo.workerSrc)return xo.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ht(this,"_setupFakeWorkerGlobal",(async()=>g(this,Sf,W1)?g(this,Sf,W1):(await import(this.workerSrc)).WorkerMessageHandler)())}};Gx=new WeakMap,ru=new WeakMap,nu=new WeakMap,bf=new WeakSet,Y1=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},Sf=new WeakSet,W1=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},R(Wt,Sf),R(Wt,Gx,0),R(Wt,ru,!1),R(Wt,nu),Sn&&(T(Wt,ru,!0),xo.workerSrc||(xo.workerSrc="./pdf.worker.mjs")),Wt._isSameOrigin=(t,e)=>{let r;try{if(r=new URL(t),!r.origin||r.origin==="null")return!1}catch{return!1}const a=new URL(e,r);return r.origin===a.origin},Wt._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))};let Qh=Wt;var no,cs,Tf,kf,ao,au,P0;class Cz{constructor(t,e,r,a,s){R(this,au);R(this,no,new Map);R(this,cs,new Map);R(this,Tf,new Map);R(this,kf,new Map);R(this,ao,null);this.messageHandler=t,this.loadingTask=e,this.commonObjs=new AO,this.fontLoader=new kH({ownerDocument:a.ownerDocument,styleElement:a.styleElement}),this.loadingParams=a.loadingParams,this._params=a,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return ht(this,"annotationStorage",new vE)}getRenderingIntent(t,e=il.ENABLE,r=null,a=!1,s=!1){let l=ka.DISPLAY,c=Nw;switch(t){case"any":l=ka.ANY;break;case"display":break;case"print":l=ka.PRINT;break;default:it(`getRenderingIntent - invalid intent: ${t}`)}const h=l&ka.PRINT&&r instanceof J4?r:this.annotationStorage;switch(e){case il.DISABLE:l+=ka.ANNOTATIONS_DISABLE;break;case il.ENABLE:break;case il.ENABLE_FORMS:l+=ka.ANNOTATIONS_FORMS;break;case il.ENABLE_STORAGE:l+=ka.ANNOTATIONS_STORAGE,c=h.serializable;break;default:it(`getRenderingIntent - invalid annotationMode: ${e}`)}a&&(l+=ka.IS_EDITING),s&&(l+=ka.OPLIST);const{ids:f,hash:d}=h.modifiedIds,m=[l,c.hash,d];return{renderingIntent:l,cacheKey:m.join("_"),annotationStorageSerializable:c,modifiedIds:f}}destroy(){var r;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(r=g(this,ao))==null||r.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const a of g(this,cs).values())t.push(a._destroy());g(this,cs).clear(),g(this,Tf).clear(),g(this,kf).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{var a,s;this.commonObjs.clear(),this.fontLoader.clear(),g(this,no).clear(),this.filterFactory.destroy(),dp.cleanup(),(a=this._networkStream)==null||a.cancelAllRequests(new Gl("Worker was terminated.")),(s=this.messageHandler)==null||s.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(r,a)=>{Tr(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=s=>{this._lastProgress={loaded:s.loaded,total:s.total}},a.onPull=()=>{this._fullReader.read().then(function({value:s,done:l}){if(l){a.close();return}Tr(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{a.error(s)})},a.onCancel=s=>{this._fullReader.cancel(s),a.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("ReaderHeadersReady",async r=>{var c;await this._fullReader.headersReady;const{isStreamingSupported:a,isRangeSupported:s,contentLength:l}=this._fullReader;return(!a||!s)&&(this._lastProgress&&((c=e.onProgress)==null||c.call(e,this._lastProgress)),this._fullReader.onProgress=h=>{var f;(f=e.onProgress)==null||f.call(e,{loaded:h.loaded,total:h.total})}),{isStreamingSupported:a,isRangeSupported:s,contentLength:l}}),t.on("GetRangeReader",(r,a)=>{Tr(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(r.begin,r.end);if(!s){a.close();return}a.onPull=()=>{s.read().then(function({value:l,done:c}){if(c){a.close();return}Tr(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{a.error(l)})},a.onCancel=l=>{s.cancel(l),a.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,e._capability.resolve(new Sz(r,this))}),t.on("DocException",r=>{e._capability.reject(ta(r))}),t.on("PasswordRequest",r=>{T(this,ao,Promise.withResolvers());try{if(!e.onPassword)throw ta(r);const a=s=>{s instanceof Error?g(this,ao).reject(s):g(this,ao).resolve({password:s})};e.onPassword(a,r.code)}catch(a){g(this,ao).reject(a)}return g(this,ao).promise}),t.on("DataLoaded",r=>{var a;(a=e.onProgress)==null||a.call(e,{loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),t.on("StartRenderPage",r=>{if(this.destroyed)return;g(this,cs).get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),t.on("commonobj",([r,a,s])=>{var l;if(this.destroyed||this.commonObjs.has(r))return null;switch(a){case"Font":const{disableFontFace:c,fontExtraProperties:h,pdfBug:f}=this._params;if("error"in s){const _=s.error;it(`Error during font loading: ${_}`),this.commonObjs.resolve(r,_);break}const d=f&&((l=globalThis.FontInspector)!=null&&l.enabled)?(_,y)=>globalThis.FontInspector.fontAdded(_,y):null,m=new CH(s,{disableFontFace:c,fontExtraProperties:h,inspectFont:d});this.fontLoader.bind(m).catch(()=>t.sendWithPromise("FontFallback",{id:r})).finally(()=>{!h&&m.data&&(m.data=null),this.commonObjs.resolve(r,m)});break;case"CopyLocalImage":const{imageRef:x}=s;Tr(x,"The imageRef must be defined.");for(const _ of g(this,cs).values())for(const[,y]of _.objs)if((y==null?void 0:y.ref)===x)return y.dataLen?(this.commonObjs.resolve(r,structuredClone(y)),y.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(r,s);break;default:throw new Error(`Got unknown common object type ${a}`)}return null}),t.on("obj",([r,a,s,l])=>{var h;if(this.destroyed)return;const c=g(this,cs).get(a);if(!c.objs.has(r)){if(c._intentStates.size===0){(h=l==null?void 0:l.bitmap)==null||h.close();return}switch(s){case"Image":c.objs.resolve(r,l),(l==null?void 0:l.dataLen)>nH&&(c._maybeCleanupAfterRender=!0);break;case"Pattern":c.objs.resolve(r,l);break;default:throw new Error(`Got unknown object type ${s}`)}}}),t.on("DocProgress",r=>{var a;this.destroyed||(a=e.onProgress)==null||a.call(e,{loaded:r.loaded,total:r.total})}),t.on("FetchBuiltInCMap",async r=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(r)}),t.on("FetchStandardFontData",async r=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(r)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var r;this.annotationStorage.size<=0&&it("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((r=this._fullReader)==null?void 0:r.filename)??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,r=g(this,Tf).get(e);if(r)return r;const a=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(s=>{if(this.destroyed)throw new Error("Transport destroyed");s.refStr&&g(this,kf).set(s.refStr,t);const l=new Tz(e,s,this,this._params.pdfBug);return g(this,cs).set(e,l),l});return g(this,Tf).set(e,a),a}getPageIndex(t){return rC(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return D(this,au,P0).call(this,"GetFieldObjects")}hasJSActions(){return D(this,au,P0).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return D(this,au,P0).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return D(this,au,P0).call(this,"GetOptionalContentConfig").then(e=>new KH(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=g(this,no).get(t);if(e)return e;const r=this.messageHandler.sendWithPromise(t,null).then(a=>{var s,l;return{info:a[0],metadata:a[1]?new YH(a[1]):null,contentDispositionFilename:((s=this._fullReader)==null?void 0:s.filename)??null,contentLength:((l=this._fullReader)==null?void 0:l.contentLength)??null}});return g(this,no).set(t,r),r}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of g(this,cs).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),g(this,no).clear(),this.filterFactory.destroy(!0),dp.cleanup()}}cachedPageNumber(t){if(!rC(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return g(this,kf).get(e)??null}}no=new WeakMap,cs=new WeakMap,Tf=new WeakMap,kf=new WeakMap,ao=new WeakMap,au=new WeakSet,P0=function(t,e=null){const r=g(this,no).get(t);if(r)return r;const a=this.messageHandler.sendWithPromise(t,e);return g(this,no).set(t,a),a};const y0=Symbol("INITIAL_DATA");var va,ag,qw;class AO{constructor(){R(this,ag);R(this,va,Object.create(null))}get(t,e=null){if(e){const a=D(this,ag,qw).call(this,t);return a.promise.then(()=>e(a.data)),null}const r=g(this,va)[t];if(!r||r.data===y0)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return r.data}has(t){const e=g(this,va)[t];return!!e&&e.data!==y0}delete(t){const e=g(this,va)[t];return!e||e.data===y0?!1:(delete g(this,va)[t],!0)}resolve(t,e=null){const r=D(this,ag,qw).call(this,t);r.data=e,r.resolve()}clear(){var t;for(const e in g(this,va)){const{data:r}=g(this,va)[e];(t=r==null?void 0:r.bitmap)==null||t.close()}T(this,va,Object.create(null))}*[Symbol.iterator](){for(const t in g(this,va)){const{data:e}=g(this,va)[t];e!==y0&&(yield[t,e])}}}va=new WeakMap,ag=new WeakSet,qw=function(t){var e;return(e=g(this,va))[t]||(e[t]={...Promise.withResolvers(),data:y0})};var El;class Rz{constructor(t){R(this,El,null);T(this,El,t),this.onContinue=null}get promise(){return g(this,El).capability.promise}cancel(t=0){g(this,El).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=g(this,El).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=g(this,El);return t.form||t.canvas&&(e==null?void 0:e.size)>0}}El=new WeakMap;var bl,iu;const Sc=class Sc{constructor({callback:t,params:e,objs:r,commonObjs:a,annotationCanvasMap:s,operatorList:l,pageIndex:c,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:d=!1,pdfBug:m=!1,pageColors:x=null}){R(this,bl,null);this.callback=t,this.params=e,this.objs=r,this.commonObjs=a,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=c,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=m,this.pageColors=x,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=d===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new Rz(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var c,h;if(this.cancelled)return;if(this._canvas){if(g(Sc,iu).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");g(Sc,iu).add(this._canvas)}this._pdfBug&&((c=globalThis.StepperManager)!=null&&c.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:r,viewport:a,transform:s,background:l}=this.params;this.gfx=new Kh(r,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:s,viewport:a,transparency:t,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,(h=this.graphicsReadyCallback)==null||h.call(this)}cancel(t=null,e=0){var r;this.running=!1,this.cancelled=!0,(r=this.gfx)==null||r.endDrawing(),g(this,bl)&&(window.cancelAnimationFrame(g(this,bl)),T(this,bl,null)),g(Sc,iu).delete(this._canvas),this.callback(t||new pE(`Rendering cancelled, page ${this._pageIndex+1}`,e))}operatorListChanged(){var t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?T(this,bl,window.requestAnimationFrame(()=>{T(this,bl,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),g(Sc,iu).delete(this._canvas),this.callback())))}};bl=new WeakMap,iu=new WeakMap,R(Sc,iu,new WeakSet);let Yw=Sc;const Oz="4.10.38",Dz="f9bea397f";function nC(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function w0(n){return Math.max(0,Math.min(255,255*n))}class aC{static CMYK_G([t,e,r,a]){return["G",1-Math.min(1,.3*t+.59*r+.11*e+a)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=w0(t),[t,t,t]}static G_HTML([t]){const e=nC(t);return`#${e}${e}${e}`}static RGB_G([t,e,r]){return["G",.3*t+.59*e+.11*r]}static RGB_rgb(t){return t.map(w0)}static RGB_HTML(t){return`#${t.map(nC).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,r,a]){return["RGB",1-Math.min(1,t+a),1-Math.min(1,r+a),1-Math.min(1,e+a)]}static CMYK_rgb([t,e,r,a]){return[w0(1-Math.min(1,t+a)),w0(1-Math.min(1,r+a)),w0(1-Math.min(1,e+a))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,r]){const a=1-t,s=1-e,l=1-r,c=Math.min(a,s,l);return["CMYK",a,s,l,c]}}class Fz{create(t,e,r=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const a=this._createSVG("svg:svg");return a.setAttribute("version","1.1"),r||(a.setAttribute("width",`${t}px`),a.setAttribute("height",`${e}px`)),a.setAttribute("preserveAspectRatio","none"),a.setAttribute("viewBox",`0 0 ${t} ${e}`),a}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){It("Abstract method `_createSVG` called.")}}class yE extends Fz{_createSVG(t){return document.createElementNS(Us,t)}}class EO{static setupStorage(t,e,r,a,s){const l=a.getValue(e,{value:null});switch(r.name){case"textarea":if(l.value!==null&&(t.textContent=l.value),s==="print")break;t.addEventListener("input",c=>{a.setValue(e,{value:c.target.value})});break;case"input":if(r.attributes.type==="radio"||r.attributes.type==="checkbox"){if(l.value===r.attributes.xfaOn?t.setAttribute("checked",!0):l.value===r.attributes.xfaOff&&t.removeAttribute("checked"),s==="print")break;t.addEventListener("change",c=>{a.setValue(e,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&t.setAttribute("value",l.value),s==="print")break;t.addEventListener("input",c=>{a.setValue(e,{value:c.target.value})})}break;case"select":if(l.value!==null){t.setAttribute("value",l.value);for(const c of r.children)c.attributes.value===l.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}t.addEventListener("input",c=>{const h=c.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;a.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:r=null,intent:a,linkService:s}){const{attributes:l}=e,c=t instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${a}`);for(const[h,f]of Object.entries(l))if(f!=null)switch(h){case"class":f.length&&t.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!c||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,f)}c&&s.addLinkAttributes(t,l.href,l.newWindow),r&&l.dataId&&this.setupStorage(t,l.dataId,e,r)}static render(t){var m,x;const e=t.annotationStorage,r=t.linkService,a=t.xfaHtml,s=t.intent||"display",l=document.createElement(a.name);a.attributes&&this.setAttributes({html:l,element:a,intent:s,linkService:r});const c=s!=="richText",h=t.div;if(h.append(l),t.viewport){const _=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=_}c&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(a.children.length===0){if(a.value){const _=document.createTextNode(a.value);l.append(_),c&&pp.shouldBuildText(a.name)&&f.push(_)}return{textDivs:f}}const d=[[a,-1,l]];for(;d.length>0;){const[_,y,A]=d.at(-1);if(y+1===_.children.length){d.pop();continue}const E=_.children[++d.at(-1)[1]];if(E===null)continue;const{name:b}=E;if(b==="#text"){const S=document.createTextNode(E.value);f.push(S),A.append(S);continue}const C=(m=E==null?void 0:E.attributes)!=null&&m.xmlns?document.createElementNS(E.attributes.xmlns,b):document.createElement(b);if(A.append(C),E.attributes&&this.setAttributes({html:C,element:E,storage:e,intent:s,linkService:r}),((x=E.children)==null?void 0:x.length)>0)d.push([E,-1,C]);else if(E.value){const S=document.createTextNode(E.value);c&&pp.shouldBuildText(b)&&f.push(S),C.append(S)}}for(const _ of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))_.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const Zg=1e3,Mz=9,Bu=new WeakSet;function Ul(n){return{width:n[2]-n[0],height:n[3]-n[1]}}class Lz{static create(t){switch(t.data.annotationType){case Or.LINK:return new bO(t);case Or.TEXT:return new Nz(t);case Or.WIDGET:switch(t.data.fieldType){case"Tx":return new Pz(t);case"Btn":return t.data.radioButton?new kO(t):t.data.checkBox?new Bz(t):new Uz(t);case"Ch":return new Hz(t);case"Sig":return new Iz(t)}return new Wu(t);case Or.POPUP:return new Kw(t);case Or.FREETEXT:return new FO(t);case Or.LINE:return new jz(t);case Or.SQUARE:return new Gz(t);case Or.CIRCLE:return new Vz(t);case Or.POLYLINE:return new MO(t);case Or.CARET:return new Xz(t);case Or.INK:return new wE(t);case Or.POLYGON:return new $z(t);case Or.HIGHLIGHT:return new LO(t);case Or.UNDERLINE:return new qz(t);case Or.SQUIGGLY:return new Yz(t);case Or.STRIKEOUT:return new Wz(t);case Or.STAMP:return new NO(t);case Or.FILEATTACHMENT:return new Kz(t);default:return new xr(t)}}}var su,Cf,Rf,ig,Ww;const SE=class SE{constructor(t,{isRenderable:e=!1,ignoreBorder:r=!1,createQuadrilaterals:a=!1}={}){R(this,ig);R(this,su,null);R(this,Cf,!1);R(this,Rf,null);this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(r)),a&&this._createQuadrilaterals()}static _hasPopupData({titleObj:t,contentsObj:e,richText:r}){return!!(t!=null&&t.str||e!=null&&e.str||r!=null&&r.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return SE._hasPopupData(this.data)}updateEdited(t){var r;if(!this.container)return;g(this,su)||T(this,su,{rect:this.data.rect.slice(0)});const{rect:e}=t;e&&D(this,ig,Ww).call(this,e),(r=g(this,Rf))==null||r.popup.updateEdited(t)}resetEdited(){var t;g(this,su)&&(D(this,ig,Ww).call(this,g(this,su).rect),(t=g(this,Rf))==null||t.popup.resetEdited(),T(this,su,null))}_createContainer(t){const{data:e,parent:{page:r,viewport:a}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",e.id),this instanceof Wu||(s.tabIndex=Zg);const{style:l}=s;if(l.zIndex=this.parent.zIndex++,e.alternativeText&&(s.title=e.alternativeText),e.noRotate&&s.classList.add("norotate"),!e.rect||this instanceof Kw){const{rotation:A}=e;return!e.hasOwnCanvas&&A!==0&&this.setRotation(A,s),s}const{width:c,height:h}=Ul(e.rect);if(!t&&e.borderStyle.width>0){l.borderWidth=`${e.borderStyle.width}px`;const A=e.borderStyle.horizontalCornerRadius,E=e.borderStyle.verticalCornerRadius;if(A>0||E>0){const C=`calc(${A}px * var(--scale-factor)) / calc(${E}px * var(--scale-factor))`;l.borderRadius=C}else if(this instanceof kO){const C=`calc(${c}px * var(--scale-factor)) / calc(${h}px * var(--scale-factor))`;l.borderRadius=C}switch(e.borderStyle.style){case v0.SOLID:l.borderStyle="solid";break;case v0.DASHED:l.borderStyle="dashed";break;case v0.BEVELED:it("Unimplemented border style: beveled");break;case v0.INSET:it("Unimplemented border style: inset");break;case v0.UNDERLINE:l.borderBottomStyle="solid";break}const b=e.borderColor||null;b?(T(this,Cf,!0),l.borderColor=je.makeHexColor(b[0]|0,b[1]|0,b[2]|0)):l.borderWidth=0}const f=je.normalizeRect([e.rect[0],r.view[3]-e.rect[1]+r.view[1],e.rect[2],r.view[3]-e.rect[3]+r.view[1]]),{pageWidth:d,pageHeight:m,pageX:x,pageY:_}=a.rawDims;l.left=`${100*(f[0]-x)/d}%`,l.top=`${100*(f[1]-_)/m}%`;const{rotation:y}=e;return e.hasOwnCanvas||y===0?(l.width=`${100*c/d}%`,l.height=`${100*h/m}%`):this.setRotation(y,s),s}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:r,pageHeight:a}=this.parent.viewport.rawDims,{width:s,height:l}=Ul(this.data.rect);let c,h;t%180===0?(c=100*s/r,h=100*l/a):(c=100*l/r,h=100*s/a),e.style.width=`${c}%`,e.style.height=`${h}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,r,a)=>{const s=a.detail[e],l=s[0],c=s.slice(1);a.target.style[r]=aC[`${l}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[r]:aC[`${l}_rgb`](c)})};return ht(this,"_commonActions",{display:e=>{const{display:r}=e.detail,a=r%2===1;this.container.style.visibility=a?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:a,noPrint:r===1||r===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:r}=e.detail;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:r,noView:r})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const r=e.detail.rotation;this.setRotation(r),this.annotationStorage.setValue(this.data.id,{rotation:r})}})}_dispatchEventFromSandbox(t,e){const r=this._commonActions;for(const a of Object.keys(e.detail)){const s=t[a]||r[a];s==null||s(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const r=this._commonActions;for(const[a,s]of Object.entries(e)){const l=r[a];if(l){const c={detail:{[a]:s},target:t};l(c),delete e[a]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,r,a,s]=this.data.rect.map(A=>Math.fround(A));if(t.length===8){const[A,E,b,C]=t.subarray(2,6);if(a===A&&s===E&&e===b&&r===C)return}const{style:l}=this.container;let c;if(g(this,Cf)){const{borderColor:A,borderWidth:E}=l;l.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${A}" stroke-width="${E}">`],this.container.classList.add("hasBorder")}const h=a-e,f=s-r,{svgFactory:d}=this,m=d.createElement("svg");m.classList.add("quadrilateralsContainer"),m.setAttribute("width",0),m.setAttribute("height",0);const x=d.createElement("defs");m.append(x);const _=d.createElement("clipPath"),y=`clippath_${this.data.id}`;_.setAttribute("id",y),_.setAttribute("clipPathUnits","objectBoundingBox"),x.append(_);for(let A=2,E=t.length;A<E;A+=8){const b=t[A],C=t[A+1],S=t[A+2],O=t[A+3],L=d.createElement("rect"),I=(S-e)/h,F=(s-C)/f,W=(b-S)/h,B=(C-O)/f;L.setAttribute("x",I),L.setAttribute("y",F),L.setAttribute("width",W),L.setAttribute("height",B),_.append(L),c==null||c.push(`<rect vector-effect="non-scaling-stroke" x="${I}" y="${F}" width="${W}" height="${B}"/>`)}g(this,Cf)&&(c.push("</g></svg>')"),l.backgroundImage=c.join("")),this.container.append(m),this.container.style.clipPath=`url(#${y})`}_createPopup(){const{data:t}=this,e=T(this,Rf,new Kw({data:{color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(e.render())}render(){It("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const r=[];if(this._fieldObjects){const a=this._fieldObjects[t];if(a)for(const{page:s,id:l,exportValues:c}of a){if(s===-1||l===e)continue;const h=typeof c=="string"?c:null,f=document.querySelector(`[data-element-id="${l}"]`);if(f&&!Bu.has(f)){it(`_getElementsByName - element not allowed: ${l}`);continue}r.push({id:l,exportValue:h,domElement:f})}return r}for(const a of document.getElementsByName(t)){const{exportValue:s}=a,l=a.getAttribute("data-element-id");l!==e&&Bu.has(a)&&r.push({id:l,exportValue:s,domElement:a})}return r}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var r;(r=this.linkService.eventBus)==null||r.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e})})}};su=new WeakMap,Cf=new WeakMap,Rf=new WeakMap,ig=new WeakSet,Ww=function(t){const{container:{style:e},data:{rect:r,rotation:a},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:l,pageX:c,pageY:h}}}}=this;r==null||r.splice(0,4,...t);const{width:f,height:d}=Ul(t);e.left=`${100*(t[0]-c)/s}%`,e.top=`${100*(l-t[3]+h)/l}%`,a===0?(e.width=`${100*f/s}%`,e.height=`${100*d/l}%`):this.setRotation(a)};let xr=SE;var Ra,_c,SO,TO;class bO extends xr{constructor(e,r=null){super(e,{isRenderable:!0,ignoreBorder:!!(r!=null&&r.ignoreBorder),createQuadrilaterals:!0});R(this,Ra);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:r}=this,a=document.createElement("a");a.setAttribute("data-element-id",e.id);let s=!1;return e.url?(r.addLinkAttributes(a,e.url,e.newWindow),s=!0):e.action?(this._bindNamedAction(a,e.action),s=!0):e.attachment?(D(this,Ra,SO).call(this,a,e.attachment,e.attachmentDest),s=!0):e.setOCGState?(D(this,Ra,TO).call(this,a,e.setOCGState),s=!0):e.dest?(this._bindLink(a,e.dest),s=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(a,e),s=!0),e.resetForm?(this._bindResetFormAction(a,e.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(a,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(a),this.container}_bindLink(e,r){e.href=this.linkService.getDestinationHash(r),e.onclick=()=>(r&&this.linkService.goToDestination(r),!1),(r||r==="")&&D(this,Ra,_c).call(this)}_bindNamedAction(e,r){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(r),!1),D(this,Ra,_c).call(this)}_bindJSAction(e,r){e.href=this.linkService.getAnchorUrl("");const a=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(r.actions)){const l=a.get(s);l&&(e[l]=()=>{var c;return(c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r.id,name:s}}),!1})}e.onclick||(e.onclick=()=>!1),D(this,Ra,_c).call(this)}_bindResetFormAction(e,r){const a=e.onclick;if(a||(e.href=this.linkService.getAnchorUrl("")),D(this,Ra,_c).call(this),!this._fieldObjects){it('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),a||(e.onclick=()=>!1);return}e.onclick=()=>{var m;a==null||a();const{fields:s,refs:l,include:c}=r,h=[];if(s.length!==0||l.length!==0){const x=new Set(l);for(const _ of s){const y=this._fieldObjects[_]||[];for(const{id:A}of y)x.add(A)}for(const _ of Object.values(this._fieldObjects))for(const y of _)x.has(y.id)===c&&h.push(y)}else for(const x of Object.values(this._fieldObjects))h.push(...x);const f=this.annotationStorage,d=[];for(const x of h){const{id:_}=x;switch(d.push(_),x.type){case"text":{const A=x.defaultValue||"";f.setValue(_,{value:A});break}case"checkbox":case"radiobutton":{const A=x.defaultValue===x.exportValues;f.setValue(_,{value:A});break}case"combobox":case"listbox":{const A=x.defaultValue||"";f.setValue(_,{value:A});break}default:continue}const y=document.querySelector(`[data-element-id="${_}"]`);if(y){if(!Bu.has(y)){it(`_bindResetFormAction - element not allowed: ${_}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((m=this.linkService.eventBus)==null||m.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}})),!1}}}Ra=new WeakSet,_c=function(){this.container.setAttribute("data-internal-link","")},SO=function(e,r,a=null){e.href=this.linkService.getAnchorUrl(""),r.description&&(e.title=r.description),e.onclick=()=>{var s;return(s=this.downloadManager)==null||s.openOrDownloadData(r.content,r.filename,a),!1},D(this,Ra,_c).call(this)},TO=function(e,r){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(r),!1),D(this,Ra,_c).call(this)};class Nz extends xr{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class Wu extends xr{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Vn.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,r,a,s){r.includes("mouse")?t.addEventListener(r,l=>{var c;(c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:s(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):t.addEventListener(r,l=>{var c;if(r==="blur"){if(!e.focused||!l.relatedTarget)return;e.focused=!1}else if(r==="focus"){if(e.focused)return;e.focused=!0}s&&((c=this.linkService.eventBus)==null||c.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:s(l)}}))})}_setEventListeners(t,e,r,a){var s,l,c;for(const[h,f]of r)(f==="Action"||(s=this.data.actions)!=null&&s[f])&&((f==="Focus"||f==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,h,f,a),f==="Focus"&&!((l=this.data.actions)!=null&&l.Blur)?this._setEventListener(t,e,"blur","Blur",null):f==="Blur"&&!((c=this.data.actions)!=null&&c.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":je.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:r}=this.data.defaultAppearanceData,a=this.data.defaultAppearanceData.fontSize||Mz,s=t.style;let l;const c=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c),d=Math.round(f/(Hy*a))||1,m=f/d;l=Math.min(a,h(m/Hy))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c);l=Math.min(a,h(f/Hy))}s.fontSize=`calc(${l}px * var(--scale-factor))`,s.color=je.makeHexColor(r[0],r[1],r[2]),this.data.textAlignment!==null&&(s.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class Pz extends Wu{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,r,a){const s=this.annotationStorage;for(const l of this._getElementsByName(t.name,t.id))l.domElement&&(l.domElement[e]=r),s.setValue(l.id,{[a]:r})}render(){var a,s;const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let r=null;if(this.renderForms){const l=t.getValue(e,{value:this.data.fieldValue});let c=l.value||"";const h=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;h&&c.length>h&&(c=c.slice(0,h));let f=l.formattedValue||((a=this.data.textContent)==null?void 0:a.join(`
`))||null;f&&this.data.comb&&(f=f.replaceAll(/\s+/g,""));const d={userValue:c,formattedValue:f,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(r=document.createElement("textarea"),r.textContent=f??c,this.data.doNotScroll&&(r.style.overflowY="hidden")):(r=document.createElement("input"),r.type="text",r.setAttribute("value",f??c),this.data.doNotScroll&&(r.style.overflowX="hidden")),this.data.hasOwnCanvas&&(r.hidden=!0),Bu.add(r),r.setAttribute("data-element-id",e),r.disabled=this.data.readOnly,r.name=this.data.fieldName,r.tabIndex=Zg,this._setRequired(r,this.data.required),h&&(r.maxLength=h),r.addEventListener("input",x=>{t.setValue(e,{value:x.target.value}),this.setPropertyOnSiblings(r,"value",x.target.value,"value"),d.formattedValue=null}),r.addEventListener("resetform",x=>{const _=this.data.defaultFieldValue??"";r.value=d.userValue=_,d.formattedValue=null});let m=x=>{const{formattedValue:_}=d;_!=null&&(x.target.value=_),x.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){r.addEventListener("focus",_=>{var A;if(d.focused)return;const{target:y}=_;d.userValue&&(y.value=d.userValue),d.lastCommittedValue=y.value,d.commitKey=1,(A=this.data.actions)!=null&&A.Focus||(d.focused=!0)}),r.addEventListener("updatefromsandbox",_=>{this.showElementAndHideCanvas(_.target);const y={value(A){d.userValue=A.detail.value??"",t.setValue(e,{value:d.userValue.toString()}),A.target.value=d.userValue},formattedValue(A){const{formattedValue:E}=A.detail;d.formattedValue=E,E!=null&&A.target!==document.activeElement&&(A.target.value=E),t.setValue(e,{formattedValue:E})},selRange(A){A.target.setSelectionRange(...A.detail.selRange)},charLimit:A=>{var S;const{charLimit:E}=A.detail,{target:b}=A;if(E===0){b.removeAttribute("maxLength");return}b.setAttribute("maxLength",E);let C=d.userValue;!C||C.length<=E||(C=C.slice(0,E),b.value=d.userValue=C,t.setValue(e,{value:C}),(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:C,willCommit:!0,commitKey:1,selStart:b.selectionStart,selEnd:b.selectionEnd}}))}};this._dispatchEventFromSandbox(y,_)}),r.addEventListener("keydown",_=>{var E;d.commitKey=1;let y=-1;if(_.key==="Escape"?y=0:_.key==="Enter"&&!this.data.multiLine?y=2:_.key==="Tab"&&(d.commitKey=3),y===-1)return;const{value:A}=_.target;d.lastCommittedValue!==A&&(d.lastCommittedValue=A,d.userValue=A,(E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:A,willCommit:!0,commitKey:y,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}}))});const x=m;m=null,r.addEventListener("blur",_=>{var A,E;if(!d.focused||!_.relatedTarget)return;(A=this.data.actions)!=null&&A.Blur||(d.focused=!1);const{value:y}=_.target;d.userValue=y,d.lastCommittedValue!==y&&((E=this.linkService.eventBus)==null||E.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:y,willCommit:!0,commitKey:d.commitKey,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}})),x(_)}),(s=this.data.actions)!=null&&s.Keystroke&&r.addEventListener("beforeinput",_=>{var L;d.lastCommittedValue=null;const{data:y,target:A}=_,{value:E,selectionStart:b,selectionEnd:C}=A;let S=b,O=C;switch(_.inputType){case"deleteWordBackward":{const I=E.substring(0,b).match(/\w*[^\w]*$/);I&&(S-=I[0].length);break}case"deleteWordForward":{const I=E.substring(b).match(/^[^\w]*\w*/);I&&(O+=I[0].length);break}case"deleteContentBackward":b===C&&(S-=1);break;case"deleteContentForward":b===C&&(O+=1);break}_.preventDefault(),(L=this.linkService.eventBus)==null||L.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:E,change:y||"",willCommit:!1,selStart:S,selEnd:O}})}),this._setEventListeners(r,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],_=>_.target.value)}if(m&&r.addEventListener("blur",m),this.data.comb){const _=(this.data.rect[2]-this.data.rect[0])/h;r.classList.add("comb"),r.style.letterSpacing=`calc(${_}px * var(--scale-factor) - 1ch)`}}else r=document.createElement("div"),r.textContent=this.data.fieldValue,r.style.verticalAlign="middle",r.style.display="table-cell",this.data.hasOwnCanvas&&(r.hidden=!0);return this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class Iz extends Wu{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class Bz extends Wu{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,r=e.id;let a=t.getValue(r,{value:e.exportValue===e.fieldValue}).value;typeof a=="string"&&(a=a!=="Off",t.setValue(r,{value:a})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return Bu.add(s),s.setAttribute("data-element-id",r),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=e.fieldName,a&&s.setAttribute("checked",!0),s.setAttribute("exportValue",e.exportValue),s.tabIndex=Zg,s.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const f of this._getElementsByName(c,r)){const d=h&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=d),t.setValue(f.id,{value:d})}t.setValue(r,{value:h})}),s.addEventListener("resetform",l=>{const c=e.defaultFieldValue||"Off";l.target.checked=c===e.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",l=>{const c={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(r,{value:h.target.checked})}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class kO extends Wu{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,r=e.id;let a=t.getValue(r,{value:e.fieldValue===e.buttonValue}).value;if(typeof a=="string"&&(a=a!==e.buttonValue,t.setValue(r,{value:a})),a)for(const l of this._getElementsByName(e.fieldName,r))t.setValue(l.id,{value:!1});const s=document.createElement("input");if(Bu.add(s),s.setAttribute("data-element-id",r),s.disabled=e.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=e.fieldName,a&&s.setAttribute("checked",!0),s.tabIndex=Zg,s.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const f of this._getElementsByName(c,r))t.setValue(f.id,{value:!1});t.setValue(r,{value:h})}),s.addEventListener("resetform",l=>{const c=e.defaultFieldValue;l.target.checked=c!=null&&c===e.buttonValue}),this.enableScripting&&this.hasJSActions){const l=e.buttonValue;s.addEventListener("updatefromsandbox",c=>{const h={value:f=>{const d=l===f.detail.value;for(const m of this._getElementsByName(f.target.name)){const x=d&&m.id===r;m.domElement&&(m.domElement.checked=x),t.setValue(m.id,{value:x})}}};this._dispatchEventFromSandbox(h,c)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class Uz extends bO{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",r=>{this._dispatchEventFromSandbox({},r)})),t}}class Hz extends Wu{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,r=t.getValue(e,{value:this.data.fieldValue}),a=document.createElement("select");Bu.add(a),a.setAttribute("data-element-id",e),a.disabled=this.data.readOnly,this._setRequired(a,this.data.required),a.name=this.data.fieldName,a.tabIndex=Zg;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(a.size=this.data.options.length,this.data.multiSelect&&(a.multiple=!0)),a.addEventListener("resetform",d=>{const m=this.data.defaultFieldValue;for(const x of a.options)x.selected=x.value===m});for(const d of this.data.options){const m=document.createElement("option");m.textContent=d.displayValue,m.value=d.exportValue,r.value.includes(d.exportValue)&&(m.setAttribute("selected",!0),s=!1),a.append(m)}let l=null;if(s){const d=document.createElement("option");d.value=" ",d.setAttribute("hidden",!0),d.setAttribute("selected",!0),a.prepend(d),l=()=>{d.remove(),a.removeEventListener("input",l),l=null},a.addEventListener("input",l)}const c=d=>{const m=d?"value":"textContent",{options:x,multiple:_}=a;return _?Array.prototype.filter.call(x,y=>y.selected).map(y=>y[m]):x.selectedIndex===-1?null:x[x.selectedIndex][m]};let h=c(!1);const f=d=>{const m=d.target.options;return Array.prototype.map.call(m,x=>({displayValue:x.textContent,exportValue:x.value}))};return this.enableScripting&&this.hasJSActions?(a.addEventListener("updatefromsandbox",d=>{const m={value(x){l==null||l();const _=x.detail.value,y=new Set(Array.isArray(_)?_:[_]);for(const A of a.options)A.selected=y.has(A.value);t.setValue(e,{value:c(!0)}),h=c(!1)},multipleSelection(x){a.multiple=!0},remove(x){const _=a.options,y=x.detail.remove;_[y].selected=!1,a.remove(y),_.length>0&&Array.prototype.findIndex.call(_,E=>E.selected)===-1&&(_[0].selected=!0),t.setValue(e,{value:c(!0),items:f(x)}),h=c(!1)},clear(x){for(;a.length!==0;)a.remove(0);t.setValue(e,{value:null,items:[]}),h=c(!1)},insert(x){const{index:_,displayValue:y,exportValue:A}=x.detail.insert,E=a.children[_],b=document.createElement("option");b.textContent=y,b.value=A,E?E.before(b):a.append(b),t.setValue(e,{value:c(!0),items:f(x)}),h=c(!1)},items(x){const{items:_}=x.detail;for(;a.length!==0;)a.remove(0);for(const y of _){const{displayValue:A,exportValue:E}=y,b=document.createElement("option");b.textContent=A,b.value=E,a.append(b)}a.options.length>0&&(a.options[0].selected=!0),t.setValue(e,{value:c(!0),items:f(x)}),h=c(!1)},indices(x){const _=new Set(x.detail.indices);for(const y of x.target.options)y.selected=_.has(y.index);t.setValue(e,{value:c(!0)}),h=c(!1)},editable(x){x.target.disabled=!x.detail.editable}};this._dispatchEventFromSandbox(m,d)}),a.addEventListener("input",d=>{var _;const m=c(!0),x=c(!1);t.setValue(e,{value:m}),d.preventDefault(),(_=this.linkService.eventBus)==null||_.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:h,change:x,changeEx:m,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(a,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],d=>d.target.value)):a.addEventListener("input",function(d){t.setValue(e,{value:c(!0)})}),this.data.combo&&this._setTextStyle(a),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class Kw extends xr{constructor(t){const{data:e,elements:r}=t;super(t,{isRenderable:xr._hasPopupData(e)}),this.elements=r,this.popup=null}render(){this.container.classList.add("popupAnnotation");const t=this.popup=new zz({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),e=[];for(const r of this.elements)r.popup=t,r.container.ariaHasPopup="dialog",e.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",e.map(r=>`${dE}${r}`).join(",")),this.container}}var Of,Vx,$x,Df,ou,cr,io,Ff,sg,og,Mf,so,bi,oo,lg,lo,cg,lu,cu,Nt,K1,Qw,CO,RO,OO,DO,Q1,Z1,Zw;class zz{constructor({container:t,color:e,elements:r,titleObj:a,modificationDate:s,contentsObj:l,richText:c,parent:h,rect:f,parentRect:d,open:m}){R(this,Nt);R(this,Of,D(this,Nt,OO).bind(this));R(this,Vx,D(this,Nt,Zw).bind(this));R(this,$x,D(this,Nt,Z1).bind(this));R(this,Df,D(this,Nt,Q1).bind(this));R(this,ou,null);R(this,cr,null);R(this,io,null);R(this,Ff,null);R(this,sg,null);R(this,og,null);R(this,Mf,null);R(this,so,!1);R(this,bi,null);R(this,oo,null);R(this,lg,null);R(this,lo,null);R(this,cg,null);R(this,lu,null);R(this,cu,!1);var x;T(this,cr,t),T(this,cg,a),T(this,io,l),T(this,lo,c),T(this,og,h),T(this,ou,e),T(this,lg,f),T(this,Mf,d),T(this,sg,r),T(this,Ff,mE.toDateObject(s)),this.trigger=r.flatMap(_=>_.getElementsToTriggerPopup());for(const _ of this.trigger)_.addEventListener("click",g(this,Df)),_.addEventListener("mouseenter",g(this,$x)),_.addEventListener("mouseleave",g(this,Vx)),_.classList.add("popupTriggerArea");for(const _ of r)(x=_.container)==null||x.addEventListener("keydown",g(this,Of));g(this,cr).hidden=!0,m&&D(this,Nt,Q1).call(this)}render(){if(g(this,bi))return;const t=T(this,bi,document.createElement("div"));if(t.className="popup",g(this,ou)){const s=t.style.outlineColor=je.makeHexColor(...g(this,ou));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`:t.style.backgroundColor=je.makeHexColor(...g(this,ou).map(c=>Math.floor(.7*(255-c)+c)))}const e=document.createElement("span");e.className="header";const r=document.createElement("h1");if(e.append(r),{dir:r.dir,str:r.textContent}=g(this,cg),t.append(e),g(this,Ff)){const s=document.createElement("span");s.classList.add("popupDate"),s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:g(this,Ff).valueOf()})),e.append(s)}const a=g(this,Nt,K1);if(a)EO.render({xfaHtml:a,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(g(this,io));t.append(s)}g(this,cr).append(t)}_formatContents({str:t,dir:e}){const r=document.createElement("p");r.classList.add("popupContent"),r.dir=e;const a=t.split(/(?:\r\n?|\n)/);for(let s=0,l=a.length;s<l;++s){const c=a[s];r.append(document.createTextNode(c)),s<l-1&&r.append(document.createElement("br"))}return r}updateEdited({rect:t,popupContent:e}){var r;g(this,lu)||T(this,lu,{contentsObj:g(this,io),richText:g(this,lo)}),t&&T(this,oo,null),e&&(T(this,lo,D(this,Nt,RO).call(this,e)),T(this,io,null)),(r=g(this,bi))==null||r.remove(),T(this,bi,null)}resetEdited(){var t;g(this,lu)&&({contentsObj:Ln(this,io)._,richText:Ln(this,lo)._}=g(this,lu),T(this,lu,null),(t=g(this,bi))==null||t.remove(),T(this,bi,null),T(this,oo,null))}forceHide(){T(this,cu,this.isVisible),g(this,cu)&&(g(this,cr).hidden=!0)}maybeShow(){g(this,cu)&&(g(this,bi)||D(this,Nt,Z1).call(this),T(this,cu,!1),g(this,cr).hidden=!1)}get isVisible(){return g(this,cr).hidden===!1}}Of=new WeakMap,Vx=new WeakMap,$x=new WeakMap,Df=new WeakMap,ou=new WeakMap,cr=new WeakMap,io=new WeakMap,Ff=new WeakMap,sg=new WeakMap,og=new WeakMap,Mf=new WeakMap,so=new WeakMap,bi=new WeakMap,oo=new WeakMap,lg=new WeakMap,lo=new WeakMap,cg=new WeakMap,lu=new WeakMap,cu=new WeakMap,Nt=new WeakSet,K1=function(){const t=g(this,lo),e=g(this,io);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&g(this,lo).html||null},Qw=function(){var t,e,r;return((r=(e=(t=g(this,Nt,K1))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:r.fontSize)||0},CO=function(){var t,e,r;return((r=(e=(t=g(this,Nt,K1))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:r.color)||null},RO=function(t){const e=[],r={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},a={style:{color:g(this,Nt,CO),fontSize:g(this,Nt,Qw)?`calc(${g(this,Nt,Qw)}px * var(--scale-factor))`:""}};for(const s of t.split(`
`))e.push({name:"span",value:s,attributes:a});return r},OO=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&g(this,so))&&D(this,Nt,Q1).call(this)},DO=function(){if(g(this,oo)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:r,pageX:a,pageY:s}}}=g(this,og);let l=!!g(this,Mf),c=l?g(this,Mf):g(this,lg);for(const y of g(this,sg))if(!c||je.intersect(y.data.rect,c)!==null){c=y.data.rect,l=!0;break}const h=je.normalizeRect([c[0],t[3]-c[1]+t[1],c[2],t[3]-c[3]+t[1]]),d=l?c[2]-c[0]+5:0,m=h[0]+d,x=h[1];T(this,oo,[100*(m-a)/e,100*(x-s)/r]);const{style:_}=g(this,cr);_.left=`${g(this,oo)[0]}%`,_.top=`${g(this,oo)[1]}%`},Q1=function(){T(this,so,!g(this,so)),g(this,so)?(D(this,Nt,Z1).call(this),g(this,cr).addEventListener("click",g(this,Df)),g(this,cr).addEventListener("keydown",g(this,Of))):(D(this,Nt,Zw).call(this),g(this,cr).removeEventListener("click",g(this,Df)),g(this,cr).removeEventListener("keydown",g(this,Of)))},Z1=function(){g(this,bi)||this.render(),this.isVisible?g(this,so)&&g(this,cr).classList.add("focused"):(D(this,Nt,DO).call(this),g(this,cr).hidden=!1,g(this,cr).style.zIndex=parseInt(g(this,cr).style.zIndex)+1e3)},Zw=function(){g(this,cr).classList.remove("focused"),!(g(this,so)||!this.isVisible)&&(g(this,cr).hidden=!0,g(this,cr).style.zIndex=parseInt(g(this,cr).style.zIndex)-1e3)};class FO extends xr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=at.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const r=document.createElement("span");r.textContent=e,t.append(r)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var ug;class jz extends xr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});R(this,ug,null)}render(){this.container.classList.add("lineAnnotation");const e=this.data,{width:r,height:a}=Ul(e.rect),s=this.svgFactory.create(r,a,!0),l=T(this,ug,this.svgFactory.createElement("svg:line"));return l.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),l.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),l.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),l.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),l.setAttribute("stroke-width",e.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return g(this,ug)}addHighlightArea(){this.container.classList.add("highlightArea")}}ug=new WeakMap;var hg;class Gz extends xr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});R(this,hg,null)}render(){this.container.classList.add("squareAnnotation");const e=this.data,{width:r,height:a}=Ul(e.rect),s=this.svgFactory.create(r,a,!0),l=e.borderStyle.width,c=T(this,hg,this.svgFactory.createElement("svg:rect"));return c.setAttribute("x",l/2),c.setAttribute("y",l/2),c.setAttribute("width",r-l),c.setAttribute("height",a-l),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),s.append(c),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return g(this,hg)}addHighlightArea(){this.container.classList.add("highlightArea")}}hg=new WeakMap;var fg;class Vz extends xr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});R(this,fg,null)}render(){this.container.classList.add("circleAnnotation");const e=this.data,{width:r,height:a}=Ul(e.rect),s=this.svgFactory.create(r,a,!0),l=e.borderStyle.width,c=T(this,fg,this.svgFactory.createElement("svg:ellipse"));return c.setAttribute("cx",r/2),c.setAttribute("cy",a/2),c.setAttribute("rx",r/2-l/2),c.setAttribute("ry",a/2-l/2),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),s.append(c),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return g(this,fg)}addHighlightArea(){this.container.classList.add("highlightArea")}}fg=new WeakMap;var dg;class MO extends xr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});R(this,dg,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:r,borderStyle:a,popupRef:s}}=this;if(!r)return this.container;const{width:l,height:c}=Ul(e),h=this.svgFactory.create(l,c,!0);let f=[];for(let m=0,x=r.length;m<x;m+=2){const _=r[m]-e[0],y=e[3]-r[m+1];f.push(`${_},${y}`)}f=f.join(" ");const d=T(this,dg,this.svgFactory.createElement(this.svgElementName));return d.setAttribute("points",f),d.setAttribute("stroke-width",a.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),h.append(d),this.container.append(h),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return g(this,dg)}addHighlightArea(){this.container.classList.add("highlightArea")}}dg=new WeakMap;class $z extends MO{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Xz extends xr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var pg,uu,gg,Jw;class wE extends xr{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});R(this,gg);R(this,pg,null);R(this,uu,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?at.HIGHLIGHT:at.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:r,inkLists:a,borderStyle:s,popupRef:l}}=this,{transform:c,width:h,height:f}=D(this,gg,Jw).call(this,r,e),d=this.svgFactory.create(h,f,!0),m=T(this,pg,this.svgFactory.createElement("svg:g"));d.append(m),m.setAttribute("stroke-width",s.width||1),m.setAttribute("stroke-linecap","round"),m.setAttribute("stroke-linejoin","round"),m.setAttribute("stroke-miterlimit",10),m.setAttribute("stroke","transparent"),m.setAttribute("fill","transparent"),m.setAttribute("transform",c);for(let x=0,_=a.length;x<_;x++){const y=this.svgFactory.createElement(this.svgElementName);g(this,uu).push(y),y.setAttribute("points",a[x].join(",")),m.append(y)}return!l&&this.hasPopupData&&this._createPopup(),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:r,points:a,rect:s}=e,l=g(this,pg);if(r>=0&&l.setAttribute("stroke-width",r||1),a)for(let c=0,h=g(this,uu).length;c<h;c++)g(this,uu)[c].setAttribute("points",a[c].join(","));if(s){const{transform:c,width:h,height:f}=D(this,gg,Jw).call(this,this.data.rotation,s);l.parentElement.setAttribute("viewBox",`0 0 ${h} ${f}`),l.setAttribute("transform",c)}}getElementsToTriggerPopup(){return g(this,uu)}addHighlightArea(){this.container.classList.add("highlightArea")}}pg=new WeakMap,uu=new WeakMap,gg=new WeakSet,Jw=function(e,r){switch(e){case 90:return{transform:`rotate(90) translate(${-r[0]},${r[1]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};case 180:return{transform:`rotate(180) translate(${-r[2]},${r[1]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]};case 270:return{transform:`rotate(270) translate(${-r[2]},${r[3]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};default:return{transform:`translate(${-r[0]},${r[3]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]}}};class LO extends xr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=at.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class qz extends xr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Yz extends xr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Wz extends xr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class NO extends xr{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=at.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var mg,xg,eA;class Kz extends xr{constructor(e){var a;super(e,{isRenderable:!0});R(this,xg);R(this,mg,null);const{file:r}=this.data;this.filename=r.filename,this.content=r.content,(a=this.linkService.eventBus)==null||a.dispatch("fileattachmentannotation",{source:this,...r})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:r}=this;let a;r.hasAppearance||r.fillAlpha===0?a=document.createElement("div"):(a=document.createElement("img"),a.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(r.name)?"paperclip":"pushpin"}.svg`,r.fillAlpha&&r.fillAlpha<1&&(a.style=`filter: opacity(${Math.round(r.fillAlpha*100)}%);`)),a.addEventListener("dblclick",D(this,xg,eA).bind(this)),T(this,mg,a);const{isMac:s}=Vn.platform;return e.addEventListener("keydown",l=>{l.key==="Enter"&&(s?l.metaKey:l.ctrlKey)&&D(this,xg,eA).call(this)}),!r.popupRef&&this.hasPopupData?this._createPopup():a.classList.add("popupTriggerArea"),e.append(a),e}getElementsToTriggerPopup(){return g(this,mg)}addHighlightArea(){this.container.classList.add("highlightArea")}}mg=new WeakMap,xg=new WeakSet,eA=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)};var vg,hu,fu,_g,Uu,PO,tA;class Qz{constructor({div:t,accessibilityManager:e,annotationCanvasMap:r,annotationEditorUIManager:a,page:s,viewport:l,structTreeLayer:c}){R(this,Uu);R(this,vg,null);R(this,hu,null);R(this,fu,new Map);R(this,_g,null);this.div=t,T(this,vg,e),T(this,hu,r),T(this,_g,c||null),this.page=s,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=a}hasEditableAnnotations(){return g(this,fu).size>0}async render(t){var l;const{annotations:e}=t,r=this.div;Pu(r,this.viewport);const a=new Map,s={data:null,layer:r,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new yE,annotationStorage:t.annotationStorage||new vE,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const c of e){if(c.noHTML)continue;const h=c.annotationType===Or.POPUP;if(h){const m=a.get(c.id);if(!m)continue;s.elements=m}else{const{width:m,height:x}=Ul(c.rect);if(m<=0||x<=0)continue}s.data=c;const f=Lz.create(s);if(!f.isRenderable)continue;if(!h&&c.popupRef){const m=a.get(c.popupRef);m?m.push(f):a.set(c.popupRef,[f])}const d=f.render();c.hidden&&(d.style.visibility="hidden"),await D(this,Uu,PO).call(this,d,c.id),f._isEditable&&(g(this,fu).set(f.data.id,f),(l=this._annotationEditorUIManager)==null||l.renderAnnotationElement(f))}D(this,Uu,tA).call(this)}update({viewport:t}){const e=this.div;this.viewport=t,Pu(e,{rotation:t.rotation}),D(this,Uu,tA).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(g(this,fu).values())}getEditableAnnotation(t){return g(this,fu).get(t)}}vg=new WeakMap,hu=new WeakMap,fu=new WeakMap,_g=new WeakMap,Uu=new WeakSet,PO=async function(t,e){var l,c;const r=t.firstChild||t,a=r.id=`${dE}${e}`,s=await((l=g(this,_g))==null?void 0:l.getAriaAttributes(a));if(s)for(const[h,f]of s)r.setAttribute(h,f);this.div.append(t),(c=g(this,vg))==null||c.moveElementInDOM(this.div,t,r,!1)},tA=function(){if(!g(this,hu))return;const t=this.div;for(const[e,r]of g(this,hu)){const a=t.querySelector(`[data-annotation-id="${e}"]`);if(!a)continue;r.className="annotationContent";const{firstChild:s}=a;s?s.nodeName==="CANVAS"?s.replaceWith(r):s.classList.contains("annotationContent")?s.after(r):s.before(r):a.append(r)}g(this,hu).clear()};const F1=/\r\n?|\n/g;var Si,_a,yg,du,ya,kr,IO,BO,UO,J1,Eo,ex,tx,HO,nA,zO;const Gt=class Gt extends ir{constructor(e){super({...e,name:"freeTextEditor"});R(this,kr);R(this,Si);R(this,_a,"");R(this,yg,`${this.id}-editor`);R(this,du,null);R(this,ya);T(this,Si,e.color||Gt._defaultColor||ir._defaultLineColor),T(this,ya,e.fontSize||Gt._defaultFontSize)}static get _keyboardManager(){const e=Gt.prototype,r=l=>l.isEmpty(),a=Iu.TRANSLATE_SMALL,s=Iu.TRANSLATE_BIG;return ht(this,"_keyboardManager",new Qg([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-a,0],checker:r}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:r}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[a,0],checker:r}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[s,0],checker:r}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-a],checker:r}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:r}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,a],checker:r}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,s],checker:r}]]))}static initialize(e,r){ir.initialize(e,r);const a=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(a.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,r){switch(e){case mt.FREETEXT_SIZE:Gt._defaultFontSize=r;break;case mt.FREETEXT_COLOR:Gt._defaultColor=r;break}}updateParams(e,r){switch(e){case mt.FREETEXT_SIZE:D(this,kr,IO).call(this,r);break;case mt.FREETEXT_COLOR:D(this,kr,BO).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[mt.FREETEXT_SIZE,Gt._defaultFontSize],[mt.FREETEXT_COLOR,Gt._defaultColor||ir._defaultLineColor]]}get propertiesToUpdate(){return[[mt.FREETEXT_SIZE,g(this,ya)],[mt.FREETEXT_COLOR,g(this,Si)]]}_translateEmpty(e,r){this._uiManager.translateSelectedEditors(e,r,!0)}getInitialTranslation(){const e=this.parentScale;return[-Gt._internalPadding*e,-(Gt._internalPadding+g(this,ya))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(at.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),T(this,du,new AbortController);const e=this._uiManager.combinedSignal(g(this,du));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e})}disableEditMode(){var e;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",g(this,yg)),this._isDraggable=!0,(e=g(this,du))==null||e.abort(),T(this,du,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){var r;this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),(r=this._initialOptions)!=null&&r.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=g(this,_a),r=T(this,_a,D(this,kr,UO).call(this).trimEnd());if(e===r)return;const a=s=>{if(T(this,_a,s),!s){this.remove();return}D(this,kr,tx).call(this),this._uiManager.rebuild(this),D(this,kr,J1).call(this)};this.addCommands({cmd:()=>{a(r)},undo:()=>{a(e)},mustExec:!1}),D(this,kr,J1).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(e){this.enterInEditMode()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){Gt._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,r;this.width&&(e=this.x,r=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",g(this,yg)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:a}=this.editorDiv;if(a.fontSize=`calc(${g(this,ya)}px * var(--scale-factor))`,a.color=g(this,Si),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Sx(this,this.div,["dblclick","keydown"]),this.width){const[s,l]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[h,f]=this.getInitialTranslation();[h,f]=this.pageTranslationToScreen(h,f);const[d,m]=this.pageDimensions,[x,_]=this.pageTranslation;let y,A;switch(this.rotation){case 0:y=e+(c[0]-x)/d,A=r+this.height-(c[1]-_)/m;break;case 90:y=e+(c[0]-x)/d,A=r-(c[1]-_)/m,[h,f]=[f,-h];break;case 180:y=e-this.width+(c[0]-x)/d,A=r-(c[1]-_)/m,[h,f]=[-h,-f];break;case 270:y=e+(c[0]-x-this.height*m)/d,A=r+(c[1]-_-this.width*d)/m,[h,f]=[-f,h];break}this.setAt(y*s,A*l,h,f)}else this.setAt(e*s,r*l,this.width*s,this.height*l);D(this,kr,tx).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var y,A,E;const r=e.clipboardData||window.clipboardData,{types:a}=r;if(a.length===1&&a[0]==="text/plain")return;e.preventDefault();const s=D(y=Gt,Eo,nA).call(y,r.getData("text")||"").replaceAll(F1,`
`);if(!s)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!s.includes(`
`)){c.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:h,startOffset:f}=c,d=[],m=[];if(h.nodeType===Node.TEXT_NODE){const b=h.parentElement;if(m.push(h.nodeValue.slice(f).replaceAll(F1,"")),b!==this.editorDiv){let C=d;for(const S of this.editorDiv.childNodes){if(S===b){C=m;continue}C.push(D(A=Gt,Eo,ex).call(A,S))}}d.push(h.nodeValue.slice(0,f).replaceAll(F1,""))}else if(h===this.editorDiv){let b=d,C=0;for(const S of this.editorDiv.childNodes)C++===f&&(b=m),b.push(D(E=Gt,Eo,ex).call(E,S))}T(this,_a,`${d.join(`
`)}${s}${m.join(`
`)}`),D(this,kr,tx).call(this);const x=new Range;let _=d.reduce((b,C)=>b+C.length,0);for(const{firstChild:b}of this.editorDiv.childNodes)if(b.nodeType===Node.TEXT_NODE){const C=b.nodeValue.length;if(_<=C){x.setStart(b,_),x.setEnd(b,_);break}_-=C}l.removeAllRanges(),l.addRange(x)}get contentDiv(){return this.editorDiv}static async deserialize(e,r,a){var c;let s=null;if(e instanceof FO){const{data:{defaultAppearanceData:{fontSize:h,fontColor:f},rect:d,rotation:m,id:x,popupRef:_},textContent:y,textPosition:A,parent:{page:{pageNumber:E}}}=e;if(!y||y.length===0)return null;s=e={annotationType:at.FREETEXT,color:Array.from(f),fontSize:h,value:y.join(`
`),position:A,pageIndex:E-1,rect:d.slice(0),rotation:m,id:x,deleted:!1,popupRef:_}}const l=await super.deserialize(e,r,a);return T(l,ya,e.fontSize),T(l,Si,je.makeHexColor(...e.color)),T(l,_a,D(c=Gt,Eo,nA).call(c,e.value)),l.annotationElementId=e.id||null,l._initialData=s,l}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r=Gt._internalPadding*this.parentScale,a=this.getRect(r,r),s=ir._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:g(this,Si)),l={annotationType:at.FREETEXT,color:s,fontSize:g(this,ya),value:D(this,kr,HO).call(this),pageIndex:this.pageIndex,rect:a,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?l:this.annotationElementId&&!D(this,kr,zO).call(this,l)?null:(l.id=this.annotationElementId,l)}renderAnnotationElement(e){const r=super.renderAnnotationElement(e);if(this.deleted)return r;const{style:a}=r;a.fontSize=`calc(${g(this,ya)}px * var(--scale-factor))`,a.color=g(this,Si),r.replaceChildren();for(const l of g(this,_a).split(`
`)){const c=document.createElement("div");c.append(l?document.createTextNode(l):document.createElement("br")),r.append(c)}const s=Gt._internalPadding*this.parentScale;return e.updateEdited({rect:this.getRect(s,s),popupContent:g(this,_a)}),r}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};Si=new WeakMap,_a=new WeakMap,yg=new WeakMap,du=new WeakMap,ya=new WeakMap,kr=new WeakSet,IO=function(e){const r=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--scale-factor))`,this.translate(0,-(s-g(this,ya))*this.parentScale),T(this,ya,s),D(this,kr,J1).call(this)},a=g(this,ya);this.addCommands({cmd:r.bind(this,e),undo:r.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:mt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},BO=function(e){const r=s=>{T(this,Si,this.editorDiv.style.color=s)},a=g(this,Si);this.addCommands({cmd:r.bind(this,e),undo:r.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:mt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},UO=function(){var a;const e=[];this.editorDiv.normalize();let r=null;for(const s of this.editorDiv.childNodes)(r==null?void 0:r.nodeType)===Node.TEXT_NODE&&s.nodeName==="BR"||(e.push(D(a=Gt,Eo,ex).call(a,s)),r=s);return e.join(`
`)},J1=function(){const[e,r]=this.parentDimensions;let a;if(this.isAttachedToDOM)a=this.div.getBoundingClientRect();else{const{currentLayer:s,div:l}=this,c=l.style.display,h=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",s.div.append(this.div),a=l.getBoundingClientRect(),l.remove(),l.style.display=c,l.classList.toggle("hidden",h)}this.rotation%180===this.parentRotation%180?(this.width=a.width/e,this.height=a.height/r):(this.width=a.height/e,this.height=a.width/r),this.fixAndSetPosition()},Eo=new WeakSet,ex=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(F1,"")},tx=function(){if(this.editorDiv.replaceChildren(),!!g(this,_a))for(const e of g(this,_a).split(`
`)){const r=document.createElement("div");r.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(r)}},HO=function(){return g(this,_a).replaceAll(""," ")},nA=function(e){return e.replaceAll(" ","")},zO=function(e){const{value:r,fontSize:a,color:s,pageIndex:l}=this._initialData;return this._hasBeenMoved||e.value!==r||e.fontSize!==a||e.color.some((c,h)=>c!==s[h])||e.pageIndex!==l},R(Gt,Eo),Ve(Gt,"_freeTextDefaultContent",""),Ve(Gt,"_internalPadding",0),Ve(Gt,"_defaultColor",null),Ve(Gt,"_defaultFontSize",10),Ve(Gt,"_type","freetext"),Ve(Gt,"_editorType",at.FREETEXT);let rA=Gt;class Ie{toSVGPath(){It("Abstract method `toSVGPath` must be implemented.")}get box(){It("Abstract getter `box` must be implemented.")}serialize(t,e){It("Abstract method `serialize` must be implemented.")}static _rescale(t,e,r,a,s,l){l||(l=new Float32Array(t.length));for(let c=0,h=t.length;c<h;c+=2)l[c]=e+t[c]*a,l[c+1]=r+t[c+1]*s;return l}static _rescaleAndSwap(t,e,r,a,s,l){l||(l=new Float32Array(t.length));for(let c=0,h=t.length;c<h;c+=2)l[c]=e+t[c+1]*a,l[c+1]=r+t[c]*s;return l}static _translate(t,e,r,a){a||(a=new Float32Array(t.length));for(let s=0,l=t.length;s<l;s+=2)a[s]=e+t[s],a[s+1]=r+t[s+1];return a}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,r,a,s){switch(s){case 90:return[1-e/r,t/a];case 180:return[1-t/r,1-e/a];case 270:return[e/r,1-t/a];default:return[t/r,e/a]}}static _normalizePagePoint(t,e,r){switch(r){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,r,a,s,l){return[(t+5*r)/6,(e+5*a)/6,(5*r+s)/6,(5*a+l)/6,(r+s)/2,(a+l)/2]}}Ve(Ie,"PRECISION",1e-4);var wa,Ti,Lf,Nf,us,ut,pu,gu,wg,Ag,Pf,If,Sl,Eg,Xx,qx,Pr,I0,jO,GO,VO,$O,XO,qO;const Vs=class Vs{constructor({x:t,y:e},r,a,s,l,c=0){R(this,Pr);R(this,wa);R(this,Ti,[]);R(this,Lf);R(this,Nf);R(this,us,[]);R(this,ut,new Float32Array(18));R(this,pu);R(this,gu);R(this,wg);R(this,Ag);R(this,Pf);R(this,If);R(this,Sl,[]);T(this,wa,r),T(this,If,s*a),T(this,Nf,l),g(this,ut).set([NaN,NaN,NaN,NaN,t,e],6),T(this,Lf,c),T(this,Ag,g(Vs,Eg)*a),T(this,wg,g(Vs,qx)*a),T(this,Pf,a),g(this,Sl).push(t,e)}isEmpty(){return isNaN(g(this,ut)[8])}add({x:t,y:e}){var B;T(this,pu,t),T(this,gu,e);const[r,a,s,l]=g(this,wa);let[c,h,f,d]=g(this,ut).subarray(8,12);const m=t-f,x=e-d,_=Math.hypot(m,x);if(_<g(this,wg))return!1;const y=_-g(this,Ag),A=y/_,E=A*m,b=A*x;let C=c,S=h;c=f,h=d,f+=E,d+=b,(B=g(this,Sl))==null||B.push(t,e);const O=-b/y,L=E/y,I=O*g(this,If),F=L*g(this,If);return g(this,ut).set(g(this,ut).subarray(2,8),0),g(this,ut).set([f+I,d+F],4),g(this,ut).set(g(this,ut).subarray(14,18),12),g(this,ut).set([f-I,d-F],16),isNaN(g(this,ut)[6])?(g(this,us).length===0&&(g(this,ut).set([c+I,h+F],2),g(this,us).push(NaN,NaN,NaN,NaN,(c+I-r)/s,(h+F-a)/l),g(this,ut).set([c-I,h-F],14),g(this,Ti).push(NaN,NaN,NaN,NaN,(c-I-r)/s,(h-F-a)/l)),g(this,ut).set([C,S,c,h,f,d],6),!this.isEmpty()):(g(this,ut).set([C,S,c,h,f,d],6),Math.abs(Math.atan2(S-h,C-c)-Math.atan2(b,E))<Math.PI/2?([c,h,f,d]=g(this,ut).subarray(2,6),g(this,us).push(NaN,NaN,NaN,NaN,((c+f)/2-r)/s,((h+d)/2-a)/l),[c,h,C,S]=g(this,ut).subarray(14,18),g(this,Ti).push(NaN,NaN,NaN,NaN,((C+c)/2-r)/s,((S+h)/2-a)/l),!0):([C,S,c,h,f,d]=g(this,ut).subarray(0,6),g(this,us).push(((C+5*c)/6-r)/s,((S+5*h)/6-a)/l,((5*c+f)/6-r)/s,((5*h+d)/6-a)/l,((c+f)/2-r)/s,((h+d)/2-a)/l),[f,d,c,h,C,S]=g(this,ut).subarray(12,18),g(this,Ti).push(((C+5*c)/6-r)/s,((S+5*h)/6-a)/l,((5*c+f)/6-r)/s,((5*h+d)/6-a)/l,((c+f)/2-r)/s,((h+d)/2-a)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const t=g(this,us),e=g(this,Ti);if(isNaN(g(this,ut)[6])&&!this.isEmpty())return D(this,Pr,jO).call(this);const r=[];r.push(`M${t[4]} ${t[5]}`);for(let a=6;a<t.length;a+=6)isNaN(t[a])?r.push(`L${t[a+4]} ${t[a+5]}`):r.push(`C${t[a]} ${t[a+1]} ${t[a+2]} ${t[a+3]} ${t[a+4]} ${t[a+5]}`);D(this,Pr,VO).call(this,r);for(let a=e.length-6;a>=6;a-=6)isNaN(e[a])?r.push(`L${e[a+4]} ${e[a+5]}`):r.push(`C${e[a]} ${e[a+1]} ${e[a+2]} ${e[a+3]} ${e[a+4]} ${e[a+5]}`);return D(this,Pr,GO).call(this,r),r.join(" ")}newFreeDrawOutline(t,e,r,a,s,l){return new YO(t,e,r,a,s,l)}getOutlines(){var m;const t=g(this,us),e=g(this,Ti),r=g(this,ut),[a,s,l,c]=g(this,wa),h=new Float32Array((((m=g(this,Sl))==null?void 0:m.length)??0)+2);for(let x=0,_=h.length-2;x<_;x+=2)h[x]=(g(this,Sl)[x]-a)/l,h[x+1]=(g(this,Sl)[x+1]-s)/c;if(h[h.length-2]=(g(this,pu)-a)/l,h[h.length-1]=(g(this,gu)-s)/c,isNaN(r[6])&&!this.isEmpty())return D(this,Pr,$O).call(this,h);const f=new Float32Array(g(this,us).length+24+g(this,Ti).length);let d=t.length;for(let x=0;x<d;x+=2){if(isNaN(t[x])){f[x]=f[x+1]=NaN;continue}f[x]=t[x],f[x+1]=t[x+1]}d=D(this,Pr,qO).call(this,f,d);for(let x=e.length-6;x>=6;x-=6)for(let _=0;_<6;_+=2){if(isNaN(e[x+_])){f[d]=f[d+1]=NaN,d+=2;continue}f[d]=e[x+_],f[d+1]=e[x+_+1],d+=2}return D(this,Pr,XO).call(this,f,d),this.newFreeDrawOutline(f,h,g(this,wa),g(this,Pf),g(this,Lf),g(this,Nf))}};wa=new WeakMap,Ti=new WeakMap,Lf=new WeakMap,Nf=new WeakMap,us=new WeakMap,ut=new WeakMap,pu=new WeakMap,gu=new WeakMap,wg=new WeakMap,Ag=new WeakMap,Pf=new WeakMap,If=new WeakMap,Sl=new WeakMap,Eg=new WeakMap,Xx=new WeakMap,qx=new WeakMap,Pr=new WeakSet,I0=function(){const t=g(this,ut).subarray(4,6),e=g(this,ut).subarray(16,18),[r,a,s,l]=g(this,wa);return[(g(this,pu)+(t[0]-e[0])/2-r)/s,(g(this,gu)+(t[1]-e[1])/2-a)/l,(g(this,pu)+(e[0]-t[0])/2-r)/s,(g(this,gu)+(e[1]-t[1])/2-a)/l]},jO=function(){const[t,e,r,a]=g(this,wa),[s,l,c,h]=D(this,Pr,I0).call(this);return`M${(g(this,ut)[2]-t)/r} ${(g(this,ut)[3]-e)/a} L${(g(this,ut)[4]-t)/r} ${(g(this,ut)[5]-e)/a} L${s} ${l} L${c} ${h} L${(g(this,ut)[16]-t)/r} ${(g(this,ut)[17]-e)/a} L${(g(this,ut)[14]-t)/r} ${(g(this,ut)[15]-e)/a} Z`},GO=function(t){const e=g(this,Ti);t.push(`L${e[4]} ${e[5]} Z`)},VO=function(t){const[e,r,a,s]=g(this,wa),l=g(this,ut).subarray(4,6),c=g(this,ut).subarray(16,18),[h,f,d,m]=D(this,Pr,I0).call(this);t.push(`L${(l[0]-e)/a} ${(l[1]-r)/s} L${h} ${f} L${d} ${m} L${(c[0]-e)/a} ${(c[1]-r)/s}`)},$O=function(t){const e=g(this,ut),[r,a,s,l]=g(this,wa),[c,h,f,d]=D(this,Pr,I0).call(this),m=new Float32Array(36);return m.set([NaN,NaN,NaN,NaN,(e[2]-r)/s,(e[3]-a)/l,NaN,NaN,NaN,NaN,(e[4]-r)/s,(e[5]-a)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,f,d,NaN,NaN,NaN,NaN,(e[16]-r)/s,(e[17]-a)/l,NaN,NaN,NaN,NaN,(e[14]-r)/s,(e[15]-a)/l],0),this.newFreeDrawOutline(m,t,g(this,wa),g(this,Pf),g(this,Lf),g(this,Nf))},XO=function(t,e){const r=g(this,Ti);return t.set([NaN,NaN,NaN,NaN,r[4],r[5]],e),e+=6},qO=function(t,e){const r=g(this,ut).subarray(4,6),a=g(this,ut).subarray(16,18),[s,l,c,h]=g(this,wa),[f,d,m,x]=D(this,Pr,I0).call(this);return t.set([NaN,NaN,NaN,NaN,(r[0]-s)/c,(r[1]-l)/h,NaN,NaN,NaN,NaN,f,d,NaN,NaN,NaN,NaN,m,x,NaN,NaN,NaN,NaN,(a[0]-s)/c,(a[1]-l)/h],e),e+=24},R(Vs,Eg,8),R(Vs,Xx,2),R(Vs,qx,g(Vs,Eg)+g(Vs,Xx));let Cx=Vs;var Bf,mu,co,bg,Aa,Sg,mr,Yx,WO;class YO extends Ie{constructor(e,r,a,s,l,c){super();R(this,Yx);R(this,Bf);R(this,mu,new Float32Array(4));R(this,co);R(this,bg);R(this,Aa);R(this,Sg);R(this,mr);T(this,mr,e),T(this,Aa,r),T(this,Bf,a),T(this,Sg,s),T(this,co,l),T(this,bg,c),this.lastPoint=[NaN,NaN],D(this,Yx,WO).call(this,c);const[h,f,d,m]=g(this,mu);for(let x=0,_=e.length;x<_;x+=2)e[x]=(e[x]-h)/d,e[x+1]=(e[x+1]-f)/m;for(let x=0,_=r.length;x<_;x+=2)r[x]=(r[x]-h)/d,r[x+1]=(r[x+1]-f)/m}toSVGPath(){const e=[`M${g(this,mr)[4]} ${g(this,mr)[5]}`];for(let r=6,a=g(this,mr).length;r<a;r+=6){if(isNaN(g(this,mr)[r])){e.push(`L${g(this,mr)[r+4]} ${g(this,mr)[r+5]}`);continue}e.push(`C${g(this,mr)[r]} ${g(this,mr)[r+1]} ${g(this,mr)[r+2]} ${g(this,mr)[r+3]} ${g(this,mr)[r+4]} ${g(this,mr)[r+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,r,a,s],l){const c=a-e,h=s-r;let f,d;switch(l){case 0:f=Ie._rescale(g(this,mr),e,s,c,-h),d=Ie._rescale(g(this,Aa),e,s,c,-h);break;case 90:f=Ie._rescaleAndSwap(g(this,mr),e,r,c,h),d=Ie._rescaleAndSwap(g(this,Aa),e,r,c,h);break;case 180:f=Ie._rescale(g(this,mr),a,r,-c,h),d=Ie._rescale(g(this,Aa),a,r,-c,h);break;case 270:f=Ie._rescaleAndSwap(g(this,mr),a,s,-c,-h),d=Ie._rescaleAndSwap(g(this,Aa),a,s,-c,-h);break}return{outline:Array.from(f),points:[Array.from(d)]}}get box(){return g(this,mu)}newOutliner(e,r,a,s,l,c=0){return new Cx(e,r,a,s,l,c)}getNewOutline(e,r){const[a,s,l,c]=g(this,mu),[h,f,d,m]=g(this,Bf),x=l*d,_=c*m,y=a*d+h,A=s*m+f,E=this.newOutliner({x:g(this,Aa)[0]*x+y,y:g(this,Aa)[1]*_+A},g(this,Bf),g(this,Sg),e,g(this,bg),r??g(this,co));for(let b=2;b<g(this,Aa).length;b+=2)E.add({x:g(this,Aa)[b]*x+y,y:g(this,Aa)[b+1]*_+A});return E.getOutlines()}}Bf=new WeakMap,mu=new WeakMap,co=new WeakMap,bg=new WeakMap,Aa=new WeakMap,Sg=new WeakMap,mr=new WeakMap,Yx=new WeakSet,WO=function(e){const r=g(this,mr);let a=r[4],s=r[5],l=a,c=s,h=a,f=s,d=a,m=s;const x=e?Math.max:Math.min;for(let y=6,A=r.length;y<A;y+=6){if(isNaN(r[y]))l=Math.min(l,r[y+4]),c=Math.min(c,r[y+5]),h=Math.max(h,r[y+4]),f=Math.max(f,r[y+5]),m<r[y+5]?(d=r[y+4],m=r[y+5]):m===r[y+5]&&(d=x(d,r[y+4]));else{const E=je.bezierBoundingBox(a,s,...r.slice(y,y+6));l=Math.min(l,E[0]),c=Math.min(c,E[1]),h=Math.max(h,E[2]),f=Math.max(f,E[3]),m<E[3]?(d=E[2],m=E[3]):m===E[3]&&(d=x(d,E[2]))}a=r[y+4],s=r[y+5]}const _=g(this,mu);_[0]=l-g(this,co),_[1]=c-g(this,co),_[2]=h-l+2*g(this,co),_[3]=f-c+2*g(this,co),this.lastPoint=[d,m]};var Tg,kg,Tl,ki,Xn,KO,rx,QO,ZO,iA;class aA{constructor(t,e=0,r=0,a=!0){R(this,Xn);R(this,Tg);R(this,kg);R(this,Tl,[]);R(this,ki,[]);let s=1/0,l=-1/0,c=1/0,h=-1/0;const f=10**-4;for(const{x:E,y:b,width:C,height:S}of t){const O=Math.floor((E-e)/f)*f,L=Math.ceil((E+C+e)/f)*f,I=Math.floor((b-e)/f)*f,F=Math.ceil((b+S+e)/f)*f,W=[O,I,F,!0],B=[L,I,F,!1];g(this,Tl).push(W,B),s=Math.min(s,O),l=Math.max(l,L),c=Math.min(c,I),h=Math.max(h,F)}const d=l-s+2*r,m=h-c+2*r,x=s-r,_=c-r,y=g(this,Tl).at(a?-1:-2),A=[y[0],y[2]];for(const E of g(this,Tl)){const[b,C,S]=E;E[0]=(b-x)/d,E[1]=(C-_)/m,E[2]=(S-_)/m}T(this,Tg,new Float32Array([x,_,d,m])),T(this,kg,A)}getOutlines(){g(this,Tl).sort((e,r)=>e[0]-r[0]||e[1]-r[1]||e[2]-r[2]);const t=[];for(const e of g(this,Tl))e[3]?(t.push(...D(this,Xn,iA).call(this,e)),D(this,Xn,QO).call(this,e)):(D(this,Xn,ZO).call(this,e),t.push(...D(this,Xn,iA).call(this,e)));return D(this,Xn,KO).call(this,t)}}Tg=new WeakMap,kg=new WeakMap,Tl=new WeakMap,ki=new WeakMap,Xn=new WeakSet,KO=function(t){const e=[],r=new Set;for(const l of t){const[c,h,f]=l;e.push([c,h,l],[c,f,l])}e.sort((l,c)=>l[1]-c[1]||l[0]-c[0]);for(let l=0,c=e.length;l<c;l+=2){const h=e[l][2],f=e[l+1][2];h.push(f),f.push(h),r.add(h),r.add(f)}const a=[];let s;for(;r.size>0;){const l=r.values().next().value;let[c,h,f,d,m]=l;r.delete(l);let x=c,_=h;for(s=[c,f],a.push(s);;){let y;if(r.has(d))y=d;else if(r.has(m))y=m;else break;r.delete(y),[c,h,f,d,m]=y,x!==c&&(s.push(x,_,c,_===h?h:f),x=c),_=_===h?f:h}s.push(x,_)}return new Zz(a,g(this,Tg),g(this,kg))},rx=function(t){const e=g(this,ki);let r=0,a=e.length-1;for(;r<=a;){const s=r+a>>1,l=e[s][0];if(l===t)return s;l<t?r=s+1:a=s-1}return a+1},QO=function([,t,e]){const r=D(this,Xn,rx).call(this,t);g(this,ki).splice(r,0,[t,e])},ZO=function([,t,e]){const r=D(this,Xn,rx).call(this,t);for(let a=r;a<g(this,ki).length;a++){const[s,l]=g(this,ki)[a];if(s!==t)break;if(s===t&&l===e){g(this,ki).splice(a,1);return}}for(let a=r-1;a>=0;a--){const[s,l]=g(this,ki)[a];if(s!==t)break;if(s===t&&l===e){g(this,ki).splice(a,1);return}}},iA=function(t){const[e,r,a]=t,s=[[e,r,a]],l=D(this,Xn,rx).call(this,a);for(let c=0;c<l;c++){const[h,f]=g(this,ki)[c];for(let d=0,m=s.length;d<m;d++){const[,x,_]=s[d];if(!(f<=x||_<=h)){if(x>=h){if(_>f)s[d][1]=f;else{if(m===1)return[];s.splice(d,1),d--,m--}continue}s[d][2]=h,_>f&&s.push([e,f,_])}}}return s};var Cg,Uf;class Zz extends Ie{constructor(e,r,a){super();R(this,Cg);R(this,Uf);T(this,Uf,e),T(this,Cg,r),this.lastPoint=a}toSVGPath(){const e=[];for(const r of g(this,Uf)){let[a,s]=r;e.push(`M${a} ${s}`);for(let l=2;l<r.length;l+=2){const c=r[l],h=r[l+1];c===a?(e.push(`V${h}`),s=h):h===s&&(e.push(`H${c}`),a=c)}e.push("Z")}return e.join(" ")}serialize([e,r,a,s],l){const c=[],h=a-e,f=s-r;for(const d of g(this,Uf)){const m=new Array(d.length);for(let x=0;x<d.length;x+=2)m[x]=e+d[x]*h,m[x+1]=s-d[x+1]*f;c.push(m)}return c}get box(){return g(this,Cg)}get classNamesForOutlining(){return["highlightOutline"]}}Cg=new WeakMap,Uf=new WeakMap;class sA extends Cx{newFreeDrawOutline(t,e,r,a,s,l){return new Jz(t,e,r,a,s,l)}}class Jz extends YO{newOutliner(t,e,r,a,s,l=0){return new sA(t,e,r,a,s,l)}}var Ci,xu,Hf,Mr,Rg,zf,Og,Dg,kl,Ri,jf,Fg,Lt,oA,lA,cA,yc,JO,tl;const ra=class ra{constructor({editor:t=null,uiManager:e=null}){R(this,Lt);R(this,Ci,null);R(this,xu,null);R(this,Hf);R(this,Mr,null);R(this,Rg,!1);R(this,zf,!1);R(this,Og,null);R(this,Dg);R(this,kl,null);R(this,Ri,null);R(this,jf);var r;t?(T(this,zf,!1),T(this,jf,mt.HIGHLIGHT_COLOR),T(this,Og,t)):(T(this,zf,!0),T(this,jf,mt.HIGHLIGHT_DEFAULT_COLOR)),T(this,Ri,(t==null?void 0:t._uiManager)||e),T(this,Dg,g(this,Ri)._eventBus),T(this,Hf,(t==null?void 0:t.color)||((r=g(this,Ri))==null?void 0:r.highlightColors.values().next().value)||"#FFFF98"),g(ra,Fg)||T(ra,Fg,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return ht(this,"_keyboardManager",new Qg([[["Escape","mac+Escape"],ra.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ra.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ra.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ra.prototype._moveToPrevious],[["Home","mac+Home"],ra.prototype._moveToBeginning],[["End","mac+End"],ra.prototype._moveToEnd]]))}renderButton(){const t=T(this,Ci,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.setAttribute("aria-haspopup",!0);const e=g(this,Ri)._signal;t.addEventListener("click",D(this,Lt,yc).bind(this),{signal:e}),t.addEventListener("keydown",D(this,Lt,cA).bind(this),{signal:e});const r=T(this,xu,document.createElement("span"));return r.className="swatch",r.setAttribute("aria-hidden",!0),r.style.backgroundColor=g(this,Hf),t.append(r),t}renderMainDropdown(){const t=T(this,Mr,D(this,Lt,oA).call(this));return t.setAttribute("aria-orientation","horizontal"),t.setAttribute("aria-labelledby","highlightColorPickerLabel"),t}_colorSelectFromKeyboard(t){if(t.target===g(this,Ci)){D(this,Lt,yc).call(this,t);return}const e=t.target.getAttribute("data-color");e&&D(this,Lt,lA).call(this,e,t)}_moveToNext(t){var e,r;if(!g(this,Lt,tl)){D(this,Lt,yc).call(this,t);return}if(t.target===g(this,Ci)){(e=g(this,Mr).firstChild)==null||e.focus();return}(r=t.target.nextSibling)==null||r.focus()}_moveToPrevious(t){var e,r;if(t.target===((e=g(this,Mr))==null?void 0:e.firstChild)||t.target===g(this,Ci)){g(this,Lt,tl)&&this._hideDropdownFromKeyboard();return}g(this,Lt,tl)||D(this,Lt,yc).call(this,t),(r=t.target.previousSibling)==null||r.focus()}_moveToBeginning(t){var e;if(!g(this,Lt,tl)){D(this,Lt,yc).call(this,t);return}(e=g(this,Mr).firstChild)==null||e.focus()}_moveToEnd(t){var e;if(!g(this,Lt,tl)){D(this,Lt,yc).call(this,t);return}(e=g(this,Mr).lastChild)==null||e.focus()}hideDropdown(){var t,e;(t=g(this,Mr))==null||t.classList.add("hidden"),(e=g(this,kl))==null||e.abort(),T(this,kl,null)}_hideDropdownFromKeyboard(){var t;if(!g(this,zf)){if(!g(this,Lt,tl)){(t=g(this,Og))==null||t.unselect();return}this.hideDropdown(),g(this,Ci).focus({preventScroll:!0,focusVisible:g(this,Rg)})}}updateColor(t){if(g(this,xu)&&(g(this,xu).style.backgroundColor=t),!g(this,Mr))return;const e=g(this,Ri).highlightColors.values();for(const r of g(this,Mr).children)r.setAttribute("aria-selected",e.next().value===t)}destroy(){var t,e;(t=g(this,Ci))==null||t.remove(),T(this,Ci,null),T(this,xu,null),(e=g(this,Mr))==null||e.remove(),T(this,Mr,null)}};Ci=new WeakMap,xu=new WeakMap,Hf=new WeakMap,Mr=new WeakMap,Rg=new WeakMap,zf=new WeakMap,Og=new WeakMap,Dg=new WeakMap,kl=new WeakMap,Ri=new WeakMap,jf=new WeakMap,Fg=new WeakMap,Lt=new WeakSet,oA=function(){const t=document.createElement("div"),e=g(this,Ri)._signal;t.addEventListener("contextmenu",Bi,{signal:e}),t.className="dropdown",t.role="listbox",t.setAttribute("aria-multiselectable",!1),t.setAttribute("aria-orientation","vertical"),t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[r,a]of g(this,Ri).highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",a),s.title=r,s.setAttribute("data-l10n-id",g(ra,Fg)[r]);const l=document.createElement("span");s.append(l),l.className="swatch",l.style.backgroundColor=a,s.setAttribute("aria-selected",a===g(this,Hf)),s.addEventListener("click",D(this,Lt,lA).bind(this,a),{signal:e}),t.append(s)}return t.addEventListener("keydown",D(this,Lt,cA).bind(this),{signal:e}),t},lA=function(t,e){e.stopPropagation(),g(this,Dg).dispatch("switchannotationeditorparams",{source:this,type:g(this,jf),value:t})},cA=function(t){ra._keyboardManager.exec(this,t)},yc=function(t){if(g(this,Lt,tl)){this.hideDropdown();return}if(T(this,Rg,t.detail===0),g(this,kl)||(T(this,kl,new AbortController),window.addEventListener("pointerdown",D(this,Lt,JO).bind(this),{signal:g(this,Ri).combinedSignal(g(this,kl))})),g(this,Mr)){g(this,Mr).classList.remove("hidden");return}const e=T(this,Mr,D(this,Lt,oA).call(this));g(this,Ci).append(e)},JO=function(t){var e;(e=g(this,Mr))!=null&&e.contains(t.target)||this.hideDropdown()},tl=function(){return g(this,Mr)&&!g(this,Mr).classList.contains("hidden")},R(ra,Fg,null);let Rx=ra;var Gf,Mg,uo,vu,Vf,ia,Lg,Ng,_u,ti,Ea,nn,$f,ho,yn,Xf,ri,Pg,tt,uA,nx,eD,tD,rD,hA,wc,si,zh,nD,ax,B0,aD,iD,sD,oD,lD;const Ct=class Ct extends ir{constructor(e){super({...e,name:"highlightEditor"});R(this,tt);R(this,Gf,null);R(this,Mg,0);R(this,uo);R(this,vu,null);R(this,Vf,null);R(this,ia,null);R(this,Lg,null);R(this,Ng,0);R(this,_u,null);R(this,ti,null);R(this,Ea,null);R(this,nn,!1);R(this,$f,null);R(this,ho);R(this,yn,null);R(this,Xf,"");R(this,ri);R(this,Pg,"");this.color=e.color||Ct._defaultColor,T(this,ri,e.thickness||Ct._defaultThickness),T(this,ho,e.opacity||Ct._defaultOpacity),T(this,uo,e.boxes||null),T(this,Pg,e.methodOfCreation||""),T(this,Xf,e.text||""),this._isDraggable=!1,e.highlightId>-1?(T(this,nn,!0),D(this,tt,nx).call(this,e),D(this,tt,wc).call(this)):g(this,uo)&&(T(this,Gf,e.anchorNode),T(this,Mg,e.anchorOffset),T(this,Lg,e.focusNode),T(this,Ng,e.focusOffset),D(this,tt,uA).call(this),D(this,tt,wc).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const e=Ct.prototype;return ht(this,"_keyboardManager",new Qg([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:g(this,nn)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:g(this,ri),methodOfCreation:g(this,Pg)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,r){var a;ir.initialize(e,r),Ct._defaultColor||(Ct._defaultColor=((a=r.highlightColors)==null?void 0:a.values().next().value)||"#fff066")}static updateDefaultParams(e,r){switch(e){case mt.HIGHLIGHT_DEFAULT_COLOR:Ct._defaultColor=r;break;case mt.HIGHLIGHT_THICKNESS:Ct._defaultThickness=r;break}}translateInPage(e,r){}get toolbarPosition(){return g(this,$f)}updateParams(e,r){switch(e){case mt.HIGHLIGHT_COLOR:D(this,tt,eD).call(this,r);break;case mt.HIGHLIGHT_THICKNESS:D(this,tt,tD).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[mt.HIGHLIGHT_DEFAULT_COLOR,Ct._defaultColor],[mt.HIGHLIGHT_THICKNESS,Ct._defaultThickness]]}get propertiesToUpdate(){return[[mt.HIGHLIGHT_COLOR,this.color||Ct._defaultColor],[mt.HIGHLIGHT_THICKNESS,g(this,ri)||Ct._defaultThickness],[mt.HIGHLIGHT_FREE,g(this,nn)]]}async addEditToolbar(){const e=await super.addEditToolbar();return e?(this._uiManager.highlightColors&&(T(this,Vf,new Rx({editor:this})),e.addColorPicker(g(this,Vf))),e):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(D(this,tt,B0).call(this))}getBaseTranslation(){return[0,0]}getRect(e,r){return super.getRect(e,r,D(this,tt,B0).call(this))}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){D(this,tt,hA).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(D(this,tt,wc).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var a;let r=!1;this.parent&&!e?D(this,tt,hA).call(this):e&&(D(this,tt,wc).call(this,e),r=!this.parent&&((a=this.div)==null?void 0:a.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),r&&this.select()}rotate(e){var s,l,c;const{drawLayer:r}=this.parent;let a;g(this,nn)?(e=(e-this.rotation+360)%360,a=D(s=Ct,si,zh).call(s,g(this,ti).box,e)):a=D(l=Ct,si,zh).call(l,[this.x,this.y,this.width,this.height],e),r.updateProperties(g(this,Ea),{bbox:a,root:{"data-main-rotation":e}}),r.updateProperties(g(this,yn),{bbox:D(c=Ct,si,zh).call(c,g(this,ia).box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();g(this,Xf)&&(e.setAttribute("aria-label",g(this,Xf)),e.setAttribute("role","mark")),g(this,nn)?e.classList.add("free"):this.div.addEventListener("keydown",D(this,tt,nD).bind(this),{signal:this._uiManager._signal});const r=T(this,_u,document.createElement("div"));e.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",r.style.clipPath=g(this,vu);const[a,s]=this.parentDimensions;return this.setDims(this.width*a,this.height*s),Sx(this,g(this,_u),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(g(this,yn),{rootClass:{hovered:!0}})}pointerleave(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(g(this,yn),{rootClass:{hovered:!1}})}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:D(this,tt,ax).call(this,!0);break;case 1:case 3:D(this,tt,ax).call(this,!1);break}}select(){var e;super.select(),g(this,yn)&&((e=this.parent)==null||e.drawLayer.updateProperties(g(this,yn),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var e;super.unselect(),g(this,yn)&&((e=this.parent)==null||e.drawLayer.updateProperties(g(this,yn),{rootClass:{selected:!1}}),g(this,nn)||D(this,tt,ax).call(this,!1))}get _mustFixPosition(){return!g(this,nn)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(g(this,Ea),{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(g(this,yn),{rootClass:{hidden:!e}}))}static startHighlighting(e,r,{target:a,x:s,y:l}){const{x:c,y:h,width:f,height:d}=a.getBoundingClientRect(),m=new AbortController,x=e.combinedSignal(m),_=y=>{m.abort(),D(this,si,oD).call(this,e,y)};window.addEventListener("blur",_,{signal:x}),window.addEventListener("pointerup",_,{signal:x}),window.addEventListener("pointerdown",Da,{capture:!0,passive:!1,signal:x}),window.addEventListener("contextmenu",Bi,{signal:x}),a.addEventListener("pointermove",D(this,si,sD).bind(this,e),{signal:x}),this._freeHighlight=new sA({x:s,y:l},[c,h,f,d],e.scale,this._defaultThickness/2,r,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(e,r,a){var A,E,b,C;let s=null;if(e instanceof LO){const{data:{quadPoints:S,rect:O,rotation:L,id:I,color:F,opacity:W,popupRef:B},parent:{page:{pageNumber:ee}}}=e;s=e={annotationType:at.HIGHLIGHT,color:Array.from(F),opacity:W,quadPoints:S,boxes:null,pageIndex:ee-1,rect:O.slice(0),rotation:L,id:I,deleted:!1,popupRef:B}}else if(e instanceof wE){const{data:{inkLists:S,rect:O,rotation:L,id:I,color:F,borderStyle:{rawWidth:W},popupRef:B},parent:{page:{pageNumber:ee}}}=e;s=e={annotationType:at.HIGHLIGHT,color:Array.from(F),thickness:W,inkLists:S,boxes:null,pageIndex:ee-1,rect:O.slice(0),rotation:L,id:I,deleted:!1,popupRef:B}}const{color:l,quadPoints:c,inkLists:h,opacity:f}=e,d=await super.deserialize(e,r,a);d.color=je.makeHexColor(...l),T(d,ho,f||1),h&&T(d,ri,e.thickness),d.annotationElementId=e.id||null,d._initialData=s;const[m,x]=d.pageDimensions,[_,y]=d.pageTranslation;if(c){const S=T(d,uo,[]);for(let O=0;O<c.length;O+=8)S.push({x:(c[O]-_)/m,y:1-(c[O+1]-y)/x,width:(c[O+2]-c[O])/m,height:(c[O+1]-c[O+5])/x});D(A=d,tt,uA).call(A),D(E=d,tt,wc).call(E),d.rotate(d.rotation)}else if(h){T(d,nn,!0);const S=h[0],O={x:S[0]-_,y:x-(S[1]-y)},L=new sA(O,[0,0,m,x],1,g(d,ri)/2,!0,.001);for(let W=0,B=S.length;W<B;W+=2)O.x=S[W]-_,O.y=x-(S[W+1]-y),L.add(O);const{id:I,clipPathId:F}=r.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:L.toSVGPath()}},!0,!0);D(b=d,tt,nx).call(b,{highlightOutlines:L.getOutlines(),highlightId:I,clipPathId:F}),D(C=d,tt,wc).call(C)}return d}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const r=this.getRect(0,0),a=ir._colorManager.convert(this.color),s={annotationType:at.HIGHLIGHT,color:a,opacity:g(this,ho),thickness:g(this,ri),quadPoints:D(this,tt,aD).call(this),outlines:D(this,tt,iD).call(this,r),pageIndex:this.pageIndex,rect:r,rotation:D(this,tt,B0).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!D(this,tt,lD).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Gf=new WeakMap,Mg=new WeakMap,uo=new WeakMap,vu=new WeakMap,Vf=new WeakMap,ia=new WeakMap,Lg=new WeakMap,Ng=new WeakMap,_u=new WeakMap,ti=new WeakMap,Ea=new WeakMap,nn=new WeakMap,$f=new WeakMap,ho=new WeakMap,yn=new WeakMap,Xf=new WeakMap,ri=new WeakMap,Pg=new WeakMap,tt=new WeakSet,uA=function(){const e=new aA(g(this,uo),.001);T(this,ti,e.getOutlines()),[this.x,this.y,this.width,this.height]=g(this,ti).box;const r=new aA(g(this,uo),.0025,.001,this._uiManager.direction==="ltr");T(this,ia,r.getOutlines());const{lastPoint:a}=g(this,ia);T(this,$f,[(a[0]-this.x)/this.width,(a[1]-this.y)/this.height])},nx=function({highlightOutlines:e,highlightId:r,clipPathId:a}){var m,x;if(T(this,ti,e),T(this,ia,e.getNewOutline(g(this,ri)/2+1.5,.0025)),r>=0)T(this,Ea,r),T(this,vu,a),this.parent.drawLayer.finalizeDraw(r,{bbox:e.box,path:{d:e.toSVGPath()}}),T(this,yn,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:g(this,ia).box,path:{d:g(this,ia).toSVGPath()}},!0));else if(this.parent){const _=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(g(this,Ea),{bbox:D(m=Ct,si,zh).call(m,g(this,ti).box,(_-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(g(this,yn),{bbox:D(x=Ct,si,zh).call(x,g(this,ia).box,_),path:{d:g(this,ia).toSVGPath()}})}const[l,c,h,f]=e.box;switch(this.rotation){case 0:this.x=l,this.y=c,this.width=h,this.height=f;break;case 90:{const[_,y]=this.parentDimensions;this.x=c,this.y=1-l,this.width=h*y/_,this.height=f*_/y;break}case 180:this.x=1-l,this.y=1-c,this.width=h,this.height=f;break;case 270:{const[_,y]=this.parentDimensions;this.x=1-c,this.y=l,this.width=h*y/_,this.height=f*_/y;break}}const{lastPoint:d}=g(this,ia);T(this,$f,[(d[0]-l)/h,(d[1]-c)/f])},eD=function(e){const r=(l,c)=>{var h,f;this.color=l,T(this,ho,c),(h=this.parent)==null||h.drawLayer.updateProperties(g(this,Ea),{root:{fill:l,"fill-opacity":c}}),(f=g(this,Vf))==null||f.updateColor(l)},a=this.color,s=g(this,ho);this.addCommands({cmd:r.bind(this,e,Ct._defaultOpacity),undo:r.bind(this,a,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:mt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(e)},!0)},tD=function(e){const r=g(this,ri),a=s=>{T(this,ri,s),D(this,tt,rD).call(this,s)};this.addCommands({cmd:a.bind(this,e),undo:a.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:mt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},rD=function(e){if(!g(this,nn))return;D(this,tt,nx).call(this,{highlightOutlines:g(this,ti).getNewOutline(e/2)}),this.fixAndSetPosition();const[r,a]=this.parentDimensions;this.setDims(this.width*r,this.height*a)},hA=function(){g(this,Ea)===null||!this.parent||(this.parent.drawLayer.remove(g(this,Ea)),T(this,Ea,null),this.parent.drawLayer.remove(g(this,yn)),T(this,yn,null))},wc=function(e=this.parent){g(this,Ea)===null&&({id:Ln(this,Ea)._,clipPathId:Ln(this,vu)._}=e.drawLayer.draw({bbox:g(this,ti).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":g(this,ho)},rootClass:{highlight:!0,free:g(this,nn)},path:{d:g(this,ti).toSVGPath()}},!1,!0),T(this,yn,e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:g(this,nn)},bbox:g(this,ia).box,path:{d:g(this,ia).toSVGPath()}},g(this,nn))),g(this,_u)&&(g(this,_u).style.clipPath=g(this,vu)))},si=new WeakSet,zh=function([e,r,a,s],l){switch(l){case 90:return[1-r-s,e,s,a];case 180:return[1-e-a,1-r-s,a,s];case 270:return[r,1-e-a,s,a]}return[e,r,a,s]},nD=function(e){Ct._keyboardManager.exec(this,e)},ax=function(e){if(!g(this,Gf))return;const r=window.getSelection();e?r.setPosition(g(this,Gf),g(this,Mg)):r.setPosition(g(this,Lg),g(this,Ng))},B0=function(){return g(this,nn)?this.rotation:0},aD=function(){if(g(this,nn))return null;const[e,r]=this.pageDimensions,[a,s]=this.pageTranslation,l=g(this,uo),c=new Float32Array(l.length*8);let h=0;for(const{x:f,y:d,width:m,height:x}of l){const _=f*e+a,y=(1-d)*r+s;c[h]=c[h+4]=_,c[h+1]=c[h+3]=y,c[h+2]=c[h+6]=_+m*e,c[h+5]=c[h+7]=y-x*r,h+=8}return c},iD=function(e){return g(this,ti).serialize(e,D(this,tt,B0).call(this))},sD=function(e,r){this._freeHighlight.add(r)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},oD=function(e,r){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(r,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},lD=function(e){const{color:r}=this._initialData;return e.color.some((a,s)=>a!==r[s])},R(Ct,si),Ve(Ct,"_defaultColor",null),Ve(Ct,"_defaultOpacity",1),Ve(Ct,"_defaultThickness",12),Ve(Ct,"_type","highlight"),Ve(Ct,"_editorType",at.HIGHLIGHT),Ve(Ct,"_freeHighlightId",-1),Ve(Ct,"_freeHighlight",null),Ve(Ct,"_freeHighlightClipId","");let Ox=Ct;var yu;class ej{constructor(){R(this,yu,Object.create(null))}updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,r]of Object.entries(t))this.updateProperty(e,r)}updateSVGProperty(t,e){g(this,yu)[t]=e}toSVGProperties(){const t=g(this,yu);return T(this,yu,Object.create(null)),{root:t}}reset(){T(this,yu,Object.create(null))}updateAll(t=this){this.updateProperties(t)}clone(){It("Not implemented")}}yu=new WeakMap;var ba,qf,$r,wu,Au,Cl,Rl,Ol,Eu,At,dA,pA,gA,U0,cD,ix,H0,jh;const Be=class Be extends ir{constructor(e){super(e);R(this,At);R(this,ba,null);R(this,qf);Ve(this,"_drawId",null);T(this,qf,e.mustBeCommitted||!1),e.drawOutlines&&(D(this,At,dA).call(this,e),D(this,At,U0).call(this))}static _mergeSVGProperties(e,r){const a=new Set(Object.keys(e));for(const[s,l]of Object.entries(r))a.has(s)?Object.assign(e[s],l):e[s]=l;return e}static getDefaultDrawingOptions(e){It("Not implemented")}static get typesMap(){It("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,r){const a=this.typesMap.get(e);a&&this._defaultDrawingOptions.updateProperty(a,r),this._currentParent&&(g(Be,$r).updateProperty(a,r),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,r){const a=this.constructor.typesMap.get(e);a&&this._updateProperty(e,a,r)}static get defaultPropertiesToUpdate(){const e=[],r=this._defaultDrawingOptions;for(const[a,s]of this.typesMap)e.push([a,r[s]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:r}=this;for(const[a,s]of this.constructor.typesMap)e.push([a,r[s]]);return e}_updateProperty(e,r,a){const s=this._drawingOptions,l=s[r],c=h=>{var d;s.updateProperty(r,h);const f=g(this,ba).updateProperty(r,h);f&&D(this,At,H0).call(this,f),(d=this.parent)==null||d.drawLayer.updateProperties(this._drawId,s.toSVGProperties())};this.addCommands({cmd:c.bind(this,a),undo:c.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,Be._mergeSVGProperties(g(this,ba).getPathResizingSVGProperties(D(this,At,ix).call(this)),{bbox:D(this,At,jh).call(this)}))}_onResized(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,Be._mergeSVGProperties(g(this,ba).getPathResizedSVGProperties(D(this,At,ix).call(this)),{bbox:D(this,At,jh).call(this)}))}_onTranslating(e,r){var a;(a=this.parent)==null||a.drawLayer.updateProperties(this._drawId,{bbox:D(this,At,jh).call(this,e,r)})}_onTranslated(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,Be._mergeSVGProperties(g(this,ba).getPathTranslatedSVGProperties(D(this,At,ix).call(this),this.parentDimensions),{bbox:D(this,At,jh).call(this)}))}_onStartDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,g(this,qf)&&(T(this,qf,!1),this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){D(this,At,gA).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(D(this,At,U0).call(this),D(this,At,H0).call(this,g(this,ba).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var a;let r=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),D(this,At,gA).call(this)):e&&(this._uiManager.addShouldRescale(this),D(this,At,U0).call(this,e),r=!this.parent&&((a=this.div)==null?void 0:a.classList.contains("selectedEditor"))),super.setParent(e),r&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Be._mergeSVGProperties({bbox:D(this,At,jh).call(this)},g(this,ba).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&D(this,At,H0).call(this,g(this,ba).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const e=super.render();e.classList.add("draw");const r=document.createElement("div");e.append(r),r.setAttribute("aria-hidden","true"),r.className="internal";const[a,s]=this.parentDimensions;return this.setDims(this.width*a,this.height*s),this._uiManager.addShouldRescale(this),this.disableEditing(),e}static createDrawerInstance(e,r,a,s,l){It("Not implemented")}static startDrawing(e,r,a,s){var E;const{target:l,offsetX:c,offsetY:h,pointerId:f,pointerType:d}=s;if(g(Be,Rl)&&g(Be,Rl)!==d)return;const{viewport:{rotation:m}}=e,{width:x,height:_}=l.getBoundingClientRect(),y=T(Be,wu,new AbortController),A=e.combinedSignal(y);if(g(Be,Cl)||T(Be,Cl,f),g(Be,Rl)??T(Be,Rl,d),window.addEventListener("pointerup",b=>{var C;g(Be,Cl)===b.pointerId?this._endDraw(b):(C=g(Be,Ol))==null||C.delete(b.pointerId)},{signal:A}),window.addEventListener("pointercancel",b=>{var C;g(Be,Cl)===b.pointerId?this._currentParent.endDrawingSession():(C=g(Be,Ol))==null||C.delete(b.pointerId)},{signal:A}),window.addEventListener("pointerdown",b=>{g(Be,Rl)===b.pointerType&&((g(Be,Ol)||T(Be,Ol,new Set)).add(b.pointerId),g(Be,$r).isCancellable()&&(g(Be,$r).removeLastElement(),g(Be,$r).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:A}),window.addEventListener("contextmenu",Bi,{signal:A}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:A}),l.addEventListener("touchmove",b=>{b.timeStamp===g(Be,Eu)&&Da(b)},{signal:A}),e.toggleDrawing(),(E=r._editorUndoBar)==null||E.hide(),g(Be,$r)){e.drawLayer.updateProperties(this._currentDrawId,g(Be,$r).startNew(c,h,x,_,m));return}r.updateUIForDefaultProperties(this),T(Be,$r,this.createDrawerInstance(c,h,x,_,m)),T(Be,Au,this.getDefaultDrawingOptions()),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(g(Be,Au).toSVGProperties(),g(Be,$r).defaultSVGProperties),!0,!1)}static _drawMove(e){var l;if(T(Be,Eu,-1),!g(Be,$r))return;const{offsetX:r,offsetY:a,pointerId:s}=e;if(g(Be,Cl)===s){if(((l=g(Be,Ol))==null?void 0:l.size)>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,g(Be,$r).add(r,a)),T(Be,Eu,e.timeStamp),Da(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,T(Be,$r,null),T(Be,Au,null),T(Be,Rl,null),T(Be,Eu,NaN)),g(Be,wu)&&(g(Be,wu).abort(),T(Be,wu,null),T(Be,Cl,NaN),T(Be,Ol,null))}static _endDraw(e){const r=this._currentParent;if(r){if(r.toggleDrawing(!0),this._cleanup(!1),e&&r.drawLayer.updateProperties(this._currentDrawId,g(Be,$r).end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const a=g(Be,$r),s=this._currentDrawId,l=a.getLastElement();r.addCommands({cmd:()=>{r.drawLayer.updateProperties(s,a.setLastElement(l))},undo:()=>{r.drawLayer.updateProperties(s,a.removeLastElement())},mustExec:!1,type:mt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const r=this._currentParent;if(!r)return null;if(r.toggleDrawing(!0),r.cleanUndoStack(mt.DRAW_STEP),!g(Be,$r).isEmpty()){const{pageDimensions:[a,s],scale:l}=r,c=r.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:g(Be,$r).getOutlines(a*l,s*l,l,this._INNER_MARGIN),drawingOptions:g(Be,Au),mustBeCommitted:!e});return this._cleanup(!0),c}return r.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,r,a,s,l,c){It("Not implemented")}static async deserialize(e,r,a){var m,x;const{rawDims:{pageWidth:s,pageHeight:l,pageX:c,pageY:h}}=r.viewport,f=this.deserializeDraw(c,h,s,l,this._INNER_MARGIN,e),d=await super.deserialize(e,r,a);return d.createDrawingOptions(e),D(m=d,At,dA).call(m,{drawOutlines:f}),D(x=d,At,U0).call(x),d.onScaleChanging(),d.rotate(),d}serializeDraw(e){const[r,a]=this.pageTranslation,[s,l]=this.pageDimensions;return g(this,ba).serialize([r,a,s,l],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};ba=new WeakMap,qf=new WeakMap,$r=new WeakMap,wu=new WeakMap,Au=new WeakMap,Cl=new WeakMap,Rl=new WeakMap,Ol=new WeakMap,Eu=new WeakMap,At=new WeakSet,dA=function({drawOutlines:e,drawId:r,drawingOptions:a}){T(this,ba,e),this._drawingOptions||(this._drawingOptions=a),r>=0?(this._drawId=r,this.parent.drawLayer.finalizeDraw(r,e.defaultProperties)):this._drawId=D(this,At,pA).call(this,e,this.parent),D(this,At,H0).call(this,e.box)},pA=function(e,r){const{id:a}=r.drawLayer.draw(Be._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return a},gA=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},U0=function(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=D(this,At,pA).call(this,g(this,ba),e)}},cD=function([e,r,a,s]){const{parentDimensions:[l,c],rotation:h}=this;switch(h){case 90:return[r,1-e,a*(c/l),s*(l/c)];case 180:return[1-e,1-r,a,s];case 270:return[1-r,e,a*(c/l),s*(l/c)];default:return[e,r,a,s]}},ix=function(){const{x:e,y:r,width:a,height:s,parentDimensions:[l,c],rotation:h}=this;switch(h){case 90:return[1-r,e,a*(l/c),s*(c/l)];case 180:return[1-e,1-r,a,s];case 270:return[r,1-e,a*(l/c),s*(c/l)];default:return[e,r,a,s]}},H0=function(e){if([this.x,this.y,this.width,this.height]=D(this,At,cD).call(this,e),this.div){this.fixAndSetPosition();const[r,a]=this.parentDimensions;this.setDims(this.width*r,this.height*a)}this._onResized()},jh=function(){const{x:e,y:r,width:a,height:s,rotation:l,parentRotation:c,parentDimensions:[h,f]}=this;switch((l*4+c)/90){case 1:return[1-r-s,e,s,a];case 2:return[1-e-a,1-r-s,a,s];case 3:return[r,1-e-a,s,a];case 4:return[e,r-a*(h/f),s*(f/h),a*(h/f)];case 5:return[1-r,e,a*(h/f),s*(f/h)];case 6:return[1-e-s*(f/h),1-r,s*(f/h),a*(h/f)];case 7:return[r-a*(h/f),1-e-s*(f/h),a*(h/f),s*(f/h)];case 8:return[e-a,r-s,a,s];case 9:return[1-r,e-a,s,a];case 10:return[1-e,1-r,a,s];case 11:return[r-s,1-e,s,a];case 12:return[e-s*(f/h),r,s*(f/h),a*(h/f)];case 13:return[1-r-a*(h/f),e-s*(f/h),a*(h/f),s*(f/h)];case 14:return[1-e,1-r-a*(h/f),s*(f/h),a*(h/f)];case 15:return[r,1-e,a*(h/f),s*(f/h)];default:return[e,r,a,s]}},Ve(Be,"_currentDrawId",-1),Ve(Be,"_currentParent",null),R(Be,$r,null),R(Be,wu,null),R(Be,Au,null),R(Be,Cl,NaN),R(Be,Rl,null),R(Be,Ol,null),R(Be,Eu,NaN),Ve(Be,"_INNER_MARGIN",3);let fA=Be;var hs,Xr,qr,bu,Yf,In,an,ni,Su,Tu,ku,Wf,sx;class tj{constructor(t,e,r,a,s,l){R(this,Wf);R(this,hs,new Float64Array(6));R(this,Xr);R(this,qr);R(this,bu);R(this,Yf);R(this,In);R(this,an,"");R(this,ni,0);R(this,Su,new Dx);R(this,Tu);R(this,ku);T(this,Tu,r),T(this,ku,a),T(this,bu,s),T(this,Yf,l),[t,e]=D(this,Wf,sx).call(this,t,e);const c=T(this,Xr,[NaN,NaN,NaN,NaN,t,e]);T(this,In,[t,e]),T(this,qr,[{line:c,points:g(this,In)}]),g(this,hs).set(c,0)}updateProperty(t,e){t==="stroke-width"&&T(this,Yf,e)}isEmpty(){return!g(this,qr)||g(this,qr).length===0}isCancellable(){return g(this,In).length<=10}add(t,e){[t,e]=D(this,Wf,sx).call(this,t,e);const[r,a,s,l]=g(this,hs).subarray(2,6),c=t-s,h=e-l;return Math.hypot(g(this,Tu)*c,g(this,ku)*h)<=2?null:(g(this,In).push(t,e),isNaN(r)?(g(this,hs).set([s,l,t,e],2),g(this,Xr).push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(g(this,hs)[0])&&g(this,Xr).splice(6,6),g(this,hs).set([r,a,s,l,t,e],0),g(this,Xr).push(...Ie.createBezierPoints(r,a,s,l,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const r=this.add(t,e);return r||(g(this,In).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,r,a,s){T(this,Tu,r),T(this,ku,a),T(this,bu,s),[t,e]=D(this,Wf,sx).call(this,t,e);const l=T(this,Xr,[NaN,NaN,NaN,NaN,t,e]);T(this,In,[t,e]);const c=g(this,qr).at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),g(this,qr).push({line:l,points:g(this,In)}),g(this,hs).set(l,0),T(this,ni,0),this.toSVGPath(),null}getLastElement(){return g(this,qr).at(-1)}setLastElement(t){return g(this,qr)?(g(this,qr).push(t),T(this,Xr,t.line),T(this,In,t.points),T(this,ni,0),{path:{d:this.toSVGPath()}}):g(this,Su).setLastElement(t)}removeLastElement(){if(!g(this,qr))return g(this,Su).removeLastElement();g(this,qr).pop(),T(this,an,"");for(let t=0,e=g(this,qr).length;t<e;t++){const{line:r,points:a}=g(this,qr)[t];T(this,Xr,r),T(this,In,a),T(this,ni,0),this.toSVGPath()}return{path:{d:g(this,an)}}}toSVGPath(){const t=Ie.svgRound(g(this,Xr)[4]),e=Ie.svgRound(g(this,Xr)[5]);if(g(this,In).length===2)return T(this,an,`${g(this,an)} M ${t} ${e} Z`),g(this,an);if(g(this,In).length<=6){const a=g(this,an).lastIndexOf("M");T(this,an,`${g(this,an).slice(0,a)} M ${t} ${e}`),T(this,ni,6)}if(g(this,In).length===4){const a=Ie.svgRound(g(this,Xr)[10]),s=Ie.svgRound(g(this,Xr)[11]);return T(this,an,`${g(this,an)} L ${a} ${s}`),T(this,ni,12),g(this,an)}const r=[];g(this,ni)===0&&(r.push(`M ${t} ${e}`),T(this,ni,6));for(let a=g(this,ni),s=g(this,Xr).length;a<s;a+=6){const[l,c,h,f,d,m]=g(this,Xr).slice(a,a+6).map(Ie.svgRound);r.push(`C${l} ${c} ${h} ${f} ${d} ${m}`)}return T(this,an,g(this,an)+r.join(" ")),T(this,ni,g(this,Xr).length),g(this,an)}getOutlines(t,e,r,a){const s=g(this,qr).at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),g(this,Su).build(g(this,qr),t,e,r,g(this,bu),g(this,Yf),a),T(this,hs,null),T(this,Xr,null),T(this,qr,null),T(this,an,null),g(this,Su)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}hs=new WeakMap,Xr=new WeakMap,qr=new WeakMap,bu=new WeakMap,Yf=new WeakMap,In=new WeakMap,an=new WeakMap,ni=new WeakMap,Su=new WeakMap,Tu=new WeakMap,ku=new WeakMap,Wf=new WeakSet,sx=function(t,e){return Ie._normalizePoint(t,e,g(this,Tu),g(this,ku),g(this,bu))};var Bn,Ig,Bg,Sa,fs,ds,Kf,Qf,Zf,on,zs,uD,hD,fD;const TE=class TE extends Ie{constructor(){super(...arguments);R(this,on);R(this,Bn);R(this,Ig,0);R(this,Bg);R(this,Sa);R(this,fs);R(this,ds);R(this,Kf);R(this,Qf);R(this,Zf)}build(e,r,a,s,l,c,h){T(this,fs,r),T(this,ds,a),T(this,Kf,s),T(this,Qf,l),T(this,Zf,c),T(this,Bg,h??0),T(this,Sa,e),D(this,on,hD).call(this)}setLastElement(e){return g(this,Sa).push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return g(this,Sa).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:r}of g(this,Sa)){if(e.push(`M${Ie.svgRound(r[4])} ${Ie.svgRound(r[5])}`),r.length===6){e.push("Z");continue}if(r.length===12){e.push(`L${Ie.svgRound(r[10])} ${Ie.svgRound(r[11])}`);continue}for(let a=6,s=r.length;a<s;a+=6){const[l,c,h,f,d,m]=r.subarray(a,a+6).map(Ie.svgRound);e.push(`C${l} ${c} ${h} ${f} ${d} ${m}`)}}return e.join("")}serialize([e,r,a,s],l){const c=[],h=[],[f,d,m,x]=D(this,on,uD).call(this);let _,y,A,E,b,C,S,O,L;switch(g(this,Qf)){case 0:L=Ie._rescale,_=e,y=r+s,A=a,E=-s,b=e+f*a,C=r+(1-d-x)*s,S=e+(f+m)*a,O=r+(1-d)*s;break;case 90:L=Ie._rescaleAndSwap,_=e,y=r,A=a,E=s,b=e+d*a,C=r+f*s,S=e+(d+x)*a,O=r+(f+m)*s;break;case 180:L=Ie._rescale,_=e+a,y=r,A=-a,E=s,b=e+(1-f-m)*a,C=r+d*s,S=e+(1-f)*a,O=r+(d+x)*s;break;case 270:L=Ie._rescaleAndSwap,_=e+a,y=r+s,A=-a,E=-s,b=e+(1-d-x)*a,C=r+(1-f-m)*s,S=e+(1-d)*a,O=r+(1-f)*s;break}for(const{line:I,points:F}of g(this,Sa))c.push(L(I,_,y,A,E,l?new Array(I.length):null)),h.push(L(F,_,y,A,E,l?new Array(F.length):null));return{lines:c,points:h,rect:[b,C,S,O]}}static deserialize(e,r,a,s,l,{paths:{lines:c,points:h},rotation:f,thickness:d}){const m=[];let x,_,y,A,E;switch(f){case 0:E=Ie._rescale,x=-e/a,_=r/s+1,y=1/a,A=-1/s;break;case 90:E=Ie._rescaleAndSwap,x=-r/s,_=-e/a,y=1/s,A=1/a;break;case 180:E=Ie._rescale,x=e/a+1,_=-r/s,y=-1/a,A=1/s;break;case 270:E=Ie._rescaleAndSwap,x=r/s+1,_=e/a+1,y=-1/s,A=-1/a;break}if(!c){c=[];for(const C of h){const S=C.length;if(S===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,C[0],C[1]]));continue}if(S===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,C[0],C[1],NaN,NaN,NaN,NaN,C[2],C[3]]));continue}const O=new Float32Array(3*(S-2));c.push(O);let[L,I,F,W]=C.subarray(0,4);O.set([NaN,NaN,NaN,NaN,L,I],0);for(let B=4;B<S;B+=2){const ee=C[B],Z=C[B+1];O.set(Ie.createBezierPoints(L,I,F,W,ee,Z),(B-2)*3),[L,I,F,W]=[F,W,ee,Z]}}}for(let C=0,S=c.length;C<S;C++)m.push({line:E(c[C].map(O=>O??NaN),x,_,y,A),points:E(h[C].map(O=>O??NaN),x,_,y,A)});const b=new TE;return b.build(m,a,s,1,f,d,l),b}get box(){return g(this,Bn)}updateProperty(e,r){return e==="stroke-width"?D(this,on,fD).call(this,r):null}updateParentDimensions([e,r],a){const[s,l]=D(this,on,zs).call(this);T(this,fs,e),T(this,ds,r),T(this,Kf,a);const[c,h]=D(this,on,zs).call(this),f=c-s,d=h-l,m=g(this,Bn);return m[0]-=f,m[1]-=d,m[2]+=2*f,m[3]+=2*d,m}updateRotation(e){return T(this,Ig,e),{path:{transform:this.rotationTransform}}}get viewBox(){return g(this,Bn).map(Ie.svgRound).join(" ")}get defaultProperties(){const[e,r]=g(this,Bn);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ie.svgRound(e)} ${Ie.svgRound(r)}`}}}get rotationTransform(){const[,,e,r]=g(this,Bn);let a=0,s=0,l=0,c=0,h=0,f=0;switch(g(this,Ig)){case 90:s=r/e,l=-e/r,h=e;break;case 180:a=-1,c=-1,h=e,f=r;break;case 270:s=-r/e,l=e/r,f=r;break;default:return""}return`matrix(${a} ${s} ${l} ${c} ${Ie.svgRound(h)} ${Ie.svgRound(f)})`}getPathResizingSVGProperties([e,r,a,s]){const[l,c]=D(this,on,zs).call(this),[h,f,d,m]=g(this,Bn);if(Math.abs(d-l)<=Ie.PRECISION||Math.abs(m-c)<=Ie.PRECISION){const E=e+a/2-(h+d/2),b=r+s/2-(f+m/2);return{path:{"transform-origin":`${Ie.svgRound(e)} ${Ie.svgRound(r)}`,transform:`${this.rotationTransform} translate(${E} ${b})`}}}const x=(a-2*l)/(d-2*l),_=(s-2*c)/(m-2*c),y=d/a,A=m/s;return{path:{"transform-origin":`${Ie.svgRound(h)} ${Ie.svgRound(f)}`,transform:`${this.rotationTransform} scale(${y} ${A}) translate(${Ie.svgRound(l)} ${Ie.svgRound(c)}) scale(${x} ${_}) translate(${Ie.svgRound(-l)} ${Ie.svgRound(-c)})`}}}getPathResizedSVGProperties([e,r,a,s]){const[l,c]=D(this,on,zs).call(this),h=g(this,Bn),[f,d,m,x]=h;if(h[0]=e,h[1]=r,h[2]=a,h[3]=s,Math.abs(m-l)<=Ie.PRECISION||Math.abs(x-c)<=Ie.PRECISION){const b=e+a/2-(f+m/2),C=r+s/2-(d+x/2);for(const{line:S,points:O}of g(this,Sa))Ie._translate(S,b,C,S),Ie._translate(O,b,C,O);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ie.svgRound(e)} ${Ie.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const _=(a-2*l)/(m-2*l),y=(s-2*c)/(x-2*c),A=-_*(f+l)+e+l,E=-y*(d+c)+r+c;if(_!==1||y!==1||A!==0||E!==0)for(const{line:b,points:C}of g(this,Sa))Ie._rescale(b,A,E,_,y,b),Ie._rescale(C,A,E,_,y,C);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ie.svgRound(e)} ${Ie.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,r],a){const[s,l]=a,c=g(this,Bn),h=e-c[0],f=r-c[1];if(g(this,fs)===s&&g(this,ds)===l)for(const{line:d,points:m}of g(this,Sa))Ie._translate(d,h,f,d),Ie._translate(m,h,f,m);else{const d=g(this,fs)/s,m=g(this,ds)/l;T(this,fs,s),T(this,ds,l);for(const{line:x,points:_}of g(this,Sa))Ie._rescale(x,h,f,d,m,x),Ie._rescale(_,h,f,d,m,_);c[2]*=d,c[3]*=m}return c[0]=e,c[1]=r,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Ie.svgRound(e)} ${Ie.svgRound(r)}`}}}get defaultSVGProperties(){const e=g(this,Bn);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Ie.svgRound(e[0])} ${Ie.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}};Bn=new WeakMap,Ig=new WeakMap,Bg=new WeakMap,Sa=new WeakMap,fs=new WeakMap,ds=new WeakMap,Kf=new WeakMap,Qf=new WeakMap,Zf=new WeakMap,on=new WeakSet,zs=function(e=g(this,Zf)){const r=g(this,Bg)+e/2*g(this,Kf);return g(this,Qf)%180===0?[r/g(this,fs),r/g(this,ds)]:[r/g(this,ds),r/g(this,fs)]},uD=function(){const[e,r,a,s]=g(this,Bn),[l,c]=D(this,on,zs).call(this,0);return[e+l,r+c,a-2*l,s-2*c]},hD=function(){const e=T(this,Bn,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:s}of g(this,Sa)){if(s.length<=12){for(let h=4,f=s.length;h<f;h+=6){const[d,m]=s.subarray(h,h+2);e[0]=Math.min(e[0],d),e[1]=Math.min(e[1],m),e[2]=Math.max(e[2],d),e[3]=Math.max(e[3],m)}continue}let l=s[4],c=s[5];for(let h=6,f=s.length;h<f;h+=6){const[d,m,x,_,y,A]=s.subarray(h,h+6);je.bezierBoundingBox(l,c,d,m,x,_,y,A,e),l=y,c=A}}const[r,a]=D(this,on,zs).call(this);e[0]=Math.min(1,Math.max(0,e[0]-r)),e[1]=Math.min(1,Math.max(0,e[1]-a)),e[2]=Math.min(1,Math.max(0,e[2]+r)),e[3]=Math.min(1,Math.max(0,e[3]+a)),e[2]-=e[0],e[3]-=e[1]},fD=function(e){const[r,a]=D(this,on,zs).call(this);T(this,Zf,e);const[s,l]=D(this,on,zs).call(this),[c,h]=[s-r,l-a],f=g(this,Bn);return f[0]-=c,f[1]-=h,f[2]+=2*c,f[3]+=2*h,f};let Dx=TE;var Jf;const kE=class kE extends ej{constructor(e){super();R(this,Jf);T(this,Jf,e),super.updateProperties({fill:"none",stroke:ir._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,r){e==="stroke-width"&&(r??(r=this["stroke-width"]),r*=g(this,Jf).realScale),super.updateSVGProperty(e,r)}clone(){const e=new kE(g(this,Jf));return e.updateAll(this),e}};Jf=new WeakMap;let mA=kE;var Wx,dD;const $h=class $h extends fA{constructor(e){super({...e,name:"inkEditor"});R(this,Wx);this._willKeepAspectRatio=!0}static initialize(e,r){ir.initialize(e,r),this._defaultDrawingOptions=new mA(r.viewParameters)}static getDefaultDrawingOptions(e){const r=this._defaultDrawingOptions.clone();return r.updateProperties(e),r}static get supportMultipleDrawings(){return!0}static get typesMap(){return ht(this,"typesMap",new Map([[mt.INK_THICKNESS,"stroke-width"],[mt.INK_COLOR,"stroke"],[mt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,r,a,s,l){return new tj(e,r,a,s,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,r,a,s,l,c){return Dx.deserialize(e,r,a,s,l,c)}static async deserialize(e,r,a){let s=null;if(e instanceof wE){const{data:{inkLists:c,rect:h,rotation:f,id:d,color:m,opacity:x,borderStyle:{rawWidth:_},popupRef:y},parent:{page:{pageNumber:A}}}=e;s=e={annotationType:at.INK,color:Array.from(m),thickness:_,opacity:x,paths:{points:c},boxes:null,pageIndex:A-1,rect:h.slice(0),rotation:f,id:d,deleted:!1,popupRef:y}}const l=await super.deserialize(e,r,a);return l.annotationElementId=e.id||null,l._initialData=s,l}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:r,parent:a}=this;r.updateSVGProperty("stroke-width"),a.drawLayer.updateProperties(e,r.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:r,opacity:a}){this._drawingOptions=$h.getDefaultDrawingOptions({stroke:je.makeHexColor(...e),"stroke-width":r,"stroke-opacity":a})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:r,points:a,rect:s}=this.serializeDraw(e),{_drawingOptions:{stroke:l,"stroke-opacity":c,"stroke-width":h}}=this,f={annotationType:at.INK,color:ir._colorManager.convert(l),opacity:c,thickness:h,paths:{lines:r,points:a},pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return e?f:this.annotationElementId&&!D(this,Wx,dD).call(this,f)?null:(f.id=this.annotationElementId,f)}renderAnnotationElement(e){const{points:r,rect:a}=this.serializeDraw(!1);return e.updateEdited({rect:a,thickness:this._drawingOptions["stroke-width"],points:r}),null}};Wx=new WeakSet,dD=function(e){const{color:r,thickness:a,opacity:s,pageIndex:l}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||e.color.some((c,h)=>c!==r[h])||e.thickness!==a||e.opacity!==s||e.pageIndex!==l},Ve($h,"_type","ink"),Ve($h,"_editorType",at.INK),Ve($h,"_defaultDrawingOptions",null);let xA=$h;var ar,sn,Dl,fo,Fl,ed,ps,gs,Ta,td,Tt,z0,j0,ox,_A,lx,yA,cx,pD;const tp=class tp extends ir{constructor(e){super({...e,name:"stampEditor"});R(this,Tt);R(this,ar,null);R(this,sn,null);R(this,Dl,null);R(this,fo,null);R(this,Fl,null);R(this,ed,"");R(this,ps,null);R(this,gs,null);R(this,Ta,!1);R(this,td,!1);T(this,fo,e.bitmapUrl),T(this,Fl,e.bitmapFile)}static initialize(e,r){ir.initialize(e,r)}static get supportedTypes(){return ht(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(r=>`image/${r}`))}static get supportedTypesStr(){return ht(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(e){return this.supportedTypes.includes(e)}static paste(e,r){r.pasteEditor(at.STAMP,{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!!((e=this.altTextData)!=null&&e.altText)}}static computeTelemetryFinalData(e){const r=e.get("hasAltText");return{hasAltText:r.get(!0)??0,hasNoAltText:r.get(!1)??0}}async mlGuessAltText(e=null,r=!0){if(this.hasAltTextData())return null;const{mlManager:a}=this._uiManager;if(!a)throw new Error("No ML.");if(!await a.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:l,height:c}=e||this.copyCanvas(null,null,!0).imageData,h=await a.guess({name:"altText",request:{data:s,width:l,height:c,channels:s.length/(l*c)}});if(!h)throw new Error("No response from the AI service.");if(h.error)throw new Error("Error from the AI service.");if(h.cancel)return null;if(!h.output)throw new Error("No valid response from the AI service.");const f=h.output;return await this.setGuessedAltText(f),r&&!this.hasAltTextData()&&(this.altTextData={alt:f,decorative:!1}),f}remove(){var e;g(this,sn)&&(T(this,ar,null),this._uiManager.imageManager.deleteId(g(this,sn)),(e=g(this,ps))==null||e.remove(),T(this,ps,null),g(this,gs)&&(clearTimeout(g(this,gs)),T(this,gs,null))),super.remove()}rebuild(){if(!this.parent){g(this,sn)&&D(this,Tt,ox).call(this);return}super.rebuild(),this.div!==null&&(g(this,sn)&&g(this,ps)===null&&D(this,Tt,ox).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(g(this,Dl)||g(this,ar)||g(this,fo)||g(this,Fl)||g(this,sn))}get isResizable(){return!0}render(){if(this.div)return this.div;let e,r;if(this.width&&(e=this.x,r=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),g(this,ar)?D(this,Tt,_A).call(this):D(this,Tt,ox).call(this),this.width&&!this.annotationElementId){const[a,s]=this.parentDimensions;this.setAt(e*a,r*s,this.width*a,this.height*s)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;g(this,gs)!==null&&clearTimeout(g(this,gs)),T(this,gs,setTimeout(()=>{T(this,gs,null),D(this,Tt,yA).call(this)},200))}copyCanvas(e,r,a=!1){var _;e||(e=224);const{width:s,height:l}=g(this,ar),c=new mw;let h=g(this,ar),f=s,d=l,m=null;if(r){if(s>r||l>r){const W=Math.min(r/s,r/l);f=Math.floor(s*W),d=Math.floor(l*W)}m=document.createElement("canvas");const y=m.width=Math.ceil(f*c.sx),A=m.height=Math.ceil(d*c.sy);g(this,Ta)||(h=D(this,Tt,lx).call(this,y,A));const E=m.getContext("2d");E.filter=this._uiManager.hcmFilter;let b="white",C="#cfcfd8";this._uiManager.hcmFilter!=="none"?C="black":(_=window.matchMedia)!=null&&_.call(window,"(prefers-color-scheme: dark)").matches&&(b="#8f8f9d",C="#42414d");const S=15,O=S*c.sx,L=S*c.sy,I=new OffscreenCanvas(O*2,L*2),F=I.getContext("2d");F.fillStyle=b,F.fillRect(0,0,O*2,L*2),F.fillStyle=C,F.fillRect(0,0,O,L),F.fillRect(O,L,O,L),E.fillStyle=E.createPattern(I,"repeat"),E.fillRect(0,0,y,A),E.drawImage(h,0,0,h.width,h.height,0,0,y,A)}let x=null;if(a){let y,A;if(c.symmetric&&h.width<e&&h.height<e)y=h.width,A=h.height;else if(h=g(this,ar),s>e||l>e){const C=Math.min(e/s,e/l);y=Math.floor(s*C),A=Math.floor(l*C),g(this,Ta)||(h=D(this,Tt,lx).call(this,y,A))}const b=new OffscreenCanvas(y,A).getContext("2d",{willReadFrequently:!0});b.drawImage(h,0,0,h.width,h.height,0,0,y,A),x={width:y,height:A,data:b.getImageData(0,0,y,A).data}}return{canvas:m,width:f,height:d,imageData:x}}getImageForAltText(){return g(this,ps)}static async deserialize(e,r,a){var A;let s=null;if(e instanceof NO){const{data:{rect:E,rotation:b,id:C,structParent:S,popupRef:O},container:L,parent:{page:{pageNumber:I}}}=e,F=L.querySelector("canvas"),W=a.imageManager.getFromCanvas(L.id,F);F.remove();const B=((A=await r._structTree.getAriaAttributes(`${dE}${C}`))==null?void 0:A.get("aria-label"))||"";s=e={annotationType:at.STAMP,bitmapId:W.id,bitmap:W.bitmap,pageIndex:I-1,rect:E.slice(0),rotation:b,id:C,deleted:!1,accessibilityData:{decorative:!1,altText:B},isSvg:!1,structParent:S,popupRef:O}}const l=await super.deserialize(e,r,a),{rect:c,bitmap:h,bitmapUrl:f,bitmapId:d,isSvg:m,accessibilityData:x}=e;d&&a.imageManager.isValidId(d)?(T(l,sn,d),h&&T(l,ar,h)):T(l,fo,f),T(l,Ta,m);const[_,y]=l.pageDimensions;return l.width=(c[2]-c[0])/_,l.height=(c[3]-c[1])/y,l.annotationElementId=e.id||null,x&&(l.altTextData=x),l._initialData=s,T(l,td,!!s),l}serialize(e=!1,r=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const a={annotationType:at.STAMP,bitmapId:g(this,sn),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:g(this,Ta),structTreeParentId:this._structTreeParentId};if(e)return a.bitmapUrl=D(this,Tt,cx).call(this,!0),a.accessibilityData=this.serializeAltText(!0),a;const{decorative:s,altText:l}=this.serializeAltText(!1);if(!s&&l&&(a.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const h=D(this,Tt,pD).call(this,a);if(h.isSame)return null;h.isSameAltText?delete a.accessibilityData:a.accessibilityData.structParent=this._initialData.structParent??-1}if(a.id=this.annotationElementId,r===null)return a;r.stamps||(r.stamps=new Map);const c=g(this,Ta)?(a.rect[2]-a.rect[0])*(a.rect[3]-a.rect[1]):null;if(!r.stamps.has(g(this,sn)))r.stamps.set(g(this,sn),{area:c,serialized:a}),a.bitmap=D(this,Tt,cx).call(this,!1);else if(g(this,Ta)){const h=r.stamps.get(g(this,sn));c>h.area&&(h.area=c,h.serialized.bitmap.close(),h.serialized.bitmap=D(this,Tt,cx).call(this,!1))}return a}renderAnnotationElement(e){return e.updateEdited({rect:this.getRect(0,0)}),null}};ar=new WeakMap,sn=new WeakMap,Dl=new WeakMap,fo=new WeakMap,Fl=new WeakMap,ed=new WeakMap,ps=new WeakMap,gs=new WeakMap,Ta=new WeakMap,td=new WeakMap,Tt=new WeakSet,z0=function(e,r=!1){if(!e){this.remove();return}T(this,ar,e.bitmap),r||(T(this,sn,e.id),T(this,Ta,e.isSvg)),e.file&&T(this,ed,e.file.name),D(this,Tt,_A).call(this)},j0=function(){if(T(this,Dl,null),this._uiManager.enableWaiting(!1),!!g(this,ps)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&g(this,ar)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&g(this,ar)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},ox=function(){if(g(this,sn)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(g(this,sn)).then(a=>D(this,Tt,z0).call(this,a,!0)).finally(()=>D(this,Tt,j0).call(this));return}if(g(this,fo)){const a=g(this,fo);T(this,fo,null),this._uiManager.enableWaiting(!0),T(this,Dl,this._uiManager.imageManager.getFromUrl(a).then(s=>D(this,Tt,z0).call(this,s)).finally(()=>D(this,Tt,j0).call(this)));return}if(g(this,Fl)){const a=g(this,Fl);T(this,Fl,null),this._uiManager.enableWaiting(!0),T(this,Dl,this._uiManager.imageManager.getFromFile(a).then(s=>D(this,Tt,z0).call(this,s)).finally(()=>D(this,Tt,j0).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=tp.supportedTypesStr;const r=this._uiManager._signal;T(this,Dl,new Promise(a=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),D(this,Tt,z0).call(this,s)}a()},{signal:r}),e.addEventListener("cancel",()=>{this.remove(),a()},{signal:r})}).finally(()=>D(this,Tt,j0).call(this))),e.click()},_A=function(){var m;const{div:e}=this;let{width:r,height:a}=g(this,ar);const[s,l]=this.pageDimensions,c=.75;if(this.width)r=this.width*s,a=this.height*l;else if(r>c*s||a>c*l){const x=Math.min(c*s/r,c*l/a);r*=x,a*=x}const[h,f]=this.parentDimensions;this.setDims(r*h/s,a*f/l),this._uiManager.enableWaiting(!1);const d=T(this,ps,document.createElement("canvas"));d.setAttribute("role","img"),this.addContainer(d),this.width=r/s,this.height=a/l,(m=this._initialOptions)!=null&&m.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),D(this,Tt,yA).call(this),g(this,td)||(this.parent.addUndoableEditor(this),T(this,td,!0)),this._reportTelemetry({action:"inserted_image"}),g(this,ed)&&d.setAttribute("aria-label",g(this,ed))},lx=function(e,r){const{width:a,height:s}=g(this,ar);let l=a,c=s,h=g(this,ar);for(;l>2*e||c>2*r;){const f=l,d=c;l>2*e&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),c>2*r&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const m=new OffscreenCanvas(l,c);m.getContext("2d").drawImage(h,0,0,f,d,0,0,l,c),h=m.transferToImageBitmap()}return h},yA=function(){const[e,r]=this.parentDimensions,{width:a,height:s}=this,l=new mw,c=Math.ceil(a*e*l.sx),h=Math.ceil(s*r*l.sy),f=g(this,ps);if(!f||f.width===c&&f.height===h)return;f.width=c,f.height=h;const d=g(this,Ta)?g(this,ar):D(this,Tt,lx).call(this,c,h),m=f.getContext("2d");m.filter=this._uiManager.hcmFilter,m.drawImage(d,0,0,d.width,d.height,0,0,c,h)},cx=function(e){if(e){if(g(this,Ta)){const s=this._uiManager.imageManager.getSvgUrl(g(this,sn));if(s)return s}const r=document.createElement("canvas");return{width:r.width,height:r.height}=g(this,ar),r.getContext("2d").drawImage(g(this,ar),0,0),r.toDataURL()}if(g(this,Ta)){const[r,a]=this.pageDimensions,s=Math.round(this.width*r*Vl.PDF_TO_CSS_UNITS),l=Math.round(this.height*a*Vl.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(s,l);return c.getContext("2d").drawImage(g(this,ar),0,0,g(this,ar).width,g(this,ar).height,0,0,s,l),c.transferToImageBitmap()}return structuredClone(g(this,ar))},pD=function(e){var c;const{pageIndex:r,accessibilityData:{altText:a}}=this._initialData,s=e.pageIndex===r,l=(((c=e.accessibilityData)==null?void 0:c.alt)||"")===a;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&s&&l,isSameAltText:l}},Ve(tp,"_type","stamp"),Ve(tp,"_editorType",at.STAMP);let vA=tp;var Cu,rd,ms,Ml,po,ai,Ll,nd,Ru,Oi,go,wn,mo,ze,Nl,Qt,gD,Ji,AA,EA,ux;const vi=class vi{constructor({uiManager:t,pageIndex:e,div:r,structTreeLayer:a,accessibilityManager:s,annotationLayer:l,drawLayer:c,textLayer:h,viewport:f,l10n:d}){R(this,Qt);R(this,Cu);R(this,rd,!1);R(this,ms,null);R(this,Ml,null);R(this,po,null);R(this,ai,new Map);R(this,Ll,!1);R(this,nd,!1);R(this,Ru,!1);R(this,Oi,null);R(this,go,null);R(this,wn,null);R(this,mo,null);R(this,ze);const m=[...g(vi,Nl).values()];if(!vi._initialized){vi._initialized=!0;for(const x of m)x.initialize(d,t)}t.registerEditorTypes(m),T(this,ze,t),this.pageIndex=e,this.div=r,T(this,Cu,s),T(this,ms,l),this.viewport=f,T(this,wn,h),this.drawLayer=c,this._structTree=a,g(this,ze).addLayer(this)}get isEmpty(){return g(this,ai).size===0}get isInvisible(){return this.isEmpty&&g(this,ze).getMode()===at.NONE}updateToolbar(t){g(this,ze).updateToolbar(t)}updateMode(t=g(this,ze).getMode()){switch(D(this,Qt,ux).call(this),t){case at.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case at.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case at.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const r of g(vi,Nl).values())e.toggle(`${r._type}Editing`,t===r._editorType);this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=g(this,wn))==null?void 0:e.div)}setEditingState(t){g(this,ze).setEditingState(t)}addCommands(t){g(this,ze).addCommands(t)}cleanUndoStack(t){g(this,ze).cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=g(this,ms))==null||e.div.classList.toggle("disabled",!t)}async enable(){T(this,Ru,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const t=new Set;for(const r of g(this,ai).values())r.enableEditing(),r.show(!0),r.annotationElementId&&(g(this,ze).removeChangedExistingAnnotation(r),t.add(r.annotationElementId));if(!g(this,ms)){T(this,Ru,!1);return}const e=g(this,ms).getEditableAnnotations();for(const r of e){if(r.hide(),g(this,ze).isDeletedAnnotationElement(r.data.id)||t.has(r.data.id))continue;const a=await this.deserialize(r);a&&(this.addOrRebuild(a),a.enableEditing())}T(this,Ru,!1)}disable(){var a;T(this,nd,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const t=new Map,e=new Map;for(const s of g(this,ai).values())if(s.disableEditing(),!!s.annotationElementId){if(s.serialize()!==null){t.set(s.annotationElementId,s);continue}else e.set(s.annotationElementId,s);(a=this.getEditableAnnotation(s.annotationElementId))==null||a.show(),s.remove()}if(g(this,ms)){const s=g(this,ms).getEditableAnnotations();for(const l of s){const{id:c}=l.data;if(g(this,ze).isDeletedAnnotationElement(c))continue;let h=e.get(c);if(h){h.resetAnnotationElement(l),h.show(!1),l.show();continue}h=t.get(c),h&&(g(this,ze).addChangedExistingAnnotation(h),h.renderAnnotationElement(l)&&h.show(!1)),l.show()}}D(this,Qt,ux).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:r}=this.div;for(const s of g(vi,Nl).values())r.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),T(this,nd,!1)}getEditableAnnotation(t){var e;return((e=g(this,ms))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){g(this,ze).getActive()!==t&&g(this,ze).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=g(this,wn))!=null&&t.div&&!g(this,mo)){T(this,mo,new AbortController);const e=g(this,ze).combinedSignal(g(this,mo));g(this,wn).div.addEventListener("pointerdown",D(this,Qt,gD).bind(this),{signal:e}),g(this,wn).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=g(this,wn))!=null&&t.div&&g(this,mo)&&(g(this,mo).abort(),T(this,mo,null),g(this,wn).div.classList.remove("highlighting"))}enableClick(){if(g(this,Ml))return;T(this,Ml,new AbortController);const t=g(this,ze).combinedSignal(g(this,Ml));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){var t;(t=g(this,Ml))==null||t.abort(),T(this,Ml,null)}attach(t){g(this,ai).set(t.id,t);const{annotationElementId:e}=t;e&&g(this,ze).isDeletedAnnotationElement(e)&&g(this,ze).removeDeletedAnnotationElement(t)}detach(t){var e;g(this,ai).delete(t.id),(e=g(this,Cu))==null||e.removePointerInTextLayer(t.contentDiv),!g(this,nd)&&t.annotationElementId&&g(this,ze).addDeletedAnnotationElement(t)}remove(t){this.detach(t),g(this,ze).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(g(this,ze).addDeletedAnnotationElement(t.annotationElementId),ir.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),g(this,ze).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!g(this,Ru)),g(this,ze).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var r;if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!g(this,po)&&(t._focusEventsAllowed=!1,T(this,po,setTimeout(()=>{T(this,po,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:g(this,ze)._signal}),e.focus())},0))),t._structTreeParentId=(r=g(this,Cu))==null?void 0:r.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),r=()=>{t.remove()};this.addCommands({cmd:e,undo:r,mustExec:!1})}getNextId(){return g(this,ze).getId()}combinedSignal(t){return g(this,ze).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=g(this,Qt,Ji))==null?void 0:t.canCreateNewEmptyEditor()}pasteEditor(t,e){g(this,ze).updateToolbar(t),g(this,ze).updateMode(t);const{offsetX:r,offsetY:a}=D(this,Qt,EA).call(this),s=this.getNextId(),l=D(this,Qt,AA).call(this,{parent:this,id:s,x:r,y:a,uiManager:g(this,ze),isCentered:!0,...e});l&&this.add(l)}async deserialize(t){var e;return await((e=g(vi,Nl).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,g(this,ze)))||null}createAndAddNewEditor(t,e,r={}){const a=this.getNextId(),s=D(this,Qt,AA).call(this,{parent:this,id:a,x:t.offsetX,y:t.offsetY,uiManager:g(this,ze),isCentered:e,...r});return s&&this.add(s),s}addNewEditor(){this.createAndAddNewEditor(D(this,Qt,EA).call(this),!0)}setSelected(t){g(this,ze).setSelected(t)}toggleSelected(t){g(this,ze).toggleSelected(t)}unselect(t){g(this,ze).unselect(t)}pointerup(t){var r;const{isMac:e}=Vn.platform;if(!(t.button!==0||t.ctrlKey&&e)&&t.target===this.div&&g(this,Ll)&&(T(this,Ll,!1),!((r=g(this,Qt,Ji))!=null&&r.isDrawer&&g(this,Qt,Ji).supportMultipleDrawings))){if(!g(this,rd)){T(this,rd,!0);return}if(g(this,ze).getMode()===at.STAMP){g(this,ze).unselectAll();return}this.createAndAddNewEditor(t,!1)}}pointerdown(t){var a;if(g(this,ze).getMode()===at.HIGHLIGHT&&this.enableTextSelection(),g(this,Ll)){T(this,Ll,!1);return}const{isMac:e}=Vn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(T(this,Ll,!0),(a=g(this,Qt,Ji))!=null&&a.isDrawer){this.startDrawingSession(t);return}const r=g(this,ze).getActive();T(this,rd,!r||r.isEmpty())}startDrawingSession(t){if(this.div.focus(),g(this,Oi)){g(this,Qt,Ji).startDrawing(this,g(this,ze),!1,t);return}g(this,ze).setCurrentDrawingSession(this),T(this,Oi,new AbortController);const e=g(this,ze).combinedSignal(g(this,Oi));this.div.addEventListener("blur",({relatedTarget:r})=>{r&&!this.div.contains(r)&&(T(this,go,null),this.commitOrRemove())},{signal:e}),g(this,Qt,Ji).startDrawing(this,g(this,ze),!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&T(this,go,e);return}g(this,go)&&setTimeout(()=>{var e;(e=g(this,go))==null||e.focus(),T(this,go,null)},0)}endDrawingSession(t=!1){return g(this,Oi)?(g(this,ze).setCurrentDrawingSession(null),g(this,Oi).abort(),T(this,Oi,null),T(this,go,null),g(this,Qt,Ji).endDrawing(t)):null}findNewParent(t,e,r){const a=g(this,ze).findParent(e,r);return a===null||a===this?!1:(a.changeParent(t),!0)}commitOrRemove(){return g(this,Oi)?(this.endDrawingSession(),!0):!1}onScaleChanging(){g(this,Oi)&&g(this,Qt,Ji).onScaleChangingWhenDrawing(this)}destroy(){var t,e;this.commitOrRemove(),((t=g(this,ze).getActive())==null?void 0:t.parent)===this&&(g(this,ze).commitOrRemove(),g(this,ze).setActiveEditor(null)),g(this,po)&&(clearTimeout(g(this,po)),T(this,po,null));for(const r of g(this,ai).values())(e=g(this,Cu))==null||e.removePointerInTextLayer(r.contentDiv),r.setParent(null),r.isAttachedToDOM=!1,r.div.remove();this.div=null,g(this,ai).clear(),g(this,ze).removeLayer(this)}render({viewport:t}){this.viewport=t,Pu(this.div,t);for(const e of g(this,ze).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){g(this,ze).commitOrRemove(),D(this,Qt,ux).call(this);const e=this.viewport.rotation,r=t.rotation;if(this.viewport=t,Pu(this.div,{rotation:r}),e!==r)for(const a of g(this,ai).values())a.rotate(r)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return g(this,ze).viewParameters.realScale}};Cu=new WeakMap,rd=new WeakMap,ms=new WeakMap,Ml=new WeakMap,po=new WeakMap,ai=new WeakMap,Ll=new WeakMap,nd=new WeakMap,Ru=new WeakMap,Oi=new WeakMap,go=new WeakMap,wn=new WeakMap,mo=new WeakMap,ze=new WeakMap,Nl=new WeakMap,Qt=new WeakSet,gD=function(t){g(this,ze).unselectAll();const{target:e}=t;if(e===g(this,wn).div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&g(this,wn).div.contains(e)){const{isMac:r}=Vn.platform;if(t.button!==0||t.ctrlKey&&r)return;g(this,ze).showAllEditors("highlight",!0,!0),g(this,wn).div.classList.add("free"),this.toggleDrawing(),Ox.startHighlighting(this,g(this,ze).direction==="ltr",{target:g(this,wn).div,x:t.x,y:t.y}),g(this,wn).div.addEventListener("pointerup",()=>{g(this,wn).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:g(this,ze)._signal}),t.preventDefault()}},Ji=function(){return g(vi,Nl).get(g(this,ze).getMode())},AA=function(t){const e=g(this,Qt,Ji);return e?new e.prototype.constructor(t):null},EA=function(){const{x:t,y:e,width:r,height:a}=this.div.getBoundingClientRect(),s=Math.max(0,t),l=Math.max(0,e),c=Math.min(window.innerWidth,t+r),h=Math.min(window.innerHeight,e+a),f=(s+c)/2-t,d=(l+h)/2-e,[m,x]=this.viewport.rotation%180===0?[f,d]:[d,f];return{offsetX:m,offsetY:x}},ux=function(){for(const t of g(this,ai).values())t.isEmpty()&&t.remove()},Ve(vi,"_initialized",!1),R(vi,Nl,new Map([rA,xA,vA,Ox].map(t=>[t._editorType,t])));let wA=vi;var Di,Ug,Un,Ou,Kx,mD,_s,SA,xD,TA;const xn=class xn{constructor({pageIndex:t}){R(this,_s);R(this,Di,null);R(this,Ug,0);R(this,Un,new Map);R(this,Ou,new Map);this.pageIndex=t}setParent(t){if(!g(this,Di)){T(this,Di,t);return}if(g(this,Di)!==t){if(g(this,Un).size>0)for(const e of g(this,Un).values())e.remove(),t.append(e);T(this,Di,t)}}static get _svgFactory(){return ht(this,"_svgFactory",new yE)}draw(t,e=!1,r=!1){const a=Ln(this,Ug)._++,s=D(this,_s,SA).call(this),l=xn._svgFactory.createElement("defs");s.append(l);const c=xn._svgFactory.createElement("path");l.append(c);const h=`path_p${this.pageIndex}_${a}`;c.setAttribute("id",h),c.setAttribute("vector-effect","non-scaling-stroke"),e&&g(this,Ou).set(a,c);const f=r?D(this,_s,xD).call(this,l,h):null,d=xn._svgFactory.createElement("use");return s.append(d),d.setAttribute("href",`#${h}`),this.updateProperties(s,t),g(this,Un).set(a,s),{id:a,clipPathId:`url(#${f})`}}drawOutline(t,e){const r=Ln(this,Ug)._++,a=D(this,_s,SA).call(this),s=xn._svgFactory.createElement("defs");a.append(s);const l=xn._svgFactory.createElement("path");s.append(l);const c=`path_p${this.pageIndex}_${r}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke");let h;if(e){const m=xn._svgFactory.createElement("mask");s.append(m),h=`mask_p${this.pageIndex}_${r}`,m.setAttribute("id",h),m.setAttribute("maskUnits","objectBoundingBox");const x=xn._svgFactory.createElement("rect");m.append(x),x.setAttribute("width","1"),x.setAttribute("height","1"),x.setAttribute("fill","white");const _=xn._svgFactory.createElement("use");m.append(_),_.setAttribute("href",`#${c}`),_.setAttribute("stroke","none"),_.setAttribute("fill","black"),_.setAttribute("fill-rule","nonzero"),_.classList.add("mask")}const f=xn._svgFactory.createElement("use");a.append(f),f.setAttribute("href",`#${c}`),h&&f.setAttribute("mask",`url(#${h})`);const d=f.cloneNode();return a.append(d),f.classList.add("mainOutline"),d.classList.add("secondaryOutline"),this.updateProperties(a,t),g(this,Un).set(r,a),r}finalizeDraw(t,e){g(this,Ou).delete(t),this.updateProperties(t,e)}updateProperties(t,e){var h;if(!e)return;const{root:r,bbox:a,rootClass:s,path:l}=e,c=typeof t=="number"?g(this,Un).get(t):t;if(c){if(r&&D(this,_s,TA).call(this,c,r),a&&D(h=xn,Kx,mD).call(h,c,a),s){const{classList:f}=c;for(const[d,m]of Object.entries(s))f.toggle(d,m)}if(l){const d=c.firstChild.firstChild;D(this,_s,TA).call(this,d,l)}}}updateParent(t,e){if(e===this)return;const r=g(this,Un).get(t);r&&(g(e,Di).append(r),g(this,Un).delete(t),g(e,Un).set(t,r))}remove(t){g(this,Ou).delete(t),g(this,Di)!==null&&(g(this,Un).get(t).remove(),g(this,Un).delete(t))}destroy(){T(this,Di,null);for(const t of g(this,Un).values())t.remove();g(this,Un).clear(),g(this,Ou).clear()}};Di=new WeakMap,Ug=new WeakMap,Un=new WeakMap,Ou=new WeakMap,Kx=new WeakSet,mD=function(t,[e,r,a,s]){const{style:l}=t;l.top=`${100*r}%`,l.left=`${100*e}%`,l.width=`${100*a}%`,l.height=`${100*s}%`},_s=new WeakSet,SA=function(){const t=xn._svgFactory.create(1,1,!0);return g(this,Di).append(t),t.setAttribute("aria-hidden",!0),t},xD=function(t,e){const r=xn._svgFactory.createElement("clipPath");t.append(r);const a=`clip_${e}`;r.setAttribute("id",a),r.setAttribute("clipPathUnits","objectBoundingBox");const s=xn._svgFactory.createElement("use");return r.append(s),s.setAttribute("href",`#${e}`),s.classList.add("clip"),a},TA=function(t,e){for(const[r,a]of Object.entries(e))a===null?t.removeAttribute(r):t.setAttribute(r,a)},R(xn,Kx);let bA=xn;globalThis.pdfjsTestingUtils={HighlightOutliner:aA};We.AbortException;We.AnnotationEditorLayer;We.AnnotationEditorParamsType;We.AnnotationEditorType;We.AnnotationEditorUIManager;We.AnnotationLayer;We.AnnotationMode;We.ColorPicker;We.DOMSVGFactory;We.DrawLayer;We.FeatureTest;var rj=We.GlobalWorkerOptions;We.ImageKind;We.InvalidPDFException;We.MissingPDFException;We.OPS;We.OutputScale;We.PDFDataRangeTransport;We.PDFDateString;We.PDFWorker;We.PasswordResponses;We.PermissionFlag;We.PixelsPerInch;We.RenderingCancelledException;We.TextLayer;We.TouchManager;We.UnexpectedResponseException;We.Util;We.VerbosityLevel;We.XfaLayer;We.build;We.createValidAbsoluteUrl;We.fetchData;var nj=We.getDocument;We.getFilenameFromUrl;We.getPdfFilenameFromUrl;We.getXfaPageViewport;We.isDataScheme;We.isPdfFile;We.noContextMenu;We.normalizeUnicode;We.setLayerDimensions;We.shadow;We.stopEvent;We.version;rj.workerSrc="/pdf.worker.min.js";const aj="https://ydxelzxjsuemylifgwte.supabase.co",ij="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkeGVsenhqc3VlbXlsaWZnd3RlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzY2MDY4MzAsImV4cCI6MjA1MjE4MjgzMH0.Nnbgsp8NvJaD_DyXpsNwnvrdZUwZz4ylWzv7_fglxPo";UC(aj,ij);const sj=()=>{const[n,t]=we.useState(()=>JSON.parse(localStorage.getItem("messages"))||[]),[e,r]=we.useState("John"),[a,s]=we.useState(""),[l,c]=we.useState("none");async function h(b){try{const S=d.join(" ");alert(S+`
Based on the previous text, provide a natural and conversational response to the following question :  `+b);var C=atob("c2stcHJvai1iV2Z5UEdZUE80OFZJMGVfQmFaSjM2ZnV1X1c5M3c1eDNhWnF0OE9XS0RObFY3RFZrMWdQQ0xaaFdZTUhKdDI5N1ZIRERZMUEwblQzQmxia0ZKckJVa0lBT0J3MFY3RU9OcXE0bllVYUduYUExVTM3SmVBYTEzNDNNYUlwUDQycEdJX1Rtd2wyTGFxV3ZFV19fWkJQc0tQUlpxWUE=");return(await(await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+C},body:JSON.stringify({model:"gpt-4",messages:[{role:"system",content:"You are a helpful assistant."},{role:"user",content:S+`
Based on the previous text, provide a natural and conversational response to the following question :  `+b}],max_tokens:200})})).json()).choices[0].message.content}catch(S){return console.error("Error fetching ChatGPT response:",S),"Sorry, I couldn't process your request."}}const f=we.useRef(null),[d,m]=we.useState([]);we.useEffect(()=>{(async()=>{const C=["/files/Mathematical database development_.pdf"];alert(C.length);const S=C.map(I=>fetch(I).then(F=>{if(I.endsWith(".txt"))return F.text();if(I.endsWith(".pdf"))return F.arrayBuffer();if(I.endsWith(".xlsx"))return F.arrayBuffer()}).catch(F=>console.error("Error fetching file:",F)));alert("B"+S.length);const O=await Promise.all(S),L=await Promise.all(O.map((I,F)=>{const W=C[F];if(W.endsWith(".txt"))return I;if(W.endsWith(".pdf"))return x(I);if(W.endsWith(".xlsx"))return _(I)}));alert("A"+L.length),m(L)})()},[]);const x=async b=>{const C=await nj({data:b}).promise;let S="";for(let O=1;O<=C.numPages;O++){const F=(await(await C.getPage(O)).getTextContent()).items.map(W=>W.str).join(" ");S+=F+`
`}return S},_=b=>{const C=hw(b,{type:"array"});let S="";return C.SheetNames.forEach(O=>{const L=C.Sheets[O];S+=rH.sheet_to_csv(L)+`
`}),S};we.useEffect(()=>{localStorage.setItem("messages",JSON.stringify(n))},[n]),we.useEffect(()=>{f.current&&(f.current.scrollTop=f.current.scrollHeight)},[n]);const y=b=>{r(b)},A=async b=>{if(b.preventDefault(),a.trim()==="")return;const C=new Date().toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}),S={sender:e,text:a,timestamp:C};if(t(O=>[...O,S]),e==="John"){console.log("msg : "+a),c("flex");const L={sender:"Jane",text:await h(a),timestamp:C};t(I=>[...I,L]),c("none")}s("")},E=()=>{localStorage.clear(),t([])};return qt.jsxs("div",{className:"app-container",children:[qt.jsxs("div",{className:"person-selector",children:[qt.jsx("button",{className:`button person-selector-button ${e==="John"?"active-person":""}`,onClick:()=>y("John"),children:"John"}),qt.jsx("button",{className:`button person-selector-button ${e==="Jane"?"active-person":""}`,onClick:()=>y("Jane"),children:"Jane"})]}),qt.jsxs("div",{className:"chat-container",children:[qt.jsxs("div",{className:"chat-header typing-indicator",style:{display:l},children:[qt.jsxs("h2",{className:"chat-header",children:[e," chatting"]}),qt.jsx("span",{className:"dot"}),qt.jsx("span",{className:"dot"}),qt.jsx("span",{className:"dot"})]}),qt.jsx("div",{ref:f,className:"chat-messages",children:n.map((b,C)=>qt.jsxs("div",{className:`message ${b.sender==="John"?"blue-bg":"gray-bg"}`,children:[qt.jsx("div",{className:"message-sender",children:b.sender}),qt.jsx("div",{className:"message-text",children:b.text}),qt.jsx("div",{className:"message-timestamp",children:b.timestamp})]},C))}),qt.jsxs("form",{className:"chat-input-form",onSubmit:A,children:[qt.jsx("textarea",{id:"message",name:"message",rows:"5",cols:"50",className:"chat-input",value:a,placeholder:`Type here, ${e}...`,onChange:b=>s(b.target.value)}),qt.jsx("button",{type:"submit",className:"button send-button",children:"Send"})]}),qt.jsx("button",{className:"button send-button",onClick:E,children:"Clear Chat"})]})]})},oj="https://ydxelzxjsuemylifgwte.supabase.co",lj="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkeGVsenhqc3VlbXlsaWZnd3RlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzY2MDY4MzAsImV4cCI6MjA1MjE4MjgzMH0.Nnbgsp8NvJaD_DyXpsNwnvrdZUwZz4ylWzv7_fglxPo";UC(oj,lj);const cj=()=>qt.jsx("div",{children:qt.jsx("main",{children:qt.jsx(sj,{})})}),uj=IF.createRoot(document.getElementById("root"));uj.render(qt.jsx(RF.StrictMode,{children:qt.jsx(QM,{basename:"/",children:qt.jsx(cj,{})})}));export{kA as g};
