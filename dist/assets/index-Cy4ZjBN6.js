var Jd=Object.defineProperty;var Th=e=>{throw TypeError(e)};var Qd=(e,r,t)=>r in e?Jd(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var Ut=(e,r,t)=>Qd(e,typeof r!="symbol"?r+"":r,t),Il=(e,r,t)=>r.has(e)||Th("Cannot "+t);var le=(e,r,t)=>(Il(e,r,"read from private field"),t?t.call(e):r.get(e)),qe=(e,r,t)=>r.has(e)?Th("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(e):r.set(e,t),$e=(e,r,t,n)=>(Il(e,r,"write to private field"),n?n.call(e,t):r.set(e,t),t),je=(e,r,t)=>(Il(e,r,"access private method"),t);var Bl=(e,r,t,n)=>({set _(i){$e(e,r,i,t)},get _(){return le(e,r,n)}});(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function t(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerPolicy&&(l.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?l.credentials="include":i.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(i){if(i.ep)return;i.ep=!0;const l=t(i);fetch(i.href,l)}})();function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(e.__esModule)return e;var r=e.default;if(typeof r=="function"){var t=function n(){return this instanceof n?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};t.prototype=r.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),t}var jsxRuntime={exports:{}},reactJsxRuntime_production={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production;function requireReactJsxRuntime_production(){if(hasRequiredReactJsxRuntime_production)return reactJsxRuntime_production;hasRequiredReactJsxRuntime_production=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment");function t(n,i,l){var c=null;if(l!==void 0&&(c=""+l),i.key!==void 0&&(c=""+i.key),"key"in i){l={};for(var f in i)f!=="key"&&(l[f]=i[f])}else l=i;return i=l.ref,{$$typeof:e,type:n,key:c,ref:i!==void 0?i:null,props:l}}return reactJsxRuntime_production.Fragment=r,reactJsxRuntime_production.jsx=t,reactJsxRuntime_production.jsxs=t,reactJsxRuntime_production}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),react={exports:{}},react_production={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production;function requireReact_production(){if(hasRequiredReact_production)return react_production;hasRequiredReact_production=1;var e=Symbol.for("react.transitional.element"),r=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),E=Symbol.iterator;function v(W){return W===null||typeof W!="object"?null:(W=E&&W[E]||W["@@iterator"],typeof W=="function"?W:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,g={};function m(W,xe,I){this.props=W,this.context=xe,this.refs=g,this.updater=I||S}m.prototype.isReactComponent={},m.prototype.setState=function(W,xe){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,xe,"setState")},m.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function b(){}b.prototype=m.prototype;function D(W,xe,I){this.props=W,this.context=xe,this.refs=g,this.updater=I||S}var C=D.prototype=new b;C.constructor=D,x(C,m.prototype),C.isPureReactComponent=!0;var F=Array.isArray,T={H:null,A:null,T:null,S:null},w=Object.prototype.hasOwnProperty;function y(W,xe,I,M,R,U){return I=U.ref,{$$typeof:e,type:W,key:xe,ref:I!==void 0?I:null,props:U}}function N(W,xe){return y(W.type,xe,void 0,void 0,void 0,W.props)}function L(W){return typeof W=="object"&&W!==null&&W.$$typeof===e}function X(W){var xe={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(I){return xe[I]})}var z=/\/+/g;function se(W,xe){return typeof W=="object"&&W!==null&&W.key!=null?X(""+W.key):xe.toString(36)}function me(){}function _e(W){switch(W.status){case"fulfilled":return W.value;case"rejected":throw W.reason;default:switch(typeof W.status=="string"?W.then(me,me):(W.status="pending",W.then(function(xe){W.status==="pending"&&(W.status="fulfilled",W.value=xe)},function(xe){W.status==="pending"&&(W.status="rejected",W.reason=xe)})),W.status){case"fulfilled":return W.value;case"rejected":throw W.reason}}throw W}function de(W,xe,I,M,R){var U=typeof W;(U==="undefined"||U==="boolean")&&(W=null);var V=!1;if(W===null)V=!0;else switch(U){case"bigint":case"string":case"number":V=!0;break;case"object":switch(W.$$typeof){case e:case r:V=!0;break;case p:return V=W._init,de(V(W._payload),xe,I,M,R)}}if(V)return R=R(W),V=M===""?"."+se(W,0):M,F(R)?(I="",V!=null&&(I=V.replace(z,"$&/")+"/"),de(R,xe,I,"",function(O){return O})):R!=null&&(L(R)&&(R=N(R,I+(R.key==null||W&&W.key===R.key?"":(""+R.key).replace(z,"$&/")+"/")+V)),xe.push(R)),1;V=0;var Z=M===""?".":M+":";if(F(W))for(var J=0;J<W.length;J++)M=W[J],U=Z+se(M,J),V+=de(M,xe,I,U,R);else if(J=v(W),typeof J=="function")for(W=J.call(W),J=0;!(M=W.next()).done;)M=M.value,U=Z+se(M,J++),V+=de(M,xe,I,U,R);else if(U==="object"){if(typeof W.then=="function")return de(_e(W),xe,I,M,R);throw xe=String(W),Error("Objects are not valid as a React child (found: "+(xe==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":xe)+"). If you meant to render a collection of children, use an array instead.")}return V}function Y(W,xe,I){if(W==null)return W;var M=[],R=0;return de(W,M,"","",function(U){return xe.call(I,U,R++)}),M}function ie(W){if(W._status===-1){var xe=W._result;xe=xe(),xe.then(function(I){(W._status===0||W._status===-1)&&(W._status=1,W._result=I)},function(I){(W._status===0||W._status===-1)&&(W._status=2,W._result=I)}),W._status===-1&&(W._status=0,W._result=xe)}if(W._status===1)return W._result.default;throw W._result}var fe=typeof reportError=="function"?reportError:function(W){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var xe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof W=="object"&&W!==null&&typeof W.message=="string"?String(W.message):String(W),error:W});if(!window.dispatchEvent(xe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",W);return}console.error(W)};function ae(){}return react_production.Children={map:Y,forEach:function(W,xe,I){Y(W,function(){xe.apply(this,arguments)},I)},count:function(W){var xe=0;return Y(W,function(){xe++}),xe},toArray:function(W){return Y(W,function(xe){return xe})||[]},only:function(W){if(!L(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},react_production.Component=m,react_production.Fragment=t,react_production.Profiler=i,react_production.PureComponent=D,react_production.StrictMode=n,react_production.Suspense=d,react_production.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,react_production.act=function(){throw Error("act(...) is not supported in production builds of React.")},react_production.cache=function(W){return function(){return W.apply(null,arguments)}},react_production.cloneElement=function(W,xe,I){if(W==null)throw Error("The argument must be a React element, but you passed "+W+".");var M=x({},W.props),R=W.key,U=void 0;if(xe!=null)for(V in xe.ref!==void 0&&(U=void 0),xe.key!==void 0&&(R=""+xe.key),xe)!w.call(xe,V)||V==="key"||V==="__self"||V==="__source"||V==="ref"&&xe.ref===void 0||(M[V]=xe[V]);var V=arguments.length-2;if(V===1)M.children=I;else if(1<V){for(var Z=Array(V),J=0;J<V;J++)Z[J]=arguments[J+2];M.children=Z}return y(W.type,R,void 0,void 0,U,M)},react_production.createContext=function(W){return W={$$typeof:c,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null},W.Provider=W,W.Consumer={$$typeof:l,_context:W},W},react_production.createElement=function(W,xe,I){var M,R={},U=null;if(xe!=null)for(M in xe.key!==void 0&&(U=""+xe.key),xe)w.call(xe,M)&&M!=="key"&&M!=="__self"&&M!=="__source"&&(R[M]=xe[M]);var V=arguments.length-2;if(V===1)R.children=I;else if(1<V){for(var Z=Array(V),J=0;J<V;J++)Z[J]=arguments[J+2];R.children=Z}if(W&&W.defaultProps)for(M in V=W.defaultProps,V)R[M]===void 0&&(R[M]=V[M]);return y(W,U,void 0,void 0,null,R)},react_production.createRef=function(){return{current:null}},react_production.forwardRef=function(W){return{$$typeof:f,render:W}},react_production.isValidElement=L,react_production.lazy=function(W){return{$$typeof:p,_payload:{_status:-1,_result:W},_init:ie}},react_production.memo=function(W,xe){return{$$typeof:h,type:W,compare:xe===void 0?null:xe}},react_production.startTransition=function(W){var xe=T.T,I={};T.T=I;try{var M=W(),R=T.S;R!==null&&R(I,M),typeof M=="object"&&M!==null&&typeof M.then=="function"&&M.then(ae,fe)}catch(U){fe(U)}finally{T.T=xe}},react_production.unstable_useCacheRefresh=function(){return T.H.useCacheRefresh()},react_production.use=function(W){return T.H.use(W)},react_production.useActionState=function(W,xe,I){return T.H.useActionState(W,xe,I)},react_production.useCallback=function(W,xe){return T.H.useCallback(W,xe)},react_production.useContext=function(W){return T.H.useContext(W)},react_production.useDebugValue=function(){},react_production.useDeferredValue=function(W,xe){return T.H.useDeferredValue(W,xe)},react_production.useEffect=function(W,xe){return T.H.useEffect(W,xe)},react_production.useId=function(){return T.H.useId()},react_production.useImperativeHandle=function(W,xe,I){return T.H.useImperativeHandle(W,xe,I)},react_production.useInsertionEffect=function(W,xe){return T.H.useInsertionEffect(W,xe)},react_production.useLayoutEffect=function(W,xe){return T.H.useLayoutEffect(W,xe)},react_production.useMemo=function(W,xe){return T.H.useMemo(W,xe)},react_production.useOptimistic=function(W,xe){return T.H.useOptimistic(W,xe)},react_production.useReducer=function(W,xe,I){return T.H.useReducer(W,xe,I)},react_production.useRef=function(W){return T.H.useRef(W)},react_production.useState=function(W){return T.H.useState(W)},react_production.useSyncExternalStore=function(W,xe,I){return T.H.useSyncExternalStore(W,xe,I)},react_production.useTransition=function(){return T.H.useTransition()},react_production.version="19.0.0",react_production}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production()),react.exports}var reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var client={exports:{}},reactDomClient_production={},scheduler={exports:{}},scheduler_production={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production;function requireScheduler_production(){return hasRequiredScheduler_production||(hasRequiredScheduler_production=1,function(e){function r(Y,ie){var fe=Y.length;Y.push(ie);e:for(;0<fe;){var ae=fe-1>>>1,W=Y[ae];if(0<i(W,ie))Y[ae]=ie,Y[fe]=W,fe=ae;else break e}}function t(Y){return Y.length===0?null:Y[0]}function n(Y){if(Y.length===0)return null;var ie=Y[0],fe=Y.pop();if(fe!==ie){Y[0]=fe;e:for(var ae=0,W=Y.length,xe=W>>>1;ae<xe;){var I=2*(ae+1)-1,M=Y[I],R=I+1,U=Y[R];if(0>i(M,fe))R<W&&0>i(U,M)?(Y[ae]=U,Y[R]=fe,ae=R):(Y[ae]=M,Y[I]=fe,ae=I);else if(R<W&&0>i(U,fe))Y[ae]=U,Y[R]=fe,ae=R;else break e}}return ie}function i(Y,ie){var fe=Y.sortIndex-ie.sortIndex;return fe!==0?fe:Y.id-ie.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var c=Date,f=c.now();e.unstable_now=function(){return c.now()-f}}var d=[],h=[],p=1,E=null,v=3,S=!1,x=!1,g=!1,m=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function C(Y){for(var ie=t(h);ie!==null;){if(ie.callback===null)n(h);else if(ie.startTime<=Y)n(h),ie.sortIndex=ie.expirationTime,r(d,ie);else break;ie=t(h)}}function F(Y){if(g=!1,C(Y),!x)if(t(d)!==null)x=!0,_e();else{var ie=t(h);ie!==null&&de(F,ie.startTime-Y)}}var T=!1,w=-1,y=5,N=-1;function L(){return!(e.unstable_now()-N<y)}function X(){if(T){var Y=e.unstable_now();N=Y;var ie=!0;try{e:{x=!1,g&&(g=!1,b(w),w=-1),S=!0;var fe=v;try{t:{for(C(Y),E=t(d);E!==null&&!(E.expirationTime>Y&&L());){var ae=E.callback;if(typeof ae=="function"){E.callback=null,v=E.priorityLevel;var W=ae(E.expirationTime<=Y);if(Y=e.unstable_now(),typeof W=="function"){E.callback=W,C(Y),ie=!0;break t}E===t(d)&&n(d),C(Y)}else n(d);E=t(d)}if(E!==null)ie=!0;else{var xe=t(h);xe!==null&&de(F,xe.startTime-Y),ie=!1}}break e}finally{E=null,v=fe,S=!1}ie=void 0}}finally{ie?z():T=!1}}}var z;if(typeof D=="function")z=function(){D(X)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,me=se.port2;se.port1.onmessage=X,z=function(){me.postMessage(null)}}else z=function(){m(X,0)};function _e(){T||(T=!0,z())}function de(Y,ie){w=m(function(){Y(e.unstable_now())},ie)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Y){Y.callback=null},e.unstable_continueExecution=function(){x||S||(x=!0,_e())},e.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<Y?Math.floor(1e3/Y):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_getFirstCallbackNode=function(){return t(d)},e.unstable_next=function(Y){switch(v){case 1:case 2:case 3:var ie=3;break;default:ie=v}var fe=v;v=ie;try{return Y()}finally{v=fe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Y,ie){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var fe=v;v=Y;try{return ie()}finally{v=fe}},e.unstable_scheduleCallback=function(Y,ie,fe){var ae=e.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?ae+fe:ae):fe=ae,Y){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=fe+W,Y={id:p++,callback:ie,priorityLevel:Y,startTime:fe,expirationTime:W,sortIndex:-1},fe>ae?(Y.sortIndex=fe,r(h,Y),t(d)===null&&Y===t(h)&&(g?(b(w),w=-1):g=!0,de(F,fe-ae))):(Y.sortIndex=W,r(d,Y),x||S||(x=!0,_e())),Y},e.unstable_shouldYield=L,e.unstable_wrapCallback=function(Y){var ie=v;return function(){var fe=v;v=ie;try{return Y.apply(this,arguments)}finally{v=fe}}}}(scheduler_production)),scheduler_production}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production()),scheduler.exports}var reactDom={exports:{}},reactDom_production={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production;function requireReactDom_production(){if(hasRequiredReactDom_production)return reactDom_production;hasRequiredReactDom_production=1;var e=requireReact();function r(d){var h="https://react.dev/errors/"+d;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)h+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+d+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(r(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function l(d,h,p){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:E==null?null:""+E,children:d,containerInfo:h,implementation:p}}var c=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(d,h){if(d==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return reactDom_production.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,reactDom_production.createPortal=function(d,h){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(r(299));return l(d,h,null,p)},reactDom_production.flushSync=function(d){var h=c.T,p=n.p;try{if(c.T=null,n.p=2,d)return d()}finally{c.T=h,n.p=p,n.d.f()}},reactDom_production.preconnect=function(d,h){typeof d=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,n.d.C(d,h))},reactDom_production.prefetchDNS=function(d){typeof d=="string"&&n.d.D(d)},reactDom_production.preinit=function(d,h){if(typeof d=="string"&&h&&typeof h.as=="string"){var p=h.as,E=f(p,h.crossOrigin),v=typeof h.integrity=="string"?h.integrity:void 0,S=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;p==="style"?n.d.S(d,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:E,integrity:v,fetchPriority:S}):p==="script"&&n.d.X(d,{crossOrigin:E,integrity:v,fetchPriority:S,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},reactDom_production.preinitModule=function(d,h){if(typeof d=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var p=f(h.as,h.crossOrigin);n.d.M(d,{crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&n.d.M(d)},reactDom_production.preload=function(d,h){if(typeof d=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var p=h.as,E=f(p,h.crossOrigin);n.d.L(d,p,{crossOrigin:E,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},reactDom_production.preloadModule=function(d,h){if(typeof d=="string")if(h){var p=f(h.as,h.crossOrigin);n.d.m(d,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else n.d.m(d)},reactDom_production.requestFormReset=function(d){n.d.r(d)},reactDom_production.unstable_batchedUpdates=function(d,h){return d(h)},reactDom_production.useFormState=function(d,h,p){return c.H.useFormState(d,h,p)},reactDom_production.useFormStatus=function(){return c.H.useHostTransitionStatus()},reactDom_production.version="19.0.0",reactDom_production}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),reactDom.exports=requireReactDom_production(),reactDom.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDomClient_production;function requireReactDomClient_production(){if(hasRequiredReactDomClient_production)return reactDomClient_production;hasRequiredReactDomClient_production=1;var e=requireScheduler(),r=requireReact(),t=requireReactDom();function n(a){var s="https://react.dev/errors/"+a;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+a+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}var l=Symbol.for("react.element"),c=Symbol.for("react.transitional.element"),f=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),E=Symbol.for("react.provider"),v=Symbol.for("react.consumer"),S=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),C=Symbol.for("react.offscreen"),F=Symbol.for("react.memo_cache_sentinel"),T=Symbol.iterator;function w(a){return a===null||typeof a!="object"?null:(a=T&&a[T]||a["@@iterator"],typeof a=="function"?a:null)}var y=Symbol.for("react.client.reference");function N(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===y?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case d:return"Fragment";case f:return"Portal";case p:return"Profiler";case h:return"StrictMode";case g:return"Suspense";case m:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case S:return(a.displayName||"Context")+".Provider";case v:return(a._context.displayName||"Context")+".Consumer";case x:var s=a.render;return a=a.displayName,a||(a=s.displayName||s.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case b:return s=a.displayName||null,s!==null?s:N(a.type)||"Memo";case D:s=a._payload,a=a._init;try{return N(a(s))}catch{}}return null}var L=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X=Object.assign,z,se;function me(a){if(z===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);z=s&&s[1]||"",se=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+z+a+se}var _e=!1;function de(a,s){if(!a||_e)return"";_e=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(s){var He=function(){throw Error()};if(Object.defineProperty(He.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(He,[])}catch(Ne){var Pe=Ne}Reflect.construct(a,[],He)}else{try{He.call()}catch(Ne){Pe=Ne}a.call(He.prototype)}}else{try{throw Error()}catch(Ne){Pe=Ne}(He=a())&&typeof He.catch=="function"&&He.catch(function(){})}}catch(Ne){if(Ne&&Pe&&typeof Ne.stack=="string")return[Ne.stack,Pe.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var _=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");_&&_.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var A=u.DetermineComponentFrameRoot(),j=A[0],ee=A[1];if(j&&ee){var pe=j.split(`
`),Ee=ee.split(`
`);for(_=u=0;u<pe.length&&!pe[u].includes("DetermineComponentFrameRoot");)u++;for(;_<Ee.length&&!Ee[_].includes("DetermineComponentFrameRoot");)_++;if(u===pe.length||_===Ee.length)for(u=pe.length-1,_=Ee.length-1;1<=u&&0<=_&&pe[u]!==Ee[_];)_--;for(;1<=u&&0<=_;u--,_--)if(pe[u]!==Ee[_]){if(u!==1||_!==1)do if(u--,_--,0>_||pe[u]!==Ee[_]){var Be=`
`+pe[u].replace(" at new "," at ");return a.displayName&&Be.includes("<anonymous>")&&(Be=Be.replace("<anonymous>",a.displayName)),Be}while(1<=u&&0<=_);break}}}finally{_e=!1,Error.prepareStackTrace=o}return(o=a?a.displayName||a.name:"")?me(o):""}function Y(a){switch(a.tag){case 26:case 27:case 5:return me(a.type);case 16:return me("Lazy");case 13:return me("Suspense");case 19:return me("SuspenseList");case 0:case 15:return a=de(a.type,!1),a;case 11:return a=de(a.type.render,!1),a;case 1:return a=de(a.type,!0),a;default:return""}}function ie(a){try{var s="";do s+=Y(a),a=a.return;while(a);return s}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}function fe(a){var s=a,o=a;if(a.alternate)for(;s.return;)s=s.return;else{a=s;do s=a,s.flags&4098&&(o=s.return),a=s.return;while(a)}return s.tag===3?o:null}function ae(a){if(a.tag===13){var s=a.memoizedState;if(s===null&&(a=a.alternate,a!==null&&(s=a.memoizedState)),s!==null)return s.dehydrated}return null}function W(a){if(fe(a)!==a)throw Error(n(188))}function xe(a){var s=a.alternate;if(!s){if(s=fe(a),s===null)throw Error(n(188));return s!==a?null:a}for(var o=a,u=s;;){var _=o.return;if(_===null)break;var A=_.alternate;if(A===null){if(u=_.return,u!==null){o=u;continue}break}if(_.child===A.child){for(A=_.child;A;){if(A===o)return W(_),a;if(A===u)return W(_),s;A=A.sibling}throw Error(n(188))}if(o.return!==u.return)o=_,u=A;else{for(var j=!1,ee=_.child;ee;){if(ee===o){j=!0,o=_,u=A;break}if(ee===u){j=!0,u=_,o=A;break}ee=ee.sibling}if(!j){for(ee=A.child;ee;){if(ee===o){j=!0,o=A,u=_;break}if(ee===u){j=!0,u=A,o=_;break}ee=ee.sibling}if(!j)throw Error(n(189))}}if(o.alternate!==u)throw Error(n(190))}if(o.tag!==3)throw Error(n(188));return o.stateNode.current===o?a:s}function I(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a;for(a=a.child;a!==null;){if(s=I(a),s!==null)return s;a=a.sibling}return null}var M=Array.isArray,R=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U={pending:!1,data:null,method:null,action:null},V=[],Z=-1;function J(a){return{current:a}}function O(a){0>Z||(a.current=V[Z],V[Z]=null,Z--)}function B(a,s){Z++,V[Z]=a.current,a.current=s}var G=J(null),P=J(null),K=J(null),oe=J(null);function re(a,s){switch(B(K,s),B(P,a),B(G,null),a=s.nodeType,a){case 9:case 11:s=(s=s.documentElement)&&(s=s.namespaceURI)?eh(s):0;break;default:if(a=a===8?s.parentNode:s,s=a.tagName,a=a.namespaceURI)a=eh(a),s=th(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}O(G),B(G,s)}function H(){O(G),O(P),O(K)}function Q(a){a.memoizedState!==null&&B(oe,a);var s=G.current,o=th(s,a.type);s!==o&&(B(P,a),B(G,o))}function be(a){P.current===a&&(O(G),O(P)),oe.current===a&&(O(oe),_s._currentValue=U)}var ge=Object.prototype.hasOwnProperty,ye=e.unstable_scheduleCallback,we=e.unstable_cancelCallback,Le=e.unstable_shouldYield,Ve=e.unstable_requestPaint,Ce=e.unstable_now,nt=e.unstable_getCurrentPriorityLevel,tt=e.unstable_ImmediatePriority,Je=e.unstable_UserBlockingPriority,et=e.unstable_NormalPriority,ht=e.unstable_LowPriority,Qe=e.unstable_IdlePriority,it=e.log,pt=e.unstable_setDisableYieldValue,st=null,ct=null;function lr(a){if(ct&&typeof ct.onCommitFiberRoot=="function")try{ct.onCommitFiberRoot(st,a,void 0,(a.current.flags&128)===128)}catch{}}function Yt(a){if(typeof it=="function"&&pt(a),ct&&typeof ct.setStrictMode=="function")try{ct.setStrictMode(st,a)}catch{}}var Mt=Math.clz32?Math.clz32:Ae,Me=Math.log,Se=Math.LN2;function Ae(a){return a>>>=0,a===0?32:31-(Me(a)/Se|0)|0}var Ye=128,lt=4194304;function gt(a){var s=a&42;if(s!==0)return s;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function yt(a,s){var o=a.pendingLanes;if(o===0)return 0;var u=0,_=a.suspendedLanes,A=a.pingedLanes,j=a.warmLanes;a=a.finishedLanes!==0;var ee=o&134217727;return ee!==0?(o=ee&~_,o!==0?u=gt(o):(A&=ee,A!==0?u=gt(A):a||(j=ee&~j,j!==0&&(u=gt(j))))):(ee=o&~_,ee!==0?u=gt(ee):A!==0?u=gt(A):a||(j=o&~j,j!==0&&(u=gt(j)))),u===0?0:s!==0&&s!==u&&!(s&_)&&(_=u&-u,j=s&-s,_>=j||_===32&&(j&4194176)!==0)?s:u}function Zt(a,s){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&s)===0}function Pr(a,s){switch(a){case 1:case 2:case 4:case 8:return s+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gr(){var a=Ye;return Ye<<=1,!(Ye&4194176)&&(Ye=128),a}function Vt(){var a=lt;return lt<<=1,!(lt&62914560)&&(lt=4194304),a}function _r(a){for(var s=[],o=0;31>o;o++)s.push(a);return s}function er(a,s){a.pendingLanes|=s,s!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function sa(a,s,o,u,_,A){var j=a.pendingLanes;a.pendingLanes=o,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=o,a.entangledLanes&=o,a.errorRecoveryDisabledLanes&=o,a.shellSuspendCounter=0;var ee=a.entanglements,pe=a.expirationTimes,Ee=a.hiddenUpdates;for(o=j&~o;0<o;){var Be=31-Mt(o),He=1<<Be;ee[Be]=0,pe[Be]=-1;var Pe=Ee[Be];if(Pe!==null)for(Ee[Be]=null,Be=0;Be<Pe.length;Be++){var Ne=Pe[Be];Ne!==null&&(Ne.lane&=-536870913)}o&=~He}u!==0&&Ft(a,u,0),A!==0&&_===0&&a.tag!==0&&(a.suspendedLanes|=A&~(j&~s))}function Ft(a,s,o){a.pendingLanes|=s,a.suspendedLanes&=~s;var u=31-Mt(s);a.entangledLanes|=s,a.entanglements[u]=a.entanglements[u]|1073741824|o&4194218}function Hr(a,s){var o=a.entangledLanes|=s;for(a=a.entanglements;o;){var u=31-Mt(o),_=1<<u;_&s|a[u]&s&&(a[u]|=s),o&=~_}}function zr(a){return a&=-a,2<a?8<a?a&134217727?32:268435456:8:2}function ia(){var a=R.p;return a!==0?a:(a=window.event,a===void 0?32:vh(a.type))}function q(a,s){var o=R.p;try{return R.p=a,s()}finally{R.p=o}}var ce=Math.random().toString(36).slice(2),te="__reactFiber$"+ce,ne="__reactProps$"+ce,ue="__reactContainer$"+ce,he="__reactEvents$"+ce,Oe="__reactListeners$"+ce,Ie="__reactHandles$"+ce,Re="__reactResources$"+ce,Fe="__reactMarker$"+ce;function De(a){delete a[te],delete a[ne],delete a[he],delete a[Oe],delete a[Ie]}function ze(a){var s=a[te];if(s)return s;for(var o=a.parentNode;o;){if(s=o[ue]||o[te]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(a=nh(a);a!==null;){if(o=a[te])return o;a=nh(a)}return s}a=o,o=a.parentNode}return null}function We(a){if(a=a[te]||a[ue]){var s=a.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return a}return null}function Ke(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a.stateNode;throw Error(n(33))}function Xe(a){var s=a[Re];return s||(s=a[Re]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Ge(a){a[Fe]=!0}var ut=new Set,Ct={};function At(a,s){Ot(a,s),Ot(a+"Capture",s)}function Ot(a,s){for(Ct[a]=s,a=0;a<s.length;a++)ut.add(s[a])}var rr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ra=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),oa={},Mr={};function Rn(a){return ge.call(Mr,a)?!0:ge.call(oa,a)?!1:Ra.test(a)?Mr[a]=!0:(oa[a]=!0,!1)}function sr(a,s,o){if(Rn(s))if(o===null)a.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":a.removeAttribute(s);return;case"boolean":var u=s.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){a.removeAttribute(s);return}}a.setAttribute(s,""+o)}}function As(a,s,o){if(o===null)a.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(s);return}a.setAttribute(s,""+o)}}function Vr(a,s,o,u){if(u===null)a.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(o);return}a.setAttributeNS(s,o,""+u)}}function mr(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function rc(a){var s=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function qh(a){var s=rc(a)?"checked":"value",o=Object.getOwnPropertyDescriptor(a.constructor.prototype,s),u=""+a[s];if(!a.hasOwnProperty(s)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var _=o.get,A=o.set;return Object.defineProperty(a,s,{configurable:!0,get:function(){return _.call(this)},set:function(j){u=""+j,A.call(this,j)}}),Object.defineProperty(a,s,{enumerable:o.enumerable}),{getValue:function(){return u},setValue:function(j){u=""+j},stopTracking:function(){a._valueTracker=null,delete a[s]}}}}function bs(a){a._valueTracker||(a._valueTracker=qh(a))}function ac(a){if(!a)return!1;var s=a._valueTracker;if(!s)return!0;var o=s.getValue(),u="";return a&&(u=rc(a)?a.checked?"true":"false":a.value),a=u,a!==o?(s.setValue(a),!0):!1}function Ts(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var $h=/[\n"\\]/g;function xr(a){return a.replace($h,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Mi(a,s,o,u,_,A,j,ee){a.name="",j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"?a.type=j:a.removeAttribute("type"),s!=null?j==="number"?(s===0&&a.value===""||a.value!=s)&&(a.value=""+mr(s)):a.value!==""+mr(s)&&(a.value=""+mr(s)):j!=="submit"&&j!=="reset"||a.removeAttribute("value"),s!=null?Li(a,j,mr(s)):o!=null?Li(a,j,mr(o)):u!=null&&a.removeAttribute("value"),_==null&&A!=null&&(a.defaultChecked=!!A),_!=null&&(a.checked=_&&typeof _!="function"&&typeof _!="symbol"),ee!=null&&typeof ee!="function"&&typeof ee!="symbol"&&typeof ee!="boolean"?a.name=""+mr(ee):a.removeAttribute("name")}function nc(a,s,o,u,_,A,j,ee){if(A!=null&&typeof A!="function"&&typeof A!="symbol"&&typeof A!="boolean"&&(a.type=A),s!=null||o!=null){if(!(A!=="submit"&&A!=="reset"||s!=null))return;o=o!=null?""+mr(o):"",s=s!=null?""+mr(s):o,ee||s===a.value||(a.value=s),a.defaultValue=s}u=u??_,u=typeof u!="function"&&typeof u!="symbol"&&!!u,a.checked=ee?a.checked:!!u,a.defaultChecked=!!u,j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(a.name=j)}function Li(a,s,o){s==="number"&&Ts(a.ownerDocument)===a||a.defaultValue===""+o||(a.defaultValue=""+o)}function Ya(a,s,o,u){if(a=a.options,s){s={};for(var _=0;_<o.length;_++)s["$"+o[_]]=!0;for(o=0;o<a.length;o++)_=s.hasOwnProperty("$"+a[o].value),a[o].selected!==_&&(a[o].selected=_),_&&u&&(a[o].defaultSelected=!0)}else{for(o=""+mr(o),s=null,_=0;_<a.length;_++){if(a[_].value===o){a[_].selected=!0,u&&(a[_].defaultSelected=!0);return}s!==null||a[_].disabled||(s=a[_])}s!==null&&(s.selected=!0)}}function sc(a,s,o){if(s!=null&&(s=""+mr(s),s!==a.value&&(a.value=s),o==null)){a.defaultValue!==s&&(a.defaultValue=s);return}a.defaultValue=o!=null?""+mr(o):""}function ic(a,s,o,u){if(s==null){if(u!=null){if(o!=null)throw Error(n(92));if(M(u)){if(1<u.length)throw Error(n(93));u=u[0]}o=u}o==null&&(o=""),s=o}o=mr(s),a.defaultValue=o,u=a.textContent,u===o&&u!==""&&u!==null&&(a.value=u)}function Ka(a,s){if(s){var o=a.firstChild;if(o&&o===a.lastChild&&o.nodeType===3){o.nodeValue=s;return}}a.textContent=s}var Wh=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function oc(a,s,o){var u=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?a.setProperty(s,""):s==="float"?a.cssFloat="":a[s]="":u?a.setProperty(s,o):typeof o!="number"||o===0||Wh.has(s)?s==="float"?a.cssFloat=o:a[s]=(""+o).trim():a[s]=o+"px"}function lc(a,s,o){if(s!=null&&typeof s!="object")throw Error(n(62));if(a=a.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||s!=null&&s.hasOwnProperty(u)||(u.indexOf("--")===0?a.setProperty(u,""):u==="float"?a.cssFloat="":a[u]="");for(var _ in s)u=s[_],s.hasOwnProperty(_)&&o[_]!==u&&oc(a,_,u)}else for(var A in s)s.hasOwnProperty(A)&&oc(a,A,s[A])}function Ni(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Kh=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ws(a){return Kh.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var Ii=null;function Bi(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Ja=null,Qa=null;function cc(a){var s=We(a);if(s&&(a=s.stateNode)){var o=a[ne]||null;e:switch(a=s.stateNode,s.type){case"input":if(Mi(a,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=a;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+xr(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var u=o[s];if(u!==a&&u.form===a.form){var _=u[ne]||null;if(!_)throw Error(n(90));Mi(u,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name)}}for(s=0;s<o.length;s++)u=o[s],u.form===a.form&&ac(u)}break e;case"textarea":sc(a,o.value,o.defaultValue);break e;case"select":s=o.value,s!=null&&Ya(a,!!o.multiple,s,!1)}}}var Ui=!1;function uc(a,s,o){if(Ui)return a(s,o);Ui=!0;try{var u=a(s);return u}finally{if(Ui=!1,(Ja!==null||Qa!==null)&&(ci(),Ja&&(s=Ja,a=Qa,Qa=Ja=null,cc(s),a)))for(s=0;s<a.length;s++)cc(a[s])}}function Fn(a,s){var o=a.stateNode;if(o===null)return null;var u=o[ne]||null;if(u===null)return null;o=u[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(a=a.type,u=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!u;break e;default:a=!1}if(a)return null;if(o&&typeof o!="function")throw Error(n(231,s,typeof o));return o}var ji=!1;if(rr)try{var On={};Object.defineProperty(On,"passive",{get:function(){ji=!0}}),window.addEventListener("test",On,On),window.removeEventListener("test",On,On)}catch{ji=!1}var la=null,Hi=null,Cs=null;function fc(){if(Cs)return Cs;var a,s=Hi,o=s.length,u,_="value"in la?la.value:la.textContent,A=_.length;for(a=0;a<o&&s[a]===_[a];a++);var j=o-a;for(u=1;u<=j&&s[o-u]===_[A-u];u++);return Cs=_.slice(a,1<u?1-u:void 0)}function ks(a){var s=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&s===13&&(a=13)):a=s,a===10&&(a=13),32<=a||a===13?a:0}function Rs(){return!0}function hc(){return!1}function ir(a){function s(o,u,_,A,j){this._reactName=o,this._targetInst=_,this.type=u,this.nativeEvent=A,this.target=j,this.currentTarget=null;for(var ee in a)a.hasOwnProperty(ee)&&(o=a[ee],this[ee]=o?o(A):A[ee]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?Rs:hc,this.isPropagationStopped=hc,this}return X(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Rs)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Rs)},persist:function(){},isPersistent:Rs}),s}var Fa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fs=ir(Fa),Dn=X({},Fa,{view:0,detail:0}),Jh=ir(Dn),zi,Vi,Pn,Os=X({},Dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gi,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Pn&&(Pn&&a.type==="mousemove"?(zi=a.screenX-Pn.screenX,Vi=a.screenY-Pn.screenY):Vi=zi=0,Pn=a),zi)},movementY:function(a){return"movementY"in a?a.movementY:Vi}}),dc=ir(Os),Qh=X({},Os,{dataTransfer:0}),Zh=ir(Qh),e0=X({},Dn,{relatedTarget:0}),Xi=ir(e0),t0=X({},Fa,{animationName:0,elapsedTime:0,pseudoElement:0}),r0=ir(t0),a0=X({},Fa,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),n0=ir(a0),s0=X({},Fa,{data:0}),pc=ir(s0),i0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},o0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},l0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function c0(a){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(a):(a=l0[a])?!!s[a]:!1}function Gi(){return c0}var u0=X({},Dn,{key:function(a){if(a.key){var s=i0[a.key]||a.key;if(s!=="Unidentified")return s}return a.type==="keypress"?(a=ks(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?o0[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gi,charCode:function(a){return a.type==="keypress"?ks(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?ks(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),f0=ir(u0),h0=X({},Os,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gc=ir(h0),d0=X({},Dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gi}),p0=ir(d0),g0=X({},Fa,{propertyName:0,elapsedTime:0,pseudoElement:0}),_0=ir(g0),m0=X({},Os,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),x0=ir(m0),v0=X({},Fa,{newState:0,oldState:0}),y0=ir(v0),E0=[9,13,27,32],qi=rr&&"CompositionEvent"in window,Mn=null;rr&&"documentMode"in document&&(Mn=document.documentMode);var S0=rr&&"TextEvent"in window&&!Mn,_c=rr&&(!qi||Mn&&8<Mn&&11>=Mn),mc=" ",xc=!1;function vc(a,s){switch(a){case"keyup":return E0.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yc(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Za=!1;function A0(a,s){switch(a){case"compositionend":return yc(s);case"keypress":return s.which!==32?null:(xc=!0,mc);case"textInput":return a=s.data,a===mc&&xc?null:a;default:return null}}function b0(a,s){if(Za)return a==="compositionend"||!qi&&vc(a,s)?(a=fc(),Cs=Hi=la=null,Za=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return _c&&s.locale!=="ko"?null:s.data;default:return null}}var T0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ec(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s==="input"?!!T0[a.type]:s==="textarea"}function Sc(a,s,o,u){Ja?Qa?Qa.push(u):Qa=[u]:Ja=u,s=pi(s,"onChange"),0<s.length&&(o=new Fs("onChange","change",null,o,u),a.push({event:o,listeners:s}))}var Ln=null,Nn=null;function w0(a){Yf(a,0)}function Ds(a){var s=Ke(a);if(ac(s))return a}function Ac(a,s){if(a==="change")return s}var bc=!1;if(rr){var $i;if(rr){var Wi="oninput"in document;if(!Wi){var Tc=document.createElement("div");Tc.setAttribute("oninput","return;"),Wi=typeof Tc.oninput=="function"}$i=Wi}else $i=!1;bc=$i&&(!document.documentMode||9<document.documentMode)}function wc(){Ln&&(Ln.detachEvent("onpropertychange",Cc),Nn=Ln=null)}function Cc(a){if(a.propertyName==="value"&&Ds(Nn)){var s=[];Sc(s,Nn,a,Bi(a)),uc(w0,s)}}function C0(a,s,o){a==="focusin"?(wc(),Ln=s,Nn=o,Ln.attachEvent("onpropertychange",Cc)):a==="focusout"&&wc()}function k0(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Ds(Nn)}function R0(a,s){if(a==="click")return Ds(s)}function F0(a,s){if(a==="input"||a==="change")return Ds(s)}function O0(a,s){return a===s&&(a!==0||1/a===1/s)||a!==a&&s!==s}var cr=typeof Object.is=="function"?Object.is:O0;function In(a,s){if(cr(a,s))return!0;if(typeof a!="object"||a===null||typeof s!="object"||s===null)return!1;var o=Object.keys(a),u=Object.keys(s);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var _=o[u];if(!ge.call(s,_)||!cr(a[_],s[_]))return!1}return!0}function kc(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Rc(a,s){var o=kc(a);a=0;for(var u;o;){if(o.nodeType===3){if(u=a+o.textContent.length,a<=s&&u>=s)return{node:o,offset:s-a};a=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=kc(o)}}function Fc(a,s){return a&&s?a===s?!0:a&&a.nodeType===3?!1:s&&s.nodeType===3?Fc(a,s.parentNode):"contains"in a?a.contains(s):a.compareDocumentPosition?!!(a.compareDocumentPosition(s)&16):!1:!1}function Oc(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var s=Ts(a.document);s instanceof a.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)a=s.contentWindow;else break;s=Ts(a.document)}return s}function Yi(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s&&(s==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||s==="textarea"||a.contentEditable==="true")}function D0(a,s){var o=Oc(s);s=a.focusedElem;var u=a.selectionRange;if(o!==s&&s&&s.ownerDocument&&Fc(s.ownerDocument.documentElement,s)){if(u!==null&&Yi(s)){if(a=u.start,o=u.end,o===void 0&&(o=a),"selectionStart"in s)s.selectionStart=a,s.selectionEnd=Math.min(o,s.value.length);else if(o=(a=s.ownerDocument||document)&&a.defaultView||window,o.getSelection){o=o.getSelection();var _=s.textContent.length,A=Math.min(u.start,_);u=u.end===void 0?A:Math.min(u.end,_),!o.extend&&A>u&&(_=u,u=A,A=_),_=Rc(s,A);var j=Rc(s,u);_&&j&&(o.rangeCount!==1||o.anchorNode!==_.node||o.anchorOffset!==_.offset||o.focusNode!==j.node||o.focusOffset!==j.offset)&&(a=a.createRange(),a.setStart(_.node,_.offset),o.removeAllRanges(),A>u?(o.addRange(a),o.extend(j.node,j.offset)):(a.setEnd(j.node,j.offset),o.addRange(a)))}}for(a=[],o=s;o=o.parentNode;)o.nodeType===1&&a.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<a.length;s++)o=a[s],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var P0=rr&&"documentMode"in document&&11>=document.documentMode,en=null,Ki=null,Bn=null,Ji=!1;function Dc(a,s,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Ji||en==null||en!==Ts(u)||(u=en,"selectionStart"in u&&Yi(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Bn&&In(Bn,u)||(Bn=u,u=pi(Ki,"onSelect"),0<u.length&&(s=new Fs("onSelect","select",null,s,o),a.push({event:s,listeners:u}),s.target=en)))}function Oa(a,s){var o={};return o[a.toLowerCase()]=s.toLowerCase(),o["Webkit"+a]="webkit"+s,o["Moz"+a]="moz"+s,o}var tn={animationend:Oa("Animation","AnimationEnd"),animationiteration:Oa("Animation","AnimationIteration"),animationstart:Oa("Animation","AnimationStart"),transitionrun:Oa("Transition","TransitionRun"),transitionstart:Oa("Transition","TransitionStart"),transitioncancel:Oa("Transition","TransitionCancel"),transitionend:Oa("Transition","TransitionEnd")},Qi={},Pc={};rr&&(Pc=document.createElement("div").style,"AnimationEvent"in window||(delete tn.animationend.animation,delete tn.animationiteration.animation,delete tn.animationstart.animation),"TransitionEvent"in window||delete tn.transitionend.transition);function Da(a){if(Qi[a])return Qi[a];if(!tn[a])return a;var s=tn[a],o;for(o in s)if(s.hasOwnProperty(o)&&o in Pc)return Qi[a]=s[o];return a}var Mc=Da("animationend"),Lc=Da("animationiteration"),Nc=Da("animationstart"),M0=Da("transitionrun"),L0=Da("transitionstart"),N0=Da("transitioncancel"),Ic=Da("transitionend"),Bc=new Map,Uc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Rr(a,s){Bc.set(a,s),At(s,[a])}var vr=[],rn=0,Zi=0;function Ps(){for(var a=rn,s=Zi=rn=0;s<a;){var o=vr[s];vr[s++]=null;var u=vr[s];vr[s++]=null;var _=vr[s];vr[s++]=null;var A=vr[s];if(vr[s++]=null,u!==null&&_!==null){var j=u.pending;j===null?_.next=_:(_.next=j.next,j.next=_),u.pending=_}A!==0&&jc(o,_,A)}}function Ms(a,s,o,u){vr[rn++]=a,vr[rn++]=s,vr[rn++]=o,vr[rn++]=u,Zi|=u,a.lanes|=u,a=a.alternate,a!==null&&(a.lanes|=u)}function eo(a,s,o,u){return Ms(a,s,o,u),Ls(a)}function ca(a,s){return Ms(a,null,null,s),Ls(a)}function jc(a,s,o){a.lanes|=o;var u=a.alternate;u!==null&&(u.lanes|=o);for(var _=!1,A=a.return;A!==null;)A.childLanes|=o,u=A.alternate,u!==null&&(u.childLanes|=o),A.tag===22&&(a=A.stateNode,a===null||a._visibility&1||(_=!0)),a=A,A=A.return;_&&s!==null&&a.tag===3&&(A=a.stateNode,_=31-Mt(o),A=A.hiddenUpdates,a=A[_],a===null?A[_]=[s]:a.push(s),s.lane=o|536870912)}function Ls(a){if(50<cs)throw cs=0,ol=null,Error(n(185));for(var s=a.return;s!==null;)a=s,s=a.return;return a.tag===3?a.stateNode:null}var an={},Hc=new WeakMap;function yr(a,s){if(typeof a=="object"&&a!==null){var o=Hc.get(a);return o!==void 0?o:(s={value:a,source:s,stack:ie(s)},Hc.set(a,s),s)}return{value:a,source:s,stack:ie(s)}}var nn=[],sn=0,Ns=null,Is=0,Er=[],Sr=0,Pa=null,Xr=1,Gr="";function Ma(a,s){nn[sn++]=Is,nn[sn++]=Ns,Ns=a,Is=s}function zc(a,s,o){Er[Sr++]=Xr,Er[Sr++]=Gr,Er[Sr++]=Pa,Pa=a;var u=Xr;a=Gr;var _=32-Mt(u)-1;u&=~(1<<_),o+=1;var A=32-Mt(s)+_;if(30<A){var j=_-_%5;A=(u&(1<<j)-1).toString(32),u>>=j,_-=j,Xr=1<<32-Mt(s)+_|o<<_|u,Gr=A+a}else Xr=1<<A|o<<_|u,Gr=a}function to(a){a.return!==null&&(Ma(a,1),zc(a,1,0))}function ro(a){for(;a===Ns;)Ns=nn[--sn],nn[sn]=null,Is=nn[--sn],nn[sn]=null;for(;a===Pa;)Pa=Er[--Sr],Er[Sr]=null,Gr=Er[--Sr],Er[Sr]=null,Xr=Er[--Sr],Er[Sr]=null}var ar=null,Kt=null,Et=!1,Fr=null,Lr=!1,ao=Error(n(519));function La(a){var s=Error(n(418,""));throw Hn(yr(s,a)),ao}function Vc(a){var s=a.stateNode,o=a.type,u=a.memoizedProps;switch(s[te]=a,s[ne]=u,o){case"dialog":xt("cancel",s),xt("close",s);break;case"iframe":case"object":case"embed":xt("load",s);break;case"video":case"audio":for(o=0;o<fs.length;o++)xt(fs[o],s);break;case"source":xt("error",s);break;case"img":case"image":case"link":xt("error",s),xt("load",s);break;case"details":xt("toggle",s);break;case"input":xt("invalid",s),nc(s,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),bs(s);break;case"select":xt("invalid",s);break;case"textarea":xt("invalid",s),ic(s,u.value,u.defaultValue,u.children),bs(s)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||u.suppressHydrationWarning===!0||Zf(s.textContent,o)?(u.popover!=null&&(xt("beforetoggle",s),xt("toggle",s)),u.onScroll!=null&&xt("scroll",s),u.onScrollEnd!=null&&xt("scrollend",s),u.onClick!=null&&(s.onclick=gi),s=!0):s=!1,s||La(a)}function Xc(a){for(ar=a.return;ar;)switch(ar.tag){case 3:case 27:Lr=!0;return;case 5:case 13:Lr=!1;return;default:ar=ar.return}}function Un(a){if(a!==ar)return!1;if(!Et)return Xc(a),Et=!0,!1;var s=!1,o;if((o=a.tag!==3&&a.tag!==27)&&((o=a.tag===5)&&(o=a.type,o=!(o!=="form"&&o!=="button")||bl(a.type,a.memoizedProps)),o=!o),o&&(s=!0),s&&Kt&&La(a),Xc(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));e:{for(a=a.nextSibling,s=0;a;){if(a.nodeType===8)if(o=a.data,o==="/$"){if(s===0){Kt=Dr(a.nextSibling);break e}s--}else o!=="$"&&o!=="$!"&&o!=="$?"||s++;a=a.nextSibling}Kt=null}}else Kt=ar?Dr(a.stateNode.nextSibling):null;return!0}function jn(){Kt=ar=null,Et=!1}function Hn(a){Fr===null?Fr=[a]:Fr.push(a)}var zn=Error(n(460)),Gc=Error(n(474)),no={then:function(){}};function qc(a){return a=a.status,a==="fulfilled"||a==="rejected"}function Bs(){}function $c(a,s,o){switch(o=a[o],o===void 0?a.push(s):o!==s&&(s.then(Bs,Bs),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,a===zn?Error(n(483)):a;default:if(typeof s.status=="string")s.then(Bs,Bs);else{if(a=kt,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=s,a.status="pending",a.then(function(u){if(s.status==="pending"){var _=s;_.status="fulfilled",_.value=u}},function(u){if(s.status==="pending"){var _=s;_.status="rejected",_.reason=u}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,a===zn?Error(n(483)):a}throw Vn=s,zn}}var Vn=null;function Wc(){if(Vn===null)throw Error(n(459));var a=Vn;return Vn=null,a}var on=null,Xn=0;function Us(a){var s=Xn;return Xn+=1,on===null&&(on=[]),$c(on,a,s)}function Gn(a,s){s=s.props.ref,a.ref=s!==void 0?s:null}function js(a,s){throw s.$$typeof===l?Error(n(525)):(a=Object.prototype.toString.call(s),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":a)))}function Yc(a){var s=a._init;return s(a._payload)}function Kc(a){function s(Te,ve){if(a){var ke=Te.deletions;ke===null?(Te.deletions=[ve],Te.flags|=16):ke.push(ve)}}function o(Te,ve){if(!a)return null;for(;ve!==null;)s(Te,ve),ve=ve.sibling;return null}function u(Te){for(var ve=new Map;Te!==null;)Te.key!==null?ve.set(Te.key,Te):ve.set(Te.index,Te),Te=Te.sibling;return ve}function _(Te,ve){return Te=Ea(Te,ve),Te.index=0,Te.sibling=null,Te}function A(Te,ve,ke){return Te.index=ke,a?(ke=Te.alternate,ke!==null?(ke=ke.index,ke<ve?(Te.flags|=33554434,ve):ke):(Te.flags|=33554434,ve)):(Te.flags|=1048576,ve)}function j(Te){return a&&Te.alternate===null&&(Te.flags|=33554434),Te}function ee(Te,ve,ke,Ue){return ve===null||ve.tag!==6?(ve=Zo(ke,Te.mode,Ue),ve.return=Te,ve):(ve=_(ve,ke),ve.return=Te,ve)}function pe(Te,ve,ke,Ue){var Ze=ke.type;return Ze===d?Be(Te,ve,ke.props.children,Ue,ke.key):ve!==null&&(ve.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===D&&Yc(Ze)===ve.type)?(ve=_(ve,ke.props),Gn(ve,ke),ve.return=Te,ve):(ve=ni(ke.type,ke.key,ke.props,null,Te.mode,Ue),Gn(ve,ke),ve.return=Te,ve)}function Ee(Te,ve,ke,Ue){return ve===null||ve.tag!==4||ve.stateNode.containerInfo!==ke.containerInfo||ve.stateNode.implementation!==ke.implementation?(ve=el(ke,Te.mode,Ue),ve.return=Te,ve):(ve=_(ve,ke.children||[]),ve.return=Te,ve)}function Be(Te,ve,ke,Ue,Ze){return ve===null||ve.tag!==7?(ve=Ga(ke,Te.mode,Ue,Ze),ve.return=Te,ve):(ve=_(ve,ke),ve.return=Te,ve)}function He(Te,ve,ke){if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return ve=Zo(""+ve,Te.mode,ke),ve.return=Te,ve;if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case c:return ke=ni(ve.type,ve.key,ve.props,null,Te.mode,ke),Gn(ke,ve),ke.return=Te,ke;case f:return ve=el(ve,Te.mode,ke),ve.return=Te,ve;case D:var Ue=ve._init;return ve=Ue(ve._payload),He(Te,ve,ke)}if(M(ve)||w(ve))return ve=Ga(ve,Te.mode,ke,null),ve.return=Te,ve;if(typeof ve.then=="function")return He(Te,Us(ve),ke);if(ve.$$typeof===S)return He(Te,ti(Te,ve),ke);js(Te,ve)}return null}function Pe(Te,ve,ke,Ue){var Ze=ve!==null?ve.key:null;if(typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint")return Ze!==null?null:ee(Te,ve,""+ke,Ue);if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case c:return ke.key===Ze?pe(Te,ve,ke,Ue):null;case f:return ke.key===Ze?Ee(Te,ve,ke,Ue):null;case D:return Ze=ke._init,ke=Ze(ke._payload),Pe(Te,ve,ke,Ue)}if(M(ke)||w(ke))return Ze!==null?null:Be(Te,ve,ke,Ue,null);if(typeof ke.then=="function")return Pe(Te,ve,Us(ke),Ue);if(ke.$$typeof===S)return Pe(Te,ve,ti(Te,ke),Ue);js(Te,ke)}return null}function Ne(Te,ve,ke,Ue,Ze){if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number"||typeof Ue=="bigint")return Te=Te.get(ke)||null,ee(ve,Te,""+Ue,Ze);if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case c:return Te=Te.get(Ue.key===null?ke:Ue.key)||null,pe(ve,Te,Ue,Ze);case f:return Te=Te.get(Ue.key===null?ke:Ue.key)||null,Ee(ve,Te,Ue,Ze);case D:var _t=Ue._init;return Ue=_t(Ue._payload),Ne(Te,ve,ke,Ue,Ze)}if(M(Ue)||w(Ue))return Te=Te.get(ke)||null,Be(ve,Te,Ue,Ze,null);if(typeof Ue.then=="function")return Ne(Te,ve,ke,Us(Ue),Ze);if(Ue.$$typeof===S)return Ne(Te,ve,ke,ti(ve,Ue),Ze);js(ve,Ue)}return null}function rt(Te,ve,ke,Ue){for(var Ze=null,_t=null,at=ve,ot=ve=0,Wt=null;at!==null&&ot<ke.length;ot++){at.index>ot?(Wt=at,at=null):Wt=at.sibling;var St=Pe(Te,at,ke[ot],Ue);if(St===null){at===null&&(at=Wt);break}a&&at&&St.alternate===null&&s(Te,at),ve=A(St,ve,ot),_t===null?Ze=St:_t.sibling=St,_t=St,at=Wt}if(ot===ke.length)return o(Te,at),Et&&Ma(Te,ot),Ze;if(at===null){for(;ot<ke.length;ot++)at=He(Te,ke[ot],Ue),at!==null&&(ve=A(at,ve,ot),_t===null?Ze=at:_t.sibling=at,_t=at);return Et&&Ma(Te,ot),Ze}for(at=u(at);ot<ke.length;ot++)Wt=Ne(at,Te,ot,ke[ot],Ue),Wt!==null&&(a&&Wt.alternate!==null&&at.delete(Wt.key===null?ot:Wt.key),ve=A(Wt,ve,ot),_t===null?Ze=Wt:_t.sibling=Wt,_t=Wt);return a&&at.forEach(function(ka){return s(Te,ka)}),Et&&Ma(Te,ot),Ze}function ft(Te,ve,ke,Ue){if(ke==null)throw Error(n(151));for(var Ze=null,_t=null,at=ve,ot=ve=0,Wt=null,St=ke.next();at!==null&&!St.done;ot++,St=ke.next()){at.index>ot?(Wt=at,at=null):Wt=at.sibling;var ka=Pe(Te,at,St.value,Ue);if(ka===null){at===null&&(at=Wt);break}a&&at&&ka.alternate===null&&s(Te,at),ve=A(ka,ve,ot),_t===null?Ze=ka:_t.sibling=ka,_t=ka,at=Wt}if(St.done)return o(Te,at),Et&&Ma(Te,ot),Ze;if(at===null){for(;!St.done;ot++,St=ke.next())St=He(Te,St.value,Ue),St!==null&&(ve=A(St,ve,ot),_t===null?Ze=St:_t.sibling=St,_t=St);return Et&&Ma(Te,ot),Ze}for(at=u(at);!St.done;ot++,St=ke.next())St=Ne(at,Te,ot,St.value,Ue),St!==null&&(a&&St.alternate!==null&&at.delete(St.key===null?ot:St.key),ve=A(St,ve,ot),_t===null?Ze=St:_t.sibling=St,_t=St);return a&&at.forEach(function(Kd){return s(Te,Kd)}),Et&&Ma(Te,ot),Ze}function It(Te,ve,ke,Ue){if(typeof ke=="object"&&ke!==null&&ke.type===d&&ke.key===null&&(ke=ke.props.children),typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case c:e:{for(var Ze=ke.key;ve!==null;){if(ve.key===Ze){if(Ze=ke.type,Ze===d){if(ve.tag===7){o(Te,ve.sibling),Ue=_(ve,ke.props.children),Ue.return=Te,Te=Ue;break e}}else if(ve.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===D&&Yc(Ze)===ve.type){o(Te,ve.sibling),Ue=_(ve,ke.props),Gn(Ue,ke),Ue.return=Te,Te=Ue;break e}o(Te,ve);break}else s(Te,ve);ve=ve.sibling}ke.type===d?(Ue=Ga(ke.props.children,Te.mode,Ue,ke.key),Ue.return=Te,Te=Ue):(Ue=ni(ke.type,ke.key,ke.props,null,Te.mode,Ue),Gn(Ue,ke),Ue.return=Te,Te=Ue)}return j(Te);case f:e:{for(Ze=ke.key;ve!==null;){if(ve.key===Ze)if(ve.tag===4&&ve.stateNode.containerInfo===ke.containerInfo&&ve.stateNode.implementation===ke.implementation){o(Te,ve.sibling),Ue=_(ve,ke.children||[]),Ue.return=Te,Te=Ue;break e}else{o(Te,ve);break}else s(Te,ve);ve=ve.sibling}Ue=el(ke,Te.mode,Ue),Ue.return=Te,Te=Ue}return j(Te);case D:return Ze=ke._init,ke=Ze(ke._payload),It(Te,ve,ke,Ue)}if(M(ke))return rt(Te,ve,ke,Ue);if(w(ke)){if(Ze=w(ke),typeof Ze!="function")throw Error(n(150));return ke=Ze.call(ke),ft(Te,ve,ke,Ue)}if(typeof ke.then=="function")return It(Te,ve,Us(ke),Ue);if(ke.$$typeof===S)return It(Te,ve,ti(Te,ke),Ue);js(Te,ke)}return typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint"?(ke=""+ke,ve!==null&&ve.tag===6?(o(Te,ve.sibling),Ue=_(ve,ke),Ue.return=Te,Te=Ue):(o(Te,ve),Ue=Zo(ke,Te.mode,Ue),Ue.return=Te,Te=Ue),j(Te)):o(Te,ve)}return function(Te,ve,ke,Ue){try{Xn=0;var Ze=It(Te,ve,ke,Ue);return on=null,Ze}catch(at){if(at===zn)throw at;var _t=wr(29,at,null,Te.mode);return _t.lanes=Ue,_t.return=Te,_t}finally{}}}var Na=Kc(!0),Jc=Kc(!1),ln=J(null),Hs=J(0);function Qc(a,s){a=ra,B(Hs,a),B(ln,s),ra=a|s.baseLanes}function so(){B(Hs,ra),B(ln,ln.current)}function io(){ra=Hs.current,O(ln),O(Hs)}var Ar=J(null),Nr=null;function ua(a){var s=a.alternate;B(Xt,Xt.current&1),B(Ar,a),Nr===null&&(s===null||ln.current!==null||s.memoizedState!==null)&&(Nr=a)}function Zc(a){if(a.tag===22){if(B(Xt,Xt.current),B(Ar,a),Nr===null){var s=a.alternate;s!==null&&s.memoizedState!==null&&(Nr=a)}}else fa()}function fa(){B(Xt,Xt.current),B(Ar,Ar.current)}function qr(a){O(Ar),Nr===a&&(Nr=null),O(Xt)}var Xt=J(0);function zs(a){for(var s=a;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||o.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var I0=typeof AbortController<"u"?AbortController:function(){var a=[],s=this.signal={aborted:!1,addEventListener:function(o,u){a.push(u)}};this.abort=function(){s.aborted=!0,a.forEach(function(o){return o()})}},B0=e.unstable_scheduleCallback,U0=e.unstable_NormalPriority,Gt={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function oo(){return{controller:new I0,data:new Map,refCount:0}}function qn(a){a.refCount--,a.refCount===0&&B0(U0,function(){a.controller.abort()})}var $n=null,lo=0,cn=0,un=null;function j0(a,s){if($n===null){var o=$n=[];lo=0,cn=gl(),un={status:"pending",value:void 0,then:function(u){o.push(u)}}}return lo++,s.then(eu,eu),s}function eu(){if(--lo===0&&$n!==null){un!==null&&(un.status="fulfilled");var a=$n;$n=null,cn=0,un=null;for(var s=0;s<a.length;s++)(0,a[s])()}}function H0(a,s){var o=[],u={status:"pending",value:null,reason:null,then:function(_){o.push(_)}};return a.then(function(){u.status="fulfilled",u.value=s;for(var _=0;_<o.length;_++)(0,o[_])(s)},function(_){for(u.status="rejected",u.reason=_,_=0;_<o.length;_++)(0,o[_])(void 0)}),u}var tu=L.S;L.S=function(a,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&j0(a,s),tu!==null&&tu(a,s)};var Ia=J(null);function co(){var a=Ia.current;return a!==null?a:kt.pooledCache}function Vs(a,s){s===null?B(Ia,Ia.current):B(Ia,s.pool)}function ru(){var a=co();return a===null?null:{parent:Gt._currentValue,pool:a}}var ha=0,dt=null,bt=null,jt=null,Xs=!1,fn=!1,Ba=!1,Gs=0,Wn=0,hn=null,z0=0;function Bt(){throw Error(n(321))}function uo(a,s){if(s===null)return!1;for(var o=0;o<s.length&&o<a.length;o++)if(!cr(a[o],s[o]))return!1;return!0}function fo(a,s,o,u,_,A){return ha=A,dt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,L.H=a===null||a.memoizedState===null?Ua:da,Ba=!1,A=o(u,_),Ba=!1,fn&&(A=nu(s,o,u,_)),au(a),A}function au(a){L.H=Ir;var s=bt!==null&&bt.next!==null;if(ha=0,jt=bt=dt=null,Xs=!1,Wn=0,hn=null,s)throw Error(n(300));a===null||qt||(a=a.dependencies,a!==null&&ei(a)&&(qt=!0))}function nu(a,s,o,u){dt=a;var _=0;do{if(fn&&(hn=null),Wn=0,fn=!1,25<=_)throw Error(n(301));if(_+=1,jt=bt=null,a.updateQueue!=null){var A=a.updateQueue;A.lastEffect=null,A.events=null,A.stores=null,A.memoCache!=null&&(A.memoCache.index=0)}L.H=ja,A=s(o,u)}while(fn);return A}function V0(){var a=L.H,s=a.useState()[0];return s=typeof s.then=="function"?Yn(s):s,a=a.useState()[0],(bt!==null?bt.memoizedState:null)!==a&&(dt.flags|=1024),s}function ho(){var a=Gs!==0;return Gs=0,a}function po(a,s,o){s.updateQueue=a.updateQueue,s.flags&=-2053,a.lanes&=~o}function go(a){if(Xs){for(a=a.memoizedState;a!==null;){var s=a.queue;s!==null&&(s.pending=null),a=a.next}Xs=!1}ha=0,jt=bt=dt=null,fn=!1,Wn=Gs=0,hn=null}function or(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jt===null?dt.memoizedState=jt=a:jt=jt.next=a,jt}function Ht(){if(bt===null){var a=dt.alternate;a=a!==null?a.memoizedState:null}else a=bt.next;var s=jt===null?dt.memoizedState:jt.next;if(s!==null)jt=s,bt=a;else{if(a===null)throw dt.alternate===null?Error(n(467)):Error(n(310));bt=a,a={memoizedState:bt.memoizedState,baseState:bt.baseState,baseQueue:bt.baseQueue,queue:bt.queue,next:null},jt===null?dt.memoizedState=jt=a:jt=jt.next=a}return jt}var qs;qs=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Yn(a){var s=Wn;return Wn+=1,hn===null&&(hn=[]),a=$c(hn,a,s),s=dt,(jt===null?s.memoizedState:jt.next)===null&&(s=s.alternate,L.H=s===null||s.memoizedState===null?Ua:da),a}function $s(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Yn(a);if(a.$$typeof===S)return tr(a)}throw Error(n(438,String(a)))}function _o(a){var s=null,o=dt.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var u=dt.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(s={data:u.data.map(function(_){return _.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=qs(),dt.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(a),u=0;u<a;u++)o[u]=F;return s.index++,o}function $r(a,s){return typeof s=="function"?s(a):s}function Ws(a){var s=Ht();return mo(s,bt,a)}function mo(a,s,o){var u=a.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=o;var _=a.baseQueue,A=u.pending;if(A!==null){if(_!==null){var j=_.next;_.next=A.next,A.next=j}s.baseQueue=_=A,u.pending=null}if(A=a.baseState,_===null)a.memoizedState=A;else{s=_.next;var ee=j=null,pe=null,Ee=s,Be=!1;do{var He=Ee.lane&-536870913;if(He!==Ee.lane?(vt&He)===He:(ha&He)===He){var Pe=Ee.revertLane;if(Pe===0)pe!==null&&(pe=pe.next={lane:0,revertLane:0,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null}),He===cn&&(Be=!0);else if((ha&Pe)===Pe){Ee=Ee.next,Pe===cn&&(Be=!0);continue}else He={lane:0,revertLane:Ee.revertLane,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null},pe===null?(ee=pe=He,j=A):pe=pe.next=He,dt.lanes|=Pe,Sa|=Pe;He=Ee.action,Ba&&o(A,He),A=Ee.hasEagerState?Ee.eagerState:o(A,He)}else Pe={lane:He,revertLane:Ee.revertLane,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null},pe===null?(ee=pe=Pe,j=A):pe=pe.next=Pe,dt.lanes|=He,Sa|=He;Ee=Ee.next}while(Ee!==null&&Ee!==s);if(pe===null?j=A:pe.next=ee,!cr(A,a.memoizedState)&&(qt=!0,Be&&(o=un,o!==null)))throw o;a.memoizedState=A,a.baseState=j,a.baseQueue=pe,u.lastRenderedState=A}return _===null&&(u.lanes=0),[a.memoizedState,u.dispatch]}function xo(a){var s=Ht(),o=s.queue;if(o===null)throw Error(n(311));o.lastRenderedReducer=a;var u=o.dispatch,_=o.pending,A=s.memoizedState;if(_!==null){o.pending=null;var j=_=_.next;do A=a(A,j.action),j=j.next;while(j!==_);cr(A,s.memoizedState)||(qt=!0),s.memoizedState=A,s.baseQueue===null&&(s.baseState=A),o.lastRenderedState=A}return[A,u]}function su(a,s,o){var u=dt,_=Ht(),A=Et;if(A){if(o===void 0)throw Error(n(407));o=o()}else o=s();var j=!cr((bt||_).memoizedState,o);if(j&&(_.memoizedState=o,qt=!0),_=_.queue,Eo(lu.bind(null,u,_,a),[a]),_.getSnapshot!==s||j||jt!==null&&jt.memoizedState.tag&1){if(u.flags|=2048,dn(9,ou.bind(null,u,_,o,s),{destroy:void 0},null),kt===null)throw Error(n(349));A||ha&60||iu(u,s,o)}return o}function iu(a,s,o){a.flags|=16384,a={getSnapshot:s,value:o},s=dt.updateQueue,s===null?(s=qs(),dt.updateQueue=s,s.stores=[a]):(o=s.stores,o===null?s.stores=[a]:o.push(a))}function ou(a,s,o,u){s.value=o,s.getSnapshot=u,cu(s)&&uu(a)}function lu(a,s,o){return o(function(){cu(s)&&uu(a)})}function cu(a){var s=a.getSnapshot;a=a.value;try{var o=s();return!cr(a,o)}catch{return!0}}function uu(a){var s=ca(a,2);s!==null&&nr(s,a,2)}function vo(a){var s=or();if(typeof a=="function"){var o=a;if(a=o(),Ba){Yt(!0);try{o()}finally{Yt(!1)}}}return s.memoizedState=s.baseState=a,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$r,lastRenderedState:a},s}function fu(a,s,o,u){return a.baseState=o,mo(a,bt,typeof u=="function"?u:$r)}function X0(a,s,o,u,_){if(Js(a))throw Error(n(485));if(a=s.action,a!==null){var A={payload:_,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(j){A.listeners.push(j)}};L.T!==null?o(!0):A.isTransition=!1,u(A),o=s.pending,o===null?(A.next=s.pending=A,hu(s,A)):(A.next=o.next,s.pending=o.next=A)}}function hu(a,s){var o=s.action,u=s.payload,_=a.state;if(s.isTransition){var A=L.T,j={};L.T=j;try{var ee=o(_,u),pe=L.S;pe!==null&&pe(j,ee),du(a,s,ee)}catch(Ee){yo(a,s,Ee)}finally{L.T=A}}else try{A=o(_,u),du(a,s,A)}catch(Ee){yo(a,s,Ee)}}function du(a,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){pu(a,s,u)},function(u){return yo(a,s,u)}):pu(a,s,o)}function pu(a,s,o){s.status="fulfilled",s.value=o,gu(s),a.state=o,s=a.pending,s!==null&&(o=s.next,o===s?a.pending=null:(o=o.next,s.next=o,hu(a,o)))}function yo(a,s,o){var u=a.pending;if(a.pending=null,u!==null){u=u.next;do s.status="rejected",s.reason=o,gu(s),s=s.next;while(s!==u)}a.action=null}function gu(a){a=a.listeners;for(var s=0;s<a.length;s++)(0,a[s])()}function _u(a,s){return s}function mu(a,s){if(Et){var o=kt.formState;if(o!==null){e:{var u=dt;if(Et){if(Kt){t:{for(var _=Kt,A=Lr;_.nodeType!==8;){if(!A){_=null;break t}if(_=Dr(_.nextSibling),_===null){_=null;break t}}A=_.data,_=A==="F!"||A==="F"?_:null}if(_){Kt=Dr(_.nextSibling),u=_.data==="F!";break e}}La(u)}u=!1}u&&(s=o[0])}}return o=or(),o.memoizedState=o.baseState=s,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_u,lastRenderedState:s},o.queue=u,o=Lu.bind(null,dt,u),u.dispatch=o,u=vo(!1),A=wo.bind(null,dt,!1,u.queue),u=or(),_={state:s,dispatch:null,action:a,pending:null},u.queue=_,o=X0.bind(null,dt,_,A,o),_.dispatch=o,u.memoizedState=a,[s,o,!1]}function xu(a){var s=Ht();return vu(s,bt,a)}function vu(a,s,o){s=mo(a,s,_u)[0],a=Ws($r)[0],s=typeof s=="object"&&s!==null&&typeof s.then=="function"?Yn(s):s;var u=Ht(),_=u.queue,A=_.dispatch;return o!==u.memoizedState&&(dt.flags|=2048,dn(9,G0.bind(null,_,o),{destroy:void 0},null)),[s,A,a]}function G0(a,s){a.action=s}function yu(a){var s=Ht(),o=bt;if(o!==null)return vu(s,o,a);Ht(),s=s.memoizedState,o=Ht();var u=o.queue.dispatch;return o.memoizedState=a,[s,u,!1]}function dn(a,s,o,u){return a={tag:a,create:s,inst:o,deps:u,next:null},s=dt.updateQueue,s===null&&(s=qs(),dt.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=a.next=a:(u=o.next,o.next=a,a.next=u,s.lastEffect=a),a}function Eu(){return Ht().memoizedState}function Ys(a,s,o,u){var _=or();dt.flags|=a,_.memoizedState=dn(1|s,o,{destroy:void 0},u===void 0?null:u)}function Ks(a,s,o,u){var _=Ht();u=u===void 0?null:u;var A=_.memoizedState.inst;bt!==null&&u!==null&&uo(u,bt.memoizedState.deps)?_.memoizedState=dn(s,o,A,u):(dt.flags|=a,_.memoizedState=dn(1|s,o,A,u))}function Su(a,s){Ys(8390656,8,a,s)}function Eo(a,s){Ks(2048,8,a,s)}function Au(a,s){return Ks(4,2,a,s)}function bu(a,s){return Ks(4,4,a,s)}function Tu(a,s){if(typeof s=="function"){a=a();var o=s(a);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return a=a(),s.current=a,function(){s.current=null}}function wu(a,s,o){o=o!=null?o.concat([a]):null,Ks(4,4,Tu.bind(null,s,a),o)}function So(){}function Cu(a,s){var o=Ht();s=s===void 0?null:s;var u=o.memoizedState;return s!==null&&uo(s,u[1])?u[0]:(o.memoizedState=[a,s],a)}function ku(a,s){var o=Ht();s=s===void 0?null:s;var u=o.memoizedState;if(s!==null&&uo(s,u[1]))return u[0];if(u=a(),Ba){Yt(!0);try{a()}finally{Yt(!1)}}return o.memoizedState=[u,s],u}function Ao(a,s,o){return o===void 0||ha&1073741824?a.memoizedState=s:(a.memoizedState=o,a=Of(),dt.lanes|=a,Sa|=a,o)}function Ru(a,s,o,u){return cr(o,s)?o:ln.current!==null?(a=Ao(a,o,u),cr(a,s)||(qt=!0),a):ha&42?(a=Of(),dt.lanes|=a,Sa|=a,s):(qt=!0,a.memoizedState=o)}function Fu(a,s,o,u,_){var A=R.p;R.p=A!==0&&8>A?A:8;var j=L.T,ee={};L.T=ee,wo(a,!1,s,o);try{var pe=_(),Ee=L.S;if(Ee!==null&&Ee(ee,pe),pe!==null&&typeof pe=="object"&&typeof pe.then=="function"){var Be=H0(pe,u);Kn(a,s,Be,dr(a))}else Kn(a,s,u,dr(a))}catch(He){Kn(a,s,{then:function(){},status:"rejected",reason:He},dr())}finally{R.p=A,L.T=j}}function q0(){}function bo(a,s,o,u){if(a.tag!==5)throw Error(n(476));var _=Ou(a).queue;Fu(a,_,s,U,o===null?q0:function(){return Du(a),o(u)})}function Ou(a){var s=a.memoizedState;if(s!==null)return s;s={memoizedState:U,baseState:U,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:$r,lastRenderedState:U},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:$r,lastRenderedState:o},next:null},a.memoizedState=s,a=a.alternate,a!==null&&(a.memoizedState=s),s}function Du(a){var s=Ou(a).next.queue;Kn(a,s,{},dr())}function To(){return tr(_s)}function Pu(){return Ht().memoizedState}function Mu(){return Ht().memoizedState}function $0(a){for(var s=a.return;s!==null;){switch(s.tag){case 24:case 3:var o=dr();a=_a(o);var u=ma(s,a,o);u!==null&&(nr(u,s,o),Zn(u,s,o)),s={cache:oo()},a.payload=s;return}s=s.return}}function W0(a,s,o){var u=dr();o={lane:u,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null},Js(a)?Nu(s,o):(o=eo(a,s,o,u),o!==null&&(nr(o,a,u),Iu(o,s,u)))}function Lu(a,s,o){var u=dr();Kn(a,s,o,u)}function Kn(a,s,o,u){var _={lane:u,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null};if(Js(a))Nu(s,_);else{var A=a.alternate;if(a.lanes===0&&(A===null||A.lanes===0)&&(A=s.lastRenderedReducer,A!==null))try{var j=s.lastRenderedState,ee=A(j,o);if(_.hasEagerState=!0,_.eagerState=ee,cr(ee,j))return Ms(a,s,_,0),kt===null&&Ps(),!1}catch{}finally{}if(o=eo(a,s,_,u),o!==null)return nr(o,a,u),Iu(o,s,u),!0}return!1}function wo(a,s,o,u){if(u={lane:2,revertLane:gl(),action:u,hasEagerState:!1,eagerState:null,next:null},Js(a)){if(s)throw Error(n(479))}else s=eo(a,o,u,2),s!==null&&nr(s,a,2)}function Js(a){var s=a.alternate;return a===dt||s!==null&&s===dt}function Nu(a,s){fn=Xs=!0;var o=a.pending;o===null?s.next=s:(s.next=o.next,o.next=s),a.pending=s}function Iu(a,s,o){if(o&4194176){var u=s.lanes;u&=a.pendingLanes,o|=u,s.lanes=o,Hr(a,o)}}var Ir={readContext:tr,use:$s,useCallback:Bt,useContext:Bt,useEffect:Bt,useImperativeHandle:Bt,useLayoutEffect:Bt,useInsertionEffect:Bt,useMemo:Bt,useReducer:Bt,useRef:Bt,useState:Bt,useDebugValue:Bt,useDeferredValue:Bt,useTransition:Bt,useSyncExternalStore:Bt,useId:Bt};Ir.useCacheRefresh=Bt,Ir.useMemoCache=Bt,Ir.useHostTransitionStatus=Bt,Ir.useFormState=Bt,Ir.useActionState=Bt,Ir.useOptimistic=Bt;var Ua={readContext:tr,use:$s,useCallback:function(a,s){return or().memoizedState=[a,s===void 0?null:s],a},useContext:tr,useEffect:Su,useImperativeHandle:function(a,s,o){o=o!=null?o.concat([a]):null,Ys(4194308,4,Tu.bind(null,s,a),o)},useLayoutEffect:function(a,s){return Ys(4194308,4,a,s)},useInsertionEffect:function(a,s){Ys(4,2,a,s)},useMemo:function(a,s){var o=or();s=s===void 0?null:s;var u=a();if(Ba){Yt(!0);try{a()}finally{Yt(!1)}}return o.memoizedState=[u,s],u},useReducer:function(a,s,o){var u=or();if(o!==void 0){var _=o(s);if(Ba){Yt(!0);try{o(s)}finally{Yt(!1)}}}else _=s;return u.memoizedState=u.baseState=_,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:_},u.queue=a,a=a.dispatch=W0.bind(null,dt,a),[u.memoizedState,a]},useRef:function(a){var s=or();return a={current:a},s.memoizedState=a},useState:function(a){a=vo(a);var s=a.queue,o=Lu.bind(null,dt,s);return s.dispatch=o,[a.memoizedState,o]},useDebugValue:So,useDeferredValue:function(a,s){var o=or();return Ao(o,a,s)},useTransition:function(){var a=vo(!1);return a=Fu.bind(null,dt,a.queue,!0,!1),or().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,s,o){var u=dt,_=or();if(Et){if(o===void 0)throw Error(n(407));o=o()}else{if(o=s(),kt===null)throw Error(n(349));vt&60||iu(u,s,o)}_.memoizedState=o;var A={value:o,getSnapshot:s};return _.queue=A,Su(lu.bind(null,u,A,a),[a]),u.flags|=2048,dn(9,ou.bind(null,u,A,o,s),{destroy:void 0},null),o},useId:function(){var a=or(),s=kt.identifierPrefix;if(Et){var o=Gr,u=Xr;o=(u&~(1<<32-Mt(u)-1)).toString(32)+o,s=":"+s+"R"+o,o=Gs++,0<o&&(s+="H"+o.toString(32)),s+=":"}else o=z0++,s=":"+s+"r"+o.toString(32)+":";return a.memoizedState=s},useCacheRefresh:function(){return or().memoizedState=$0.bind(null,dt)}};Ua.useMemoCache=_o,Ua.useHostTransitionStatus=To,Ua.useFormState=mu,Ua.useActionState=mu,Ua.useOptimistic=function(a){var s=or();s.memoizedState=s.baseState=a;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=wo.bind(null,dt,!0,o),o.dispatch=s,[a,s]};var da={readContext:tr,use:$s,useCallback:Cu,useContext:tr,useEffect:Eo,useImperativeHandle:wu,useInsertionEffect:Au,useLayoutEffect:bu,useMemo:ku,useReducer:Ws,useRef:Eu,useState:function(){return Ws($r)},useDebugValue:So,useDeferredValue:function(a,s){var o=Ht();return Ru(o,bt.memoizedState,a,s)},useTransition:function(){var a=Ws($r)[0],s=Ht().memoizedState;return[typeof a=="boolean"?a:Yn(a),s]},useSyncExternalStore:su,useId:Pu};da.useCacheRefresh=Mu,da.useMemoCache=_o,da.useHostTransitionStatus=To,da.useFormState=xu,da.useActionState=xu,da.useOptimistic=function(a,s){var o=Ht();return fu(o,bt,a,s)};var ja={readContext:tr,use:$s,useCallback:Cu,useContext:tr,useEffect:Eo,useImperativeHandle:wu,useInsertionEffect:Au,useLayoutEffect:bu,useMemo:ku,useReducer:xo,useRef:Eu,useState:function(){return xo($r)},useDebugValue:So,useDeferredValue:function(a,s){var o=Ht();return bt===null?Ao(o,a,s):Ru(o,bt.memoizedState,a,s)},useTransition:function(){var a=xo($r)[0],s=Ht().memoizedState;return[typeof a=="boolean"?a:Yn(a),s]},useSyncExternalStore:su,useId:Pu};ja.useCacheRefresh=Mu,ja.useMemoCache=_o,ja.useHostTransitionStatus=To,ja.useFormState=yu,ja.useActionState=yu,ja.useOptimistic=function(a,s){var o=Ht();return bt!==null?fu(o,bt,a,s):(o.baseState=a,[a,o.queue.dispatch])};function Co(a,s,o,u){s=a.memoizedState,o=o(u,s),o=o==null?s:X({},s,o),a.memoizedState=o,a.lanes===0&&(a.updateQueue.baseState=o)}var ko={isMounted:function(a){return(a=a._reactInternals)?fe(a)===a:!1},enqueueSetState:function(a,s,o){a=a._reactInternals;var u=dr(),_=_a(u);_.payload=s,o!=null&&(_.callback=o),s=ma(a,_,u),s!==null&&(nr(s,a,u),Zn(s,a,u))},enqueueReplaceState:function(a,s,o){a=a._reactInternals;var u=dr(),_=_a(u);_.tag=1,_.payload=s,o!=null&&(_.callback=o),s=ma(a,_,u),s!==null&&(nr(s,a,u),Zn(s,a,u))},enqueueForceUpdate:function(a,s){a=a._reactInternals;var o=dr(),u=_a(o);u.tag=2,s!=null&&(u.callback=s),s=ma(a,u,o),s!==null&&(nr(s,a,o),Zn(s,a,o))}};function Bu(a,s,o,u,_,A,j){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(u,A,j):s.prototype&&s.prototype.isPureReactComponent?!In(o,u)||!In(_,A):!0}function Uu(a,s,o,u){a=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,u),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,u),s.state!==a&&ko.enqueueReplaceState(s,s.state,null)}function Ha(a,s){var o=s;if("ref"in s){o={};for(var u in s)u!=="ref"&&(o[u]=s[u])}if(a=a.defaultProps){o===s&&(o=X({},o));for(var _ in a)o[_]===void 0&&(o[_]=a[_])}return o}var Qs=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function ju(a){Qs(a)}function Hu(a){console.error(a)}function zu(a){Qs(a)}function Zs(a,s){try{var o=a.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(u){setTimeout(function(){throw u})}}function Vu(a,s,o){try{var u=a.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(_){setTimeout(function(){throw _})}}function Ro(a,s,o){return o=_a(o),o.tag=3,o.payload={element:null},o.callback=function(){Zs(a,s)},o}function Xu(a){return a=_a(a),a.tag=3,a}function Gu(a,s,o,u){var _=o.type.getDerivedStateFromError;if(typeof _=="function"){var A=u.value;a.payload=function(){return _(A)},a.callback=function(){Vu(s,o,u)}}var j=o.stateNode;j!==null&&typeof j.componentDidCatch=="function"&&(a.callback=function(){Vu(s,o,u),typeof _!="function"&&(Aa===null?Aa=new Set([this]):Aa.add(this));var ee=u.stack;this.componentDidCatch(u.value,{componentStack:ee!==null?ee:""})})}function Y0(a,s,o,u,_){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(s=o.alternate,s!==null&&Qn(s,o,_,!0),o=Ar.current,o!==null){switch(o.tag){case 13:return Nr===null?ul():o.alternate===null&&Nt===0&&(Nt=3),o.flags&=-257,o.flags|=65536,o.lanes=_,u===no?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([u]):s.add(u),hl(a,u,_)),!1;case 22:return o.flags|=65536,u===no?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([u]):o.add(u)),hl(a,u,_)),!1}throw Error(n(435,o.tag))}return hl(a,u,_),ul(),!1}if(Et)return s=Ar.current,s!==null?(!(s.flags&65536)&&(s.flags|=256),s.flags|=65536,s.lanes=_,u!==ao&&(a=Error(n(422),{cause:u}),Hn(yr(a,o)))):(u!==ao&&(s=Error(n(423),{cause:u}),Hn(yr(s,o))),a=a.current.alternate,a.flags|=65536,_&=-_,a.lanes|=_,u=yr(u,o),_=Ro(a.stateNode,u,_),Xo(a,_),Nt!==4&&(Nt=2)),!1;var A=Error(n(520),{cause:u});if(A=yr(A,o),os===null?os=[A]:os.push(A),Nt!==4&&(Nt=2),s===null)return!0;u=yr(u,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,a=_&-_,o.lanes|=a,a=Ro(o.stateNode,u,a),Xo(o,a),!1;case 1:if(s=o.type,A=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Aa===null||!Aa.has(A))))return o.flags|=65536,_&=-_,o.lanes|=_,_=Xu(_),Gu(_,a,o,u),Xo(o,_),!1}o=o.return}while(o!==null);return!1}var qu=Error(n(461)),qt=!1;function Jt(a,s,o,u){s.child=a===null?Jc(s,null,o,u):Na(s,a.child,o,u)}function $u(a,s,o,u,_){o=o.render;var A=s.ref;if("ref"in u){var j={};for(var ee in u)ee!=="ref"&&(j[ee]=u[ee])}else j=u;return Va(s),u=fo(a,s,o,j,A,_),ee=ho(),a!==null&&!qt?(po(a,s,_),Wr(a,s,_)):(Et&&ee&&to(s),s.flags|=1,Jt(a,s,u,_),s.child)}function Wu(a,s,o,u,_){if(a===null){var A=o.type;return typeof A=="function"&&!Qo(A)&&A.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=A,Yu(a,s,A,u,_)):(a=ni(o.type,null,u,s,s.mode,_),a.ref=s.ref,a.return=s,s.child=a)}if(A=a.child,!Bo(a,_)){var j=A.memoizedProps;if(o=o.compare,o=o!==null?o:In,o(j,u)&&a.ref===s.ref)return Wr(a,s,_)}return s.flags|=1,a=Ea(A,u),a.ref=s.ref,a.return=s,s.child=a}function Yu(a,s,o,u,_){if(a!==null){var A=a.memoizedProps;if(In(A,u)&&a.ref===s.ref)if(qt=!1,s.pendingProps=u=A,Bo(a,_))a.flags&131072&&(qt=!0);else return s.lanes=a.lanes,Wr(a,s,_)}return Fo(a,s,o,u,_)}function Ku(a,s,o){var u=s.pendingProps,_=u.children,A=(s.stateNode._pendingVisibility&2)!==0,j=a!==null?a.memoizedState:null;if(Jn(a,s),u.mode==="hidden"||A){if(s.flags&128){if(u=j!==null?j.baseLanes|o:o,a!==null){for(_=s.child=a.child,A=0;_!==null;)A=A|_.lanes|_.childLanes,_=_.sibling;s.childLanes=A&~u}else s.childLanes=0,s.child=null;return Ju(a,s,u,o)}if(o&536870912)s.memoizedState={baseLanes:0,cachePool:null},a!==null&&Vs(s,j!==null?j.cachePool:null),j!==null?Qc(s,j):so(),Zc(s);else return s.lanes=s.childLanes=536870912,Ju(a,s,j!==null?j.baseLanes|o:o,o)}else j!==null?(Vs(s,j.cachePool),Qc(s,j),fa(),s.memoizedState=null):(a!==null&&Vs(s,null),so(),fa());return Jt(a,s,_,o),s.child}function Ju(a,s,o,u){var _=co();return _=_===null?null:{parent:Gt._currentValue,pool:_},s.memoizedState={baseLanes:o,cachePool:_},a!==null&&Vs(s,null),so(),Zc(s),a!==null&&Qn(a,s,u,!0),null}function Jn(a,s){var o=s.ref;if(o===null)a!==null&&a.ref!==null&&(s.flags|=2097664);else{if(typeof o!="function"&&typeof o!="object")throw Error(n(284));(a===null||a.ref!==o)&&(s.flags|=2097664)}}function Fo(a,s,o,u,_){return Va(s),o=fo(a,s,o,u,void 0,_),u=ho(),a!==null&&!qt?(po(a,s,_),Wr(a,s,_)):(Et&&u&&to(s),s.flags|=1,Jt(a,s,o,_),s.child)}function Qu(a,s,o,u,_,A){return Va(s),s.updateQueue=null,o=nu(s,u,o,_),au(a),u=ho(),a!==null&&!qt?(po(a,s,A),Wr(a,s,A)):(Et&&u&&to(s),s.flags|=1,Jt(a,s,o,A),s.child)}function Zu(a,s,o,u,_){if(Va(s),s.stateNode===null){var A=an,j=o.contextType;typeof j=="object"&&j!==null&&(A=tr(j)),A=new o(u,A),s.memoizedState=A.state!==null&&A.state!==void 0?A.state:null,A.updater=ko,s.stateNode=A,A._reactInternals=s,A=s.stateNode,A.props=u,A.state=s.memoizedState,A.refs={},zo(s),j=o.contextType,A.context=typeof j=="object"&&j!==null?tr(j):an,A.state=s.memoizedState,j=o.getDerivedStateFromProps,typeof j=="function"&&(Co(s,o,j,u),A.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof A.getSnapshotBeforeUpdate=="function"||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(j=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),j!==A.state&&ko.enqueueReplaceState(A,A.state,null),ts(s,u,A,_),es(),A.state=s.memoizedState),typeof A.componentDidMount=="function"&&(s.flags|=4194308),u=!0}else if(a===null){A=s.stateNode;var ee=s.memoizedProps,pe=Ha(o,ee);A.props=pe;var Ee=A.context,Be=o.contextType;j=an,typeof Be=="object"&&Be!==null&&(j=tr(Be));var He=o.getDerivedStateFromProps;Be=typeof He=="function"||typeof A.getSnapshotBeforeUpdate=="function",ee=s.pendingProps!==ee,Be||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(ee||Ee!==j)&&Uu(s,A,u,j),ga=!1;var Pe=s.memoizedState;A.state=Pe,ts(s,u,A,_),es(),Ee=s.memoizedState,ee||Pe!==Ee||ga?(typeof He=="function"&&(Co(s,o,He,u),Ee=s.memoizedState),(pe=ga||Bu(s,o,pe,u,Pe,Ee,j))?(Be||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(s.flags|=4194308)):(typeof A.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=u,s.memoizedState=Ee),A.props=u,A.state=Ee,A.context=j,u=pe):(typeof A.componentDidMount=="function"&&(s.flags|=4194308),u=!1)}else{A=s.stateNode,Vo(a,s),j=s.memoizedProps,Be=Ha(o,j),A.props=Be,He=s.pendingProps,Pe=A.context,Ee=o.contextType,pe=an,typeof Ee=="object"&&Ee!==null&&(pe=tr(Ee)),ee=o.getDerivedStateFromProps,(Ee=typeof ee=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(j!==He||Pe!==pe)&&Uu(s,A,u,pe),ga=!1,Pe=s.memoizedState,A.state=Pe,ts(s,u,A,_),es();var Ne=s.memoizedState;j!==He||Pe!==Ne||ga||a!==null&&a.dependencies!==null&&ei(a.dependencies)?(typeof ee=="function"&&(Co(s,o,ee,u),Ne=s.memoizedState),(Be=ga||Bu(s,o,Be,u,Pe,Ne,pe)||a!==null&&a.dependencies!==null&&ei(a.dependencies))?(Ee||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(u,Ne,pe),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(u,Ne,pe)),typeof A.componentDidUpdate=="function"&&(s.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof A.componentDidUpdate!="function"||j===a.memoizedProps&&Pe===a.memoizedState||(s.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||j===a.memoizedProps&&Pe===a.memoizedState||(s.flags|=1024),s.memoizedProps=u,s.memoizedState=Ne),A.props=u,A.state=Ne,A.context=pe,u=Be):(typeof A.componentDidUpdate!="function"||j===a.memoizedProps&&Pe===a.memoizedState||(s.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||j===a.memoizedProps&&Pe===a.memoizedState||(s.flags|=1024),u=!1)}return A=u,Jn(a,s),u=(s.flags&128)!==0,A||u?(A=s.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:A.render(),s.flags|=1,a!==null&&u?(s.child=Na(s,a.child,null,_),s.child=Na(s,null,o,_)):Jt(a,s,o,_),s.memoizedState=A.state,a=s.child):a=Wr(a,s,_),a}function ef(a,s,o,u){return jn(),s.flags|=256,Jt(a,s,o,u),s.child}var Oo={dehydrated:null,treeContext:null,retryLane:0};function Do(a){return{baseLanes:a,cachePool:ru()}}function Po(a,s,o){return a=a!==null?a.childLanes&~o:0,s&&(a|=Cr),a}function tf(a,s,o){var u=s.pendingProps,_=!1,A=(s.flags&128)!==0,j;if((j=A)||(j=a!==null&&a.memoizedState===null?!1:(Xt.current&2)!==0),j&&(_=!0,s.flags&=-129),j=(s.flags&32)!==0,s.flags&=-33,a===null){if(Et){if(_?ua(s):fa(),Et){var ee=Kt,pe;if(pe=ee){e:{for(pe=ee,ee=Lr;pe.nodeType!==8;){if(!ee){ee=null;break e}if(pe=Dr(pe.nextSibling),pe===null){ee=null;break e}}ee=pe}ee!==null?(s.memoizedState={dehydrated:ee,treeContext:Pa!==null?{id:Xr,overflow:Gr}:null,retryLane:536870912},pe=wr(18,null,null,0),pe.stateNode=ee,pe.return=s,s.child=pe,ar=s,Kt=null,pe=!0):pe=!1}pe||La(s)}if(ee=s.memoizedState,ee!==null&&(ee=ee.dehydrated,ee!==null))return ee.data==="$!"?s.lanes=16:s.lanes=536870912,null;qr(s)}return ee=u.children,u=u.fallback,_?(fa(),_=s.mode,ee=Lo({mode:"hidden",children:ee},_),u=Ga(u,_,o,null),ee.return=s,u.return=s,ee.sibling=u,s.child=ee,_=s.child,_.memoizedState=Do(o),_.childLanes=Po(a,j,o),s.memoizedState=Oo,u):(ua(s),Mo(s,ee))}if(pe=a.memoizedState,pe!==null&&(ee=pe.dehydrated,ee!==null)){if(A)s.flags&256?(ua(s),s.flags&=-257,s=No(a,s,o)):s.memoizedState!==null?(fa(),s.child=a.child,s.flags|=128,s=null):(fa(),_=u.fallback,ee=s.mode,u=Lo({mode:"visible",children:u.children},ee),_=Ga(_,ee,o,null),_.flags|=2,u.return=s,_.return=s,u.sibling=_,s.child=u,Na(s,a.child,null,o),u=s.child,u.memoizedState=Do(o),u.childLanes=Po(a,j,o),s.memoizedState=Oo,s=_);else if(ua(s),ee.data==="$!"){if(j=ee.nextSibling&&ee.nextSibling.dataset,j)var Ee=j.dgst;j=Ee,u=Error(n(419)),u.stack="",u.digest=j,Hn({value:u,source:null,stack:null}),s=No(a,s,o)}else if(qt||Qn(a,s,o,!1),j=(o&a.childLanes)!==0,qt||j){if(j=kt,j!==null){if(u=o&-o,u&42)u=1;else switch(u){case 2:u=1;break;case 8:u=4;break;case 32:u=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:u=64;break;case 268435456:u=134217728;break;default:u=0}if(u=u&(j.suspendedLanes|o)?0:u,u!==0&&u!==pe.retryLane)throw pe.retryLane=u,ca(a,u),nr(j,a,u),qu}ee.data==="$?"||ul(),s=No(a,s,o)}else ee.data==="$?"?(s.flags|=128,s.child=a.child,s=ud.bind(null,a),ee._reactRetry=s,s=null):(a=pe.treeContext,Kt=Dr(ee.nextSibling),ar=s,Et=!0,Fr=null,Lr=!1,a!==null&&(Er[Sr++]=Xr,Er[Sr++]=Gr,Er[Sr++]=Pa,Xr=a.id,Gr=a.overflow,Pa=s),s=Mo(s,u.children),s.flags|=4096);return s}return _?(fa(),_=u.fallback,ee=s.mode,pe=a.child,Ee=pe.sibling,u=Ea(pe,{mode:"hidden",children:u.children}),u.subtreeFlags=pe.subtreeFlags&31457280,Ee!==null?_=Ea(Ee,_):(_=Ga(_,ee,o,null),_.flags|=2),_.return=s,u.return=s,u.sibling=_,s.child=u,u=_,_=s.child,ee=a.child.memoizedState,ee===null?ee=Do(o):(pe=ee.cachePool,pe!==null?(Ee=Gt._currentValue,pe=pe.parent!==Ee?{parent:Ee,pool:Ee}:pe):pe=ru(),ee={baseLanes:ee.baseLanes|o,cachePool:pe}),_.memoizedState=ee,_.childLanes=Po(a,j,o),s.memoizedState=Oo,u):(ua(s),o=a.child,a=o.sibling,o=Ea(o,{mode:"visible",children:u.children}),o.return=s,o.sibling=null,a!==null&&(j=s.deletions,j===null?(s.deletions=[a],s.flags|=16):j.push(a)),s.child=o,s.memoizedState=null,o)}function Mo(a,s){return s=Lo({mode:"visible",children:s},a.mode),s.return=a,a.child=s}function Lo(a,s){return kf(a,s,0,null)}function No(a,s,o){return Na(s,a.child,null,o),a=Mo(s,s.pendingProps.children),a.flags|=2,s.memoizedState=null,a}function rf(a,s,o){a.lanes|=s;var u=a.alternate;u!==null&&(u.lanes|=s),jo(a.return,s,o)}function Io(a,s,o,u,_){var A=a.memoizedState;A===null?a.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:_}:(A.isBackwards=s,A.rendering=null,A.renderingStartTime=0,A.last=u,A.tail=o,A.tailMode=_)}function af(a,s,o){var u=s.pendingProps,_=u.revealOrder,A=u.tail;if(Jt(a,s,u.children,o),u=Xt.current,u&2)u=u&1|2,s.flags|=128;else{if(a!==null&&a.flags&128)e:for(a=s.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&rf(a,o,s);else if(a.tag===19)rf(a,o,s);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}u&=1}switch(B(Xt,u),_){case"forwards":for(o=s.child,_=null;o!==null;)a=o.alternate,a!==null&&zs(a)===null&&(_=o),o=o.sibling;o=_,o===null?(_=s.child,s.child=null):(_=o.sibling,o.sibling=null),Io(s,!1,_,o,A);break;case"backwards":for(o=null,_=s.child,s.child=null;_!==null;){if(a=_.alternate,a!==null&&zs(a)===null){s.child=_;break}a=_.sibling,_.sibling=o,o=_,_=a}Io(s,!0,o,null,A);break;case"together":Io(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Wr(a,s,o){if(a!==null&&(s.dependencies=a.dependencies),Sa|=s.lanes,!(o&s.childLanes))if(a!==null){if(Qn(a,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(a!==null&&s.child!==a.child)throw Error(n(153));if(s.child!==null){for(a=s.child,o=Ea(a,a.pendingProps),s.child=o,o.return=s;a.sibling!==null;)a=a.sibling,o=o.sibling=Ea(a,a.pendingProps),o.return=s;o.sibling=null}return s.child}function Bo(a,s){return a.lanes&s?!0:(a=a.dependencies,!!(a!==null&&ei(a)))}function K0(a,s,o){switch(s.tag){case 3:re(s,s.stateNode.containerInfo),pa(s,Gt,a.memoizedState.cache),jn();break;case 27:case 5:Q(s);break;case 4:re(s,s.stateNode.containerInfo);break;case 10:pa(s,s.type,s.memoizedProps.value);break;case 13:var u=s.memoizedState;if(u!==null)return u.dehydrated!==null?(ua(s),s.flags|=128,null):o&s.child.childLanes?tf(a,s,o):(ua(s),a=Wr(a,s,o),a!==null?a.sibling:null);ua(s);break;case 19:var _=(a.flags&128)!==0;if(u=(o&s.childLanes)!==0,u||(Qn(a,s,o,!1),u=(o&s.childLanes)!==0),_){if(u)return af(a,s,o);s.flags|=128}if(_=s.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),B(Xt,Xt.current),u)break;return null;case 22:case 23:return s.lanes=0,Ku(a,s,o);case 24:pa(s,Gt,a.memoizedState.cache)}return Wr(a,s,o)}function nf(a,s,o){if(a!==null)if(a.memoizedProps!==s.pendingProps)qt=!0;else{if(!Bo(a,o)&&!(s.flags&128))return qt=!1,K0(a,s,o);qt=!!(a.flags&131072)}else qt=!1,Et&&s.flags&1048576&&zc(s,Is,s.index);switch(s.lanes=0,s.tag){case 16:e:{a=s.pendingProps;var u=s.elementType,_=u._init;if(u=_(u._payload),s.type=u,typeof u=="function")Qo(u)?(a=Ha(u,a),s.tag=1,s=Zu(null,s,u,a,o)):(s.tag=0,s=Fo(null,s,u,a,o));else{if(u!=null){if(_=u.$$typeof,_===x){s.tag=11,s=$u(null,s,u,a,o);break e}else if(_===b){s.tag=14,s=Wu(null,s,u,a,o);break e}}throw s=N(u)||u,Error(n(306,s,""))}}return s;case 0:return Fo(a,s,s.type,s.pendingProps,o);case 1:return u=s.type,_=Ha(u,s.pendingProps),Zu(a,s,u,_,o);case 3:e:{if(re(s,s.stateNode.containerInfo),a===null)throw Error(n(387));var A=s.pendingProps;_=s.memoizedState,u=_.element,Vo(a,s),ts(s,A,null,o);var j=s.memoizedState;if(A=j.cache,pa(s,Gt,A),A!==_.cache&&Ho(s,[Gt],o,!0),es(),A=j.element,_.isDehydrated)if(_={element:A,isDehydrated:!1,cache:j.cache},s.updateQueue.baseState=_,s.memoizedState=_,s.flags&256){s=ef(a,s,A,o);break e}else if(A!==u){u=yr(Error(n(424)),s),Hn(u),s=ef(a,s,A,o);break e}else for(Kt=Dr(s.stateNode.containerInfo.firstChild),ar=s,Et=!0,Fr=null,Lr=!0,o=Jc(s,null,A,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(jn(),A===u){s=Wr(a,s,o);break e}Jt(a,s,A,o)}s=s.child}return s;case 26:return Jn(a,s),a===null?(o=lh(s.type,null,s.pendingProps,null))?s.memoizedState=o:Et||(o=s.type,a=s.pendingProps,u=_i(K.current).createElement(o),u[te]=s,u[ne]=a,Qt(u,o,a),Ge(u),s.stateNode=u):s.memoizedState=lh(s.type,a.memoizedProps,s.pendingProps,a.memoizedState),null;case 27:return Q(s),a===null&&Et&&(u=s.stateNode=sh(s.type,s.pendingProps,K.current),ar=s,Lr=!0,Kt=Dr(u.firstChild)),u=s.pendingProps.children,a!==null||Et?Jt(a,s,u,o):s.child=Na(s,null,u,o),Jn(a,s),s.child;case 5:return a===null&&Et&&((_=u=Kt)&&(u=wd(u,s.type,s.pendingProps,Lr),u!==null?(s.stateNode=u,ar=s,Kt=Dr(u.firstChild),Lr=!1,_=!0):_=!1),_||La(s)),Q(s),_=s.type,A=s.pendingProps,j=a!==null?a.memoizedProps:null,u=A.children,bl(_,A)?u=null:j!==null&&bl(_,j)&&(s.flags|=32),s.memoizedState!==null&&(_=fo(a,s,V0,null,null,o),_s._currentValue=_),Jn(a,s),Jt(a,s,u,o),s.child;case 6:return a===null&&Et&&((a=o=Kt)&&(o=Cd(o,s.pendingProps,Lr),o!==null?(s.stateNode=o,ar=s,Kt=null,a=!0):a=!1),a||La(s)),null;case 13:return tf(a,s,o);case 4:return re(s,s.stateNode.containerInfo),u=s.pendingProps,a===null?s.child=Na(s,null,u,o):Jt(a,s,u,o),s.child;case 11:return $u(a,s,s.type,s.pendingProps,o);case 7:return Jt(a,s,s.pendingProps,o),s.child;case 8:return Jt(a,s,s.pendingProps.children,o),s.child;case 12:return Jt(a,s,s.pendingProps.children,o),s.child;case 10:return u=s.pendingProps,pa(s,s.type,u.value),Jt(a,s,u.children,o),s.child;case 9:return _=s.type._context,u=s.pendingProps.children,Va(s),_=tr(_),u=u(_),s.flags|=1,Jt(a,s,u,o),s.child;case 14:return Wu(a,s,s.type,s.pendingProps,o);case 15:return Yu(a,s,s.type,s.pendingProps,o);case 19:return af(a,s,o);case 22:return Ku(a,s,o);case 24:return Va(s),u=tr(Gt),a===null?(_=co(),_===null&&(_=kt,A=oo(),_.pooledCache=A,A.refCount++,A!==null&&(_.pooledCacheLanes|=o),_=A),s.memoizedState={parent:u,cache:_},zo(s),pa(s,Gt,_)):(a.lanes&o&&(Vo(a,s),ts(s,null,null,o),es()),_=a.memoizedState,A=s.memoizedState,_.parent!==u?(_={parent:u,cache:u},s.memoizedState=_,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=_),pa(s,Gt,u)):(u=A.cache,pa(s,Gt,u),u!==_.cache&&Ho(s,[Gt],o,!0))),Jt(a,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(n(156,s.tag))}var Uo=J(null),za=null,Yr=null;function pa(a,s,o){B(Uo,s._currentValue),s._currentValue=o}function Kr(a){a._currentValue=Uo.current,O(Uo)}function jo(a,s,o){for(;a!==null;){var u=a.alternate;if((a.childLanes&s)!==s?(a.childLanes|=s,u!==null&&(u.childLanes|=s)):u!==null&&(u.childLanes&s)!==s&&(u.childLanes|=s),a===o)break;a=a.return}}function Ho(a,s,o,u){var _=a.child;for(_!==null&&(_.return=a);_!==null;){var A=_.dependencies;if(A!==null){var j=_.child;A=A.firstContext;e:for(;A!==null;){var ee=A;A=_;for(var pe=0;pe<s.length;pe++)if(ee.context===s[pe]){A.lanes|=o,ee=A.alternate,ee!==null&&(ee.lanes|=o),jo(A.return,o,a),u||(j=null);break e}A=ee.next}}else if(_.tag===18){if(j=_.return,j===null)throw Error(n(341));j.lanes|=o,A=j.alternate,A!==null&&(A.lanes|=o),jo(j,o,a),j=null}else j=_.child;if(j!==null)j.return=_;else for(j=_;j!==null;){if(j===a){j=null;break}if(_=j.sibling,_!==null){_.return=j.return,j=_;break}j=j.return}_=j}}function Qn(a,s,o,u){a=null;for(var _=s,A=!1;_!==null;){if(!A){if(_.flags&524288)A=!0;else if(_.flags&262144)break}if(_.tag===10){var j=_.alternate;if(j===null)throw Error(n(387));if(j=j.memoizedProps,j!==null){var ee=_.type;cr(_.pendingProps.value,j.value)||(a!==null?a.push(ee):a=[ee])}}else if(_===oe.current){if(j=_.alternate,j===null)throw Error(n(387));j.memoizedState.memoizedState!==_.memoizedState.memoizedState&&(a!==null?a.push(_s):a=[_s])}_=_.return}a!==null&&Ho(s,a,o,u),s.flags|=262144}function ei(a){for(a=a.firstContext;a!==null;){if(!cr(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Va(a){za=a,Yr=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function tr(a){return sf(za,a)}function ti(a,s){return za===null&&Va(a),sf(a,s)}function sf(a,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},Yr===null){if(a===null)throw Error(n(308));Yr=s,a.dependencies={lanes:0,firstContext:s},a.flags|=524288}else Yr=Yr.next=s;return o}var ga=!1;function zo(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Vo(a,s){a=a.updateQueue,s.updateQueue===a&&(s.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function _a(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function ma(a,s,o){var u=a.updateQueue;if(u===null)return null;if(u=u.shared,Pt&2){var _=u.pending;return _===null?s.next=s:(s.next=_.next,_.next=s),u.pending=s,s=Ls(a),jc(a,null,o),s}return Ms(a,u,s,o),Ls(a)}function Zn(a,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194176)!==0)){var u=s.lanes;u&=a.pendingLanes,o|=u,s.lanes=o,Hr(a,o)}}function Xo(a,s){var o=a.updateQueue,u=a.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var _=null,A=null;if(o=o.firstBaseUpdate,o!==null){do{var j={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};A===null?_=A=j:A=A.next=j,o=o.next}while(o!==null);A===null?_=A=s:A=A.next=s}else _=A=s;o={baseState:u.baseState,firstBaseUpdate:_,lastBaseUpdate:A,shared:u.shared,callbacks:u.callbacks},a.updateQueue=o;return}a=o.lastBaseUpdate,a===null?o.firstBaseUpdate=s:a.next=s,o.lastBaseUpdate=s}var Go=!1;function es(){if(Go){var a=un;if(a!==null)throw a}}function ts(a,s,o,u){Go=!1;var _=a.updateQueue;ga=!1;var A=_.firstBaseUpdate,j=_.lastBaseUpdate,ee=_.shared.pending;if(ee!==null){_.shared.pending=null;var pe=ee,Ee=pe.next;pe.next=null,j===null?A=Ee:j.next=Ee,j=pe;var Be=a.alternate;Be!==null&&(Be=Be.updateQueue,ee=Be.lastBaseUpdate,ee!==j&&(ee===null?Be.firstBaseUpdate=Ee:ee.next=Ee,Be.lastBaseUpdate=pe))}if(A!==null){var He=_.baseState;j=0,Be=Ee=pe=null,ee=A;do{var Pe=ee.lane&-536870913,Ne=Pe!==ee.lane;if(Ne?(vt&Pe)===Pe:(u&Pe)===Pe){Pe!==0&&Pe===cn&&(Go=!0),Be!==null&&(Be=Be.next={lane:0,tag:ee.tag,payload:ee.payload,callback:null,next:null});e:{var rt=a,ft=ee;Pe=s;var It=o;switch(ft.tag){case 1:if(rt=ft.payload,typeof rt=="function"){He=rt.call(It,He,Pe);break e}He=rt;break e;case 3:rt.flags=rt.flags&-65537|128;case 0:if(rt=ft.payload,Pe=typeof rt=="function"?rt.call(It,He,Pe):rt,Pe==null)break e;He=X({},He,Pe);break e;case 2:ga=!0}}Pe=ee.callback,Pe!==null&&(a.flags|=64,Ne&&(a.flags|=8192),Ne=_.callbacks,Ne===null?_.callbacks=[Pe]:Ne.push(Pe))}else Ne={lane:Pe,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null},Be===null?(Ee=Be=Ne,pe=He):Be=Be.next=Ne,j|=Pe;if(ee=ee.next,ee===null){if(ee=_.shared.pending,ee===null)break;Ne=ee,ee=Ne.next,Ne.next=null,_.lastBaseUpdate=Ne,_.shared.pending=null}}while(!0);Be===null&&(pe=He),_.baseState=pe,_.firstBaseUpdate=Ee,_.lastBaseUpdate=Be,A===null&&(_.shared.lanes=0),Sa|=j,a.lanes=j,a.memoizedState=He}}function of(a,s){if(typeof a!="function")throw Error(n(191,a));a.call(s)}function lf(a,s){var o=a.callbacks;if(o!==null)for(a.callbacks=null,a=0;a<o.length;a++)of(o[a],s)}function rs(a,s){try{var o=s.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var _=u.next;o=_;do{if((o.tag&a)===a){u=void 0;var A=o.create,j=o.inst;u=A(),j.destroy=u}o=o.next}while(o!==_)}}catch(ee){wt(s,s.return,ee)}}function xa(a,s,o){try{var u=s.updateQueue,_=u!==null?u.lastEffect:null;if(_!==null){var A=_.next;u=A;do{if((u.tag&a)===a){var j=u.inst,ee=j.destroy;if(ee!==void 0){j.destroy=void 0,_=s;var pe=o;try{ee()}catch(Ee){wt(_,pe,Ee)}}}u=u.next}while(u!==A)}}catch(Ee){wt(s,s.return,Ee)}}function cf(a){var s=a.updateQueue;if(s!==null){var o=a.stateNode;try{lf(s,o)}catch(u){wt(a,a.return,u)}}}function uf(a,s,o){o.props=Ha(a.type,a.memoizedProps),o.state=a.memoizedState;try{o.componentWillUnmount()}catch(u){wt(a,s,u)}}function Xa(a,s){try{var o=a.ref;if(o!==null){var u=a.stateNode;switch(a.tag){case 26:case 27:case 5:var _=u;break;default:_=u}typeof o=="function"?a.refCleanup=o(_):o.current=_}}catch(A){wt(a,s,A)}}function ur(a,s){var o=a.ref,u=a.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(_){wt(a,s,_)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(_){wt(a,s,_)}else o.current=null}function ff(a){var s=a.type,o=a.memoizedProps,u=a.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(_){wt(a,a.return,_)}}function hf(a,s,o){try{var u=a.stateNode;Ed(u,a.type,o,s),u[ne]=s}catch(_){wt(a,a.return,_)}}function df(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27||a.tag===4}function qo(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||df(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==27&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function $o(a,s,o){var u=a.tag;if(u===5||u===6)a=a.stateNode,s?o.nodeType===8?o.parentNode.insertBefore(a,s):o.insertBefore(a,s):(o.nodeType===8?(s=o.parentNode,s.insertBefore(a,o)):(s=o,s.appendChild(a)),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=gi));else if(u!==4&&u!==27&&(a=a.child,a!==null))for($o(a,s,o),a=a.sibling;a!==null;)$o(a,s,o),a=a.sibling}function ri(a,s,o){var u=a.tag;if(u===5||u===6)a=a.stateNode,s?o.insertBefore(a,s):o.appendChild(a);else if(u!==4&&u!==27&&(a=a.child,a!==null))for(ri(a,s,o),a=a.sibling;a!==null;)ri(a,s,o),a=a.sibling}var Jr=!1,Lt=!1,Wo=!1,pf=typeof WeakSet=="function"?WeakSet:Set,$t=null,gf=!1;function J0(a,s){if(a=a.containerInfo,Sl=Si,a=Oc(a),Yi(a)){if("selectionStart"in a)var o={start:a.selectionStart,end:a.selectionEnd};else e:{o=(o=a.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var _=u.anchorOffset,A=u.focusNode;u=u.focusOffset;try{o.nodeType,A.nodeType}catch{o=null;break e}var j=0,ee=-1,pe=-1,Ee=0,Be=0,He=a,Pe=null;t:for(;;){for(var Ne;He!==o||_!==0&&He.nodeType!==3||(ee=j+_),He!==A||u!==0&&He.nodeType!==3||(pe=j+u),He.nodeType===3&&(j+=He.nodeValue.length),(Ne=He.firstChild)!==null;)Pe=He,He=Ne;for(;;){if(He===a)break t;if(Pe===o&&++Ee===_&&(ee=j),Pe===A&&++Be===u&&(pe=j),(Ne=He.nextSibling)!==null)break;He=Pe,Pe=He.parentNode}He=Ne}o=ee===-1||pe===-1?null:{start:ee,end:pe}}else o=null}o=o||{start:0,end:0}}else o=null;for(Al={focusedElem:a,selectionRange:o},Si=!1,$t=s;$t!==null;)if(s=$t,a=s.child,(s.subtreeFlags&1028)!==0&&a!==null)a.return=s,$t=a;else for(;$t!==null;){switch(s=$t,A=s.alternate,a=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if(a&1024&&A!==null){a=void 0,o=s,_=A.memoizedProps,A=A.memoizedState,u=o.stateNode;try{var rt=Ha(o.type,_,o.elementType===o.type);a=u.getSnapshotBeforeUpdate(rt,A),u.__reactInternalSnapshotBeforeUpdate=a}catch(ft){wt(o,o.return,ft)}}break;case 3:if(a&1024){if(a=s.stateNode.containerInfo,o=a.nodeType,o===9)Cl(a);else if(o===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":Cl(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(a&1024)throw Error(n(163))}if(a=s.sibling,a!==null){a.return=s.return,$t=a;break}$t=s.return}return rt=gf,gf=!1,rt}function _f(a,s,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:Zr(a,o),u&4&&rs(5,o);break;case 1:if(Zr(a,o),u&4)if(a=o.stateNode,s===null)try{a.componentDidMount()}catch(ee){wt(o,o.return,ee)}else{var _=Ha(o.type,s.memoizedProps);s=s.memoizedState;try{a.componentDidUpdate(_,s,a.__reactInternalSnapshotBeforeUpdate)}catch(ee){wt(o,o.return,ee)}}u&64&&cf(o),u&512&&Xa(o,o.return);break;case 3:if(Zr(a,o),u&64&&(u=o.updateQueue,u!==null)){if(a=null,o.child!==null)switch(o.child.tag){case 27:case 5:a=o.child.stateNode;break;case 1:a=o.child.stateNode}try{lf(u,a)}catch(ee){wt(o,o.return,ee)}}break;case 26:Zr(a,o),u&512&&Xa(o,o.return);break;case 27:case 5:Zr(a,o),s===null&&u&4&&ff(o),u&512&&Xa(o,o.return);break;case 12:Zr(a,o);break;case 13:Zr(a,o),u&4&&vf(a,o);break;case 22:if(_=o.memoizedState!==null||Jr,!_){s=s!==null&&s.memoizedState!==null||Lt;var A=Jr,j=Lt;Jr=_,(Lt=s)&&!j?va(a,o,(o.subtreeFlags&8772)!==0):Zr(a,o),Jr=A,Lt=j}u&512&&(o.memoizedProps.mode==="manual"?Xa(o,o.return):ur(o,o.return));break;default:Zr(a,o)}}function mf(a){var s=a.alternate;s!==null&&(a.alternate=null,mf(s)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(s=a.stateNode,s!==null&&De(s)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var zt=null,fr=!1;function Qr(a,s,o){for(o=o.child;o!==null;)xf(a,s,o),o=o.sibling}function xf(a,s,o){if(ct&&typeof ct.onCommitFiberUnmount=="function")try{ct.onCommitFiberUnmount(st,o)}catch{}switch(o.tag){case 26:Lt||ur(o,s),Qr(a,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Lt||ur(o,s);var u=zt,_=fr;for(zt=o.stateNode,Qr(a,s,o),o=o.stateNode,s=o.attributes;s.length;)o.removeAttributeNode(s[0]);De(o),zt=u,fr=_;break;case 5:Lt||ur(o,s);case 6:_=zt;var A=fr;if(zt=null,Qr(a,s,o),zt=_,fr=A,zt!==null)if(fr)try{a=zt,u=o.stateNode,a.nodeType===8?a.parentNode.removeChild(u):a.removeChild(u)}catch(j){wt(o,s,j)}else try{zt.removeChild(o.stateNode)}catch(j){wt(o,s,j)}break;case 18:zt!==null&&(fr?(s=zt,o=o.stateNode,s.nodeType===8?wl(s.parentNode,o):s.nodeType===1&&wl(s,o),ys(s)):wl(zt,o.stateNode));break;case 4:u=zt,_=fr,zt=o.stateNode.containerInfo,fr=!0,Qr(a,s,o),zt=u,fr=_;break;case 0:case 11:case 14:case 15:Lt||xa(2,o,s),Lt||xa(4,o,s),Qr(a,s,o);break;case 1:Lt||(ur(o,s),u=o.stateNode,typeof u.componentWillUnmount=="function"&&uf(o,s,u)),Qr(a,s,o);break;case 21:Qr(a,s,o);break;case 22:Lt||ur(o,s),Lt=(u=Lt)||o.memoizedState!==null,Qr(a,s,o),Lt=u;break;default:Qr(a,s,o)}}function vf(a,s){if(s.memoizedState===null&&(a=s.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{ys(a)}catch(o){wt(s,s.return,o)}}function Q0(a){switch(a.tag){case 13:case 19:var s=a.stateNode;return s===null&&(s=a.stateNode=new pf),s;case 22:return a=a.stateNode,s=a._retryCache,s===null&&(s=a._retryCache=new pf),s;default:throw Error(n(435,a.tag))}}function Yo(a,s){var o=Q0(a);s.forEach(function(u){var _=fd.bind(null,a,u);o.has(u)||(o.add(u),u.then(_,_))})}function br(a,s){var o=s.deletions;if(o!==null)for(var u=0;u<o.length;u++){var _=o[u],A=a,j=s,ee=j;e:for(;ee!==null;){switch(ee.tag){case 27:case 5:zt=ee.stateNode,fr=!1;break e;case 3:zt=ee.stateNode.containerInfo,fr=!0;break e;case 4:zt=ee.stateNode.containerInfo,fr=!0;break e}ee=ee.return}if(zt===null)throw Error(n(160));xf(A,j,_),zt=null,fr=!1,A=_.alternate,A!==null&&(A.return=null),_.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)yf(s,a),s=s.sibling}var Or=null;function yf(a,s){var o=a.alternate,u=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:br(s,a),Tr(a),u&4&&(xa(3,a,a.return),rs(3,a),xa(5,a,a.return));break;case 1:br(s,a),Tr(a),u&512&&(Lt||o===null||ur(o,o.return)),u&64&&Jr&&(a=a.updateQueue,a!==null&&(u=a.callbacks,u!==null&&(o=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var _=Or;if(br(s,a),Tr(a),u&512&&(Lt||o===null||ur(o,o.return)),u&4){var A=o!==null?o.memoizedState:null;if(u=a.memoizedState,o===null)if(u===null)if(a.stateNode===null){e:{u=a.type,o=a.memoizedProps,_=_.ownerDocument||_;t:switch(u){case"title":A=_.getElementsByTagName("title")[0],(!A||A[Fe]||A[te]||A.namespaceURI==="http://www.w3.org/2000/svg"||A.hasAttribute("itemprop"))&&(A=_.createElement(u),_.head.insertBefore(A,_.querySelector("head > title"))),Qt(A,u,o),A[te]=a,Ge(A),u=A;break e;case"link":var j=fh("link","href",_).get(u+(o.href||""));if(j){for(var ee=0;ee<j.length;ee++)if(A=j[ee],A.getAttribute("href")===(o.href==null?null:o.href)&&A.getAttribute("rel")===(o.rel==null?null:o.rel)&&A.getAttribute("title")===(o.title==null?null:o.title)&&A.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){j.splice(ee,1);break t}}A=_.createElement(u),Qt(A,u,o),_.head.appendChild(A);break;case"meta":if(j=fh("meta","content",_).get(u+(o.content||""))){for(ee=0;ee<j.length;ee++)if(A=j[ee],A.getAttribute("content")===(o.content==null?null:""+o.content)&&A.getAttribute("name")===(o.name==null?null:o.name)&&A.getAttribute("property")===(o.property==null?null:o.property)&&A.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&A.getAttribute("charset")===(o.charSet==null?null:o.charSet)){j.splice(ee,1);break t}}A=_.createElement(u),Qt(A,u,o),_.head.appendChild(A);break;default:throw Error(n(468,u))}A[te]=a,Ge(A),u=A}a.stateNode=u}else hh(_,a.type,a.stateNode);else a.stateNode=uh(_,u,a.memoizedProps);else A!==u?(A===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):A.count--,u===null?hh(_,a.type,a.stateNode):uh(_,u,a.memoizedProps)):u===null&&a.stateNode!==null&&hf(a,a.memoizedProps,o.memoizedProps)}break;case 27:if(u&4&&a.alternate===null){_=a.stateNode,A=a.memoizedProps;try{for(var pe=_.firstChild;pe;){var Ee=pe.nextSibling,Be=pe.nodeName;pe[Fe]||Be==="HEAD"||Be==="BODY"||Be==="SCRIPT"||Be==="STYLE"||Be==="LINK"&&pe.rel.toLowerCase()==="stylesheet"||_.removeChild(pe),pe=Ee}for(var He=a.type,Pe=_.attributes;Pe.length;)_.removeAttributeNode(Pe[0]);Qt(_,He,A),_[te]=a,_[ne]=A}catch(rt){wt(a,a.return,rt)}}case 5:if(br(s,a),Tr(a),u&512&&(Lt||o===null||ur(o,o.return)),a.flags&32){_=a.stateNode;try{Ka(_,"")}catch(rt){wt(a,a.return,rt)}}u&4&&a.stateNode!=null&&(_=a.memoizedProps,hf(a,_,o!==null?o.memoizedProps:_)),u&1024&&(Wo=!0);break;case 6:if(br(s,a),Tr(a),u&4){if(a.stateNode===null)throw Error(n(162));u=a.memoizedProps,o=a.stateNode;try{o.nodeValue=u}catch(rt){wt(a,a.return,rt)}}break;case 3:if(vi=null,_=Or,Or=mi(s.containerInfo),br(s,a),Or=_,Tr(a),u&4&&o!==null&&o.memoizedState.isDehydrated)try{ys(s.containerInfo)}catch(rt){wt(a,a.return,rt)}Wo&&(Wo=!1,Ef(a));break;case 4:u=Or,Or=mi(a.stateNode.containerInfo),br(s,a),Tr(a),Or=u;break;case 12:br(s,a),Tr(a);break;case 13:br(s,a),Tr(a),a.child.flags&8192&&a.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(nl=Ce()),u&4&&(u=a.updateQueue,u!==null&&(a.updateQueue=null,Yo(a,u)));break;case 22:if(u&512&&(Lt||o===null||ur(o,o.return)),pe=a.memoizedState!==null,Ee=o!==null&&o.memoizedState!==null,Be=Jr,He=Lt,Jr=Be||pe,Lt=He||Ee,br(s,a),Lt=He,Jr=Be,Tr(a),s=a.stateNode,s._current=a,s._visibility&=-3,s._visibility|=s._pendingVisibility&2,u&8192&&(s._visibility=pe?s._visibility&-2:s._visibility|1,pe&&(s=Jr||Lt,o===null||Ee||s||pn(a)),a.memoizedProps===null||a.memoizedProps.mode!=="manual"))e:for(o=null,s=a;;){if(s.tag===5||s.tag===26||s.tag===27){if(o===null){Ee=o=s;try{if(_=Ee.stateNode,pe)A=_.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none";else{j=Ee.stateNode,ee=Ee.memoizedProps.style;var Ne=ee!=null&&ee.hasOwnProperty("display")?ee.display:null;j.style.display=Ne==null||typeof Ne=="boolean"?"":(""+Ne).trim()}}catch(rt){wt(Ee,Ee.return,rt)}}}else if(s.tag===6){if(o===null){Ee=s;try{Ee.stateNode.nodeValue=pe?"":Ee.memoizedProps}catch(rt){wt(Ee,Ee.return,rt)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===a)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}u&4&&(u=a.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,Yo(a,o))));break;case 19:br(s,a),Tr(a),u&4&&(u=a.updateQueue,u!==null&&(a.updateQueue=null,Yo(a,u)));break;case 21:break;default:br(s,a),Tr(a)}}function Tr(a){var s=a.flags;if(s&2){try{if(a.tag!==27){e:{for(var o=a.return;o!==null;){if(df(o)){var u=o;break e}o=o.return}throw Error(n(160))}switch(u.tag){case 27:var _=u.stateNode,A=qo(a);ri(a,A,_);break;case 5:var j=u.stateNode;u.flags&32&&(Ka(j,""),u.flags&=-33);var ee=qo(a);ri(a,ee,j);break;case 3:case 4:var pe=u.stateNode.containerInfo,Ee=qo(a);$o(a,Ee,pe);break;default:throw Error(n(161))}}}catch(Be){wt(a,a.return,Be)}a.flags&=-3}s&4096&&(a.flags&=-4097)}function Ef(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var s=a;Ef(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),a=a.sibling}}function Zr(a,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)_f(a,s.alternate,s),s=s.sibling}function pn(a){for(a=a.child;a!==null;){var s=a;switch(s.tag){case 0:case 11:case 14:case 15:xa(4,s,s.return),pn(s);break;case 1:ur(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&uf(s,s.return,o),pn(s);break;case 26:case 27:case 5:ur(s,s.return),pn(s);break;case 22:ur(s,s.return),s.memoizedState===null&&pn(s);break;default:pn(s)}a=a.sibling}}function va(a,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var u=s.alternate,_=a,A=s,j=A.flags;switch(A.tag){case 0:case 11:case 15:va(_,A,o),rs(4,A);break;case 1:if(va(_,A,o),u=A,_=u.stateNode,typeof _.componentDidMount=="function")try{_.componentDidMount()}catch(Ee){wt(u,u.return,Ee)}if(u=A,_=u.updateQueue,_!==null){var ee=u.stateNode;try{var pe=_.shared.hiddenCallbacks;if(pe!==null)for(_.shared.hiddenCallbacks=null,_=0;_<pe.length;_++)of(pe[_],ee)}catch(Ee){wt(u,u.return,Ee)}}o&&j&64&&cf(A),Xa(A,A.return);break;case 26:case 27:case 5:va(_,A,o),o&&u===null&&j&4&&ff(A),Xa(A,A.return);break;case 12:va(_,A,o);break;case 13:va(_,A,o),o&&j&4&&vf(_,A);break;case 22:A.memoizedState===null&&va(_,A,o),Xa(A,A.return);break;default:va(_,A,o)}s=s.sibling}}function Ko(a,s){var o=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(o=a.memoizedState.cachePool.pool),a=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),a!==o&&(a!=null&&a.refCount++,o!=null&&qn(o))}function Jo(a,s){a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&qn(a))}function ya(a,s,o,u){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Sf(a,s,o,u),s=s.sibling}function Sf(a,s,o,u){var _=s.flags;switch(s.tag){case 0:case 11:case 15:ya(a,s,o,u),_&2048&&rs(9,s);break;case 3:ya(a,s,o,u),_&2048&&(a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&qn(a)));break;case 12:if(_&2048){ya(a,s,o,u),a=s.stateNode;try{var A=s.memoizedProps,j=A.id,ee=A.onPostCommit;typeof ee=="function"&&ee(j,s.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(pe){wt(s,s.return,pe)}}else ya(a,s,o,u);break;case 23:break;case 22:A=s.stateNode,s.memoizedState!==null?A._visibility&4?ya(a,s,o,u):as(a,s):A._visibility&4?ya(a,s,o,u):(A._visibility|=4,gn(a,s,o,u,(s.subtreeFlags&10256)!==0)),_&2048&&Ko(s.alternate,s);break;case 24:ya(a,s,o,u),_&2048&&Jo(s.alternate,s);break;default:ya(a,s,o,u)}}function gn(a,s,o,u,_){for(_=_&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var A=a,j=s,ee=o,pe=u,Ee=j.flags;switch(j.tag){case 0:case 11:case 15:gn(A,j,ee,pe,_),rs(8,j);break;case 23:break;case 22:var Be=j.stateNode;j.memoizedState!==null?Be._visibility&4?gn(A,j,ee,pe,_):as(A,j):(Be._visibility|=4,gn(A,j,ee,pe,_)),_&&Ee&2048&&Ko(j.alternate,j);break;case 24:gn(A,j,ee,pe,_),_&&Ee&2048&&Jo(j.alternate,j);break;default:gn(A,j,ee,pe,_)}s=s.sibling}}function as(a,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=a,u=s,_=u.flags;switch(u.tag){case 22:as(o,u),_&2048&&Ko(u.alternate,u);break;case 24:as(o,u),_&2048&&Jo(u.alternate,u);break;default:as(o,u)}s=s.sibling}}var ns=8192;function _n(a){if(a.subtreeFlags&ns)for(a=a.child;a!==null;)Af(a),a=a.sibling}function Af(a){switch(a.tag){case 26:_n(a),a.flags&ns&&a.memoizedState!==null&&jd(Or,a.memoizedState,a.memoizedProps);break;case 5:_n(a);break;case 3:case 4:var s=Or;Or=mi(a.stateNode.containerInfo),_n(a),Or=s;break;case 22:a.memoizedState===null&&(s=a.alternate,s!==null&&s.memoizedState!==null?(s=ns,ns=16777216,_n(a),ns=s):_n(a));break;default:_n(a)}}function bf(a){var s=a.alternate;if(s!==null&&(a=s.child,a!==null)){s.child=null;do s=a.sibling,a.sibling=null,a=s;while(a!==null)}}function ss(a){var s=a.deletions;if(a.flags&16){if(s!==null)for(var o=0;o<s.length;o++){var u=s[o];$t=u,wf(u,a)}bf(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Tf(a),a=a.sibling}function Tf(a){switch(a.tag){case 0:case 11:case 15:ss(a),a.flags&2048&&xa(9,a,a.return);break;case 3:ss(a);break;case 12:ss(a);break;case 22:var s=a.stateNode;a.memoizedState!==null&&s._visibility&4&&(a.return===null||a.return.tag!==13)?(s._visibility&=-5,ai(a)):ss(a);break;default:ss(a)}}function ai(a){var s=a.deletions;if(a.flags&16){if(s!==null)for(var o=0;o<s.length;o++){var u=s[o];$t=u,wf(u,a)}bf(a)}for(a=a.child;a!==null;){switch(s=a,s.tag){case 0:case 11:case 15:xa(8,s,s.return),ai(s);break;case 22:o=s.stateNode,o._visibility&4&&(o._visibility&=-5,ai(s));break;default:ai(s)}a=a.sibling}}function wf(a,s){for(;$t!==null;){var o=$t;switch(o.tag){case 0:case 11:case 15:xa(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:qn(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,$t=u;else e:for(o=a;$t!==null;){u=$t;var _=u.sibling,A=u.return;if(mf(u),u===o){$t=null;break e}if(_!==null){_.return=A,$t=_;break e}$t=A}}}function Z0(a,s,o,u){this.tag=a,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wr(a,s,o,u){return new Z0(a,s,o,u)}function Qo(a){return a=a.prototype,!(!a||!a.isReactComponent)}function Ea(a,s){var o=a.alternate;return o===null?(o=wr(a.tag,s,a.key,a.mode),o.elementType=a.elementType,o.type=a.type,o.stateNode=a.stateNode,o.alternate=a,a.alternate=o):(o.pendingProps=s,o.type=a.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=a.flags&31457280,o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,s=a.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=a.sibling,o.index=a.index,o.ref=a.ref,o.refCleanup=a.refCleanup,o}function Cf(a,s){a.flags&=31457282;var o=a.alternate;return o===null?(a.childLanes=0,a.lanes=s,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,s=o.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),a}function ni(a,s,o,u,_,A){var j=0;if(u=a,typeof a=="function")Qo(a)&&(j=1);else if(typeof a=="string")j=Bd(a,o,G.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case d:return Ga(o.children,_,A,s);case h:j=8,_|=24;break;case p:return a=wr(12,o,s,_|2),a.elementType=p,a.lanes=A,a;case g:return a=wr(13,o,s,_),a.elementType=g,a.lanes=A,a;case m:return a=wr(19,o,s,_),a.elementType=m,a.lanes=A,a;case C:return kf(o,_,A,s);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case E:case S:j=10;break e;case v:j=9;break e;case x:j=11;break e;case b:j=14;break e;case D:j=16,u=null;break e}j=29,o=Error(n(130,a===null?"null":typeof a,"")),u=null}return s=wr(j,o,s,_),s.elementType=a,s.type=u,s.lanes=A,s}function Ga(a,s,o,u){return a=wr(7,a,u,s),a.lanes=o,a}function kf(a,s,o,u){a=wr(22,a,u,s),a.elementType=C,a.lanes=o;var _={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var A=_._current;if(A===null)throw Error(n(456));if(!(_._pendingVisibility&2)){var j=ca(A,2);j!==null&&(_._pendingVisibility|=2,nr(j,A,2))}},attach:function(){var A=_._current;if(A===null)throw Error(n(456));if(_._pendingVisibility&2){var j=ca(A,2);j!==null&&(_._pendingVisibility&=-3,nr(j,A,2))}}};return a.stateNode=_,a}function Zo(a,s,o){return a=wr(6,a,null,s),a.lanes=o,a}function el(a,s,o){return s=wr(4,a.children!==null?a.children:[],a.key,s),s.lanes=o,s.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},s}function ea(a){a.flags|=4}function Rf(a,s){if(s.type!=="stylesheet"||s.state.loading&4)a.flags&=-16777217;else if(a.flags|=16777216,!dh(s)){if(s=Ar.current,s!==null&&((vt&4194176)===vt?Nr!==null:(vt&62914560)!==vt&&!(vt&536870912)||s!==Nr))throw Vn=no,Gc;a.flags|=8192}}function si(a,s){s!==null&&(a.flags|=4),a.flags&16384&&(s=a.tag!==22?Vt():536870912,a.lanes|=s,xn|=s)}function is(a,s){if(!Et)switch(a.tailMode){case"hidden":s=a.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?a.tail=null:o.sibling=null;break;case"collapsed":o=a.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s||a.tail===null?a.tail=null:a.tail.sibling=null:u.sibling=null}}function Dt(a){var s=a.alternate!==null&&a.alternate.child===a.child,o=0,u=0;if(s)for(var _=a.child;_!==null;)o|=_.lanes|_.childLanes,u|=_.subtreeFlags&31457280,u|=_.flags&31457280,_.return=a,_=_.sibling;else for(_=a.child;_!==null;)o|=_.lanes|_.childLanes,u|=_.subtreeFlags,u|=_.flags,_.return=a,_=_.sibling;return a.subtreeFlags|=u,a.childLanes=o,s}function ed(a,s,o){var u=s.pendingProps;switch(ro(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dt(s),null;case 1:return Dt(s),null;case 3:return o=s.stateNode,u=null,a!==null&&(u=a.memoizedState.cache),s.memoizedState.cache!==u&&(s.flags|=2048),Kr(Gt),H(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(a===null||a.child===null)&&(Un(s)?ea(s):a===null||a.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,Fr!==null&&(ll(Fr),Fr=null))),Dt(s),null;case 26:return o=s.memoizedState,a===null?(ea(s),o!==null?(Dt(s),Rf(s,o)):(Dt(s),s.flags&=-16777217)):o?o!==a.memoizedState?(ea(s),Dt(s),Rf(s,o)):(Dt(s),s.flags&=-16777217):(a.memoizedProps!==u&&ea(s),Dt(s),s.flags&=-16777217),null;case 27:be(s),o=K.current;var _=s.type;if(a!==null&&s.stateNode!=null)a.memoizedProps!==u&&ea(s);else{if(!u){if(s.stateNode===null)throw Error(n(166));return Dt(s),null}a=G.current,Un(s)?Vc(s):(a=sh(_,u,o),s.stateNode=a,ea(s))}return Dt(s),null;case 5:if(be(s),o=s.type,a!==null&&s.stateNode!=null)a.memoizedProps!==u&&ea(s);else{if(!u){if(s.stateNode===null)throw Error(n(166));return Dt(s),null}if(a=G.current,Un(s))Vc(s);else{switch(_=_i(K.current),a){case 1:a=_.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:a=_.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":a=_.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":a=_.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":a=_.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof u.is=="string"?_.createElement("select",{is:u.is}):_.createElement("select"),u.multiple?a.multiple=!0:u.size&&(a.size=u.size);break;default:a=typeof u.is=="string"?_.createElement(o,{is:u.is}):_.createElement(o)}}a[te]=s,a[ne]=u;e:for(_=s.child;_!==null;){if(_.tag===5||_.tag===6)a.appendChild(_.stateNode);else if(_.tag!==4&&_.tag!==27&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===s)break e;for(;_.sibling===null;){if(_.return===null||_.return===s)break e;_=_.return}_.sibling.return=_.return,_=_.sibling}s.stateNode=a;e:switch(Qt(a,o,u),o){case"button":case"input":case"select":case"textarea":a=!!u.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&ea(s)}}return Dt(s),s.flags&=-16777217,null;case 6:if(a&&s.stateNode!=null)a.memoizedProps!==u&&ea(s);else{if(typeof u!="string"&&s.stateNode===null)throw Error(n(166));if(a=K.current,Un(s)){if(a=s.stateNode,o=s.memoizedProps,u=null,_=ar,_!==null)switch(_.tag){case 27:case 5:u=_.memoizedProps}a[te]=s,a=!!(a.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||Zf(a.nodeValue,o)),a||La(s)}else a=_i(a).createTextNode(u),a[te]=s,s.stateNode=a}return Dt(s),null;case 13:if(u=s.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(_=Un(s),u!==null&&u.dehydrated!==null){if(a===null){if(!_)throw Error(n(318));if(_=s.memoizedState,_=_!==null?_.dehydrated:null,!_)throw Error(n(317));_[te]=s}else jn(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;Dt(s),_=!1}else Fr!==null&&(ll(Fr),Fr=null),_=!0;if(!_)return s.flags&256?(qr(s),s):(qr(s),null)}if(qr(s),s.flags&128)return s.lanes=o,s;if(o=u!==null,a=a!==null&&a.memoizedState!==null,o){u=s.child,_=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(_=u.alternate.memoizedState.cachePool.pool);var A=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(A=u.memoizedState.cachePool.pool),A!==_&&(u.flags|=2048)}return o!==a&&o&&(s.child.flags|=8192),si(s,s.updateQueue),Dt(s),null;case 4:return H(),a===null&&vl(s.stateNode.containerInfo),Dt(s),null;case 10:return Kr(s.type),Dt(s),null;case 19:if(O(Xt),_=s.memoizedState,_===null)return Dt(s),null;if(u=(s.flags&128)!==0,A=_.rendering,A===null)if(u)is(_,!1);else{if(Nt!==0||a!==null&&a.flags&128)for(a=s.child;a!==null;){if(A=zs(a),A!==null){for(s.flags|=128,is(_,!1),a=A.updateQueue,s.updateQueue=a,si(s,a),s.subtreeFlags=0,a=o,o=s.child;o!==null;)Cf(o,a),o=o.sibling;return B(Xt,Xt.current&1|2),s.child}a=a.sibling}_.tail!==null&&Ce()>ii&&(s.flags|=128,u=!0,is(_,!1),s.lanes=4194304)}else{if(!u)if(a=zs(A),a!==null){if(s.flags|=128,u=!0,a=a.updateQueue,s.updateQueue=a,si(s,a),is(_,!0),_.tail===null&&_.tailMode==="hidden"&&!A.alternate&&!Et)return Dt(s),null}else 2*Ce()-_.renderingStartTime>ii&&o!==536870912&&(s.flags|=128,u=!0,is(_,!1),s.lanes=4194304);_.isBackwards?(A.sibling=s.child,s.child=A):(a=_.last,a!==null?a.sibling=A:s.child=A,_.last=A)}return _.tail!==null?(s=_.tail,_.rendering=s,_.tail=s.sibling,_.renderingStartTime=Ce(),s.sibling=null,a=Xt.current,B(Xt,u?a&1|2:a&1),s):(Dt(s),null);case 22:case 23:return qr(s),io(),u=s.memoizedState!==null,a!==null?a.memoizedState!==null!==u&&(s.flags|=8192):u&&(s.flags|=8192),u?o&536870912&&!(s.flags&128)&&(Dt(s),s.subtreeFlags&6&&(s.flags|=8192)):Dt(s),o=s.updateQueue,o!==null&&si(s,o.retryQueue),o=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(o=a.memoizedState.cachePool.pool),u=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),u!==o&&(s.flags|=2048),a!==null&&O(Ia),null;case 24:return o=null,a!==null&&(o=a.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),Kr(Gt),Dt(s),null;case 25:return null}throw Error(n(156,s.tag))}function td(a,s){switch(ro(s),s.tag){case 1:return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 3:return Kr(Gt),H(),a=s.flags,a&65536&&!(a&128)?(s.flags=a&-65537|128,s):null;case 26:case 27:case 5:return be(s),null;case 13:if(qr(s),a=s.memoizedState,a!==null&&a.dehydrated!==null){if(s.alternate===null)throw Error(n(340));jn()}return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 19:return O(Xt),null;case 4:return H(),null;case 10:return Kr(s.type),null;case 22:case 23:return qr(s),io(),a!==null&&O(Ia),a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 24:return Kr(Gt),null;case 25:return null;default:return null}}function Ff(a,s){switch(ro(s),s.tag){case 3:Kr(Gt),H();break;case 26:case 27:case 5:be(s);break;case 4:H();break;case 13:qr(s);break;case 19:O(Xt);break;case 10:Kr(s.type);break;case 22:case 23:qr(s),io(),a!==null&&O(Ia);break;case 24:Kr(Gt)}}var rd={getCacheForType:function(a){var s=tr(Gt),o=s.data.get(a);return o===void 0&&(o=a(),s.data.set(a,o)),o}},ad=typeof WeakMap=="function"?WeakMap:Map,Pt=0,kt=null,mt=null,vt=0,Rt=0,hr=null,ta=!1,mn=!1,tl=!1,ra=0,Nt=0,Sa=0,qa=0,rl=0,Cr=0,xn=0,os=null,Br=null,al=!1,nl=0,ii=1/0,oi=null,Aa=null,li=!1,$a=null,ls=0,sl=0,il=null,cs=0,ol=null;function dr(){if(Pt&2&&vt!==0)return vt&-vt;if(L.T!==null){var a=cn;return a!==0?a:gl()}return ia()}function Of(){Cr===0&&(Cr=!(vt&536870912)||Et?gr():536870912);var a=Ar.current;return a!==null&&(a.flags|=32),Cr}function nr(a,s,o){(a===kt&&Rt===2||a.cancelPendingCommit!==null)&&(vn(a,0),aa(a,vt,Cr,!1)),er(a,o),(!(Pt&2)||a!==kt)&&(a===kt&&(!(Pt&2)&&(qa|=o),Nt===4&&aa(a,vt,Cr,!1)),Ur(a))}function Df(a,s,o){if(Pt&6)throw Error(n(327));var u=!o&&(s&60)===0&&(s&a.expiredLanes)===0||Zt(a,s),_=u?id(a,s):fl(a,s,!0),A=u;do{if(_===0){mn&&!u&&aa(a,s,0,!1);break}else if(_===6)aa(a,s,0,!ta);else{if(o=a.current.alternate,A&&!nd(o)){_=fl(a,s,!1),A=!1;continue}if(_===2){if(A=s,a.errorRecoveryDisabledLanes&A)var j=0;else j=a.pendingLanes&-536870913,j=j!==0?j:j&536870912?536870912:0;if(j!==0){s=j;e:{var ee=a;_=os;var pe=ee.current.memoizedState.isDehydrated;if(pe&&(vn(ee,j).flags|=256),j=fl(ee,j,!1),j!==2){if(tl&&!pe){ee.errorRecoveryDisabledLanes|=A,qa|=A,_=4;break e}A=Br,Br=_,A!==null&&ll(A)}_=j}if(A=!1,_!==2)continue}}if(_===1){vn(a,0),aa(a,s,0,!0);break}e:{switch(u=a,_){case 0:case 1:throw Error(n(345));case 4:if((s&4194176)===s){aa(u,s,Cr,!ta);break e}break;case 2:Br=null;break;case 3:case 5:break;default:throw Error(n(329))}if(u.finishedWork=o,u.finishedLanes=s,(s&62914560)===s&&(A=nl+300-Ce(),10<A)){if(aa(u,s,Cr,!ta),yt(u,0)!==0)break e;u.timeoutHandle=rh(Pf.bind(null,u,o,Br,oi,al,s,Cr,qa,xn,ta,2,-0,0),A);break e}Pf(u,o,Br,oi,al,s,Cr,qa,xn,ta,0,-0,0)}}break}while(!0);Ur(a)}function ll(a){Br===null?Br=a:Br.push.apply(Br,a)}function Pf(a,s,o,u,_,A,j,ee,pe,Ee,Be,He,Pe){var Ne=s.subtreeFlags;if((Ne&8192||(Ne&16785408)===16785408)&&(gs={stylesheets:null,count:0,unsuspend:Ud},Af(s),s=Hd(),s!==null)){a.cancelPendingCommit=s(jf.bind(null,a,o,u,_,j,ee,pe,1,He,Pe)),aa(a,A,j,!Ee);return}jf(a,o,u,_,j,ee,pe,Be,He,Pe)}function nd(a){for(var s=a;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var _=o[u],A=_.getSnapshot;_=_.value;try{if(!cr(A(),_))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function aa(a,s,o,u){s&=~rl,s&=~qa,a.suspendedLanes|=s,a.pingedLanes&=~s,u&&(a.warmLanes|=s),u=a.expirationTimes;for(var _=s;0<_;){var A=31-Mt(_),j=1<<A;u[A]=-1,_&=~j}o!==0&&Ft(a,o,s)}function ci(){return Pt&6?!0:(us(0),!1)}function cl(){if(mt!==null){if(Rt===0)var a=mt.return;else a=mt,Yr=za=null,go(a),on=null,Xn=0,a=mt;for(;a!==null;)Ff(a.alternate,a),a=a.return;mt=null}}function vn(a,s){a.finishedWork=null,a.finishedLanes=0;var o=a.timeoutHandle;o!==-1&&(a.timeoutHandle=-1,Ad(o)),o=a.cancelPendingCommit,o!==null&&(a.cancelPendingCommit=null,o()),cl(),kt=a,mt=o=Ea(a.current,null),vt=s,Rt=0,hr=null,ta=!1,mn=Zt(a,s),tl=!1,xn=Cr=rl=qa=Sa=Nt=0,Br=os=null,al=!1,s&8&&(s|=s&32);var u=a.entangledLanes;if(u!==0)for(a=a.entanglements,u&=s;0<u;){var _=31-Mt(u),A=1<<_;s|=a[_],u&=~A}return ra=s,Ps(),o}function Mf(a,s){dt=null,L.H=Ir,s===zn?(s=Wc(),Rt=3):s===Gc?(s=Wc(),Rt=4):Rt=s===qu?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,hr=s,mt===null&&(Nt=1,Zs(a,yr(s,a.current)))}function Lf(){var a=L.H;return L.H=Ir,a===null?Ir:a}function Nf(){var a=L.A;return L.A=rd,a}function ul(){Nt=4,ta||(vt&4194176)!==vt&&Ar.current!==null||(mn=!0),!(Sa&134217727)&&!(qa&134217727)||kt===null||aa(kt,vt,Cr,!1)}function fl(a,s,o){var u=Pt;Pt|=2;var _=Lf(),A=Nf();(kt!==a||vt!==s)&&(oi=null,vn(a,s)),s=!1;var j=Nt;e:do try{if(Rt!==0&&mt!==null){var ee=mt,pe=hr;switch(Rt){case 8:cl(),j=6;break e;case 3:case 2:case 6:Ar.current===null&&(s=!0);var Ee=Rt;if(Rt=0,hr=null,yn(a,ee,pe,Ee),o&&mn){j=0;break e}break;default:Ee=Rt,Rt=0,hr=null,yn(a,ee,pe,Ee)}}sd(),j=Nt;break}catch(Be){Mf(a,Be)}while(!0);return s&&a.shellSuspendCounter++,Yr=za=null,Pt=u,L.H=_,L.A=A,mt===null&&(kt=null,vt=0,Ps()),j}function sd(){for(;mt!==null;)If(mt)}function id(a,s){var o=Pt;Pt|=2;var u=Lf(),_=Nf();kt!==a||vt!==s?(oi=null,ii=Ce()+500,vn(a,s)):mn=Zt(a,s);e:do try{if(Rt!==0&&mt!==null){s=mt;var A=hr;t:switch(Rt){case 1:Rt=0,hr=null,yn(a,s,A,1);break;case 2:if(qc(A)){Rt=0,hr=null,Bf(s);break}s=function(){Rt===2&&kt===a&&(Rt=7),Ur(a)},A.then(s,s);break e;case 3:Rt=7;break e;case 4:Rt=5;break e;case 7:qc(A)?(Rt=0,hr=null,Bf(s)):(Rt=0,hr=null,yn(a,s,A,7));break;case 5:var j=null;switch(mt.tag){case 26:j=mt.memoizedState;case 5:case 27:var ee=mt;if(!j||dh(j)){Rt=0,hr=null;var pe=ee.sibling;if(pe!==null)mt=pe;else{var Ee=ee.return;Ee!==null?(mt=Ee,ui(Ee)):mt=null}break t}}Rt=0,hr=null,yn(a,s,A,5);break;case 6:Rt=0,hr=null,yn(a,s,A,6);break;case 8:cl(),Nt=6;break e;default:throw Error(n(462))}}od();break}catch(Be){Mf(a,Be)}while(!0);return Yr=za=null,L.H=u,L.A=_,Pt=o,mt!==null?0:(kt=null,vt=0,Ps(),Nt)}function od(){for(;mt!==null&&!Le();)If(mt)}function If(a){var s=nf(a.alternate,a,ra);a.memoizedProps=a.pendingProps,s===null?ui(a):mt=s}function Bf(a){var s=a,o=s.alternate;switch(s.tag){case 15:case 0:s=Qu(o,s,s.pendingProps,s.type,void 0,vt);break;case 11:s=Qu(o,s,s.pendingProps,s.type.render,s.ref,vt);break;case 5:go(s);default:Ff(o,s),s=mt=Cf(s,ra),s=nf(o,s,ra)}a.memoizedProps=a.pendingProps,s===null?ui(a):mt=s}function yn(a,s,o,u){Yr=za=null,go(s),on=null,Xn=0;var _=s.return;try{if(Y0(a,_,s,o,vt)){Nt=1,Zs(a,yr(o,a.current)),mt=null;return}}catch(A){if(_!==null)throw mt=_,A;Nt=1,Zs(a,yr(o,a.current)),mt=null;return}s.flags&32768?(Et||u===1?a=!0:mn||vt&536870912?a=!1:(ta=a=!0,(u===2||u===3||u===6)&&(u=Ar.current,u!==null&&u.tag===13&&(u.flags|=16384))),Uf(s,a)):ui(s)}function ui(a){var s=a;do{if(s.flags&32768){Uf(s,ta);return}a=s.return;var o=ed(s.alternate,s,ra);if(o!==null){mt=o;return}if(s=s.sibling,s!==null){mt=s;return}mt=s=a}while(s!==null);Nt===0&&(Nt=5)}function Uf(a,s){do{var o=td(a.alternate,a);if(o!==null){o.flags&=32767,mt=o;return}if(o=a.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(a=a.sibling,a!==null)){mt=a;return}mt=a=o}while(a!==null);Nt=6,mt=null}function jf(a,s,o,u,_,A,j,ee,pe,Ee){var Be=L.T,He=R.p;try{R.p=2,L.T=null,ld(a,s,o,u,He,_,A,j,ee,pe,Ee)}finally{L.T=Be,R.p=He}}function ld(a,s,o,u,_,A,j,ee){do En();while($a!==null);if(Pt&6)throw Error(n(327));var pe=a.finishedWork;if(u=a.finishedLanes,pe===null)return null;if(a.finishedWork=null,a.finishedLanes=0,pe===a.current)throw Error(n(177));a.callbackNode=null,a.callbackPriority=0,a.cancelPendingCommit=null;var Ee=pe.lanes|pe.childLanes;if(Ee|=Zi,sa(a,u,Ee,A,j,ee),a===kt&&(mt=kt=null,vt=0),!(pe.subtreeFlags&10256)&&!(pe.flags&10256)||li||(li=!0,sl=Ee,il=o,hd(et,function(){return En(),null})),o=(pe.flags&15990)!==0,pe.subtreeFlags&15990||o?(o=L.T,L.T=null,A=R.p,R.p=2,j=Pt,Pt|=4,J0(a,pe),yf(pe,a),D0(Al,a.containerInfo),Si=!!Sl,Al=Sl=null,a.current=pe,_f(a,pe.alternate,pe),Ve(),Pt=j,R.p=A,L.T=o):a.current=pe,li?(li=!1,$a=a,ls=u):Hf(a,Ee),Ee=a.pendingLanes,Ee===0&&(Aa=null),lr(pe.stateNode),Ur(a),s!==null)for(_=a.onRecoverableError,pe=0;pe<s.length;pe++)Ee=s[pe],_(Ee.value,{componentStack:Ee.stack});return ls&3&&En(),Ee=a.pendingLanes,u&4194218&&Ee&42?a===ol?cs++:(cs=0,ol=a):cs=0,us(0),null}function Hf(a,s){(a.pooledCacheLanes&=s)===0&&(s=a.pooledCache,s!=null&&(a.pooledCache=null,qn(s)))}function En(){if($a!==null){var a=$a,s=sl;sl=0;var o=zr(ls),u=L.T,_=R.p;try{if(R.p=32>o?32:o,L.T=null,$a===null)var A=!1;else{o=il,il=null;var j=$a,ee=ls;if($a=null,ls=0,Pt&6)throw Error(n(331));var pe=Pt;if(Pt|=4,Tf(j.current),Sf(j,j.current,ee,o),Pt=pe,us(0,!1),ct&&typeof ct.onPostCommitFiberRoot=="function")try{ct.onPostCommitFiberRoot(st,j)}catch{}A=!0}return A}finally{R.p=_,L.T=u,Hf(a,s)}}return!1}function zf(a,s,o){s=yr(o,s),s=Ro(a.stateNode,s,2),a=ma(a,s,2),a!==null&&(er(a,2),Ur(a))}function wt(a,s,o){if(a.tag===3)zf(a,a,o);else for(;s!==null;){if(s.tag===3){zf(s,a,o);break}else if(s.tag===1){var u=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Aa===null||!Aa.has(u))){a=yr(o,a),o=Xu(2),u=ma(s,o,2),u!==null&&(Gu(o,u,s,a),er(u,2),Ur(u));break}}s=s.return}}function hl(a,s,o){var u=a.pingCache;if(u===null){u=a.pingCache=new ad;var _=new Set;u.set(s,_)}else _=u.get(s),_===void 0&&(_=new Set,u.set(s,_));_.has(o)||(tl=!0,_.add(o),a=cd.bind(null,a,s,o),s.then(a,a))}function cd(a,s,o){var u=a.pingCache;u!==null&&u.delete(s),a.pingedLanes|=a.suspendedLanes&o,a.warmLanes&=~o,kt===a&&(vt&o)===o&&(Nt===4||Nt===3&&(vt&62914560)===vt&&300>Ce()-nl?!(Pt&2)&&vn(a,0):rl|=o,xn===vt&&(xn=0)),Ur(a)}function Vf(a,s){s===0&&(s=Vt()),a=ca(a,s),a!==null&&(er(a,s),Ur(a))}function ud(a){var s=a.memoizedState,o=0;s!==null&&(o=s.retryLane),Vf(a,o)}function fd(a,s){var o=0;switch(a.tag){case 13:var u=a.stateNode,_=a.memoizedState;_!==null&&(o=_.retryLane);break;case 19:u=a.stateNode;break;case 22:u=a.stateNode._retryCache;break;default:throw Error(n(314))}u!==null&&u.delete(s),Vf(a,o)}function hd(a,s){return ye(a,s)}var fi=null,Sn=null,dl=!1,hi=!1,pl=!1,Wa=0;function Ur(a){a!==Sn&&a.next===null&&(Sn===null?fi=Sn=a:Sn=Sn.next=a),hi=!0,dl||(dl=!0,pd(dd))}function us(a,s){if(!pl&&hi){pl=!0;do for(var o=!1,u=fi;u!==null;){if(a!==0){var _=u.pendingLanes;if(_===0)var A=0;else{var j=u.suspendedLanes,ee=u.pingedLanes;A=(1<<31-Mt(42|a)+1)-1,A&=_&~(j&~ee),A=A&201326677?A&201326677|1:A?A|2:0}A!==0&&(o=!0,qf(u,A))}else A=vt,A=yt(u,u===kt?A:0),!(A&3)||Zt(u,A)||(o=!0,qf(u,A));u=u.next}while(o);pl=!1}}function dd(){hi=dl=!1;var a=0;Wa!==0&&(Sd()&&(a=Wa),Wa=0);for(var s=Ce(),o=null,u=fi;u!==null;){var _=u.next,A=Xf(u,s);A===0?(u.next=null,o===null?fi=_:o.next=_,_===null&&(Sn=o)):(o=u,(a!==0||A&3)&&(hi=!0)),u=_}us(a)}function Xf(a,s){for(var o=a.suspendedLanes,u=a.pingedLanes,_=a.expirationTimes,A=a.pendingLanes&-62914561;0<A;){var j=31-Mt(A),ee=1<<j,pe=_[j];pe===-1?(!(ee&o)||ee&u)&&(_[j]=Pr(ee,s)):pe<=s&&(a.expiredLanes|=ee),A&=~ee}if(s=kt,o=vt,o=yt(a,a===s?o:0),u=a.callbackNode,o===0||a===s&&Rt===2||a.cancelPendingCommit!==null)return u!==null&&u!==null&&we(u),a.callbackNode=null,a.callbackPriority=0;if(!(o&3)||Zt(a,o)){if(s=o&-o,s===a.callbackPriority)return s;switch(u!==null&&we(u),zr(o)){case 2:case 8:o=Je;break;case 32:o=et;break;case 268435456:o=Qe;break;default:o=et}return u=Gf.bind(null,a),o=ye(o,u),a.callbackPriority=s,a.callbackNode=o,s}return u!==null&&u!==null&&we(u),a.callbackPriority=2,a.callbackNode=null,2}function Gf(a,s){var o=a.callbackNode;if(En()&&a.callbackNode!==o)return null;var u=vt;return u=yt(a,a===kt?u:0),u===0?null:(Df(a,u,s),Xf(a,Ce()),a.callbackNode!=null&&a.callbackNode===o?Gf.bind(null,a):null)}function qf(a,s){if(En())return null;Df(a,s,!0)}function pd(a){bd(function(){Pt&6?ye(tt,a):a()})}function gl(){return Wa===0&&(Wa=gr()),Wa}function $f(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:ws(""+a)}function Wf(a,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,a.id&&o.setAttribute("form",a.id),s.parentNode.insertBefore(o,s),a=new FormData(a),o.parentNode.removeChild(o),a}function gd(a,s,o,u,_){if(s==="submit"&&o&&o.stateNode===_){var A=$f((_[ne]||null).action),j=u.submitter;j&&(s=(s=j[ne]||null)?$f(s.formAction):j.getAttribute("formAction"),s!==null&&(A=s,j=null));var ee=new Fs("action","action",null,u,_);a.push({event:ee,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Wa!==0){var pe=j?Wf(_,j):new FormData(_);bo(o,{pending:!0,data:pe,method:_.method,action:A},null,pe)}}else typeof A=="function"&&(ee.preventDefault(),pe=j?Wf(_,j):new FormData(_),bo(o,{pending:!0,data:pe,method:_.method,action:A},A,pe))},currentTarget:_}]})}}for(var _l=0;_l<Uc.length;_l++){var ml=Uc[_l],_d=ml.toLowerCase(),md=ml[0].toUpperCase()+ml.slice(1);Rr(_d,"on"+md)}Rr(Mc,"onAnimationEnd"),Rr(Lc,"onAnimationIteration"),Rr(Nc,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(M0,"onTransitionRun"),Rr(L0,"onTransitionStart"),Rr(N0,"onTransitionCancel"),Rr(Ic,"onTransitionEnd"),Ot("onMouseEnter",["mouseout","mouseover"]),Ot("onMouseLeave",["mouseout","mouseover"]),Ot("onPointerEnter",["pointerout","pointerover"]),Ot("onPointerLeave",["pointerout","pointerover"]),At("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),At("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),At("onBeforeInput",["compositionend","keypress","textInput","paste"]),At("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),At("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),At("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xd=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(fs));function Yf(a,s){s=(s&4)!==0;for(var o=0;o<a.length;o++){var u=a[o],_=u.event;u=u.listeners;e:{var A=void 0;if(s)for(var j=u.length-1;0<=j;j--){var ee=u[j],pe=ee.instance,Ee=ee.currentTarget;if(ee=ee.listener,pe!==A&&_.isPropagationStopped())break e;A=ee,_.currentTarget=Ee;try{A(_)}catch(Be){Qs(Be)}_.currentTarget=null,A=pe}else for(j=0;j<u.length;j++){if(ee=u[j],pe=ee.instance,Ee=ee.currentTarget,ee=ee.listener,pe!==A&&_.isPropagationStopped())break e;A=ee,_.currentTarget=Ee;try{A(_)}catch(Be){Qs(Be)}_.currentTarget=null,A=pe}}}}function xt(a,s){var o=s[he];o===void 0&&(o=s[he]=new Set);var u=a+"__bubble";o.has(u)||(Kf(s,a,2,!1),o.add(u))}function xl(a,s,o){var u=0;s&&(u|=4),Kf(o,a,u,s)}var di="_reactListening"+Math.random().toString(36).slice(2);function vl(a){if(!a[di]){a[di]=!0,ut.forEach(function(o){o!=="selectionchange"&&(xd.has(o)||xl(o,!1,a),xl(o,!0,a))});var s=a.nodeType===9?a:a.ownerDocument;s===null||s[di]||(s[di]=!0,xl("selectionchange",!1,s))}}function Kf(a,s,o,u){switch(vh(s)){case 2:var _=Xd;break;case 8:_=Gd;break;default:_=Dl}o=_.bind(null,s,o,a),_=void 0,!ji||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(_=!0),u?_!==void 0?a.addEventListener(s,o,{capture:!0,passive:_}):a.addEventListener(s,o,!0):_!==void 0?a.addEventListener(s,o,{passive:_}):a.addEventListener(s,o,!1)}function yl(a,s,o,u,_){var A=u;if(!(s&1)&&!(s&2)&&u!==null)e:for(;;){if(u===null)return;var j=u.tag;if(j===3||j===4){var ee=u.stateNode.containerInfo;if(ee===_||ee.nodeType===8&&ee.parentNode===_)break;if(j===4)for(j=u.return;j!==null;){var pe=j.tag;if((pe===3||pe===4)&&(pe=j.stateNode.containerInfo,pe===_||pe.nodeType===8&&pe.parentNode===_))return;j=j.return}for(;ee!==null;){if(j=ze(ee),j===null)return;if(pe=j.tag,pe===5||pe===6||pe===26||pe===27){u=A=j;continue e}ee=ee.parentNode}}u=u.return}uc(function(){var Ee=A,Be=Bi(o),He=[];e:{var Pe=Bc.get(a);if(Pe!==void 0){var Ne=Fs,rt=a;switch(a){case"keypress":if(ks(o)===0)break e;case"keydown":case"keyup":Ne=f0;break;case"focusin":rt="focus",Ne=Xi;break;case"focusout":rt="blur",Ne=Xi;break;case"beforeblur":case"afterblur":Ne=Xi;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ne=dc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ne=Zh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ne=p0;break;case Mc:case Lc:case Nc:Ne=r0;break;case Ic:Ne=_0;break;case"scroll":case"scrollend":Ne=Jh;break;case"wheel":Ne=x0;break;case"copy":case"cut":case"paste":Ne=n0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ne=gc;break;case"toggle":case"beforetoggle":Ne=y0}var ft=(s&4)!==0,It=!ft&&(a==="scroll"||a==="scrollend"),Te=ft?Pe!==null?Pe+"Capture":null:Pe;ft=[];for(var ve=Ee,ke;ve!==null;){var Ue=ve;if(ke=Ue.stateNode,Ue=Ue.tag,Ue!==5&&Ue!==26&&Ue!==27||ke===null||Te===null||(Ue=Fn(ve,Te),Ue!=null&&ft.push(hs(ve,Ue,ke))),It)break;ve=ve.return}0<ft.length&&(Pe=new Ne(Pe,rt,null,o,Be),He.push({event:Pe,listeners:ft}))}}if(!(s&7)){e:{if(Pe=a==="mouseover"||a==="pointerover",Ne=a==="mouseout"||a==="pointerout",Pe&&o!==Ii&&(rt=o.relatedTarget||o.fromElement)&&(ze(rt)||rt[ue]))break e;if((Ne||Pe)&&(Pe=Be.window===Be?Be:(Pe=Be.ownerDocument)?Pe.defaultView||Pe.parentWindow:window,Ne?(rt=o.relatedTarget||o.toElement,Ne=Ee,rt=rt?ze(rt):null,rt!==null&&(It=fe(rt),ft=rt.tag,rt!==It||ft!==5&&ft!==27&&ft!==6)&&(rt=null)):(Ne=null,rt=Ee),Ne!==rt)){if(ft=dc,Ue="onMouseLeave",Te="onMouseEnter",ve="mouse",(a==="pointerout"||a==="pointerover")&&(ft=gc,Ue="onPointerLeave",Te="onPointerEnter",ve="pointer"),It=Ne==null?Pe:Ke(Ne),ke=rt==null?Pe:Ke(rt),Pe=new ft(Ue,ve+"leave",Ne,o,Be),Pe.target=It,Pe.relatedTarget=ke,Ue=null,ze(Be)===Ee&&(ft=new ft(Te,ve+"enter",rt,o,Be),ft.target=ke,ft.relatedTarget=It,Ue=ft),It=Ue,Ne&&rt)t:{for(ft=Ne,Te=rt,ve=0,ke=ft;ke;ke=An(ke))ve++;for(ke=0,Ue=Te;Ue;Ue=An(Ue))ke++;for(;0<ve-ke;)ft=An(ft),ve--;for(;0<ke-ve;)Te=An(Te),ke--;for(;ve--;){if(ft===Te||Te!==null&&ft===Te.alternate)break t;ft=An(ft),Te=An(Te)}ft=null}else ft=null;Ne!==null&&Jf(He,Pe,Ne,ft,!1),rt!==null&&It!==null&&Jf(He,It,rt,ft,!0)}}e:{if(Pe=Ee?Ke(Ee):window,Ne=Pe.nodeName&&Pe.nodeName.toLowerCase(),Ne==="select"||Ne==="input"&&Pe.type==="file")var Ze=Ac;else if(Ec(Pe))if(bc)Ze=F0;else{Ze=k0;var _t=C0}else Ne=Pe.nodeName,!Ne||Ne.toLowerCase()!=="input"||Pe.type!=="checkbox"&&Pe.type!=="radio"?Ee&&Ni(Ee.elementType)&&(Ze=Ac):Ze=R0;if(Ze&&(Ze=Ze(a,Ee))){Sc(He,Ze,o,Be);break e}_t&&_t(a,Pe,Ee),a==="focusout"&&Ee&&Pe.type==="number"&&Ee.memoizedProps.value!=null&&Li(Pe,"number",Pe.value)}switch(_t=Ee?Ke(Ee):window,a){case"focusin":(Ec(_t)||_t.contentEditable==="true")&&(en=_t,Ki=Ee,Bn=null);break;case"focusout":Bn=Ki=en=null;break;case"mousedown":Ji=!0;break;case"contextmenu":case"mouseup":case"dragend":Ji=!1,Dc(He,o,Be);break;case"selectionchange":if(P0)break;case"keydown":case"keyup":Dc(He,o,Be)}var at;if(qi)e:{switch(a){case"compositionstart":var ot="onCompositionStart";break e;case"compositionend":ot="onCompositionEnd";break e;case"compositionupdate":ot="onCompositionUpdate";break e}ot=void 0}else Za?vc(a,o)&&(ot="onCompositionEnd"):a==="keydown"&&o.keyCode===229&&(ot="onCompositionStart");ot&&(_c&&o.locale!=="ko"&&(Za||ot!=="onCompositionStart"?ot==="onCompositionEnd"&&Za&&(at=fc()):(la=Be,Hi="value"in la?la.value:la.textContent,Za=!0)),_t=pi(Ee,ot),0<_t.length&&(ot=new pc(ot,a,null,o,Be),He.push({event:ot,listeners:_t}),at?ot.data=at:(at=yc(o),at!==null&&(ot.data=at)))),(at=S0?A0(a,o):b0(a,o))&&(ot=pi(Ee,"onBeforeInput"),0<ot.length&&(_t=new pc("onBeforeInput","beforeinput",null,o,Be),He.push({event:_t,listeners:ot}),_t.data=at)),gd(He,a,Ee,o,Be)}Yf(He,s)})}function hs(a,s,o){return{instance:a,listener:s,currentTarget:o}}function pi(a,s){for(var o=s+"Capture",u=[];a!==null;){var _=a,A=_.stateNode;_=_.tag,_!==5&&_!==26&&_!==27||A===null||(_=Fn(a,o),_!=null&&u.unshift(hs(a,_,A)),_=Fn(a,s),_!=null&&u.push(hs(a,_,A))),a=a.return}return u}function An(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function Jf(a,s,o,u,_){for(var A=s._reactName,j=[];o!==null&&o!==u;){var ee=o,pe=ee.alternate,Ee=ee.stateNode;if(ee=ee.tag,pe!==null&&pe===u)break;ee!==5&&ee!==26&&ee!==27||Ee===null||(pe=Ee,_?(Ee=Fn(o,A),Ee!=null&&j.unshift(hs(o,Ee,pe))):_||(Ee=Fn(o,A),Ee!=null&&j.push(hs(o,Ee,pe)))),o=o.return}j.length!==0&&a.push({event:s,listeners:j})}var vd=/\r\n?/g,yd=/\u0000|\uFFFD/g;function Qf(a){return(typeof a=="string"?a:""+a).replace(vd,`
`).replace(yd,"")}function Zf(a,s){return s=Qf(s),Qf(a)===s}function gi(){}function Tt(a,s,o,u,_,A){switch(o){case"children":typeof u=="string"?s==="body"||s==="textarea"&&u===""||Ka(a,u):(typeof u=="number"||typeof u=="bigint")&&s!=="body"&&Ka(a,""+u);break;case"className":As(a,"class",u);break;case"tabIndex":As(a,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":As(a,o,u);break;case"style":lc(a,u,A);break;case"data":if(s!=="object"){As(a,"data",u);break}case"src":case"href":if(u===""&&(s!=="a"||o!=="href")){a.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){a.removeAttribute(o);break}u=ws(""+u),a.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){a.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof A=="function"&&(o==="formAction"?(s!=="input"&&Tt(a,s,"name",_.name,_,null),Tt(a,s,"formEncType",_.formEncType,_,null),Tt(a,s,"formMethod",_.formMethod,_,null),Tt(a,s,"formTarget",_.formTarget,_,null)):(Tt(a,s,"encType",_.encType,_,null),Tt(a,s,"method",_.method,_,null),Tt(a,s,"target",_.target,_,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){a.removeAttribute(o);break}u=ws(""+u),a.setAttribute(o,u);break;case"onClick":u!=null&&(a.onclick=gi);break;case"onScroll":u!=null&&xt("scroll",a);break;case"onScrollEnd":u!=null&&xt("scrollend",a);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(n(61));if(o=u.__html,o!=null){if(_.children!=null)throw Error(n(60));a.innerHTML=o}}break;case"multiple":a.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":a.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){a.removeAttribute("xlink:href");break}o=ws(""+u),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?a.setAttribute(o,""+u):a.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?a.setAttribute(o,""):a.removeAttribute(o);break;case"capture":case"download":u===!0?a.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?a.setAttribute(o,u):a.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?a.setAttribute(o,u):a.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?a.removeAttribute(o):a.setAttribute(o,u);break;case"popover":xt("beforetoggle",a),xt("toggle",a),sr(a,"popover",u);break;case"xlinkActuate":Vr(a,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Vr(a,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Vr(a,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Vr(a,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Vr(a,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Vr(a,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Vr(a,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Vr(a,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Vr(a,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":sr(a,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Yh.get(o)||o,sr(a,o,u))}}function El(a,s,o,u,_,A){switch(o){case"style":lc(a,u,A);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(n(61));if(o=u.__html,o!=null){if(_.children!=null)throw Error(n(60));a.innerHTML=o}}break;case"children":typeof u=="string"?Ka(a,u):(typeof u=="number"||typeof u=="bigint")&&Ka(a,""+u);break;case"onScroll":u!=null&&xt("scroll",a);break;case"onScrollEnd":u!=null&&xt("scrollend",a);break;case"onClick":u!=null&&(a.onclick=gi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ct.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(_=o.endsWith("Capture"),s=o.slice(2,_?o.length-7:void 0),A=a[ne]||null,A=A!=null?A[o]:null,typeof A=="function"&&a.removeEventListener(s,A,_),typeof u=="function")){typeof A!="function"&&A!==null&&(o in a?a[o]=null:a.hasAttribute(o)&&a.removeAttribute(o)),a.addEventListener(s,u,_);break e}o in a?a[o]=u:u===!0?a.setAttribute(o,""):sr(a,o,u)}}}function Qt(a,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":xt("error",a),xt("load",a);var u=!1,_=!1,A;for(A in o)if(o.hasOwnProperty(A)){var j=o[A];if(j!=null)switch(A){case"src":u=!0;break;case"srcSet":_=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Tt(a,s,A,j,o,null)}}_&&Tt(a,s,"srcSet",o.srcSet,o,null),u&&Tt(a,s,"src",o.src,o,null);return;case"input":xt("invalid",a);var ee=A=j=_=null,pe=null,Ee=null;for(u in o)if(o.hasOwnProperty(u)){var Be=o[u];if(Be!=null)switch(u){case"name":_=Be;break;case"type":j=Be;break;case"checked":pe=Be;break;case"defaultChecked":Ee=Be;break;case"value":A=Be;break;case"defaultValue":ee=Be;break;case"children":case"dangerouslySetInnerHTML":if(Be!=null)throw Error(n(137,s));break;default:Tt(a,s,u,Be,o,null)}}nc(a,A,ee,pe,Ee,j,_,!1),bs(a);return;case"select":xt("invalid",a),u=j=A=null;for(_ in o)if(o.hasOwnProperty(_)&&(ee=o[_],ee!=null))switch(_){case"value":A=ee;break;case"defaultValue":j=ee;break;case"multiple":u=ee;default:Tt(a,s,_,ee,o,null)}s=A,o=j,a.multiple=!!u,s!=null?Ya(a,!!u,s,!1):o!=null&&Ya(a,!!u,o,!0);return;case"textarea":xt("invalid",a),A=_=u=null;for(j in o)if(o.hasOwnProperty(j)&&(ee=o[j],ee!=null))switch(j){case"value":u=ee;break;case"defaultValue":_=ee;break;case"children":A=ee;break;case"dangerouslySetInnerHTML":if(ee!=null)throw Error(n(91));break;default:Tt(a,s,j,ee,o,null)}ic(a,u,_,A),bs(a);return;case"option":for(pe in o)if(o.hasOwnProperty(pe)&&(u=o[pe],u!=null))switch(pe){case"selected":a.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:Tt(a,s,pe,u,o,null)}return;case"dialog":xt("cancel",a),xt("close",a);break;case"iframe":case"object":xt("load",a);break;case"video":case"audio":for(u=0;u<fs.length;u++)xt(fs[u],a);break;case"image":xt("error",a),xt("load",a);break;case"details":xt("toggle",a);break;case"embed":case"source":case"link":xt("error",a),xt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ee in o)if(o.hasOwnProperty(Ee)&&(u=o[Ee],u!=null))switch(Ee){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Tt(a,s,Ee,u,o,null)}return;default:if(Ni(s)){for(Be in o)o.hasOwnProperty(Be)&&(u=o[Be],u!==void 0&&El(a,s,Be,u,o,void 0));return}}for(ee in o)o.hasOwnProperty(ee)&&(u=o[ee],u!=null&&Tt(a,s,ee,u,o,null))}function Ed(a,s,o,u){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var _=null,A=null,j=null,ee=null,pe=null,Ee=null,Be=null;for(Ne in o){var He=o[Ne];if(o.hasOwnProperty(Ne)&&He!=null)switch(Ne){case"checked":break;case"value":break;case"defaultValue":pe=He;default:u.hasOwnProperty(Ne)||Tt(a,s,Ne,null,u,He)}}for(var Pe in u){var Ne=u[Pe];if(He=o[Pe],u.hasOwnProperty(Pe)&&(Ne!=null||He!=null))switch(Pe){case"type":A=Ne;break;case"name":_=Ne;break;case"checked":Ee=Ne;break;case"defaultChecked":Be=Ne;break;case"value":j=Ne;break;case"defaultValue":ee=Ne;break;case"children":case"dangerouslySetInnerHTML":if(Ne!=null)throw Error(n(137,s));break;default:Ne!==He&&Tt(a,s,Pe,Ne,u,He)}}Mi(a,j,ee,pe,Ee,Be,A,_);return;case"select":Ne=j=ee=Pe=null;for(A in o)if(pe=o[A],o.hasOwnProperty(A)&&pe!=null)switch(A){case"value":break;case"multiple":Ne=pe;default:u.hasOwnProperty(A)||Tt(a,s,A,null,u,pe)}for(_ in u)if(A=u[_],pe=o[_],u.hasOwnProperty(_)&&(A!=null||pe!=null))switch(_){case"value":Pe=A;break;case"defaultValue":ee=A;break;case"multiple":j=A;default:A!==pe&&Tt(a,s,_,A,u,pe)}s=ee,o=j,u=Ne,Pe!=null?Ya(a,!!o,Pe,!1):!!u!=!!o&&(s!=null?Ya(a,!!o,s,!0):Ya(a,!!o,o?[]:"",!1));return;case"textarea":Ne=Pe=null;for(ee in o)if(_=o[ee],o.hasOwnProperty(ee)&&_!=null&&!u.hasOwnProperty(ee))switch(ee){case"value":break;case"children":break;default:Tt(a,s,ee,null,u,_)}for(j in u)if(_=u[j],A=o[j],u.hasOwnProperty(j)&&(_!=null||A!=null))switch(j){case"value":Pe=_;break;case"defaultValue":Ne=_;break;case"children":break;case"dangerouslySetInnerHTML":if(_!=null)throw Error(n(91));break;default:_!==A&&Tt(a,s,j,_,u,A)}sc(a,Pe,Ne);return;case"option":for(var rt in o)if(Pe=o[rt],o.hasOwnProperty(rt)&&Pe!=null&&!u.hasOwnProperty(rt))switch(rt){case"selected":a.selected=!1;break;default:Tt(a,s,rt,null,u,Pe)}for(pe in u)if(Pe=u[pe],Ne=o[pe],u.hasOwnProperty(pe)&&Pe!==Ne&&(Pe!=null||Ne!=null))switch(pe){case"selected":a.selected=Pe&&typeof Pe!="function"&&typeof Pe!="symbol";break;default:Tt(a,s,pe,Pe,u,Ne)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ft in o)Pe=o[ft],o.hasOwnProperty(ft)&&Pe!=null&&!u.hasOwnProperty(ft)&&Tt(a,s,ft,null,u,Pe);for(Ee in u)if(Pe=u[Ee],Ne=o[Ee],u.hasOwnProperty(Ee)&&Pe!==Ne&&(Pe!=null||Ne!=null))switch(Ee){case"children":case"dangerouslySetInnerHTML":if(Pe!=null)throw Error(n(137,s));break;default:Tt(a,s,Ee,Pe,u,Ne)}return;default:if(Ni(s)){for(var It in o)Pe=o[It],o.hasOwnProperty(It)&&Pe!==void 0&&!u.hasOwnProperty(It)&&El(a,s,It,void 0,u,Pe);for(Be in u)Pe=u[Be],Ne=o[Be],!u.hasOwnProperty(Be)||Pe===Ne||Pe===void 0&&Ne===void 0||El(a,s,Be,Pe,u,Ne);return}}for(var Te in o)Pe=o[Te],o.hasOwnProperty(Te)&&Pe!=null&&!u.hasOwnProperty(Te)&&Tt(a,s,Te,null,u,Pe);for(He in u)Pe=u[He],Ne=o[He],!u.hasOwnProperty(He)||Pe===Ne||Pe==null&&Ne==null||Tt(a,s,He,Pe,u,Ne)}var Sl=null,Al=null;function _i(a){return a.nodeType===9?a:a.ownerDocument}function eh(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function th(a,s){if(a===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&s==="foreignObject"?0:a}function bl(a,s){return a==="textarea"||a==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Tl=null;function Sd(){var a=window.event;return a&&a.type==="popstate"?a===Tl?!1:(Tl=a,!0):(Tl=null,!1)}var rh=typeof setTimeout=="function"?setTimeout:void 0,Ad=typeof clearTimeout=="function"?clearTimeout:void 0,ah=typeof Promise=="function"?Promise:void 0,bd=typeof queueMicrotask=="function"?queueMicrotask:typeof ah<"u"?function(a){return ah.resolve(null).then(a).catch(Td)}:rh;function Td(a){setTimeout(function(){throw a})}function wl(a,s){var o=s,u=0;do{var _=o.nextSibling;if(a.removeChild(o),_&&_.nodeType===8)if(o=_.data,o==="/$"){if(u===0){a.removeChild(_),ys(s);return}u--}else o!=="$"&&o!=="$?"&&o!=="$!"||u++;o=_}while(o);ys(s)}function Cl(a){var s=a.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Cl(o),De(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}a.removeChild(o)}}function wd(a,s,o,u){for(;a.nodeType===1;){var _=o;if(a.nodeName.toLowerCase()!==s.toLowerCase()){if(!u&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(u){if(!a[Fe])switch(s){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(A=a.getAttribute("rel"),A==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(A!==_.rel||a.getAttribute("href")!==(_.href==null?null:_.href)||a.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin)||a.getAttribute("title")!==(_.title==null?null:_.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(A=a.getAttribute("src"),(A!==(_.src==null?null:_.src)||a.getAttribute("type")!==(_.type==null?null:_.type)||a.getAttribute("crossorigin")!==(_.crossOrigin==null?null:_.crossOrigin))&&A&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(s==="input"&&a.type==="hidden"){var A=_.name==null?null:""+_.name;if(_.type==="hidden"&&a.getAttribute("name")===A)return a}else return a;if(a=Dr(a.nextSibling),a===null)break}return null}function Cd(a,s,o){if(s==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!o||(a=Dr(a.nextSibling),a===null))return null;return a}function Dr(a){for(;a!=null;a=a.nextSibling){var s=a.nodeType;if(s===1||s===3)break;if(s===8){if(s=a.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return a}function nh(a){a=a.previousSibling;for(var s=0;a;){if(a.nodeType===8){var o=a.data;if(o==="$"||o==="$!"||o==="$?"){if(s===0)return a;s--}else o==="/$"&&s++}a=a.previousSibling}return null}function sh(a,s,o){switch(s=_i(o),a){case"html":if(a=s.documentElement,!a)throw Error(n(452));return a;case"head":if(a=s.head,!a)throw Error(n(453));return a;case"body":if(a=s.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}var kr=new Map,ih=new Set;function mi(a){return typeof a.getRootNode=="function"?a.getRootNode():a.ownerDocument}var na=R.d;R.d={f:kd,r:Rd,D:Fd,C:Od,L:Dd,m:Pd,X:Ld,S:Md,M:Nd};function kd(){var a=na.f(),s=ci();return a||s}function Rd(a){var s=We(a);s!==null&&s.tag===5&&s.type==="form"?Du(s):na.r(a)}var bn=typeof document>"u"?null:document;function oh(a,s,o){var u=bn;if(u&&typeof s=="string"&&s){var _=xr(s);_='link[rel="'+a+'"][href="'+_+'"]',typeof o=="string"&&(_+='[crossorigin="'+o+'"]'),ih.has(_)||(ih.add(_),a={rel:a,crossOrigin:o,href:s},u.querySelector(_)===null&&(s=u.createElement("link"),Qt(s,"link",a),Ge(s),u.head.appendChild(s)))}}function Fd(a){na.D(a),oh("dns-prefetch",a,null)}function Od(a,s){na.C(a,s),oh("preconnect",a,s)}function Dd(a,s,o){na.L(a,s,o);var u=bn;if(u&&a&&s){var _='link[rel="preload"][as="'+xr(s)+'"]';s==="image"&&o&&o.imageSrcSet?(_+='[imagesrcset="'+xr(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(_+='[imagesizes="'+xr(o.imageSizes)+'"]')):_+='[href="'+xr(a)+'"]';var A=_;switch(s){case"style":A=Tn(a);break;case"script":A=wn(a)}kr.has(A)||(a=X({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:a,as:s},o),kr.set(A,a),u.querySelector(_)!==null||s==="style"&&u.querySelector(ds(A))||s==="script"&&u.querySelector(ps(A))||(s=u.createElement("link"),Qt(s,"link",a),Ge(s),u.head.appendChild(s)))}}function Pd(a,s){na.m(a,s);var o=bn;if(o&&a){var u=s&&typeof s.as=="string"?s.as:"script",_='link[rel="modulepreload"][as="'+xr(u)+'"][href="'+xr(a)+'"]',A=_;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":A=wn(a)}if(!kr.has(A)&&(a=X({rel:"modulepreload",href:a},s),kr.set(A,a),o.querySelector(_)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(ps(A)))return}u=o.createElement("link"),Qt(u,"link",a),Ge(u),o.head.appendChild(u)}}}function Md(a,s,o){na.S(a,s,o);var u=bn;if(u&&a){var _=Xe(u).hoistableStyles,A=Tn(a);s=s||"default";var j=_.get(A);if(!j){var ee={loading:0,preload:null};if(j=u.querySelector(ds(A)))ee.loading=5;else{a=X({rel:"stylesheet",href:a,"data-precedence":s},o),(o=kr.get(A))&&kl(a,o);var pe=j=u.createElement("link");Ge(pe),Qt(pe,"link",a),pe._p=new Promise(function(Ee,Be){pe.onload=Ee,pe.onerror=Be}),pe.addEventListener("load",function(){ee.loading|=1}),pe.addEventListener("error",function(){ee.loading|=2}),ee.loading|=4,xi(j,s,u)}j={type:"stylesheet",instance:j,count:1,state:ee},_.set(A,j)}}}function Ld(a,s){na.X(a,s);var o=bn;if(o&&a){var u=Xe(o).hoistableScripts,_=wn(a),A=u.get(_);A||(A=o.querySelector(ps(_)),A||(a=X({src:a,async:!0},s),(s=kr.get(_))&&Rl(a,s),A=o.createElement("script"),Ge(A),Qt(A,"link",a),o.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},u.set(_,A))}}function Nd(a,s){na.M(a,s);var o=bn;if(o&&a){var u=Xe(o).hoistableScripts,_=wn(a),A=u.get(_);A||(A=o.querySelector(ps(_)),A||(a=X({src:a,async:!0,type:"module"},s),(s=kr.get(_))&&Rl(a,s),A=o.createElement("script"),Ge(A),Qt(A,"link",a),o.head.appendChild(A)),A={type:"script",instance:A,count:1,state:null},u.set(_,A))}}function lh(a,s,o,u){var _=(_=K.current)?mi(_):null;if(!_)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=Tn(o.href),o=Xe(_).hoistableStyles,u=o.get(s),u||(u={type:"style",instance:null,count:0,state:null},o.set(s,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){a=Tn(o.href);var A=Xe(_).hoistableStyles,j=A.get(a);if(j||(_=_.ownerDocument||_,j={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},A.set(a,j),(A=_.querySelector(ds(a)))&&!A._p&&(j.instance=A,j.state.loading=5),kr.has(a)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},kr.set(a,o),A||Id(_,a,o,j.state))),s&&u===null)throw Error(n(528,""));return j}if(s&&u!==null)throw Error(n(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=wn(o),o=Xe(_).hoistableScripts,u=o.get(s),u||(u={type:"script",instance:null,count:0,state:null},o.set(s,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function Tn(a){return'href="'+xr(a)+'"'}function ds(a){return'link[rel="stylesheet"]['+a+"]"}function ch(a){return X({},a,{"data-precedence":a.precedence,precedence:null})}function Id(a,s,o,u){a.querySelector('link[rel="preload"][as="style"]['+s+"]")?u.loading=1:(s=a.createElement("link"),u.preload=s,s.addEventListener("load",function(){return u.loading|=1}),s.addEventListener("error",function(){return u.loading|=2}),Qt(s,"link",o),Ge(s),a.head.appendChild(s))}function wn(a){return'[src="'+xr(a)+'"]'}function ps(a){return"script[async]"+a}function uh(a,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var u=a.querySelector('style[data-href~="'+xr(o.href)+'"]');if(u)return s.instance=u,Ge(u),u;var _=X({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(a.ownerDocument||a).createElement("style"),Ge(u),Qt(u,"style",_),xi(u,o.precedence,a),s.instance=u;case"stylesheet":_=Tn(o.href);var A=a.querySelector(ds(_));if(A)return s.state.loading|=4,s.instance=A,Ge(A),A;u=ch(o),(_=kr.get(_))&&kl(u,_),A=(a.ownerDocument||a).createElement("link"),Ge(A);var j=A;return j._p=new Promise(function(ee,pe){j.onload=ee,j.onerror=pe}),Qt(A,"link",u),s.state.loading|=4,xi(A,o.precedence,a),s.instance=A;case"script":return A=wn(o.src),(_=a.querySelector(ps(A)))?(s.instance=_,Ge(_),_):(u=o,(_=kr.get(A))&&(u=X({},o),Rl(u,_)),a=a.ownerDocument||a,_=a.createElement("script"),Ge(_),Qt(_,"link",u),a.head.appendChild(_),s.instance=_);case"void":return null;default:throw Error(n(443,s.type))}else s.type==="stylesheet"&&!(s.state.loading&4)&&(u=s.instance,s.state.loading|=4,xi(u,o.precedence,a));return s.instance}function xi(a,s,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),_=u.length?u[u.length-1]:null,A=_,j=0;j<u.length;j++){var ee=u[j];if(ee.dataset.precedence===s)A=ee;else if(A!==_)break}A?A.parentNode.insertBefore(a,A.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(a,s.firstChild))}function kl(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.title==null&&(a.title=s.title)}function Rl(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.integrity==null&&(a.integrity=s.integrity)}var vi=null;function fh(a,s,o){if(vi===null){var u=new Map,_=vi=new Map;_.set(o,u)}else _=vi,u=_.get(o),u||(u=new Map,_.set(o,u));if(u.has(a))return u;for(u.set(a,null),o=o.getElementsByTagName(a),_=0;_<o.length;_++){var A=o[_];if(!(A[Fe]||A[te]||a==="link"&&A.getAttribute("rel")==="stylesheet")&&A.namespaceURI!=="http://www.w3.org/2000/svg"){var j=A.getAttribute(s)||"";j=a+j;var ee=u.get(j);ee?ee.push(A):u.set(j,[A])}}return u}function hh(a,s,o){a=a.ownerDocument||a,a.head.insertBefore(o,s==="title"?a.querySelector("head > title"):null)}function Bd(a,s,o){if(o===1||s.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return a=s.disabled,typeof s.precedence=="string"&&a==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function dh(a){return!(a.type==="stylesheet"&&!(a.state.loading&3))}var gs=null;function Ud(){}function jd(a,s,o){if(gs===null)throw Error(n(475));var u=gs;if(s.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&!(s.state.loading&4)){if(s.instance===null){var _=Tn(o.href),A=a.querySelector(ds(_));if(A){a=A._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(u.count++,u=yi.bind(u),a.then(u,u)),s.state.loading|=4,s.instance=A,Ge(A);return}A=a.ownerDocument||a,o=ch(o),(_=kr.get(_))&&kl(o,_),A=A.createElement("link"),Ge(A);var j=A;j._p=new Promise(function(ee,pe){j.onload=ee,j.onerror=pe}),Qt(A,"link",o),s.instance=A}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(s,a),(a=s.state.preload)&&!(s.state.loading&3)&&(u.count++,s=yi.bind(u),a.addEventListener("load",s),a.addEventListener("error",s))}}function Hd(){if(gs===null)throw Error(n(475));var a=gs;return a.stylesheets&&a.count===0&&Fl(a,a.stylesheets),0<a.count?function(s){var o=setTimeout(function(){if(a.stylesheets&&Fl(a,a.stylesheets),a.unsuspend){var u=a.unsuspend;a.unsuspend=null,u()}},6e4);return a.unsuspend=s,function(){a.unsuspend=null,clearTimeout(o)}}:null}function yi(){if(this.count--,this.count===0){if(this.stylesheets)Fl(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var Ei=null;function Fl(a,s){a.stylesheets=null,a.unsuspend!==null&&(a.count++,Ei=new Map,s.forEach(zd,a),Ei=null,yi.call(a))}function zd(a,s){if(!(s.state.loading&4)){var o=Ei.get(a);if(o)var u=o.get(null);else{o=new Map,Ei.set(a,o);for(var _=a.querySelectorAll("link[data-precedence],style[data-precedence]"),A=0;A<_.length;A++){var j=_[A];(j.nodeName==="LINK"||j.getAttribute("media")!=="not all")&&(o.set(j.dataset.precedence,j),u=j)}u&&o.set(null,u)}_=s.instance,j=_.getAttribute("data-precedence"),A=o.get(j)||u,A===u&&o.set(null,_),o.set(j,_),this.count++,u=yi.bind(this),_.addEventListener("load",u),_.addEventListener("error",u),A?A.parentNode.insertBefore(_,A.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(_,a.firstChild)),s.state.loading|=4}}var _s={$$typeof:S,Provider:null,Consumer:null,_currentValue:U,_currentValue2:U,_threadCount:0};function Vd(a,s,o,u,_,A,j,ee){this.tag=1,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=_r(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_r(0),this.hiddenUpdates=_r(null),this.identifierPrefix=u,this.onUncaughtError=_,this.onCaughtError=A,this.onRecoverableError=j,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ee,this.incompleteTransitions=new Map}function ph(a,s,o,u,_,A,j,ee,pe,Ee,Be,He){return a=new Vd(a,s,o,j,ee,pe,Ee,He),s=1,A===!0&&(s|=24),A=wr(3,null,null,s),a.current=A,A.stateNode=a,s=oo(),s.refCount++,a.pooledCache=s,s.refCount++,A.memoizedState={element:u,isDehydrated:o,cache:s},zo(A),a}function gh(a){return a?(a=an,a):an}function _h(a,s,o,u,_,A){_=gh(_),u.context===null?u.context=_:u.pendingContext=_,u=_a(s),u.payload={element:o},A=A===void 0?null:A,A!==null&&(u.callback=A),o=ma(a,u,s),o!==null&&(nr(o,a,s),Zn(o,a,s))}function mh(a,s){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var o=a.retryLane;a.retryLane=o!==0&&o<s?o:s}}function Ol(a,s){mh(a,s),(a=a.alternate)&&mh(a,s)}function xh(a){if(a.tag===13){var s=ca(a,67108864);s!==null&&nr(s,a,67108864),Ol(a,67108864)}}var Si=!0;function Xd(a,s,o,u){var _=L.T;L.T=null;var A=R.p;try{R.p=2,Dl(a,s,o,u)}finally{R.p=A,L.T=_}}function Gd(a,s,o,u){var _=L.T;L.T=null;var A=R.p;try{R.p=8,Dl(a,s,o,u)}finally{R.p=A,L.T=_}}function Dl(a,s,o,u){if(Si){var _=Pl(u);if(_===null)yl(a,s,u,Ai,o),yh(a,u);else if($d(_,a,s,o,u))u.stopPropagation();else if(yh(a,u),s&4&&-1<qd.indexOf(a)){for(;_!==null;){var A=We(_);if(A!==null)switch(A.tag){case 3:if(A=A.stateNode,A.current.memoizedState.isDehydrated){var j=gt(A.pendingLanes);if(j!==0){var ee=A;for(ee.pendingLanes|=2,ee.entangledLanes|=2;j;){var pe=1<<31-Mt(j);ee.entanglements[1]|=pe,j&=~pe}Ur(A),!(Pt&6)&&(ii=Ce()+500,us(0))}}break;case 13:ee=ca(A,2),ee!==null&&nr(ee,A,2),ci(),Ol(A,2)}if(A=Pl(u),A===null&&yl(a,s,u,Ai,o),A===_)break;_=A}_!==null&&u.stopPropagation()}else yl(a,s,u,null,o)}}function Pl(a){return a=Bi(a),Ml(a)}var Ai=null;function Ml(a){if(Ai=null,a=ze(a),a!==null){var s=fe(a);if(s===null)a=null;else{var o=s.tag;if(o===13){if(a=ae(s),a!==null)return a;a=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;a=null}else s!==a&&(a=null)}}return Ai=a,null}function vh(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(nt()){case tt:return 2;case Je:return 8;case et:case ht:return 32;case Qe:return 268435456;default:return 32}default:return 32}}var Ll=!1,ba=null,Ta=null,wa=null,ms=new Map,xs=new Map,Ca=[],qd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function yh(a,s){switch(a){case"focusin":case"focusout":ba=null;break;case"dragenter":case"dragleave":Ta=null;break;case"mouseover":case"mouseout":wa=null;break;case"pointerover":case"pointerout":ms.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":xs.delete(s.pointerId)}}function vs(a,s,o,u,_,A){return a===null||a.nativeEvent!==A?(a={blockedOn:s,domEventName:o,eventSystemFlags:u,nativeEvent:A,targetContainers:[_]},s!==null&&(s=We(s),s!==null&&xh(s)),a):(a.eventSystemFlags|=u,s=a.targetContainers,_!==null&&s.indexOf(_)===-1&&s.push(_),a)}function $d(a,s,o,u,_){switch(s){case"focusin":return ba=vs(ba,a,s,o,u,_),!0;case"dragenter":return Ta=vs(Ta,a,s,o,u,_),!0;case"mouseover":return wa=vs(wa,a,s,o,u,_),!0;case"pointerover":var A=_.pointerId;return ms.set(A,vs(ms.get(A)||null,a,s,o,u,_)),!0;case"gotpointercapture":return A=_.pointerId,xs.set(A,vs(xs.get(A)||null,a,s,o,u,_)),!0}return!1}function Eh(a){var s=ze(a.target);if(s!==null){var o=fe(s);if(o!==null){if(s=o.tag,s===13){if(s=ae(o),s!==null){a.blockedOn=s,q(a.priority,function(){if(o.tag===13){var u=dr(),_=ca(o,u);_!==null&&nr(_,o,u),Ol(o,u)}});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){a.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}a.blockedOn=null}function bi(a){if(a.blockedOn!==null)return!1;for(var s=a.targetContainers;0<s.length;){var o=Pl(a.nativeEvent);if(o===null){o=a.nativeEvent;var u=new o.constructor(o.type,o);Ii=u,o.target.dispatchEvent(u),Ii=null}else return s=We(o),s!==null&&xh(s),a.blockedOn=o,!1;s.shift()}return!0}function Sh(a,s,o){bi(a)&&o.delete(s)}function Wd(){Ll=!1,ba!==null&&bi(ba)&&(ba=null),Ta!==null&&bi(Ta)&&(Ta=null),wa!==null&&bi(wa)&&(wa=null),ms.forEach(Sh),xs.forEach(Sh)}function Ti(a,s){a.blockedOn===s&&(a.blockedOn=null,Ll||(Ll=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Wd)))}var wi=null;function Ah(a){wi!==a&&(wi=a,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){wi===a&&(wi=null);for(var s=0;s<a.length;s+=3){var o=a[s],u=a[s+1],_=a[s+2];if(typeof u!="function"){if(Ml(u||o)===null)continue;break}var A=We(o);A!==null&&(a.splice(s,3),s-=3,bo(A,{pending:!0,data:_,method:o.method,action:u},u,_))}}))}function ys(a){function s(pe){return Ti(pe,a)}ba!==null&&Ti(ba,a),Ta!==null&&Ti(Ta,a),wa!==null&&Ti(wa,a),ms.forEach(s),xs.forEach(s);for(var o=0;o<Ca.length;o++){var u=Ca[o];u.blockedOn===a&&(u.blockedOn=null)}for(;0<Ca.length&&(o=Ca[0],o.blockedOn===null);)Eh(o),o.blockedOn===null&&Ca.shift();if(o=(a.ownerDocument||a).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var _=o[u],A=o[u+1],j=_[ne]||null;if(typeof A=="function")j||Ah(o);else if(j){var ee=null;if(A&&A.hasAttribute("formAction")){if(_=A,j=A[ne]||null)ee=j.formAction;else if(Ml(_)!==null)continue}else ee=j.action;typeof ee=="function"?o[u+1]=ee:(o.splice(u,3),u-=3),Ah(o)}}}function Nl(a){this._internalRoot=a}Ci.prototype.render=Nl.prototype.render=function(a){var s=this._internalRoot;if(s===null)throw Error(n(409));var o=s.current,u=dr();_h(o,u,a,s,null,null)},Ci.prototype.unmount=Nl.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var s=a.containerInfo;a.tag===0&&En(),_h(a.current,2,null,a,null,null),ci(),s[ue]=null}};function Ci(a){this._internalRoot=a}Ci.prototype.unstable_scheduleHydration=function(a){if(a){var s=ia();a={blockedOn:null,target:a,priority:s};for(var o=0;o<Ca.length&&s!==0&&s<Ca[o].priority;o++);Ca.splice(o,0,a),o===0&&Eh(a)}};var bh=r.version;if(bh!=="19.0.0")throw Error(n(527,bh,"19.0.0"));R.findDOMNode=function(a){var s=a._reactInternals;if(s===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=xe(s),a=a!==null?I(a):null,a=a===null?null:a.stateNode,a};var Yd={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:L,findFiberByHostInstance:ze,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ki=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ki.isDisabled&&ki.supportsFiber)try{st=ki.inject(Yd),ct=ki}catch{}}return reactDomClient_production.createRoot=function(a,s){if(!i(a))throw Error(n(299));var o=!1,u="",_=ju,A=Hu,j=zu,ee=null;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(u=s.identifierPrefix),s.onUncaughtError!==void 0&&(_=s.onUncaughtError),s.onCaughtError!==void 0&&(A=s.onCaughtError),s.onRecoverableError!==void 0&&(j=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(ee=s.unstable_transitionCallbacks)),s=ph(a,1,!1,null,null,o,u,_,A,j,ee,null),a[ue]=s.current,vl(a.nodeType===8?a.parentNode:a),new Nl(s)},reactDomClient_production.hydrateRoot=function(a,s,o){if(!i(a))throw Error(n(299));var u=!1,_="",A=ju,j=Hu,ee=zu,pe=null,Ee=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(_=o.identifierPrefix),o.onUncaughtError!==void 0&&(A=o.onUncaughtError),o.onCaughtError!==void 0&&(j=o.onCaughtError),o.onRecoverableError!==void 0&&(ee=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(pe=o.unstable_transitionCallbacks),o.formState!==void 0&&(Ee=o.formState)),s=ph(a,1,!0,s,o??null,u,_,A,j,ee,pe,Ee),s.context=gh(null),o=s.current,u=dr(),_=_a(u),_.callback=null,ma(o,_,u),s.current.lanes=u,er(s,u),Ur(s),a[ue]=s.current,vl(a),new Ci(s)},reactDomClient_production.version="19.0.0",reactDomClient_production}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client.exports;hasRequiredClient=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),client.exports=requireReactDomClient_production(),client.exports}var clientExports=requireClient();const ReactDOM=getDefaultExportFromCjs(clientExports);var dist={},hasRequiredDist;function requireDist(){if(hasRequiredDist)return dist;hasRequiredDist=1,Object.defineProperty(dist,"__esModule",{value:!0}),dist.parse=c,dist.serialize=h;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,r=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,n=/^[\u0020-\u003A\u003D-\u007E]*$/,i=Object.prototype.toString,l=(()=>{const v=function(){};return v.prototype=Object.create(null),v})();function c(v,S){const x=new l,g=v.length;if(g<2)return x;const m=(S==null?void 0:S.decode)||p;let b=0;do{const D=v.indexOf("=",b);if(D===-1)break;const C=v.indexOf(";",b),F=C===-1?g:C;if(D>F){b=v.lastIndexOf(";",D-1)+1;continue}const T=f(v,b,D),w=d(v,D,T),y=v.slice(T,w);if(x[y]===void 0){let N=f(v,D+1,F),L=d(v,F,N);const X=m(v.slice(N,L));x[y]=X}b=F+1}while(b<g);return x}function f(v,S,x){do{const g=v.charCodeAt(S);if(g!==32&&g!==9)return S}while(++S<x);return x}function d(v,S,x){for(;S>x;){const g=v.charCodeAt(--S);if(g!==32&&g!==9)return S+1}return x}function h(v,S,x){const g=(x==null?void 0:x.encode)||encodeURIComponent;if(!e.test(v))throw new TypeError(`argument name is invalid: ${v}`);const m=g(S);if(!r.test(m))throw new TypeError(`argument val is invalid: ${S}`);let b=v+"="+m;if(!x)return b;if(x.maxAge!==void 0){if(!Number.isInteger(x.maxAge))throw new TypeError(`option maxAge is invalid: ${x.maxAge}`);b+="; Max-Age="+x.maxAge}if(x.domain){if(!t.test(x.domain))throw new TypeError(`option domain is invalid: ${x.domain}`);b+="; Domain="+x.domain}if(x.path){if(!n.test(x.path))throw new TypeError(`option path is invalid: ${x.path}`);b+="; Path="+x.path}if(x.expires){if(!E(x.expires)||!Number.isFinite(x.expires.valueOf()))throw new TypeError(`option expires is invalid: ${x.expires}`);b+="; Expires="+x.expires.toUTCString()}if(x.httpOnly&&(b+="; HttpOnly"),x.secure&&(b+="; Secure"),x.partitioned&&(b+="; Partitioned"),x.priority)switch(typeof x.priority=="string"?x.priority.toLowerCase():void 0){case"low":b+="; Priority=Low";break;case"medium":b+="; Priority=Medium";break;case"high":b+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${x.priority}`)}if(x.sameSite)switch(typeof x.sameSite=="string"?x.sameSite.toLowerCase():x.sameSite){case!0:case"strict":b+="; SameSite=Strict";break;case"lax":b+="; SameSite=Lax";break;case"none":b+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${x.sameSite}`)}return b}function p(v){if(v.indexOf("%")===-1)return v;try{return decodeURIComponent(v)}catch{return v}}function E(v){return i.call(v)==="[object Date]"}return dist}requireDist();/**
 * react-router v7.1.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var PopStateEventType="popstate";function createBrowserHistory(e={}){function r(n,i){let{pathname:l,search:c,hash:f}=n.location;return createLocation("",{pathname:l,search:c,hash:f},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(n,i){return typeof i=="string"?i:createPath(i)}return getUrlBasedHistory(r,t,null,e)}function invariant(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function warning(e,r){if(!e){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function createKey(){return Math.random().toString(36).substring(2,10)}function getHistoryState(e,r){return{usr:e.state,key:e.key,idx:r}}function createLocation(e,r,t=null,n){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof r=="string"?parsePath(r):r,state:t,key:r&&r.key||n||createKey()}}function createPath({pathname:e="/",search:r="",hash:t=""}){return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),t&&t!=="#"&&(e+=t.charAt(0)==="#"?t:"#"+t),e}function parsePath(e){let r={};if(e){let t=e.indexOf("#");t>=0&&(r.hash=e.substring(t),e=e.substring(0,t));let n=e.indexOf("?");n>=0&&(r.search=e.substring(n),e=e.substring(0,n)),e&&(r.pathname=e)}return r}function getUrlBasedHistory(e,r,t,n={}){let{window:i=document.defaultView,v5Compat:l=!1}=n,c=i.history,f="POP",d=null,h=p();h==null&&(h=0,c.replaceState({...c.state,idx:h},""));function p(){return(c.state||{idx:null}).idx}function E(){f="POP";let m=p(),b=m==null?null:m-h;h=m,d&&d({action:f,location:g.location,delta:b})}function v(m,b){f="PUSH";let D=createLocation(g.location,m,b);h=p()+1;let C=getHistoryState(D,h),F=g.createHref(D);try{c.pushState(C,"",F)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;i.location.assign(F)}l&&d&&d({action:f,location:g.location,delta:1})}function S(m,b){f="REPLACE";let D=createLocation(g.location,m,b);h=p();let C=getHistoryState(D,h),F=g.createHref(D);c.replaceState(C,"",F),l&&d&&d({action:f,location:g.location,delta:0})}function x(m){let b=i.location.origin!=="null"?i.location.origin:i.location.href,D=typeof m=="string"?m:createPath(m);return D=D.replace(/ $/,"%20"),invariant(b,`No window.location.(origin|href) available to create URL for href: ${D}`),new URL(D,b)}let g={get action(){return f},get location(){return e(i,c)},listen(m){if(d)throw new Error("A history only accepts one active listener");return i.addEventListener(PopStateEventType,E),d=m,()=>{i.removeEventListener(PopStateEventType,E),d=null}},createHref(m){return r(i,m)},createURL:x,encodeLocation(m){let b=x(m);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:v,replace:S,go(m){return c.go(m)}};return g}function matchRoutes(e,r,t="/"){return matchRoutesImpl(e,r,t,!1)}function matchRoutesImpl(e,r,t,n){let i=typeof r=="string"?parsePath(r):r,l=stripBasename(i.pathname||"/",t);if(l==null)return null;let c=flattenRoutes(e);rankRouteBranches(c);let f=null;for(let d=0;f==null&&d<c.length;++d){let h=decodePath(l);f=matchRouteBranch(c[d],h,n)}return f}function flattenRoutes(e,r=[],t=[],n=""){let i=(l,c,f)=>{let d={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};d.relativePath.startsWith("/")&&(invariant(d.relativePath.startsWith(n),`Absolute route path "${d.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(n.length));let h=joinPaths([n,d.relativePath]),p=t.concat(d);l.children&&l.children.length>0&&(invariant(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),flattenRoutes(l.children,r,p,h)),!(l.path==null&&!l.index)&&r.push({path:h,score:computeScore(h,l.index),routesMeta:p})};return e.forEach((l,c)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))i(l,c);else for(let d of explodeOptionalSegments(l.path))i(l,c,d)}),r}function explodeOptionalSegments(e){let r=e.split("/");if(r.length===0)return[];let[t,...n]=r,i=t.endsWith("?"),l=t.replace(/\?$/,"");if(n.length===0)return i?[l,""]:[l];let c=explodeOptionalSegments(n.join("/")),f=[];return f.push(...c.map(d=>d===""?l:[l,d].join("/"))),i&&f.push(...c),f.map(d=>e.startsWith("/")&&d===""?"/":d)}function rankRouteBranches(e){e.sort((r,t)=>r.score!==t.score?t.score-r.score:compareIndexes(r.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=e=>e==="*";function computeScore(e,r){let t=e.split("/"),n=t.length;return t.some(isSplat)&&(n+=splatPenalty),r&&(n+=indexRouteValue),t.filter(i=>!isSplat(i)).reduce((i,l)=>i+(paramRe.test(l)?dynamicSegmentValue:l===""?emptySegmentValue:staticSegmentValue),n)}function compareIndexes(e,r){return e.length===r.length&&e.slice(0,-1).every((n,i)=>n===r[i])?e[e.length-1]-r[r.length-1]:0}function matchRouteBranch(e,r,t=!1){let{routesMeta:n}=e,i={},l="/",c=[];for(let f=0;f<n.length;++f){let d=n[f],h=f===n.length-1,p=l==="/"?r:r.slice(l.length)||"/",E=matchPath({path:d.relativePath,caseSensitive:d.caseSensitive,end:h},p),v=d.route;if(!E&&h&&t&&!n[n.length-1].route.index&&(E=matchPath({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},p)),!E)return null;Object.assign(i,E.params),c.push({params:i,pathname:joinPaths([l,E.pathname]),pathnameBase:normalizePathname(joinPaths([l,E.pathnameBase])),route:v}),E.pathnameBase!=="/"&&(l=joinPaths([l,E.pathnameBase]))}return c}function matchPath(e,r){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[t,n]=compilePath(e.path,e.caseSensitive,e.end),i=r.match(t);if(!i)return null;let l=i[0],c=l.replace(/(.)\/+$/,"$1"),f=i.slice(1);return{params:n.reduce((h,{paramName:p,isOptional:E},v)=>{if(p==="*"){let x=f[v]||"";c=l.slice(0,l.length-x.length).replace(/(.)\/+$/,"$1")}const S=f[v];return E&&!S?h[p]=void 0:h[p]=(S||"").replace(/%2F/g,"/"),h},{}),pathname:l,pathnameBase:c,pattern:e}}function compilePath(e,r=!1,t=!0){warning(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,f,d)=>(n.push({paramName:f,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,r?void 0:"i"),n]}function decodePath(e){try{return e.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return warning(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${r}).`),e}}function stripBasename(e,r){if(r==="/")return e;if(!e.toLowerCase().startsWith(r.toLowerCase()))return null;let t=r.endsWith("/")?r.length-1:r.length,n=e.charAt(t);return n&&n!=="/"?null:e.slice(t)||"/"}function resolvePath(e,r="/"){let{pathname:t,search:n="",hash:i=""}=typeof e=="string"?parsePath(e):e;return{pathname:t?t.startsWith("/")?t:resolvePathname(t,r):r,search:normalizeSearch(n),hash:normalizeHash(i)}}function resolvePathname(e,r){let t=r.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function getInvalidPathError(e,r,t,n){return`Cannot include a '${e}' character in a manually specified \`to.${r}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function getPathContributingMatches(e){return e.filter((r,t)=>t===0||r.route.path&&r.route.path.length>0)}function getResolveToMatches(e){let r=getPathContributingMatches(e);return r.map((t,n)=>n===r.length-1?t.pathname:t.pathnameBase)}function resolveTo(e,r,t,n=!1){let i;typeof e=="string"?i=parsePath(e):(i={...e},invariant(!i.pathname||!i.pathname.includes("?"),getInvalidPathError("?","pathname","search",i)),invariant(!i.pathname||!i.pathname.includes("#"),getInvalidPathError("#","pathname","hash",i)),invariant(!i.search||!i.search.includes("#"),getInvalidPathError("#","search","hash",i)));let l=e===""||i.pathname==="",c=l?"/":i.pathname,f;if(c==null)f=t;else{let E=r.length-1;if(!n&&c.startsWith("..")){let v=c.split("/");for(;v[0]==="..";)v.shift(),E-=1;i.pathname=v.join("/")}f=E>=0?r[E]:"/"}let d=resolvePath(i,f),h=c&&c!=="/"&&c.endsWith("/"),p=(l||c===".")&&t.endsWith("/");return!d.pathname.endsWith("/")&&(h||p)&&(d.pathname+="/"),d}var joinPaths=e=>e.join("/").replace(/\/\/+/g,"/"),normalizePathname=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,normalizeHash=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function isRouteErrorResponse(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var validMutationMethodsArr=["POST","PUT","PATCH","DELETE"];new Set(validMutationMethodsArr);var validRequestMethodsArr=["GET",...validMutationMethodsArr];new Set(validRequestMethodsArr);var DataRouterContext=reactExports.createContext(null);DataRouterContext.displayName="DataRouter";var DataRouterStateContext=reactExports.createContext(null);DataRouterStateContext.displayName="DataRouterState";var ViewTransitionContext=reactExports.createContext({isTransitioning:!1});ViewTransitionContext.displayName="ViewTransition";var FetchersContext=reactExports.createContext(new Map);FetchersContext.displayName="Fetchers";var AwaitContext=reactExports.createContext(null);AwaitContext.displayName="Await";var NavigationContext=reactExports.createContext(null);NavigationContext.displayName="Navigation";var LocationContext=reactExports.createContext(null);LocationContext.displayName="Location";var RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1});RouteContext.displayName="Route";var RouteErrorContext=reactExports.createContext(null);RouteErrorContext.displayName="RouteError";function useHref(e,{relative:r}={}){invariant(useInRouterContext(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=reactExports.useContext(NavigationContext),{hash:i,pathname:l,search:c}=useResolvedPath(e,{relative:r}),f=l;return t!=="/"&&(f=l==="/"?t:joinPaths([t,l])),n.createHref({pathname:f,search:c,hash:i})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return invariant(useInRouterContext(),"useLocation() may be used only in the context of a <Router> component."),reactExports.useContext(LocationContext).location}var navigateEffectWarning="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function useIsomorphicLayoutEffect(e){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(e)}function useNavigate(){let{isDataRoute:e}=reactExports.useContext(RouteContext);return e?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){invariant(useInRouterContext(),"useNavigate() may be used only in the context of a <Router> component.");let e=reactExports.useContext(DataRouterContext),{basename:r,navigator:t}=reactExports.useContext(NavigationContext),{matches:n}=reactExports.useContext(RouteContext),{pathname:i}=useLocation(),l=JSON.stringify(getResolveToMatches(n)),c=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{c.current=!0}),reactExports.useCallback((d,h={})=>{if(warning(c.current,navigateEffectWarning),!c.current)return;if(typeof d=="number"){t.go(d);return}let p=resolveTo(d,JSON.parse(l),i,h.relative==="path");e==null&&r!=="/"&&(p.pathname=p.pathname==="/"?r:joinPaths([r,p.pathname])),(h.replace?t.replace:t.push)(p,h.state,h)},[r,t,l,i,e])}reactExports.createContext(null);function useResolvedPath(e,{relative:r}={}){let{matches:t}=reactExports.useContext(RouteContext),{pathname:n}=useLocation(),i=JSON.stringify(getResolveToMatches(t));return reactExports.useMemo(()=>resolveTo(e,JSON.parse(i),n,r==="path"),[e,i,n,r])}function useRoutesImpl(e,r,t,n){invariant(useInRouterContext(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=reactExports.useContext(NavigationContext),{matches:l}=reactExports.useContext(RouteContext),c=l[l.length-1],f=c?c.params:{},d=c?c.pathname:"/",h=c?c.pathnameBase:"/",p=c&&c.route;{let b=p&&p.path||"";warningOnce(d,!p||b.endsWith("*")||b.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${b}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${b}"> to <Route path="${b==="/"?"*":`${b}/*`}">.`)}let E=useLocation(),v;v=E;let S=v.pathname||"/",x=S;if(h!=="/"){let b=h.replace(/^\//,"").split("/");x="/"+S.replace(/^\//,"").split("/").slice(b.length).join("/")}let g=matchRoutes(e,{pathname:x});return warning(p||g!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),warning(g==null||g[g.length-1].route.element!==void 0||g[g.length-1].route.Component!==void 0||g[g.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),_renderMatches(g&&g.map(b=>Object.assign({},b,{params:Object.assign({},f,b.params),pathname:joinPaths([h,i.encodeLocation?i.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?h:joinPaths([h,i.encodeLocation?i.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),l,t,n)}function DefaultErrorComponent(){let e=useRouteError(),r=isRouteErrorResponse(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),t=e instanceof Error?e.stack:null,n="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:n},l={padding:"2px 4px",backgroundColor:n},c=null;return console.error("Error handled by React Router default ErrorBoundary:",e),c=reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("p",null," Hey developer "),reactExports.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",reactExports.createElement("code",{style:l},"ErrorBoundary")," or"," ",reactExports.createElement("code",{style:l},"errorElement")," prop on your route.")),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},r),t?reactExports.createElement("pre",{style:i},t):null,c)}var defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null),RenderErrorBoundary=class extends reactExports.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function RenderedRoute({routeContext:e,match:r,children:t}){let n=reactExports.useContext(DataRouterContext);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),reactExports.createElement(RouteContext.Provider,{value:e},t)}function _renderMatches(e,r=[],t=null,n=null){if(e==null){if(!t)return null;if(t.errors)e=t.matches;else if(r.length===0&&!t.initialized&&t.matches.length>0)e=t.matches;else return null}let i=e,l=t==null?void 0:t.errors;if(l!=null){let d=i.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);invariant(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),i=i.slice(0,Math.min(i.length,d+1))}let c=!1,f=-1;if(t)for(let d=0;d<i.length;d++){let h=i[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(f=d),h.route.id){let{loaderData:p,errors:E}=t,v=h.route.loader&&!p.hasOwnProperty(h.route.id)&&(!E||E[h.route.id]===void 0);if(h.route.lazy||v){c=!0,f>=0?i=i.slice(0,f+1):i=[i[0]];break}}}return i.reduceRight((d,h,p)=>{let E,v=!1,S=null,x=null;t&&(E=l&&h.route.id?l[h.route.id]:void 0,S=h.route.errorElement||defaultErrorElement,c&&(f<0&&p===0?(warningOnce("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,x=null):f===p&&(v=!0,x=h.route.hydrateFallbackElement||null)));let g=r.concat(i.slice(0,p+1)),m=()=>{let b;return E?b=S:v?b=x:h.route.Component?b=reactExports.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=d,reactExports.createElement(RenderedRoute,{match:h,routeContext:{outlet:d,matches:g,isDataRoute:t!=null},children:b})};return t&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?reactExports.createElement(RenderErrorBoundary,{location:t.location,revalidation:t.revalidation,component:S,error:E,children:m(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):m()},null)}function getDataRouterConsoleError(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext(e){let r=reactExports.useContext(DataRouterContext);return invariant(r,getDataRouterConsoleError(e)),r}function useDataRouterState(e){let r=reactExports.useContext(DataRouterStateContext);return invariant(r,getDataRouterConsoleError(e)),r}function useRouteContext(e){let r=reactExports.useContext(RouteContext);return invariant(r,getDataRouterConsoleError(e)),r}function useCurrentRouteId(e){let r=useRouteContext(e),t=r.matches[r.matches.length-1];return invariant(t.route.id,`${e} can only be used on routes that contain a unique "id"`),t.route.id}function useRouteId(){return useCurrentRouteId("useRouteId")}function useRouteError(){var n;let e=reactExports.useContext(RouteErrorContext),r=useDataRouterState("useRouteError"),t=useCurrentRouteId("useRouteError");return e!==void 0?e:(n=r.errors)==null?void 0:n[t]}function useNavigateStable(){let{router:e}=useDataRouterContext("useNavigate"),r=useCurrentRouteId("useNavigate"),t=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>{t.current=!0}),reactExports.useCallback(async(i,l={})=>{warning(t.current,navigateEffectWarning),t.current&&(typeof i=="number"?e.navigate(i):await e.navigate(i,{fromRouteId:r,...l}))},[e,r])}var alreadyWarned={};function warningOnce(e,r,t){!r&&!alreadyWarned[e]&&(alreadyWarned[e]=!0,warning(!1,t))}reactExports.memo(DataRoutes);function DataRoutes({routes:e,future:r,state:t}){return useRoutesImpl(e,void 0,t,r)}function Router({basename:e="/",children:r=null,location:t,navigationType:n="POP",navigator:i,static:l=!1}){invariant(!useInRouterContext(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=e.replace(/^\/*/,"/"),f=reactExports.useMemo(()=>({basename:c,navigator:i,static:l,future:{}}),[c,i,l]);typeof t=="string"&&(t=parsePath(t));let{pathname:d="/",search:h="",hash:p="",state:E=null,key:v="default"}=t,S=reactExports.useMemo(()=>{let x=stripBasename(d,c);return x==null?null:{location:{pathname:x,search:h,hash:p,state:E,key:v},navigationType:n}},[c,d,h,p,E,v,n]);return warning(S!=null,`<Router basename="${c}"> is not able to match the URL "${d}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:reactExports.createElement(NavigationContext.Provider,{value:f},reactExports.createElement(LocationContext.Provider,{children:r,value:S}))}var defaultMethod="get",defaultEncType="application/x-www-form-urlencoded";function isHtmlElement(e){return e!=null&&typeof e.tagName=="string"}function isButtonElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="button"}function isFormElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="form"}function isInputElement(e){return isHtmlElement(e)&&e.tagName.toLowerCase()==="input"}function isModifiedEvent(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function shouldProcessLinkClick(e,r){return e.button===0&&(!r||r==="_self")&&!isModifiedEvent(e)}var _formDataSupportsSubmitter=null;function isFormDataSubmitterSupported(){if(_formDataSupportsSubmitter===null)try{new FormData(document.createElement("form"),0),_formDataSupportsSubmitter=!1}catch{_formDataSupportsSubmitter=!0}return _formDataSupportsSubmitter}var supportedFormEncTypes=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function getFormEncType(e){return e!=null&&!supportedFormEncTypes.has(e)?(warning(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${defaultEncType}"`),null):e}function getFormSubmissionInfo(e,r){let t,n,i,l,c;if(isFormElement(e)){let f=e.getAttribute("action");n=f?stripBasename(f,r):null,t=e.getAttribute("method")||defaultMethod,i=getFormEncType(e.getAttribute("enctype"))||defaultEncType,l=new FormData(e)}else if(isButtonElement(e)||isInputElement(e)&&(e.type==="submit"||e.type==="image")){let f=e.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=e.getAttribute("formaction")||f.getAttribute("action");if(n=d?stripBasename(d,r):null,t=e.getAttribute("formmethod")||f.getAttribute("method")||defaultMethod,i=getFormEncType(e.getAttribute("formenctype"))||getFormEncType(f.getAttribute("enctype"))||defaultEncType,l=new FormData(f,e),!isFormDataSubmitterSupported()){let{name:h,type:p,value:E}=e;if(p==="image"){let v=h?`${h}.`:"";l.append(`${v}x`,"0"),l.append(`${v}y`,"0")}else h&&l.append(h,E)}}else{if(isHtmlElement(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=defaultMethod,n=null,i=defaultEncType,c=e}return l&&i==="text/plain"&&(c=l,l=void 0),{action:n,method:t.toLowerCase(),encType:i,formData:l,body:c}}function invariant2(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}async function loadRouteModule(e,r){if(e.id in r)return r[e.id];try{let t=await import(e.module);return r[e.id]=t,t}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function isHtmlLinkDescriptor(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function getKeyedPrefetchLinks(e,r,t){let n=await Promise.all(e.map(async i=>{let l=r.routes[i.route.id];if(l){let c=await loadRouteModule(l,t);return c.links?c.links():[]}return[]}));return dedupeLinkDescriptors(n.flat(1).filter(isHtmlLinkDescriptor).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function getNewMatchesForLinks(e,r,t,n,i,l){let c=(d,h)=>t[h]?d.route.id!==t[h].route.id:!0,f=(d,h)=>{var p;return t[h].pathname!==d.pathname||((p=t[h].route.path)==null?void 0:p.endsWith("*"))&&t[h].params["*"]!==d.params["*"]};return l==="assets"?r.filter((d,h)=>c(d,h)||f(d,h)):l==="data"?r.filter((d,h)=>{var E;let p=n.routes[d.route.id];if(!p||!p.hasLoader)return!1;if(c(d,h)||f(d,h))return!0;if(d.route.shouldRevalidate){let v=d.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((E=t[0])==null?void 0:E.params)||{},nextUrl:new URL(e,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function getModuleLinkHrefs(e,r){return dedupeHrefs(e.map(t=>{let n=r.routes[t.route.id];if(!n)return[];let i=[n.module];return n.imports&&(i=i.concat(n.imports)),i}).flat(1))}function dedupeHrefs(e){return[...new Set(e)]}function sortKeys(e){let r={},t=Object.keys(e).sort();for(let n of t)r[n]=e[n];return r}function dedupeLinkDescriptors(e,r){let t=new Set;return new Set(r),e.reduce((n,i)=>{let l=JSON.stringify(sortKeys(i));return t.has(l)||(t.add(l),n.push({key:l,link:i})),n},[])}function singleFetchUrl(e){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname="_root.data":r.pathname=`${r.pathname.replace(/\/$/,"")}.data`,r}function useDataRouterContext2(){let e=reactExports.useContext(DataRouterContext);return invariant2(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function useDataRouterStateContext(){let e=reactExports.useContext(DataRouterStateContext);return invariant2(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var FrameworkContext=reactExports.createContext(void 0);FrameworkContext.displayName="FrameworkContext";function useFrameworkContext(){let e=reactExports.useContext(FrameworkContext);return invariant2(e,"You must render this element inside a <HydratedRouter> element"),e}function usePrefetchBehavior(e,r){let t=reactExports.useContext(FrameworkContext),[n,i]=reactExports.useState(!1),[l,c]=reactExports.useState(!1),{onFocus:f,onBlur:d,onMouseEnter:h,onMouseLeave:p,onTouchStart:E}=r,v=reactExports.useRef(null);reactExports.useEffect(()=>{if(e==="render"&&c(!0),e==="viewport"){let g=b=>{b.forEach(D=>{c(D.isIntersecting)})},m=new IntersectionObserver(g,{threshold:.5});return v.current&&m.observe(v.current),()=>{m.disconnect()}}},[e]),reactExports.useEffect(()=>{if(n){let g=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(g)}}},[n]);let S=()=>{i(!0)},x=()=>{i(!1),c(!1)};return t?e!=="intent"?[l,v,{}]:[l,v,{onFocus:composeEventHandlers(f,S),onBlur:composeEventHandlers(d,x),onMouseEnter:composeEventHandlers(h,S),onMouseLeave:composeEventHandlers(p,x),onTouchStart:composeEventHandlers(E,S)}]:[!1,v,{}]}function composeEventHandlers(e,r){return t=>{e&&e(t),t.defaultPrevented||r(t)}}function PrefetchPageLinks({page:e,...r}){let{router:t}=useDataRouterContext2(),n=reactExports.useMemo(()=>matchRoutes(t.routes,e,t.basename),[t.routes,e,t.basename]);return n?reactExports.createElement(PrefetchPageLinksImpl,{page:e,matches:n,...r}):null}function useKeyedPrefetchLinks(e){let{manifest:r,routeModules:t}=useFrameworkContext(),[n,i]=reactExports.useState([]);return reactExports.useEffect(()=>{let l=!1;return getKeyedPrefetchLinks(e,r,t).then(c=>{l||i(c)}),()=>{l=!0}},[e,r,t]),n}function PrefetchPageLinksImpl({page:e,matches:r,...t}){let n=useLocation(),{manifest:i,routeModules:l}=useFrameworkContext(),{loaderData:c,matches:f}=useDataRouterStateContext(),d=reactExports.useMemo(()=>getNewMatchesForLinks(e,r,f,i,n,"data"),[e,r,f,i,n]),h=reactExports.useMemo(()=>getNewMatchesForLinks(e,r,f,i,n,"assets"),[e,r,f,i,n]),p=reactExports.useMemo(()=>{if(e===n.pathname+n.search+n.hash)return[];let S=new Set,x=!1;if(r.forEach(m=>{var D;let b=i.routes[m.route.id];!b||!b.hasLoader||(!d.some(C=>C.route.id===m.route.id)&&m.route.id in c&&((D=l[m.route.id])!=null&&D.shouldRevalidate)||b.hasClientLoader?x=!0:S.add(m.route.id))}),S.size===0)return[];let g=singleFetchUrl(e);return x&&S.size>0&&g.searchParams.set("_routes",r.filter(m=>S.has(m.route.id)).map(m=>m.route.id).join(",")),[g.pathname+g.search]},[c,n,i,d,r,e,l]),E=reactExports.useMemo(()=>getModuleLinkHrefs(h,i),[h,i]),v=useKeyedPrefetchLinks(h);return reactExports.createElement(reactExports.Fragment,null,p.map(S=>reactExports.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...t})),E.map(S=>reactExports.createElement("link",{key:S,rel:"modulepreload",href:S,...t})),v.map(({key:S,link:x})=>reactExports.createElement("link",{key:S,...x})))}function mergeRefs(...e){return r=>{e.forEach(t=>{typeof t=="function"?t(r):t!=null&&(t.current=r)})}}var isBrowser$1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{isBrowser$1&&(window.__reactRouterVersion="7.1.3")}catch{}function BrowserRouter({basename:e,children:r,window:t}){let n=reactExports.useRef();n.current==null&&(n.current=createBrowserHistory({window:t,v5Compat:!0}));let i=n.current,[l,c]=reactExports.useState({action:i.action,location:i.location}),f=reactExports.useCallback(d=>{reactExports.startTransition(()=>c(d))},[c]);return reactExports.useLayoutEffect(()=>i.listen(f),[i,f]),reactExports.createElement(Router,{basename:e,children:r,location:l.location,navigationType:l.action,navigator:i})}var ABSOLUTE_URL_REGEX2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function({onClick:r,discover:t="render",prefetch:n="none",relative:i,reloadDocument:l,replace:c,state:f,target:d,to:h,preventScrollReset:p,viewTransition:E,...v},S){let{basename:x}=reactExports.useContext(NavigationContext),g=typeof h=="string"&&ABSOLUTE_URL_REGEX2.test(h),m,b=!1;if(typeof h=="string"&&g&&(m=h,isBrowser$1))try{let L=new URL(window.location.href),X=h.startsWith("//")?new URL(L.protocol+h):new URL(h),z=stripBasename(X.pathname,x);X.origin===L.origin&&z!=null?h=z+X.search+X.hash:b=!0}catch{warning(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let D=useHref(h,{relative:i}),[C,F,T]=usePrefetchBehavior(n,v),w=useLinkClickHandler(h,{replace:c,state:f,target:d,preventScrollReset:p,relative:i,viewTransition:E});function y(L){r&&r(L),L.defaultPrevented||w(L)}let N=reactExports.createElement("a",{...v,...T,href:m||D,onClick:b||l?r:y,ref:mergeRefs(S,F),target:d,"data-discover":!g&&t==="render"?"true":void 0});return C&&!g?reactExports.createElement(reactExports.Fragment,null,N,reactExports.createElement(PrefetchPageLinks,{page:D})):N});Link.displayName="Link";var NavLink=reactExports.forwardRef(function({"aria-current":r="page",caseSensitive:t=!1,className:n="",end:i=!1,style:l,to:c,viewTransition:f,children:d,...h},p){let E=useResolvedPath(c,{relative:h.relative}),v=useLocation(),S=reactExports.useContext(DataRouterStateContext),{navigator:x,basename:g}=reactExports.useContext(NavigationContext),m=S!=null&&useViewTransitionState(E)&&f===!0,b=x.encodeLocation?x.encodeLocation(E).pathname:E.pathname,D=v.pathname,C=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;t||(D=D.toLowerCase(),C=C?C.toLowerCase():null,b=b.toLowerCase()),C&&g&&(C=stripBasename(C,g)||C);const F=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let T=D===b||!i&&D.startsWith(b)&&D.charAt(F)==="/",w=C!=null&&(C===b||!i&&C.startsWith(b)&&C.charAt(b.length)==="/"),y={isActive:T,isPending:w,isTransitioning:m},N=T?r:void 0,L;typeof n=="function"?L=n(y):L=[n,T?"active":null,w?"pending":null,m?"transitioning":null].filter(Boolean).join(" ");let X=typeof l=="function"?l(y):l;return reactExports.createElement(Link,{...h,"aria-current":N,className:L,ref:p,style:X,to:c,viewTransition:f},typeof d=="function"?d(y):d)});NavLink.displayName="NavLink";var Form=reactExports.forwardRef(({discover:e="render",fetcherKey:r,navigate:t,reloadDocument:n,replace:i,state:l,method:c=defaultMethod,action:f,onSubmit:d,relative:h,preventScrollReset:p,viewTransition:E,...v},S)=>{let x=useSubmit(),g=useFormAction(f,{relative:h}),m=c.toLowerCase()==="get"?"get":"post",b=typeof f=="string"&&ABSOLUTE_URL_REGEX2.test(f),D=C=>{if(d&&d(C),C.defaultPrevented)return;C.preventDefault();let F=C.nativeEvent.submitter,T=(F==null?void 0:F.getAttribute("formmethod"))||c;x(F||C.currentTarget,{fetcherKey:r,method:T,navigate:t,replace:i,state:l,relative:h,preventScrollReset:p,viewTransition:E})};return reactExports.createElement("form",{ref:S,method:m,action:g,onSubmit:n?d:D,...v,"data-discover":!b&&e==="render"?"true":void 0})});Form.displayName="Form";function getDataRouterConsoleError2(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function useDataRouterContext3(e){let r=reactExports.useContext(DataRouterContext);return invariant(r,getDataRouterConsoleError2(e)),r}function useLinkClickHandler(e,{target:r,replace:t,state:n,preventScrollReset:i,relative:l,viewTransition:c}={}){let f=useNavigate(),d=useLocation(),h=useResolvedPath(e,{relative:l});return reactExports.useCallback(p=>{if(shouldProcessLinkClick(p,r)){p.preventDefault();let E=t!==void 0?t:createPath(d)===createPath(h);f(e,{replace:E,state:n,preventScrollReset:i,relative:l,viewTransition:c})}},[d,f,h,t,n,r,e,i,l,c])}var fetcherId=0,getUniqueFetcherId=()=>`__${String(++fetcherId)}__`;function useSubmit(){let{router:e}=useDataRouterContext3("useSubmit"),{basename:r}=reactExports.useContext(NavigationContext),t=useRouteId();return reactExports.useCallback(async(n,i={})=>{let{action:l,method:c,encType:f,formData:d,body:h}=getFormSubmissionInfo(n,r);if(i.navigate===!1){let p=i.fetcherKey||getUniqueFetcherId();await e.fetch(p,t,i.action||l,{preventScrollReset:i.preventScrollReset,formData:d,body:h,formMethod:i.method||c,formEncType:i.encType||f,flushSync:i.flushSync})}else await e.navigate(i.action||l,{preventScrollReset:i.preventScrollReset,formData:d,body:h,formMethod:i.method||c,formEncType:i.encType||f,replace:i.replace,state:i.state,fromRouteId:t,flushSync:i.flushSync,viewTransition:i.viewTransition})},[e,r,t])}function useFormAction(e,{relative:r}={}){let{basename:t}=reactExports.useContext(NavigationContext),n=reactExports.useContext(RouteContext);invariant(n,"useFormAction must be used inside a RouteContext");let[i]=n.matches.slice(-1),l={...useResolvedPath(e||".",{relative:r})},c=useLocation();if(e==null){l.search=c.search;let f=new URLSearchParams(l.search),d=f.getAll("index");if(d.some(p=>p==="")){f.delete("index"),d.filter(E=>E).forEach(E=>f.append("index",E));let p=f.toString();l.search=p?`?${p}`:""}}return(!e||e===".")&&i.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(l.pathname=l.pathname==="/"?t:joinPaths([t,l.pathname])),createPath(l)}function useViewTransitionState(e,r={}){let t=reactExports.useContext(ViewTransitionContext);invariant(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=useDataRouterContext3("useViewTransitionState"),i=useResolvedPath(e,{relative:r.relative});if(!t.isTransitioning)return!1;let l=stripBasename(t.currentLocation.pathname,n)||t.currentLocation.pathname,c=stripBasename(t.nextLocation.pathname,n)||t.nextLocation.pathname;return matchPath(i.pathname,c)!=null||matchPath(i.pathname,l)!=null}new TextEncoder;const scriptRel="modulepreload",assetsURL=function(e){return"/"+e},seen={},__vitePreload=function(r,t,n){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),f=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));i=Promise.allSettled(t.map(d=>{if(d=assetsURL(d),d in seen)return;seen[d]=!0;const h=d.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${p}`))return;const E=document.createElement("link");if(E.rel=h?"stylesheet":scriptRel,h||(E.as="script"),E.crossOrigin="",E.href=d,f&&E.setAttribute("nonce",f),document.head.appendChild(E),h)return new Promise((v,S)=>{E.addEventListener("load",v),E.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${d}`)))})}))}function l(c){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=c,window.dispatchEvent(f),!f.defaultPrevented)throw c}return i.then(c=>{for(const f of c||[])f.status==="rejected"&&l(f.reason);return r().catch(l)})},resolveFetch$3=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>__vitePreload(async()=>{const{default:n}=await Promise.resolve().then(()=>browser);return{default:n}},[]).then(({default:n})=>n(...t)):r=fetch,(...t)=>r(...t)};class FunctionsError extends Error{constructor(r,t="FunctionsError",n){super(r),this.name=t,this.context=n}}class FunctionsFetchError extends FunctionsError{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class FunctionsRelayError extends FunctionsError{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class FunctionsHttpError extends FunctionsError{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var FunctionRegion;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(FunctionRegion||(FunctionRegion={}));var __awaiter$7=function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(p){try{h(n.next(p))}catch(E){c(E)}}function d(p){try{h(n.throw(p))}catch(E){c(E)}}function h(p){p.done?l(p.value):i(p.value).then(f,d)}h((n=n.apply(e,r||[])).next())})};class FunctionsClient{constructor(r,{headers:t={},customFetch:n,region:i=FunctionRegion.Any}={}){this.url=r,this.headers=t,this.region=i,this.fetch=resolveFetch$3(n)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r,t={}){var n;return __awaiter$7(this,void 0,void 0,function*(){try{const{headers:i,method:l,body:c}=t;let f={},{region:d}=t;d||(d=this.region),d&&d!=="any"&&(f["x-region"]=d);let h;c&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",h=c):typeof c=="string"?(f["Content-Type"]="text/plain",h=c):typeof FormData<"u"&&c instanceof FormData?h=c:(f["Content-Type"]="application/json",h=JSON.stringify(c)));const p=yield this.fetch(`${this.url}/${r}`,{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),i),body:h}).catch(x=>{throw new FunctionsFetchError(x)}),E=p.headers.get("x-relay-error");if(E&&E==="true")throw new FunctionsRelayError(p);if(!p.ok)throw new FunctionsHttpError(p);let v=((n=p.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),S;return v==="application/json"?S=yield p.json():v==="application/octet-stream"?S=yield p.blob():v==="text/event-stream"?S=p:v==="multipart/form-data"?S=yield p.formData():S=yield p.text(),{data:S,error:null}}catch(i){return{data:null,error:i}}})}}var cjs={},PostgrestClient$1={},PostgrestQueryBuilder$1={},PostgrestFilterBuilder$1={},PostgrestTransformBuilder$1={},PostgrestBuilder$1={},getGlobal=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},globalObject=getGlobal();const fetch$1=globalObject.fetch,nodeFetch=globalObject.fetch.bind(globalObject),Headers$1=globalObject.Headers,Request=globalObject.Request,Response$1=globalObject.Response,browser=Object.freeze(Object.defineProperty({__proto__:null,Headers:Headers$1,Request,Response:Response$1,default:nodeFetch,fetch:fetch$1},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(browser);var PostgrestError$1={},hasRequiredPostgrestError;function requirePostgrestError(){if(hasRequiredPostgrestError)return PostgrestError$1;hasRequiredPostgrestError=1,Object.defineProperty(PostgrestError$1,"__esModule",{value:!0});class e extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return PostgrestError$1.default=e,PostgrestError$1}var hasRequiredPostgrestBuilder;function requirePostgrestBuilder(){if(hasRequiredPostgrestBuilder)return PostgrestBuilder$1;hasRequiredPostgrestBuilder=1;var e=PostgrestBuilder$1.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(PostgrestBuilder$1,"__esModule",{value:!0});const r=e(require$$0),t=e(requirePostgrestError());class n{constructor(l){this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=l.headers,this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=l.shouldThrowOnError,this.signal=l.signal,this.isMaybeSingle=l.isMaybeSingle,l.fetch?this.fetch=l.fetch:typeof fetch>"u"?this.fetch=r.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,c){return this.headers=Object.assign({},this.headers),this.headers[l]=c,this}then(l,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const f=this.fetch;let d=f(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async h=>{var p,E,v;let S=null,x=null,g=null,m=h.status,b=h.statusText;if(h.ok){if(this.method!=="HEAD"){const T=await h.text();T===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?x=T:x=JSON.parse(T))}const C=(p=this.headers.Prefer)===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),F=(E=h.headers.get("content-range"))===null||E===void 0?void 0:E.split("/");C&&F&&F.length>1&&(g=parseInt(F[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(x)&&(x.length>1?(S={code:"PGRST116",details:`Results contain ${x.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},x=null,g=null,m=406,b="Not Acceptable"):x.length===1?x=x[0]:x=null)}else{const C=await h.text();try{S=JSON.parse(C),Array.isArray(S)&&h.status===404&&(x=[],S=null,m=200,b="OK")}catch{h.status===404&&C===""?(m=204,b="No Content"):S={message:C}}if(S&&this.isMaybeSingle&&(!((v=S==null?void 0:S.details)===null||v===void 0)&&v.includes("0 rows"))&&(S=null,m=200,b="OK"),S&&this.shouldThrowOnError)throw new t.default(S)}return{error:S,data:x,count:g,status:m,statusText:b}});return this.shouldThrowOnError||(d=d.catch(h=>{var p,E,v;return{error:{message:`${(p=h==null?void 0:h.name)!==null&&p!==void 0?p:"FetchError"}: ${h==null?void 0:h.message}`,details:`${(E=h==null?void 0:h.stack)!==null&&E!==void 0?E:""}`,hint:"",code:`${(v=h==null?void 0:h.code)!==null&&v!==void 0?v:""}`},data:null,count:null,status:0,statusText:""}})),d.then(l,c)}}return PostgrestBuilder$1.default=n,PostgrestBuilder$1}var hasRequiredPostgrestTransformBuilder;function requirePostgrestTransformBuilder(){if(hasRequiredPostgrestTransformBuilder)return PostgrestTransformBuilder$1;hasRequiredPostgrestTransformBuilder=1;var e=PostgrestTransformBuilder$1.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(PostgrestTransformBuilder$1,"__esModule",{value:!0});const r=e(requirePostgrestBuilder());class t extends r.default{select(i){let l=!1;const c=(i??"*").split("").map(f=>/\s/.test(f)&&!l?"":(f==='"'&&(l=!l),f)).join("");return this.url.searchParams.set("select",c),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(i,{ascending:l=!0,nullsFirst:c,foreignTable:f,referencedTable:d=f}={}){const h=d?`${d}.order`:"order",p=this.url.searchParams.get(h);return this.url.searchParams.set(h,`${p?`${p},`:""}${i}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:l,referencedTable:c=l}={}){const f=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(f,`${i}`),this}range(i,l,{foreignTable:c,referencedTable:f=c}={}){const d=typeof f>"u"?"offset":`${f}.offset`,h=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(d,`${i}`),this.url.searchParams.set(h,`${l-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:i=!1,verbose:l=!1,settings:c=!1,buffers:f=!1,wal:d=!1,format:h="text"}={}){var p;const E=[i?"analyze":null,l?"verbose":null,c?"settings":null,f?"buffers":null,d?"wal":null].filter(Boolean).join("|"),v=(p=this.headers.Accept)!==null&&p!==void 0?p:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${h}; for="${v}"; options=${E};`,h==="json"?this:this}rollback(){var i;return((i=this.headers.Prefer)!==null&&i!==void 0?i:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return PostgrestTransformBuilder$1.default=t,PostgrestTransformBuilder$1}var hasRequiredPostgrestFilterBuilder;function requirePostgrestFilterBuilder(){if(hasRequiredPostgrestFilterBuilder)return PostgrestFilterBuilder$1;hasRequiredPostgrestFilterBuilder=1;var e=PostgrestFilterBuilder$1.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(PostgrestFilterBuilder$1,"__esModule",{value:!0});const r=e(requirePostgrestTransformBuilder());class t extends r.default{eq(i,l){return this.url.searchParams.append(i,`eq.${l}`),this}neq(i,l){return this.url.searchParams.append(i,`neq.${l}`),this}gt(i,l){return this.url.searchParams.append(i,`gt.${l}`),this}gte(i,l){return this.url.searchParams.append(i,`gte.${l}`),this}lt(i,l){return this.url.searchParams.append(i,`lt.${l}`),this}lte(i,l){return this.url.searchParams.append(i,`lte.${l}`),this}like(i,l){return this.url.searchParams.append(i,`like.${l}`),this}likeAllOf(i,l){return this.url.searchParams.append(i,`like(all).{${l.join(",")}}`),this}likeAnyOf(i,l){return this.url.searchParams.append(i,`like(any).{${l.join(",")}}`),this}ilike(i,l){return this.url.searchParams.append(i,`ilike.${l}`),this}ilikeAllOf(i,l){return this.url.searchParams.append(i,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(i,l){return this.url.searchParams.append(i,`ilike(any).{${l.join(",")}}`),this}is(i,l){return this.url.searchParams.append(i,`is.${l}`),this}in(i,l){const c=Array.from(new Set(l)).map(f=>typeof f=="string"&&new RegExp("[,()]").test(f)?`"${f}"`:`${f}`).join(",");return this.url.searchParams.append(i,`in.(${c})`),this}contains(i,l){return typeof l=="string"?this.url.searchParams.append(i,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(i,`cs.{${l.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(l)}`),this}containedBy(i,l){return typeof l=="string"?this.url.searchParams.append(i,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(i,`cd.{${l.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(l)}`),this}rangeGt(i,l){return this.url.searchParams.append(i,`sr.${l}`),this}rangeGte(i,l){return this.url.searchParams.append(i,`nxl.${l}`),this}rangeLt(i,l){return this.url.searchParams.append(i,`sl.${l}`),this}rangeLte(i,l){return this.url.searchParams.append(i,`nxr.${l}`),this}rangeAdjacent(i,l){return this.url.searchParams.append(i,`adj.${l}`),this}overlaps(i,l){return typeof l=="string"?this.url.searchParams.append(i,`ov.${l}`):this.url.searchParams.append(i,`ov.{${l.join(",")}}`),this}textSearch(i,l,{config:c,type:f}={}){let d="";f==="plain"?d="pl":f==="phrase"?d="ph":f==="websearch"&&(d="w");const h=c===void 0?"":`(${c})`;return this.url.searchParams.append(i,`${d}fts${h}.${l}`),this}match(i){return Object.entries(i).forEach(([l,c])=>{this.url.searchParams.append(l,`eq.${c}`)}),this}not(i,l,c){return this.url.searchParams.append(i,`not.${l}.${c}`),this}or(i,{foreignTable:l,referencedTable:c=l}={}){const f=c?`${c}.or`:"or";return this.url.searchParams.append(f,`(${i})`),this}filter(i,l,c){return this.url.searchParams.append(i,`${l}.${c}`),this}}return PostgrestFilterBuilder$1.default=t,PostgrestFilterBuilder$1}var hasRequiredPostgrestQueryBuilder;function requirePostgrestQueryBuilder(){if(hasRequiredPostgrestQueryBuilder)return PostgrestQueryBuilder$1;hasRequiredPostgrestQueryBuilder=1;var e=PostgrestQueryBuilder$1.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(PostgrestQueryBuilder$1,"__esModule",{value:!0});const r=e(requirePostgrestFilterBuilder());class t{constructor(i,{headers:l={},schema:c,fetch:f}){this.url=i,this.headers=l,this.schema=c,this.fetch=f}select(i,{head:l=!1,count:c}={}){const f=l?"HEAD":"GET";let d=!1;const h=(i??"*").split("").map(p=>/\s/.test(p)&&!d?"":(p==='"'&&(d=!d),p)).join("");return this.url.searchParams.set("select",h),c&&(this.headers.Prefer=`count=${c}`),new r.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(i,{count:l,defaultToNull:c=!0}={}){const f="POST",d=[];if(this.headers.Prefer&&d.push(this.headers.Prefer),l&&d.push(`count=${l}`),c||d.push("missing=default"),this.headers.Prefer=d.join(","),Array.isArray(i)){const h=i.reduce((p,E)=>p.concat(Object.keys(E)),[]);if(h.length>0){const p=[...new Set(h)].map(E=>`"${E}"`);this.url.searchParams.set("columns",p.join(","))}}return new r.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}upsert(i,{onConflict:l,ignoreDuplicates:c=!1,count:f,defaultToNull:d=!0}={}){const h="POST",p=[`resolution=${c?"ignore":"merge"}-duplicates`];if(l!==void 0&&this.url.searchParams.set("on_conflict",l),this.headers.Prefer&&p.push(this.headers.Prefer),f&&p.push(`count=${f}`),d||p.push("missing=default"),this.headers.Prefer=p.join(","),Array.isArray(i)){const E=i.reduce((v,S)=>v.concat(Object.keys(S)),[]);if(E.length>0){const v=[...new Set(E)].map(S=>`"${S}"`);this.url.searchParams.set("columns",v.join(","))}}return new r.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}update(i,{count:l}={}){const c="PATCH",f=[];return this.headers.Prefer&&f.push(this.headers.Prefer),l&&f.push(`count=${l}`),this.headers.Prefer=f.join(","),new r.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:this.fetch,allowEmpty:!1})}delete({count:i}={}){const l="DELETE",c=[];return i&&c.push(`count=${i}`),this.headers.Prefer&&c.unshift(this.headers.Prefer),this.headers.Prefer=c.join(","),new r.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return PostgrestQueryBuilder$1.default=t,PostgrestQueryBuilder$1}var constants={},version$4={},hasRequiredVersion;function requireVersion(){return hasRequiredVersion||(hasRequiredVersion=1,Object.defineProperty(version$4,"__esModule",{value:!0}),version$4.version=void 0,version$4.version="0.0.0-automated"),version$4}var hasRequiredConstants;function requireConstants(){if(hasRequiredConstants)return constants;hasRequiredConstants=1,Object.defineProperty(constants,"__esModule",{value:!0}),constants.DEFAULT_HEADERS=void 0;const e=requireVersion();return constants.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${e.version}`},constants}var hasRequiredPostgrestClient;function requirePostgrestClient(){if(hasRequiredPostgrestClient)return PostgrestClient$1;hasRequiredPostgrestClient=1;var e=PostgrestClient$1.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(PostgrestClient$1,"__esModule",{value:!0});const r=e(requirePostgrestQueryBuilder()),t=e(requirePostgrestFilterBuilder()),n=requireConstants();class i{constructor(c,{headers:f={},schema:d,fetch:h}={}){this.url=c,this.headers=Object.assign(Object.assign({},n.DEFAULT_HEADERS),f),this.schemaName=d,this.fetch=h}from(c){const f=new URL(`${this.url}/${c}`);return new r.default(f,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(c){return new i(this.url,{headers:this.headers,schema:c,fetch:this.fetch})}rpc(c,f={},{head:d=!1,get:h=!1,count:p}={}){let E;const v=new URL(`${this.url}/rpc/${c}`);let S;d||h?(E=d?"HEAD":"GET",Object.entries(f).filter(([g,m])=>m!==void 0).map(([g,m])=>[g,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([g,m])=>{v.searchParams.append(g,m)})):(E="POST",S=f);const x=Object.assign({},this.headers);return p&&(x.Prefer=`count=${p}`),new t.default({method:E,url:v,headers:x,schema:this.schemaName,body:S,fetch:this.fetch,allowEmpty:!1})}}return PostgrestClient$1.default=i,PostgrestClient$1}var hasRequiredCjs;function requireCjs(){if(hasRequiredCjs)return cjs;hasRequiredCjs=1;var e=cjs.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(cjs,"__esModule",{value:!0}),cjs.PostgrestError=cjs.PostgrestBuilder=cjs.PostgrestTransformBuilder=cjs.PostgrestFilterBuilder=cjs.PostgrestQueryBuilder=cjs.PostgrestClient=void 0;const r=e(requirePostgrestClient());cjs.PostgrestClient=r.default;const t=e(requirePostgrestQueryBuilder());cjs.PostgrestQueryBuilder=t.default;const n=e(requirePostgrestFilterBuilder());cjs.PostgrestFilterBuilder=n.default;const i=e(requirePostgrestTransformBuilder());cjs.PostgrestTransformBuilder=i.default;const l=e(requirePostgrestBuilder());cjs.PostgrestBuilder=l.default;const c=e(requirePostgrestError());return cjs.PostgrestError=c.default,cjs.default={PostgrestClient:r.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:i.default,PostgrestBuilder:l.default,PostgrestError:c.default},cjs}var cjsExports=requireCjs();const index=getDefaultExportFromCjs(cjsExports),{PostgrestClient,PostgrestQueryBuilder,PostgrestFilterBuilder,PostgrestTransformBuilder,PostgrestBuilder,PostgrestError}=index,version$3="2.11.2",DEFAULT_HEADERS$3={"X-Client-Info":`realtime-js/${version$3}`},VSN="1.0.0",DEFAULT_TIMEOUT=1e4,WS_CLOSE_NORMAL=1e3;var SOCKET_STATES;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(SOCKET_STATES||(SOCKET_STATES={}));var CHANNEL_STATES;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(CHANNEL_STATES||(CHANNEL_STATES={}));var CHANNEL_EVENTS;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(CHANNEL_EVENTS||(CHANNEL_EVENTS={}));var TRANSPORTS;(function(e){e.websocket="websocket"})(TRANSPORTS||(TRANSPORTS={}));var CONNECTION_STATE;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(CONNECTION_STATE||(CONNECTION_STATE={}));class Serializer{constructor(){this.HEADER_LENGTH=1}decode(r,t){return r.constructor===ArrayBuffer?t(this._binaryDecode(r)):t(typeof r=="string"?JSON.parse(r):{})}_binaryDecode(r){const t=new DataView(r),n=new TextDecoder;return this._decodeBroadcast(r,t,n)}_decodeBroadcast(r,t,n){const i=t.getUint8(1),l=t.getUint8(2);let c=this.HEADER_LENGTH+2;const f=n.decode(r.slice(c,c+i));c=c+i;const d=n.decode(r.slice(c,c+l));c=c+l;const h=JSON.parse(n.decode(r.slice(c,r.byteLength)));return{ref:null,topic:f,event:d,payload:h}}}class Timer{constructor(r,t){this.callback=r,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var PostgresTypes;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(PostgresTypes||(PostgresTypes={}));const convertChangeData=(e,r,t={})=>{var n;const i=(n=t.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(r).reduce((l,c)=>(l[c]=convertColumn(c,e,r,i),l),{})},convertColumn=(e,r,t,n)=>{const i=r.find(f=>f.name===e),l=i==null?void 0:i.type,c=t[e];return l&&!n.includes(l)?convertCell(l,c):noop$1(c)},convertCell=(e,r)=>{if(e.charAt(0)==="_"){const t=e.slice(1,e.length);return toArray(r,t)}switch(e){case PostgresTypes.bool:return toBoolean(r);case PostgresTypes.float4:case PostgresTypes.float8:case PostgresTypes.int2:case PostgresTypes.int4:case PostgresTypes.int8:case PostgresTypes.numeric:case PostgresTypes.oid:return toNumber(r);case PostgresTypes.json:case PostgresTypes.jsonb:return toJson(r);case PostgresTypes.timestamp:return toTimestampString(r);case PostgresTypes.abstime:case PostgresTypes.date:case PostgresTypes.daterange:case PostgresTypes.int4range:case PostgresTypes.int8range:case PostgresTypes.money:case PostgresTypes.reltime:case PostgresTypes.text:case PostgresTypes.time:case PostgresTypes.timestamptz:case PostgresTypes.timetz:case PostgresTypes.tsrange:case PostgresTypes.tstzrange:return noop$1(r);default:return noop$1(r)}},noop$1=e=>e,toBoolean=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},toNumber=e=>{if(typeof e=="string"){const r=parseFloat(e);if(!Number.isNaN(r))return r}return e},toJson=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(r){return console.log(`JSON parse error: ${r}`),e}return e},toArray=(e,r)=>{if(typeof e!="string")return e;const t=e.length-1,n=e[t];if(e[0]==="{"&&n==="}"){let l;const c=e.slice(1,t);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(f=>convertCell(r,f))}return e},toTimestampString=e=>typeof e=="string"?e.replace(" ","T"):e,httpEndpointURL=e=>{let r=e;return r=r.replace(/^ws/i,"http"),r=r.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),r.replace(/\/+$/,"")};class Push{constructor(r,t,n={},i=DEFAULT_TIMEOUT){this.channel=r,this.event=t,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,t){var n;return this._hasReceived(r)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:r,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const r=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:r,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:t}){this.recHooks.filter(n=>n.status===r).forEach(n=>n.callback(t))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}var REALTIME_PRESENCE_LISTEN_EVENTS;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(REALTIME_PRESENCE_LISTEN_EVENTS||(REALTIME_PRESENCE_LISTEN_EVENTS={}));class RealtimePresence{constructor(r,t){this.channel=r,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:l,onLeave:c,onSync:f}=this.caller;this.joinRef=this.channel._joinRef(),this.state=RealtimePresence.syncState(this.state,i,l,c),this.pendingDiffs.forEach(d=>{this.state=RealtimePresence.syncDiff(this.state,d,l,c)}),this.pendingDiffs=[],f()}),this.channel._on(n.diff,{},i=>{const{onJoin:l,onLeave:c,onSync:f}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=RealtimePresence.syncDiff(this.state,i,l,c),f())}),this.onJoin((i,l,c)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:l,newPresences:c})}),this.onLeave((i,l,c)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(r,t,n,i){const l=this.cloneDeep(r),c=this.transformState(t),f={},d={};return this.map(l,(h,p)=>{c[h]||(d[h]=p)}),this.map(c,(h,p)=>{const E=l[h];if(E){const v=p.map(m=>m.presence_ref),S=E.map(m=>m.presence_ref),x=p.filter(m=>S.indexOf(m.presence_ref)<0),g=E.filter(m=>v.indexOf(m.presence_ref)<0);x.length>0&&(f[h]=x),g.length>0&&(d[h]=g)}else f[h]=p}),this.syncDiff(l,{joins:f,leaves:d},n,i)}static syncDiff(r,t,n,i){const{joins:l,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(l,(f,d)=>{var h;const p=(h=r[f])!==null&&h!==void 0?h:[];if(r[f]=this.cloneDeep(d),p.length>0){const E=r[f].map(S=>S.presence_ref),v=p.filter(S=>E.indexOf(S.presence_ref)<0);r[f].unshift(...v)}n(f,p,d)}),this.map(c,(f,d)=>{let h=r[f];if(!h)return;const p=d.map(E=>E.presence_ref);h=h.filter(E=>p.indexOf(E.presence_ref)<0),r[f]=h,i(f,h,d),h.length===0&&delete r[f]}),r}static map(r,t){return Object.getOwnPropertyNames(r).map(n=>t(n,r[n]))}static transformState(r){return r=this.cloneDeep(r),Object.getOwnPropertyNames(r).reduce((t,n)=>{const i=r[n];return"metas"in i?t[n]=i.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):t[n]=i,t},{})}static cloneDeep(r){return JSON.parse(JSON.stringify(r))}onJoin(r){this.caller.onJoin=r}onLeave(r){this.caller.onLeave=r}onSync(r){this.caller.onSync=r}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var REALTIME_POSTGRES_CHANGES_LISTEN_EVENT;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT||(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT={}));var REALTIME_LISTEN_TYPES;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(REALTIME_LISTEN_TYPES||(REALTIME_LISTEN_TYPES={}));var REALTIME_SUBSCRIBE_STATES;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(REALTIME_SUBSCRIBE_STATES||(REALTIME_SUBSCRIBE_STATES={}));class RealtimeChannel{constructor(r,t={config:{}},n){this.topic=r,this.params=t,this.socket=n,this.bindings={},this.state=CHANNEL_STATES.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=r.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Push(this,CHANNEL_EVENTS.join,this.params,this.timeout),this.rejoinTimer=new Timer(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=CHANNEL_STATES.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=CHANNEL_STATES.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())}),this._on(CHANNEL_EVENTS.reply,{},(i,l)=>{this._trigger(this._replyEventName(l),i)}),this.presence=new RealtimePresence(this),this.broadcastEndpointURL=httpEndpointURL(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(r,t=this.timeout){var n,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:l,presence:c,private:f}}=this.params;this._onError(p=>r==null?void 0:r(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR,p)),this._onClose(()=>r==null?void 0:r(REALTIME_SUBSCRIBE_STATES.CLOSED));const d={},h={broadcast:l,presence:c,postgres_changes:(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&i!==void 0?i:[],private:f};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:h},d)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:p})=>{var E;if(this.socket.setAuth(),p===void 0){r==null||r(REALTIME_SUBSCRIBE_STATES.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,S=(E=v==null?void 0:v.length)!==null&&E!==void 0?E:0,x=[];for(let g=0;g<S;g++){const m=v[g],{filter:{event:b,schema:D,table:C,filter:F}}=m,T=p&&p[g];if(T&&T.event===b&&T.schema===D&&T.table===C&&T.filter===F)x.push(Object.assign(Object.assign({},m),{id:T.id}));else{this.unsubscribe(),r==null||r(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,r&&r(REALTIME_SUBSCRIBE_STATES.SUBSCRIBED);return}}).receive("error",p=>{r==null||r(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{r==null||r(REALTIME_SUBSCRIBE_STATES.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(r,t={}){return await this.send({type:"presence",event:"track",payload:r},t.timeout||this.timeout)}async untrack(r={}){return await this.send({type:"presence",event:"untrack"},r)}on(r,t,n){return this._on(r,t,n)}async send(r,t={}){var n,i;if(!this._canPush()&&r.type==="broadcast"){const{event:l,payload:c}=r,d={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const h=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=h.body)===null||i===void 0?void 0:i.cancel()),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,f,d;const h=this._push(r.type,r,t.timeout||this.timeout);r.type==="broadcast"&&!(!((d=(f=(c=this.params)===null||c===void 0?void 0:c.config)===null||f===void 0?void 0:f.broadcast)===null||d===void 0)&&d.ack)&&l("ok"),h.receive("ok",()=>l("ok")),h.receive("error",()=>l("error")),h.receive("timeout",()=>l("timed out"))})}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=CHANNEL_STATES.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(CHANNEL_EVENTS.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const i=new Push(this,CHANNEL_EVENTS.leave,{},r);i.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}async _fetchWithTimeout(r,t,n){const i=new AbortController,l=setTimeout(()=>i.abort(),n),c=await this.socket.fetch(r,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(l),c}_push(r,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Push(this,r,t,n);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(r,t,n){return t}_isMember(r){return this.topic===r}_joinRef(){return this.joinPush.ref}_trigger(r,t,n){var i,l;const c=r.toLocaleLowerCase(),{close:f,error:d,leave:h,join:p}=CHANNEL_EVENTS;if(n&&[f,d,h,p].indexOf(c)>=0&&n!==this._joinRef())return;let v=this._onMessage(c,t,n);if(t&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(S=>{var x,g,m;return((x=S.filter)===null||x===void 0?void 0:x.event)==="*"||((m=(g=S.filter)===null||g===void 0?void 0:g.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===c}).map(S=>S.callback(v,n)):(l=this.bindings[c])===null||l===void 0||l.filter(S=>{var x,g,m,b,D,C;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in S){const F=S.id,T=(x=S.filter)===null||x===void 0?void 0:x.event;return F&&((g=t.ids)===null||g===void 0?void 0:g.includes(F))&&(T==="*"||(T==null?void 0:T.toLocaleLowerCase())===((m=t.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{const F=(D=(b=S==null?void 0:S.filter)===null||b===void 0?void 0:b.event)===null||D===void 0?void 0:D.toLocaleLowerCase();return F==="*"||F===((C=t==null?void 0:t.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return S.type.toLocaleLowerCase()===c}).map(S=>{if(typeof v=="object"&&"ids"in v){const x=v.data,{schema:g,table:m,commit_timestamp:b,type:D,errors:C}=x;v=Object.assign(Object.assign({},{schema:g,table:m,commit_timestamp:b,eventType:D,new:{},old:{},errors:C}),this._getPayloadRecords(x))}S.callback(v,n)})}_isClosed(){return this.state===CHANNEL_STATES.closed}_isJoined(){return this.state===CHANNEL_STATES.joined}_isJoining(){return this.state===CHANNEL_STATES.joining}_isLeaving(){return this.state===CHANNEL_STATES.leaving}_replyEventName(r){return`chan_reply_${r}`}_on(r,t,n){const i=r.toLocaleLowerCase(),l={type:i,filter:t,callback:n};return this.bindings[i]?this.bindings[i].push(l):this.bindings[i]=[l],this}_off(r,t){const n=r.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(i=>{var l;return!(((l=i.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===n&&RealtimeChannel.isEqual(i.filter,t))}),this}static isEqual(r,t){if(Object.keys(r).length!==Object.keys(t).length)return!1;for(const n in r)if(r[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(r){this._on(CHANNEL_EVENTS.close,{},r)}_onError(r){this._on(CHANNEL_EVENTS.error,{},t=>r(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(r=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=CHANNEL_STATES.joining,this.joinPush.resend(r))}_getPayloadRecords(r){const t={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(t.new=convertChangeData(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(t.old=convertChangeData(r.columns,r.old_record)),t}}const noop=()=>{},NATIVE_WEBSOCKET_AVAILABLE=typeof WebSocket<"u",WORKER_SCRIPT=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class RealtimeClient{constructor(r,t){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=DEFAULT_HEADERS$3,this.params={},this.timeout=DEFAULT_TIMEOUT,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=noop,this.conn=null,this.sendBuffer=[],this.serializer=new Serializer,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=l=>{let c;return l?c=l:typeof fetch>"u"?c=(...f)=>__vitePreload(async()=>{const{default:d}=await Promise.resolve().then(()=>browser);return{default:d}},void 0).then(({default:d})=>d(...f)):c=fetch,(...f)=>c(...f)},this.endPoint=`${r}/${TRANSPORTS.websocket}`,this.httpEndpoint=httpEndpointURL(r),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const i=(n=t==null?void 0:t.params)===null||n===void 0?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:l=>[1e3,2e3,5e3,1e4][l-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(l,c)=>c(JSON.stringify(l)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Timer(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(NATIVE_WEBSOCKET_AVAILABLE){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new WSWebSocketDummy(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),__vitePreload(async()=>{const{default:r}=await import("./browser-BQHyCiNc.js").then(t=>t.b);return{default:r}},[]).then(({default:r})=>{this.conn=new r(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:VSN}))}disconnect(r,t){this.conn&&(this.conn.onclose=function(){},r?this.conn.close(r,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(r){const t=await r.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const r=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),r}log(r,t,n){this.logger(r,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case SOCKET_STATES.connecting:return CONNECTION_STATE.Connecting;case SOCKET_STATES.open:return CONNECTION_STATE.Open;case SOCKET_STATES.closing:return CONNECTION_STATE.Closing;default:return CONNECTION_STATE.Closed}}isConnected(){return this.connectionState()===CONNECTION_STATE.Open}channel(r,t={config:{}}){const n=new RealtimeChannel(`realtime:${r}`,t,this);return this.channels.push(n),n}push(r){const{topic:t,event:n,payload:i,ref:l}=r,c=()=>{this.encode(r,f=>{var d;(d=this.conn)===null||d===void 0||d.send(f)})};this.log("push",`${t} ${n} (${l})`,i),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(r=null){let t=r||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let n=null;try{n=JSON.parse(atob(t.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=t,this.channels.forEach(i=>{t&&i.updateJoinPayload({access_token:t}),i.joinedOnce&&i._isJoined()&&i._push(CHANNEL_EVENTS.access_token,{access_token:t})})}}async sendHeartbeat(){var r;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(r=this.conn)===null||r===void 0||r.close(WS_CLOSE_NORMAL,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}_leaveOpenTopic(r){let t=this.channels.find(n=>n.topic===r&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${r}"`),t.unsubscribe())}_remove(r){this.channels=this.channels.filter(t=>t._joinRef()!==r._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this._onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r))}_onConnMessage(r){this.decode(r.data,t=>{let{topic:n,event:i,payload:l,ref:c}=t;c&&c===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${l.status||""} ${n} ${i} ${c&&"("+c+")"||""}`,l),this.channels.filter(f=>f._isMember(n)).forEach(f=>f._trigger(i,l,c)),this.stateChangeCallbacks.message.forEach(f=>f(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const r=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(r),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(r=>r())}_onConnClose(r){this.log("transport","close",r),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(r))}_onConnError(r){this.log("transport",r.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(r))}_triggerChanError(){this.channels.forEach(r=>r._trigger(CHANNEL_EVENTS.error))}_appendParams(r,t){if(Object.keys(t).length===0)return r;const n=r.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${r}${n}${i}`}_workerObjectUrl(r){let t;if(r)t=r;else{const n=new Blob([WORKER_SCRIPT],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}}class WSWebSocketDummy{constructor(r,t,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=SOCKET_STATES.connecting,this.send=()=>{},this.url=null,this.url=r,this.close=n.close}}class StorageError extends Error{constructor(r){super(r),this.__isStorageError=!0,this.name="StorageError"}}function isStorageError(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class StorageApiError extends StorageError{constructor(r,t){super(r),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class StorageUnknownError extends StorageError{constructor(r,t){super(r),this.name="StorageUnknownError",this.originalError=t}}var __awaiter$6=function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(p){try{h(n.next(p))}catch(E){c(E)}}function d(p){try{h(n.throw(p))}catch(E){c(E)}}function h(p){p.done?l(p.value):i(p.value).then(f,d)}h((n=n.apply(e,r||[])).next())})};const resolveFetch$2=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>__vitePreload(async()=>{const{default:n}=await Promise.resolve().then(()=>browser);return{default:n}},void 0).then(({default:n})=>n(...t)):r=fetch,(...t)=>r(...t)},resolveResponse=()=>__awaiter$6(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield __vitePreload(()=>Promise.resolve().then(()=>browser),void 0)).Response:Response}),recursiveToCamel=e=>{if(Array.isArray(e))return e.map(t=>recursiveToCamel(t));if(typeof e=="function"||e!==Object(e))return e;const r={};return Object.entries(e).forEach(([t,n])=>{const i=t.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));r[i]=recursiveToCamel(n)}),r};var __awaiter$5=function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(p){try{h(n.next(p))}catch(E){c(E)}}function d(p){try{h(n.throw(p))}catch(E){c(E)}}function h(p){p.done?l(p.value):i(p.value).then(f,d)}h((n=n.apply(e,r||[])).next())})};const _getErrorMessage$1=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),handleError$1=(e,r,t)=>__awaiter$5(void 0,void 0,void 0,function*(){const n=yield resolveResponse();e instanceof n&&!(t!=null&&t.noResolveJson)?e.json().then(i=>{r(new StorageApiError(_getErrorMessage$1(i),e.status||500))}).catch(i=>{r(new StorageUnknownError(_getErrorMessage$1(i),i))}):r(new StorageUnknownError(_getErrorMessage$1(e),e))}),_getRequestParams$1=(e,r,t,n)=>{const i={method:e,headers:(r==null?void 0:r.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},r==null?void 0:r.headers),n&&(i.body=JSON.stringify(n)),Object.assign(Object.assign({},i),t))};function _handleRequest$1(e,r,t,n,i,l){return __awaiter$5(this,void 0,void 0,function*(){return new Promise((c,f)=>{e(t,_getRequestParams$1(r,n,i,l)).then(d=>{if(!d.ok)throw d;return n!=null&&n.noResolveJson?d:d.json()}).then(d=>c(d)).catch(d=>handleError$1(d,f,n))})})}function get(e,r,t,n){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(e,"GET",r,t,n)})}function post(e,r,t,n,i){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(e,"POST",r,n,i,t)})}function put(e,r,t,n,i){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(e,"PUT",r,n,i,t)})}function head(e,r,t,n){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(e,"HEAD",r,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function remove(e,r,t,n,i){return __awaiter$5(this,void 0,void 0,function*(){return _handleRequest$1(e,"DELETE",r,n,i,t)})}var __awaiter$4=function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(p){try{h(n.next(p))}catch(E){c(E)}}function d(p){try{h(n.throw(p))}catch(E){c(E)}}function h(p){p.done?l(p.value):i(p.value).then(f,d)}h((n=n.apply(e,r||[])).next())})};const DEFAULT_SEARCH_OPTIONS={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},DEFAULT_FILE_OPTIONS={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class StorageFileApi{constructor(r,t={},n,i){this.url=r,this.headers=t,this.bucketId=n,this.fetch=resolveFetch$2(i)}uploadOrUpdate(r,t,n,i){return __awaiter$4(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},DEFAULT_FILE_OPTIONS),i);let f=Object.assign(Object.assign({},this.headers),r==="POST"&&{"x-upsert":String(c.upsert)});const d=c.metadata;typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),d&&l.append("metadata",this.encodeMetadata(d)),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl),d&&l.append("metadata",this.encodeMetadata(d))):(l=n,f["cache-control"]=`max-age=${c.cacheControl}`,f["content-type"]=c.contentType,d&&(f["x-metadata"]=this.toBase64(this.encodeMetadata(d)))),i!=null&&i.headers&&(f=Object.assign(Object.assign({},f),i.headers));const h=this._removeEmptyFolders(t),p=this._getFinalPath(h),E=yield this.fetch(`${this.url}/object/${p}`,Object.assign({method:r,body:l,headers:f},c!=null&&c.duplex?{duplex:c.duplex}:{})),v=yield E.json();return E.ok?{data:{path:h,id:v.Id,fullPath:v.Key},error:null}:{data:null,error:v}}catch(l){if(isStorageError(l))return{data:null,error:l};throw l}})}upload(r,t,n){return __awaiter$4(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",r,t,n)})}uploadToSignedUrl(r,t,n,i){return __awaiter$4(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(r),c=this._getFinalPath(l),f=new URL(this.url+`/object/upload/sign/${c}`);f.searchParams.set("token",t);try{let d;const h=Object.assign({upsert:DEFAULT_FILE_OPTIONS.upsert},i),p=Object.assign(Object.assign({},this.headers),{"x-upsert":String(h.upsert)});typeof Blob<"u"&&n instanceof Blob?(d=new FormData,d.append("cacheControl",h.cacheControl),d.append("",n)):typeof FormData<"u"&&n instanceof FormData?(d=n,d.append("cacheControl",h.cacheControl)):(d=n,p["cache-control"]=`max-age=${h.cacheControl}`,p["content-type"]=h.contentType);const E=yield this.fetch(f.toString(),{method:"PUT",body:d,headers:p}),v=yield E.json();return E.ok?{data:{path:l,fullPath:v.Key},error:null}:{data:null,error:v}}catch(d){if(isStorageError(d))return{data:null,error:d};throw d}})}createSignedUploadUrl(r,t){return __awaiter$4(this,void 0,void 0,function*(){try{let n=this._getFinalPath(r);const i=Object.assign({},this.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const l=yield post(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),c=new URL(this.url+l.url),f=c.searchParams.get("token");if(!f)throw new StorageError("No token returned by API");return{data:{signedUrl:c.toString(),path:r,token:f},error:null}}catch(n){if(isStorageError(n))return{data:null,error:n};throw n}})}update(r,t,n){return __awaiter$4(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",r,t,n)})}move(r,t,n){return __awaiter$4(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:r,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(isStorageError(i))return{data:null,error:i};throw i}})}copy(r,t,n){return __awaiter$4(this,void 0,void 0,function*(){try{return{data:{path:(yield post(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:r,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(isStorageError(i))return{data:null,error:i};throw i}})}createSignedUrl(r,t,n){return __awaiter$4(this,void 0,void 0,function*(){try{let i=this._getFinalPath(r),l=yield post(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const c=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(i){if(isStorageError(i))return{data:null,error:i};throw i}})}createSignedUrls(r,t,n){return __awaiter$4(this,void 0,void 0,function*(){try{const i=yield post(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:r},{headers:this.headers}),l=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(i){if(isStorageError(i))return{data:null,error:i};throw i}})}download(r,t){return __awaiter$4(this,void 0,void 0,function*(){const i=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),c=l?`?${l}`:"";try{const f=this._getFinalPath(r);return{data:yield(yield get(this.fetch,`${this.url}/${i}/${f}${c}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(f){if(isStorageError(f))return{data:null,error:f};throw f}})}info(r){return __awaiter$4(this,void 0,void 0,function*(){const t=this._getFinalPath(r);try{const n=yield get(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:recursiveToCamel(n),error:null}}catch(n){if(isStorageError(n))return{data:null,error:n};throw n}})}exists(r){return __awaiter$4(this,void 0,void 0,function*(){const t=this._getFinalPath(r);try{return yield head(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(isStorageError(n)&&n instanceof StorageUnknownError){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(r,t){const n=this._getFinalPath(r),i=[],l=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";l!==""&&i.push(l);const f=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",d=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});d!==""&&i.push(d);let h=i.join("&");return h!==""&&(h=`?${h}`),{data:{publicUrl:encodeURI(`${this.url}/${f}/public/${n}${h}`)}}}remove(r){return __awaiter$4(this,void 0,void 0,function*(){try{return{data:yield remove(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:r},{headers:this.headers}),error:null}}catch(t){if(isStorageError(t))return{data:null,error:t};throw t}})}list(r,t,n){return __awaiter$4(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},DEFAULT_SEARCH_OPTIONS),t),{prefix:r||""});return{data:yield post(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(isStorageError(i))return{data:null,error:i};throw i}})}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const t=[];return r.width&&t.push(`width=${r.width}`),r.height&&t.push(`height=${r.height}`),r.resize&&t.push(`resize=${r.resize}`),r.format&&t.push(`format=${r.format}`),r.quality&&t.push(`quality=${r.quality}`),t.join("&")}}const version$2="2.7.1",DEFAULT_HEADERS$2={"X-Client-Info":`storage-js/${version$2}`};var __awaiter$3=function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(p){try{h(n.next(p))}catch(E){c(E)}}function d(p){try{h(n.throw(p))}catch(E){c(E)}}function h(p){p.done?l(p.value):i(p.value).then(f,d)}h((n=n.apply(e,r||[])).next())})};class StorageBucketApi{constructor(r,t={},n){this.url=r,this.headers=Object.assign(Object.assign({},DEFAULT_HEADERS$2),t),this.fetch=resolveFetch$2(n)}listBuckets(){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield get(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(r){if(isStorageError(r))return{data:null,error:r};throw r}})}getBucket(r){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield get(this.fetch,`${this.url}/bucket/${r}`,{headers:this.headers}),error:null}}catch(t){if(isStorageError(t))return{data:null,error:t};throw t}})}createBucket(r,t={public:!1}){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/bucket`,{id:r,name:r,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(isStorageError(n))return{data:null,error:n};throw n}})}updateBucket(r,t){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield put(this.fetch,`${this.url}/bucket/${r}`,{id:r,name:r,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(isStorageError(n))return{data:null,error:n};throw n}})}emptyBucket(r){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/bucket/${r}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(isStorageError(t))return{data:null,error:t};throw t}})}deleteBucket(r){return __awaiter$3(this,void 0,void 0,function*(){try{return{data:yield remove(this.fetch,`${this.url}/bucket/${r}`,{},{headers:this.headers}),error:null}}catch(t){if(isStorageError(t))return{data:null,error:t};throw t}})}}class StorageClient extends StorageBucketApi{constructor(r,t={},n){super(r,t,n)}from(r){return new StorageFileApi(this.url,this.headers,r,this.fetch)}}const version$1="2.48.0";let JS_ENV="";typeof Deno<"u"?JS_ENV="deno":typeof document<"u"?JS_ENV="web":typeof navigator<"u"&&navigator.product==="ReactNative"?JS_ENV="react-native":JS_ENV="node";const DEFAULT_HEADERS$1={"X-Client-Info":`supabase-js-${JS_ENV}/${version$1}`},DEFAULT_GLOBAL_OPTIONS={headers:DEFAULT_HEADERS$1},DEFAULT_DB_OPTIONS={schema:"public"},DEFAULT_AUTH_OPTIONS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},DEFAULT_REALTIME_OPTIONS={};var __awaiter$2=function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(p){try{h(n.next(p))}catch(E){c(E)}}function d(p){try{h(n.throw(p))}catch(E){c(E)}}function h(p){p.done?l(p.value):i(p.value).then(f,d)}h((n=n.apply(e,r||[])).next())})};const resolveFetch$1=e=>{let r;return e?r=e:typeof fetch>"u"?r=nodeFetch:r=fetch,(...t)=>r(...t)},resolveHeadersConstructor=()=>typeof Headers>"u"?Headers$1:Headers,fetchWithAuth=(e,r,t)=>{const n=resolveFetch$1(t),i=resolveHeadersConstructor();return(l,c)=>__awaiter$2(void 0,void 0,void 0,function*(){var f;const d=(f=yield r())!==null&&f!==void 0?f:e;let h=new i(c==null?void 0:c.headers);return h.has("apikey")||h.set("apikey",e),h.has("Authorization")||h.set("Authorization",`Bearer ${d}`),n(l,Object.assign(Object.assign({},c),{headers:h}))})};var __awaiter$1=function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(p){try{h(n.next(p))}catch(E){c(E)}}function d(p){try{h(n.throw(p))}catch(E){c(E)}}function h(p){p.done?l(p.value):i(p.value).then(f,d)}h((n=n.apply(e,r||[])).next())})};function stripTrailingSlash(e){return e.replace(/\/$/,"")}function applySettingDefaults(e,r){const{db:t,auth:n,realtime:i,global:l}=e,{db:c,auth:f,realtime:d,global:h}=r,p={db:Object.assign(Object.assign({},c),t),auth:Object.assign(Object.assign({},f),n),realtime:Object.assign(Object.assign({},d),i),global:Object.assign(Object.assign({},h),l),accessToken:()=>__awaiter$1(this,void 0,void 0,function*(){return""})};return e.accessToken?p.accessToken=e.accessToken:delete p.accessToken,p}const version="2.67.3",GOTRUE_URL="http://localhost:9999",STORAGE_KEY="supabase.auth.token",DEFAULT_HEADERS={"X-Client-Info":`gotrue-js/${version}`},EXPIRY_MARGIN=10,API_VERSION_HEADER_NAME="X-Supabase-Api-Version",API_VERSIONS={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function expiresAt(e){return Math.round(Date.now()/1e3)+e}function uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const r=Math.random()*16|0;return(e=="x"?r:r&3|8).toString(16)})}const isBrowser=()=>typeof window<"u"&&typeof document<"u",localStorageWriteTests={tested:!1,writable:!1},supportsLocalStorage=()=>{if(!isBrowser())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(localStorageWriteTests.tested)return localStorageWriteTests.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),localStorageWriteTests.tested=!0,localStorageWriteTests.writable=!0}catch{localStorageWriteTests.tested=!0,localStorageWriteTests.writable=!1}return localStorageWriteTests.writable};function parseParametersFromURL(e){const r={},t=new URL(e);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,l)=>{r[l]=i})}catch{}return t.searchParams.forEach((n,i)=>{r[i]=n}),r}const resolveFetch=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>__vitePreload(async()=>{const{default:n}=await Promise.resolve().then(()=>browser);return{default:n}},void 0).then(({default:n})=>n(...t)):r=fetch,(...t)=>r(...t)},looksLikeFetchResponse=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",setItemAsync=async(e,r,t)=>{await e.setItem(r,JSON.stringify(t))},getItemAsync=async(e,r)=>{const t=await e.getItem(r);if(!t)return null;try{return JSON.parse(t)}catch{return t}},removeItemAsync=async(e,r)=>{await e.removeItem(r)};function decodeBase64URL(e){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",n,i,l,c,f,d,h,p=0;for(e=e.replace("-","+").replace("_","/");p<e.length;)c=r.indexOf(e.charAt(p++)),f=r.indexOf(e.charAt(p++)),d=r.indexOf(e.charAt(p++)),h=r.indexOf(e.charAt(p++)),n=c<<2|f>>4,i=(f&15)<<4|d>>2,l=(d&3)<<6|h,t=t+String.fromCharCode(n),d!=64&&i!=0&&(t=t+String.fromCharCode(i)),h!=64&&l!=0&&(t=t+String.fromCharCode(l));return t}class Deferred{constructor(){this.promise=new Deferred.promiseConstructor((r,t)=>{this.resolve=r,this.reject=t})}}Deferred.promiseConstructor=Promise;function decodeJWTPayload(e){const r=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=e.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!r.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const n=t[1];return JSON.parse(decodeBase64URL(n))}async function sleep(e){return await new Promise(r=>{setTimeout(()=>r(null),e)})}function retryable(e,r){return new Promise((n,i)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await e(l);if(!r(l,null,c)){n(c);return}}catch(c){if(!r(l,c)){i(c);return}}})()})}function dec2hex(e){return("0"+e.toString(16)).substr(-2)}function generatePKCEVerifier(){const r=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let i="";for(let l=0;l<56;l++)i+=t.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(r),Array.from(r,dec2hex).join("")}async function sha256(e){const t=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(n);return Array.from(i).map(l=>String.fromCharCode(l)).join("")}function base64urlencode(e){return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function generatePKCEChallenge(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await sha256(e);return base64urlencode(t)}async function getCodeChallengeAndMethod(e,r,t=!1){const n=generatePKCEVerifier();let i=n;t&&(i+="/PASSWORD_RECOVERY"),await setItemAsync(e,`${r}-code-verifier`,i);const l=await generatePKCEChallenge(n);return[l,n===l?"plain":"s256"]}const API_VERSION_REGEX=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function parseResponseAPIVersion(e){const r=e.headers.get(API_VERSION_HEADER_NAME);if(!r||!r.match(API_VERSION_REGEX))return null;try{return new Date(`${r}T00:00:00.0Z`)}catch{return null}}class AuthError extends Error{constructor(r,t,n){super(r),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function isAuthError(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class AuthApiError extends AuthError{constructor(r,t,n){super(r,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function isAuthApiError(e){return isAuthError(e)&&e.name==="AuthApiError"}class AuthUnknownError extends AuthError{constructor(r,t){super(r),this.name="AuthUnknownError",this.originalError=t}}class CustomAuthError extends AuthError{constructor(r,t,n,i){super(r,n,i),this.name=t,this.status=n}}class AuthSessionMissingError extends CustomAuthError{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function isAuthSessionMissingError(e){return isAuthError(e)&&e.name==="AuthSessionMissingError"}class AuthInvalidTokenResponseError extends CustomAuthError{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class AuthInvalidCredentialsError extends CustomAuthError{constructor(r){super(r,"AuthInvalidCredentialsError",400,void 0)}}class AuthImplicitGrantRedirectError extends CustomAuthError{constructor(r,t=null){super(r,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function isAuthImplicitGrantRedirectError(e){return isAuthError(e)&&e.name==="AuthImplicitGrantRedirectError"}class AuthPKCEGrantCodeExchangeError extends CustomAuthError{constructor(r,t=null){super(r,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class AuthRetryableFetchError extends CustomAuthError{constructor(r,t){super(r,"AuthRetryableFetchError",t,void 0)}}function isAuthRetryableFetchError(e){return isAuthError(e)&&e.name==="AuthRetryableFetchError"}class AuthWeakPasswordError extends CustomAuthError{constructor(r,t,n){super(r,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}var __rest$1=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t};const _getErrorMessage=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),NETWORK_ERROR_CODES=[502,503,504];async function handleError(e){var r;if(!looksLikeFetchResponse(e))throw new AuthRetryableFetchError(_getErrorMessage(e),0);if(NETWORK_ERROR_CODES.includes(e.status))throw new AuthRetryableFetchError(_getErrorMessage(e),e.status);let t;try{t=await e.json()}catch(l){throw new AuthUnknownError(_getErrorMessage(l),l)}let n;const i=parseResponseAPIVersion(e);if(i&&i.getTime()>=API_VERSIONS["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new AuthWeakPasswordError(_getErrorMessage(t),e.status,((r=t.weak_password)===null||r===void 0?void 0:r.reasons)||[]);if(n==="session_not_found")throw new AuthSessionMissingError}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new AuthWeakPasswordError(_getErrorMessage(t),e.status,t.weak_password.reasons);throw new AuthApiError(_getErrorMessage(t),e.status||500,n)}const _getRequestParams=(e,r,t,n)=>{const i={method:e,headers:(r==null?void 0:r.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r==null?void 0:r.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),t))};async function _request(e,r,t,n){var i;const l=Object.assign({},n==null?void 0:n.headers);l[API_VERSION_HEADER_NAME]||(l[API_VERSION_HEADER_NAME]=API_VERSIONS["2024-01-01"].name),n!=null&&n.jwt&&(l.Authorization=`Bearer ${n.jwt}`);const c=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(c.redirect_to=n.redirectTo);const f=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",d=await _handleRequest(e,r,t+f,{headers:l,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(d):{data:Object.assign({},d),error:null}}async function _handleRequest(e,r,t,n,i,l){const c=_getRequestParams(r,n,i,l);let f;try{f=await e(t,Object.assign({},c))}catch(d){throw console.error(d),new AuthRetryableFetchError(_getErrorMessage(d),0)}if(f.ok||await handleError(f),n!=null&&n.noResolveJson)return f;try{return await f.json()}catch(d){await handleError(d)}}function _sessionResponse(e){var r;let t=null;hasSession(e)&&(t=Object.assign({},e),e.expires_at||(t.expires_at=expiresAt(e.expires_in)));const n=(r=e.user)!==null&&r!==void 0?r:e;return{data:{session:t,user:n},error:null}}function _sessionResponsePassword(e){const r=_sessionResponse(e);return!r.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(r.data.weak_password=e.weak_password),r}function _userResponse(e){var r;return{data:{user:(r=e.user)!==null&&r!==void 0?r:e},error:null}}function _ssoResponse(e){return{data:e,error:null}}function _generateLinkResponse(e){const{action_link:r,email_otp:t,hashed_token:n,redirect_to:i,verification_type:l}=e,c=__rest$1(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),f={action_link:r,email_otp:t,hashed_token:n,redirect_to:i,verification_type:l},d=Object.assign({},c);return{data:{properties:f,user:d},error:null}}function _noResolveJsonResponse(e){return e}function hasSession(e){return e.access_token&&e.refresh_token&&e.expires_in}var __rest=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]]);return t};class GoTrueAdminApi{constructor({url:r="",headers:t={},fetch:n}){this.url=r,this.headers=t,this.fetch=resolveFetch(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(r,t="global"){try{return await _request(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:r,noResolveJson:!0}),{data:null,error:null}}catch(n){if(isAuthError(n))return{data:null,error:n};throw n}}async inviteUserByEmail(r,t={}){try{return await _request(this.fetch,"POST",`${this.url}/invite`,{body:{email:r,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:_userResponse})}catch(n){if(isAuthError(n))return{data:{user:null},error:n};throw n}}async generateLink(r){try{const{options:t}=r,n=__rest(r,["options"]),i=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await _request(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:_generateLinkResponse,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(isAuthError(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(r){try{return await _request(this.fetch,"POST",`${this.url}/admin/users`,{body:r,headers:this.headers,xform:_userResponse})}catch(t){if(isAuthError(t))return{data:{user:null},error:t};throw t}}async listUsers(r){var t,n,i,l,c,f,d;try{const h={nextPage:null,lastPage:0,total:0},p=await _request(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=r==null?void 0:r.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(l=(i=r==null?void 0:r.perPage)===null||i===void 0?void 0:i.toString())!==null&&l!==void 0?l:""},xform:_noResolveJsonResponse});if(p.error)throw p.error;const E=await p.json(),v=(c=p.headers.get("x-total-count"))!==null&&c!==void 0?c:0,S=(d=(f=p.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&d!==void 0?d:[];return S.length>0&&(S.forEach(x=>{const g=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(x.split(";")[1].split("=")[1]);h[`${m}Page`]=g}),h.total=parseInt(v)),{data:Object.assign(Object.assign({},E),h),error:null}}catch(h){if(isAuthError(h))return{data:{users:[]},error:h};throw h}}async getUserById(r){try{return await _request(this.fetch,"GET",`${this.url}/admin/users/${r}`,{headers:this.headers,xform:_userResponse})}catch(t){if(isAuthError(t))return{data:{user:null},error:t};throw t}}async updateUserById(r,t){try{return await _request(this.fetch,"PUT",`${this.url}/admin/users/${r}`,{body:t,headers:this.headers,xform:_userResponse})}catch(n){if(isAuthError(n))return{data:{user:null},error:n};throw n}}async deleteUser(r,t=!1){try{return await _request(this.fetch,"DELETE",`${this.url}/admin/users/${r}`,{headers:this.headers,body:{should_soft_delete:t},xform:_userResponse})}catch(n){if(isAuthError(n))return{data:{user:null},error:n};throw n}}async _listFactors(r){try{const{data:t,error:n}=await _request(this.fetch,"GET",`${this.url}/admin/users/${r.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:n}}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}async _deleteFactor(r){try{return{data:await _request(this.fetch,"DELETE",`${this.url}/admin/users/${r.userId}/factors/${r.id}`,{headers:this.headers}),error:null}}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}}const localStorageAdapter={getItem:e=>supportsLocalStorage()?globalThis.localStorage.getItem(e):null,setItem:(e,r)=>{supportsLocalStorage()&&globalThis.localStorage.setItem(e,r)},removeItem:e=>{supportsLocalStorage()&&globalThis.localStorage.removeItem(e)}};function memoryLocalStorageAdapter(e={}){return{getItem:r=>e[r]||null,setItem:(r,t)=>{e[r]=t},removeItem:r=>{delete e[r]}}}function polyfillGlobalThis(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const internals={debug:!!(globalThis&&supportsLocalStorage()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class LockAcquireTimeoutError extends Error{constructor(r){super(r),this.isAcquireTimeout=!0}}class NavigatorLockAcquireTimeoutError extends LockAcquireTimeoutError{}async function navigatorLock(e,r,t){internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,r);const n=new globalThis.AbortController;return r>0&&setTimeout(()=>{n.abort(),internals.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},r),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,r===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await t()}finally{internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(r===0)throw internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new NavigatorLockAcquireTimeoutError(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(internals.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}polyfillGlobalThis();const DEFAULT_OPTIONS={url:GOTRUE_URL,storageKey:STORAGE_KEY,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:DEFAULT_HEADERS,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},AUTO_REFRESH_TICK_DURATION=30*1e3,AUTO_REFRESH_TICK_THRESHOLD=3;async function lockNoOp(e,r,t){return await t()}class GoTrueClient{constructor(r){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=GoTrueClient.nextInstanceID,GoTrueClient.nextInstanceID+=1,this.instanceID>0&&isBrowser()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},DEFAULT_OPTIONS),r);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new GoTrueAdminApi({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=resolveFetch(i.fetch),this.lock=i.lock||lockNoOp,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:isBrowser()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=navigatorLock:this.lock=lockNoOp,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:supportsLocalStorage()?this.storage=localStorageAdapter:(this.memoryStorage={},this.storage=memoryLocalStorageAdapter(this.memoryStorage)):(this.memoryStorage={},this.storage=memoryLocalStorageAdapter(this.memoryStorage)),isBrowser()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}_debug(...r){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${version}) ${new Date().toISOString()}`,...r),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var r;try{const t=parseParametersFromURL(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),isBrowser()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:l}=await this._getSessionFromURL(t,n);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),isAuthImplicitGrantRedirectError(l)){const d=(r=l.details)===null||r===void 0?void 0:r.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:f}=i;return this._debug("#_initialize()","detected session in URL",c,"redirect type",f),await this._saveSession(c),setTimeout(async()=>{f==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return isAuthError(t)?{error:t}:{error:new AuthUnknownError("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(r){var t,n,i;try{const l=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=r==null?void 0:r.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=r==null?void 0:r.options)===null||i===void 0?void 0:i.captchaToken}},xform:_sessionResponse}),{data:c,error:f}=l;if(f||!c)return{data:{user:null,session:null},error:f};const d=c.session,h=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:h,session:d},error:null}}catch(l){if(isAuthError(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(r){var t,n,i;try{let l;if("email"in r){const{email:p,password:E,options:v}=r;let S=null,x=null;this.flowType==="pkce"&&([S,x]=await getCodeChallengeAndMethod(this.storage,this.storageKey)),l=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v==null?void 0:v.emailRedirectTo,body:{email:p,password:E,data:(t=v==null?void 0:v.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken},code_challenge:S,code_challenge_method:x},xform:_sessionResponse})}else if("phone"in r){const{phone:p,password:E,options:v}=r;l=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:E,data:(n=v==null?void 0:v.data)!==null&&n!==void 0?n:{},channel:(i=v==null?void 0:v.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken}},xform:_sessionResponse})}else throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a password");const{data:c,error:f}=l;if(f||!c)return{data:{user:null,session:null},error:f};const d=c.session,h=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",d)),{data:{user:h,session:d},error:null}}catch(l){if(isAuthError(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(r){try{let t;if("email"in r){const{email:l,password:c,options:f}=r;t=await _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:_sessionResponsePassword})}else if("phone"in r){const{phone:l,password:c,options:f}=r;t=await _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:_sessionResponsePassword})}else throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a password");const{data:n,error:i}=t;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(t){if(isAuthError(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(r){var t,n,i,l;return await this._handleProviderSignIn(r.provider,{redirectTo:(t=r.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=r.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=r.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(l=r.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(r){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(r))}async _exchangeCodeForSession(r){const t=await getItemAsync(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(t??"").split("/");try{const{data:l,error:c}=await _request(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:r,code_verifier:n},xform:_sessionResponse});if(await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new AuthInvalidTokenResponseError}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:i??null}),error:c})}catch(l){if(isAuthError(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(r){try{const{options:t,provider:n,token:i,access_token:l,nonce:c}=r,f=await _request(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:_sessionResponse}),{data:d,error:h}=f;return h?{data:{user:null,session:null},error:h}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),{data:d,error:h})}catch(t){if(isAuthError(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(r){var t,n,i,l,c;try{if("email"in r){const{email:f,options:d}=r;let h=null,p=null;this.flowType==="pkce"&&([h,p]=await getCodeChallengeAndMethod(this.storage,this.storageKey));const{error:E}=await _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:f,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},create_user:(n=d==null?void 0:d.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:h,code_challenge_method:p},redirectTo:d==null?void 0:d.emailRedirectTo});return{data:{user:null,session:null},error:E}}if("phone"in r){const{phone:f,options:d}=r,{data:h,error:p}=await _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:f,data:(i=d==null?void 0:d.data)!==null&&i!==void 0?i:{},create_user:(l=d==null?void 0:d.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(c=d==null?void 0:d.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:h==null?void 0:h.message_id},error:p}}throw new AuthInvalidCredentialsError("You must provide either an email or phone number.")}catch(f){if(isAuthError(f))return{data:{user:null,session:null},error:f};throw f}}async verifyOtp(r){var t,n;try{let i,l;"options"in r&&(i=(t=r.options)===null||t===void 0?void 0:t.redirectTo,l=(n=r.options)===null||n===void 0?void 0:n.captchaToken);const{data:c,error:f}=await _request(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},r),{gotrue_meta_security:{captcha_token:l}}),redirectTo:i,xform:_sessionResponse});if(f)throw f;if(!c)throw new Error("An error occurred on token verification.");const d=c.session,h=c.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(r.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),{data:{user:h,session:d},error:null}}catch(i){if(isAuthError(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(r){var t,n,i;try{let l=null,c=null;return this.flowType==="pkce"&&([l,c]=await getCodeChallengeAndMethod(this.storage,this.storageKey)),await _request(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in r?{provider_id:r.providerId}:null),"domain"in r?{domain:r.domain}:null),{redirect_to:(n=(t=r.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=r==null?void 0:r.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:r.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:_ssoResponse})}catch(l){if(isAuthError(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async r=>{const{data:{session:t},error:n}=r;if(n)throw n;if(!t)throw new AuthSessionMissingError;const{error:i}=await _request(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}})}catch(r){if(isAuthError(r))return{data:{user:null,session:null},error:r};throw r}}async resend(r){try{const t=`${this.url}/resend`;if("email"in r){const{email:n,type:i,options:l}=r,{error:c}=await _request(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in r){const{phone:n,type:i,options:l}=r,{data:c,error:f}=await _request(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:f}}throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a type")}catch(t){if(isAuthError(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(r,t){this._debug("#_acquireLock","begin",r);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,r,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(r){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await r(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let r=null;const t=await getItemAsync(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?r=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!r)return{data:{session:null},error:null};const n=r.expires_at?r.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",r.expires_at),!n){if(this.storage.isServer){let c=this.suppressGetSessionWarning;r=new Proxy(r,{get:(d,h,p)=>(!c&&h==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(d,h,p))})}return{data:{session:r},error:null}}const{session:i,error:l}=await this._callRefreshToken(r.refresh_token);return l?{data:{session:null},error:l}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(r){return r?await this._getUser(r):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(r){try{return r?await _request(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:r,xform:_userResponse}):await this._useSession(async t=>{var n,i,l;const{data:c,error:f}=t;if(f)throw f;return!(!((n=c.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new AuthSessionMissingError}:await _request(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(i=c.session)===null||i===void 0?void 0:i.access_token)!==null&&l!==void 0?l:void 0,xform:_userResponse})})}catch(t){if(isAuthError(t))return isAuthSessionMissingError(t)&&(await this._removeSession(),await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(r,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(r,t))}async _updateUser(r,t={}){try{return await this._useSession(async n=>{const{data:i,error:l}=n;if(l)throw l;if(!i.session)throw new AuthSessionMissingError;const c=i.session;let f=null,d=null;this.flowType==="pkce"&&r.email!=null&&([f,d]=await getCodeChallengeAndMethod(this.storage,this.storageKey));const{data:h,error:p}=await _request(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},r),{code_challenge:f,code_challenge_method:d}),jwt:c.access_token,xform:_userResponse});if(p)throw p;return c.user=h.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(n){if(isAuthError(n))return{data:{user:null},error:n};throw n}}_decodeJWT(r){return decodeJWTPayload(r)}async setSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(r))}async _setSession(r){try{if(!r.access_token||!r.refresh_token)throw new AuthSessionMissingError;const t=Date.now()/1e3;let n=t,i=!0,l=null;const c=decodeJWTPayload(r.access_token);if(c.exp&&(n=c.exp,i=n<=t),i){const{session:f,error:d}=await this._callRefreshToken(r.refresh_token);if(d)return{data:{user:null,session:null},error:d};if(!f)return{data:{user:null,session:null},error:null};l=f}else{const{data:f,error:d}=await this._getUser(r.access_token);if(d)throw d;l={access_token:r.access_token,refresh_token:r.refresh_token,user:f.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(t){if(isAuthError(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(r))}async _refreshSession(r){try{return await this._useSession(async t=>{var n;if(!r){const{data:c,error:f}=t;if(f)throw f;r=(n=c.session)!==null&&n!==void 0?n:void 0}if(!(r!=null&&r.refresh_token))throw new AuthSessionMissingError;const{session:i,error:l}=await this._callRefreshToken(r.refresh_token);return l?{data:{user:null,session:null},error:l}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(isAuthError(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(r,t){try{if(!isBrowser())throw new AuthImplicitGrantRedirectError("No browser detected.");if(r.error||r.error_description||r.error_code)throw new AuthImplicitGrantRedirectError(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new AuthPKCEGrantCodeExchangeError("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new AuthImplicitGrantRedirectError("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!r.code)throw new AuthPKCEGrantCodeExchangeError("No code detected.");const{data:D,error:C}=await this._exchangeCodeForSession(r.code);if(C)throw C;const F=new URL(window.location.href);return F.searchParams.delete("code"),window.history.replaceState(window.history.state,"",F.toString()),{data:{session:D.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:l,refresh_token:c,expires_in:f,expires_at:d,token_type:h}=r;if(!l||!f||!c||!h)throw new AuthImplicitGrantRedirectError("No session defined in URL");const p=Math.round(Date.now()/1e3),E=parseInt(f);let v=p+E;d&&(v=parseInt(d));const S=v-p;S*1e3<=AUTO_REFRESH_TICK_DURATION&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${S}s, should have been closer to ${E}s`);const x=v-E;p-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,v,p):p-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,v,p);const{data:g,error:m}=await this._getUser(l);if(m)throw m;const b={provider_token:n,provider_refresh_token:i,access_token:l,expires_in:E,expires_at:v,refresh_token:c,token_type:h,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:r.type},error:null}}catch(n){if(isAuthError(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(r){return!!(r.access_token||r.error_description)}async _isPKCECallback(r){const t=await getItemAsync(this.storage,`${this.storageKey}-code-verifier`);return!!(r.code&&t)}async signOut(r={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(r))}async _signOut({scope:r}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:i,error:l}=t;if(l)return{error:l};const c=(n=i.session)===null||n===void 0?void 0:n.access_token;if(c){const{error:f}=await this.admin.signOut(c,r);if(f&&!(isAuthApiError(f)&&(f.status===404||f.status===401||f.status===403)))return{error:f}}return r!=="others"&&(await this._removeSession(),await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(r){const t=uuid(),n={id:t,callback:r,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(r){return await this._useSession(async t=>{var n,i;try{const{data:{session:l},error:c}=t;if(c)throw c;await((n=this.stateChangeEmitters.get(r))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",r,"session",l)}catch(l){await((i=this.stateChangeEmitters.get(r))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",r,"error",l),console.error(l)}})}async resetPasswordForEmail(r,t={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await getCodeChallengeAndMethod(this.storage,this.storageKey,!0));try{return await _request(this.fetch,"POST",`${this.url}/recover`,{body:{email:r,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(isAuthError(l))return{data:null,error:l};throw l}}async getUserIdentities(){var r;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(r=t.user.identities)!==null&&r!==void 0?r:[]},error:null}}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}async linkIdentity(r){var t;try{const{data:n,error:i}=await this._useSession(async l=>{var c,f,d,h,p;const{data:E,error:v}=l;if(v)throw v;const S=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,r.provider,{redirectTo:(c=r.options)===null||c===void 0?void 0:c.redirectTo,scopes:(f=r.options)===null||f===void 0?void 0:f.scopes,queryParams:(d=r.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await _request(this.fetch,"GET",S,{headers:this.headers,jwt:(p=(h=E.session)===null||h===void 0?void 0:h.access_token)!==null&&p!==void 0?p:void 0})});if(i)throw i;return isBrowser()&&!(!((t=r.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:r.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(isAuthError(n))return{data:{provider:r.provider,url:null},error:n};throw n}}async unlinkIdentity(r){try{return await this._useSession(async t=>{var n,i;const{data:l,error:c}=t;if(c)throw c;return await _request(this.fetch,"DELETE",`${this.url}/user/identities/${r.identity_id}`,{headers:this.headers,jwt:(i=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}async _refreshAccessToken(r){const t=`#_refreshAccessToken(${r.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await retryable(async i=>(i>0&&await sleep(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await _request(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:r},headers:this.headers,xform:_sessionResponse})),(i,l)=>{const c=200*Math.pow(2,i);return l&&isAuthRetryableFetchError(l)&&Date.now()+c-n<AUTO_REFRESH_TICK_DURATION})}catch(n){if(this._debug(t,"error",n),isAuthError(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(r){return typeof r=="object"&&r!==null&&"access_token"in r&&"refresh_token"in r&&"expires_at"in r}async _handleProviderSignIn(r,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,r,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",r,"options",t,"url",n),isBrowser()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:r,url:n},error:null}}async _recoverAndRefresh(){var r;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const n=await getItemAsync(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n)){this._debug(t,"session is not valid"),n!==null&&await this._removeSession();return}const i=Math.round(Date.now()/1e3),l=((r=n.expires_at)!==null&&r!==void 0?r:1/0)<i+EXPIRY_MARGIN;if(this._debug(t,`session has${l?"":" not"} expired with margin of ${EXPIRY_MARGIN}s`),l){if(this.autoRefreshToken&&n.refresh_token){const{error:c}=await this._callRefreshToken(n.refresh_token);c&&(console.error(c),isAuthRetryableFetchError(c)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(t,"error",n),console.error(n);return}finally{this._debug(t,"end")}}async _callRefreshToken(r){var t,n;if(!r)throw new AuthSessionMissingError;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${r.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Deferred;const{data:l,error:c}=await this._refreshAccessToken(r);if(c)throw c;if(!l.session)throw new AuthSessionMissingError;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const f={session:l.session,error:null};return this.refreshingDeferred.resolve(f),f}catch(l){if(this._debug(i,"error",l),isAuthError(l)){const c={session:null,error:l};return isAuthRetryableFetchError(l)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(l),l}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(r,t,n=!0){const i=`#_notifyAllSubscribers(${r})`;this._debug(i,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:r,session:t});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async f=>{try{await f.callback(r,t)}catch(d){l.push(d)}});if(await Promise.all(c),l.length>0){for(let f=0;f<l.length;f+=1)console.error(l[f]);throw l[0]}}finally{this._debug(i,"end")}}async _saveSession(r){this._debug("#_saveSession()",r),this.suppressGetSessionWarning=!0,await setItemAsync(this.storage,this.storageKey,r)}async _removeSession(){this._debug("#_removeSession()"),await removeItemAsync(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const r=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{r&&isBrowser()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",r)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const r=setInterval(()=>this._autoRefreshTokenTick(),AUTO_REFRESH_TICK_DURATION);this.autoRefreshTicker=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const r=this.autoRefreshTicker;this.autoRefreshTicker=null,r&&clearInterval(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const r=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-r)/AUTO_REFRESH_TICK_DURATION);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${AUTO_REFRESH_TICK_DURATION}ms, refresh threshold is ${AUTO_REFRESH_TICK_THRESHOLD} ticks`),i<=AUTO_REFRESH_TICK_THRESHOLD&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(r){if(r.isAcquireTimeout||r instanceof LockAcquireTimeoutError)this._debug("auto refresh token tick lock not available");else throw r}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!isBrowser()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(r){console.error("_handleVisibilityChange",r)}}async _onVisibilityChanged(r){const t=`#_onVisibilityChanged(${r})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),r||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(r,t,n){const i=[`provider=${encodeURIComponent(t)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[l,c]=await getCodeChallengeAndMethod(this.storage,this.storageKey),f=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});i.push(f.toString())}if(n!=null&&n.queryParams){const l=new URLSearchParams(n.queryParams);i.push(l.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${r}?${i.join("&")}`}async _unenroll(r){try{return await this._useSession(async t=>{var n;const{data:i,error:l}=t;return l?{data:null,error:l}:await _request(this.fetch,"DELETE",`${this.url}/factors/${r.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}async _enroll(r){try{return await this._useSession(async t=>{var n,i;const{data:l,error:c}=t;if(c)return{data:null,error:c};const f=Object.assign({friendly_name:r.friendlyName,factor_type:r.factorType},r.factorType==="phone"?{phone:r.phone}:{issuer:r.issuer}),{data:d,error:h}=await _request(this.fetch,"POST",`${this.url}/factors`,{body:f,headers:this.headers,jwt:(n=l==null?void 0:l.session)===null||n===void 0?void 0:n.access_token});return h?{data:null,error:h}:(r.factorType==="totp"&&(!((i=d==null?void 0:d.totp)===null||i===void 0)&&i.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),{data:d,error:null})})}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}async _verify(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:i,error:l}=t;if(l)return{data:null,error:l};const{data:c,error:f}=await _request(this.fetch,"POST",`${this.url}/factors/${r.factorId}/verify`,{body:{code:r.code,challenge_id:r.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return f?{data:null,error:f}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:f})})}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}})}async _challenge(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:i,error:l}=t;return l?{data:null,error:l}:await _request(this.fetch,"POST",`${this.url}/factors/${r.factorId}/challenge`,{body:{channel:r.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(r){const{data:t,error:n}=await this._challenge({factorId:r.factorId});return n?{data:null,error:n}:await this._verify({factorId:r.factorId,challengeId:t.id,code:r.code})}async _listFactors(){const{data:{user:r},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=(r==null?void 0:r.factors)||[],i=n.filter(c=>c.factor_type==="totp"&&c.status==="verified"),l=n.filter(c=>c.factor_type==="phone"&&c.status==="verified");return{data:{all:n,totp:i,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async r=>{var t,n;const{data:{session:i},error:l}=r;if(l)return{data:null,error:l};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const c=this._decodeJWT(i.access_token);let f=null;c.aal&&(f=c.aal);let d=f;((n=(t=i.user.factors)===null||t===void 0?void 0:t.filter(E=>E.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(d="aal2");const p=c.amr||[];return{data:{currentLevel:f,nextLevel:d,currentAuthenticationMethods:p},error:null}}))}}GoTrueClient.nextInstanceID=0;const AuthClient=GoTrueClient;class SupabaseAuthClient extends AuthClient{constructor(r){super(r)}}var __awaiter=function(e,r,t,n){function i(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(p){try{h(n.next(p))}catch(E){c(E)}}function d(p){try{h(n.throw(p))}catch(E){c(E)}}function h(p){p.done?l(p.value):i(p.value).then(f,d)}h((n=n.apply(e,r||[])).next())})};class SupabaseClient{constructor(r,t,n){var i,l,c;if(this.supabaseUrl=r,this.supabaseKey=t,!r)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const f=stripTrailingSlash(r);this.realtimeUrl=`${f}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${f}/auth/v1`,this.storageUrl=`${f}/storage/v1`,this.functionsUrl=`${f}/functions/v1`;const d=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,h={db:DEFAULT_DB_OPTIONS,realtime:DEFAULT_REALTIME_OPTIONS,auth:Object.assign(Object.assign({},DEFAULT_AUTH_OPTIONS),{storageKey:d}),global:DEFAULT_GLOBAL_OPTIONS},p=applySettingDefaults(n??{},h);this.storageKey=(i=p.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(l=p.global.headers)!==null&&l!==void 0?l:{},p.accessToken?(this.accessToken=p.accessToken,this.auth=new Proxy({},{get:(E,v)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(v)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=p.auth)!==null&&c!==void 0?c:{},this.headers,p.global.fetch),this.fetch=fetchWithAuth(t,this._getAccessToken.bind(this),p.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},p.realtime)),this.rest=new PostgrestClient(`${f}/rest/v1`,{headers:this.headers,schema:p.db.schema,fetch:this.fetch}),p.accessToken||this._listenForAuthEvents()}get functions(){return new FunctionsClient(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new StorageClient(this.storageUrl,this.headers,this.fetch)}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,t={},n={}){return this.rest.rpc(r,t,n)}channel(r,t={config:{}}){return this.realtime.channel(r,t)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var r,t;return __awaiter(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:t,detectSessionInUrl:n,storage:i,storageKey:l,flowType:c,lock:f,debug:d},h,p){const E={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new SupabaseAuthClient({url:this.authUrl,headers:Object.assign(Object.assign({},E),h),storageKey:l,autoRefreshToken:r,persistSession:t,detectSessionInUrl:n,storage:i,flowType:c,lock:f,debug:d,fetch:p,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(r){return new RealtimeClient(this.realtimeUrl,Object.assign(Object.assign({},r),{params:Object.assign({apikey:this.supabaseKey},r==null?void 0:r.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(r,t,n){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:r==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const createClient=(e,r,t)=>new SupabaseClient(e,r,t);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var current_ansi=1252,VALID_ANSI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],CS2CP={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},set_ansi=function(e){VALID_ANSI.indexOf(e)!=-1&&(current_ansi=CS2CP[0]=e)};function reset_ansi(){set_ansi(1252)}var set_cp=function(e){set_ansi(e)};function reset_cp(){set_cp(1200),reset_ansi()}function char_codes(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function utf16leread(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function utf16beread(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var debom=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?utf16leread(e.slice(2)):r==254&&t==255?utf16beread(e.slice(2)):r==65279?e.slice(1):e},_getchar=function(r){return String.fromCharCode(r)},_getansi=function(r){return String.fromCharCode(r)},$cptable,Base64_map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Base64_encode(e){for(var r="",t=0,n=0,i=0,l=0,c=0,f=0,d=0,h=0;h<e.length;)t=e.charCodeAt(h++),l=t>>2,n=e.charCodeAt(h++),c=(t&3)<<4|n>>4,i=e.charCodeAt(h++),f=(n&15)<<2|i>>6,d=i&63,isNaN(n)?f=d=64:isNaN(i)&&(d=64),r+=Base64_map.charAt(l)+Base64_map.charAt(c)+Base64_map.charAt(f)+Base64_map.charAt(d);return r}function Base64_decode(e){var r="",t=0,n=0,i=0,l=0,c=0,f=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)l=Base64_map.indexOf(e.charAt(h++)),c=Base64_map.indexOf(e.charAt(h++)),t=l<<2|c>>4,r+=String.fromCharCode(t),f=Base64_map.indexOf(e.charAt(h++)),n=(c&15)<<4|f>>2,f!==64&&(r+=String.fromCharCode(n)),d=Base64_map.indexOf(e.charAt(h++)),i=(f&3)<<6|d,d!==64&&(r+=String.fromCharCode(i));return r}var has_buf=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Buffer_from=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function new_raw_buf(e){return has_buf?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function new_unsafe_buf(e){return has_buf?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var s2a=function(r){return has_buf?Buffer_from(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function a2s(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function ab2a(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ab2a(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var bconcat=has_buf?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:Buffer_from(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),i=0;for(r=0,t=0;r<e.length;t+=i,++r)if(i=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function utf8decode(e){for(var r=[],t=0,n=e.length+250,i=new_raw_buf(e.length+255),l=0;l<e.length;++l){var c=e.charCodeAt(l);if(c<128)i[t++]=c;else if(c<2048)i[t++]=192|c>>6&31,i[t++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var f=e.charCodeAt(++l)&1023;i[t++]=240|c>>8&7,i[t++]=128|c>>2&63,i[t++]=128|f>>6&15|(c&3)<<4,i[t++]=128|f&63}else i[t++]=224|c>>12&15,i[t++]=128|c>>6&63,i[t++]=128|c&63;t>n&&(r.push(i.slice(0,t)),t=0,i=new_raw_buf(65535),n=65530)}return r.push(i.slice(0,t)),bconcat(r)}var chr0=/\u0000/g,chr1=/[\u0001-\u0006]/g;function _strrev(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function pad0(e,r){var t=""+e;return t.length>=r?t:fill("0",r-t.length)+t}function pad_(e,r){var t=""+e;return t.length>=r?t:fill(" ",r-t.length)+t}function rpad_(e,r){var t=""+e;return t.length>=r?t:t+fill(" ",r-t.length)}function pad0r1(e,r){var t=""+Math.round(e);return t.length>=r?t:fill("0",r-t.length)+t}function pad0r2(e,r){var t=""+e;return t.length>=r?t:fill("0",r-t.length)+t}var p2_32=Math.pow(2,32);function pad0r(e,r){if(e>p2_32||e<-p2_32)return pad0r1(e,r);var t=Math.round(e);return pad0r2(t,r)}function SSF_isgeneral(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var days=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],months=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SSF_init_table(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var table_fmt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},SSF_default_map={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SSF_default_str={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function SSF_frac(e,r,t){for(var n=e<0?-1:1,i=e*n,l=0,c=1,f=0,d=1,h=0,p=0,E=Math.floor(i);h<r&&(E=Math.floor(i),f=E*c+l,p=E*h+d,!(i-E<5e-8));)i=1/(i-E),l=c,c=f,d=h,h=p;if(p>r&&(h>r?(p=d,f=l):(p=h,f=c)),!t)return[0,n*f,p];var v=Math.floor(n*f/p);return[v,n*f-v*p,p]}function SSF_parse_date_code(e,r,t){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),l=0,c=[],f={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(f.u)<1e-6&&(f.u=0),r&&r.date1904&&(n+=1462),f.u>.9999&&(f.u=0,++i==86400&&(f.T=i=0,++n,++f.D)),n===60)c=t?[1317,10,29]:[1900,2,29],l=3;else if(n===0)c=t?[1317,8,29]:[1900,1,0],l=6;else{n>60&&--n;var d=new Date(1900,0,1);d.setDate(d.getDate()+n-1),c=[d.getFullYear(),d.getMonth()+1,d.getDate()],l=d.getDay(),n<60&&(l=(l+6)%7),t&&(l=SSF_fix_hijri(d,c))}return f.y=c[0],f.m=c[1],f.d=c[2],f.S=i%60,i=Math.floor(i/60),f.M=i%60,i=Math.floor(i/60),f.H=i,f.q=l,f}var SSFbasedate=new Date(1899,11,31,0,0,0),SSFdnthresh=SSFbasedate.getTime(),SSFbase1904=new Date(1900,2,1,0,0,0);function datenum_local(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=SSFbase1904&&(t+=24*60*60*1e3),(t-(SSFdnthresh+(e.getTimezoneOffset()-SSFbasedate.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function SSF_strip_decimal(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SSF_normalize_exp(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SSF_small_exp(e){var r=e<0?12:11,t=SSF_strip_decimal(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function SSF_large_exp(e){var r=SSF_strip_decimal(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function SSF_general_num(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=SSF_small_exp(e):r===10?t=e.toFixed(10).substr(0,12):t=SSF_large_exp(e),SSF_strip_decimal(SSF_normalize_exp(t.toUpperCase()))}function SSF_general(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):SSF_general_num(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return SSF_format(14,datenum_local(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function SSF_fix_hijri(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function SSF_write_date(e,r,t,n){var i="",l=0,c=0,f=t.y,d,h=0;switch(e){case 98:f=t.y+543;case 121:switch(r.length){case 1:case 2:d=f%100,h=2;break;default:d=f%1e4,h=4;break}break;case 109:switch(r.length){case 1:case 2:d=t.m,h=r.length;break;case 3:return months[t.m-1][1];case 5:return months[t.m-1][0];default:return months[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:d=t.d,h=r.length;break;case 3:return days[t.q][0];default:return days[t.q][1]}break;case 104:switch(r.length){case 1:case 2:d=1+(t.H+11)%12,h=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:d=t.H,h=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:d=t.M,h=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?pad0(t.S,r.length):(n>=2?c=n===3?1e3:100:c=n===1?10:1,l=Math.round(c*(t.S+t.u)),l>=60*c&&(l=0),r==="s"?l===0?"0":""+l/c:(i=pad0(l,2+n),r==="ss"?i.substr(0,2):"."+i.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":d=t.D*24+t.H;break;case"[m]":case"[mm]":d=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":d=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}h=r.length===3?1:2;break;case 101:d=f,h=1;break}var p=h>0?pad0(d,h):"";return p}function commaify(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var pct1=/%/g;function write_num_pct(e,r,t){var n=r.replace(pct1,""),i=r.length-n.length;return write_num(e,n,t*Math.pow(10,2*i))+fill("%",i)}function write_num_cm(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return write_num(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function write_num_exp(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+write_num_exp(e,-r);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var l=Math.floor(Math.log(r)*Math.LOG10E)%i;if(l<0&&(l+=i),t=(r/Math.pow(10,l)).toPrecision(n+1+(i+l)%i),t.indexOf("e")===-1){var c=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+l):t+="E+"+(c-l);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,d,h,p){return d+h+p.substr(0,(i+l)%i)+"."+p.substr(l)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var frac1=/# (\?+)( ?)\/( ?)(\d+)/;function write_num_f1(e,r,t){var n=parseInt(e[4],10),i=Math.round(r*n),l=Math.floor(i/n),c=i-l*n,f=n;return t+(l===0?"":""+l)+" "+(c===0?fill(" ",e[1].length+1+e[4].length):pad_(c,e[1].length)+e[2]+"/"+e[3]+pad0(f,e[4].length))}function write_num_f2(e,r,t){return t+(r===0?"":""+r)+fill(" ",e[1].length+2+e[4].length)}var dec1=/^#*0*\.([0#]+)/,closeparen=/\).*[0#]/,phone=/\(###\) ###\\?-####/;function hashq(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function rnd(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function dec(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function carry(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function flr(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function write_num_flt(e,r,t){if(e.charCodeAt(0)===40&&!r.match(closeparen)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?write_num_flt("n",n,t):"("+write_num_flt("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return write_num_cm(e,r,t);if(r.indexOf("%")!==-1)return write_num_pct(e,r,t);if(r.indexOf("E")!==-1)return write_num_exp(r,t);if(r.charCodeAt(0)===36)return"$"+write_num_flt(e,r.substr(r.charAt(1)==" "?2:1),t);var i,l,c,f,d=Math.abs(t),h=t<0?"-":"";if(r.match(/^00+$/))return h+pad0r(d,r.length);if(r.match(/^[#?]+$/))return i=pad0r(t,0),i==="0"&&(i=""),i.length>r.length?i:hashq(r.substr(0,r.length-i.length))+i;if(l=r.match(frac1))return write_num_f1(l,d,h);if(r.match(/^#+0+$/))return h+pad0r(d,r.length-r.indexOf("0"));if(l=r.match(dec1))return i=rnd(t,l[1].length).replace(/^([^\.]+)$/,"$1."+hashq(l[1])).replace(/\.$/,"."+hashq(l[1])).replace(/\.(\d*)$/,function(x,g){return"."+g+fill("0",hashq(l[1]).length-g.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),l=r.match(/^(0*)\.(#*)$/))return h+rnd(d,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=r.match(/^#{1,3},##0(\.?)$/))return h+commaify(pad0r(d,0));if(l=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+write_num_flt(e,r,-t):commaify(""+(Math.floor(t)+carry(t,l[1].length)))+"."+pad0(dec(t,l[1].length),l[1].length);if(l=r.match(/^#,#*,#0/))return write_num_flt(e,r.replace(/^#,#*,/,""),t);if(l=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=_strrev(write_num_flt(e,r.replace(/[\\-]/g,""),t)),c=0,_strrev(_strrev(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return c<i.length?i.charAt(c++):x==="0"?"0":""}));if(r.match(phone))return i=write_num_flt(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var p="";if(l=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),f=SSF_frac(d,Math.pow(10,c)-1,!1),i=""+h,p=write_num("n",l[1],f[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),i+=p+l[2]+"/"+l[3],p=rpad_(f[2],c),p.length<l[4].length&&(p=hashq(l[4].substr(l[4].length-p.length))+p),i+=p,i;if(l=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),f=SSF_frac(d,Math.pow(10,c)-1,!0),h+(f[0]||(f[1]?"":"0"))+" "+(f[1]?pad_(f[1],c)+l[2]+"/"+l[3]+rpad_(f[2],c):fill(" ",2*c+1+l[2].length+l[3].length));if(l=r.match(/^[#0?]+$/))return i=pad0r(t,0),r.length<=i.length?i:hashq(r.substr(0,r.length-i.length))+i;if(l=r.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=i.indexOf(".");var E=r.indexOf(".")-c,v=r.length-i.length-E;return hashq(r.substr(0,E)+i+r.substr(r.length-v))}if(l=r.match(/^00,000\.([#0]*0)$/))return c=dec(t,l[1].length),t<0?"-"+write_num_flt(e,r,-t):commaify(flr(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?pad0(0,3-x.length):"")+x})+"."+pad0(c,l[1].length);switch(r){case"###,##0.00":return write_num_flt(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var S=commaify(pad0r(d,0));return S!=="0"?h+S:"";case"###,###.00":return write_num_flt(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return write_num_flt(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function write_num_cm2(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return write_num(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function write_num_pct2(e,r,t){var n=r.replace(pct1,""),i=r.length-n.length;return write_num(e,n,t*Math.pow(10,2*i))+fill("%",i)}function write_num_exp2(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+write_num_exp2(e,-r);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var l=Math.floor(Math.log(r)*Math.LOG10E)%i;if(l<0&&(l+=i),t=(r/Math.pow(10,l)).toPrecision(n+1+(i+l)%i),!t.match(/[Ee]/)){var c=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+l):t+="E+"+(c-l),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,d,h,p){return d+h+p.substr(0,(i+l)%i)+"."+p.substr(l)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function write_num_int(e,r,t){if(e.charCodeAt(0)===40&&!r.match(closeparen)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?write_num_int("n",n,t):"("+write_num_int("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return write_num_cm2(e,r,t);if(r.indexOf("%")!==-1)return write_num_pct2(e,r,t);if(r.indexOf("E")!==-1)return write_num_exp2(r,t);if(r.charCodeAt(0)===36)return"$"+write_num_int(e,r.substr(r.charAt(1)==" "?2:1),t);var i,l,c,f,d=Math.abs(t),h=t<0?"-":"";if(r.match(/^00+$/))return h+pad0(d,r.length);if(r.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>r.length?i:hashq(r.substr(0,r.length-i.length))+i;if(l=r.match(frac1))return write_num_f2(l,d,h);if(r.match(/^#+0+$/))return h+pad0(d,r.length-r.indexOf("0"));if(l=r.match(dec1))return i=(""+t).replace(/^([^\.]+)$/,"$1."+hashq(l[1])).replace(/\.$/,"."+hashq(l[1])),i=i.replace(/\.(\d*)$/,function(x,g){return"."+g+fill("0",hashq(l[1]).length-g.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),l=r.match(/^(0*)\.(#*)$/))return h+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=r.match(/^#{1,3},##0(\.?)$/))return h+commaify(""+d);if(l=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+write_num_int(e,r,-t):commaify(""+t)+"."+fill("0",l[1].length);if(l=r.match(/^#,#*,#0/))return write_num_int(e,r.replace(/^#,#*,/,""),t);if(l=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=_strrev(write_num_int(e,r.replace(/[\\-]/g,""),t)),c=0,_strrev(_strrev(r.replace(/\\/g,"")).replace(/[0#]/g,function(x){return c<i.length?i.charAt(c++):x==="0"?"0":""}));if(r.match(phone))return i=write_num_int(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var p="";if(l=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),f=SSF_frac(d,Math.pow(10,c)-1,!1),i=""+h,p=write_num("n",l[1],f[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),i+=p+l[2]+"/"+l[3],p=rpad_(f[2],c),p.length<l[4].length&&(p=hashq(l[4].substr(l[4].length-p.length))+p),i+=p,i;if(l=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),f=SSF_frac(d,Math.pow(10,c)-1,!0),h+(f[0]||(f[1]?"":"0"))+" "+(f[1]?pad_(f[1],c)+l[2]+"/"+l[3]+rpad_(f[2],c):fill(" ",2*c+1+l[2].length+l[3].length));if(l=r.match(/^[#0?]+$/))return i=""+t,r.length<=i.length?i:hashq(r.substr(0,r.length-i.length))+i;if(l=r.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=i.indexOf(".");var E=r.indexOf(".")-c,v=r.length-i.length-E;return hashq(r.substr(0,E)+i+r.substr(r.length-v))}if(l=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+write_num_int(e,r,-t):commaify(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?pad0(0,3-x.length):"")+x})+"."+pad0(0,l[1].length);switch(r){case"###,###":case"##,###":case"#,###":var S=commaify(""+d);return S!=="0"?h+S:"";default:if(r.match(/\.[0#?]*$/))return write_num_int(e,r.slice(0,r.lastIndexOf(".")),t)+hashq(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function write_num(e,r,t){return(t|0)===t?write_num_int(e,r,t):write_num_flt(e,r,t)}function SSF_split_fmt(e){for(var r=[],t=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(i,n-i),i=n+1}if(r[r.length]=e.substr(i),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var SSF_abstime=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fmt_is_date(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":SSF_isgeneral(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(SSF_abstime))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function eval_fmt(e,r,t,n){for(var i=[],l="",c=0,f="",d="t",h,p,E,v="H";c<e.length;)switch(f=e.charAt(c)){case"G":if(!SSF_isgeneral(e,c))throw new Error("unrecognized character "+f+" in "+e);i[i.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";(E=e.charCodeAt(++c))!==34&&c<e.length;)l+=String.fromCharCode(E);i[i.length]={t:"t",v:l},++c;break;case"\\":var S=e.charAt(++c),x=S==="("||S===")"?S:"t";i[i.length]={t:x,v:S},++c;break;case"_":i[i.length]={t:"t",v:" "},c+=2;break;case"@":i[i.length]={t:"T",v:r},++c;break;case"B":case"b":if(e.charAt(c+1)==="1"||e.charAt(c+1)==="2"){if(h==null&&(h=SSF_parse_date_code(r,t,e.charAt(c+1)==="2"),h==null))return"";i[i.length]={t:"X",v:e.substr(c,2)},d=f,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":f=f.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||h==null&&(h=SSF_parse_date_code(r,t),h==null))return"";for(l=f;++c<e.length&&e.charAt(c).toLowerCase()===f;)l+=f;f==="m"&&d.toLowerCase()==="h"&&(f="M"),f==="h"&&(f=v),i[i.length]={t:f,v:l},d=f;break;case"A":case"a":case"":var g={t:f,v:f};if(h==null&&(h=SSF_parse_date_code(r,t)),e.substr(c,3).toUpperCase()==="A/P"?(h!=null&&(g.v=h.H>=12?"P":"A"),g.t="T",v="h",c+=3):e.substr(c,5).toUpperCase()==="AM/PM"?(h!=null&&(g.v=h.H>=12?"PM":"AM"),g.t="T",c+=5,v="h"):e.substr(c,5).toUpperCase()==="/"?(h!=null&&(g.v=h.H>=12?"":""),g.t="T",c+=5,v="h"):(g.t="t",++c),h==null&&g.t==="T")return"";i[i.length]=g,d=f;break;case"[":for(l=f;e.charAt(c++)!=="]"&&c<e.length;)l+=e.charAt(c);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(SSF_abstime)){if(h==null&&(h=SSF_parse_date_code(r,t),h==null))return"";i[i.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",fmt_is_date(e)||(i[i.length]={t:"t",v:l}));break;case".":if(h!=null){for(l=f;++c<e.length&&(f=e.charAt(c))==="0";)l+=f;i[i.length]={t:"s",v:l};break}case"0":case"#":for(l=f;++c<e.length&&"0#?.,E+-%".indexOf(f=e.charAt(c))>-1;)l+=f;i[i.length]={t:"n",v:l};break;case"?":for(l=f;e.charAt(++c)===f;)l+=f;i[i.length]={t:f,v:l},d=f;break;case"*":++c,(e.charAt(c)==" "||e.charAt(c)=="*")&&++c;break;case"(":case")":i[i.length]={t:n===1?"t":f,v:f},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=f;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);i[i.length]={t:"D",v:l};break;case" ":i[i.length]={t:f,v:f},++c;break;case"$":i[i.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(f)===-1)throw new Error("unrecognized character "+f+" in "+e);i[i.length]={t:"t",v:f},++c;break}var m=0,b=0,D;for(c=i.length-1,d="t";c>=0;--c)switch(i[c].t){case"h":case"H":i[c].t=v,d="h",m<1&&(m=1);break;case"s":(D=i[c].v.match(/\.0+$/))&&(b=Math.max(b,D[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":d=i[c].t;break;case"m":d==="s"&&(i[c].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&i[c].v.match(/[Hh]/)&&(m=1),m<2&&i[c].v.match(/[Mm]/)&&(m=2),m<3&&i[c].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var C="",F;for(c=0;c<i.length;++c)switch(i[c].t){case"t":case"T":case" ":case"D":break;case"X":i[c].v="",i[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[c].v=SSF_write_date(i[c].t.charCodeAt(0),i[c].v,h,b),i[c].t="t";break;case"n":case"?":for(F=c+1;i[F]!=null&&((f=i[F].t)==="?"||f==="D"||(f===" "||f==="t")&&i[F+1]!=null&&(i[F+1].t==="?"||i[F+1].t==="t"&&i[F+1].v==="/")||i[c].t==="("&&(f===" "||f==="n"||f===")")||f==="t"&&(i[F].v==="/"||i[F].v===" "&&i[F+1]!=null&&i[F+1].t=="?"));)i[c].v+=i[F].v,i[F]={v:"",t:";"},++F;C+=i[c].v,c=F-1;break;case"G":i[c].t="t",i[c].v=SSF_general(r,t);break}var T="",w,y;if(C.length>0){C.charCodeAt(0)==40?(w=r<0&&C.charCodeAt(0)===45?-r:r,y=write_num("n",C,w)):(w=r<0&&n>1?-r:r,y=write_num("n",C,w),w<0&&i[0]&&i[0].t=="t"&&(y=y.substr(1),i[0].v="-"+i[0].v)),F=y.length-1;var N=i.length;for(c=0;c<i.length;++c)if(i[c]!=null&&i[c].t!="t"&&i[c].v.indexOf(".")>-1){N=c;break}var L=i.length;if(N===i.length&&y.indexOf("E")===-1){for(c=i.length-1;c>=0;--c)i[c]==null||"n?".indexOf(i[c].t)===-1||(F>=i[c].v.length-1?(F-=i[c].v.length,i[c].v=y.substr(F+1,i[c].v.length)):F<0?i[c].v="":(i[c].v=y.substr(0,F+1),F=-1),i[c].t="t",L=c);F>=0&&L<i.length&&(i[L].v=y.substr(0,F+1)+i[L].v)}else if(N!==i.length&&y.indexOf("E")===-1){for(F=y.indexOf(".")-1,c=N;c>=0;--c)if(!(i[c]==null||"n?".indexOf(i[c].t)===-1)){for(p=i[c].v.indexOf(".")>-1&&c===N?i[c].v.indexOf(".")-1:i[c].v.length-1,T=i[c].v.substr(p+1);p>=0;--p)F>=0&&(i[c].v.charAt(p)==="0"||i[c].v.charAt(p)==="#")&&(T=y.charAt(F--)+T);i[c].v=T,i[c].t="t",L=c}for(F>=0&&L<i.length&&(i[L].v=y.substr(0,F+1)+i[L].v),F=y.indexOf(".")+1,c=N;c<i.length;++c)if(!(i[c]==null||"n?(".indexOf(i[c].t)===-1&&c!==N)){for(p=i[c].v.indexOf(".")>-1&&c===N?i[c].v.indexOf(".")+1:0,T=i[c].v.substr(0,p);p<i[c].v.length;++p)F<y.length&&(T+=y.charAt(F++));i[c].v=T,i[c].t="t",L=c}}}for(c=0;c<i.length;++c)i[c]!=null&&"n?".indexOf(i[c].t)>-1&&(w=n>1&&r<0&&c>0&&i[c-1].v==="-"?-r:r,i[c].v=write_num(i[c].t,i[c].v,w),i[c].t="t");var X="";for(c=0;c!==i.length;++c)i[c]!=null&&(X+=i[c].v);return X}var cfregex2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function chkcond(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function choose_fmt(e,r){var t=SSF_split_fmt(e),n=t.length,i=t[n-1].indexOf("@");if(n<4&&i>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var l=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,l];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var c=t[0].match(cfregex2),f=t[1].match(cfregex2);return chkcond(r,c)?[n,t[0]]:chkcond(r,f)?[n,t[1]]:[n,t[c!=null&&f!=null?2:1]]}return[n,l]}function SSF_format(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:table_fmt)[e],n==null&&(n=t.table&&t.table[SSF_default_map[e]]||table_fmt[SSF_default_map[e]]),n==null&&(n=SSF_default_str[e]||"General");break}if(SSF_isgeneral(n,0))return SSF_general(r,t);r instanceof Date&&(r=datenum_local(r,t.date1904));var i=choose_fmt(n,r);if(SSF_isgeneral(i[1]))return SSF_general(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return eval_fmt(i[1],r,t,i[0])}function SSF_load(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(table_fmt[t]==null){r<0&&(r=t);continue}if(table_fmt[t]==e){r=t;break}}r<0&&(r=391)}return table_fmt[r]=e,r}function make_ssf(){table_fmt=SSF_init_table()}var SSFImplicit={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},dateNFregex=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dateNF_regex(e){var r=typeof e=="number"?table_fmt[e]:e;return r=r.replace(dateNFregex,"(\\d+)"),new RegExp("^"+r+"$")}function dateNF_fix(e,r,t){var n=-1,i=-1,l=-1,c=-1,f=-1,d=-1;(r.match(dateNFregex)||[]).forEach(function(E,v){var S=parseInt(t[v+1],10);switch(E.toLowerCase().charAt(0)){case"y":n=S;break;case"d":l=S;break;case"h":c=S;break;case"s":d=S;break;case"m":c>=0?f=S:i=S;break}}),d>=0&&f==-1&&i>=0&&(f=i,i=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var p=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return c==-1&&f==-1&&d==-1?h:n==-1&&i==-1&&l==-1?p:h+"T"+p}var CRC32=function(){var e={};e.version="1.2.0";function r(){for(var y=0,N=new Array(256),L=0;L!=256;++L)y=L,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,N[L]=y;return typeof Int32Array<"u"?new Int32Array(N):N}var t=r();function n(y){var N=0,L=0,X=0,z=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(X=0;X!=256;++X)z[X]=y[X];for(X=0;X!=256;++X)for(L=y[X],N=256+X;N<4096;N+=256)L=z[N]=L>>>8^y[L&255];var se=[];for(X=1;X!=16;++X)se[X-1]=typeof Int32Array<"u"?z.subarray(X*256,X*256+256):z.slice(X*256,X*256+256);return se}var i=n(t),l=i[0],c=i[1],f=i[2],d=i[3],h=i[4],p=i[5],E=i[6],v=i[7],S=i[8],x=i[9],g=i[10],m=i[11],b=i[12],D=i[13],C=i[14];function F(y,N){for(var L=N^-1,X=0,z=y.length;X<z;)L=L>>>8^t[(L^y.charCodeAt(X++))&255];return~L}function T(y,N){for(var L=N^-1,X=y.length-15,z=0;z<X;)L=C[y[z++]^L&255]^D[y[z++]^L>>8&255]^b[y[z++]^L>>16&255]^m[y[z++]^L>>>24]^g[y[z++]]^x[y[z++]]^S[y[z++]]^v[y[z++]]^E[y[z++]]^p[y[z++]]^h[y[z++]]^d[y[z++]]^f[y[z++]]^c[y[z++]]^l[y[z++]]^t[y[z++]];for(X+=15;z<X;)L=L>>>8^t[(L^y[z++])&255];return~L}function w(y,N){for(var L=N^-1,X=0,z=y.length,se=0,me=0;X<z;)se=y.charCodeAt(X++),se<128?L=L>>>8^t[(L^se)&255]:se<2048?(L=L>>>8^t[(L^(192|se>>6&31))&255],L=L>>>8^t[(L^(128|se&63))&255]):se>=55296&&se<57344?(se=(se&1023)+64,me=y.charCodeAt(X++)&1023,L=L>>>8^t[(L^(240|se>>8&7))&255],L=L>>>8^t[(L^(128|se>>2&63))&255],L=L>>>8^t[(L^(128|me>>6&15|(se&3)<<4))&255],L=L>>>8^t[(L^(128|me&63))&255]):(L=L>>>8^t[(L^(224|se>>12&15))&255],L=L>>>8^t[(L^(128|se>>6&63))&255],L=L>>>8^t[(L^(128|se&63))&255]);return~L}return e.table=t,e.bstr=F,e.buf=T,e.str=w,e}(),CFB=function(){var r={};r.version="1.2.1";function t(q,ce){for(var te=q.split("/"),ne=ce.split("/"),ue=0,he=0,Oe=Math.min(te.length,ne.length);ue<Oe;++ue){if(he=te[ue].length-ne[ue].length)return he;if(te[ue]!=ne[ue])return te[ue]<ne[ue]?-1:1}return te.length-ne.length}function n(q){if(q.charAt(q.length-1)=="/")return q.slice(0,-1).indexOf("/")===-1?q:n(q.slice(0,-1));var ce=q.lastIndexOf("/");return ce===-1?q:q.slice(0,ce+1)}function i(q){if(q.charAt(q.length-1)=="/")return i(q.slice(0,-1));var ce=q.lastIndexOf("/");return ce===-1?q:q.slice(ce+1)}function l(q,ce){typeof ce=="string"&&(ce=new Date(ce));var te=ce.getHours();te=te<<6|ce.getMinutes(),te=te<<5|ce.getSeconds()>>>1,q.write_shift(2,te);var ne=ce.getFullYear()-1980;ne=ne<<4|ce.getMonth()+1,ne=ne<<5|ce.getDate(),q.write_shift(2,ne)}function c(q){var ce=q.read_shift(2)&65535,te=q.read_shift(2)&65535,ne=new Date,ue=te&31;te>>>=5;var he=te&15;te>>>=4,ne.setMilliseconds(0),ne.setFullYear(te+1980),ne.setMonth(he-1),ne.setDate(ue);var Oe=ce&31;ce>>>=5;var Ie=ce&63;return ce>>>=6,ne.setHours(ce),ne.setMinutes(Ie),ne.setSeconds(Oe<<1),ne}function f(q){prep_blob(q,0);for(var ce={},te=0;q.l<=q.length-4;){var ne=q.read_shift(2),ue=q.read_shift(2),he=q.l+ue,Oe={};switch(ne){case 21589:te=q.read_shift(1),te&1&&(Oe.mtime=q.read_shift(4)),ue>5&&(te&2&&(Oe.atime=q.read_shift(4)),te&4&&(Oe.ctime=q.read_shift(4))),Oe.mtime&&(Oe.mt=new Date(Oe.mtime*1e3));break}q.l=he,ce[ne]=Oe}return ce}var d;function h(){return d||(d={})}function p(q,ce){if(q[0]==80&&q[1]==75)return Ae(q,ce);if((q[0]|32)==109&&(q[1]|32)==105)return _r(q,ce);if(q.length<512)throw new Error("CFB file size "+q.length+" < 512");var te=3,ne=512,ue=0,he=0,Oe=0,Ie=0,Re=0,Fe=[],De=q.slice(0,512);prep_blob(De,0);var ze=E(De);switch(te=ze[0],te){case 3:ne=512;break;case 4:ne=4096;break;case 0:if(ze[1]==0)return Ae(q,ce);default:throw new Error("Major Version: Expected 3 or 4 saw "+te)}ne!==512&&(De=q.slice(0,ne),prep_blob(De,28));var We=q.slice(0,ne);v(De,te);var Ke=De.read_shift(4,"i");if(te===3&&Ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ke);De.l+=4,Oe=De.read_shift(4,"i"),De.l+=4,De.chk("00100000","Mini Stream Cutoff Size: "),Ie=De.read_shift(4,"i"),ue=De.read_shift(4,"i"),Re=De.read_shift(4,"i"),he=De.read_shift(4,"i");for(var Xe=-1,Ge=0;Ge<109&&(Xe=De.read_shift(4,"i"),!(Xe<0));++Ge)Fe[Ge]=Xe;var ut=S(q,ne);m(Re,he,ut,ne,Fe);var Ct=D(ut,Oe,Fe,ne);Ct[Oe].name="!Directory",ue>0&&Ie!==me&&(Ct[Ie].name="!MiniFAT"),Ct[Fe[0]].name="!FAT",Ct.fat_addrs=Fe,Ct.ssz=ne;var At={},Ot=[],rr=[],Ra=[];C(Oe,Ct,ut,Ot,ue,At,rr,Ie),x(rr,Ra,Ot),Ot.shift();var oa={FileIndex:rr,FullPaths:Ra};return ce&&ce.raw&&(oa.raw={header:We,sectors:ut}),oa}function E(q){if(q[q.l]==80&&q[q.l+1]==75)return[0,0];q.chk(_e,"Header Signature: "),q.l+=16;var ce=q.read_shift(2,"u");return[q.read_shift(2,"u"),ce]}function v(q,ce){var te=9;switch(q.l+=2,te=q.read_shift(2)){case 9:if(ce!=3)throw new Error("Sector Shift: Expected 9 saw "+te);break;case 12:if(ce!=4)throw new Error("Sector Shift: Expected 12 saw "+te);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+te)}q.chk("0600","Mini Sector Shift: "),q.chk("000000000000","Reserved: ")}function S(q,ce){for(var te=Math.ceil(q.length/ce)-1,ne=[],ue=1;ue<te;++ue)ne[ue-1]=q.slice(ue*ce,(ue+1)*ce);return ne[te-1]=q.slice(te*ce),ne}function x(q,ce,te){for(var ne=0,ue=0,he=0,Oe=0,Ie=0,Re=te.length,Fe=[],De=[];ne<Re;++ne)Fe[ne]=De[ne]=ne,ce[ne]=te[ne];for(;Ie<De.length;++Ie)ne=De[Ie],ue=q[ne].L,he=q[ne].R,Oe=q[ne].C,Fe[ne]===ne&&(ue!==-1&&Fe[ue]!==ue&&(Fe[ne]=Fe[ue]),he!==-1&&Fe[he]!==he&&(Fe[ne]=Fe[he])),Oe!==-1&&(Fe[Oe]=ne),ue!==-1&&ne!=Fe[ne]&&(Fe[ue]=Fe[ne],De.lastIndexOf(ue)<Ie&&De.push(ue)),he!==-1&&ne!=Fe[ne]&&(Fe[he]=Fe[ne],De.lastIndexOf(he)<Ie&&De.push(he));for(ne=1;ne<Re;++ne)Fe[ne]===ne&&(he!==-1&&Fe[he]!==he?Fe[ne]=Fe[he]:ue!==-1&&Fe[ue]!==ue&&(Fe[ne]=Fe[ue]));for(ne=1;ne<Re;++ne)if(q[ne].type!==0){if(Ie=ne,Ie!=Fe[Ie])do Ie=Fe[Ie],ce[ne]=ce[Ie]+"/"+ce[ne];while(Ie!==0&&Fe[Ie]!==-1&&Ie!=Fe[Ie]);Fe[ne]=-1}for(ce[0]+="/",ne=1;ne<Re;++ne)q[ne].type!==2&&(ce[ne]+="/")}function g(q,ce,te){for(var ne=q.start,ue=q.size,he=[],Oe=ne;te&&ue>0&&Oe>=0;)he.push(ce.slice(Oe*se,Oe*se+se)),ue-=se,Oe=__readInt32LE(te,Oe*4);return he.length===0?new_buf(0):bconcat(he).slice(0,q.size)}function m(q,ce,te,ne,ue){var he=me;if(q===me){if(ce!==0)throw new Error("DIFAT chain shorter than expected")}else if(q!==-1){var Oe=te[q],Ie=(ne>>>2)-1;if(!Oe)return;for(var Re=0;Re<Ie&&(he=__readInt32LE(Oe,Re*4))!==me;++Re)ue.push(he);m(__readInt32LE(Oe,ne-4),ce-1,te,ne,ue)}}function b(q,ce,te,ne,ue){var he=[],Oe=[];ue||(ue=[]);var Ie=ne-1,Re=0,Fe=0;for(Re=ce;Re>=0;){ue[Re]=!0,he[he.length]=Re,Oe.push(q[Re]);var De=te[Math.floor(Re*4/ne)];if(Fe=Re*4&Ie,ne<4+Fe)throw new Error("FAT boundary crossed: "+Re+" 4 "+ne);if(!q[De])break;Re=__readInt32LE(q[De],Fe)}return{nodes:he,data:__toBuffer([Oe])}}function D(q,ce,te,ne){var ue=q.length,he=[],Oe=[],Ie=[],Re=[],Fe=ne-1,De=0,ze=0,We=0,Ke=0;for(De=0;De<ue;++De)if(Ie=[],We=De+ce,We>=ue&&(We-=ue),!Oe[We]){Re=[];var Xe=[];for(ze=We;ze>=0;){Xe[ze]=!0,Oe[ze]=!0,Ie[Ie.length]=ze,Re.push(q[ze]);var Ge=te[Math.floor(ze*4/ne)];if(Ke=ze*4&Fe,ne<4+Ke)throw new Error("FAT boundary crossed: "+ze+" 4 "+ne);if(!q[Ge]||(ze=__readInt32LE(q[Ge],Ke),Xe[ze]))break}he[We]={nodes:Ie,data:__toBuffer([Re])}}return he}function C(q,ce,te,ne,ue,he,Oe,Ie){for(var Re=0,Fe=ne.length?2:0,De=ce[q].data,ze=0,We=0,Ke;ze<De.length;ze+=128){var Xe=De.slice(ze,ze+128);prep_blob(Xe,64),We=Xe.read_shift(2),Ke=__utf16le(Xe,0,We-Fe),ne.push(Ke);var Ge={name:Ke,type:Xe.read_shift(1),color:Xe.read_shift(1),L:Xe.read_shift(4,"i"),R:Xe.read_shift(4,"i"),C:Xe.read_shift(4,"i"),clsid:Xe.read_shift(16),state:Xe.read_shift(4,"i"),start:0,size:0},ut=Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2);ut!==0&&(Ge.ct=F(Xe,Xe.l-8));var Ct=Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2)+Xe.read_shift(2);Ct!==0&&(Ge.mt=F(Xe,Xe.l-8)),Ge.start=Xe.read_shift(4,"i"),Ge.size=Xe.read_shift(4,"i"),Ge.size<0&&Ge.start<0&&(Ge.size=Ge.type=0,Ge.start=me,Ge.name=""),Ge.type===5?(Re=Ge.start,ue>0&&Re!==me&&(ce[Re].name="!StreamData")):Ge.size>=4096?(Ge.storage="fat",ce[Ge.start]===void 0&&(ce[Ge.start]=b(te,Ge.start,ce.fat_addrs,ce.ssz)),ce[Ge.start].name=Ge.name,Ge.content=ce[Ge.start].data.slice(0,Ge.size)):(Ge.storage="minifat",Ge.size<0?Ge.size=0:Re!==me&&Ge.start!==me&&ce[Re]&&(Ge.content=g(Ge,ce[Re].data,(ce[Ie]||{}).data))),Ge.content&&prep_blob(Ge.content,0),he[Ke]=Ge,Oe.push(Ge)}}function F(q,ce){return new Date((__readUInt32LE(q,ce+4)/1e7*Math.pow(2,32)+__readUInt32LE(q,ce)/1e7-11644473600)*1e3)}function T(q,ce){return h(),p(d.readFileSync(q),ce)}function w(q,ce){var te=ce&&ce.type;switch(te||has_buf&&Buffer.isBuffer(q)&&(te="buffer"),te||"base64"){case"file":return T(q,ce);case"base64":return p(s2a(Base64_decode(q)),ce);case"binary":return p(s2a(q),ce)}return p(q,ce)}function y(q,ce){var te=ce||{},ne=te.root||"Root Entry";if(q.FullPaths||(q.FullPaths=[]),q.FileIndex||(q.FileIndex=[]),q.FullPaths.length!==q.FileIndex.length)throw new Error("inconsistent CFB structure");q.FullPaths.length===0&&(q.FullPaths[0]=ne+"/",q.FileIndex[0]={name:ne,type:5}),te.CLSID&&(q.FileIndex[0].clsid=te.CLSID),N(q)}function N(q){var ce="Sh33tJ5";if(!CFB.find(q,"/"+ce)){var te=new_buf(4);te[0]=55,te[1]=te[3]=50,te[2]=54,q.FileIndex.push({name:ce,type:2,content:te,size:4,L:69,R:69,C:69}),q.FullPaths.push(q.FullPaths[0]+ce),L(q)}}function L(q,ce){y(q);for(var te=!1,ne=!1,ue=q.FullPaths.length-1;ue>=0;--ue){var he=q.FileIndex[ue];switch(he.type){case 0:ne?te=!0:(q.FileIndex.pop(),q.FullPaths.pop());break;case 1:case 2:case 5:ne=!0,isNaN(he.R*he.L*he.C)&&(te=!0),he.R>-1&&he.L>-1&&he.R==he.L&&(te=!0);break;default:te=!0;break}}if(!(!te&&!ce)){var Oe=new Date(1987,1,19),Ie=0,Re=Object.create?Object.create(null):{},Fe=[];for(ue=0;ue<q.FullPaths.length;++ue)Re[q.FullPaths[ue]]=!0,q.FileIndex[ue].type!==0&&Fe.push([q.FullPaths[ue],q.FileIndex[ue]]);for(ue=0;ue<Fe.length;++ue){var De=n(Fe[ue][0]);ne=Re[De],ne||(Fe.push([De,{name:i(De).replace("/",""),type:1,clsid:Y,ct:Oe,mt:Oe,content:null}]),Re[De]=!0)}for(Fe.sort(function(Ke,Xe){return t(Ke[0],Xe[0])}),q.FullPaths=[],q.FileIndex=[],ue=0;ue<Fe.length;++ue)q.FullPaths[ue]=Fe[ue][0],q.FileIndex[ue]=Fe[ue][1];for(ue=0;ue<Fe.length;++ue){var ze=q.FileIndex[ue],We=q.FullPaths[ue];if(ze.name=i(We).replace("/",""),ze.L=ze.R=ze.C=-(ze.color=1),ze.size=ze.content?ze.content.length:0,ze.start=0,ze.clsid=ze.clsid||Y,ue===0)ze.C=Fe.length>1?1:-1,ze.size=0,ze.type=5;else if(We.slice(-1)=="/"){for(Ie=ue+1;Ie<Fe.length&&n(q.FullPaths[Ie])!=We;++Ie);for(ze.C=Ie>=Fe.length?-1:Ie,Ie=ue+1;Ie<Fe.length&&n(q.FullPaths[Ie])!=n(We);++Ie);ze.R=Ie>=Fe.length?-1:Ie,ze.type=1}else n(q.FullPaths[ue+1]||"")==n(We)&&(ze.R=ue+1),ze.type=2}}}function X(q,ce){var te=ce||{};if(te.fileType=="mad")return er(q,te);switch(L(q),te.fileType){case"zip":return lt(q,te)}var ne=function(Ke){for(var Xe=0,Ge=0,ut=0;ut<Ke.FileIndex.length;++ut){var Ct=Ke.FileIndex[ut];if(Ct.content){var At=Ct.content.length;At>0&&(At<4096?Xe+=At+63>>6:Ge+=At+511>>9)}}for(var Ot=Ke.FullPaths.length+3>>2,rr=Xe+7>>3,Ra=Xe+127>>7,oa=rr+Ge+Ot+Ra,Mr=oa+127>>7,Rn=Mr<=109?0:Math.ceil((Mr-109)/127);oa+Mr+Rn+127>>7>Mr;)Rn=++Mr<=109?0:Math.ceil((Mr-109)/127);var sr=[1,Rn,Mr,Ra,Ot,Ge,Xe,0];return Ke.FileIndex[0].size=Xe<<6,sr[7]=(Ke.FileIndex[0].start=sr[0]+sr[1]+sr[2]+sr[3]+sr[4]+sr[5])+(sr[6]+7>>3),sr}(q),ue=new_buf(ne[7]<<9),he=0,Oe=0;{for(he=0;he<8;++he)ue.write_shift(1,de[he]);for(he=0;he<8;++he)ue.write_shift(2,0);for(ue.write_shift(2,62),ue.write_shift(2,3),ue.write_shift(2,65534),ue.write_shift(2,9),ue.write_shift(2,6),he=0;he<3;++he)ue.write_shift(2,0);for(ue.write_shift(4,0),ue.write_shift(4,ne[2]),ue.write_shift(4,ne[0]+ne[1]+ne[2]+ne[3]-1),ue.write_shift(4,0),ue.write_shift(4,4096),ue.write_shift(4,ne[3]?ne[0]+ne[1]+ne[2]-1:me),ue.write_shift(4,ne[3]),ue.write_shift(-4,ne[1]?ne[0]-1:me),ue.write_shift(4,ne[1]),he=0;he<109;++he)ue.write_shift(-4,he<ne[2]?ne[1]+he:-1)}if(ne[1])for(Oe=0;Oe<ne[1];++Oe){for(;he<236+Oe*127;++he)ue.write_shift(-4,he<ne[2]?ne[1]+he:-1);ue.write_shift(-4,Oe===ne[1]-1?me:Oe+1)}var Ie=function(Ke){for(Oe+=Ke;he<Oe-1;++he)ue.write_shift(-4,he+1);Ke&&(++he,ue.write_shift(-4,me))};for(Oe=he=0,Oe+=ne[1];he<Oe;++he)ue.write_shift(-4,ie.DIFSECT);for(Oe+=ne[2];he<Oe;++he)ue.write_shift(-4,ie.FATSECT);Ie(ne[3]),Ie(ne[4]);for(var Re=0,Fe=0,De=q.FileIndex[0];Re<q.FileIndex.length;++Re)De=q.FileIndex[Re],De.content&&(Fe=De.content.length,!(Fe<4096)&&(De.start=Oe,Ie(Fe+511>>9)));for(Ie(ne[6]+7>>3);ue.l&511;)ue.write_shift(-4,ie.ENDOFCHAIN);for(Oe=he=0,Re=0;Re<q.FileIndex.length;++Re)De=q.FileIndex[Re],De.content&&(Fe=De.content.length,!(!Fe||Fe>=4096)&&(De.start=Oe,Ie(Fe+63>>6)));for(;ue.l&511;)ue.write_shift(-4,ie.ENDOFCHAIN);for(he=0;he<ne[4]<<2;++he){var ze=q.FullPaths[he];if(!ze||ze.length===0){for(Re=0;Re<17;++Re)ue.write_shift(4,0);for(Re=0;Re<3;++Re)ue.write_shift(4,-1);for(Re=0;Re<12;++Re)ue.write_shift(4,0);continue}De=q.FileIndex[he],he===0&&(De.start=De.size?De.start-1:me);var We=he===0&&te.root||De.name;if(Fe=2*(We.length+1),ue.write_shift(64,We,"utf16le"),ue.write_shift(2,Fe),ue.write_shift(1,De.type),ue.write_shift(1,De.color),ue.write_shift(-4,De.L),ue.write_shift(-4,De.R),ue.write_shift(-4,De.C),De.clsid)ue.write_shift(16,De.clsid,"hex");else for(Re=0;Re<4;++Re)ue.write_shift(4,0);ue.write_shift(4,De.state||0),ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(4,De.start),ue.write_shift(4,De.size),ue.write_shift(4,0)}for(he=1;he<q.FileIndex.length;++he)if(De=q.FileIndex[he],De.size>=4096)if(ue.l=De.start+1<<9,has_buf&&Buffer.isBuffer(De.content))De.content.copy(ue,ue.l,0,De.size),ue.l+=De.size+511&-512;else{for(Re=0;Re<De.size;++Re)ue.write_shift(1,De.content[Re]);for(;Re&511;++Re)ue.write_shift(1,0)}for(he=1;he<q.FileIndex.length;++he)if(De=q.FileIndex[he],De.size>0&&De.size<4096)if(has_buf&&Buffer.isBuffer(De.content))De.content.copy(ue,ue.l,0,De.size),ue.l+=De.size+63&-64;else{for(Re=0;Re<De.size;++Re)ue.write_shift(1,De.content[Re]);for(;Re&63;++Re)ue.write_shift(1,0)}if(has_buf)ue.l=ue.length;else for(;ue.l<ue.length;)ue.write_shift(1,0);return ue}function z(q,ce){var te=q.FullPaths.map(function(Re){return Re.toUpperCase()}),ne=te.map(function(Re){var Fe=Re.split("/");return Fe[Fe.length-(Re.slice(-1)=="/"?2:1)]}),ue=!1;ce.charCodeAt(0)===47?(ue=!0,ce=te[0].slice(0,-1)+ce):ue=ce.indexOf("/")!==-1;var he=ce.toUpperCase(),Oe=ue===!0?te.indexOf(he):ne.indexOf(he);if(Oe!==-1)return q.FileIndex[Oe];var Ie=!he.match(chr1);for(he=he.replace(chr0,""),Ie&&(he=he.replace(chr1,"!")),Oe=0;Oe<te.length;++Oe)if((Ie?te[Oe].replace(chr1,"!"):te[Oe]).replace(chr0,"")==he||(Ie?ne[Oe].replace(chr1,"!"):ne[Oe]).replace(chr0,"")==he)return q.FileIndex[Oe];return null}var se=64,me=-2,_e="d0cf11e0a1b11ae1",de=[208,207,17,224,161,177,26,225],Y="00000000000000000000000000000000",ie={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:me,FREESECT:-1,HEADER_SIGNATURE:_e,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function fe(q,ce,te){h();var ne=X(q,te);d.writeFileSync(ce,ne)}function ae(q){for(var ce=new Array(q.length),te=0;te<q.length;++te)ce[te]=String.fromCharCode(q[te]);return ce.join("")}function W(q,ce){var te=X(q,ce);switch(ce&&ce.type||"buffer"){case"file":return h(),d.writeFileSync(ce.filename,te),te;case"binary":return typeof te=="string"?te:ae(te);case"base64":return Base64_encode(typeof te=="string"?te:ae(te));case"buffer":if(has_buf)return Buffer.isBuffer(te)?te:Buffer_from(te);case"array":return typeof te=="string"?s2a(te):te}return te}var xe;function I(q){try{var ce=q.InflateRaw,te=new ce;if(te._processChunk(new Uint8Array([3,0]),te._finishFlushFlag),te.bytesRead)xe=q;else throw new Error("zlib does not expose bytesRead")}catch(ne){console.error("cannot use native zlib: "+(ne.message||ne))}}function M(q,ce){if(!xe)return Me(q,ce);var te=xe.InflateRaw,ne=new te,ue=ne._processChunk(q.slice(q.l),ne._finishFlushFlag);return q.l+=ne.bytesRead,ue}function R(q){return xe?xe.deflateRawSync(q):Qe(q)}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function J(q){var ce=(q<<1|q<<11)&139536|(q<<5|q<<15)&558144;return(ce>>16|ce>>8|ce)&255}for(var O=typeof Uint8Array<"u",B=O?new Uint8Array(256):[],G=0;G<256;++G)B[G]=J(G);function P(q,ce){var te=B[q&255];return ce<=8?te>>>8-ce:(te=te<<8|B[q>>8&255],ce<=16?te>>>16-ce:(te=te<<8|B[q>>16&255],te>>>24-ce))}function K(q,ce){var te=ce&7,ne=ce>>>3;return(q[ne]|(te<=6?0:q[ne+1]<<8))>>>te&3}function oe(q,ce){var te=ce&7,ne=ce>>>3;return(q[ne]|(te<=5?0:q[ne+1]<<8))>>>te&7}function re(q,ce){var te=ce&7,ne=ce>>>3;return(q[ne]|(te<=4?0:q[ne+1]<<8))>>>te&15}function H(q,ce){var te=ce&7,ne=ce>>>3;return(q[ne]|(te<=3?0:q[ne+1]<<8))>>>te&31}function Q(q,ce){var te=ce&7,ne=ce>>>3;return(q[ne]|(te<=1?0:q[ne+1]<<8))>>>te&127}function be(q,ce,te){var ne=ce&7,ue=ce>>>3,he=(1<<te)-1,Oe=q[ue]>>>ne;return te<8-ne||(Oe|=q[ue+1]<<8-ne,te<16-ne)||(Oe|=q[ue+2]<<16-ne,te<24-ne)||(Oe|=q[ue+3]<<24-ne),Oe&he}function ge(q,ce,te){var ne=ce&7,ue=ce>>>3;return ne<=5?q[ue]|=(te&7)<<ne:(q[ue]|=te<<ne&255,q[ue+1]=(te&7)>>8-ne),ce+3}function ye(q,ce,te){var ne=ce&7,ue=ce>>>3;return te=(te&1)<<ne,q[ue]|=te,ce+1}function we(q,ce,te){var ne=ce&7,ue=ce>>>3;return te<<=ne,q[ue]|=te&255,te>>>=8,q[ue+1]=te,ce+8}function Le(q,ce,te){var ne=ce&7,ue=ce>>>3;return te<<=ne,q[ue]|=te&255,te>>>=8,q[ue+1]=te&255,q[ue+2]=te>>>8,ce+16}function Ve(q,ce){var te=q.length,ne=2*te>ce?2*te:ce+5,ue=0;if(te>=ce)return q;if(has_buf){var he=new_unsafe_buf(ne);if(q.copy)q.copy(he);else for(;ue<q.length;++ue)he[ue]=q[ue];return he}else if(O){var Oe=new Uint8Array(ne);if(Oe.set)Oe.set(q);else for(;ue<te;++ue)Oe[ue]=q[ue];return Oe}return q.length=ne,q}function Ce(q){for(var ce=new Array(q),te=0;te<q;++te)ce[te]=0;return ce}function nt(q,ce,te){var ne=1,ue=0,he=0,Oe=0,Ie=0,Re=q.length,Fe=O?new Uint16Array(32):Ce(32);for(he=0;he<32;++he)Fe[he]=0;for(he=Re;he<te;++he)q[he]=0;Re=q.length;var De=O?new Uint16Array(Re):Ce(Re);for(he=0;he<Re;++he)Fe[ue=q[he]]++,ne<ue&&(ne=ue),De[he]=0;for(Fe[0]=0,he=1;he<=ne;++he)Fe[he+16]=Ie=Ie+Fe[he-1]<<1;for(he=0;he<Re;++he)Ie=q[he],Ie!=0&&(De[he]=Fe[Ie+16]++);var ze=0;for(he=0;he<Re;++he)if(ze=q[he],ze!=0)for(Ie=P(De[he],ne)>>ne-ze,Oe=(1<<ne+4-ze)-1;Oe>=0;--Oe)ce[Ie|Oe<<ze]=ze&15|he<<4;return ne}var tt=O?new Uint16Array(512):Ce(512),Je=O?new Uint16Array(32):Ce(32);if(!O){for(var et=0;et<512;++et)tt[et]=0;for(et=0;et<32;++et)Je[et]=0}(function(){for(var q=[],ce=0;ce<32;ce++)q.push(5);nt(q,Je,32);var te=[];for(ce=0;ce<=143;ce++)te.push(8);for(;ce<=255;ce++)te.push(9);for(;ce<=279;ce++)te.push(7);for(;ce<=287;ce++)te.push(8);nt(te,tt,288)})();var ht=function(){for(var ce=O?new Uint8Array(32768):[],te=0,ne=0;te<Z.length-1;++te)for(;ne<Z[te+1];++ne)ce[ne]=te;for(;ne<32768;++ne)ce[ne]=29;var ue=O?new Uint8Array(259):[];for(te=0,ne=0;te<V.length-1;++te)for(;ne<V[te+1];++ne)ue[ne]=te;function he(Ie,Re){for(var Fe=0;Fe<Ie.length;){var De=Math.min(65535,Ie.length-Fe),ze=Fe+De==Ie.length;for(Re.write_shift(1,+ze),Re.write_shift(2,De),Re.write_shift(2,~De&65535);De-- >0;)Re[Re.l++]=Ie[Fe++]}return Re.l}function Oe(Ie,Re){for(var Fe=0,De=0,ze=O?new Uint16Array(32768):[];De<Ie.length;){var We=Math.min(65535,Ie.length-De);if(We<10){for(Fe=ge(Re,Fe,+(De+We==Ie.length)),Fe&7&&(Fe+=8-(Fe&7)),Re.l=Fe/8|0,Re.write_shift(2,We),Re.write_shift(2,~We&65535);We-- >0;)Re[Re.l++]=Ie[De++];Fe=Re.l*8;continue}Fe=ge(Re,Fe,+(De+We==Ie.length)+2);for(var Ke=0;We-- >0;){var Xe=Ie[De];Ke=(Ke<<5^Xe)&32767;var Ge=-1,ut=0;if((Ge=ze[Ke])&&(Ge|=De&-32768,Ge>De&&(Ge-=32768),Ge<De))for(;Ie[Ge+ut]==Ie[De+ut]&&ut<250;)++ut;if(ut>2){Xe=ue[ut],Xe<=22?Fe=we(Re,Fe,B[Xe+1]>>1)-1:(we(Re,Fe,3),Fe+=5,we(Re,Fe,B[Xe-23]>>5),Fe+=3);var Ct=Xe<8?0:Xe-4>>2;Ct>0&&(Le(Re,Fe,ut-V[Xe]),Fe+=Ct),Xe=ce[De-Ge],Fe=we(Re,Fe,B[Xe]>>3),Fe-=3;var At=Xe<4?0:Xe-2>>1;At>0&&(Le(Re,Fe,De-Ge-Z[Xe]),Fe+=At);for(var Ot=0;Ot<ut;++Ot)ze[Ke]=De&32767,Ke=(Ke<<5^Ie[De])&32767,++De;We-=ut-1}else Xe<=143?Xe=Xe+48:Fe=ye(Re,Fe,1),Fe=we(Re,Fe,B[Xe]),ze[Ke]=De&32767,++De}Fe=we(Re,Fe,0)-1}return Re.l=(Fe+7)/8|0,Re.l}return function(Re,Fe){return Re.length<8?he(Re,Fe):Oe(Re,Fe)}}();function Qe(q){var ce=new_buf(50+Math.floor(q.length*1.1)),te=ht(q,ce);return ce.slice(0,te)}var it=O?new Uint16Array(32768):Ce(32768),pt=O?new Uint16Array(32768):Ce(32768),st=O?new Uint16Array(128):Ce(128),ct=1,lr=1;function Yt(q,ce){var te=H(q,ce)+257;ce+=5;var ne=H(q,ce)+1;ce+=5;var ue=re(q,ce)+4;ce+=4;for(var he=0,Oe=O?new Uint8Array(19):Ce(19),Ie=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Re=1,Fe=O?new Uint8Array(8):Ce(8),De=O?new Uint8Array(8):Ce(8),ze=Oe.length,We=0;We<ue;++We)Oe[U[We]]=he=oe(q,ce),Re<he&&(Re=he),Fe[he]++,ce+=3;var Ke=0;for(Fe[0]=0,We=1;We<=Re;++We)De[We]=Ke=Ke+Fe[We-1]<<1;for(We=0;We<ze;++We)(Ke=Oe[We])!=0&&(Ie[We]=De[Ke]++);var Xe=0;for(We=0;We<ze;++We)if(Xe=Oe[We],Xe!=0){Ke=B[Ie[We]]>>8-Xe;for(var Ge=(1<<7-Xe)-1;Ge>=0;--Ge)st[Ke|Ge<<Xe]=Xe&7|We<<3}var ut=[];for(Re=1;ut.length<te+ne;)switch(Ke=st[Q(q,ce)],ce+=Ke&7,Ke>>>=3){case 16:for(he=3+K(q,ce),ce+=2,Ke=ut[ut.length-1];he-- >0;)ut.push(Ke);break;case 17:for(he=3+oe(q,ce),ce+=3;he-- >0;)ut.push(0);break;case 18:for(he=11+Q(q,ce),ce+=7;he-- >0;)ut.push(0);break;default:ut.push(Ke),Re<Ke&&(Re=Ke);break}var Ct=ut.slice(0,te),At=ut.slice(te);for(We=te;We<286;++We)Ct[We]=0;for(We=ne;We<30;++We)At[We]=0;return ct=nt(Ct,it,286),lr=nt(At,pt,30),ce}function Mt(q,ce){if(q[0]==3&&!(q[1]&3))return[new_raw_buf(ce),2];for(var te=0,ne=0,ue=new_unsafe_buf(ce||1<<18),he=0,Oe=ue.length>>>0,Ie=0,Re=0;!(ne&1);){if(ne=oe(q,te),te+=3,ne>>>1)ne>>1==1?(Ie=9,Re=5):(te=Yt(q,te),Ie=ct,Re=lr);else{te&7&&(te+=8-(te&7));var Fe=q[te>>>3]|q[(te>>>3)+1]<<8;if(te+=32,Fe>0)for(!ce&&Oe<he+Fe&&(ue=Ve(ue,he+Fe),Oe=ue.length);Fe-- >0;)ue[he++]=q[te>>>3],te+=8;continue}for(;;){!ce&&Oe<he+32767&&(ue=Ve(ue,he+32767),Oe=ue.length);var De=be(q,te,Ie),ze=ne>>>1==1?tt[De]:it[De];if(te+=ze&15,ze>>>=4,!(ze>>>8&255))ue[he++]=ze;else{if(ze==256)break;ze-=257;var We=ze<8?0:ze-4>>2;We>5&&(We=0);var Ke=he+V[ze];We>0&&(Ke+=be(q,te,We),te+=We),De=be(q,te,Re),ze=ne>>>1==1?Je[De]:pt[De],te+=ze&15,ze>>>=4;var Xe=ze<4?0:ze-2>>1,Ge=Z[ze];for(Xe>0&&(Ge+=be(q,te,Xe),te+=Xe),!ce&&Oe<Ke&&(ue=Ve(ue,Ke+100),Oe=ue.length);he<Ke;)ue[he]=ue[he-Ge],++he}}}return ce?[ue,te+7>>>3]:[ue.slice(0,he),te+7>>>3]}function Me(q,ce){var te=q.slice(q.l||0),ne=Mt(te,ce);return q.l+=ne[1],ne[0]}function Se(q,ce){if(q)typeof console<"u"&&console.error(ce);else throw new Error(ce)}function Ae(q,ce){var te=q;prep_blob(te,0);var ne=[],ue=[],he={FileIndex:ne,FullPaths:ue};y(he,{root:ce.root});for(var Oe=te.length-4;(te[Oe]!=80||te[Oe+1]!=75||te[Oe+2]!=5||te[Oe+3]!=6)&&Oe>=0;)--Oe;te.l=Oe+4,te.l+=4;var Ie=te.read_shift(2);te.l+=6;var Re=te.read_shift(4);for(te.l=Re,Oe=0;Oe<Ie;++Oe){te.l+=20;var Fe=te.read_shift(4),De=te.read_shift(4),ze=te.read_shift(2),We=te.read_shift(2),Ke=te.read_shift(2);te.l+=8;var Xe=te.read_shift(4),Ge=f(te.slice(te.l+ze,te.l+ze+We));te.l+=ze+We+Ke;var ut=te.l;te.l=Xe+4,Ye(te,Fe,De,he,Ge),te.l=ut}return he}function Ye(q,ce,te,ne,ue){q.l+=2;var he=q.read_shift(2),Oe=q.read_shift(2),Ie=c(q);if(he&8257)throw new Error("Unsupported ZIP encryption");for(var Re=q.read_shift(4),Fe=q.read_shift(4),De=q.read_shift(4),ze=q.read_shift(2),We=q.read_shift(2),Ke="",Xe=0;Xe<ze;++Xe)Ke+=String.fromCharCode(q[q.l++]);if(We){var Ge=f(q.slice(q.l,q.l+We));(Ge[21589]||{}).mt&&(Ie=Ge[21589].mt),((ue||{})[21589]||{}).mt&&(Ie=ue[21589].mt)}q.l+=We;var ut=q.slice(q.l,q.l+Fe);switch(Oe){case 8:ut=M(q,De);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Oe)}var Ct=!1;he&8&&(Re=q.read_shift(4),Re==134695760&&(Re=q.read_shift(4),Ct=!0),Fe=q.read_shift(4),De=q.read_shift(4)),Fe!=ce&&Se(Ct,"Bad compressed size: "+ce+" != "+Fe),De!=te&&Se(Ct,"Bad uncompressed size: "+te+" != "+De),Ft(ne,Ke,ut,{unsafe:!0,mt:Ie})}function lt(q,ce){var te=ce||{},ne=[],ue=[],he=new_buf(1),Oe=te.compression?8:0,Ie=0,Re=0,Fe=0,De=0,ze=0,We=q.FullPaths[0],Ke=We,Xe=q.FileIndex[0],Ge=[],ut=0;for(Re=1;Re<q.FullPaths.length;++Re)if(Ke=q.FullPaths[Re].slice(We.length),Xe=q.FileIndex[Re],!(!Xe.size||!Xe.content||Ke=="Sh33tJ5")){var Ct=De,At=new_buf(Ke.length);for(Fe=0;Fe<Ke.length;++Fe)At.write_shift(1,Ke.charCodeAt(Fe)&127);At=At.slice(0,At.l),Ge[ze]=CRC32.buf(Xe.content,0);var Ot=Xe.content;Oe==8&&(Ot=R(Ot)),he=new_buf(30),he.write_shift(4,67324752),he.write_shift(2,20),he.write_shift(2,Ie),he.write_shift(2,Oe),Xe.mt?l(he,Xe.mt):he.write_shift(4,0),he.write_shift(-4,Ge[ze]),he.write_shift(4,Ot.length),he.write_shift(4,Xe.content.length),he.write_shift(2,At.length),he.write_shift(2,0),De+=he.length,ne.push(he),De+=At.length,ne.push(At),De+=Ot.length,ne.push(Ot),he=new_buf(46),he.write_shift(4,33639248),he.write_shift(2,0),he.write_shift(2,20),he.write_shift(2,Ie),he.write_shift(2,Oe),he.write_shift(4,0),he.write_shift(-4,Ge[ze]),he.write_shift(4,Ot.length),he.write_shift(4,Xe.content.length),he.write_shift(2,At.length),he.write_shift(2,0),he.write_shift(2,0),he.write_shift(2,0),he.write_shift(2,0),he.write_shift(4,0),he.write_shift(4,Ct),ut+=he.l,ue.push(he),ut+=At.length,ue.push(At),++ze}return he=new_buf(22),he.write_shift(4,101010256),he.write_shift(2,0),he.write_shift(2,0),he.write_shift(2,ze),he.write_shift(2,ze),he.write_shift(4,ut),he.write_shift(4,De),he.write_shift(2,0),bconcat([bconcat(ne),bconcat(ue),he])}var gt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function yt(q,ce){if(q.ctype)return q.ctype;var te=q.name||"",ne=te.match(/\.([^\.]+)$/);return ne&&gt[ne[1]]||ce&&(ne=(te=ce).match(/[\.\\]([^\.\\])+$/),ne&&gt[ne[1]])?gt[ne[1]]:"application/octet-stream"}function Zt(q){for(var ce=Base64_encode(q),te=[],ne=0;ne<ce.length;ne+=76)te.push(ce.slice(ne,ne+76));return te.join(`\r
`)+`\r
`}function Pr(q){var ce=q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Fe){var De=Fe.charCodeAt(0).toString(16).toUpperCase();return"="+(De.length==1?"0"+De:De)});ce=ce.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ce.charAt(0)==`
`&&(ce="=0D"+ce.slice(1)),ce=ce.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var te=[],ne=ce.split(`\r
`),ue=0;ue<ne.length;++ue){var he=ne[ue];if(he.length==0){te.push("");continue}for(var Oe=0;Oe<he.length;){var Ie=76,Re=he.slice(Oe,Oe+Ie);Re.charAt(Ie-1)=="="?Ie--:Re.charAt(Ie-2)=="="?Ie-=2:Re.charAt(Ie-3)=="="&&(Ie-=3),Re=he.slice(Oe,Oe+Ie),Oe+=Ie,Oe<he.length&&(Re+="="),te.push(Re)}}return te.join(`\r
`)}function gr(q){for(var ce=[],te=0;te<q.length;++te){for(var ne=q[te];te<=q.length&&ne.charAt(ne.length-1)=="=";)ne=ne.slice(0,ne.length-1)+q[++te];ce.push(ne)}for(var ue=0;ue<ce.length;++ue)ce[ue]=ce[ue].replace(/[=][0-9A-Fa-f]{2}/g,function(he){return String.fromCharCode(parseInt(he.slice(1),16))});return s2a(ce.join(`\r
`))}function Vt(q,ce,te){for(var ne="",ue="",he="",Oe,Ie=0;Ie<10;++Ie){var Re=ce[Ie];if(!Re||Re.match(/^\s*$/))break;var Fe=Re.match(/^(.*?):\s*([^\s].*)$/);if(Fe)switch(Fe[1].toLowerCase()){case"content-location":ne=Fe[2].trim();break;case"content-type":he=Fe[2].trim();break;case"content-transfer-encoding":ue=Fe[2].trim();break}}switch(++Ie,ue.toLowerCase()){case"base64":Oe=s2a(Base64_decode(ce.slice(Ie).join("")));break;case"quoted-printable":Oe=gr(ce.slice(Ie));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ue)}var De=Ft(q,ne.slice(te.length),Oe,{unsafe:!0});he&&(De.ctype=he)}function _r(q,ce){if(ae(q.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var te=ce&&ce.root||"",ne=(has_buf&&Buffer.isBuffer(q)?q.toString("binary"):ae(q)).split(`\r
`),ue=0,he="";for(ue=0;ue<ne.length;++ue)if(he=ne[ue],!!/^Content-Location:/i.test(he)&&(he=he.slice(he.indexOf("file")),te||(te=he.slice(0,he.lastIndexOf("/")+1)),he.slice(0,te.length)!=te))for(;te.length>0&&(te=te.slice(0,te.length-1),te=te.slice(0,te.lastIndexOf("/")+1),he.slice(0,te.length)!=te););var Oe=(ne[1]||"").match(/boundary="(.*?)"/);if(!Oe)throw new Error("MAD cannot find boundary");var Ie="--"+(Oe[1]||""),Re=[],Fe=[],De={FileIndex:Re,FullPaths:Fe};y(De);var ze,We=0;for(ue=0;ue<ne.length;++ue){var Ke=ne[ue];Ke!==Ie&&Ke!==Ie+"--"||(We++&&Vt(De,ne.slice(ze,ue),te),ze=ue)}return De}function er(q,ce){var te=ce||{},ne=te.boundary||"SheetJS";ne="------="+ne;for(var ue=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ne.slice(2)+'"',"","",""],he=q.FullPaths[0],Oe=he,Ie=q.FileIndex[0],Re=1;Re<q.FullPaths.length;++Re)if(Oe=q.FullPaths[Re].slice(he.length),Ie=q.FileIndex[Re],!(!Ie.size||!Ie.content||Oe=="Sh33tJ5")){Oe=Oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ut){return"_x"+ut.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ut){return"_u"+ut.charCodeAt(0).toString(16)+"_"});for(var Fe=Ie.content,De=has_buf&&Buffer.isBuffer(Fe)?Fe.toString("binary"):ae(Fe),ze=0,We=Math.min(1024,De.length),Ke=0,Xe=0;Xe<=We;++Xe)(Ke=De.charCodeAt(Xe))>=32&&Ke<128&&++ze;var Ge=ze>=We*4/5;ue.push(ne),ue.push("Content-Location: "+(te.root||"file:///C:/SheetJS/")+Oe),ue.push("Content-Transfer-Encoding: "+(Ge?"quoted-printable":"base64")),ue.push("Content-Type: "+yt(Ie,Oe)),ue.push(""),ue.push(Ge?Pr(De):Zt(De))}return ue.push(ne+`--\r
`),ue.join(`\r
`)}function sa(q){var ce={};return y(ce,q),ce}function Ft(q,ce,te,ne){var ue=ne&&ne.unsafe;ue||y(q);var he=!ue&&CFB.find(q,ce);if(!he){var Oe=q.FullPaths[0];ce.slice(0,Oe.length)==Oe?Oe=ce:(Oe.slice(-1)!="/"&&(Oe+="/"),Oe=(Oe+ce).replace("//","/")),he={name:i(ce),type:2},q.FileIndex.push(he),q.FullPaths.push(Oe),ue||CFB.utils.cfb_gc(q)}return he.content=te,he.size=te?te.length:0,ne&&(ne.CLSID&&(he.clsid=ne.CLSID),ne.mt&&(he.mt=ne.mt),ne.ct&&(he.ct=ne.ct)),he}function Hr(q,ce){y(q);var te=CFB.find(q,ce);if(te){for(var ne=0;ne<q.FileIndex.length;++ne)if(q.FileIndex[ne]==te)return q.FileIndex.splice(ne,1),q.FullPaths.splice(ne,1),!0}return!1}function zr(q,ce,te){y(q);var ne=CFB.find(q,ce);if(ne){for(var ue=0;ue<q.FileIndex.length;++ue)if(q.FileIndex[ue]==ne)return q.FileIndex[ue].name=i(te),q.FullPaths[ue]=te,!0}return!1}function ia(q){L(q,!0)}return r.find=z,r.read=w,r.parse=p,r.write=W,r.writeFile=fe,r.utils={cfb_new:sa,cfb_add:Ft,cfb_del:Hr,cfb_mov:zr,cfb_gc:ia,ReadShift,CheckField,prep_blob,bconcat,use_zlib:I,_deflateRaw:Qe,_inflateRaw:Me,consts:ie},r}();function read_binary(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function keys(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function evert(e){for(var r=[],t=keys(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}var basedate=new Date(1899,11,30,0,0,0);function datenum(e,r){var t=e.getTime(),n=basedate.getTime()+(e.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4;return(t-n)/(24*60*60*1e3)}var refdate=new Date,dnthresh=basedate.getTime()+(refdate.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4,refoffset=refdate.getTimezoneOffset();function numdate(e){var r=new Date;return r.setTime(e*24*60*60*1e3+dnthresh),r.getTimezoneOffset()!==refoffset&&r.setTime(r.getTime()+(r.getTimezoneOffset()-refoffset)*6e4),r}function parse_isodur(e){var r=0,t=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=i.length;++l)if(i[l]){switch(t=1,l>3&&(n=!0),i[l].slice(i[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[l].slice(i[l].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(i[l],10)}return r}var good_pd_date_1=new Date("2017-02-19T19:06:09.000Z"),good_pd_date=isNaN(good_pd_date_1.getFullYear())?new Date("2/19/17"):good_pd_date_1,good_pd=good_pd_date.getFullYear()==2017;function parseDate(e,r){var t=new Date(e);if(good_pd)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(good_pd_date.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function cc2str(e,r){if(has_buf&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return utf8write(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return utf8write(utf16beread(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return utf8write(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return utf8write(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return t[l]||l})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function dup(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=dup(e[t]));return r}function fill(e,r){for(var t="";t.length<r;)t+=e;return t}function fuzzynum(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,l){return t=-t,l}),!isNaN(r=Number(n)))?r/t:r}var lower_months=["january","february","march","april","may","june","july","august","september","october","november","december"];function fuzzydate(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),i=r.getMonth(),l=r.getDate();if(isNaN(l))return t;var c=e.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&lower_months.indexOf(c)==-1)return t}else if(c.match(/[a-z]/))return t;return n<0||n>8099?t:(i>0||l>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var split_regex=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,i){if(e||typeof n=="string")return t.split(n);for(var l=t.split(n),c=[l[0]],f=1;f<l.length;++f)c.push(i),c.push(l[f]);return c}}();function getdatastr(e){return e?e.content&&e.type?cc2str(e.content,!0):e.data?debom(e.data):e.asNodeBuffer&&has_buf?debom(e.asNodeBuffer().toString("binary")):e.asBinary?debom(e.asBinary()):e._data&&e._data.getContent?debom(cc2str(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function getdatabin(e){if(!e)return null;if(e.data)return char_codes(e.data);if(e.asNodeBuffer&&has_buf)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?char_codes(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function getdata(e){return e&&e.name.slice(-4)===".bin"?getdatabin(e):getdatastr(e)}function safegetzipfile(e,r){for(var t=e.FullPaths||keys(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),l=0;l<t.length;++l){var c=t[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==c||i==c)return e.files?e.files[t[l]]:e.FileIndex[l]}return null}function getzipfile(e,r){var t=safegetzipfile(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function getzipdata(e,r,t){if(!t)return getdata(getzipfile(e,r));if(!r)return null;try{return getzipdata(e,r)}catch{return null}}function getzipstr(e,r,t){if(!t)return getdatastr(getzipfile(e,r));if(!r)return null;try{return getzipstr(e,r)}catch{return null}}function getzipbin(e,r,t){return getdatabin(getzipfile(e,r))}function zipentries(e){for(var r=e.FullPaths||keys(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function zip_add_file(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return has_buf?n=Buffer_from(t):n=utf8decode(t),CFB.utils.cfb_add(e,r,n)}CFB.utils.cfb_add(e,r,t)}else e.file(r,t)}function zip_read(e,r){switch(r.type){case"base64":return CFB.read(e,{type:"base64"});case"binary":return CFB.read(e,{type:"binary"});case"buffer":case"array":return CFB.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function resolve_path(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?t.pop():i!=="."&&t.push(i)}return t.join("/")}var XML_HEADER=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,attregexg=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,tagregex1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,tagregex2=/<[^>]*>/g,tagregex=XML_HEADER.match(tagregex1)?tagregex1:tagregex2,nsregex=/<\w*:/,nsregex2=/<(\/?)\w+:/;function parsexmltag(e,r,t){for(var n={},i=0,l=0;i!==e.length&&!((l=e.charCodeAt(i))===32||l===10||l===13);++i);if(r||(n[0]=e.slice(0,i)),i===e.length)return n;var c=e.match(attregexg),f=0,d="",h=0,p="",E="",v=1;if(c)for(h=0;h!=c.length;++h){for(E=c[h],l=0;l!=E.length&&E.charCodeAt(l)!==61;++l);for(p=E.slice(0,l).trim();E.charCodeAt(l+1)==32;)++l;for(v=(i=E.charCodeAt(l+1))==34||i==39?1:0,d=E.slice(l+1+v,E.length-v),f=0;f!=p.length&&p.charCodeAt(f)!==58;++f);if(f===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),n[p]=d,n[p.toLowerCase()]=d;else{var S=(f===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(f+1);if(n[S]&&p.slice(f-3,f)=="ext")continue;n[S]=d,n[S.toLowerCase()]=d}}return n}function strip_ns(e){return e.replace(nsregex2,"<$1")}var encodings={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rencoding=evert(encodings),unescapexml=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(n){var i=n+"",l=i.indexOf("<![CDATA[");if(l==-1)return i.replace(e,function(f,d){return encodings[f]||String.fromCharCode(parseInt(d,f.indexOf("x")>-1?16:10))||f}).replace(r,function(f,d){return String.fromCharCode(parseInt(d,16))});var c=i.indexOf("]]>");return t(i.slice(0,l))+i.slice(l+9,c)+t(i.slice(c+3))}}(),decregex=/[&<>'"]/g,htmlcharegex=/[\u0000-\u001f]/g;function escapehtml(e){var r=e+"";return r.replace(decregex,function(t){return rencoding[t]}).replace(/\n/g,"<br/>").replace(htmlcharegex,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var xlml_fixstr=function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}}();function parsexmlbool(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function utf8reada(e){for(var r="",t=0,n=0,i=0,l=0,c=0,f=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(i=e.charCodeAt(t++),n>191&&n<224){c=(n&31)<<6,c|=i&63,r+=String.fromCharCode(c);continue}if(l=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(i&63)<<6|l&63);continue}c=e.charCodeAt(t++),f=((n&7)<<18|(i&63)<<12|(l&63)<<6|c&63)-65536,r+=String.fromCharCode(55296+(f>>>10&1023)),r+=String.fromCharCode(56320+(f&1023))}return r}function utf8readb(e){var r=new_raw_buf(2*e.length),t,n,i=1,l=0,c=0,f;for(n=0;n<e.length;n+=i)i=1,(f=e.charCodeAt(n))<128?t=f:f<224?(t=(f&31)*64+(e.charCodeAt(n+1)&63),i=2):f<240?(t=(f&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,t=(f&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,c=55296+(t>>>10&1023),t=56320+(t&1023)),c!==0&&(r[l++]=c&255,r[l++]=c>>>8,c=0),r[l++]=t%256,r[l++]=t>>>8;return r.slice(0,l).toString("ucs2")}function utf8readc(e){return Buffer_from(e,"binary").toString("utf8")}var utf8corpus="foo bar baz",utf8read=has_buf&&(utf8readc(utf8corpus)==utf8reada(utf8corpus)&&utf8readc||utf8readb(utf8corpus)==utf8reada(utf8corpus)&&utf8readb)||utf8reada,utf8write=has_buf?function(e){return Buffer_from(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,i=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(i>>18&7))),r.push(String.fromCharCode(144+(i>>12&63))),r.push(String.fromCharCode(128+(i>>6&63))),r.push(String.fromCharCode(128+(i&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},matchtag=function(){var e={};return function(t,n){var i=t+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}}(),htmldecode=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),vtregex=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),vtvregex=/<\/?(?:vt:)?variant>/g,vtmregex=/<(?:vt:)([^>]*)>([\s\S]*)</;function parseVector(e,r){var t=parsexmltag(e),n=e.match(vtregex(t.baseType))||[],i=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return i}return n.forEach(function(l){var c=l.replace(vtvregex,"").match(vtmregex);c&&i.push({v:utf8read(c[2]),t:c[1]})}),i}var wtregex=/(^\s|\s$|\n)/;function wxt_helper(e){return keys(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function writextag(e,r,t){return"<"+e+(t!=null?wxt_helper(t):"")+(r!=null?(r.match(wtregex)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function xlml_normalize(e){if(has_buf&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return utf8read(a2s(ab2a(e)));throw new Error("Bad input format: expected Buffer or string")}var xlmlregex=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,XMLNS={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},XMLNS_main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function read_double_le(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),i=e[r+6]&15,l=5;l>=0;--l)i=i*256+e[r+l];return n==2047?i==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),t*Math.pow(2,n-52)*i)}function write_double_le(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,i=0,l=0,c=n?-r:r;isFinite(c)?c==0?i=l=0:(i=Math.floor(Math.log(c)/Math.LN2),l=c*Math.pow(2,52-i),i<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?i=-1022:(l-=Math.pow(2,52),i+=1023)):(i=2047,l=isNaN(r)?26985:0);for(var f=0;f<=5;++f,l/=256)e[t+f]=l&255;e[t+6]=(i&15)<<4|l&15,e[t+7]=i>>4|n}var ___toBuffer=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,l=e[0][n].length;i<l;i+=t)r.push.apply(r,e[0][n].slice(i,i+t));return r},__toBuffer=has_buf?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:Buffer_from(r)})):___toBuffer(e)}:___toBuffer,___utf16le=function(e,r,t){for(var n=[],i=r;i<t;i+=2)n.push(String.fromCharCode(__readUInt16LE(e,i)));return n.join("").replace(chr0,"")},__utf16le=has_buf?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(chr0,""):___utf16le(e,r,t)}:___utf16le,___hexlify=function(e,r,t){for(var n=[],i=r;i<r+t;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},__hexlify=has_buf?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):___hexlify(e,r,t)}:___hexlify,___utf8=function(e,r,t){for(var n=[],i=r;i<t;i++)n.push(String.fromCharCode(__readUInt8(e,i)));return n.join("")},__utf8=has_buf?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):___utf8(r,t,n)}:___utf8,___lpstr=function(e,r){var t=__readUInt32LE(e,r);return t>0?__utf8(e,r+4,r+4+t-1):""},__lpstr=___lpstr,___cpstr=function(e,r){var t=__readUInt32LE(e,r);return t>0?__utf8(e,r+4,r+4+t-1):""},__cpstr=___cpstr,___lpwstr=function(e,r){var t=2*__readUInt32LE(e,r);return t>0?__utf8(e,r+4,r+4+t-1):""},__lpwstr=___lpwstr,___lpp4=function(r,t){var n=__readUInt32LE(r,t);return n>0?__utf16le(r,t+4,t+4+n):""},__lpp4=___lpp4,___8lpp4=function(e,r){var t=__readUInt32LE(e,r);return t>0?__utf8(e,r+4,r+4+t):""},__8lpp4=___8lpp4,___double=function(e,r){return read_double_le(e,r)},__double=___double,is_buf=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};has_buf&&(__lpstr=function(r,t){if(!Buffer.isBuffer(r))return ___lpstr(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},__cpstr=function(r,t){if(!Buffer.isBuffer(r))return ___cpstr(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},__lpwstr=function(r,t){if(!Buffer.isBuffer(r))return ___lpwstr(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},__lpp4=function(r,t){if(!Buffer.isBuffer(r))return ___lpp4(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},__8lpp4=function(r,t){if(!Buffer.isBuffer(r))return ___8lpp4(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},__double=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):___double(r,t)},is_buf=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var __readUInt8=function(e,r){return e[r]},__readUInt16LE=function(e,r){return e[r+1]*256+e[r]},__readInt16LE=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},__readUInt32LE=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},__readInt32LE=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},__readInt32BE=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function ReadShift(e,r){var t="",n,i,l=[],c,f,d,h;switch(r){case"dbcs":if(h=this.l,has_buf&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)t+=String.fromCharCode(__readUInt16LE(this,h)),h+=2;e*=2;break;case"utf8":t=__utf8(this,this.l,this.l+e);break;case"utf16le":e*=2,t=__utf16le(this,this.l,this.l+e);break;case"wstr":return ReadShift.call(this,e,"dbcs");case"lpstr-ansi":t=__lpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpstr-cp":t=__cpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpwstr":t=__lpwstr(this,this.l),e=4+2*__readUInt32LE(this,this.l);break;case"lpp4":e=4+__readUInt32LE(this,this.l),t=__lpp4(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+__readUInt32LE(this,this.l),t=__8lpp4(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(c=__readUInt8(this,this.l+e++))!==0;)l.push(_getchar(c));t=l.join("");break;case"_wstr":for(e=0,t="";(c=__readUInt16LE(this,this.l+e))!==0;)l.push(_getchar(c)),e+=2;e+=2,t=l.join("");break;case"dbcs-cont":for(t="",h=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return c=__readUInt8(this,h),this.l=h+1,f=ReadShift.call(this,e-d,c?"dbcs-cont":"sbcs-cont"),l.join("")+f;l.push(_getchar(__readUInt16LE(this,h))),h+=2}t=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",h=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return c=__readUInt8(this,h),this.l=h+1,f=ReadShift.call(this,e-d,c?"dbcs-cont":"sbcs-cont"),l.join("")+f;l.push(_getchar(__readUInt8(this,h))),h+=1}t=l.join("");break;default:switch(e){case 1:return n=__readUInt8(this,this.l),this.l++,n;case 2:return n=(r==="i"?__readInt16LE:__readUInt16LE)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(n=(e>0?__readInt32LE:__readInt32BE)(this,this.l),this.l+=4,n):(i=__readUInt32LE(this,this.l),this.l+=4,i);case 8:case-8:if(r==="f")return e==8?i=__double(this,this.l):i=__double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:t=__hexlify(this,this.l,e);break}}return this.l+=e,t}var __writeUInt32LE=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},__writeInt32LE=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},__writeUInt16LE=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function WriteShift(e,r,t){var n=0,i=0;if(t==="dbcs"){for(i=0;i!=r.length;++i)__writeUInt16LE(this,r.charCodeAt(i),this.l+2*i);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=r.length;++i)this[this.l+i]=r.charCodeAt(i)&255;n=r.length}else if(t==="hex"){for(;i<e;++i)this[this.l++]=parseInt(r.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var l=Math.min(this.l+e,this.length);for(i=0;i<Math.min(r.length,e);++i){var c=r.charCodeAt(i);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,__writeUInt32LE(this,r,this.l);break;case 8:if(n=8,t==="f"){write_double_le(this,r,this.l);break}case 16:break;case-4:n=4,__writeInt32LE(this,r,this.l);break}return this.l+=n,this}function CheckField(e,r){var t=__hexlify(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function prep_blob(e,r){e.l=r,e.read_shift=ReadShift,e.chk=CheckField,e.write_shift=WriteShift}function parsenoop(e,r){e.l+=r}function new_buf(e){var r=new_raw_buf(e);return prep_blob(r,0),r}function recordhopper(e,r,t){if(e){var n,i,l;prep_blob(e,e.l||0);for(var c=e.length,f=0,d=0;e.l<c;){f=e.read_shift(1),f&128&&(f=(f&127)+((e.read_shift(1)&127)<<7));var h=XLSBRecordEnum[f]||XLSBRecordEnum[65535];for(n=e.read_shift(1),l=n&127,i=1;i<4&&n&128;++i)l+=((n=e.read_shift(1))&127)<<7*i;d=e.l+l;var p=h.f&&h.f(e,l,t);if(e.l=d,r(p,h,f))return}}}function buf_array(){var e=[],r=has_buf?256:2048,t=function(h){var p=new_buf(h);return prep_blob(p,0),p},n=t(r),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},l=function(h){return n&&h<n.length-n.l?n:(i(),n=t(Math.max(h+1,r)))},c=function(){return i(),bconcat(e)},f=function(h){i(),n=h,n.l==null&&(n.l=n.length),l(r)};return{next:l,push:f,end:c,_bufs:e}}function shift_cell_xls(e,r,t){var n=dup(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function shift_range_xls(e,r,t){var n=dup(e);return n.s=shift_cell_xls(n.s,r.s,t),n.e=shift_cell_xls(n.e,r.s,t),n}function encode_cell_xls(e,r){if(e.cRel&&e.c<0)for(e=dup(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=dup(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=encode_cell(e);return!e.cRel&&e.cRel!=null&&(t=fix_col(t)),!e.rRel&&e.rRel!=null&&(t=fix_row(t)),t}function encode_range_xls(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+encode_col(e.s.c)+":"+(e.e.cRel?"":"$")+encode_col(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+encode_row(e.s.r)+":"+(e.e.rRel?"":"$")+encode_row(e.e.r):encode_cell_xls(e.s,r.biff)+":"+encode_cell_xls(e.e,r.biff)}function decode_row(e){return parseInt(unfix_row(e),10)-1}function encode_row(e){return""+(e+1)}function fix_row(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function unfix_row(e){return e.replace(/\$(\d+)$/,"$1")}function decode_col(e){for(var r=unfix_col(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function encode_col(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function fix_col(e){return e.replace(/^([A-Z])/,"$$$1")}function unfix_col(e){return e.replace(/^\$([A-Z])/,"$1")}function split_cell(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function decode_cell(e){for(var r=0,t=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?r=10*r+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:r-1}}function encode_cell(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function decode_range(e){var r=e.indexOf(":");return r==-1?{s:decode_cell(e),e:decode_cell(e)}:{s:decode_cell(e.slice(0,r)),e:decode_cell(e.slice(r+1))}}function encode_range(e,r){return typeof r>"u"||typeof r=="number"?encode_range(e.s,e.e):(typeof e!="string"&&(e=encode_cell(e)),typeof r!="string"&&(r=encode_cell(r)),e==r?e:e+":"+r)}function safe_decode_range(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,i=0,l=e.length;for(t=0;n<l&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(r.s.c=--t,t=0;n<l&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;if(r.s.r=--t,n===l||i!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=l&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(r.e.c=--t,t=0;n!=l&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;return r.e.r=--t,r}function safe_format_cell(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=SSF_format(e.z,t?datenum(r):r)}catch{}try{return e.w=SSF_format((e.XF||{}).numFmtId||(t?14:0),t?datenum(r):r)}catch{return""+r}}function format_cell(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?BErr[e.v]||e.v:r==null?safe_format_cell(e,e.v):safe_format_cell(e,r))}function sheet_to_workbook(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function sheet_add_aoa(e,r,t){var n=t||{},i=e?Array.isArray(e):n.dense,l=e||(i?[]:{}),c=0,f=0;if(l&&n.origin!=null){if(typeof n.origin=="number")c=n.origin;else{var d=typeof n.origin=="string"?decode_cell(n.origin):n.origin;c=d.r,f=d.c}l["!ref"]||(l["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var p=safe_decode_range(l["!ref"]);h.s.c=p.s.c,h.s.r=p.s.r,h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),c==-1&&(h.e.r=c=p.e.r+1)}for(var E=0;E!=r.length;++E)if(r[E]){if(!Array.isArray(r[E]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=r[E].length;++v)if(!(typeof r[E][v]>"u")){var S={v:r[E][v]},x=c+E,g=f+v;if(h.s.r>x&&(h.s.r=x),h.s.c>g&&(h.s.c=g),h.e.r<x&&(h.e.r=x),h.e.c<g&&(h.e.c=g),r[E][v]&&typeof r[E][v]=="object"&&!Array.isArray(r[E][v])&&!(r[E][v]instanceof Date))S=r[E][v];else if(Array.isArray(S.v)&&(S.f=r[E][v][1],S.v=S.v[0]),S.v===null)if(S.f)S.t="n";else if(n.nullError)S.t="e",S.v=0;else if(n.sheetStubs)S.t="z";else continue;else typeof S.v=="number"?S.t="n":typeof S.v=="boolean"?S.t="b":S.v instanceof Date?(S.z=n.dateNF||table_fmt[14],n.cellDates?(S.t="d",S.w=SSF_format(S.z,datenum(S.v))):(S.t="n",S.v=datenum(S.v),S.w=SSF_format(S.z,S.v))):S.t="s";if(i)l[x]||(l[x]=[]),l[x][g]&&l[x][g].z&&(S.z=l[x][g].z),l[x][g]=S;else{var m=encode_cell({c:g,r:x});l[m]&&l[m].z&&(S.z=l[m].z),l[m]=S}}}return h.s.c<1e7&&(l["!ref"]=encode_range(h)),l}function aoa_to_sheet(e,r){return sheet_add_aoa(null,e,r)}function parse_Int32LE(e){return e.read_shift(4,"i")}function parse_XLWideString(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function parse_StrRun(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function parse_RichStr(e,r){var t=e.l,n=e.read_shift(1),i=parse_XLWideString(e),l=[],c={t:i,h:i};if(n&1){for(var f=e.read_shift(4),d=0;d!=f;++d)l.push(parse_StrRun(e));c.r=l}else c.r=[{ich:0,ifnt:0}];return e.l=t+r,c}var parse_BrtCommentText=parse_RichStr;function parse_XLSBCell(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function parse_XLSBShortCell(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var parse_XLSBCodeName=parse_XLWideString;function parse_XLNullableWideString(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var parse_XLNameWideString=parse_XLWideString,parse_RelID=parse_XLNullableWideString;function parse_RkNumber(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var i=n===0?__double([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):__readInt32LE(r,0)>>2;return t?i/100:i}function parse_RfX(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var parse_UncheckedRfX=parse_RfX;function parse_Xnum(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function parse_BrtColor(e){var r={},t=e.read_shift(1),n=t>>>1,i=e.read_shift(1),l=e.read_shift(2,"i"),c=e.read_shift(1),f=e.read_shift(1),d=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=i;var h=XLSIcv[i];h&&(r.rgb=rgb2Hex(h));break;case 2:r.rgb=rgb2Hex([c,f,d]);break;case 3:r.theme=i;break}return l!=0&&(r.tint=l>0?l/32767:l/32768),r}function parse_FontFlags(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function parse_ClipboardFormatOrString(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function parse_ClipboardFormatOrAnsiString(e){return parse_ClipboardFormatOrString(e,1)}function parse_ClipboardFormatOrUnicodeString(e){return parse_ClipboardFormatOrString(e,2)}var VT_I2=2,VT_I4=3,VT_BOOL=11,VT_VARIANT=12,VT_UI4=19,VT_FILETIME=64,VT_BLOB=65,VT_CF=71,VT_VECTOR_VARIANT=4108,VT_VECTOR_LPSTR=4126,VT_STRING=80,VT_USTR=81,VT_CUSTOM=[VT_STRING,VT_USTR],DocSummaryPIDDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Category",t:VT_STRING},3:{n:"PresentationFormat",t:VT_STRING},4:{n:"ByteCount",t:VT_I4},5:{n:"LineCount",t:VT_I4},6:{n:"ParagraphCount",t:VT_I4},7:{n:"SlideCount",t:VT_I4},8:{n:"NoteCount",t:VT_I4},9:{n:"HiddenCount",t:VT_I4},10:{n:"MultimediaClipCount",t:VT_I4},11:{n:"ScaleCrop",t:VT_BOOL},12:{n:"HeadingPairs",t:VT_VECTOR_VARIANT},13:{n:"TitlesOfParts",t:VT_VECTOR_LPSTR},14:{n:"Manager",t:VT_STRING},15:{n:"Company",t:VT_STRING},16:{n:"LinksUpToDate",t:VT_BOOL},17:{n:"CharacterCount",t:VT_I4},19:{n:"SharedDoc",t:VT_BOOL},22:{n:"HyperlinksChanged",t:VT_BOOL},23:{n:"AppVersion",t:VT_I4,p:"version"},24:{n:"DigSig",t:VT_BLOB},26:{n:"ContentType",t:VT_STRING},27:{n:"ContentStatus",t:VT_STRING},28:{n:"Language",t:VT_STRING},29:{n:"Version",t:VT_STRING},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},SummaryPIDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Title",t:VT_STRING},3:{n:"Subject",t:VT_STRING},4:{n:"Author",t:VT_STRING},5:{n:"Keywords",t:VT_STRING},6:{n:"Comments",t:VT_STRING},7:{n:"Template",t:VT_STRING},8:{n:"LastAuthor",t:VT_STRING},9:{n:"RevNumber",t:VT_STRING},10:{n:"EditTime",t:VT_FILETIME},11:{n:"LastPrinted",t:VT_FILETIME},12:{n:"CreatedDate",t:VT_FILETIME},13:{n:"ModifiedDate",t:VT_FILETIME},14:{n:"PageCount",t:VT_I4},15:{n:"WordCount",t:VT_I4},16:{n:"CharCount",t:VT_I4},17:{n:"Thumbnail",t:VT_CF},18:{n:"Application",t:VT_STRING},19:{n:"DocSecurity",t:VT_I4},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},CountryEnum={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},XLSFillPattern=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function rgbify(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var _XLSIcv=rgbify([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),XLSIcv=dup(_XLSIcv),BErr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RBErr={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ct2type={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function new_ct(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function parse_ct(e){var r=new_ct();if(!e||!e.match)return r;var t={};if((e.match(tagregex)||[]).forEach(function(n){var i=parsexmltag(n);switch(i[0].replace(nsregex,"<")){case"<?xml":break;case"<Types":r.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[i.Extension]=i.ContentType;break;case"<Override":r[ct2type[i.ContentType]]!==void 0&&r[ct2type[i.ContentType]].push(i.PartName);break}}),r.xmlns!==XMLNS.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}var RELS={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function get_rels_path(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function parse_rels(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(tagregex)||[]).forEach(function(i){var l=parsexmltag(i);if(l[0]==="<Relationship"){var c={};c.Type=l.Type,c.Target=l.Target,c.Id=l.Id,l.TargetMode&&(c.TargetMode=l.TargetMode);var f=l.TargetMode==="External"?l.Target:resolve_path(l.Target,r);t[f]=c,n[l.Id]=c}}),t["!id"]=n,t}var CT_ODS="application/vnd.oasis.opendocument.spreadsheet";function parse_manifest(e,r){for(var t=xlml_normalize(e),n,i;n=xlmlregex.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(i=parsexmltag(n[0],!1),i.path=="/"&&i.type!==CT_ODS)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var CORE_PROPS=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],CORE_PROPS_REGEX=function(){for(var e=new Array(CORE_PROPS.length),r=0;r<CORE_PROPS.length;++r){var t=CORE_PROPS[r],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function parse_core_props(e){var r={};e=utf8read(e);for(var t=0;t<CORE_PROPS.length;++t){var n=CORE_PROPS[t],i=e.match(CORE_PROPS_REGEX[t]);i!=null&&i.length>0&&(r[n[1]]=unescapexml(i[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=parseDate(r[n[1]]))}return r}var EXT_PROPS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function load_props_pairs(e,r,t,n){var i=[];if(typeof e=="string")i=parseVector(e,n);else for(var l=0;l<e.length;++l)i=i.concat(e[l].map(function(p){return{v:p}}));var c=typeof r=="string"?parseVector(r,n).map(function(p){return p.v}):r,f=0,d=0;if(c.length>0)for(var h=0;h!==i.length;h+=2){switch(d=+i[h+1].v,i[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=d,t.SheetNames=c.slice(f,f+d);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=d,t.DefinedNames=c.slice(f,f+d);break;case"Charts":case"Diagramme":t.Chartsheets=d,t.ChartNames=c.slice(f,f+d);break}f+=d}}function parse_ext_props(e,r,t){var n={};return r||(r={}),e=utf8read(e),EXT_PROPS.forEach(function(i){var l=(e.match(matchtag(i[0]))||[])[1];switch(i[2]){case"string":l&&(r[i[1]]=unescapexml(l));break;case"bool":r[i[1]]=l==="true";break;case"raw":var c=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));c&&c.length>0&&(n[i[1]]=c[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&load_props_pairs(n.HeadingPairs,n.TitlesOfParts,r,t),r}var custregex=/<[^>]+>[^<]*/g;function parse_cust_props(e,r){var t={},n="",i=e.match(custregex);if(i)for(var l=0;l!=i.length;++l){var c=i[l],f=parsexmltag(c);switch(f[0]){case"<?xml":break;case"<Properties":break;case"<property":n=unescapexml(f.name);break;case"</property>":n=null;break;default:if(c.indexOf("<vt:")===0){var d=c.split(">"),h=d[0].slice(4),p=d[1];switch(h){case"lpstr":case"bstr":case"lpwstr":t[n]=unescapexml(p);break;case"bool":t[n]=parsexmlbool(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(p,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(p);break;case"filetime":case"date":t[n]=parseDate(p);break;case"cy":case"error":t[n]=unescapexml(p);break;default:if(h.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",c,h,d)}}else if(c.slice(0,2)!=="</"){if(r.WTF)throw new Error(c)}}}return t}var XLMLDocPropsMap={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},evert_XLMLDPM;function xlml_set_prop(e,r,t){evert_XLMLDPM||(evert_XLMLDPM=evert(XLMLDocPropsMap)),r=evert_XLMLDPM[r]||r,e[r]=t}function parse_FILETIME(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function parse_lpstr(e,r,t){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return i}function parse_lpwstr(e,r,t){var n=e.read_shift(0,"lpwstr");return n}function parse_VtStringBase(e,r,t){return r===31?parse_lpwstr(e):parse_lpstr(e,r,t)}function parse_VtString(e,r,t){return parse_VtStringBase(e,r,t===!1?0:4)}function parse_VtUnalignedString(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return parse_VtStringBase(e,r,0)}function parse_VtVecLpwstrValue(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var i=e.l;t[n]=e.read_shift(0,"lpwstr").replace(chr0,""),e.l-i&2&&(e.l+=2)}return t}function parse_VtVecUnalignedLpstrValue(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(chr0,"");return t}function parse_VtHeadingPair(e){var r=e.l,t=parse_TypedPropertyValue(e,VT_USTR);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=parse_TypedPropertyValue(e,VT_I4);return[t,n]}function parse_VtVecHeadingPairValue(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(parse_VtHeadingPair(e));return t}function parse_dictionary(e,r){for(var t=e.read_shift(4),n={},i=0;i!=t;++i){var l=e.read_shift(4),c=e.read_shift(4);n[l]=e.read_shift(c,r===1200?"utf16le":"utf8").replace(chr0,"").replace(chr1,"!"),r===1200&&c%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function parse_BLOB(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function parse_ClipboardData(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function parse_TypedPropertyValue(e,r,t){var n=e.read_shift(2),i,l=t||{};if(e.l+=2,r!==VT_VARIANT&&n!==r&&VT_CUSTOM.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===VT_VARIANT?n:r){case 2:return i=e.read_shift(2,"i"),l.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return parse_lpstr(e,n,4).replace(chr0,"");case 31:return parse_lpwstr(e);case 64:return parse_FILETIME(e);case 65:return parse_BLOB(e);case 71:return parse_ClipboardData(e);case 80:return parse_VtString(e,n,!l.raw).replace(chr0,"");case 81:return parse_VtUnalignedString(e,n).replace(chr0,"");case 4108:return parse_VtVecHeadingPairValue(e);case 4126:case 4127:return n==4127?parse_VtVecLpwstrValue(e):parse_VtVecUnalignedLpstrValue(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function parse_PropertySet(e,r){var t=e.l,n=e.read_shift(4),i=e.read_shift(4),l=[],c=0,f=0,d=-1,h={};for(c=0;c!=i;++c){var p=e.read_shift(4),E=e.read_shift(4);l[c]=[p,E+t]}l.sort(function(D,C){return D[1]-C[1]});var v={};for(c=0;c!=i;++c){if(e.l!==l[c][1]){var S=!0;if(c>0&&r)switch(r[l[c-1][0]].t){case 2:e.l+2===l[c][1]&&(e.l+=2,S=!1);break;case 80:e.l<=l[c][1]&&(e.l=l[c][1],S=!1);break;case 4108:e.l<=l[c][1]&&(e.l=l[c][1],S=!1);break}if((!r||c==0)&&e.l<=l[c][1]&&(S=!1,e.l=l[c][1]),S)throw new Error("Read Error: Expected address "+l[c][1]+" at "+e.l+" :"+c)}if(r){var x=r[l[c][0]];if(v[x.n]=parse_TypedPropertyValue(e,x.t,{raw:!0}),x.p==="version"&&(v[x.n]=String(v[x.n]>>16)+"."+("0000"+String(v[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(v[x.n]){case 0:v[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:set_cp(f=v[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[x.n])}}else if(l[c][0]===1){if(f=v.CodePage=parse_TypedPropertyValue(e,VT_I2),set_cp(f),d!==-1){var g=e.l;e.l=l[d][1],h=parse_dictionary(e,f),e.l=g}}else if(l[c][0]===0){if(f===0){d=c,e.l=l[c+1][1];continue}h=parse_dictionary(e,f)}else{var m=h[l[c][0]],b;switch(e[e.l]){case 65:e.l+=4,b=parse_BLOB(e);break;case 30:e.l+=4,b=parse_VtString(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,b=parse_VtString(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,b=e.read_shift(4,"i");break;case 19:e.l+=4,b=e.read_shift(4);break;case 5:e.l+=4,b=e.read_shift(8,"f");break;case 11:e.l+=4,b=parsebool(e,4);break;case 64:e.l+=4,b=parseDate(parse_FILETIME(e));break;default:throw new Error("unparsed value: "+e[e.l])}v[m]=b}}return e.l=t+n,v}function parse_PropertySetStream(e,r,t){var n=e.content;if(!n)return{};prep_blob(n,0);var i,l,c,f,d=0;n.chk("feff","Byte Order: "),n.read_shift(2);var h=n.read_shift(4),p=n.read_shift(16);if(p!==CFB.utils.consts.HEADER_CLSID&&p!==t)throw new Error("Bad PropertySet CLSID "+p);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(l=n.read_shift(16),f=n.read_shift(4),i===1&&f!==n.l)throw new Error("Length mismatch: "+f+" !== "+n.l);i===2&&(c=n.read_shift(16),d=n.read_shift(4));var E=parse_PropertySet(n,r),v={SystemIdentifier:h};for(var S in E)v[S]=E[S];if(v.FMTID=l,i===1)return v;if(d-n.l==2&&(n.l+=2),n.l!==d)throw new Error("Length mismatch 2: "+n.l+" !== "+d);var x;try{x=parse_PropertySet(n,null)}catch{}for(S in x)v[S]=x[S];return v.FMTID=[l,c],v}function parsenoop2(e,r){return e.read_shift(r),null}function parslurp(e,r,t){for(var n=[],i=e.l+r;e.l<i;)n.push(t(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function parsebool(e,r){return e.read_shift(r)===1}function parseuint16(e){return e.read_shift(2,"u")}function parseuint16a(e,r){return parslurp(e,r,parseuint16)}function parse_Bes(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function parse_ShortXLUnicodeString(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var l=e.read_shift(1);l&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var c=n?e.read_shift(n,i):"";return c}function parse_XLUnicodeRichExtendedString(e){var r=e.read_shift(2),t=e.read_shift(1),n=t&4,i=t&8,l=1+(t&1),c=0,f,d={};i&&(c=e.read_shift(2)),n&&(f=e.read_shift(4));var h=l==2?"dbcs-cont":"sbcs-cont",p=r===0?"":e.read_shift(r,h);return i&&(e.l+=4*c),n&&(e.l+=f),d.t=p,i||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function parse_XLUnicodeStringNoCch(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function parse_XLUnicodeString(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):parse_XLUnicodeStringNoCch(e,n,t)}function parse_XLUnicodeString2(e,r,t){if(t.biff>5)return parse_XLUnicodeString(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function parse_ControlInfo(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function parse_URLMoniker(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var i=e.read_shift((n?r-24:r)>>1,"utf16le").replace(chr0,"");return n&&(e.l+=24),i}function parse_FileMoniker(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return t+n.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=e.read_shift(l>>1,"utf16le").replace(chr0,"");return t+c}function parse_HyperlinkMoniker(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return parse_URLMoniker(e);case"0303000000000000c000000000000046":return parse_FileMoniker(e);default:throw new Error("Unsupported Moniker "+t)}}function parse_HyperlinkString(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(chr0,""):"";return t}function parse_Hyperlink(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var l,c,f,d,h="",p,E;i&16&&(l=parse_HyperlinkString(e,t-e.l)),i&128&&(c=parse_HyperlinkString(e,t-e.l)),(i&257)===257&&(f=parse_HyperlinkString(e,t-e.l)),(i&257)===1&&(d=parse_HyperlinkMoniker(e,t-e.l)),i&8&&(h=parse_HyperlinkString(e,t-e.l)),i&32&&(p=e.read_shift(16)),i&64&&(E=parse_FILETIME(e)),e.l=t;var v=c||f||d||"";v&&h&&(v+="#"+h),v||(v="#"+h),i&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var S={Target:v};return p&&(S.guid=p),E&&(S.time=E),l&&(S.Tooltip=l),S}function parse_LongRGBA(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[r,t,n,i]}function parse_LongRGB(e,r){var t=parse_LongRGBA(e);return t[3]=0,t}function parse_XLSCell(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return{r,c:t,ixfe:n}}function parse_frtHeader(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function parse_OptXLUnicodeString(e,r,t){return r===0?"":parse_XLUnicodeString2(e,r,t)}function parse_XTI(e,r,t){var n=t.biff>8?4:2,i=e.read_shift(n),l=e.read_shift(n,"i"),c=e.read_shift(n,"i");return[i,l,c]}function parse_RkRec(e){var r=e.read_shift(2),t=parse_RkNumber(e);return[r,t]}function parse_AddinUdf(e,r,t){e.l+=4,r-=4;var n=e.l+r,i=parse_ShortXLUnicodeString(e,r,t),l=e.read_shift(2);if(n-=e.l,l!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+l);return e.l+=l,i}function parse_Ref8U(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r},e:{c:i,r:t}}}function parse_RefU(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r},e:{c:i,r:t}}}var parse_Ref=parse_RefU;function parse_FtCmo(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function parse_FtNts(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function parse_FtCf(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function parse_FtSkip(e){e.l+=2,e.l+=e.read_shift(2)}var FtTab={0:parse_FtSkip,4:parse_FtSkip,5:parse_FtSkip,6:parse_FtSkip,7:parse_FtCf,8:parse_FtSkip,9:parse_FtSkip,10:parse_FtSkip,11:parse_FtSkip,12:parse_FtSkip,13:parse_FtNts,14:parse_FtSkip,15:parse_FtSkip,16:parse_FtSkip,17:parse_FtSkip,18:parse_FtSkip,19:parse_FtSkip,20:parse_FtSkip,21:parse_FtCmo};function parse_FtArray(e,r){for(var t=e.l+r,n=[];e.l<t;){var i=e.read_shift(2);e.l-=2;try{n.push(FtTab[i](e,t-e.l))}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function parse_BOF(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function parse_InterfaceHdr(e,r){return r===0||e.read_shift(2),1200}function parse_WriteAccess(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,i=parse_XLUnicodeString2(e,0,t);return e.read_shift(r+n-e.l),i}function parse_WsBool(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function parse_BoundSheet8(e,r,t){var n=e.read_shift(4),i=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var c=parse_ShortXLUnicodeString(e,0,t);return c.length===0&&(c="Sheet1"),{pos:n,hs:i,dt:l,name:c}}function parse_SST(e,r){for(var t=e.l+r,n=e.read_shift(4),i=e.read_shift(4),l=[],c=0;c!=i&&e.l<t;++c)l.push(parse_XLUnicodeRichExtendedString(e));return l.Count=n,l.Unique=i,l}function parse_ExtSST(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function parse_Row(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function parse_ForceFullCalculation(e){var r=parse_frtHeader(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function parse_RecalcId(e){return e.read_shift(2),e.read_shift(4)}function parse_DefaultRowHeight(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);t&&t.biff==2&&(n=1-(i>>15),i&=32767);var l={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[l,i]}function parse_Window1(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),d=e.read_shift(2),h=e.read_shift(2);return{Pos:[r,t],Dim:[n,i],Flags:l,CurTab:c,FirstTab:f,Selected:d,TabRatio:h}}function parse_Window2(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function parse_Pane(){}function parse_Font(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=parse_ShortXLUnicodeString(e,0,t),n}function parse_LabelSst(e){var r=parse_XLSCell(e);return r.isst=e.read_shift(4),r}function parse_Label(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,i=parse_XLSCell(e);t.biff==2&&e.l++;var l=parse_XLUnicodeString(e,n-e.l,t);return i.val=l,i}function parse_Format(e,r,t){var n=e.read_shift(2),i=parse_XLUnicodeString2(e,0,t);return[n,i]}var parse_BIFF2Format=parse_XLUnicodeString2;function parse_Dimensions(e,r,t){var n=e.l+r,i=t.biff==8||!t.biff?4:2,l=e.read_shift(i),c=e.read_shift(i),f=e.read_shift(2),d=e.read_shift(2);return e.l=n,{s:{r:l,c:f},e:{r:c,c:d}}}function parse_RK(e){var r=e.read_shift(2),t=e.read_shift(2),n=parse_RkRec(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function parse_MulRk(e,r){for(var t=e.l+r-2,n=e.read_shift(2),i=e.read_shift(2),l=[];e.l<t;)l.push(parse_RkRec(e));if(e.l!==t)throw new Error("MulRK read error");var c=e.read_shift(2);if(l.length!=c-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:c,rkrec:l}}function parse_MulBlank(e,r){for(var t=e.l+r-2,n=e.read_shift(2),i=e.read_shift(2),l=[];e.l<t;)l.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var c=e.read_shift(2);if(l.length!=c-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:c,ixfe:l}}function parse_CellStyleXF(e,r,t,n){var i={},l=e.read_shift(4),c=e.read_shift(4),f=e.read_shift(4),d=e.read_shift(2);return i.patternType=XLSFillPattern[f>>26],n.cellStyles&&(i.alc=l&7,i.fWrap=l>>3&1,i.alcV=l>>4&7,i.fJustLast=l>>7&1,i.trot=l>>8&255,i.cIndent=l>>16&15,i.fShrinkToFit=l>>20&1,i.iReadOrder=l>>22&2,i.fAtrNum=l>>26&1,i.fAtrFnt=l>>27&1,i.fAtrAlc=l>>28&1,i.fAtrBdr=l>>29&1,i.fAtrPat=l>>30&1,i.fAtrProt=l>>31&1,i.dgLeft=c&15,i.dgRight=c>>4&15,i.dgTop=c>>8&15,i.dgBottom=c>>12&15,i.icvLeft=c>>16&127,i.icvRight=c>>23&127,i.grbitDiag=c>>30&3,i.icvTop=f&127,i.icvBottom=f>>7&127,i.icvDiag=f>>14&127,i.dgDiag=f>>21&15,i.icvFore=d&127,i.icvBack=d>>7&127,i.fsxButton=d>>14&1),i}function parse_XF(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=parse_CellStyleXF(e,r,n.fStyle,t),n}function parse_Guts(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function parse_BoolErr(e,r,t){var n=parse_XLSCell(e);(t.biff==2||r==9)&&++e.l;var i=parse_Bes(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function parse_Number(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=parse_XLSCell(e),i=parse_Xnum(e);return n.val=i,n}var parse_XLHeaderFooter=parse_OptXLUnicodeString;function parse_SupBook(e,r,t){var n=e.l+r,i=e.read_shift(2),l=e.read_shift(2);if(t.sbcch=l,l==1025||l==14849)return[l,i];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var c=parse_XLUnicodeStringNoCch(e,l),f=[];n>e.l;)f.push(parse_XLUnicodeString(e));return[l,i,c,f]}function parse_ExternName(e,r,t){var n=e.read_shift(2),i,l={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(i=parse_AddinUdf(e,r-2,t)),l.body=i||e.read_shift(r-2),typeof i=="string"&&(l.Name=i),l}var XLSLblBuiltIn=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function parse_Lbl(e,r,t){var n=e.l+r,i=e.read_shift(2),l=e.read_shift(1),c=e.read_shift(1),f=e.read_shift(t&&t.biff==2?1:2),d=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),d=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var h=parse_XLUnicodeStringNoCch(e,c,t);i&32&&(h=XLSLblBuiltIn[h.charCodeAt(0)]);var p=n-e.l;t&&t.biff==2&&--p;var E=n==e.l||f===0||!(p>0)?[]:parse_NameParsedFormula(e,p,t,f);return{chKey:l,Name:h,itab:d,rgce:E}}function parse_ExternSheet(e,r,t){if(t.biff<8)return parse_BIFF5ExternSheet(e,r,t);for(var n=[],i=e.l+r,l=e.read_shift(t.biff>8?4:2);l--!==0;)n.push(parse_XTI(e,t.biff>8?12:6,t));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function parse_BIFF5ExternSheet(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=parse_ShortXLUnicodeString(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function parse_NameCmt(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),i=e.read_shift(2),l=parse_XLUnicodeStringNoCch(e,n,t),c=parse_XLUnicodeStringNoCch(e,i,t);return[l,c]}function parse_ShrFmla(e,r,t){var n=parse_RefU(e);e.l++;var i=e.read_shift(1);return r-=8,[parse_SharedParsedFormula(e,r,t),i,n]}function parse_Array(e,r,t){var n=parse_Ref(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,parse_ArrayParsedFormula(e,r,t)]}function parse_MTRSettings(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function parse_NoteSh(e,r,t){if(!(t.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),f=parse_XLUnicodeString2(e,0,t);return t.biff<8&&e.read_shift(1),[{r:n,c:i},f,c,l]}}function parse_Note(e,r,t){return parse_NoteSh(e,r,t)}function parse_MergeCells(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(parse_Ref8U(e));return t}function parse_Obj(e,r,t){if(t&&t.biff<8)return parse_BIFF5Obj(e,r,t);var n=parse_FtCmo(e),i=parse_FtArray(e,r-22,n[1]);return{cmo:n,ft:i}}var parse_BIFF5OT={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=t,{fmt:n}}};function parse_BIFF5Obj(e,r,t){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var c=[];return c.push((parse_BIFF5OT[n]||parsenoop)(e,r,t)),{cmo:[i,n,l],ft:c}}function parse_TxO(e,r,t){var n=e.l,i="";try{e.l+=4;var l=(t.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:c=parse_ControlInfo(e,6,t);var f=e.read_shift(2);e.read_shift(2),parseuint16(e,2);var d=e.read_shift(2);e.l+=d;for(var h=1;h<e.lens.length-1;++h){if(e.l-n!=e.lens[h])throw new Error("TxO: bad continue record");var p=e[e.l],E=parse_XLUnicodeStringNoCch(e,e.lens[h+1]-e.lens[h]-1);if(i+=E,i.length>=(p?f:2*f))break}if(i.length!==f&&i.length!==f*2)throw new Error("cchText: "+f+" != "+i.length);return e.l=n+r,{t:i}}catch{return e.l=n+r,{t:i}}}function parse_HLink(e,r){var t=parse_Ref8U(e);e.l+=16;var n=parse_Hyperlink(e,r-24);return[t,n]}function parse_HLinkTooltip(e,r){e.read_shift(2);var t=parse_Ref8U(e),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(chr0,""),[t,n]}function parse_Country(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=CountryEnum[t]||t,t=e.read_shift(2),r[1]=CountryEnum[t]||t,r}function parse_ClrtClient(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(parse_LongRGB(e));return t}function parse_Palette(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(parse_LongRGB(e));return t}function parse_XFCRC(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function parse_ColInfo(e,r,t){if(!t.cellStyles)return parsenoop(e,r);var n=t&&t.biff>=12?4:2,i=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(n),f=e.read_shift(n),d=e.read_shift(2);n==2&&(e.l+=2);var h={s:i,e:l,w:c,ixfe:f,flags:d};return(t.biff>=5||!t.biff)&&(h.level=d>>8&7),h}function parse_Setup(e,r){var t={};return r<32||(e.l+=16,t.header=parse_Xnum(e),t.footer=parse_Xnum(e),e.l+=2),t}function parse_ShtProps(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}var parse_Blank=parse_XLSCell,parse_Scl=parseuint16a,parse_String=parse_XLUnicodeString;function parse_ImData(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),i={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function parse_BIFF2STR(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=parse_XLSCell(e);++e.l;var i=parse_XLUnicodeString2(e,r-7,t);return n.t="str",n.val=i,n}function parse_BIFF2NUM(e){var r=parse_XLSCell(e);++e.l;var t=parse_Xnum(e);return r.t="n",r.val=t,r}function parse_BIFF2INT(e){var r=parse_XLSCell(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function parse_BIFF2STRING(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function parse_BIFF2FONTXTRA(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function parse_RString(e,r,t){var n=e.l+r,i=parse_XLSCell(e),l=e.read_shift(2),c=parse_XLUnicodeStringNoCch(e,l,t);return e.l=n,i.t="str",i.val=c,i}var DBF_SUPPORTED_VERSIONS=[2,3,48,49,131,139,140,245],DBF=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=evert({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(f,d){var h=[],p=new_raw_buf(1);switch(d.type){case"base64":p=s2a(Base64_decode(f));break;case"binary":p=s2a(f);break;case"buffer":case"array":p=f;break}prep_blob(p,0);var E=p.read_shift(1),v=!!(E&136),S=!1,x=!1;switch(E){case 2:break;case 3:break;case 48:S=!0,v=!0;break;case 49:S=!0,v=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+E.toString(16))}var g=0,m=521;E==2&&(g=p.read_shift(2)),p.l+=3,E!=2&&(g=p.read_shift(4)),g>1048576&&(g=1e6),E!=2&&(m=p.read_shift(2));var b=p.read_shift(2),D=d.codepage||1252;E!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(D=e[p[p.l]]),p.l+=1,p.l+=2),x&&(p.l+=36);for(var C=[],F={},T=Math.min(p.length,E==2?521:m-10-(S?264:0)),w=x?32:11;p.l<T&&p[p.l]!=13;)switch(F={},F.name=$cptable.utils.decode(D,p.slice(p.l,p.l+w)).replace(/[\u0000\r\n].*$/g,""),p.l+=w,F.type=String.fromCharCode(p.read_shift(1)),E!=2&&!x&&(F.offset=p.read_shift(4)),F.len=p.read_shift(1),E==2&&(F.offset=p.read_shift(2)),F.dec=p.read_shift(1),F.name.length&&C.push(F),E!=2&&(p.l+=x?13:14),F.type){case"B":(!S||F.len!=8)&&d.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+F.type)}if(p[p.l]!==13&&(p.l=m-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=m;var y=0,N=0;for(h[0]=[],N=0;N!=C.length;++N)h[0][N]=C[N].name;for(;g-- >0;){if(p[p.l]===42){p.l+=b;continue}for(++p.l,h[++y]=[],N=0,N=0;N!=C.length;++N){var L=p.slice(p.l,p.l+C[N].len);p.l+=C[N].len,prep_blob(L,0);var X=$cptable.utils.decode(D,L);switch(C[N].type){case"C":X.trim().length&&(h[y][N]=X.replace(/\s+$/,""));break;case"D":X.length===8?h[y][N]=new Date(+X.slice(0,4),+X.slice(4,6)-1,+X.slice(6,8)):h[y][N]=X;break;case"F":h[y][N]=parseFloat(X.trim());break;case"+":case"I":h[y][N]=x?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(X.trim().toUpperCase()){case"Y":case"T":h[y][N]=!0;break;case"N":case"F":h[y][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+X+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+E.toString(16));h[y][N]="##MEMO##"+(x?parseInt(X.trim(),10):L.read_shift(4));break;case"N":X=X.replace(/\u0000/g,"").trim(),X&&X!="."&&(h[y][N]=+X||0);break;case"@":h[y][N]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":h[y][N]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":h[y][N]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[y][N]=-L.read_shift(-8,"f");break;case"B":if(S&&C[N].len==8){h[y][N]=L.read_shift(8,"f");break}case"G":case"P":L.l+=C[N].len;break;case"0":if(C[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[N].type)}}}if(E!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return d.sheetRows&&(h=h.slice(0,d.sheetRows)),d.DBF=C,h}function n(f,d){var h=d||{};h.dateNF||(h.dateNF="yyyymmdd");var p=aoa_to_sheet(t(f,h),h);return p["!cols"]=h.DBF.map(function(E){return{wch:E.len,DBF:E}}),delete h.DBF,p}function i(f,d){try{return sheet_to_workbook(n(f,d),d)}catch(h){if(d&&d.WTF)throw h}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function c(f,d){var h=d||{};if(+h.codepage>=0&&set_cp(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var p=buf_array(),E=sheet_to_json(f,{header:1,raw:!0,cellDates:!0}),v=E[0],S=E.slice(1),x=f["!cols"]||[],g=0,m=0,b=0,D=1;for(g=0;g<v.length;++g){if(((x[g]||{}).DBF||{}).name){v[g]=x[g].DBF.name,++b;continue}if(v[g]!=null){if(++b,typeof v[g]=="number"&&(v[g]=v[g].toString(10)),typeof v[g]!="string")throw new Error("DBF Invalid column name "+v[g]+" |"+typeof v[g]+"|");if(v.indexOf(v[g])!==g){for(m=0;m<1024;++m)if(v.indexOf(v[g]+"_"+m)==-1){v[g]+="_"+m;break}}}}var C=safe_decode_range(f["!ref"]),F=[],T=[],w=[];for(g=0;g<=C.e.c-C.s.c;++g){var y="",N="",L=0,X=[];for(m=0;m<S.length;++m)S[m][g]!=null&&X.push(S[m][g]);if(X.length==0||v[g]==null){F[g]="?";continue}for(m=0;m<X.length;++m){switch(typeof X[m]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=X[m]instanceof Date?"D":"C";break;default:N="C"}L=Math.max(L,String(X[m]).length),y=y&&y!=N?"C":N}L>250&&(L=250),N=((x[g]||{}).DBF||{}).type,N=="C"&&x[g].DBF.len>L&&(L=x[g].DBF.len),y=="B"&&N=="N"&&(y="N",w[g]=x[g].DBF.dec,L=x[g].DBF.len),T[g]=y=="C"||N=="N"?L:l[y]||0,D+=T[g],F[g]=y}var z=p.next(32);for(z.write_shift(4,318902576),z.write_shift(4,S.length),z.write_shift(2,296+32*b),z.write_shift(2,D),g=0;g<4;++g)z.write_shift(4,0);for(z.write_shift(4,0|(+r[current_ansi]||3)<<8),g=0,m=0;g<v.length;++g)if(v[g]!=null){var se=p.next(32),me=(v[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);se.write_shift(1,me,"sbcs"),se.write_shift(1,F[g]=="?"?"C":F[g],"sbcs"),se.write_shift(4,m),se.write_shift(1,T[g]||l[F[g]]||0),se.write_shift(1,w[g]||0),se.write_shift(1,2),se.write_shift(4,0),se.write_shift(1,0),se.write_shift(4,0),se.write_shift(4,0),m+=T[g]||l[F[g]]||0}var _e=p.next(264);for(_e.write_shift(4,13),g=0;g<65;++g)_e.write_shift(4,0);for(g=0;g<S.length;++g){var de=p.next(D);for(de.write_shift(1,0),m=0;m<v.length;++m)if(v[m]!=null)switch(F[m]){case"L":de.write_shift(1,S[g][m]==null?63:S[g][m]?84:70);break;case"B":de.write_shift(8,S[g][m]||0,"f");break;case"N":var Y="0";for(typeof S[g][m]=="number"&&(Y=S[g][m].toFixed(w[m]||0)),b=0;b<T[m]-Y.length;++b)de.write_shift(1,32);de.write_shift(1,Y,"sbcs");break;case"D":S[g][m]?(de.write_shift(4,("0000"+S[g][m].getFullYear()).slice(-4),"sbcs"),de.write_shift(2,("00"+(S[g][m].getMonth()+1)).slice(-2),"sbcs"),de.write_shift(2,("00"+S[g][m].getDate()).slice(-2),"sbcs")):de.write_shift(8,"00000000","sbcs");break;case"C":var ie=String(S[g][m]!=null?S[g][m]:"").slice(0,T[m]);for(de.write_shift(1,ie,"sbcs"),b=0;b<T[m]-ie.length;++b)de.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:i,to_sheet:n,from_sheet:c}}(),SYLK=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+keys(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(v,S){var x=e[S];return typeof x=="number"?_getansi(x):x},n=function(v,S,x){var g=S.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return g==59?v:_getansi(g)};e["|"]=254;function i(v,S){switch(S.type){case"base64":return l(Base64_decode(v),S);case"binary":return l(v,S);case"buffer":return l(has_buf&&Buffer.isBuffer(v)?v.toString("binary"):a2s(v),S);case"array":return l(cc2str(v),S)}throw new Error("Unrecognized type "+S.type)}function l(v,S){var x=v.split(/[\n\r]+/),g=-1,m=-1,b=0,D=0,C=[],F=[],T=null,w={},y=[],N=[],L=[],X=0,z;for(+S.codepage>=0&&set_cp(+S.codepage);b!==x.length;++b){X=0;var se=x[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),me=se.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")}),_e=me[0],de;if(se.length>0)switch(_e){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":me[1].charAt(0)=="P"&&F.push(se.slice(3).replace(/;;/g,";"));break;case"C":var Y=!1,ie=!1,fe=!1,ae=!1,W=-1,xe=-1;for(D=1;D<me.length;++D)switch(me[D].charAt(0)){case"A":break;case"X":m=parseInt(me[D].slice(1))-1,ie=!0;break;case"Y":for(g=parseInt(me[D].slice(1))-1,ie||(m=0),z=C.length;z<=g;++z)C[z]=[];break;case"K":de=me[D].slice(1),de.charAt(0)==='"'?de=de.slice(1,de.length-1):de==="TRUE"?de=!0:de==="FALSE"?de=!1:isNaN(fuzzynum(de))?isNaN(fuzzydate(de).getDate())||(de=parseDate(de)):(de=fuzzynum(de),T!==null&&fmt_is_date(T)&&(de=numdate(de))),Y=!0;break;case"E":ae=!0;var I=rc_to_a1(me[D].slice(1),{r:g,c:m});C[g][m]=[C[g][m],I];break;case"S":fe=!0,C[g][m]=[C[g][m],"S5S"];break;case"G":break;case"R":W=parseInt(me[D].slice(1))-1;break;case"C":xe=parseInt(me[D].slice(1))-1;break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+se)}if(Y&&(C[g][m]&&C[g][m].length==2?C[g][m][0]=de:C[g][m]=de,T=null),fe){if(ae)throw new Error("SYLK shared formula cannot have own formula");var M=W>-1&&C[W][xe];if(!M||!M[1])throw new Error("SYLK shared formula cannot find base");C[g][m][1]=shift_formula_str(M[1],{r:g-W,c:m-xe})}break;case"F":var R=0;for(D=1;D<me.length;++D)switch(me[D].charAt(0)){case"X":m=parseInt(me[D].slice(1))-1,++R;break;case"Y":for(g=parseInt(me[D].slice(1))-1,z=C.length;z<=g;++z)C[z]=[];break;case"M":X=parseInt(me[D].slice(1))/20;break;case"F":break;case"G":break;case"P":T=F[parseInt(me[D].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=me[D].slice(1).split(" "),z=parseInt(L[0],10);z<=parseInt(L[1],10);++z)X=parseInt(L[2],10),N[z-1]=X===0?{hidden:!0}:{wch:X},process_col(N[z-1]);break;case"C":m=parseInt(me[D].slice(1))-1,N[m]||(N[m]={});break;case"R":g=parseInt(me[D].slice(1))-1,y[g]||(y[g]={}),X>0?(y[g].hpt=X,y[g].hpx=pt2px(X)):X===0&&(y[g].hidden=!0);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+se)}R<1&&(T=null);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+se)}}return y.length>0&&(w["!rows"]=y),N.length>0&&(w["!cols"]=N),S&&S.sheetRows&&(C=C.slice(0,S.sheetRows)),[C,w]}function c(v,S){var x=i(v,S),g=x[0],m=x[1],b=aoa_to_sheet(g,S);return keys(m).forEach(function(D){b[D]=m[D]}),b}function f(v,S){return sheet_to_workbook(c(v,S),S)}function d(v,S,x,g){var m="C;Y"+(x+1)+";X"+(g+1)+";K";switch(v.t){case"n":m+=v.v||0,v.f&&!v.F&&(m+=";E"+a1_to_rc(v.f,{r:x,c:g}));break;case"b":m+=v.v?"TRUE":"FALSE";break;case"e":m+=v.w||v.v;break;case"d":m+='"'+(v.w||v.v)+'"';break;case"s":m+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function h(v,S){S.forEach(function(x,g){var m="F;W"+(g+1)+" "+(g+1)+" ";x.hidden?m+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=width2px(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=px2char(x.wpx)),typeof x.wch=="number"&&(m+=Math.round(x.wch))),m.charAt(m.length-1)!=" "&&v.push(m)})}function p(v,S){S.forEach(function(x,g){var m="F;";x.hidden?m+="M0;":x.hpt?m+="M"+20*x.hpt+";":x.hpx&&(m+="M"+20*px2pt(x.hpx)+";"),m.length>2&&v.push(m+"R"+(g+1))})}function E(v,S){var x=["ID;PWXL;N;E"],g=[],m=safe_decode_range(v["!ref"]),b,D=Array.isArray(v),C=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),v["!cols"]&&h(x,v["!cols"]),v["!rows"]&&p(x,v["!rows"]),x.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var F=m.s.r;F<=m.e.r;++F)for(var T=m.s.c;T<=m.e.c;++T){var w=encode_cell({r:F,c:T});b=D?(v[F]||[])[T]:v[w],!(!b||b.v==null&&(!b.f||b.F))&&g.push(d(b,v,F,T))}return x.join(C)+C+g.join(C)+C+"E"+C}return{to_workbook:f,to_sheet:c,from_sheet:E}}(),DIF=function(){function e(l,c){switch(c.type){case"base64":return r(Base64_decode(l),c);case"binary":return r(l,c);case"buffer":return r(has_buf&&Buffer.isBuffer(l)?l.toString("binary"):a2s(l),c);case"array":return r(cc2str(l),c)}throw new Error("Unrecognized type "+c.type)}function r(l,c){for(var f=l.split(`
`),d=-1,h=-1,p=0,E=[];p!==f.length;++p){if(f[p].trim()==="BOT"){E[++d]=[],h=0;continue}if(!(d<0)){var v=f[p].trim().split(","),S=v[0],x=v[1];++p;for(var g=f[p]||"";(g.match(/["]/g)||[]).length&1&&p<f.length-1;)g+=`
`+f[++p];switch(g=g.trim(),+S){case-1:if(g==="BOT"){E[++d]=[],h=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?E[d][h]=!0:g==="FALSE"?E[d][h]=!1:isNaN(fuzzynum(x))?isNaN(fuzzydate(x).getDate())?E[d][h]=x:E[d][h]=parseDate(x):E[d][h]=fuzzynum(x),++h;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),E[d][h++]=g!==""?g:null;break}if(g==="EOD")break}}return c&&c.sheetRows&&(E=E.slice(0,c.sheetRows)),E}function t(l,c){return aoa_to_sheet(e(l,c),c)}function n(l,c){return sheet_to_workbook(t(l,c),c)}var i=function(){var l=function(d,h,p,E,v){d.push(h),d.push(p+","+E),d.push('"'+v.replace(/"/g,'""')+'"')},c=function(d,h,p,E){d.push(h+","+p),d.push(h==1?'"'+E.replace(/"/g,'""')+'"':E)};return function(d){var h=[],p=safe_decode_range(d["!ref"]),E,v=Array.isArray(d);l(h,"TABLE",0,1,"sheetjs"),l(h,"VECTORS",0,p.e.r-p.s.r+1,""),l(h,"TUPLES",0,p.e.c-p.s.c+1,""),l(h,"DATA",0,0,"");for(var S=p.s.r;S<=p.e.r;++S){c(h,-1,0,"BOT");for(var x=p.s.c;x<=p.e.c;++x){var g=encode_cell({r:S,c:x});if(E=v?(d[S]||[])[x]:d[g],!E){c(h,1,0,"");continue}switch(E.t){case"n":var m=E.w;!m&&E.v!=null&&(m=E.v),m==null?E.f&&!E.F?c(h,1,0,"="+E.f):c(h,1,0,""):c(h,0,m,"V");break;case"b":c(h,0,E.v?1:0,E.v?"TRUE":"FALSE");break;case"s":c(h,1,0,isNaN(E.v)?E.v:'="'+E.v+'"');break;case"d":E.w||(E.w=SSF_format(E.z||table_fmt[14],datenum(parseDate(E.v)))),c(h,0,E.w,"V");break;default:c(h,1,0,"")}}}c(h,-1,0,"EOD");var b=`\r
`,D=h.join(b);return D}}();return{to_workbook:n,to_sheet:t,from_sheet:i}}(),ETH=function(){function e(E){return E.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(E){return E.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(E,v){for(var S=E.split(`
`),x=-1,g=-1,m=0,b=[];m!==S.length;++m){var D=S[m].trim().split(":");if(D[0]==="cell"){var C=decode_cell(D[1]);if(b.length<=C.r)for(x=b.length;x<=C.r;++x)b[x]||(b[x]=[]);switch(x=C.r,g=C.c,D[2]){case"t":b[x][g]=e(D[3]);break;case"v":b[x][g]=+D[3];break;case"vtf":var F=D[D.length-1];case"vtc":switch(D[3]){case"nl":b[x][g]=!!+D[4];break;default:b[x][g]=+D[4];break}D[2]=="vtf"&&(b[x][g]=[b[x][g],F])}}}return v&&v.sheetRows&&(b=b.slice(0,v.sheetRows)),b}function n(E,v){return aoa_to_sheet(t(E,v),v)}function i(E,v){return sheet_to_workbook(n(E,v),v)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,f=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function h(E){if(!E||!E["!ref"])return"";for(var v=[],S=[],x,g="",m=decode_range(E["!ref"]),b=Array.isArray(E),D=m.s.r;D<=m.e.r;++D)for(var C=m.s.c;C<=m.e.c;++C)if(g=encode_cell({r:D,c:C}),x=b?(E[D]||[])[C]:E[g],!(!x||x.v==null||x.t==="z")){switch(S=["cell",g,"t"],x.t){case"s":case"str":S.push(r(x.v));break;case"n":x.f?(S[2]="vtf",S[3]="n",S[4]=x.v,S[5]=r(x.f)):(S[2]="v",S[3]=x.v);break;case"b":S[2]="vt"+(x.f?"f":"c"),S[3]="nl",S[4]=x.v?"1":"0",S[5]=r(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var F=datenum(parseDate(x.v));S[2]="vtc",S[3]="nd",S[4]=""+F,S[5]=x.w||SSF_format(x.z||table_fmt[14],F);break;case"e":continue}v.push(S.join(":"))}return v.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function p(E){return[l,c,f,c,h(E),d].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:p}}(),PRN=function(){function e(p,E,v,S,x){x.raw?E[v][S]=p:p===""||(p==="TRUE"?E[v][S]=!0:p==="FALSE"?E[v][S]=!1:isNaN(fuzzynum(p))?isNaN(fuzzydate(p).getDate())?E[v][S]=p:E[v][S]=parseDate(p):E[v][S]=fuzzynum(p))}function r(p,E){var v=E||{},S=[];if(!p||p.length===0)return S;for(var x=p.split(/[\r\n]/),g=x.length-1;g>=0&&x[g].length===0;)--g;for(var m=10,b=0,D=0;D<=g;++D)b=x[D].indexOf(" "),b==-1?b=x[D].length:b++,m=Math.max(m,b);for(D=0;D<=g;++D){S[D]=[];var C=0;for(e(x[D].slice(0,m).trim(),S,D,C,v),C=1;C<=(x[D].length-m)/10+1;++C)e(x[D].slice(m+(C-1)*10,m+C*10).trim(),S,D,C,v)}return v.sheetRows&&(S=S.slice(0,v.sheetRows)),S}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(p){for(var E={},v=!1,S=0,x=0;S<p.length;++S)(x=p.charCodeAt(S))==34?v=!v:!v&&x in t&&(E[x]=(E[x]||0)+1);x=[];for(S in E)Object.prototype.hasOwnProperty.call(E,S)&&x.push([E[S],S]);if(!x.length){E=n;for(S in E)Object.prototype.hasOwnProperty.call(E,S)&&x.push([E[S],S])}return x.sort(function(g,m){return g[0]-m[0]||n[g[1]]-n[m[1]]}),t[x.pop()[1]]||44}function l(p,E){var v=E||{},S="",x=v.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(S=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(S=p.charAt(4),p=p.slice(6)):S=i(p.slice(0,1024)):v.FS?S=v.FS:S=i(p.slice(0,1024));var m=0,b=0,D=0,C=0,F=0,T=S.charCodeAt(0),w=!1,y=0,N=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var L=v.dateNF!=null?dateNF_regex(v.dateNF):null;function X(){var z=p.slice(C,F),se={};if(z.charAt(0)=='"'&&z.charAt(z.length-1)=='"'&&(z=z.slice(1,-1).replace(/""/g,'"')),z.length===0)se.t="z";else if(v.raw)se.t="s",se.v=z;else if(z.trim().length===0)se.t="s",se.v=z;else if(z.charCodeAt(0)==61)z.charCodeAt(1)==34&&z.charCodeAt(z.length-1)==34?(se.t="s",se.v=z.slice(2,-1).replace(/""/g,'"')):fuzzyfmla(z)?(se.t="n",se.f=z.slice(1)):(se.t="s",se.v=z);else if(z=="TRUE")se.t="b",se.v=!0;else if(z=="FALSE")se.t="b",se.v=!1;else if(!isNaN(D=fuzzynum(z)))se.t="n",v.cellText!==!1&&(se.w=z),se.v=D;else if(!isNaN(fuzzydate(z).getDate())||L&&z.match(L)){se.z=v.dateNF||table_fmt[14];var me=0;L&&z.match(L)&&(z=dateNF_fix(z,v.dateNF,z.match(L)||[]),me=1),v.cellDates?(se.t="d",se.v=parseDate(z,me)):(se.t="n",se.v=datenum(parseDate(z,me))),v.cellText!==!1&&(se.w=SSF_format(se.z,se.v instanceof Date?datenum(se.v):se.v)),v.cellNF||delete se.z}else se.t="s",se.v=z;if(se.t=="z"||(v.dense?(x[m]||(x[m]=[]),x[m][b]=se):x[encode_cell({c:b,r:m})]=se),C=F+1,N=p.charCodeAt(C),g.e.c<b&&(g.e.c=b),g.e.r<m&&(g.e.r=m),y==T)++b;else if(b=0,++m,v.sheetRows&&v.sheetRows<=m)return!0}e:for(;F<p.length;++F)switch(y=p.charCodeAt(F)){case 34:N===34&&(w=!w);break;case T:case 10:case 13:if(!w&&X())break e;break}return F-C>0&&X(),x["!ref"]=encode_range(g),x}function c(p,E){return!(E&&E.PRN)||E.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?l(p,E):aoa_to_sheet(r(p,E),E)}function f(p,E){var v="",S=E.type=="string"?[0,0,0,0]:firstbyte(p,E);switch(E.type){case"base64":v=Base64_decode(p);break;case"binary":v=p;break;case"buffer":E.codepage==65001?v=p.toString("utf8"):(E.codepage,v=has_buf&&Buffer.isBuffer(p)?p.toString("binary"):a2s(p));break;case"array":v=cc2str(p);break;case"string":v=p;break;default:throw new Error("Unrecognized type "+E.type)}return S[0]==239&&S[1]==187&&S[2]==191?v=utf8read(v.slice(3)):E.type!="string"&&E.type!="buffer"&&E.codepage==65001?v=utf8read(v):E.type=="binary",v.slice(0,19)=="socialcalc:version:"?ETH.to_sheet(E.type=="string"?v:utf8read(v),E):c(v,E)}function d(p,E){return sheet_to_workbook(f(p,E),E)}function h(p){for(var E=[],v=safe_decode_range(p["!ref"]),S,x=Array.isArray(p),g=v.s.r;g<=v.e.r;++g){for(var m=[],b=v.s.c;b<=v.e.c;++b){var D=encode_cell({r:g,c:b});if(S=x?(p[g]||[])[b]:p[D],!S||S.v==null){m.push("          ");continue}for(var C=(S.w||(format_cell(S),S.w)||"").slice(0,10);C.length<10;)C+=" ";m.push(C+(b===0?" ":""))}E.push(m.join(""))}return E.join(`
`)}return{to_workbook:d,to_sheet:f,from_sheet:h}}();function read_wb_ID(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var i=SYLK.to_workbook(e,t);return t.WTF=n,i}catch(l){if(t.WTF=n,!l.message.match(/SYLK bad record ID/)&&n)throw l;return PRN.to_workbook(e,r)}}var WK_=function(){function e(I,M,R){if(I){prep_blob(I,I.l||0);for(var U=R.Enum||W;I.l<I.length;){var V=I.read_shift(2),Z=U[V]||U[65535],J=I.read_shift(2),O=I.l+J,B=Z.f&&Z.f(I,J,R);if(I.l=O,M(B,Z,V))return}}}function r(I,M){switch(M.type){case"base64":return t(s2a(Base64_decode(I)),M);case"binary":return t(s2a(I),M);case"buffer":case"array":return t(I,M)}throw"Unsupported type "+M.type}function t(I,M){if(!I)return I;var R=M||{},U=R.dense?[]:{},V="Sheet1",Z="",J=0,O={},B=[],G=[],P={s:{r:0,c:0},e:{r:0,c:0}},K=R.sheetRows||0;if(I[2]==0&&(I[3]==8||I[3]==9)&&I.length>=16&&I[14]==5&&I[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(I[2]==2)R.Enum=W,e(I,function(Q,be,ge){switch(ge){case 0:R.vers=Q,Q>=4096&&(R.qpro=!0);break;case 6:P=Q;break;case 204:Q&&(Z=Q);break;case 222:Z=Q;break;case 15:case 51:R.qpro||(Q[1].v=Q[1].v.slice(1));case 13:case 14:case 16:ge==14&&(Q[2]&112)==112&&(Q[2]&15)>1&&(Q[2]&15)<15&&(Q[1].z=R.dateNF||table_fmt[14],R.cellDates&&(Q[1].t="d",Q[1].v=numdate(Q[1].v))),R.qpro&&Q[3]>J&&(U["!ref"]=encode_range(P),O[V]=U,B.push(V),U=R.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},J=Q[3],V=Z||"Sheet"+(J+1),Z="");var ye=R.dense?(U[Q[0].r]||[])[Q[0].c]:U[encode_cell(Q[0])];if(ye){ye.t=Q[1].t,ye.v=Q[1].v,Q[1].z!=null&&(ye.z=Q[1].z),Q[1].f!=null&&(ye.f=Q[1].f);break}R.dense?(U[Q[0].r]||(U[Q[0].r]=[]),U[Q[0].r][Q[0].c]=Q[1]):U[encode_cell(Q[0])]=Q[1];break}},R);else if(I[2]==26||I[2]==14)R.Enum=xe,I[2]==14&&(R.qpro=!0,I.l=0),e(I,function(Q,be,ge){switch(ge){case 204:V=Q;break;case 22:Q[1].v=Q[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Q[3]>J&&(U["!ref"]=encode_range(P),O[V]=U,B.push(V),U=R.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},J=Q[3],V="Sheet"+(J+1)),K>0&&Q[0].r>=K)break;R.dense?(U[Q[0].r]||(U[Q[0].r]=[]),U[Q[0].r][Q[0].c]=Q[1]):U[encode_cell(Q[0])]=Q[1],P.e.c<Q[0].c&&(P.e.c=Q[0].c),P.e.r<Q[0].r&&(P.e.r=Q[0].r);break;case 27:Q[14e3]&&(G[Q[14e3][0]]=Q[14e3][1]);break;case 1537:G[Q[0]]=Q[1],Q[0]==J&&(V=Q[1]);break}},R);else throw new Error("Unrecognized LOTUS BOF "+I[2]);if(U["!ref"]=encode_range(P),O[Z||V]=U,B.push(Z||V),!G.length)return{SheetNames:B,Sheets:O};for(var oe={},re=[],H=0;H<G.length;++H)O[B[H]]?(re.push(G[H]||B[H]),oe[G[H]]=O[G[H]]||O[B[H]]):(re.push(G[H]),oe[G[H]]={"!ref":"A1"});return{SheetNames:re,Sheets:oe}}function n(I,M){var R=M||{};if(+R.codepage>=0&&set_cp(+R.codepage),R.type=="string")throw new Error("Cannot write WK1 to JS string");var U=buf_array(),V=safe_decode_range(I["!ref"]),Z=Array.isArray(I),J=[];write_biff_rec(U,0,l(1030)),write_biff_rec(U,6,d(V));for(var O=Math.min(V.e.r,8191),B=V.s.r;B<=O;++B)for(var G=encode_row(B),P=V.s.c;P<=V.e.c;++P){B===V.s.r&&(J[P]=encode_col(P));var K=J[P]+G,oe=Z?(I[B]||[])[P]:I[K];if(!(!oe||oe.t=="z"))if(oe.t=="n")(oe.v|0)==oe.v&&oe.v>=-32768&&oe.v<=32767?write_biff_rec(U,13,S(B,P,oe.v)):write_biff_rec(U,14,g(B,P,oe.v));else{var re=format_cell(oe);write_biff_rec(U,15,E(B,P,re.slice(0,239)))}}return write_biff_rec(U,1),U.end()}function i(I,M){var R=M||{};if(+R.codepage>=0&&set_cp(+R.codepage),R.type=="string")throw new Error("Cannot write WK3 to JS string");var U=buf_array();write_biff_rec(U,0,c(I));for(var V=0,Z=0;V<I.SheetNames.length;++V)(I.Sheets[I.SheetNames[V]]||{})["!ref"]&&write_biff_rec(U,27,ae(I.SheetNames[V],Z++));var J=0;for(V=0;V<I.SheetNames.length;++V){var O=I.Sheets[I.SheetNames[V]];if(!(!O||!O["!ref"])){for(var B=safe_decode_range(O["!ref"]),G=Array.isArray(O),P=[],K=Math.min(B.e.r,8191),oe=B.s.r;oe<=K;++oe)for(var re=encode_row(oe),H=B.s.c;H<=B.e.c;++H){oe===B.s.r&&(P[H]=encode_col(H));var Q=P[H]+re,be=G?(O[oe]||[])[H]:O[Q];if(!(!be||be.t=="z"))if(be.t=="n")write_biff_rec(U,23,X(oe,H,J,be.v));else{var ge=format_cell(be);write_biff_rec(U,22,y(oe,H,J,ge.slice(0,239)))}}++J}}return write_biff_rec(U,1),U.end()}function l(I){var M=new_buf(2);return M.write_shift(2,I),M}function c(I){var M=new_buf(26);M.write_shift(2,4096),M.write_shift(2,4),M.write_shift(4,0);for(var R=0,U=0,V=0,Z=0;Z<I.SheetNames.length;++Z){var J=I.SheetNames[Z],O=I.Sheets[J];if(!(!O||!O["!ref"])){++V;var B=decode_range(O["!ref"]);R<B.e.r&&(R=B.e.r),U<B.e.c&&(U=B.e.c)}}return R>8191&&(R=8191),M.write_shift(2,R),M.write_shift(1,V),M.write_shift(1,U),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(1,1),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(4,0),M}function f(I,M,R){var U={s:{c:0,r:0},e:{c:0,r:0}};return M==8&&R.qpro?(U.s.c=I.read_shift(1),I.l++,U.s.r=I.read_shift(2),U.e.c=I.read_shift(1),I.l++,U.e.r=I.read_shift(2),U):(U.s.c=I.read_shift(2),U.s.r=I.read_shift(2),M==12&&R.qpro&&(I.l+=2),U.e.c=I.read_shift(2),U.e.r=I.read_shift(2),M==12&&R.qpro&&(I.l+=2),U.s.c==65535&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}function d(I){var M=new_buf(8);return M.write_shift(2,I.s.c),M.write_shift(2,I.s.r),M.write_shift(2,I.e.c),M.write_shift(2,I.e.r),M}function h(I,M,R){var U=[{c:0,r:0},{t:"n",v:0},0,0];return R.qpro&&R.vers!=20768?(U[0].c=I.read_shift(1),U[3]=I.read_shift(1),U[0].r=I.read_shift(2),I.l+=2):(U[2]=I.read_shift(1),U[0].c=I.read_shift(2),U[0].r=I.read_shift(2)),U}function p(I,M,R){var U=I.l+M,V=h(I,M,R);if(V[1].t="s",R.vers==20768){I.l++;var Z=I.read_shift(1);return V[1].v=I.read_shift(Z,"utf8"),V}return R.qpro&&I.l++,V[1].v=I.read_shift(U-I.l,"cstr"),V}function E(I,M,R){var U=new_buf(7+R.length);U.write_shift(1,255),U.write_shift(2,M),U.write_shift(2,I),U.write_shift(1,39);for(var V=0;V<U.length;++V){var Z=R.charCodeAt(V);U.write_shift(1,Z>=128?95:Z)}return U.write_shift(1,0),U}function v(I,M,R){var U=h(I,M,R);return U[1].v=I.read_shift(2,"i"),U}function S(I,M,R){var U=new_buf(7);return U.write_shift(1,255),U.write_shift(2,M),U.write_shift(2,I),U.write_shift(2,R,"i"),U}function x(I,M,R){var U=h(I,M,R);return U[1].v=I.read_shift(8,"f"),U}function g(I,M,R){var U=new_buf(13);return U.write_shift(1,255),U.write_shift(2,M),U.write_shift(2,I),U.write_shift(8,R,"f"),U}function m(I,M,R){var U=I.l+M,V=h(I,M,R);if(V[1].v=I.read_shift(8,"f"),R.qpro)I.l=U;else{var Z=I.read_shift(2);F(I.slice(I.l,I.l+Z),V),I.l+=Z}return V}function b(I,M,R){var U=M&32768;return M&=-32769,M=(U?I:0)+(M>=8192?M-16384:M),(U?"":"$")+(R?encode_col(M):encode_row(M))}var D={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function F(I,M){prep_blob(I,0);for(var R=[],U=0,V="",Z="",J="",O="";I.l<I.length;){var B=I[I.l++];switch(B){case 0:R.push(I.read_shift(8,"f"));break;case 1:Z=b(M[0].c,I.read_shift(2),!0),V=b(M[0].r,I.read_shift(2),!1),R.push(Z+V);break;case 2:{var G=b(M[0].c,I.read_shift(2),!0),P=b(M[0].r,I.read_shift(2),!1);Z=b(M[0].c,I.read_shift(2),!0),V=b(M[0].r,I.read_shift(2),!1),R.push(G+P+":"+Z+V)}break;case 3:if(I.l<I.length){console.error("WK1 premature formula end");return}break;case 4:R.push("("+R.pop()+")");break;case 5:R.push(I.read_shift(2));break;case 6:{for(var K="";B=I[I.l++];)K+=String.fromCharCode(B);R.push('"'+K.replace(/"/g,'""')+'"')}break;case 8:R.push("-"+R.pop());break;case 23:R.push("+"+R.pop());break;case 22:R.push("NOT("+R.pop()+")");break;case 20:case 21:O=R.pop(),J=R.pop(),R.push(["AND","OR"][B-20]+"("+J+","+O+")");break;default:if(B<32&&C[B])O=R.pop(),J=R.pop(),R.push(J+C[B]+O);else if(D[B]){if(U=D[B][1],U==69&&(U=I[I.l++]),U>R.length){console.error("WK1 bad formula parse 0x"+B.toString(16)+":|"+R.join("|")+"|");return}var oe=R.slice(-U);R.length-=U,R.push(D[B][0]+"("+oe.join(",")+")")}else return B<=7?console.error("WK1 invalid opcode "+B.toString(16)):B<=24?console.error("WK1 unsupported op "+B.toString(16)):B<=30?console.error("WK1 invalid opcode "+B.toString(16)):B<=115?console.error("WK1 unsupported function opcode "+B.toString(16)):console.error("WK1 unrecognized opcode "+B.toString(16))}}R.length==1?M[1].f=""+R[0]:console.error("WK1 bad formula parse |"+R.join("|")+"|")}function T(I){var M=[{c:0,r:0},{t:"n",v:0},0];return M[0].r=I.read_shift(2),M[3]=I[I.l++],M[0].c=I[I.l++],M}function w(I,M){var R=T(I);return R[1].t="s",R[1].v=I.read_shift(M-4,"cstr"),R}function y(I,M,R,U){var V=new_buf(6+U.length);V.write_shift(2,I),V.write_shift(1,R),V.write_shift(1,M),V.write_shift(1,39);for(var Z=0;Z<U.length;++Z){var J=U.charCodeAt(Z);V.write_shift(1,J>=128?95:J)}return V.write_shift(1,0),V}function N(I,M){var R=T(I);R[1].v=I.read_shift(2);var U=R[1].v>>1;if(R[1].v&1)switch(U&7){case 0:U=(U>>3)*5e3;break;case 1:U=(U>>3)*500;break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64;break}return R[1].v=U,R}function L(I,M){var R=T(I),U=I.read_shift(4),V=I.read_shift(4),Z=I.read_shift(2);if(Z==65535)return U===0&&V===3221225472?(R[1].t="e",R[1].v=15):U===0&&V===3489660928?(R[1].t="e",R[1].v=42):R[1].v=0,R;var J=Z&32768;return Z=(Z&32767)-16446,R[1].v=(1-J*2)*(V*Math.pow(2,Z+32)+U*Math.pow(2,Z)),R}function X(I,M,R,U){var V=new_buf(14);if(V.write_shift(2,I),V.write_shift(1,R),V.write_shift(1,M),U==0)return V.write_shift(4,0),V.write_shift(4,0),V.write_shift(2,65535),V;var Z=0,J=0,O=0,B=0;return U<0&&(Z=1,U=-U),J=Math.log2(U)|0,U/=Math.pow(2,J-31),B=U>>>0,B&2147483648||(U/=2,++J,B=U>>>0),U-=B,B|=2147483648,B>>>=0,U*=Math.pow(2,32),O=U>>>0,V.write_shift(4,O),V.write_shift(4,B),J+=16383+(Z?32768:0),V.write_shift(2,J),V}function z(I,M){var R=L(I);return I.l+=M-14,R}function se(I,M){var R=T(I),U=I.read_shift(4);return R[1].v=U>>6,R}function me(I,M){var R=T(I),U=I.read_shift(8,"f");return R[1].v=U,R}function _e(I,M){var R=me(I);return I.l+=M-10,R}function de(I,M){return I[I.l+M-1]==0?I.read_shift(M,"cstr"):""}function Y(I,M){var R=I[I.l++];R>M-1&&(R=M-1);for(var U="";U.length<R;)U+=String.fromCharCode(I[I.l++]);return U}function ie(I,M,R){if(!(!R.qpro||M<21)){var U=I.read_shift(1);I.l+=17,I.l+=1,I.l+=2;var V=I.read_shift(M-21,"cstr");return[U,V]}}function fe(I,M){for(var R={},U=I.l+M;I.l<U;){var V=I.read_shift(2);if(V==14e3){for(R[V]=[0,""],R[V][0]=I.read_shift(2);I[I.l];)R[V][1]+=String.fromCharCode(I[I.l]),I.l++;I.l++}}return R}function ae(I,M){var R=new_buf(5+I.length);R.write_shift(2,14e3),R.write_shift(2,M);for(var U=0;U<I.length;++U){var V=I.charCodeAt(U);R[R.l++]=V>127?95:V}return R[R.l++]=0,R}var W={0:{n:"BOF",f:parseuint16},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:de},222:{n:"SHEETNAMELP",f:Y},65535:{n:""}},xe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:w},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:z},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:fe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:se},38:{n:"??"},39:{n:"NUMBER27",f:me},40:{n:"FORMULA28",f:_e},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:de},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ie},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:r}}();function parse_rpr(e){var r={},t=e.match(tagregex),n=0,i=!1;if(t)for(;n!=t.length;++n){var l=parsexmltag(t[n]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;r.cp=CS2CP[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=l.val;break;case"<sz":r.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":l.rgb&&(r.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(l[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+l[0])}}return r}var parse_rs=function(){var e=matchtag("t"),r=matchtag("rPr");function t(l){var c=l.match(e);if(!c)return{t:"s",v:""};var f={t:"s",v:unescapexml(c[1])},d=l.match(r);return d&&(f.s=parse_rpr(d[1])),f}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(c){return c.replace(n,"").split(i).map(t).filter(function(f){return f.v})}}(),rs_to_html=function(){var r=/(\r\n|\n)/g;function t(i,l,c){var f=[];i.u&&f.push("text-decoration: underline;"),i.uval&&f.push("text-underline-style:"+i.uval+";"),i.sz&&f.push("font-size:"+i.sz+"pt;"),i.outline&&f.push("text-effect: outline;"),i.shadow&&f.push("text-shadow: auto;"),l.push('<span style="'+f.join("")+'">'),i.b&&(l.push("<b>"),c.push("</b>")),i.i&&(l.push("<i>"),c.push("</i>")),i.strike&&(l.push("<s>"),c.push("</s>"));var d=i.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(l.push("<"+d+">"),c.push("</"+d+">")),c.push("</span>"),i}function n(i){var l=[[],i.v,[]];return i.v?(i.s&&t(i.s,l[0],l[2]),l[0].join("")+l[1].replace(r,"<br/>")+l[2].join("")):""}return function(l){return l.map(n).join("")}}(),sitregex=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,sirregex=/<(?:\w+:)?r>/,sirphregex=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function parse_si(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=unescapexml(utf8read(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=utf8read(e),t&&(n.h=escapehtml(n.t))):e.match(sirregex)&&(n.r=utf8read(e),n.t=unescapexml(utf8read((e.replace(sirphregex,"").match(sitregex)||[]).join("").replace(tagregex,""))),t&&(n.h=rs_to_html(parse_rs(n.r)))),n):{t:""}}var sstr0=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sstr1=/<(?:\w+:)?(?:si|sstItem)>/g,sstr2=/<\/(?:\w+:)?(?:si|sstItem)>/;function parse_sst_xml(e,r){var t=[],n="";if(!e)return t;var i=e.match(sstr0);if(i){n=i[2].replace(sstr1,"").split(sstr2);for(var l=0;l!=n.length;++l){var c=parse_si(n[l].trim(),r);c!=null&&(t[t.length]=c)}i=parsexmltag(i[1]),t.Count=i.count,t.Unique=i.uniqueCount}return t}function parse_BrtBeginSst(e){return[e.read_shift(4),e.read_shift(4)]}function parse_sst_bin(e,r){var t=[],n=!1;return recordhopper(e,function(l,c,f){switch(f){case 159:t.Count=l[0],t.Unique=l[1];break;case 19:t.push(l);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(c.T,!n||r.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}),t}function _JS2ANSI(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function parse_CRYPTOVersion(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function parse_DataSpaceVersionInfo(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=parse_CRYPTOVersion(e,4),r.U=parse_CRYPTOVersion(e,4),r.W=parse_CRYPTOVersion(e,4),r}function parse_DataSpaceMapEntry(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},i=e.read_shift(4),l=[];i-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=l,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function parse_DataSpaceMap(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(parse_DataSpaceMapEntry(e));return r}function parse_DataSpaceDefinition(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function parse_TransformInfoHeader(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=parse_CRYPTOVersion(e,4),r.U=parse_CRYPTOVersion(e,4),r.W=parse_CRYPTOVersion(e,4),r}function parse_Primary(e){var r=parse_TransformInfoHeader(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function parse_EncryptionHeader(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function parse_EncryptionVerifier(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function parse_EncryptionInfo(e){var r=parse_CRYPTOVersion(e);switch(r.Minor){case 2:return[r.Minor,parse_EncInfoStd(e)];case 3:return[r.Minor,parse_EncInfoExt()];case 4:return[r.Minor,parse_EncInfoAgl(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function parse_EncInfoStd(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=parse_EncryptionHeader(e,t),i=parse_EncryptionVerifier(e,e.length-e.l);return{t:"Std",h:n,v:i}}function parse_EncInfoExt(){throw new Error("File is password-protected: ECMA-376 Extensible")}function parse_EncInfoAgl(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(tagregex,function(l){var c=parsexmltag(l);switch(strip_ns(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(f){n[f]=c[f]});break;case"<dataIntegrity":n.encryptedHmacKey=c.encryptedHmacKey,n.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(c);break;default:throw c[0]}}),n}function parse_RC4CryptoHeader(e,r){var t={},n=t.EncryptionVersionInfo=parse_CRYPTOVersion(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var i=e.read_shift(4);return r-=4,t.EncryptionHeader=parse_EncryptionHeader(e,i),r-=i,t.EncryptionVerifier=parse_EncryptionVerifier(e,r),t}function parse_RC4Header(e){var r={},t=r.EncryptionVersionInfo=parse_CRYPTOVersion(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function crypto_CreatePasswordVerifier_Method1(e){var r=0,t,n=_JS2ANSI(e),i=n.length+1,l,c,f,d,h;for(t=new_raw_buf(i),t[0]=n.length,l=1;l!=i;++l)t[l]=n[l-1];for(l=i-1;l>=0;--l)c=t[l],f=r&16384?1:0,d=r<<1&32767,h=f|d,r=h^c;return r^52811}var crypto_CreateXorArray_Method1=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(c){return(c/2|c*128)&255},i=function(c,f){return n(c^f)},l=function(c){for(var f=r[c.length-1],d=104,h=c.length-1;h>=0;--h)for(var p=c[h],E=0;E!=7;++E)p&64&&(f^=t[d]),p*=2,--d;return f};return function(c){for(var f=_JS2ANSI(c),d=l(f),h=f.length,p=new_raw_buf(16),E=0;E!=16;++E)p[E]=0;var v,S,x;for((h&1)===1&&(v=d>>8,p[h]=i(e[0],v),--h,v=d&255,S=f[f.length-1],p[h]=i(S,v));h>0;)--h,v=d>>8,p[h]=i(f[h],v),--h,v=d&255,p[h]=i(f[h],v);for(h=15,x=15-f.length;x>0;)v=d>>8,p[h]=i(e[x],v),--h,--x,v=d&255,p[h]=i(f[h],v),--h,--x;return p}}(),crypto_DecryptData_Method1=function(e,r,t,n,i){i||(i=r),n||(n=crypto_CreateXorArray_Method1(e));var l,c;for(l=0;l!=r.length;++l)c=r[l],c^=n[t],c=(c>>5|c<<3)&255,i[l]=c,++t;return[i,t,n]},crypto_MakeXorDecryptor=function(e){var r=0,t=crypto_CreateXorArray_Method1(e);return function(n){var i=crypto_DecryptData_Method1("",n,r,t);return r=i[1],i[0]}};function parse_XORObfuscation(e,r,t,n){var i={key:parseuint16(e),verificationBytes:parseuint16(e)};return t.password&&(i.verifier=crypto_CreatePasswordVerifier_Method1(t.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=crypto_MakeXorDecryptor(t.password)),i}function parse_FilePassHeader(e,r,t){var n=t;return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=parse_RC4Header(e):n.Data=parse_RC4CryptoHeader(e,r),n}function parse_FilePass(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?parse_FilePassHeader(e,r-2,n):parse_XORObfuscation(e,t.biff>=8?r:r-2,t,n),n}var RTF=function(){function e(i,l){switch(l.type){case"base64":return r(Base64_decode(i),l);case"binary":return r(i,l);case"buffer":return r(has_buf&&Buffer.isBuffer(i)?i.toString("binary"):a2s(i),l);case"array":return r(cc2str(i),l)}throw new Error("Unrecognized type "+l.type)}function r(i,l){var c=l||{},f=c.dense?[]:{},d=i.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(p,E){Array.isArray(f)&&(f[E]=[]);for(var v=/\\\w+\b/g,S=0,x,g=-1;x=v.exec(p);){switch(x[0]){case"\\cell":var m=p.slice(S,v.lastIndex-x[0].length);if(m[0]==" "&&(m=m.slice(1)),++g,m.length){var b={v:m,t:"s"};Array.isArray(f)?f[E][g]=b:f[encode_cell({r:E,c:g})]=b}break}S=v.lastIndex}g>h.e.c&&(h.e.c=g)}),f["!ref"]=encode_range(h),f}function t(i,l){return sheet_to_workbook(e(i,l),l)}function n(i){for(var l=["{\\rtf1\\ansi"],c=safe_decode_range(i["!ref"]),f,d=Array.isArray(i),h=c.s.r;h<=c.e.r;++h){l.push("\\trowd\\trautofit1");for(var p=c.s.c;p<=c.e.c;++p)l.push("\\cellx"+(p+1));for(l.push("\\pard\\intbl"),p=c.s.c;p<=c.e.c;++p){var E=encode_cell({r:h,c:p});f=d?(i[h]||[])[p]:i[E],!(!f||f.v==null&&(!f.f||f.F))&&(l.push(" "+(f.w||(format_cell(f),f.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}}();function hex2RGB(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function rgb2Hex(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function rgb2HSL(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,i=Math.max(r,t,n),l=Math.min(r,t,n),c=i-l;if(c===0)return[0,0,r];var f=0,d=0,h=i+l;switch(d=c/(h>1?2-h:h),i){case r:f=((t-n)/c+6)%6;break;case t:f=(n-r)/c+2;break;case n:f=(r-t)/c+4;break}return[f/6,d,h/2]}function hsl2RGB(e){var r=e[0],t=e[1],n=e[2],i=t*2*(n<.5?n:1-n),l=n-i/2,c=[l,l,l],f=6*r,d;if(t!==0)switch(f|0){case 0:case 6:d=i*f,c[0]+=i,c[1]+=d;break;case 1:d=i*(2-f),c[0]+=d,c[1]+=i;break;case 2:d=i*(f-2),c[1]+=i,c[2]+=d;break;case 3:d=i*(4-f),c[1]+=d,c[2]+=i;break;case 4:d=i*(f-4),c[2]+=i,c[0]+=d;break;case 5:d=i*(6-f),c[2]+=d,c[0]+=i;break}for(var h=0;h!=3;++h)c[h]=Math.round(c[h]*255);return c}function rgb_tint(e,r){if(r===0)return e;var t=rgb2HSL(hex2RGB(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),rgb2Hex(hsl2RGB(t))}var DEF_MDW=6,MAX_MDW=15,MIN_MDW=1,MDW=DEF_MDW;function width2px(e){return Math.floor((e+Math.round(128/MDW)/256)*MDW)}function px2char(e){return Math.floor((e-5)/MDW*100+.5)/100}function char2width(e){return Math.round((e*MDW+5)/MDW*256)/256}function cycle_width(e){return char2width(px2char(width2px(e)))}function find_mdw_colw(e){var r=Math.abs(e-cycle_width(e)),t=MDW;if(r>.005)for(MDW=MIN_MDW;MDW<MAX_MDW;++MDW)Math.abs(e-cycle_width(e))<=r&&(r=Math.abs(e-cycle_width(e)),t=MDW);MDW=t}function process_col(e){e.width?(e.wpx=width2px(e.width),e.wch=px2char(e.wpx),e.MDW=MDW):e.wpx?(e.wch=px2char(e.wpx),e.width=char2width(e.wch),e.MDW=MDW):typeof e.wch=="number"&&(e.width=char2width(e.wch),e.wpx=width2px(e.width),e.MDW=MDW),e.customWidth&&delete e.customWidth}var DEF_PPI=96,PPI=DEF_PPI;function px2pt(e){return e*96/PPI}function pt2px(e){return e*PPI/96}var XLMLPatternTypeMap={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function parse_borders(e,r,t,n){r.Borders=[];var i={},l=!1;(e[0].match(tagregex)||[]).forEach(function(c){var f=parsexmltag(c);switch(strip_ns(f[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},f.diagonalUp&&(i.diagonalUp=parsexmlbool(f.diagonalUp)),f.diagonalDown&&(i.diagonalDown=parsexmlbool(f.diagonalDown)),r.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+f[0]+" in borders")}})}function parse_fills(e,r,t,n){r.Fills=[];var i={},l=!1;(e[0].match(tagregex)||[]).forEach(function(c){var f=parsexmltag(c);switch(strip_ns(f[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},r.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":f.patternType&&(i.patternType=f.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),f.indexed&&(i.bgColor.indexed=parseInt(f.indexed,10)),f.theme&&(i.bgColor.theme=parseInt(f.theme,10)),f.tint&&(i.bgColor.tint=parseFloat(f.tint)),f.rgb&&(i.bgColor.rgb=f.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),f.theme&&(i.fgColor.theme=parseInt(f.theme,10)),f.tint&&(i.fgColor.tint=parseFloat(f.tint)),f.rgb!=null&&(i.fgColor.rgb=f.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+f[0]+" in fills")}})}function parse_fonts(e,r,t,n){r.Fonts=[];var i={},l=!1;(e[0].match(tagregex)||[]).forEach(function(c){var f=parsexmltag(c);switch(strip_ns(f[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(i),i={};break;case"<name":f.val&&(i.name=utf8read(f.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=f.val?parsexmlbool(f.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=f.val?parsexmlbool(f.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(f.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=f.val?parsexmlbool(f.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=f.val?parsexmlbool(f.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=f.val?parsexmlbool(f.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=f.val?parsexmlbool(f.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=f.val?parsexmlbool(f.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":f.val&&(i.sz=+f.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":f.val&&(i.vertAlign=f.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":f.val&&(i.family=parseInt(f.val,10));break;case"<family/>":case"</family>":break;case"<scheme":f.val&&(i.scheme=f.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(f.val=="1")break;f.codepage=CS2CP[parseInt(f.val,10)];break;case"<color":if(i.color||(i.color={}),f.auto&&(i.color.auto=parsexmlbool(f.auto)),f.rgb)i.color.rgb=f.rgb.slice(-6);else if(f.indexed){i.color.index=parseInt(f.indexed,10);var d=XLSIcv[i.color.index];i.color.index==81&&(d=XLSIcv[1]),d||(d=XLSIcv[1]),i.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else f.theme&&(i.color.theme=parseInt(f.theme,10),f.tint&&(i.color.tint=parseFloat(f.tint)),f.theme&&t.themeElements&&t.themeElements.clrScheme&&(i.color.rgb=rgb_tint(t.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+f[0]+" in fonts")}})}function parse_numFmts(e,r,t){r.NumberFmt=[];for(var n=keys(table_fmt),i=0;i<n.length;++i)r.NumberFmt[n[i]]=table_fmt[n[i]];var l=e[0].match(tagregex);if(l)for(i=0;i<l.length;++i){var c=parsexmltag(l[i]);switch(strip_ns(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var f=unescapexml(utf8read(c.formatCode)),d=parseInt(c.numFmtId,10);if(r.NumberFmt[d]=f,d>0){if(d>392){for(d=392;d>60&&r.NumberFmt[d]!=null;--d);r.NumberFmt[d]=f}SSF_load(f,d)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}var cellXF_uint=["numFmtId","fillId","fontId","borderId","xfId"],cellXF_bool=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function parse_cellXfs(e,r,t){r.CellXf=[];var n,i=!1;(e[0].match(tagregex)||[]).forEach(function(l){var c=parsexmltag(l),f=0;switch(strip_ns(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=c,delete n[0],f=0;f<cellXF_uint.length;++f)n[cellXF_uint[f]]&&(n[cellXF_uint[f]]=parseInt(n[cellXF_uint[f]],10));for(f=0;f<cellXF_bool.length;++f)n[cellXF_bool[f]]&&(n[cellXF_bool[f]]=parsexmlbool(n[cellXF_bool[f]]));if(r.NumberFmt&&n.numFmtId>392){for(f=392;f>60;--f)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[f]){n.numFmtId=f;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};c.vertical&&(d.vertical=c.vertical),c.horizontal&&(d.horizontal=c.horizontal),c.textRotation!=null&&(d.textRotation=c.textRotation),c.indent&&(d.indent=c.indent),c.wrapText&&(d.wrapText=parsexmlbool(c.wrapText)),n.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(t&&t.WTF&&!i)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}var parse_sty_xml=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(f,d,h){var p={};if(!f)return p;f=f.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var E;return(E=f.match(r))&&parse_numFmts(E,p,h),(E=f.match(i))&&parse_fonts(E,p,d,h),(E=f.match(n))&&parse_fills(E,p,d,h),(E=f.match(l))&&parse_borders(E,p,d,h),(E=f.match(t))&&parse_cellXfs(E,p,h),p}}();function parse_BrtFmt(e,r){var t=e.read_shift(2),n=parse_XLWideString(e);return[t,n]}function parse_BrtFont(e,r,t){var n={};n.sz=e.read_shift(2)/20;var i=parse_FontFlags(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var l=e.read_shift(2);switch(l===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var c=e.read_shift(1);c!=0&&(n.underline=c);var f=e.read_shift(1);f>0&&(n.family=f);var d=e.read_shift(1);switch(d>0&&(n.charset=d),e.l++,n.color=parse_BrtColor(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=parse_XLWideString(e),n}var parse_BrtFill=parsenoop;function parse_BrtXF(e,r){var t=e.l+r,n=e.read_shift(2),i=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:i}}var parse_BrtBorder=parsenoop;function parse_sty_bin(e,r,t){var n={};n.NumberFmt=[];for(var i in table_fmt)n.NumberFmt[i]=table_fmt[i];n.CellXf=[],n.Fonts=[];var l=[],c=!1;return recordhopper(e,function(d,h,p){switch(p){case 44:n.NumberFmt[d[0]]=d[1],SSF_load(d[1],d[0]);break;case 43:n.Fonts.push(d),d.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(d.color.rgb=rgb_tint(r.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&n.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:l.push(p),c=!0;break;case 38:l.pop(),c=!1;break;default:if(h.T>0)l.push(p);else if(h.T<0)l.pop();else if(!c||t.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),n}var XLSXThemeClrScheme=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function parse_clrScheme(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(tagregex)||[]).forEach(function(i){var l=parsexmltag(i);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=l.val;break;case"<a:sysClr":n.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(r.themeElements.clrScheme[XLSXThemeClrScheme.indexOf(l[0])]=n,n={}):n.name=l[0].slice(3,l[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function parse_fontScheme(){}function parse_fmtScheme(){}var clrsregex=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,fntsregex=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,fmtsregex=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function parse_themeElements(e,r,t){r.themeElements={};var n;[["clrScheme",clrsregex,parse_clrScheme],["fontScheme",fntsregex,parse_fontScheme],["fmtScheme",fmtsregex,parse_fmtScheme]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,r,t)})}var themeltregex=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function parse_theme_xml(e,r){(!e||e.length===0)&&(e=write_theme());var t,n={};if(!(t=e.match(themeltregex)))throw new Error("themeElements not found in theme");return parse_themeElements(t[0],n,r),n.raw=e,n}function write_theme(e,r){var t=[XML_HEADER];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function parse_Theme(e,r,t){var n=e.l+r,i=e.read_shift(4);if(i!==124226){if(!t.cellStyles){e.l=n;return}var l=e.slice(e.l);e.l=n;var c;try{c=zip_read(l,{type:"array"})}catch{return}var f=getzipstr(c,"theme/theme/theme1.xml",!0);if(f)return parse_theme_xml(f,t)}}function parse_ColorTheme(e){return e.read_shift(4)}function parse_FullColorExt(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=parse_IcvXF(e,4);break;case 2:r.xclrValue=parse_LongRGBA(e);break;case 3:r.xclrValue=parse_ColorTheme(e);break;case 4:e.l+=4;break}return e.l+=8,r}function parse_IcvXF(e,r){return parsenoop(e,r)}function parse_XFExtGradient(e,r){return parsenoop(e,r)}function parse_ExtProp(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=parse_FullColorExt(e);break;case 6:n[1]=parse_XFExtGradient(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function parse_XFExt(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),l=[];i-- >0;)l.push(parse_ExtProp(e,t-e.l));return{ixfe:n,ext:l}}function update_xfext(e,r){r.forEach(function(t){switch(t[0]){}})}function parse_BrtMdtinfo(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:parse_XLWideString(e)}}function parse_BrtMdb(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function parse_BrtBeginEsmdb(e){return e.l+=4,e.read_shift(4)!=0}function parse_xlmeta_bin(e,r,t){var n={Types:[],Cell:[],Value:[]},i=t||{},l=[],c=!1,f=2;return recordhopper(e,function(d,h,p){switch(p){case 335:n.Types.push({name:d.name});break;case 51:d.forEach(function(E){f==1?n.Cell.push({type:n.Types[E[0]-1].name,index:E[1]}):f==0&&n.Value.push({type:n.Types[E[0]-1].name,index:E[1]})});break;case 337:f=d?1:0;break;case 338:f=2;break;case 35:l.push(p),c=!0;break;case 36:l.pop(),c=!1;break;default:if(!h.T){if(!c||i.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),n}function parse_xlmeta_xml(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,l=2,c;return e.replace(tagregex,function(f){var d=parsexmltag(f);switch(strip_ns(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<n.Types.length;++h)n.Types[h].name==d.name&&(c=n.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?n.Cell.push({type:n.Types[d.t-1].name,index:+d.v}):l==0&&n.Value.push({type:n.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+d.i);break;default:if(!i&&t.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return f}),n}function parse_cc_xml(e){var r=[];if(!e)return r;var t=1;return(e.match(tagregex)||[]).forEach(function(n){var i=parsexmltag(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?t=i.i:i.i=t,r.push(i);break}}),r}function parse_BrtCalcChainItem$(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=encode_cell(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function parse_cc_bin(e,r,t){var n=[];return recordhopper(e,function(l,c,f){switch(f){case 63:n.push(l);break;default:if(!c.T)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function parse_xlink_xml(){}function parse_xlink_bin(e,r,t,n){if(!e)return e;var i=n||{},l=!1;recordhopper(e,function(f,d,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!d.T){if(!l||i.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},i)}function parse_drawing(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}function sheet_insert_comments(e,r,t,n){var i=Array.isArray(e),l;r.forEach(function(c){var f=decode_cell(c.ref);if(i?(e[f.r]||(e[f.r]=[]),l=e[f.r][f.c]):l=e[c.ref],!l){l={t:"z"},i?e[f.r][f.c]=l:e[c.ref]=l;var d=safe_decode_range(e["!ref"]||"BDWGO1000001:A1");d.s.r>f.r&&(d.s.r=f.r),d.e.r<f.r&&(d.e.r=f.r),d.s.c>f.c&&(d.s.c=f.c),d.e.c<f.c&&(d.e.c=f.c);var h=encode_range(d);h!==e["!ref"]&&(e["!ref"]=h)}l.c||(l.c=[]);var p={a:c.author,t:c.t,r:c.r,T:t};c.h&&(p.h=c.h);for(var E=l.c.length-1;E>=0;--E){if(!t&&l.c[E].T)return;t&&!l.c[E].T&&l.c.splice(E,1)}if(t&&n){for(E=0;E<n.length;++E)if(p.a==n[E].id){p.a=n[E].name||p.a;break}}l.c.push(p)})}function parse_comments_xml(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var f=c.match(/<(?:\w+:)?author[^>]*>(.*)/);f&&t.push(f[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var f=c.match(/<(?:\w+:)?comment[^>]*>/);if(f){var d=parsexmltag(f[0]),h={author:d.authorId&&t[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},p=decode_cell(d.ref);if(!(r.sheetRows&&r.sheetRows<=p.r)){var E=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!E&&!!E[1]&&parse_si(E[1])||{r:"",t:"",h:""};h.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),h.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(h.h=v.h),n.push(h)}}}}),n}function parse_tcmnt_xml(e,r){var t=[],n=!1,i={},l=0;return e.replace(tagregex,function(f,d){var h=parsexmltag(f);switch(strip_ns(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":i.t!=null&&t.push(i);break;case"<text>":case"<text":l=d+f.length;break;case"</text>":i.t=e.slice(l,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return f}),t}function parse_people_xml(e,r){var t=[],n=!1;return e.replace(tagregex,function(l){var c=parsexmltag(l);switch(strip_ns(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return l}),t}function parse_BrtBeginComment(e){var r={};r.iauthor=e.read_shift(4);var t=parse_UncheckedRfX(e);return r.rfx=t.s,r.ref=encode_cell(t.s),e.l+=16,r}var parse_BrtCommentAuthor=parse_XLWideString;function parse_comments_bin(e,r){var t=[],n=[],i={},l=!1;return recordhopper(e,function(f,d,h){switch(h){case 632:n.push(f);break;case 635:i=f;break;case 637:i.t=f.t,i.h=f.h,i.r=f.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,r.sheetRows&&i.rfx&&r.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,t.push(i);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!l||r.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),t}var CT_VBA="application/vnd.ms-office.vbaProject";function make_vba_xls(e){var r=CFB.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var i=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");CFB.utils.cfb_add(r,i,e.FileIndex[n].content)}}),CFB.write(r)}function parse_ds_bin(){return{"!type":"dialog"}}function parse_ds_xml(){return{"!type":"dialog"}}function parse_ms_bin(){return{"!type":"macro"}}function parse_ms_xml(){return{"!type":"macro"}}var rc_to_a1=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,i,l,c){var f=!1,d=!1;l.length==0?d=!0:l.charAt(0)=="["&&(d=!0,l=l.slice(1,-1)),c.length==0?f=!0:c.charAt(0)=="["&&(f=!0,c=c.slice(1,-1));var h=l.length>0?parseInt(l,10)|0:0,p=c.length>0?parseInt(c,10)|0:0;return f?p+=r.c:--p,d?h+=r.r:--h,i+(f?"":"$")+encode_col(p)+(d?"":"$")+encode_row(h)}return function(i,l){return r=l,i.replace(e,t)}}(),crefregex=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,a1_to_rc=function(){return function(r,t){return r.replace(crefregex,function(n,i,l,c,f,d){var h=decode_col(c)-(l?0:t.c),p=decode_row(d)-(f?0:t.r),E=p==0?"":f?p+1:"["+p+"]",v=h==0?"":l?h+1:"["+h+"]";return i+"R"+E+"C"+v})}}();function shift_formula_str(e,r){return e.replace(crefregex,function(t,n,i,l,c,f){return n+(i=="$"?i+l:encode_col(decode_col(l)+r.c))+(c=="$"?c+f:encode_row(decode_row(f)+r.r))})}function shift_formula_xlsx(e,r,t){var n=decode_range(r),i=n.s,l=decode_cell(t),c={r:l.r-i.r,c:l.c-i.c};return shift_formula_str(e,c)}function fuzzyfmla(e){return e.length!=1}function _xlfn(e){return e.replace(/_xlfn\./g,"")}function parseread1(e){e.l+=1}function parse_ColRelU(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function parse_RgceArea(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return parse_RgceArea_BIFF2(e);t.biff==12&&(n=4)}var i=e.read_shift(n),l=e.read_shift(n),c=parse_ColRelU(e),f=parse_ColRelU(e);return{s:{r:i,c:c[0],cRel:c[1],rRel:c[2]},e:{r:l,c:f[0],cRel:f[1],rRel:f[2]}}}function parse_RgceArea_BIFF2(e){var r=parse_ColRelU(e),t=parse_ColRelU(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function parse_RgceAreaRel(e,r,t){if(t.biff<8)return parse_RgceArea_BIFF2(e);var n=e.read_shift(t.biff==12?4:2),i=e.read_shift(t.biff==12?4:2),l=parse_ColRelU(e),c=parse_ColRelU(e);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function parse_RgceLoc(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return parse_RgceLoc_BIFF2(e);var n=e.read_shift(t&&t.biff==12?4:2),i=parse_ColRelU(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function parse_RgceLoc_BIFF2(e){var r=parse_ColRelU(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function parse_RgceElfLoc(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function parse_RgceLocRel(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return parse_RgceLocRel_BIFF2(e);var i=e.read_shift(n>=12?4:2),l=e.read_shift(2),c=(l&16384)>>14,f=(l&32768)>>15;if(l&=16383,f==1)for(;i>524287;)i-=1048576;if(c==1)for(;l>8191;)l=l-16384;return{r:i,c:l,cRel:c,rRel:f}}function parse_RgceLocRel_BIFF2(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,i=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),i==1&&t>=128&&(t=t-256),{r,c:t,cRel:i,rRel:n}}function parse_PtgArea(e,r,t){var n=(e[e.l++]&96)>>5,i=parse_RgceArea(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,i]}function parse_PtgArea3d(e,r,t){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),l=8;if(t)switch(t.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var c=parse_RgceArea(e,l,t);return[n,i,c]}function parse_PtgAreaErr(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function parse_PtgAreaErr3d(e,r,t){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),l=8;if(t)switch(t.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[n,i]}function parse_PtgAreaN(e,r,t){var n=(e[e.l++]&96)>>5,i=parse_RgceAreaRel(e,r-1,t);return[n,i]}function parse_PtgArray(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function parse_PtgAttrBaxcel(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function parse_PtgAttrChoose(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),i=[],l=0;l<=n;++l)i.push(e.read_shift(t&&t.biff==2?1:2));return i}function parse_PtgAttrGoto(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function parse_PtgAttrIf(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function parse_PtgAttrIfError(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function parse_PtgAttrSemi(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function parse_PtgAttrSpaceType(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function parse_PtgAttrSpace(e){return e.read_shift(2),parse_PtgAttrSpaceType(e)}function parse_PtgAttrSpaceSemi(e){return e.read_shift(2),parse_PtgAttrSpaceType(e)}function parse_PtgRef(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var i=parse_RgceLoc(e,0,t);return[n,i]}function parse_PtgRefN(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var i=parse_RgceLocRel(e,0,t);return[n,i]}function parse_PtgRef3d(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var l=parse_RgceLoc(e,0,t);return[n,i,l]}function parse_PtgFunc(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(t&&t.biff<=3?1:2);return[FtabArgc[i],Ftab[i],n]}function parse_PtgFuncVar(e,r,t){var n=e[e.l++],i=e.read_shift(1),l=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:parsetab(e);return[i,(l[0]===0?Ftab:Cetab)[l[1]]]}function parsetab(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function parse_PtgAttrSum(e,r,t){e.l+=t&&t.biff==2?3:4}function parse_PtgExp(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(t&&t.biff==2?1:2);return[n,i]}function parse_PtgErr(e){return e.l++,BErr[e.read_shift(1)]}function parse_PtgInt(e){return e.l++,e.read_shift(2)}function parse_PtgBool(e){return e.l++,e.read_shift(1)!==0}function parse_PtgNum(e){return e.l++,parse_Xnum(e)}function parse_PtgStr(e,r,t){return e.l++,parse_ShortXLUnicodeString(e,r-1,t)}function parse_SerAr(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=parsebool(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=BErr[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=parse_Xnum(e);break;case 2:t[1]=parse_XLUnicodeString2(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function parse_PtgExtraMem(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),i=[],l=0;l!=n;++l)i.push((t.biff==12?parse_UncheckedRfX:parse_Ref8U)(e));return i}function parse_PtgExtraArray(e,r,t){var n=0,i=0;t.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--i==0&&(i=256));for(var l=0,c=[];l!=n&&(c[l]=[]);++l)for(var f=0;f!=i;++f)c[l][f]=parse_SerAr(e,t.biff);return c}function parse_PtgName(e,r,t){var n=e.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,l=e.read_shift(i);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,l]}function parse_PtgNameX(e,r,t){if(t.biff==5)return parse_PtgNameX_BIFF5(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),l=e.read_shift(4);return[n,i,l]}function parse_PtgNameX_BIFF5(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function parse_PtgMemArea(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var i=e.read_shift(t&&t.biff==2?1:2);return[n,i]}function parse_PtgMemFunc(e,r,t){var n=e.read_shift(1)>>>5&3,i=e.read_shift(t&&t.biff==2?1:2);return[n,i]}function parse_PtgRefErr(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function parse_PtgRefErr3d(e,r,t){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),l=4;if(t)switch(t.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[n,i]}var parse_PtgMemErr=parsenoop,parse_PtgMemNoMem=parsenoop,parse_PtgTbl=parsenoop;function parse_PtgElfLoc(e,r,t){return e.l+=2,[parse_RgceElfLoc(e)]}function parse_PtgElfNoop(e){return e.l+=6,[]}var parse_PtgElfCol=parse_PtgElfLoc,parse_PtgElfColS=parse_PtgElfNoop,parse_PtgElfColSV=parse_PtgElfNoop,parse_PtgElfColV=parse_PtgElfLoc;function parse_PtgElfLel(e){return e.l+=2,[parseuint16(e),e.read_shift(2)&1]}var parse_PtgElfRadical=parse_PtgElfLoc,parse_PtgElfRadicalLel=parse_PtgElfLel,parse_PtgElfRadicalS=parse_PtgElfNoop,parse_PtgElfRw=parse_PtgElfLoc,parse_PtgElfRwV=parse_PtgElfLoc,PtgListRT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function parse_PtgList(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),l=e.read_shift(2),c=PtgListRT[t>>2&31];return{ixti:r,coltype:t&3,rt:c,idx:n,c:i,C:l}}function parse_PtgSxName(e){return e.l+=2,[e.read_shift(4)]}function parse_PtgSheet(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function parse_PtgEndSheet(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function parse_PtgMemAreaN(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function parse_PtgMemNoMemN(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function parse_PtgAttrNoop(e){return e.l+=4,[0,0]}var PtgTypes={1:{n:"PtgExp",f:parse_PtgExp},2:{n:"PtgTbl",f:parse_PtgTbl},3:{n:"PtgAdd",f:parseread1},4:{n:"PtgSub",f:parseread1},5:{n:"PtgMul",f:parseread1},6:{n:"PtgDiv",f:parseread1},7:{n:"PtgPower",f:parseread1},8:{n:"PtgConcat",f:parseread1},9:{n:"PtgLt",f:parseread1},10:{n:"PtgLe",f:parseread1},11:{n:"PtgEq",f:parseread1},12:{n:"PtgGe",f:parseread1},13:{n:"PtgGt",f:parseread1},14:{n:"PtgNe",f:parseread1},15:{n:"PtgIsect",f:parseread1},16:{n:"PtgUnion",f:parseread1},17:{n:"PtgRange",f:parseread1},18:{n:"PtgUplus",f:parseread1},19:{n:"PtgUminus",f:parseread1},20:{n:"PtgPercent",f:parseread1},21:{n:"PtgParen",f:parseread1},22:{n:"PtgMissArg",f:parseread1},23:{n:"PtgStr",f:parse_PtgStr},26:{n:"PtgSheet",f:parse_PtgSheet},27:{n:"PtgEndSheet",f:parse_PtgEndSheet},28:{n:"PtgErr",f:parse_PtgErr},29:{n:"PtgBool",f:parse_PtgBool},30:{n:"PtgInt",f:parse_PtgInt},31:{n:"PtgNum",f:parse_PtgNum},32:{n:"PtgArray",f:parse_PtgArray},33:{n:"PtgFunc",f:parse_PtgFunc},34:{n:"PtgFuncVar",f:parse_PtgFuncVar},35:{n:"PtgName",f:parse_PtgName},36:{n:"PtgRef",f:parse_PtgRef},37:{n:"PtgArea",f:parse_PtgArea},38:{n:"PtgMemArea",f:parse_PtgMemArea},39:{n:"PtgMemErr",f:parse_PtgMemErr},40:{n:"PtgMemNoMem",f:parse_PtgMemNoMem},41:{n:"PtgMemFunc",f:parse_PtgMemFunc},42:{n:"PtgRefErr",f:parse_PtgRefErr},43:{n:"PtgAreaErr",f:parse_PtgAreaErr},44:{n:"PtgRefN",f:parse_PtgRefN},45:{n:"PtgAreaN",f:parse_PtgAreaN},46:{n:"PtgMemAreaN",f:parse_PtgMemAreaN},47:{n:"PtgMemNoMemN",f:parse_PtgMemNoMemN},57:{n:"PtgNameX",f:parse_PtgNameX},58:{n:"PtgRef3d",f:parse_PtgRef3d},59:{n:"PtgArea3d",f:parse_PtgArea3d},60:{n:"PtgRefErr3d",f:parse_PtgRefErr3d},61:{n:"PtgAreaErr3d",f:parse_PtgAreaErr3d},255:{}},PtgDupes={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ptg18={1:{n:"PtgElfLel",f:parse_PtgElfLel},2:{n:"PtgElfRw",f:parse_PtgElfRw},3:{n:"PtgElfCol",f:parse_PtgElfCol},6:{n:"PtgElfRwV",f:parse_PtgElfRwV},7:{n:"PtgElfColV",f:parse_PtgElfColV},10:{n:"PtgElfRadical",f:parse_PtgElfRadical},11:{n:"PtgElfRadicalS",f:parse_PtgElfRadicalS},13:{n:"PtgElfColS",f:parse_PtgElfColS},15:{n:"PtgElfColSV",f:parse_PtgElfColSV},16:{n:"PtgElfRadicalLel",f:parse_PtgElfRadicalLel},25:{n:"PtgList",f:parse_PtgList},29:{n:"PtgSxName",f:parse_PtgSxName},255:{}},Ptg19={0:{n:"PtgAttrNoop",f:parse_PtgAttrNoop},1:{n:"PtgAttrSemi",f:parse_PtgAttrSemi},2:{n:"PtgAttrIf",f:parse_PtgAttrIf},4:{n:"PtgAttrChoose",f:parse_PtgAttrChoose},8:{n:"PtgAttrGoto",f:parse_PtgAttrGoto},16:{n:"PtgAttrSum",f:parse_PtgAttrSum},32:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},33:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},64:{n:"PtgAttrSpace",f:parse_PtgAttrSpace},65:{n:"PtgAttrSpaceSemi",f:parse_PtgAttrSpaceSemi},128:{n:"PtgAttrIfError",f:parse_PtgAttrIfError},255:{}};function parse_RgbExtra(e,r,t,n){if(n.biff<8)return parsenoop(e,r);for(var i=e.l+r,l=[],c=0;c!==t.length;++c)switch(t[c][0]){case"PtgArray":t[c][1]=parse_PtgExtraArray(e,0,n),l.push(t[c][1]);break;case"PtgMemArea":t[c][2]=parse_PtgExtraMem(e,t[c][1],n),l.push(t[c][2]);break;case"PtgExp":n&&n.biff==12&&(t[c][1][1]=e.read_shift(4),l.push(t[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[c][0]}return r=i-e.l,r!==0&&l.push(parsenoop(e,r)),l}function parse_Rgce(e,r,t){for(var n=e.l+r,i,l,c=[];n!=e.l;)r=n-e.l,l=e[e.l],i=PtgTypes[l]||PtgTypes[PtgDupes[l]],(l===24||l===25)&&(i=(l===24?Ptg18:Ptg19)[e[e.l+1]]),!i||!i.f?parsenoop(e,r):c.push([i.n,i.f(e,r,t)]);return c}function stringify_array(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],i=[],l=0;l<n.length;++l){var c=n[l];if(c)switch(c[0]){case 2:i.push('"'+c[1].replace(/"/g,'""')+'"');break;default:i.push(c[1])}else i.push("")}r.push(i.join(","))}return r.join(";")}var PtgBinOp={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function formula_quote_sheet_name(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function get_ixti_raw(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var i="";if(t.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function get_ixti(e,r,t){var n=get_ixti_raw(e,r,t);return n=="#REF"?n:formula_quote_sheet_name(n,t)}function stringify_formula(e,r,t,n,i){var l=i&&i.biff||8,c={s:{c:0,r:0},e:{c:0,r:0}},f=[],d,h,p,E=0,v=0,S,x="";if(!e[0]||!e[0][0])return"";for(var g=-1,m="",b=0,D=e[0].length;b<D;++b){var C=e[0][b];switch(C[0]){case"PtgUminus":f.push("-"+f.pop());break;case"PtgUplus":f.push("+"+f.pop());break;case"PtgPercent":f.push(f.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=f.pop(),h=f.pop(),g>=0){switch(e[0][g][1][0]){case 0:m=fill(" ",e[0][g][1][1]);break;case 1:m=fill("\r",e[0][g][1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}h=h+m,g=-1}f.push(h+PtgBinOp[C[0]]+d);break;case"PtgIsect":d=f.pop(),h=f.pop(),f.push(h+" "+d);break;case"PtgUnion":d=f.pop(),h=f.pop(),f.push(h+","+d);break;case"PtgRange":d=f.pop(),h=f.pop(),f.push(h+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=shift_cell_xls(C[1][1],c,i),f.push(encode_cell_xls(p,l));break;case"PtgRefN":p=t?shift_cell_xls(C[1][1],t,i):C[1][1],f.push(encode_cell_xls(p,l));break;case"PtgRef3d":E=C[1][1],p=shift_cell_xls(C[1][2],c,i),x=get_ixti(n,E,i),f.push(x+"!"+encode_cell_xls(p,l));break;case"PtgFunc":case"PtgFuncVar":var F=C[1][0],T=C[1][1];F||(F=0),F&=127;var w=F==0?[]:f.slice(-F);f.length-=F,T==="User"&&(T=w.shift()),f.push(T+"("+w.join(",")+")");break;case"PtgBool":f.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":f.push(C[1]);break;case"PtgNum":f.push(String(C[1]));break;case"PtgStr":f.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":f.push(C[1]);break;case"PtgAreaN":S=shift_range_xls(C[1][1],t?{s:t}:c,i),f.push(encode_range_xls(S,i));break;case"PtgArea":S=shift_range_xls(C[1][1],c,i),f.push(encode_range_xls(S,i));break;case"PtgArea3d":E=C[1][1],S=C[1][2],x=get_ixti(n,E,i),f.push(x+"!"+encode_range_xls(S,i));break;case"PtgAttrSum":f.push("SUM("+f.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=C[1][2];var y=(n.names||[])[v-1]||(n[0]||[])[v],N=y?y.Name:"SH33TJSNAME"+String(v);N&&N.slice(0,6)=="_xlfn."&&!i.xlfn&&(N=N.slice(6)),f.push(N);break;case"PtgNameX":var L=C[1][1];v=C[1][2];var X;if(i.biff<=5)L<0&&(L=-L),n[L]&&(X=n[L][v]);else{var z="";if(((n[L]||[])[0]||[])[0]==14849||(((n[L]||[])[0]||[])[0]==1025?n[L][v]&&n[L][v].itab>0&&(z=n.SheetNames[n[L][v].itab-1]+"!"):z=n.SheetNames[v-1]+"!"),n[L]&&n[L][v])z+=n[L][v].Name;else if(n[0]&&n[0][v])z+=n[0][v].Name;else{var se=(get_ixti_raw(n,L,i)||"").split(";;");se[v-1]?z=se[v-1]:z+="SH33TJSERRX"}f.push(z);break}X||(X={Name:"SH33TJSERRY"}),f.push(X.Name);break;case"PtgParen":var me="(",_e=")";if(g>=0){switch(m="",e[0][g][1][0]){case 2:me=fill(" ",e[0][g][1][1])+me;break;case 3:me=fill("\r",e[0][g][1][1])+me;break;case 4:_e=fill(" ",e[0][g][1][1])+_e;break;case 5:_e=fill("\r",e[0][g][1][1])+_e;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}f.push(me+f.pop()+_e);break;case"PtgRefErr":f.push("#REF!");break;case"PtgRefErr3d":f.push("#REF!");break;case"PtgExp":p={c:C[1][1],r:C[1][0]};var de={c:t.c,r:t.r};if(n.sharedf[encode_cell(p)]){var Y=n.sharedf[encode_cell(p)];f.push(stringify_formula(Y,c,de,n,i))}else{var ie=!1;for(d=0;d!=n.arrayf.length;++d)if(h=n.arrayf[d],!(p.c<h[0].s.c||p.c>h[0].e.c)&&!(p.r<h[0].s.r||p.r>h[0].e.r)){f.push(stringify_formula(h[1],c,de,n,i)),ie=!0;break}ie||f.push(C[1])}break;case"PtgArray":f.push("{"+stringify_array(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":f.push("");break;case"PtgAreaErr":f.push("#REF!");break;case"PtgAreaErr3d":f.push("#REF!");break;case"PtgList":f.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var fe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&fe.indexOf(e[0][b][0])==-1){C=e[0][g];var ae=!0;switch(C[1][0]){case 4:ae=!1;case 0:m=fill(" ",C[1][1]);break;case 5:ae=!1;case 1:m=fill("\r",C[1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}f.push((ae?m:"")+f.pop()+(ae?"":m)),g=-1}}if(f.length>1&&i.WTF)throw new Error("bad formula stack");return f[0]}function parse_ArrayParsedFormula(e,r,t){var n=e.l+r,i=t.biff==2?1:2,l,c=e.read_shift(i);if(c==65535)return[[],parsenoop(e,r-2)];var f=parse_Rgce(e,c,t);return r!==c+i&&(l=parse_RgbExtra(e,r-c-i,f,t)),e.l=n,[f,l]}function parse_XLSCellParsedFormula(e,r,t){var n=e.l+r,i=t.biff==2?1:2,l,c=e.read_shift(i);if(c==65535)return[[],parsenoop(e,r-2)];var f=parse_Rgce(e,c,t);return r!==c+i&&(l=parse_RgbExtra(e,r-c-i,f,t)),e.l=n,[f,l]}function parse_NameParsedFormula(e,r,t,n){var i=e.l+r,l=parse_Rgce(e,n,t),c;return i!==e.l&&(c=parse_RgbExtra(e,i-e.l,l,t)),[l,c]}function parse_SharedParsedFormula(e,r,t){var n=e.l+r,i,l=e.read_shift(2),c=parse_Rgce(e,l,t);return l==65535?[[],parsenoop(e,r-2)]:(r!==l+2&&(i=parse_RgbExtra(e,n-l-2,c,t)),[c,i])}function parse_FormulaValue(e){var r;if(__readUInt16LE(e,e.l+6)!==65535)return[parse_Xnum(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function parse_Formula(e,r,t){var n=e.l+r,i=parse_XLSCell(e);t.biff==2&&++e.l;var l=parse_FormulaValue(e),c=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var f=parse_XLSCellParsedFormula(e,n-e.l,t);return{cell:i,val:l[0],formula:f,shared:c>>3&1,tt:l[1]}}function parse_XLSBParsedFormula(e,r,t){var n=e.read_shift(4),i=parse_Rgce(e,n,t),l=e.read_shift(4),c=l>0?parse_RgbExtra(e,l,i,t):null;return[i,c]}var parse_XLSBArrayParsedFormula=parse_XLSBParsedFormula,parse_XLSBCellParsedFormula=parse_XLSBParsedFormula,parse_XLSBNameParsedFormula=parse_XLSBParsedFormula,parse_XLSBSharedParsedFormula=parse_XLSBParsedFormula,Cetab={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ftab={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FtabArgc={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ods_to_csf_formula(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function ods_to_csf_3D(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var strs={},_ssfopts={};function default_margins(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function safe_format(e,r,t,n,i,l){try{n.cellNF&&(e.z=table_fmt[r])}catch(f){if(n.WTF)throw f}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=parseDate(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(table_fmt[r]==null&&SSF_load(SSFImplicit[r]||"General",r),e.t==="e")e.w=e.w||BErr[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v);else if(e.t==="d"){var c=datenum(e.v);(c|0)===c?e.w=c.toString(10):e.w=SSF_general_num(c)}else{if(e.v===void 0)return"";e.w=SSF_general(e.v,_ssfopts)}else e.t==="d"?e.w=SSF_format(r,datenum(e.v),_ssfopts):e.w=SSF_format(r,e.v,_ssfopts)}catch(f){if(n.WTF)throw f}if(n.cellStyles&&t!=null)try{e.s=l.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=rgb_tint(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=rgb_tint(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(f){if(n.WTF&&l.Fills)throw f}}}function parse_ws_xml_dim(e,r){var t=safe_decode_range(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=encode_range(t))}var mergecregex=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sheetdataregex=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hlinkregex=/<(?:\w:)?hyperlink [^>]*>/mg,dimregex=/"(\w*:\w*)"/,colregex=/<(?:\w:)?col\b[^>]*[\/]?>/g,afregex=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,marginregex=/<(?:\w:)?pageMargins[^>]*\/>/g,sheetprregex=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,sheetprregex2=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,svsregex=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function parse_ws_xml(e,r,t,n,i,l,c){if(!e)return e;n||(n={"!id":{}});var f=r.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",p="",E=e.match(sheetdataregex);E?(h=e.slice(0,E.index),p=e.slice(E.index+E[0].length)):h=p=e;var v=h.match(sheetprregex);v?parse_ws_xml_sheetpr(v[0],f,i,t):(v=h.match(sheetprregex2))&&parse_ws_xml_sheetpr2(v[0],v[1]||"",f,i,t);var S=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(S>0){var x=h.slice(S,S+50).match(dimregex);x&&parse_ws_xml_dim(f,x[1])}var g=h.match(svsregex);g&&g[1]&&parse_ws_xml_sheetviews(g[1],i);var m=[];if(r.cellStyles){var b=h.match(colregex);b&&parse_ws_xml_cols(m,b)}E&&parse_ws_xml_data(E[1],f,r,d,l,c);var D=p.match(afregex);D&&(f["!autofilter"]=parse_ws_xml_autofilter(D[0]));var C=[],F=p.match(mergecregex);if(F)for(S=0;S!=F.length;++S)C[S]=safe_decode_range(F[S].slice(F[S].indexOf('"')+1));var T=p.match(hlinkregex);T&&parse_ws_xml_hlinks(f,T,n);var w=p.match(marginregex);if(w&&(f["!margins"]=parse_ws_xml_margins(parsexmltag(w[0]))),!f["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(f["!ref"]=encode_range(d)),r.sheetRows>0&&f["!ref"]){var y=safe_decode_range(f["!ref"]);r.sheetRows<=+y.e.r&&(y.e.r=r.sheetRows-1,y.e.r>d.e.r&&(y.e.r=d.e.r),y.e.r<y.s.r&&(y.s.r=y.e.r),y.e.c>d.e.c&&(y.e.c=d.e.c),y.e.c<y.s.c&&(y.s.c=y.e.c),f["!fullref"]=f["!ref"],f["!ref"]=encode_range(y))}return m.length>0&&(f["!cols"]=m),C.length>0&&(f["!merges"]=C),f}function parse_ws_xml_sheetpr(e,r,t,n){var i=parsexmltag(e);t.Sheets[n]||(t.Sheets[n]={}),i.codeName&&(t.Sheets[n].CodeName=unescapexml(utf8read(i.codeName)))}function parse_ws_xml_sheetpr2(e,r,t,n,i){parse_ws_xml_sheetpr(e.slice(0,e.indexOf(">")),t,n,i)}function parse_ws_xml_hlinks(e,r,t){for(var n=Array.isArray(e),i=0;i!=r.length;++i){var l=parsexmltag(utf8read(r[i]),!0);if(!l.ref)return;var c=((t||{})["!id"]||[])[l.id];c?(l.Target=c.Target,l.location&&(l.Target+="#"+unescapexml(l.location))):(l.Target="#"+unescapexml(l.location),c={Target:l.Target,TargetMode:"Internal"}),l.Rel=c,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var f=safe_decode_range(l.ref),d=f.s.r;d<=f.e.r;++d)for(var h=f.s.c;h<=f.e.c;++h){var p=encode_cell({c:h,r:d});n?(e[d]||(e[d]=[]),e[d][h]||(e[d][h]={t:"z",v:void 0}),e[d][h].l=l):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=l)}}}function parse_ws_xml_margins(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function parse_ws_xml_cols(e,r){for(var t=!1,n=0;n!=r.length;++n){var i=parsexmltag(r[n],!0);i.hidden&&(i.hidden=parsexmlbool(i.hidden));var l=parseInt(i.min,10)-1,c=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!t&&i.width&&(t=!0,find_mdw_colw(i.width)),process_col(i);l<=c;)e[l++]=dup(i)}}function parse_ws_xml_autofilter(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var sviewregex=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function parse_ws_xml_sheetviews(e,r){r.Views||(r.Views=[{}]),(e.match(sviewregex)||[]).forEach(function(t,n){var i=parsexmltag(t);r.Views[n]||(r.Views[n]={}),+i.zoomScale&&(r.Views[n].zoom=+i.zoomScale),parsexmlbool(i.rightToLeft)&&(r.Views[n].RTL=!0)})}var parse_ws_xml_data=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,l=matchtag("v"),c=matchtag("f");return function(d,h,p,E,v,S){for(var x=0,g="",m=[],b=[],D=0,C=0,F=0,T="",w,y,N=0,L=0,X,z,se=0,me=0,_e=Array.isArray(S.CellXf),de,Y=[],ie=[],fe=Array.isArray(h),ae=[],W={},xe=!1,I=!!p.sheetStubs,M=d.split(r),R=0,U=M.length;R!=U;++R){g=M[R].trim();var V=g.length;if(V!==0){var Z=0;e:for(x=0;x<V;++x)switch(g[x]){case">":if(g[x-1]!="/"){++x;break e}if(p&&p.cellStyles){if(y=parsexmltag(g.slice(Z,x),!0),N=y.r!=null?parseInt(y.r,10):N+1,L=-1,p.sheetRows&&p.sheetRows<N)continue;W={},xe=!1,y.ht&&(xe=!0,W.hpt=parseFloat(y.ht),W.hpx=pt2px(W.hpt)),y.hidden=="1"&&(xe=!0,W.hidden=!0),y.outlineLevel!=null&&(xe=!0,W.level=+y.outlineLevel),xe&&(ae[N-1]=W)}break;case"<":Z=x;break}if(Z>=x)break;if(y=parsexmltag(g.slice(Z,x),!0),N=y.r!=null?parseInt(y.r,10):N+1,L=-1,!(p.sheetRows&&p.sheetRows<N)){E.s.r>N-1&&(E.s.r=N-1),E.e.r<N-1&&(E.e.r=N-1),p&&p.cellStyles&&(W={},xe=!1,y.ht&&(xe=!0,W.hpt=parseFloat(y.ht),W.hpx=pt2px(W.hpt)),y.hidden=="1"&&(xe=!0,W.hidden=!0),y.outlineLevel!=null&&(xe=!0,W.level=+y.outlineLevel),xe&&(ae[N-1]=W)),m=g.slice(x).split(e);for(var J=0;J!=m.length&&m[J].trim().charAt(0)=="<";++J);for(m=m.slice(J),x=0;x!=m.length;++x)if(g=m[x].trim(),g.length!==0){if(b=g.match(t),D=x,C=0,F=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,b!=null&&b.length===2){for(D=0,T=b[1],C=0;C!=T.length&&!((F=T.charCodeAt(C)-64)<1||F>26);++C)D=26*D+F;--D,L=D}else++L;for(C=0;C!=g.length&&g.charCodeAt(C)!==62;++C);if(++C,y=parsexmltag(g.slice(0,C),!0),y.r||(y.r=encode_cell({r:N-1,c:L})),T=g.slice(C),w={t:""},(b=T.match(l))!=null&&b[1]!==""&&(w.v=unescapexml(b[1])),p.cellFormula){if((b=T.match(c))!=null&&b[1]!==""){if(w.f=unescapexml(utf8read(b[1])).replace(/\r\n/g,`
`),p.xlfn||(w.f=_xlfn(w.f)),b[0].indexOf('t="array"')>-1)w.F=(T.match(i)||[])[1],w.F.indexOf(":")>-1&&Y.push([safe_decode_range(w.F),w.F]);else if(b[0].indexOf('t="shared"')>-1){z=parsexmltag(b[0]);var O=unescapexml(utf8read(b[1]));p.xlfn||(O=_xlfn(O)),ie[parseInt(z.si,10)]=[z,O,y.r]}}else(b=T.match(/<f[^>]*\/>/))&&(z=parsexmltag(b[0]),ie[z.si]&&(w.f=shift_formula_xlsx(ie[z.si][1],ie[z.si][2],y.r)));var B=decode_cell(y.r);for(C=0;C<Y.length;++C)B.r>=Y[C][0].s.r&&B.r<=Y[C][0].e.r&&B.c>=Y[C][0].s.c&&B.c<=Y[C][0].e.c&&(w.F=Y[C][1])}if(y.t==null&&w.v===void 0)if(w.f||w.F)w.v=0,w.t="n";else if(I)w.t="z";else continue;else w.t=y.t||"n";switch(E.s.c>L&&(E.s.c=L),E.e.c<L&&(E.e.c=L),w.t){case"n":if(w.v==""||w.v==null){if(!I)continue;w.t="z"}else w.v=parseFloat(w.v);break;case"s":if(typeof w.v>"u"){if(!I)continue;w.t="z"}else X=strs[parseInt(w.v,10)],w.v=X.t,w.r=X.r,p.cellHTML&&(w.h=X.h);break;case"str":w.t="s",w.v=w.v!=null?utf8read(w.v):"",p.cellHTML&&(w.h=escapehtml(w.v));break;case"inlineStr":b=T.match(n),w.t="s",b!=null&&(X=parse_si(b[1]))?(w.v=X.t,p.cellHTML&&(w.h=X.h)):w.v="";break;case"b":w.v=parsexmlbool(w.v);break;case"d":p.cellDates?w.v=parseDate(w.v,1):(w.v=datenum(parseDate(w.v,1)),w.t="n");break;case"e":(!p||p.cellText!==!1)&&(w.w=w.v),w.v=RBErr[w.v];break}if(se=me=0,de=null,_e&&y.s!==void 0&&(de=S.CellXf[y.s],de!=null&&(de.numFmtId!=null&&(se=de.numFmtId),p.cellStyles&&de.fillId!=null&&(me=de.fillId))),safe_format(w,se,me,p,v,S),p.cellDates&&_e&&w.t=="n"&&fmt_is_date(table_fmt[se])&&(w.t="d",w.v=numdate(w.v)),y.cm&&p.xlmeta){var G=(p.xlmeta.Cell||[])[+y.cm-1];G&&G.type=="XLDAPR"&&(w.D=!0)}if(fe){var P=decode_cell(y.r);h[P.r]||(h[P.r]=[]),h[P.r][P.c]=w}else h[y.r]=w}}}}ae.length>0&&(h["!rows"]=ae)}}();function parse_BrtRowHdr(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=n,l&7&&(t.level=l&7),l&16&&(t.hidden=!0),l&32&&(t.hpt=i/20),t}var parse_BrtWsDim=parse_UncheckedRfX;function parse_BrtWsFmtInfo(){}function parse_BrtWsProp(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=parse_XLSBCodeName(e),t}function parse_BrtCellBlank(e){var r=parse_XLSBCell(e);return[r]}function parse_BrtShortBlank(e){var r=parse_XLSBShortCell(e);return[r]}function parse_BrtCellBool(e){var r=parse_XLSBCell(e),t=e.read_shift(1);return[r,t,"b"]}function parse_BrtShortBool(e){var r=parse_XLSBShortCell(e),t=e.read_shift(1);return[r,t,"b"]}function parse_BrtCellError(e){var r=parse_XLSBCell(e),t=e.read_shift(1);return[r,t,"e"]}function parse_BrtShortError(e){var r=parse_XLSBShortCell(e),t=e.read_shift(1);return[r,t,"e"]}function parse_BrtCellIsst(e){var r=parse_XLSBCell(e),t=e.read_shift(4);return[r,t,"s"]}function parse_BrtShortIsst(e){var r=parse_XLSBShortCell(e),t=e.read_shift(4);return[r,t,"s"]}function parse_BrtCellReal(e){var r=parse_XLSBCell(e),t=parse_Xnum(e);return[r,t,"n"]}function parse_BrtShortReal(e){var r=parse_XLSBShortCell(e),t=parse_Xnum(e);return[r,t,"n"]}function parse_BrtCellRk(e){var r=parse_XLSBCell(e),t=parse_RkNumber(e);return[r,t,"n"]}function parse_BrtShortRk(e){var r=parse_XLSBShortCell(e),t=parse_RkNumber(e);return[r,t,"n"]}function parse_BrtCellRString(e){var r=parse_XLSBCell(e),t=parse_RichStr(e);return[r,t,"is"]}function parse_BrtCellSt(e){var r=parse_XLSBCell(e),t=parse_XLWideString(e);return[r,t,"str"]}function parse_BrtShortSt(e){var r=parse_XLSBShortCell(e),t=parse_XLWideString(e);return[r,t,"str"]}function parse_BrtFmlaBool(e,r,t){var n=e.l+r,i=parse_XLSBCell(e);i.r=t["!row"];var l=e.read_shift(1),c=[i,l,"b"];if(t.cellFormula){e.l+=2;var f=parse_XLSBCellParsedFormula(e,n-e.l,t);c[3]=stringify_formula(f,null,i,t.supbooks,t)}else e.l=n;return c}function parse_BrtFmlaError(e,r,t){var n=e.l+r,i=parse_XLSBCell(e);i.r=t["!row"];var l=e.read_shift(1),c=[i,l,"e"];if(t.cellFormula){e.l+=2;var f=parse_XLSBCellParsedFormula(e,n-e.l,t);c[3]=stringify_formula(f,null,i,t.supbooks,t)}else e.l=n;return c}function parse_BrtFmlaNum(e,r,t){var n=e.l+r,i=parse_XLSBCell(e);i.r=t["!row"];var l=parse_Xnum(e),c=[i,l,"n"];if(t.cellFormula){e.l+=2;var f=parse_XLSBCellParsedFormula(e,n-e.l,t);c[3]=stringify_formula(f,null,i,t.supbooks,t)}else e.l=n;return c}function parse_BrtFmlaString(e,r,t){var n=e.l+r,i=parse_XLSBCell(e);i.r=t["!row"];var l=parse_XLWideString(e),c=[i,l,"str"];if(t.cellFormula){e.l+=2;var f=parse_XLSBCellParsedFormula(e,n-e.l,t);c[3]=stringify_formula(f,null,i,t.supbooks,t)}else e.l=n;return c}var parse_BrtMergeCell=parse_UncheckedRfX;function parse_BrtHLink(e,r){var t=e.l+r,n=parse_UncheckedRfX(e),i=parse_XLNullableWideString(e),l=parse_XLWideString(e),c=parse_XLWideString(e),f=parse_XLWideString(e);e.l=t;var d={rfx:n,relId:i,loc:l,display:f};return c&&(d.Tooltip=c),d}function parse_BrtPane(){}function parse_BrtArrFmla(e,r,t){var n=e.l+r,i=parse_RfX(e),l=e.read_shift(1),c=[i];if(c[2]=l,t.cellFormula){var f=parse_XLSBArrayParsedFormula(e,n-e.l,t);c[1]=f}else e.l=n;return c}function parse_BrtShrFmla(e,r,t){var n=e.l+r,i=parse_UncheckedRfX(e),l=[i];if(t.cellFormula){var c=parse_XLSBSharedParsedFormula(e,n-e.l,t);l[1]=c,e.l=n}else e.l=n;return l}var BrtMarginKeys=["left","right","top","bottom","header","footer"];function parse_BrtMargins(e){var r={};return BrtMarginKeys.forEach(function(t){r[t]=parse_Xnum(e)}),r}function parse_BrtBeginWsView(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function parse_BrtDVal(){}function parse_BrtDVal14(){}function parse_ws_bin(e,r,t,n,i,l,c){if(!e)return e;var f=r||{};n||(n={"!id":{}});var d=f.dense?[]:{},h,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},E=!1,v=!1,S,x,g,m,b,D,C,F,T,w=[];f.biff=12,f["!row"]=0;var y=0,N=!1,L=[],X={},z=f.supbooks||i.supbooks||[[]];if(z.sharedf=X,z.arrayf=L,z.SheetNames=i.SheetNames||i.Sheets.map(function(fe){return fe.name}),!f.supbooks&&(f.supbooks=z,i.Names))for(var se=0;se<i.Names.length;++se)z[0][se+1]=i.Names[se];var me=[],_e=[],de=!1;XLSBRecordEnum[16]={n:"BrtShortReal",f:parse_BrtShortReal};var Y;if(recordhopper(e,function(ae,W,xe){if(!v)switch(xe){case 148:h=ae;break;case 0:S=ae,f.sheetRows&&f.sheetRows<=S.r&&(v=!0),F=encode_row(m=S.r),f["!row"]=S.r,(ae.hidden||ae.hpt||ae.level!=null)&&(ae.hpt&&(ae.hpx=pt2px(ae.hpt)),_e[ae.r]=ae);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:ae[2]},ae[2]){case"n":x.v=ae[1];break;case"s":C=strs[ae[1]],x.v=C.t,x.r=C.r;break;case"b":x.v=!!ae[1];break;case"e":x.v=ae[1],f.cellText!==!1&&(x.w=BErr[x.v]);break;case"str":x.t="s",x.v=ae[1];break;case"is":x.t="s",x.v=ae[1].t;break}if((g=c.CellXf[ae[0].iStyleRef])&&safe_format(x,g.numFmtId,null,f,l,c),b=ae[0].c==-1?b+1:ae[0].c,f.dense?(d[m]||(d[m]=[]),d[m][b]=x):d[encode_col(b)+F]=x,f.cellFormula){for(N=!1,y=0;y<L.length;++y){var I=L[y];S.r>=I[0].s.r&&S.r<=I[0].e.r&&b>=I[0].s.c&&b<=I[0].e.c&&(x.F=encode_range(I[0]),N=!0)}!N&&ae.length>3&&(x.f=ae[3])}if(p.s.r>S.r&&(p.s.r=S.r),p.s.c>b&&(p.s.c=b),p.e.r<S.r&&(p.e.r=S.r),p.e.c<b&&(p.e.c=b),f.cellDates&&g&&x.t=="n"&&fmt_is_date(table_fmt[g.numFmtId])){var M=SSF_parse_date_code(x.v);M&&(x.t="d",x.v=new Date(M.y,M.m-1,M.d,M.H,M.M,M.S,M.u))}Y&&(Y.type=="XLDAPR"&&(x.D=!0),Y=void 0);break;case 1:case 12:if(!f.sheetStubs||E)break;x={t:"z",v:void 0},b=ae[0].c==-1?b+1:ae[0].c,f.dense?(d[m]||(d[m]=[]),d[m][b]=x):d[encode_col(b)+F]=x,p.s.r>S.r&&(p.s.r=S.r),p.s.c>b&&(p.s.c=b),p.e.r<S.r&&(p.e.r=S.r),p.e.c<b&&(p.e.c=b),Y&&(Y.type=="XLDAPR"&&(x.D=!0),Y=void 0);break;case 176:w.push(ae);break;case 49:Y=((f.xlmeta||{}).Cell||[])[ae-1];break;case 494:var R=n["!id"][ae.relId];for(R?(ae.Target=R.Target,ae.loc&&(ae.Target+="#"+ae.loc),ae.Rel=R):ae.relId==""&&(ae.Target="#"+ae.loc),m=ae.rfx.s.r;m<=ae.rfx.e.r;++m)for(b=ae.rfx.s.c;b<=ae.rfx.e.c;++b)f.dense?(d[m]||(d[m]=[]),d[m][b]||(d[m][b]={t:"z",v:void 0}),d[m][b].l=ae):(D=encode_cell({c:b,r:m}),d[D]||(d[D]={t:"z",v:void 0}),d[D].l=ae);break;case 426:if(!f.cellFormula)break;L.push(ae),T=f.dense?d[m][b]:d[encode_col(b)+F],T.f=stringify_formula(ae[1],p,{r:S.r,c:b},z,f),T.F=encode_range(ae[0]);break;case 427:if(!f.cellFormula)break;X[encode_cell(ae[0].s)]=ae[1],T=f.dense?d[m][b]:d[encode_col(b)+F],T.f=stringify_formula(ae[1],p,{r:S.r,c:b},z,f);break;case 60:if(!f.cellStyles)break;for(;ae.e>=ae.s;)me[ae.e--]={width:ae.w/256,hidden:!!(ae.flags&1),level:ae.level},de||(de=!0,find_mdw_colw(ae.w/256)),process_col(me[ae.e+1]);break;case 161:d["!autofilter"]={ref:encode_range(ae)};break;case 476:d["!margins"]=ae;break;case 147:i.Sheets[t]||(i.Sheets[t]={}),ae.name&&(i.Sheets[t].CodeName=ae.name),(ae.above||ae.left)&&(d["!outline"]={above:ae.above,left:ae.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),ae.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:E=!0;break;case 36:E=!1;break;case 37:E=!0;break;case 38:E=!1;break;default:if(!W.T){if(!E||f.WTF)throw new Error("Unexpected record 0x"+xe.toString(16))}}},f),delete f.supbooks,delete f["!row"],!d["!ref"]&&(p.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(d["!ref"]=encode_range(h||p)),f.sheetRows&&d["!ref"]){var ie=safe_decode_range(d["!ref"]);f.sheetRows<=+ie.e.r&&(ie.e.r=f.sheetRows-1,ie.e.r>p.e.r&&(ie.e.r=p.e.r),ie.e.r<ie.s.r&&(ie.s.r=ie.e.r),ie.e.c>p.e.c&&(ie.e.c=p.e.c),ie.e.c<ie.s.c&&(ie.s.c=ie.e.c),d["!fullref"]=d["!ref"],d["!ref"]=encode_range(ie))}return w.length>0&&(d["!merges"]=w),me.length>0&&(d["!cols"]=me),_e.length>0&&(d["!rows"]=_e),d}function parse_Cache(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var c=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(r[+c[1]]=t?+c[2]:c[2])});var i=unescapexml((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){n=l.replace(/<.*?>/g,"")}),[r,i,n]}function parse_chart(e,r,t,n,i,l){var c=l||{"!type":"chart"};if(!e)return l;var f=0,d=0,h="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(E){var v=parse_Cache(E);p.s.r=p.s.c=0,p.e.c=f,h=encode_col(f),v[0].forEach(function(S,x){c[h+encode_row(x)]={t:"n",v:S,z:v[1]},d=x}),p.e.r<d&&(p.e.r=d),++f}),f>0&&(c["!ref"]=encode_range(p)),c}function parse_cs_xml(e,r,t,n,i){if(!e)return e;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c,f=e.match(sheetprregex);return f&&parse_ws_xml_sheetpr(f[0],l,i,t),(c=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=c[1]),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}function parse_BrtCsProp(e,r){e.l+=10;var t=parse_XLWideString(e);return{name:t}}function parse_cs_bin(e,r,t,n,i){if(!e)return e;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c=!1;return recordhopper(e,function(d,h,p){switch(p){case 550:l["!rel"]=d;break;case 651:i.Sheets[t]||(i.Sheets[t]={}),d.name&&(i.Sheets[t].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!c||r.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},r),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}var WBPropsDef=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],WBViewDef=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],SheetDef=[],CalcPrDef=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function push_defaults_array(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],i=0;i!=r.length;++i){var l=r[i];if(n[l[0]]==null)n[l[0]]=l[1];else switch(l[2]){case"bool":typeof n[l[0]]=="string"&&(n[l[0]]=parsexmlbool(n[l[0]]));break;case"int":typeof n[l[0]]=="string"&&(n[l[0]]=parseInt(n[l[0]],10));break}}}function push_defaults(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=parsexmlbool(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function parse_wb_defaults(e){push_defaults(e.WBProps,WBPropsDef),push_defaults(e.CalcPr,CalcPrDef),push_defaults_array(e.WBView,WBViewDef),push_defaults_array(e.Sheets,SheetDef),_ssfopts.date1904=parsexmlbool(e.WBProps.date1904)}var badchars="][*?/\\".split("");function check_ws_name(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return badchars.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var wbnsregex=/<\w+:workbook/;function parse_wb_xml(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",l={},c=0;if(e.replace(tagregex,function(d,h){var p=parsexmltag(d);switch(strip_ns(p[0])){case"<?xml":break;case"<workbook":d.match(wbnsregex)&&(i="xmlns"+d.match(/<(\w+):/)[1]),t.xmlns=p[i];break;case"</workbook>":break;case"<fileVersion":delete p[0],t.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":WBPropsDef.forEach(function(E){if(p[E[0]]!=null)switch(E[2]){case"bool":t.WBProps[E[0]]=parsexmlbool(p[E[0]]);break;case"int":t.WBProps[E[0]]=parseInt(p[E[0]],10);break;default:t.WBProps[E[0]]=p[E[0]]}}),p.codeName&&(t.WBProps.CodeName=utf8read(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],t.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=unescapexml(utf8read(p.name)),delete p[0],t.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":l={},l.Name=utf8read(p.name),p.comment&&(l.Comment=p.comment),p.localSheetId&&(l.Sheet=+p.localSheetId),parsexmlbool(p.hidden||"0")&&(l.Hidden=!0),c=h+d.length;break;case"</definedName>":l.Ref=unescapexml(utf8read(e.slice(c,h))),t.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete p[0],t.CalcPr=p;break;case"<calcPr/>":delete p[0],t.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return d}),XMLNS_main.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return parse_wb_defaults(t),t}function parse_BrtBundleSh(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=parse_RelID(e),t.name=parse_XLWideString(e),t}function parse_BrtWbProp(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var i=r>8?parse_XLWideString(e):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function parse_BrtFRTArchID$(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function parse_BrtName(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var i=e.read_shift(4),l=parse_XLNameWideString(e),c=parse_XLSBNameParsedFormula(e,0,t),f=parse_XLNullableWideString(e);e.l=n;var d={Name:l,Ptg:c};return i<268435455&&(d.Sheet=i),f&&(d.Comment=f),d}function parse_wb_bin(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;r||(r={}),r.biff=12;var l=[],c=[[]];return c.SheetNames=[],c.XTI=[],XLSBRecordEnum[16]={n:"BrtFRTArchID$",f:parse_BrtFRTArchID$},recordhopper(e,function(d,h,p){switch(p){case 156:c.SheetNames.push(d.name),t.Sheets.push(d);break;case 153:t.WBProps=d;break;case 39:d.Sheet!=null&&(r.SID=d.Sheet),d.Ref=stringify_formula(d.Ptg,null,null,c,r),delete r.SID,delete d.Ptg,l.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([p,d]):c[0]=[p,d],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(d),c.XTI=c.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(p),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(p),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!h.T){if(!i||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},r),parse_wb_defaults(t),t.Names=l,t.supbooks=c,t}function parse_wb(e,r,t){return r.slice(-4)===".bin"?parse_wb_bin(e,t):parse_wb_xml(e,t)}function parse_ws(e,r,t,n,i,l,c,f){return r.slice(-4)===".bin"?parse_ws_bin(e,n,t,i,l,c,f):parse_ws_xml(e,n,t,i,l,c,f)}function parse_cs(e,r,t,n,i,l,c,f){return r.slice(-4)===".bin"?parse_cs_bin(e,n,t,i,l):parse_cs_xml(e,n,t,i,l)}function parse_ms(e,r,t,n,i,l,c,f){return r.slice(-4)===".bin"?parse_ms_bin():parse_ms_xml()}function parse_ds(e,r,t,n,i,l,c,f){return r.slice(-4)===".bin"?parse_ds_bin():parse_ds_xml()}function parse_sty(e,r,t,n){return r.slice(-4)===".bin"?parse_sty_bin(e,t,n):parse_sty_xml(e,t,n)}function parse_theme(e,r,t){return parse_theme_xml(e,t)}function parse_sst(e,r,t){return r.slice(-4)===".bin"?parse_sst_bin(e,t):parse_sst_xml(e,t)}function parse_cmnt(e,r,t){return r.slice(-4)===".bin"?parse_comments_bin(e,t):parse_comments_xml(e,t)}function parse_cc(e,r,t){return r.slice(-4)===".bin"?parse_cc_bin(e):parse_cc_xml(e)}function parse_xlink(e,r,t,n){return t.slice(-4)===".bin"?parse_xlink_bin(e,r,t,n):void 0}function parse_xlmeta(e,r,t){return r.slice(-4)===".bin"?parse_xlmeta_bin(e,r,t):parse_xlmeta_xml(e,r,t)}var attregexg2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,attregex2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function xlml_parsexmltag(e,r){var t=e.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var i=e.match(attregexg2),l,c,f,d;if(i)for(d=0;d!=i.length;++d)l=i[d].match(attregex2),(c=l[1].indexOf(":"))===-1?n[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?f="xmlns"+l[1].slice(6):f=l[1].slice(c+1),n[f]=l[2].slice(1,l[2].length-1));return n}function xlml_parsexmltagobj(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(attregexg2),i,l,c,f;if(n)for(f=0;f!=n.length;++f)i=n[f].match(attregex2),(l=i[1].indexOf(":"))===-1?t[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(l+1),t[c]=i[2].slice(1,i[2].length-1));return t}var XLMLFormatMap;function xlml_format(e,r){var t=XLMLFormatMap[e]||unescapexml(e);return t==="General"?SSF_general(r):SSF_format(t,r)}function xlml_set_custprop(e,r,t,n){var i=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=parsexmlbool(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=parseDate(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[unescapexml(r)]=i}function safe_format_xlml(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||BErr[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v):e.w=SSF_general(e.v):e.w=xlml_format(r||"General",e.v)}catch(l){if(t.WTF)throw l}try{var n=XLMLFormatMap[r]||r||"General";if(t.cellNF&&(e.z=n),t.cellDates&&e.t=="n"&&fmt_is_date(n)){var i=SSF_parse_date_code(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(l){if(t.WTF)throw l}}}function process_style_xlml(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=XLMLPatternTypeMap[n.Pattern]||n.Pattern)}e[r.ID]=r}function parse_xlml_data(e,r,t,n,i,l,c,f,d,h){var p="General",E=n.StyleID,v={};h=h||{};var S=[],x=0;for(E===void 0&&f&&(E=f.StyleID),E===void 0&&c&&(E=c.StyleID);l[E]!==void 0&&(l[E].nf&&(p=l[E].nf),l[E].Interior&&S.push(l[E].Interior),!!l[E].Parent);)E=l[E].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=parsexmlbool(e);break;case"String":n.t="s",n.r=xlml_fixstr(unescapexml(e)),n.v=e.indexOf("<")>-1?unescapexml(r||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(parseDate(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=unescapexml(e):n.v<60&&(n.v=n.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=RBErr[e],h.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=xlml_fixstr(r||e));break}if(safe_format_xlml(n,p,h),h.cellFormula!==!1)if(n.Formula){var g=unescapexml(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=rc_to_a1(g,i),delete n.Formula,n.ArrayRange=="RC"?n.F=rc_to_a1("RC:RC",i):n.ArrayRange&&(n.F=rc_to_a1(n.ArrayRange,i),d.push([safe_decode_range(n.F),n.F]))}else for(x=0;x<d.length;++x)i.r>=d[x][0].s.r&&i.r<=d[x][0].e.r&&i.c>=d[x][0].s.c&&i.c<=d[x][0].e.c&&(n.F=d[x][1]);h.cellStyles&&(S.forEach(function(m){!v.patternType&&m.patternType&&(v.patternType=m.patternType)}),n.s=v),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function xlml_clean_comment(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function parse_xlml_xml(e,r){var t=r||{};make_ssf();var n=debom(xlml_normalize(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=utf8read(n));var i=n.slice(0,1024).toLowerCase(),l=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var c=dup(t);return c.type="string",PRN.to_workbook(n,c)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(be){i.indexOf("<"+be)>=0&&(l=!0)}),l)return html_to_workbook(n,t);XLMLFormatMap={"General Number":"General","General Date":table_fmt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":table_fmt[15],"Short Date":table_fmt[14],"Long Time":table_fmt[19],"Medium Time":table_fmt[18],"Short Time":table_fmt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:table_fmt[2],Standard:table_fmt[4],Percent:table_fmt[10],Scientific:table_fmt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var f,d=[],h,p={},E=[],v=t.dense?[]:{},S="",x={},g={},m=xlml_parsexmltag('<Data ss:Type="String">'),b=0,D=0,C=0,F={s:{r:2e6,c:2e6},e:{r:0,c:0}},T={},w={},y="",N=0,L=[],X={},z={},se=0,me=[],_e=[],de={},Y=[],ie,fe=!1,ae=[],W=[],xe={},I=0,M=0,R={Sheets:[],WBProps:{date1904:!1}},U={};xlmlregex.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var V="";f=xlmlregex.exec(n);)switch(f[3]=(V=f[3]).toLowerCase()){case"data":if(V=="data"){if(f[1]==="/"){if((h=d.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&d.push([f[3],!0]);break}if(d[d.length-1][1])break;f[1]==="/"?parse_xlml_data(n.slice(b,f.index),y,m,d[d.length-1][0]=="comment"?de:x,{c:D,r:C},T,Y[D],g,ae,t):(y="",m=xlml_parsexmltag(f[0]),b=f.index+f[0].length);break;case"cell":if(f[1]==="/")if(_e.length>0&&(x.c=_e),(!t.sheetRows||t.sheetRows>C)&&x.v!==void 0&&(t.dense?(v[C]||(v[C]=[]),v[C][D]=x):v[encode_col(D)+encode_row(C)]=x),x.HRef&&(x.l={Target:unescapexml(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(I=D+(parseInt(x.MergeAcross,10)|0),M=C+(parseInt(x.MergeDown,10)|0),L.push({s:{c:D,r:C},e:{c:I,r:M}})),!t.sheetStubs)x.MergeAcross?D=I+1:++D;else if(x.MergeAcross||x.MergeDown){for(var Z=D;Z<=I;++Z)for(var J=C;J<=M;++J)(Z>D||J>C)&&(t.dense?(v[J]||(v[J]=[]),v[J][Z]={t:"z"}):v[encode_col(Z)+encode_row(J)]={t:"z"});D=I+1}else++D;else x=xlml_parsexmltagobj(f[0]),x.Index&&(D=+x.Index-1),D<F.s.c&&(F.s.c=D),D>F.e.c&&(F.e.c=D),f[0].slice(-2)==="/>"&&++D,_e=[];break;case"row":f[1]==="/"||f[0].slice(-2)==="/>"?(C<F.s.r&&(F.s.r=C),C>F.e.r&&(F.e.r=C),f[0].slice(-2)==="/>"&&(g=xlml_parsexmltag(f[0]),g.Index&&(C=+g.Index-1)),D=0,++C):(g=xlml_parsexmltag(f[0]),g.Index&&(C=+g.Index-1),xe={},(g.AutoFitHeight=="0"||g.Height)&&(xe.hpx=parseInt(g.Height,10),xe.hpt=px2pt(xe.hpx),W[C]=xe),g.Hidden=="1"&&(xe.hidden=!0,W[C]=xe));break;case"worksheet":if(f[1]==="/"){if((h=d.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"));E.push(S),F.s.r<=F.e.r&&F.s.c<=F.e.c&&(v["!ref"]=encode_range(F),t.sheetRows&&t.sheetRows<=F.e.r&&(v["!fullref"]=v["!ref"],F.e.r=t.sheetRows-1,v["!ref"]=encode_range(F))),L.length&&(v["!merges"]=L),Y.length>0&&(v["!cols"]=Y),W.length>0&&(v["!rows"]=W),p[S]=v}else F={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=D=0,d.push([f[3],!1]),h=xlml_parsexmltag(f[0]),S=unescapexml(h.Name),v=t.dense?[]:{},L=[],ae=[],W=[],U={name:S,Hidden:0},R.Sheets.push(U);break;case"table":if(f[1]==="/"){if((h=d.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"))}else{if(f[0].slice(-2)=="/>")break;d.push([f[3],!1]),Y=[],fe=!1}break;case"style":f[1]==="/"?process_style_xlml(T,w,t):w=xlml_parsexmltag(f[0]);break;case"numberformat":w.nf=unescapexml(xlml_parsexmltag(f[0]).Format||"General"),XLMLFormatMap[w.nf]&&(w.nf=XLMLFormatMap[w.nf]);for(var O=0;O!=392&&table_fmt[O]!=w.nf;++O);if(O==392){for(O=57;O!=392;++O)if(table_fmt[O]==null){SSF_load(w.nf,O);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(ie=xlml_parsexmltag(f[0]),ie.Hidden&&(ie.hidden=!0,delete ie.Hidden),ie.Width&&(ie.wpx=parseInt(ie.Width,10)),!fe&&ie.wpx>10){fe=!0,MDW=DEF_MDW;for(var B=0;B<Y.length;++B)Y[B]&&process_col(Y[B])}fe&&process_col(ie),Y[ie.Index-1||Y.length]=ie;for(var G=0;G<+ie.Span;++G)Y[Y.length]=dup(ie);break;case"namedrange":if(f[1]==="/")break;R.Names||(R.Names=[]);var P=parsexmltag(f[0]),K={Name:P.Name,Ref:rc_to_a1(P.RefersTo.slice(1),{r:0,c:0})};R.Sheets.length>0&&(K.Sheet=R.Sheets.length-1),R.Names.push(K);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(f[0].slice(-2)==="/>")break;f[1]==="/"?y+=n.slice(N,f.index):N=f.index+f[0].length;break;case"interior":if(!t.cellStyles)break;w.Interior=xlml_parsexmltag(f[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(f[0].slice(-2)==="/>")break;f[1]==="/"?xlml_set_prop(X,V,n.slice(se,f.index)):se=f.index+f[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(f[1]==="/"){if((h=d.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"))}else d.push([f[3],!1]);break;case"comment":if(f[1]==="/"){if((h=d.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"));xlml_clean_comment(de),_e.push(de)}else d.push([f[3],!1]),h=xlml_parsexmltag(f[0]),de={a:h.Author};break;case"autofilter":if(f[1]==="/"){if((h=d.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"))}else if(f[0].charAt(f[0].length-2)!=="/"){var oe=xlml_parsexmltag(f[0]);v["!autofilter"]={ref:rc_to_a1(oe.Range).replace(/\$/g,"")},d.push([f[3],!0])}break;case"name":break;case"datavalidation":if(f[1]==="/"){if((h=d.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&d.push([f[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(f[1]==="/"){if((h=d.pop())[0]!==f[3])throw new Error("Bad state: "+h.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&d.push([f[3],!0]);break;case"null":break;default:if(d.length==0&&f[3]=="document"||d.length==0&&f[3]=="uof")return parse_fods(n,t);var re=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(f[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:re=!1}break;case"componentoptions":switch(f[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:re=!1}break;case"excelworkbook":switch(f[3]){case"date1904":R.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:re=!1}break;case"workbookoptions":switch(f[3]){case"owcversion":break;case"height":break;case"width":break;default:re=!1}break;case"worksheetoptions":switch(f[3]){case"visible":if(f[0].slice(-2)!=="/>")if(f[1]==="/")switch(n.slice(se,f.index)){case"SheetHidden":U.Hidden=1;break;case"SheetVeryHidden":U.Hidden=2;break}else se=f.index+f[0].length;break;case"header":v["!margins"]||default_margins(v["!margins"]={},"xlml"),isNaN(+parsexmltag(f[0]).Margin)||(v["!margins"].header=+parsexmltag(f[0]).Margin);break;case"footer":v["!margins"]||default_margins(v["!margins"]={},"xlml"),isNaN(+parsexmltag(f[0]).Margin)||(v["!margins"].footer=+parsexmltag(f[0]).Margin);break;case"pagemargins":var H=parsexmltag(f[0]);v["!margins"]||default_margins(v["!margins"]={},"xlml"),isNaN(+H.Top)||(v["!margins"].top=+H.Top),isNaN(+H.Left)||(v["!margins"].left=+H.Left),isNaN(+H.Right)||(v["!margins"].right=+H.Right),isNaN(+H.Bottom)||(v["!margins"].bottom=+H.Bottom);break;case"displayrighttoleft":R.Views||(R.Views=[]),R.Views[0]||(R.Views[0]={}),R.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:re=!1}break;case"pivottable":case"pivotcache":switch(f[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:re=!1}break;case"pagebreaks":switch(f[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:re=!1}break;case"autofilter":switch(f[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:re=!1}break;case"querytable":switch(f[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:re=!1}break;case"datavalidation":switch(f[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:re=!1}break;case"sorting":case"conditionalformatting":switch(f[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:re=!1}break;case"mapinfo":case"schema":case"data":switch(f[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:re=!1}break;case"smarttags":break;default:re=!1;break}if(re||f[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+f[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(f[0].slice(-2)==="/>")break;f[1]==="/"?xlml_set_custprop(z,V,me,n.slice(se,f.index)):(me=f,se=f.index+f[0].length);break}if(t.WTF)throw"Unrecognized tag: "+f[3]+"|"+d.join("|")}var Q={};return!t.bookSheets&&!t.bookProps&&(Q.Sheets=p),Q.SheetNames=E,Q.Workbook=R,Q.SSF=dup(table_fmt),Q.Props=X,Q.Custprops=z,Q}function parse_xlml(e,r){switch(fix_read_opts(r=r||{}),r.type||"base64"){case"base64":return parse_xlml_xml(Base64_decode(e),r);case"binary":case"buffer":case"file":return parse_xlml_xml(e,r);case"array":return parse_xlml_xml(a2s(e),r)}}function parse_compobj(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=parse_ClipboardFormatOrAnsiString(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=parse_ClipboardFormatOrUnicodeString(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var CONTINUE_RT=[60,1084,2066,2165,2175];function slurp(e,r,t,n,i){var l=n,c=[],f=t.slice(t.l,t.l+l);if(i.enc&&i.enc.insitu&&f.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(f)}c.push(f),t.l+=l;for(var d=__readUInt16LE(t,t.l),h=XLSRecordEnum[d],p=0;h!=null&&CONTINUE_RT.indexOf(d)>-1;)l=__readUInt16LE(t,t.l+2),p=t.l+4,d==2066?p+=4:(d==2165||d==2175)&&(p+=12),f=t.slice(p,t.l+4+l),c.push(f),t.l+=4+l,h=XLSRecordEnum[d=__readUInt16LE(t,t.l)];var E=bconcat(c);prep_blob(E,0);var v=0;E.lens=[];for(var S=0;S<c.length;++S)E.lens.push(v),v+=c[S].length;if(E.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+E.length+" < "+n;return r.f(E,E.length,i)}function safe_format_xf(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=table_fmt[n])}catch(l){if(r.WTF)throw l}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||BErr[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v):e.w=SSF_general(e.v):e.w=SSF_format(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(l){if(r.WTF)throw l}if(r.cellDates&&n&&e.t=="n"&&fmt_is_date(table_fmt[n]||String(n))){var i=SSF_parse_date_code(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function make_cell(e,r,t){return{v:e,ixfe:r,t}}function parse_workbook(e,r){var t={opts:{}},n={},i=r.dense?[]:{},l={},c={},f=null,d=[],h="",p={},E,v="",S,x,g,m,b={},D=[],C,F,T=[],w=[],y={Sheets:[],WBProps:{date1904:!1},Views:[{}]},N={},L=function(Qe){return Qe<8?XLSIcv[Qe]:Qe<64&&w[Qe-8]||XLSIcv[Qe]},X=function(Qe,it,pt){var st=it.XF.data;if(!(!st||!st.patternType||!pt||!pt.cellStyles)){it.s={},it.s.patternType=st.patternType;var ct;(ct=rgb2Hex(L(st.icvFore)))&&(it.s.fgColor={rgb:ct}),(ct=rgb2Hex(L(st.icvBack)))&&(it.s.bgColor={rgb:ct})}},z=function(Qe,it,pt){if(!(xe>1)&&!(pt.sheetRows&&Qe.r>=pt.sheetRows)){if(pt.cellStyles&&it.XF&&it.XF.data&&X(Qe,it,pt),delete it.ixfe,delete it.XF,E=Qe,v=encode_cell(Qe),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),Qe.r<c.s.r&&(c.s.r=Qe.r),Qe.c<c.s.c&&(c.s.c=Qe.c),Qe.r+1>c.e.r&&(c.e.r=Qe.r+1),Qe.c+1>c.e.c&&(c.e.c=Qe.c+1),pt.cellFormula&&it.f){for(var st=0;st<D.length;++st)if(!(D[st][0].s.c>Qe.c||D[st][0].s.r>Qe.r)&&!(D[st][0].e.c<Qe.c||D[st][0].e.r<Qe.r)){it.F=encode_range(D[st][0]),(D[st][0].s.c!=Qe.c||D[st][0].s.r!=Qe.r)&&delete it.f,it.f&&(it.f=""+stringify_formula(D[st][1],c,Qe,ae,se));break}}pt.dense?(i[Qe.r]||(i[Qe.r]=[]),i[Qe.r][Qe.c]=it):i[v]=it}},se={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:D,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(se.password=r.password);var me,_e=[],de=[],Y=[],ie=[],fe=!1,ae=[];ae.SheetNames=se.snames,ae.sharedf=se.sharedf,ae.arrayf=se.arrayf,ae.names=[],ae.XTI=[];var W=0,xe=0,I=0,M=[],R=[],U;se.codepage=1200,set_cp(1200);for(var V=!1;e.l<e.length-1;){var Z=e.l,J=e.read_shift(2);if(J===0&&W===10)break;var O=e.l===e.length?0:e.read_shift(2),B=XLSRecordEnum[J];if(B&&B.f){if(r.bookSheets&&W===133&&J!==133)break;if(W=J,B.r===2||B.r==12){var G=e.read_shift(2);if(O-=2,!se.enc&&G!==J&&((G&255)<<8|G>>8)!==J)throw new Error("rt mismatch: "+G+"!="+J);B.r==12&&(e.l+=10,O-=10)}var P={};if(J===10?P=B.f(e,O,se):P=slurp(J,B,e,O,se),xe==0&&[9,521,1033,2057].indexOf(W)===-1)continue;switch(J){case 34:t.opts.Date1904=y.WBProps.date1904=P;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(se.enc||(e.l=0),se.enc=P,!r.password)throw new Error("File is password-protected");if(P.valid==null)throw new Error("Encryption scheme unsupported");if(!P.valid)throw new Error("Password is incorrect");break;case 92:se.lastuser=P;break;case 66:var K=Number(P);switch(K){case 21010:K=1200;break;case 32768:K=1e4;break;case 32769:K=1252;break}set_cp(se.codepage=K),V=!0;break;case 317:se.rrtabid=P;break;case 25:se.winlocked=P;break;case 439:t.opts.RefreshAll=P;break;case 12:t.opts.CalcCount=P;break;case 16:t.opts.CalcDelta=P;break;case 17:t.opts.CalcIter=P;break;case 13:t.opts.CalcMode=P;break;case 14:t.opts.CalcPrecision=P;break;case 95:t.opts.CalcSaveRecalc=P;break;case 15:se.CalcRefMode=P;break;case 2211:t.opts.FullCalc=P;break;case 129:P.fDialog&&(i["!type"]="dialog"),P.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),P.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:T.push(P);break;case 430:ae.push([P]),ae[ae.length-1].XTI=[];break;case 35:case 547:ae[ae.length-1].push(P);break;case 24:case 536:U={Name:P.Name,Ref:stringify_formula(P.rgce,c,null,ae,se)},P.itab>0&&(U.Sheet=P.itab-1),ae.names.push(U),ae[0]||(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].push(P),P.Name=="_xlnm._FilterDatabase"&&P.itab>0&&P.rgce&&P.rgce[0]&&P.rgce[0][0]&&P.rgce[0][0][0]=="PtgArea3d"&&(R[P.itab-1]={ref:encode_range(P.rgce[0][0][1][2])});break;case 22:se.ExternCount=P;break;case 23:ae.length==0&&(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].XTI=ae[ae.length-1].XTI.concat(P),ae.XTI=ae.XTI.concat(P);break;case 2196:if(se.biff<8)break;U!=null&&(U.Comment=P[1]);break;case 18:i["!protect"]=P;break;case 19:P!==0&&se.WTF&&console.error("Password verifier: "+P);break;case 133:l[P.pos]=P,se.snames.push(P.name);break;case 10:{if(--xe)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,i["!ref"]=encode_range(c),r.sheetRows&&r.sheetRows<=c.e.r){var oe=c.e.r;c.e.r=r.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=encode_range(c),c.e.r=oe}c.e.r++,c.e.c++}_e.length>0&&(i["!merges"]=_e),de.length>0&&(i["!objects"]=de),Y.length>0&&(i["!cols"]=Y),ie.length>0&&(i["!rows"]=ie),y.Sheets.push(N)}h===""?p=i:n[h]=i,i=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(se.biff===8&&(se.biff={9:2,521:3,1033:4}[J]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[P.BIFFVer]||8),se.biffguess=P.BIFFVer==0,P.BIFFVer==0&&P.dt==4096&&(se.biff=5,V=!0,set_cp(se.codepage=28591)),se.biff==8&&P.BIFFVer==0&&P.dt==16&&(se.biff=2),xe++)break;if(i=r.dense?[]:{},se.biff<8&&!V&&(V=!0,set_cp(se.codepage=r.codepage||1252)),se.biff<5||P.BIFFVer==0&&P.dt==4096){h===""&&(h="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var re={pos:e.l-O,name:h};l[re.pos]=re,se.snames.push(h)}else h=(l[Z]||{name:""}).name;P.dt==32&&(i["!type"]="chart"),P.dt==64&&(i["!type"]="macro"),_e=[],de=[],se.arrayf=D=[],Y=[],ie=[],fe=!1,N={Hidden:(l[Z]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(r.dense?(i[P.r]||[])[P.c]:i[encode_cell({c:P.c,r:P.r})])&&++P.c,C={ixfe:P.ixfe,XF:T[P.ixfe]||{},v:P.val,t:"n"},I>0&&(C.z=M[C.ixfe>>8&63]),safe_format_xf(C,r,t.opts.Date1904),z({c:P.c,r:P.r},C,r);break;case 5:case 517:C={ixfe:P.ixfe,XF:T[P.ixfe],v:P.val,t:P.t},I>0&&(C.z=M[C.ixfe>>8&63]),safe_format_xf(C,r,t.opts.Date1904),z({c:P.c,r:P.r},C,r);break;case 638:C={ixfe:P.ixfe,XF:T[P.ixfe],v:P.rknum,t:"n"},I>0&&(C.z=M[C.ixfe>>8&63]),safe_format_xf(C,r,t.opts.Date1904),z({c:P.c,r:P.r},C,r);break;case 189:for(var H=P.c;H<=P.C;++H){var Q=P.rkrec[H-P.c][0];C={ixfe:Q,XF:T[Q],v:P.rkrec[H-P.c][1],t:"n"},I>0&&(C.z=M[C.ixfe>>8&63]),safe_format_xf(C,r,t.opts.Date1904),z({c:H,r:P.r},C,r)}break;case 6:case 518:case 1030:{if(P.val=="String"){f=P;break}if(C=make_cell(P.val,P.cell.ixfe,P.tt),C.XF=T[C.ixfe],r.cellFormula){var be=P.formula;if(be&&be[0]&&be[0][0]&&be[0][0][0]=="PtgExp"){var ge=be[0][0][1][0],ye=be[0][0][1][1],we=encode_cell({r:ge,c:ye});b[we]?C.f=""+stringify_formula(P.formula,c,P.cell,ae,se):C.F=((r.dense?(i[ge]||[])[ye]:i[we])||{}).F}else C.f=""+stringify_formula(P.formula,c,P.cell,ae,se)}I>0&&(C.z=M[C.ixfe>>8&63]),safe_format_xf(C,r,t.opts.Date1904),z(P.cell,C,r),f=P}break;case 7:case 519:if(f)f.val=P,C=make_cell(P,f.cell.ixfe,"s"),C.XF=T[C.ixfe],r.cellFormula&&(C.f=""+stringify_formula(f.formula,c,f.cell,ae,se)),I>0&&(C.z=M[C.ixfe>>8&63]),safe_format_xf(C,r,t.opts.Date1904),z(f.cell,C,r),f=null;else throw new Error("String record expects Formula");break;case 33:case 545:{D.push(P);var Le=encode_cell(P[0].s);if(S=r.dense?(i[P[0].s.r]||[])[P[0].s.c]:i[Le],r.cellFormula&&S){if(!f||!Le||!S)break;S.f=""+stringify_formula(P[1],c,P[0],ae,se),S.F=encode_range(P[0])}}break;case 1212:{if(!r.cellFormula)break;if(v){if(!f)break;b[encode_cell(f.cell)]=P[0],S=r.dense?(i[f.cell.r]||[])[f.cell.c]:i[encode_cell(f.cell)],(S||{}).f=""+stringify_formula(P[0],c,E,ae,se)}}break;case 253:C=make_cell(d[P.isst].t,P.ixfe,"s"),d[P.isst].h&&(C.h=d[P.isst].h),C.XF=T[C.ixfe],I>0&&(C.z=M[C.ixfe>>8&63]),safe_format_xf(C,r,t.opts.Date1904),z({c:P.c,r:P.r},C,r);break;case 513:r.sheetStubs&&(C={ixfe:P.ixfe,XF:T[P.ixfe],t:"z"},I>0&&(C.z=M[C.ixfe>>8&63]),safe_format_xf(C,r,t.opts.Date1904),z({c:P.c,r:P.r},C,r));break;case 190:if(r.sheetStubs)for(var Ve=P.c;Ve<=P.C;++Ve){var Ce=P.ixfe[Ve-P.c];C={ixfe:Ce,XF:T[Ce],t:"z"},I>0&&(C.z=M[C.ixfe>>8&63]),safe_format_xf(C,r,t.opts.Date1904),z({c:Ve,r:P.r},C,r)}break;case 214:case 516:case 4:C=make_cell(P.val,P.ixfe,"s"),C.XF=T[C.ixfe],I>0&&(C.z=M[C.ixfe>>8&63]),safe_format_xf(C,r,t.opts.Date1904),z({c:P.c,r:P.r},C,r);break;case 0:case 512:xe===1&&(c=P);break;case 252:d=P;break;case 1054:if(se.biff==4){M[I++]=P[1];for(var nt=0;nt<I+163&&table_fmt[nt]!=P[1];++nt);nt>=163&&SSF_load(P[1],I+163)}else SSF_load(P[1],P[0]);break;case 30:{M[I++]=P;for(var tt=0;tt<I+163&&table_fmt[tt]!=P;++tt);tt>=163&&SSF_load(P,I+163)}break;case 229:_e=_e.concat(P);break;case 93:de[P.cmo[0]]=se.lastobj=P;break;case 438:se.lastobj.TxO=P;break;case 127:se.lastobj.ImData=P;break;case 440:for(m=P[0].s.r;m<=P[0].e.r;++m)for(g=P[0].s.c;g<=P[0].e.c;++g)S=r.dense?(i[m]||[])[g]:i[encode_cell({c:g,r:m})],S&&(S.l=P[1]);break;case 2048:for(m=P[0].s.r;m<=P[0].e.r;++m)for(g=P[0].s.c;g<=P[0].e.c;++g)S=r.dense?(i[m]||[])[g]:i[encode_cell({c:g,r:m})],S&&S.l&&(S.l.Tooltip=P[1]);break;case 28:{if(se.biff<=5&&se.biff>=2)break;S=r.dense?(i[P[0].r]||[])[P[0].c]:i[encode_cell(P[0])];var Je=de[P[2]];S||(r.dense?(i[P[0].r]||(i[P[0].r]=[]),S=i[P[0].r][P[0].c]={t:"z"}):S=i[encode_cell(P[0])]={t:"z"},c.e.r=Math.max(c.e.r,P[0].r),c.s.r=Math.min(c.s.r,P[0].r),c.e.c=Math.max(c.e.c,P[0].c),c.s.c=Math.min(c.s.c,P[0].c)),S.c||(S.c=[]),x={a:P[1],t:Je.TxO.t},S.c.push(x)}break;case 2173:update_xfext(T[P.ixfe],P.ext);break;case 125:{if(!se.cellStyles)break;for(;P.e>=P.s;)Y[P.e--]={width:P.w/256,level:P.level||0,hidden:!!(P.flags&1)},fe||(fe=!0,find_mdw_colw(P.w/256)),process_col(Y[P.e+1])}break;case 520:{var et={};P.level!=null&&(ie[P.r]=et,et.level=P.level),P.hidden&&(ie[P.r]=et,et.hidden=!0),P.hpt&&(ie[P.r]=et,et.hpt=P.hpt,et.hpx=pt2px(P.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||default_margins(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[J]]=P;break;case 161:i["!margins"]||default_margins(i["!margins"]={}),i["!margins"].header=P.header,i["!margins"].footer=P.footer;break;case 574:P.RTL&&(y.Views[0].RTL=!0);break;case 146:w=P;break;case 2198:me=P;break;case 140:F=P;break;case 442:h?N.CodeName=P||N.name:y.WBProps.CodeName=P||"ThisWorkbook";break}}else B||console.error("Missing Info for XLS Record 0x"+J.toString(16)),e.l+=O}return t.SheetNames=keys(l).sort(function(ht,Qe){return Number(ht)-Number(Qe)}).map(function(ht){return l[ht].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&p["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=p)):t.Preamble=p,t.Sheets&&R.forEach(function(ht,Qe){t.Sheets[t.SheetNames[Qe]]["!autofilter"]=ht}),t.Strings=d,t.SSF=dup(table_fmt),se.enc&&(t.Encryption=se.enc),me&&(t.Themes=me),t.Metadata={},F!==void 0&&(t.Metadata.Country=F),ae.names.length>0&&(y.Names=ae.names),t.Workbook=y,t}var PSCLSID={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function parse_xls_props(e,r,t){var n=CFB.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=parse_PropertySetStream(n,DocSummaryPIDDSI,PSCLSID.DSI);for(var l in i)r[l]=i[l]}catch(h){if(t.WTF)throw h}var c=CFB.find(e,"/!SummaryInformation");if(c&&c.size>0)try{var f=parse_PropertySetStream(c,SummaryPIDSI,PSCLSID.SI);for(var d in f)r[d]==null&&(r[d]=f[d])}catch(h){if(t.WTF)throw h}r.HeadingPairs&&r.TitlesOfParts&&(load_props_pairs(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function parse_xlscfb(e,r){r||(r={}),fix_read_opts(r),reset_cp(),r.codepage&&set_ansi(r.codepage);var t,n;if(e.FullPaths){if(CFB.find(e,"/encryption"))throw new Error("File is password-protected");t=CFB.find(e,"!CompObj"),n=CFB.find(e,"/Workbook")||CFB.find(e,"/Book")}else{switch(r.type){case"base64":e=s2a(Base64_decode(e));break;case"binary":e=s2a(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}prep_blob(e,0),n={content:e}}var i,l;if(t&&parse_compobj(t),r.bookProps&&!r.bookSheets)i={};else{var c=has_buf?"buffer":"array";if(n&&n.content)i=parse_workbook(n.content,r);else if((l=CFB.find(e,"PerfectOffice_MAIN"))&&l.content)i=WK_.to_workbook(l.content,(r.type=c,r));else if((l=CFB.find(e,"NativeContent_MAIN"))&&l.content)i=WK_.to_workbook(l.content,(r.type=c,r));else throw(l=CFB.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&CFB.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=make_vba_xls(e))}var f={};return e.FullPaths&&parse_xls_props(e,f,r),i.Props=i.Custprops=f,r.bookFiles&&(i.cfb=e),i}var XLSBRecordEnum={0:{f:parse_BrtRowHdr},1:{f:parse_BrtCellBlank},2:{f:parse_BrtCellRk},3:{f:parse_BrtCellError},4:{f:parse_BrtCellBool},5:{f:parse_BrtCellReal},6:{f:parse_BrtCellSt},7:{f:parse_BrtCellIsst},8:{f:parse_BrtFmlaString},9:{f:parse_BrtFmlaNum},10:{f:parse_BrtFmlaBool},11:{f:parse_BrtFmlaError},12:{f:parse_BrtShortBlank},13:{f:parse_BrtShortRk},14:{f:parse_BrtShortError},15:{f:parse_BrtShortBool},16:{f:parse_BrtShortReal},17:{f:parse_BrtShortSt},18:{f:parse_BrtShortIsst},19:{f:parse_RichStr},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:parse_BrtName},40:{},42:{},43:{f:parse_BrtFont},44:{f:parse_BrtFmt},45:{f:parse_BrtFill},46:{f:parse_BrtBorder},47:{f:parse_BrtXF},48:{},49:{f:parse_Int32LE},50:{},51:{f:parse_BrtMdb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:parse_ColInfo},62:{f:parse_BrtCellRString},63:{f:parse_BrtCalcChainItem$},64:{f:parse_BrtDVal},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:parsenoop,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:parse_BrtBeginWsView},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:parse_BrtWsProp},148:{f:parse_BrtWsDim,p:16},151:{f:parse_BrtPane},152:{},153:{f:parse_BrtWbProp},154:{},155:{},156:{f:parse_BrtBundleSh},157:{},158:{},159:{T:1,f:parse_BrtBeginSst},160:{T:-1},161:{T:1,f:parse_UncheckedRfX},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:parse_BrtMergeCell},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:parse_BrtMdtinfo},336:{T:-1},337:{f:parse_BrtBeginEsmdb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:parse_RelID},357:{},358:{},359:{},360:{T:1},361:{},362:{f:parse_ExternSheet},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:parse_BrtArrFmla},427:{f:parse_BrtShrFmla},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:parse_BrtMargins},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:parse_BrtWsFmtInfo},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:parse_BrtHLink},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:parse_RelID},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:parse_BrtCommentAuthor},633:{T:1},634:{T:-1},635:{T:1,f:parse_BrtBeginComment},636:{T:-1},637:{f:parse_BrtCommentText},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:parse_BrtCsProp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:parse_BrtDVal14},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},XLSRecordEnum={6:{f:parse_Formula},10:{f:parsenoop2},12:{f:parseuint16},13:{f:parseuint16},14:{f:parsebool},15:{f:parsebool},16:{f:parse_Xnum},17:{f:parsebool},18:{f:parsebool},19:{f:parseuint16},20:{f:parse_XLHeaderFooter},21:{f:parse_XLHeaderFooter},23:{f:parse_ExternSheet},24:{f:parse_Lbl},25:{f:parsebool},26:{},27:{},28:{f:parse_Note},29:{},34:{f:parsebool},35:{f:parse_ExternName},38:{f:parse_Xnum},39:{f:parse_Xnum},40:{f:parse_Xnum},41:{f:parse_Xnum},42:{f:parsebool},43:{f:parsebool},47:{f:parse_FilePass},49:{f:parse_Font},51:{f:parseuint16},60:{},61:{f:parse_Window1},64:{f:parsebool},65:{f:parse_Pane},66:{f:parseuint16},77:{},80:{},81:{},82:{},85:{f:parseuint16},89:{},90:{},91:{},92:{f:parse_WriteAccess},93:{f:parse_Obj},94:{},95:{f:parsebool},96:{},97:{},99:{f:parsebool},125:{f:parse_ColInfo},128:{f:parse_Guts},129:{f:parse_WsBool},130:{f:parseuint16},131:{f:parsebool},132:{f:parsebool},133:{f:parse_BoundSheet8},134:{},140:{f:parse_Country},141:{f:parseuint16},144:{},146:{f:parse_Palette},151:{},152:{},153:{},154:{},155:{},156:{f:parseuint16},157:{},158:{},160:{f:parse_Scl},161:{f:parse_Setup},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:parse_MulRk},190:{f:parse_MulBlank},193:{f:parsenoop2},197:{},198:{},199:{},200:{},201:{},202:{f:parsebool},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:parseuint16},220:{},221:{f:parsebool},222:{},224:{f:parse_XF},225:{f:parse_InterfaceHdr},226:{f:parsenoop2},227:{},229:{f:parse_MergeCells},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:parse_SST},253:{f:parse_LabelSst},255:{f:parse_ExtSST},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:parseuint16a},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:parsebool},353:{f:parsenoop2},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:parse_SupBook},431:{f:parsebool},432:{},433:{},434:{},437:{},438:{f:parse_TxO},439:{f:parsebool},440:{f:parse_HLink},441:{},442:{f:parse_XLUnicodeString},443:{},444:{f:parseuint16},445:{},446:{},448:{f:parsenoop2},449:{f:parse_RecalcId,r:2},450:{f:parsenoop2},512:{f:parse_Dimensions},513:{f:parse_Blank},515:{f:parse_Number},516:{f:parse_Label},517:{f:parse_BoolErr},519:{f:parse_String},520:{f:parse_Row},523:{},545:{f:parse_Array},549:{f:parse_DefaultRowHeight},566:{},574:{f:parse_Window2},638:{f:parse_RK},659:{},1048:{},1054:{f:parse_Format},1084:{},1212:{f:parse_ShrFmla},2048:{f:parse_HLinkTooltip},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:parse_BOF},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:parsenoop2},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:parse_XFCRC,r:12},2173:{f:parse_XFExt,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:parsebool,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:parse_NameCmt,r:12},2197:{},2198:{f:parse_Theme,r:12},2199:{},2200:{},2201:{},2202:{f:parse_MTRSettings,r:12},2203:{f:parsenoop2},2204:{},2205:{},2206:{},2207:{},2211:{f:parse_ForceFullCalculation},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:parseuint16},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:parse_ShtProps},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:parse_ClrtClient},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:parse_Dimensions},1:{},2:{f:parse_BIFF2INT},3:{f:parse_BIFF2NUM},4:{f:parse_BIFF2STR},5:{f:parse_BoolErr},7:{f:parse_BIFF2STRING},8:{},9:{f:parse_BOF},11:{},22:{f:parseuint16},30:{f:parse_BIFF2Format},31:{},32:{},33:{f:parse_Array},36:{},37:{f:parse_DefaultRowHeight},50:{f:parse_BIFF2FONTXTRA},62:{},52:{},67:{},68:{f:parseuint16},69:{},86:{},126:{},127:{f:parse_ImData},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:parse_RString},223:{},234:{},354:{},421:{},518:{f:parse_Formula},521:{f:parse_BOF},536:{f:parse_Lbl},547:{f:parse_ExternName},561:{},579:{},1030:{f:parse_Formula},1033:{f:parse_BOF},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function write_biff_rec(e,r,t,n){var i=r;if(!isNaN(i)){var l=(t||[]).length||0,c=e.next(4);c.write_shift(2,i),c.write_shift(2,l),l>0&&is_buf(t)&&e.push(t)}}function html_to_sheet(e,r){var t=r,n=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),c=i.index,f=l&&l.index||e.length,d=split_regex(e.slice(c,f),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,p=0,E=0,v=0,S={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(c=0;c<d.length;++c){var g=d[c].trim(),m=g.slice(0,3).toLowerCase();if(m=="<tr"){if(++h,t.sheetRows&&t.sheetRows<=h){--h;break}p=0;continue}if(!(m!="<td"&&m!="<th")){var b=g.split(/<\/t[dh]>/i);for(f=0;f<b.length;++f){var D=b[f].trim();if(D.match(/<t[dh]/i)){for(var C=D,F=0;C.charAt(0)=="<"&&(F=C.indexOf(">"))>-1;)C=C.slice(F+1);for(var T=0;T<x.length;++T){var w=x[T];w.s.c==p&&w.s.r<h&&h<=w.e.r&&(p=w.e.c+1,T=-1)}var y=parsexmltag(D.slice(0,D.indexOf(">")));v=y.colspan?+y.colspan:1,((E=+y.rowspan)>1||v>1)&&x.push({s:{r:h,c:p},e:{r:h+(E||1)-1,c:p+v-1}});var N=y.t||y["data-t"]||"";if(!C.length){p+=v;continue}if(C=htmldecode(C),S.s.r>h&&(S.s.r=h),S.e.r<h&&(S.e.r=h),S.s.c>p&&(S.s.c=p),S.e.c<p&&(S.e.c=p),!C.length){p+=v;continue}var L={t:"s",v:C};t.raw||!C.trim().length||N=="s"||(C==="TRUE"?L={t:"b",v:!0}:C==="FALSE"?L={t:"b",v:!1}:isNaN(fuzzynum(C))?isNaN(fuzzydate(C).getDate())||(L={t:"d",v:parseDate(C)},t.cellDates||(L={t:"n",v:datenum(L.v)}),L.z=t.dateNF||table_fmt[14]):L={t:"n",v:fuzzynum(C)}),t.dense?(n[h]||(n[h]=[]),n[h][p]=L):n[encode_cell({r:h,c:p})]=L,p+=v}}}}return n["!ref"]=encode_range(S),x.length&&(n["!merges"]=x),n}function make_html_row(e,r,t,n){for(var i=e["!merges"]||[],l=[],c=r.s.c;c<=r.e.c;++c){for(var f=0,d=0,h=0;h<i.length;++h)if(!(i[h].s.r>t||i[h].s.c>c)&&!(i[h].e.r<t||i[h].e.c<c)){if(i[h].s.r<t||i[h].s.c<c){f=-1;break}f=i[h].e.r-i[h].s.r+1,d=i[h].e.c-i[h].s.c+1;break}if(!(f<0)){var p=encode_cell({r:t,c}),E=n.dense?(e[t]||[])[c]:e[p],v=E&&E.v!=null&&(E.h||escapehtml(E.w||(format_cell(E),E.w)||""))||"",S={};f>1&&(S.rowspan=f),d>1&&(S.colspan=d),n.editable?v='<span contenteditable="true">'+v+"</span>":E&&(S["data-t"]=E&&E.t||"z",E.v!=null&&(S["data-v"]=E.v),E.z!=null&&(S["data-z"]=E.z),E.l&&(E.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+E.l.Target+'">'+v+"</a>")),S.id=(n.id||"sjs")+"-"+p,l.push(writextag("td",v,S))}}var x="<tr>";return x+l.join("")+"</tr>"}var HTML_BEGIN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HTML_END="</body></html>";function html_to_workbook(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return sheet_to_workbook(html_to_sheet(t[0],r),r);var n=book_new();return t.forEach(function(i,l){book_append_sheet(n,html_to_sheet(i,r),"Sheet"+(l+1))}),n}function make_html_preamble(e,r,t){var n=[];return n.join("")+"<table"+(t.id?' id="'+t.id+'"':"")+">"}function sheet_to_html(e,r){var t=r||{},n=t.header!=null?t.header:HTML_BEGIN,i=t.footer!=null?t.footer:HTML_END,l=[n],c=decode_range(e["!ref"]);t.dense=Array.isArray(e),l.push(make_html_preamble(e,c,t));for(var f=c.s.r;f<=c.e.r;++f)l.push(make_html_row(e,c,f,t));return l.push("</table>"+i),l.join("")}function sheet_add_dom(e,r,t){var n=t||{},i=0,l=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?decode_cell(n.origin):n.origin;i=c.r,l=c.c}var f=r.getElementsByTagName("tr"),d=Math.min(n.sheetRows||1e7,f.length),h={s:{r:0,c:0},e:{r:i,c:l}};if(e["!ref"]){var p=decode_range(e["!ref"]);h.s.r=Math.min(h.s.r,p.s.r),h.s.c=Math.min(h.s.c,p.s.c),h.e.r=Math.max(h.e.r,p.e.r),h.e.c=Math.max(h.e.c,p.e.c),i==-1&&(h.e.r=i=p.e.r+1)}var E=[],v=0,S=e["!rows"]||(e["!rows"]=[]),x=0,g=0,m=0,b=0,D=0,C=0;for(e["!cols"]||(e["!cols"]=[]);x<f.length&&g<d;++x){var F=f[x];if(is_dom_element_hidden(F)){if(n.display)continue;S[g]={hidden:!0}}var T=F.children;for(m=b=0;m<T.length;++m){var w=T[m];if(!(n.display&&is_dom_element_hidden(w))){var y=w.hasAttribute("data-v")?w.getAttribute("data-v"):w.hasAttribute("v")?w.getAttribute("v"):htmldecode(w.innerHTML),N=w.getAttribute("data-z")||w.getAttribute("z");for(v=0;v<E.length;++v){var L=E[v];L.s.c==b+l&&L.s.r<g+i&&g+i<=L.e.r&&(b=L.e.c+1-l,v=-1)}C=+w.getAttribute("colspan")||1,((D=+w.getAttribute("rowspan")||1)>1||C>1)&&E.push({s:{r:g+i,c:b+l},e:{r:g+i+(D||1)-1,c:b+l+(C||1)-1}});var X={t:"s",v:y},z=w.getAttribute("data-t")||w.getAttribute("t")||"";y!=null&&(y.length==0?X.t=z||"z":n.raw||y.trim().length==0||z=="s"||(y==="TRUE"?X={t:"b",v:!0}:y==="FALSE"?X={t:"b",v:!1}:isNaN(fuzzynum(y))?isNaN(fuzzydate(y).getDate())||(X={t:"d",v:parseDate(y)},n.cellDates||(X={t:"n",v:datenum(X.v)}),X.z=n.dateNF||table_fmt[14]):X={t:"n",v:fuzzynum(y)})),X.z===void 0&&N!=null&&(X.z=N);var se="",me=w.getElementsByTagName("A");if(me&&me.length)for(var _e=0;_e<me.length&&!(me[_e].hasAttribute("href")&&(se=me[_e].getAttribute("href"),se.charAt(0)!="#"));++_e);se&&se.charAt(0)!="#"&&(X.l={Target:se}),n.dense?(e[g+i]||(e[g+i]=[]),e[g+i][b+l]=X):e[encode_cell({c:b+l,r:g+i})]=X,h.e.c<b+l&&(h.e.c=b+l),b+=C}}++g}return E.length&&(e["!merges"]=(e["!merges"]||[]).concat(E)),h.e.r=Math.max(h.e.r,g-1+i),e["!ref"]=encode_range(h),g>=d&&(e["!fullref"]=encode_range((h.e.r=f.length-x+g-1+i,h))),e}function parse_dom_table(e,r){var t=r||{},n=t.dense?[]:{};return sheet_add_dom(n,e,r)}function table_to_book(e,r){return sheet_to_workbook(parse_dom_table(e,r),r)}function is_dom_element_hidden(e){var r="",t=get_get_computed_style_function(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function get_get_computed_style_function(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function parse_text_p(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=unescapexml(r.replace(/<[^>]*>/g,""));return[t]}var number_formats_ods={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function parse_content_xml(e,r){var t=r||{},n=xlml_normalize(e),i=[],l,c,f={name:""},d="",h=0,p,E,v={},S=[],x=t.dense?[]:{},g,m,b={value:""},D="",C=0,F=[],T=-1,w=-1,y={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,L={},X=[],z={},se=0,me=0,_e=[],de=1,Y=1,ie=[],fe={Names:[]},ae={},W=["",""],xe=[],I={},M="",R=0,U=!1,V=!1,Z=0;for(xlmlregex.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=xlmlregex.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(y.e.c>=y.s.c&&y.e.r>=y.s.r?x["!ref"]=encode_range(y):x["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=y.e.r&&(x["!fullref"]=x["!ref"],y.e.r=t.sheetRows-1,x["!ref"]=encode_range(y)),X.length&&(x["!merges"]=X),_e.length&&(x["!rows"]=_e),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),S.push(p.name),v[p.name]=x,V=!1):g[0].charAt(g[0].length-2)!=="/"&&(p=parsexmltag(g[0],!1),T=w=-1,y.s.r=y.s.c=1e7,y.e.r=y.e.c=0,x=t.dense?[]:{},X=[],_e=[],V=!0);break;case"table-row-group":g[1]==="/"?--N:++N;break;case"table-row":case"":if(g[1]==="/"){T+=de,de=1;break}if(E=parsexmltag(g[0],!1),E.?T=E.-1:T==-1&&(T=0),de=+E["number-rows-repeated"]||1,de<10)for(Z=0;Z<de;++Z)N>0&&(_e[T+Z]={level:N});w=-1;break;case"covered-table-cell":g[1]!=="/"&&++w,t.sheetStubs&&(t.dense?(x[T]||(x[T]=[]),x[T][w]={t:"z"}):x[encode_cell({r:T,c:w})]={t:"z"}),D="",F=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++w,b=parsexmltag(g[0],!1),Y=parseInt(b["number-columns-repeated"]||"1",10),m={t:"z",v:null},b.formula&&t.cellFormula!=!1&&(m.f=ods_to_csf_formula(unescapexml(b.formula))),(b.||b["value-type"])=="string"&&(m.t="s",m.v=unescapexml(b["string-value"]||""),t.dense?(x[T]||(x[T]=[]),x[T][w]=m):x[encode_cell({r:T,c:w})]=m),w+=Y-1;else if(g[1]!=="/"){++w,D="",C=0,F=[],Y=1;var J=de?T+de-1:T;if(w>y.e.c&&(y.e.c=w),w<y.s.c&&(y.s.c=w),T<y.s.r&&(y.s.r=T),J>y.e.r&&(y.e.r=J),b=parsexmltag(g[0],!1),xe=[],I={},m={t:b.||b["value-type"],v:null},t.cellFormula)if(b.formula&&(b.formula=unescapexml(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(se=parseInt(b["number-matrix-rows-spanned"],10)||0,me=parseInt(b["number-matrix-columns-spanned"],10)||0,z={s:{r:T,c:w},e:{r:T+se-1,c:w+me-1}},m.F=encode_range(z),ie.push([z,m.F])),b.formula)m.f=ods_to_csf_formula(b.formula);else for(Z=0;Z<ie.length;++Z)T>=ie[Z][0].s.r&&T<=ie[Z][0].e.r&&w>=ie[Z][0].s.c&&w<=ie[Z][0].e.c&&(m.F=ie[Z][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(se=parseInt(b["number-rows-spanned"],10)||0,me=parseInt(b["number-columns-spanned"],10)||0,z={s:{r:T,c:w},e:{r:T+se-1,c:w+me-1}},X.push(z)),b["number-columns-repeated"]&&(Y=parseInt(b["number-columns-repeated"],10)),m.t){case"boolean":m.t="b",m.v=parsexmlbool(b["boolean-value"]);break;case"float":m.t="n",m.v=parseFloat(b.value);break;case"percentage":m.t="n",m.v=parseFloat(b.value);break;case"currency":m.t="n",m.v=parseFloat(b.value);break;case"date":m.t="d",m.v=parseDate(b["date-value"]),t.cellDates||(m.t="n",m.v=datenum(m.v)),m.z="m/d/yy";break;case"time":m.t="n",m.v=parse_isodur(b["time-value"])/86400,t.cellDates&&(m.t="d",m.v=numdate(m.v)),m.z="HH:MM:SS";break;case"number":m.t="n",m.v=parseFloat(b.);break;default:if(m.t==="string"||m.t==="text"||!m.t)m.t="s",b["string-value"]!=null&&(D=unescapexml(b["string-value"]),F=[]);else throw new Error("Unsupported value type "+m.t)}}else{if(U=!1,m.t==="s"&&(m.v=D||"",F.length&&(m.R=F),U=C==0),ae.Target&&(m.l=ae),xe.length>0&&(m.c=xe,xe=[]),D&&t.cellText!==!1&&(m.w=D),U&&(m.t="z",delete m.v),(!U||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=T))for(var O=0;O<de;++O){if(Y=parseInt(b["number-columns-repeated"]||"1",10),t.dense)for(x[T+O]||(x[T+O]=[]),x[T+O][w]=O==0?m:dup(m);--Y>0;)x[T+O][w+Y]=dup(m);else for(x[encode_cell({r:T+O,c:w})]=m;--Y>0;)x[encode_cell({r:T+O,c:w+Y})]=dup(m);y.e.c<=w&&(y.e.c=w)}Y=parseInt(b["number-columns-repeated"]||"1",10),w+=Y-1,Y=0,m={},D="",F=[]}ae={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((l=i.pop())[0]!==g[3])throw"Bad state: "+l}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((l=i.pop())[0]!==g[3])throw"Bad state: "+l;I.t=D,F.length&&(I.R=F),I.a=M,xe.push(I)}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);M="",R=0,D="",C=0,F=[];break;case"creator":g[1]==="/"?M=n.slice(R,g.index):R=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((l=i.pop())[0]!==g[3])throw"Bad state: "+l}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);D="",C=0,F=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(L[f.name]=d,(l=i.pop())[0]!==g[3])throw"Bad state: "+l}else g[0].charAt(g[0].length-2)!=="/"&&(d="",f=parsexmltag(g[0],!1),i.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":c=parsexmltag(g[0],!1),d+=number_formats_ods[g[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":c=parsexmltag(g[0],!1),d+=number_formats_ods[g[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":d+=n.slice(h,g.index);break}else h=g.index+g[0].length;break;case"named-range":c=parsexmltag(g[0],!1),W=ods_to_csf_3D(c["cell-range-address"]);var B={Name:c.name,Ref:W[0]+"!"+W[1]};V&&(B.Sheet=S.length),fe.Names.push(B);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(g[1]==="/"&&(!b||!b["string-value"])){var G=parse_text_p(n.slice(C,g.index));D=(D.length>0?D+`
`:"")+G[0]}else parsexmltag(g[0],!1),C=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{W=ods_to_csf_3D(parsexmltag(g[0])["target-range-address"]),v[W[0]]["!autofilter"]={ref:W[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(ae=parsexmltag(g[0],!1),!ae.href)break;ae.Target=unescapexml(ae.href),delete ae.href,ae.Target.charAt(0)=="#"&&ae.Target.indexOf(".")>-1?(W=ods_to_csf_3D(ae.Target.slice(1)),ae.Target="#"+W[0]+"!"+W[1]):ae.Target.match(/^\.\.[\\\/]/)&&(ae.Target=ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(g)}}var P={Sheets:v,SheetNames:S,Workbook:fe};return t.bookSheets&&delete P.Sheets,P}function parse_ods(e,r){r=r||{},safegetzipfile(e,"META-INF/manifest.xml")&&parse_manifest(getzipdata(e,"META-INF/manifest.xml"),r);var t=getzipstr(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=parse_content_xml(utf8read(t),r);return safegetzipfile(e,"meta.xml")&&(n.Props=parse_core_props(getzipdata(e,"meta.xml"))),n}function parse_fods(e,r){return parse_content_xml(e,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function u8_to_dataview(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function u8str(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):utf8read(a2s(e))}function u8concat(e){var r=e.reduce(function(i,l){return i+l.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(i){t.set(i,n),n+=i.length}),t}function popcnt(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function readDecimal128LE(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,i=r+13;i>=r;--i)n=n*256+e[i];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function parse_varint49(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function varint_to_i32(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function parse_shallow(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],i=parse_varint49(e,t),l=i&7;i=Math.floor(i/8);var c=0,f;if(i==0)break;switch(l){case 0:{for(var d=t[0];e[t[0]++]>=128;);f=e.slice(d,t[0])}break;case 5:c=4,f=e.slice(t[0],t[0]+c),t[0]+=c;break;case 1:c=8,f=e.slice(t[0],t[0]+c),t[0]+=c;break;case 2:c=parse_varint49(e,t),f=e.slice(t[0],t[0]+c),t[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(i," at offset ").concat(n))}var h={data:f,type:l};r[i]==null?r[i]=[h]:r[i].push(h)}return r}function mappa(e,r){return(e==null?void 0:e.map(function(t){return r(t.data)}))||[]}function parse_iwa_file(e){for(var r,t=[],n=[0];n[0]<e.length;){var i=parse_varint49(e,n),l=parse_shallow(e.slice(n[0],n[0]+i));n[0]+=i;var c={id:varint_to_i32(l[1][0].data),messages:[]};l[2].forEach(function(f){var d=parse_shallow(f.data),h=varint_to_i32(d[3][0].data);c.messages.push({meta:d,data:e.slice(n[0],n[0]+h)}),n[0]+=h}),(r=l[3])!=null&&r[0]&&(c.merge=varint_to_i32(l[3][0].data)>>>0>0),t.push(c)}return t}function parse_snappy_chunk(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=parse_varint49(r,t),i=[];t[0]<r.length;){var l=r[t[0]]&3;if(l==0){var c=r[t[0]++]>>2;if(c<60)++c;else{var f=c-59;c=r[t[0]],f>1&&(c|=r[t[0]+1]<<8),f>2&&(c|=r[t[0]+2]<<16),f>3&&(c|=r[t[0]+3]<<24),c>>>=0,c++,t[0]+=f}i.push(r.slice(t[0],t[0]+c)),t[0]+=c;continue}else{var d=0,h=0;if(l==1?(h=(r[t[0]]>>2&7)+4,d=(r[t[0]++]&224)<<3,d|=r[t[0]++]):(h=(r[t[0]++]>>2)+1,l==2?(d=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(d=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),i=[u8concat(i)],d==0)throw new Error("Invalid offset 0");if(d>i[0].length)throw new Error("Invalid offset beyond length");if(h>=d)for(i.push(i[0].slice(-d)),h-=d;h>=i[i.length-1].length;)i.push(i[i.length-1]),h-=i[i.length-1].length;i.push(i[0].slice(-d,-d+h))}}var p=u8concat(i);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function decompress_iwa_file(e){for(var r=[],t=0;t<e.length;){var n=e[t++],i=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(parse_snappy_chunk(n,e.slice(t,t+i))),t+=i}if(t!==e.length)throw new Error("data is not a valid framed stream!");return u8concat(r)}function parse_old_storage(e,r,t,n){var i=u8_to_dataview(e),l=i.getUint32(4,!0),c=(n>1?12:8)+popcnt(l&(n>1?3470:398))*4,f=-1,d=-1,h=NaN,p=new Date(2001,0,1);l&512&&(f=i.getUint32(c,!0),c+=4),c+=popcnt(l&(n>1?12288:4096))*4,l&16&&(d=i.getUint32(c,!0),c+=4),l&32&&(h=i.getFloat64(c,!0),c+=8),l&64&&(p.setTime(p.getTime()+i.getFloat64(c,!0)*1e3),c+=8);var E;switch(e[2]){case 0:break;case 2:E={t:"n",v:h};break;case 3:E={t:"s",v:r[d]};break;case 5:E={t:"d",v:p};break;case 6:E={t:"b",v:h>0};break;case 7:E={t:"n",v:h/86400};break;case 8:E={t:"e",v:0};break;case 9:if(f>-1)E={t:"s",v:t[f]};else if(d>-1)E={t:"s",v:r[d]};else if(!isNaN(h))E={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return E}function parse_new_storage(e,r,t){var n=u8_to_dataview(e),i=n.getUint32(8,!0),l=12,c=-1,f=-1,d=NaN,h=NaN,p=new Date(2001,0,1);i&1&&(d=readDecimal128LE(e,l),l+=16),i&2&&(h=n.getFloat64(l,!0),l+=8),i&4&&(p.setTime(p.getTime()+n.getFloat64(l,!0)*1e3),l+=8),i&8&&(f=n.getUint32(l,!0),l+=4),i&16&&(c=n.getUint32(l,!0),l+=4);var E;switch(e[1]){case 0:break;case 2:E={t:"n",v:d};break;case 3:E={t:"s",v:r[f]};break;case 5:E={t:"d",v:p};break;case 6:E={t:"b",v:h>0};break;case 7:E={t:"n",v:h/86400};break;case 8:E={t:"e",v:0};break;case 9:if(c>-1)E={t:"s",v:t[c]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:E={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return E}function parse_cell_storage(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return parse_old_storage(e,r,t,e[0]);case 5:return parse_new_storage(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function parse_TSP_Reference(e){var r=parse_shallow(e);return parse_varint49(r[1][0].data)}function parse_TST_TableDataList(e,r){var t=parse_shallow(r.data),n=varint_to_i32(t[1][0].data),i=t[3],l=[];return(i||[]).forEach(function(c){var f=parse_shallow(c.data),d=varint_to_i32(f[1][0].data)>>>0;switch(n){case 1:l[d]=u8str(f[3][0].data);break;case 8:{var h=e[parse_TSP_Reference(f[9][0].data)][0],p=parse_shallow(h.data),E=e[parse_TSP_Reference(p[1][0].data)][0],v=varint_to_i32(E.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var S=parse_shallow(E.data);l[d]=S[3].map(function(x){return u8str(x.data)}).join("")}break}}),l}function parse_TST_TileRowInfo(e,r){var t,n,i,l,c,f,d,h,p,E,v,S,x,g,m=parse_shallow(e),b=varint_to_i32(m[1][0].data)>>>0,D=varint_to_i32(m[2][0].data)>>>0,C=((n=(t=m[8])==null?void 0:t[0])==null?void 0:n.data)&&varint_to_i32(m[8][0].data)>0||!1,F,T;if((l=(i=m[7])==null?void 0:i[0])!=null&&l.data&&r!=0)F=(f=(c=m[7])==null?void 0:c[0])==null?void 0:f.data,T=(h=(d=m[6])==null?void 0:d[0])==null?void 0:h.data;else if((E=(p=m[4])==null?void 0:p[0])!=null&&E.data&&r!=1)F=(S=(v=m[4])==null?void 0:v[0])==null?void 0:S.data,T=(g=(x=m[3])==null?void 0:x[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var w=C?4:1,y=u8_to_dataview(F),N=[],L=0;L<F.length/2;++L){var X=y.getUint16(L*2,!0);X<65535&&N.push([L,X])}if(N.length!=D)throw"Expected ".concat(D," cells, found ").concat(N.length);var z=[];for(L=0;L<N.length-1;++L)z[N[L][0]]=T.subarray(N[L][1]*w,N[L+1][1]*w);return N.length>=1&&(z[N[N.length-1][0]]=T.subarray(N[N.length-1][1]*w)),{R:b,cells:z}}function parse_TST_Tile(e,r){var t,n=parse_shallow(r.data),i=(t=n==null?void 0:n[7])!=null&&t[0]?varint_to_i32(n[7][0].data)>>>0>0?1:0:-1,l=mappa(n[5],function(c){return parse_TST_TileRowInfo(c,i)});return{nrows:varint_to_i32(n[4][0].data)>>>0,data:l.reduce(function(c,f){return c[f.R]||(c[f.R]=[]),f.cells.forEach(function(d,h){if(c[f.R][h])throw new Error("Duplicate cell r=".concat(f.R," c=").concat(h));c[f.R][h]=d}),c},[])}}function parse_TST_TableModelArchive(e,r,t){var n,i=parse_shallow(r.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(varint_to_i32(i[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(l.e.c=(varint_to_i32(i[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));t["!ref"]=encode_range(l);var c=parse_shallow(i[4][0].data),f=parse_TST_TableDataList(e,e[parse_TSP_Reference(c[4][0].data)][0]),d=(n=c[17])!=null&&n[0]?parse_TST_TableDataList(e,e[parse_TSP_Reference(c[17][0].data)][0]):[],h=parse_shallow(c[3][0].data),p=0;h[1].forEach(function(E){var v=parse_shallow(E.data),S=e[parse_TSP_Reference(v[2][0].data)][0],x=varint_to_i32(S.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var g=parse_TST_Tile(e,S);g.data.forEach(function(m,b){m.forEach(function(D,C){var F=encode_cell({r:p+b,c:C}),T=parse_cell_storage(D,f,d);T&&(t[F]=T)})}),p+=g.nrows})}function parse_TST_TableInfoArchive(e,r){var t=parse_shallow(r.data),n={"!ref":"A1"},i=e[parse_TSP_Reference(t[2][0].data)],l=varint_to_i32(i[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return parse_TST_TableModelArchive(e,i[0],n),n}function parse_TN_SheetArchive(e,r){var t,n=parse_shallow(r.data),i={name:(t=n[1])!=null&&t[0]?u8str(n[1][0].data):"",sheets:[]},l=mappa(n[2],parse_TSP_Reference);return l.forEach(function(c){e[c].forEach(function(f){var d=varint_to_i32(f.meta[1][0].data);d==6e3&&i.sheets.push(parse_TST_TableInfoArchive(e,f))})}),i}function parse_TN_DocumentArchive(e,r){var t=book_new(),n=parse_shallow(r.data),i=mappa(n[1],parse_TSP_Reference);if(i.forEach(function(l){e[l].forEach(function(c){var f=varint_to_i32(c.meta[1][0].data);if(f==2){var d=parse_TN_SheetArchive(e,c);d.sheets.forEach(function(h,p){book_append_sheet(t,h,p==0?d.name:d.name+"_"+p,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function parse_numbers_iwa(e){var r,t,n,i,l={},c=[];if(e.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var h;try{h=decompress_iwa_file(d.content)}catch(E){return console.log("?? "+d.content.length+" "+(E.message||E))}var p;try{p=parse_iwa_file(h)}catch(E){return console.log("## "+(E.message||E))}p.forEach(function(E){l[E.id]=E.messages,c.push(E.id)})}}),!c.length)throw new Error("File has no messages");var f=((i=(n=(t=(r=l==null?void 0:l[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&varint_to_i32(l[1][0].meta[1][0].data)==1&&l[1][0];if(f||c.forEach(function(d){l[d].forEach(function(h){var p=varint_to_i32(h.meta[1][0].data)>>>0;if(p==1)if(!f)f=h;else throw new Error("Document has multiple roots")})}),!f)throw new Error("Cannot find Document root");return parse_TN_DocumentArchive(l,f)}function fix_opts_func(e){return function(t){for(var n=0;n!=e.length;++n){var i=e[n];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function fix_read_opts(e){fix_opts_func([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function get_sheet_type(e){return RELS.WS.indexOf(e)>-1?"sheet":e==RELS.CS?"chart":e==RELS.DS?"dialog":e==RELS.MS?"macro":e&&e.length?e:"sheet"}function safe_parse_wbrels(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,get_sheet_type(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function safe_parse_sheet(e,r,t,n,i,l,c,f,d,h,p,E){try{l[n]=parse_rels(getzipstr(e,t,!0),r);var v=getzipdata(e,r),S;switch(f){case"sheet":S=parse_ws(v,r,i,d,l[n],h,p,E);break;case"chart":if(S=parse_cs(v,r,i,d,l[n],h,p,E),!S||!S["!drawel"])break;var x=resolve_path(S["!drawel"].Target,r),g=get_rels_path(x),m=parse_drawing(getzipstr(e,x,!0),parse_rels(getzipstr(e,g,!0),x)),b=resolve_path(m,x),D=get_rels_path(b);S=parse_chart(getzipstr(e,b,!0),b,d,parse_rels(getzipstr(e,D,!0),b),h,S);break;case"macro":S=parse_ms(v,r,i,d,l[n],h,p,E);break;case"dialog":S=parse_ds(v,r,i,d,l[n],h,p,E);break;default:throw new Error("Unrecognized sheet type "+f)}c[n]=S;var C=[];l&&l[n]&&keys(l[n]).forEach(function(F){var T="";if(l[n][F].Type==RELS.CMNT){T=resolve_path(l[n][F].Target,r);var w=parse_cmnt(getzipdata(e,T,!0),T,d);if(!w||!w.length)return;sheet_insert_comments(S,w,!1)}l[n][F].Type==RELS.TCMNT&&(T=resolve_path(l[n][F].Target,r),C=C.concat(parse_tcmnt_xml(getzipdata(e,T,!0),d)))}),C&&C.length&&sheet_insert_comments(S,C,!0,d.people||[])}catch(F){if(d.WTF)throw F}}function strip_front_slash(e){return e.charAt(0)=="/"?e.slice(1):e}function parse_zip(e,r){if(make_ssf(),r=r||{},fix_read_opts(r),safegetzipfile(e,"META-INF/manifest.xml")||safegetzipfile(e,"objectdata.xml"))return parse_ods(e,r);if(safegetzipfile(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof parse_numbers_iwa<"u"){if(e.FileIndex)return parse_numbers_iwa(e);var t=CFB.utils.cfb_new();return zipentries(e).forEach(function(_e){zip_add_file(t,_e,getzipbin(e,_e))}),parse_numbers_iwa(t)}throw new Error("Unsupported NUMBERS file")}if(!safegetzipfile(e,"[Content_Types].xml"))throw safegetzipfile(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):safegetzipfile(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=zipentries(e),i=parse_ct(getzipstr(e,"[Content_Types].xml")),l=!1,c,f;if(i.workbooks.length===0&&(f="xl/workbook.xml",getzipdata(e,f,!0)&&i.workbooks.push(f)),i.workbooks.length===0){if(f="xl/workbook.bin",!getzipdata(e,f,!0))throw new Error("Could not find workbook");i.workbooks.push(f),l=!0}i.workbooks[0].slice(-3)=="bin"&&(l=!0);var d={},h={};if(!r.bookSheets&&!r.bookProps){if(strs=[],i.sst)try{strs=parse_sst(getzipdata(e,strip_front_slash(i.sst)),i.sst,r)}catch(_e){if(r.WTF)throw _e}r.cellStyles&&i.themes.length&&(d=parse_theme(getzipstr(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],r)),i.style&&(h=parse_sty(getzipdata(e,strip_front_slash(i.style)),i.style,d,r))}i.links.map(function(_e){try{var de=parse_rels(getzipstr(e,get_rels_path(strip_front_slash(_e))),_e);return parse_xlink(getzipdata(e,strip_front_slash(_e)),de,_e,r)}catch{}});var p=parse_wb(getzipdata(e,strip_front_slash(i.workbooks[0])),i.workbooks[0],r),E={},v="";i.coreprops.length&&(v=getzipdata(e,strip_front_slash(i.coreprops[0]),!0),v&&(E=parse_core_props(v)),i.extprops.length!==0&&(v=getzipdata(e,strip_front_slash(i.extprops[0]),!0),v&&parse_ext_props(v,E,r)));var S={};(!r.bookSheets||r.bookProps)&&i.custprops.length!==0&&(v=getzipstr(e,strip_front_slash(i.custprops[0]),!0),v&&(S=parse_cust_props(v,r)));var x={};if((r.bookSheets||r.bookProps)&&(p.Sheets?c=p.Sheets.map(function(de){return de.name}):E.Worksheets&&E.SheetNames.length>0&&(c=E.SheetNames),r.bookProps&&(x.Props=E,x.Custprops=S),r.bookSheets&&typeof c<"u"&&(x.SheetNames=c),r.bookSheets?x.SheetNames:r.bookProps))return x;c={};var g={};r.bookDeps&&i.calcchain&&(g=parse_cc(getzipdata(e,strip_front_slash(i.calcchain)),i.calcchain));var m=0,b={},D,C;{var F=p.Sheets;E.Worksheets=F.length,E.SheetNames=[];for(var T=0;T!=F.length;++T)E.SheetNames[T]=F[T].name}var w=l?"bin":"xml",y=i.workbooks[0].lastIndexOf("/"),N=(i.workbooks[0].slice(0,y+1)+"_rels/"+i.workbooks[0].slice(y+1)+".rels").replace(/^\//,"");safegetzipfile(e,N)||(N="xl/_rels/workbook."+w+".rels");var L=parse_rels(getzipstr(e,N,!0),N.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(r.xlmeta=parse_xlmeta(getzipdata(e,strip_front_slash(i.metadata[0])),i.metadata[0],r)),(i.people||[]).length>=1&&(r.people=parse_people_xml(getzipdata(e,strip_front_slash(i.people[0])),r)),L&&(L=safe_parse_wbrels(L,p.Sheets));var X=getzipdata(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(m=0;m!=E.Worksheets;++m){var z="sheet";if(L&&L[m]?(D="xl/"+L[m][1].replace(/[\/]?xl\//,""),safegetzipfile(e,D)||(D=L[m][1]),safegetzipfile(e,D)||(D=N.replace(/_rels\/.*$/,"")+L[m][1]),z=L[m][2]):(D="xl/worksheets/sheet"+(m+1-X)+"."+w,D=D.replace(/sheet0\./,"sheet.")),C=D.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(m!=r.sheets)continue e;break;case"string":if(E.SheetNames[m].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var se=!1,me=0;me!=r.sheets.length;++me)typeof r.sheets[me]=="number"&&r.sheets[me]==m&&(se=1),typeof r.sheets[me]=="string"&&r.sheets[me].toLowerCase()==E.SheetNames[m].toLowerCase()&&(se=1);if(!se)continue e}}safe_parse_sheet(e,D,C,E.SheetNames[m],m,b,c,z,r,p,d,h)}return x={Directory:i,Workbook:p,Props:E,Custprops:S,Deps:g,Sheets:c,SheetNames:E.SheetNames,Strings:strs,Styles:h,Themes:d,SSF:dup(table_fmt)},r&&r.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(_e,de){_e=_e.replace(/^Root Entry[\/]/,""),x.keys.push(_e),x.files[_e]=e.FileIndex[de]}))),r&&r.bookVBA&&(i.vba.length>0?x.vbaraw=getzipdata(e,strip_front_slash(i.vba[0]),!0):i.defaults&&i.defaults.bin===CT_VBA&&(x.vbaraw=getzipdata(e,"xl/vbaProject.bin",!0))),x}function parse_xlsxcfb(e,r){var t=r||{},n="Workbook",i=CFB.find(e,n);try{if(n="/!DataSpaces/Version",i=CFB.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(parse_DataSpaceVersionInfo(i.content),n="/!DataSpaces/DataSpaceMap",i=CFB.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=parse_DataSpaceMap(i.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=CFB.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=parse_DataSpaceDefinition(i.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=CFB.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);parse_Primary(i.content)}catch{}if(n="/EncryptionInfo",i=CFB.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var f=parse_EncryptionInfo(i.content);if(n="/EncryptedPackage",i=CFB.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(f[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(f[1],i.content,t.password||"",t);if(f[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(f[1],i.content,t.password||"",t);throw new Error("File is password-protected")}function firstbyte(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Base64_decode(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function read_cfb(e,r){return CFB.find(e,"EncryptedPackage")?parse_xlsxcfb(e,r):parse_xlscfb(e,r)}function read_zip(e,r){var t,n=e,i=r||{};return i.type||(i.type=has_buf&&Buffer.isBuffer(e)?"buffer":"base64"),t=zip_read(n,i),parse_zip(t,i)}function read_plaintext(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return parse_xlml(e.slice(t),r);default:break e}return PRN.to_workbook(e,r)}function read_plaintext_raw(e,r){var t="",n=firstbyte(e,r);switch(r.type){case"base64":t=Base64_decode(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=cc2str(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=utf8read(t)),r.type="binary",read_plaintext(t,r)}function read_utf16(e,r){var t=e;return r.type=="base64"&&(t=Base64_decode(t)),t=$cptable.utils.decode(1200,t.slice(2),"str"),r.type="binary",read_plaintext(t,r)}function bstrify(e){return e.match(/[^\x00-\x7F]/)?utf8write(e):e}function read_prn(e,r,t,n){return n?(t.type="string",PRN.to_workbook(e,t)):PRN.to_workbook(r,t)}function readSync(e,r){reset_cp();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return readSync(new Uint8Array(e),(t=dup(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],l=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),_ssfopts={},t.dateNF&&(_ssfopts.dateNF=t.dateNF),t.type||(t.type=has_buf&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=has_buf?"buffer":"binary",n=read_binary(e),typeof Uint8Array<"u"&&!has_buf&&(t.type="array")),t.type=="string"&&(l=!0,t.type="binary",t.codepage=65001,n=bstrify(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),f=new Uint8Array(c);if(f.foo="bar",!f.foo)return t=dup(t),t.type="array",readSync(ab2a(n),t)}switch((i=firstbyte(n,t))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return read_cfb(CFB.read(n,t),t);break;case 9:if(i[1]<=8)return parse_xlscfb(n,t);break;case 60:return parse_xlml(n,t);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return read_wb_ID(n,t);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return DIF.to_workbook(n,t);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?read_zip(n,t):read_prn(e,n,t,l);case 239:return i[3]===60?parse_xlml(n,t):read_prn(e,n,t,l);case 255:if(i[1]===254)return read_utf16(n,t);if(i[1]===0&&i[2]===2&&i[3]===0)return WK_.to_workbook(n,t);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return WK_.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return DBF.to_workbook(n,t);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return RTF.to_workbook(n,t);break;case 10:case 13:case 32:return read_plaintext_raw(n,t);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return DBF_SUPPORTED_VERSIONS.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?DBF.to_workbook(n,t):read_prn(e,n,t,l)}function make_json_row(e,r,t,n,i,l,c,f){var d=encode_row(t),h=f.defval,p=f.raw||!Object.prototype.hasOwnProperty.call(f,"raw"),E=!0,v=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:t,enumerable:!1})}catch{v.__rowNum__=t}else v.__rowNum__=t;if(!c||e[t])for(var S=r.s.c;S<=r.e.c;++S){var x=c?e[t][S]:e[n[S]+d];if(x===void 0||x.t===void 0){if(h===void 0)continue;l[S]!=null&&(v[l[S]]=h);continue}var g=x.v;switch(x.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(l[S]!=null){if(g==null)if(x.t=="e"&&g===null)v[l[S]]=null;else if(h!==void 0)v[l[S]]=h;else if(p&&g===null)v[l[S]]=null;else continue;else v[l[S]]=p&&(x.t!=="n"||x.t==="n"&&f.rawNumbers!==!1)?g:format_cell(x,g,f);g!=null&&(E=!1)}}return{row:v,isempty:E}}function sheet_to_json(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,i=1,l=[],c=0,f="",d={s:{r:0,c:0},e:{r:0,c:0}},h=r||{},p=h.range!=null?h.range:e["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof p){case"string":d=safe_decode_range(p);break;case"number":d=safe_decode_range(e["!ref"]),d.s.r=p;break;default:d=p}n>0&&(i=0);var E=encode_row(d.s.r),v=[],S=[],x=0,g=0,m=Array.isArray(e),b=d.s.r,D=0,C={};m&&!e[b]&&(e[b]=[]);var F=h.skipHidden&&e["!cols"]||[],T=h.skipHidden&&e["!rows"]||[];for(D=d.s.c;D<=d.e.c;++D)if(!(F[D]||{}).hidden)switch(v[D]=encode_col(D),t=m?e[b][D]:e[v[D]+E],n){case 1:l[D]=D-d.s.c;break;case 2:l[D]=v[D];break;case 3:l[D]=h.header[D-d.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),f=c=format_cell(t,null,h),g=C[c]||0,!g)C[c]=1;else{do f=c+"_"+g++;while(C[f]);C[c]=g,C[f]=1}l[D]=f}for(b=d.s.r+i;b<=d.e.r;++b)if(!(T[b]||{}).hidden){var w=make_json_row(e,d,b,v,n,l,m,h);(w.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(S[x++]=w.row)}return S.length=x,S}var qreg=/"/g;function make_csv_row(e,r,t,n,i,l,c,f){for(var d=!0,h=[],p="",E=encode_row(t),v=r.s.c;v<=r.e.c;++v)if(n[v]){var S=f.dense?(e[t]||[])[v]:e[n[v]+E];if(S==null)p="";else if(S.v!=null){d=!1,p=""+(f.rawNumbers&&S.t=="n"?S.v:format_cell(S,null,f));for(var x=0,g=0;x!==p.length;++x)if((g=p.charCodeAt(x))===i||g===l||g===34||f.forceQuotes){p='"'+p.replace(qreg,'""')+'"';break}p=="ID"&&(p='"ID"')}else S.f!=null&&!S.F?(d=!1,p="="+S.f,p.indexOf(",")>=0&&(p='"'+p.replace(qreg,'""')+'"')):p="";h.push(p)}return f.blankrows===!1&&d?null:h.join(c)}function sheet_to_csv(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var i=safe_decode_range(e["!ref"]),l=n.FS!==void 0?n.FS:",",c=l.charCodeAt(0),f=n.RS!==void 0?n.RS:`
`,d=f.charCodeAt(0),h=new RegExp((l=="|"?"\\|":l)+"+$"),p="",E=[];n.dense=Array.isArray(e);for(var v=n.skipHidden&&e["!cols"]||[],S=n.skipHidden&&e["!rows"]||[],x=i.s.c;x<=i.e.c;++x)(v[x]||{}).hidden||(E[x]=encode_col(x));for(var g=0,m=i.s.r;m<=i.e.r;++m)(S[m]||{}).hidden||(p=make_csv_row(e,i,m,E,c,d,l,n),p!=null&&(n.strip&&(p=p.replace(h,"")),(p||n.blankrows!==!1)&&t.push((g++?f:"")+p)));return delete n.dense,t.join("")}function sheet_to_txt(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=sheet_to_csv(e,r);return t}function sheet_to_formulae(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var i=safe_decode_range(e["!ref"]),l="",c=[],f,d=[],h=Array.isArray(e);for(f=i.s.c;f<=i.e.c;++f)c[f]=encode_col(f);for(var p=i.s.r;p<=i.e.r;++p)for(l=encode_row(p),f=i.s.c;f<=i.e.c;++f)if(r=c[f]+l,t=h?(e[p]||[])[f]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}d[d.length]=r+"="+n}return d}function sheet_add_json(e,r,t){var n=t||{},i=+!n.skipHeader,l=e||{},c=0,f=0;if(n.origin!=null)if(typeof n.origin=="number")c=n.origin;else{var d=typeof n.origin=="string"?decode_cell(n.origin):n.origin;c=d.r,f=d.c}var h,p={s:{c:0,r:0},e:{c:f,r:c+r.length-1+i}};if(l["!ref"]){var E=safe_decode_range(l["!ref"]);p.e.c=Math.max(p.e.c,E.e.c),p.e.r=Math.max(p.e.r,E.e.r),c==-1&&(c=E.e.r+1,p.e.r=c+r.length-1+i)}else c==-1&&(c=0,p.e.r=r.length-1+i);var v=n.header||[],S=0;r.forEach(function(g,m){keys(g).forEach(function(b){(S=v.indexOf(b))==-1&&(v[S=v.length]=b);var D=g[b],C="z",F="",T=encode_cell({c:f+S,r:c+m+i});h=ws_get_cell_stub(l,T),D&&typeof D=="object"&&!(D instanceof Date)?l[T]=D:(typeof D=="number"?C="n":typeof D=="boolean"?C="b":typeof D=="string"?C="s":D instanceof Date?(C="d",n.cellDates||(C="n",D=datenum(D)),F=n.dateNF||table_fmt[14]):D===null&&n.nullError&&(C="e",D=0),h?(h.t=C,h.v=D,delete h.w,delete h.R,F&&(h.z=F)):l[T]=h={t:C,v:D},F&&(h.z=F))})}),p.e.c=Math.max(p.e.c,f+v.length-1);var x=encode_row(c);if(i)for(S=0;S<v.length;++S)l[encode_col(S+f)+x]={t:"s",v:v[S]};return l["!ref"]=encode_range(p),l}function json_to_sheet(e,r){return sheet_add_json(null,e,r)}function ws_get_cell_stub(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=decode_cell(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?ws_get_cell_stub(e,encode_cell(r)):ws_get_cell_stub(e,encode_cell({r,c:t||0}))}function wb_sheet_idx(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function book_new(){return{SheetNames:[],Sheets:{}}}function book_append_sheet(e,r,t,n){var i=1;if(!t)for(;i<=65535&&e.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var l=t.match(/(^.*?)(\d+)$/);i=l&&+l[2]||0;var c=l&&l[1]||t;for(++i;i<=65535&&e.SheetNames.indexOf(t=c+i)!=-1;++i);}if(check_ws_name(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function book_set_sheet_visibility(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=wb_sheet_idx(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function cell_set_number_format(e,r){return e.z=r,e}function cell_set_hyperlink(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function cell_set_internal_link(e,r,t){return cell_set_hyperlink(e,"#"+r,t)}function cell_add_comment(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function sheet_set_array_formula(e,r,t,n){for(var i=typeof r!="string"?r:safe_decode_range(r),l=typeof r=="string"?r:encode_range(r),c=i.s.r;c<=i.e.r;++c)for(var f=i.s.c;f<=i.e.c;++f){var d=ws_get_cell_stub(e,c,f);d.t="n",d.F=l,delete d.v,c==i.s.r&&f==i.s.c&&(d.f=t,n&&(d.D=!0))}return e}var utils={encode_col,encode_row,encode_cell,encode_range,decode_col,decode_row,split_cell,decode_cell,decode_range,format_cell,sheet_add_aoa,sheet_add_json,sheet_add_dom,aoa_to_sheet,json_to_sheet,table_to_sheet:parse_dom_table,table_to_book,sheet_to_csv,sheet_to_txt,sheet_to_json,sheet_to_html,sheet_to_formulae,sheet_to_row_object_array:sheet_to_json,sheet_get_cell:ws_get_cell_stub,book_new,book_append_sheet,book_set_sheet_visibility,cell_set_number_format,cell_set_hyperlink,cell_set_internal_link,cell_add_comment,sheet_set_array_formula,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,function(module,exports){(function(r,t){module.exports=t()})(globalThis,()=>(()=>{var __webpack_modules__=[,(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.VerbosityLevel=r.Util=r.UnknownErrorException=r.UnexpectedResponseException=r.UNSUPPORTED_FEATURES=r.TextRenderingMode=r.StreamType=r.RenderingIntentFlag=r.PermissionFlag=r.PasswordResponses=r.PasswordException=r.PageActionEventType=r.OPS=r.MissingPDFException=r.LINE_FACTOR=r.LINE_DESCENT_FACTOR=r.InvalidPDFException=r.ImageKind=r.IDENTITY_MATRIX=r.FormatError=r.FontType=r.FeatureTest=r.FONT_IDENTITY_MATRIX=r.DocumentActionEventType=r.CMapCompressionType=r.BaseException=r.AnnotationType=r.AnnotationStateModelType=r.AnnotationReviewState=r.AnnotationReplyType=r.AnnotationMode=r.AnnotationMarkedState=r.AnnotationFlag=r.AnnotationFieldFlag=r.AnnotationEditorType=r.AnnotationEditorPrefix=r.AnnotationEditorParamsType=r.AnnotationBorderStyleType=r.AnnotationActionEventType=r.AbortException=void 0,r.arrayByteLength=Q,r.arraysToBytes=be,r.assert=M,r.bytesToString=re,r.createPromiseCapability=Mt,r.createValidAbsoluteUrl=U,r.escapeString=ht,r.getModificationDate=Yt,r.getVerbosityLevel=ae,r.info=W,r.isArrayBuffer=ct,r.isArrayEqual=lr,r.isAscii=Qe,r.objectFromMap=we,r.objectSize=ye,r.setVerbosityLevel=fe,r.shadow=V,r.string32=ge,r.stringToBytes=H,r.stringToPDFString=et,r.stringToUTF16BEString=it,r.stringToUTF8String=pt,r.unreachable=I,r.utf8StringToString=st,r.warn=xe,t(2);const n=[1,0,0,1,0,0];r.IDENTITY_MATRIX=n;const i=[.001,0,0,.001,0,0];r.FONT_IDENTITY_MATRIX=i;const l=1.35;r.LINE_FACTOR=l;const c=.35;r.LINE_DESCENT_FACTOR=c;const f={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};r.RenderingIntentFlag=f;const d={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};r.AnnotationMode=d;const h="pdfjs_internal_editor_";r.AnnotationEditorPrefix=h;const p={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};r.AnnotationEditorType=p;const E={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};r.AnnotationEditorParamsType=E;const v={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};r.PermissionFlag=v;const S={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};r.TextRenderingMode=S;const x={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};r.ImageKind=x;const g={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};r.AnnotationType=g;const m={MARKED:"Marked",REVIEW:"Review"};r.AnnotationStateModelType=m;const b={MARKED:"Marked",UNMARKED:"Unmarked"};r.AnnotationMarkedState=b;const D={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};r.AnnotationReviewState=D;const C={GROUP:"Group",REPLY:"R"};r.AnnotationReplyType=C;const F={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};r.AnnotationFlag=F;const T={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};r.AnnotationFieldFlag=T;const w={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};r.AnnotationBorderStyleType=w;const y={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};r.AnnotationActionEventType=y;const N={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};r.DocumentActionEventType=N;const L={O:"PageOpen",C:"PageClose"};r.PageActionEventType=L;const X={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};r.StreamType=X;const z={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};r.FontType=z;const se={ERRORS:0,WARNINGS:1,INFOS:5};r.VerbosityLevel=se;const me={NONE:0,BINARY:1,STREAM:2};r.CMapCompressionType=me;const _e={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};r.OPS=_e;const de={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};r.UNSUPPORTED_FEATURES=de;const Y={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};r.PasswordResponses=Y;let ie=se.WARNINGS;function fe(Me){Number.isInteger(Me)&&(ie=Me)}function ae(){return ie}function W(Me){ie>=se.INFOS&&console.log(`Info: ${Me}`)}function xe(Me){ie>=se.WARNINGS&&console.log(`Warning: ${Me}`)}function I(Me){throw new Error(Me)}function M(Me,Se){Me||I(Se)}function R(Me){if(!Me)return!1;switch(Me.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function U(Me,Se=null,Ae=null){if(!Me)return null;try{if(Ae&&typeof Me=="string"){if(Ae.addDefaultProtocol&&Me.startsWith("www.")){const lt=Me.match(/\./g);lt&&lt.length>=2&&(Me=`http://${Me}`)}if(Ae.tryConvertEncoding)try{Me=pt(Me)}catch{}}const Ye=Se?new URL(Me,Se):new URL(Me);if(R(Ye))return Ye}catch{}return null}function V(Me,Se,Ae){return Object.defineProperty(Me,Se,{value:Ae,enumerable:!0,configurable:!0,writable:!1}),Ae}const Z=function(){function Se(Ae,Ye){this.constructor===Se&&I("Cannot initialize BaseException."),this.message=Ae,this.name=Ye}return Se.prototype=new Error,Se.constructor=Se,Se}();r.BaseException=Z;class J extends Z{constructor(Se,Ae){super(Se,"PasswordException"),this.code=Ae}}r.PasswordException=J;class O extends Z{constructor(Se,Ae){super(Se,"UnknownErrorException"),this.details=Ae}}r.UnknownErrorException=O;class B extends Z{constructor(Se){super(Se,"InvalidPDFException")}}r.InvalidPDFException=B;class G extends Z{constructor(Se){super(Se,"MissingPDFException")}}r.MissingPDFException=G;class P extends Z{constructor(Se,Ae){super(Se,"UnexpectedResponseException"),this.status=Ae}}r.UnexpectedResponseException=P;class K extends Z{constructor(Se){super(Se,"FormatError")}}r.FormatError=K;class oe extends Z{constructor(Se){super(Se,"AbortException")}}r.AbortException=oe;function re(Me){(typeof Me!="object"||Me===null||Me.length===void 0)&&I("Invalid argument for bytesToString");const Se=Me.length,Ae=8192;if(Se<Ae)return String.fromCharCode.apply(null,Me);const Ye=[];for(let lt=0;lt<Se;lt+=Ae){const gt=Math.min(lt+Ae,Se),yt=Me.subarray(lt,gt);Ye.push(String.fromCharCode.apply(null,yt))}return Ye.join("")}function H(Me){typeof Me!="string"&&I("Invalid argument for stringToBytes");const Se=Me.length,Ae=new Uint8Array(Se);for(let Ye=0;Ye<Se;++Ye)Ae[Ye]=Me.charCodeAt(Ye)&255;return Ae}function Q(Me){if(Me.length!==void 0)return Me.length;if(Me.byteLength!==void 0)return Me.byteLength;I("Invalid argument for arrayByteLength")}function be(Me){const Se=Me.length;if(Se===1&&Me[0]instanceof Uint8Array)return Me[0];let Ae=0;for(let gt=0;gt<Se;gt++)Ae+=Q(Me[gt]);let Ye=0;const lt=new Uint8Array(Ae);for(let gt=0;gt<Se;gt++){let yt=Me[gt];yt instanceof Uint8Array||(typeof yt=="string"?yt=H(yt):yt=new Uint8Array(yt));const Zt=yt.byteLength;lt.set(yt,Ye),Ye+=Zt}return lt}function ge(Me){return String.fromCharCode(Me>>24&255,Me>>16&255,Me>>8&255,Me&255)}function ye(Me){return Object.keys(Me).length}function we(Me){const Se=Object.create(null);for(const[Ae,Ye]of Me)Se[Ae]=Ye;return Se}function Le(){const Me=new Uint8Array(4);return Me[0]=1,new Uint32Array(Me.buffer,0,1)[0]===1}function Ve(){try{return new Function(""),!0}catch{return!1}}class Ce{static get isLittleEndian(){return V(this,"isLittleEndian",Le())}static get isEvalSupported(){return V(this,"isEvalSupported",Ve())}static get isOffscreenCanvasSupported(){return V(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}}r.FeatureTest=Ce;const nt=[...Array(256).keys()].map(Me=>Me.toString(16).padStart(2,"0"));class tt{static makeHexColor(Se,Ae,Ye){return`#${nt[Se]}${nt[Ae]}${nt[Ye]}`}static scaleMinMax(Se,Ae){let Ye;Se[0]?(Se[0]<0&&(Ye=Ae[0],Ae[0]=Ae[1],Ae[1]=Ye),Ae[0]*=Se[0],Ae[1]*=Se[0],Se[3]<0&&(Ye=Ae[2],Ae[2]=Ae[3],Ae[3]=Ye),Ae[2]*=Se[3],Ae[3]*=Se[3]):(Ye=Ae[0],Ae[0]=Ae[2],Ae[2]=Ye,Ye=Ae[1],Ae[1]=Ae[3],Ae[3]=Ye,Se[1]<0&&(Ye=Ae[2],Ae[2]=Ae[3],Ae[3]=Ye),Ae[2]*=Se[1],Ae[3]*=Se[1],Se[2]<0&&(Ye=Ae[0],Ae[0]=Ae[1],Ae[1]=Ye),Ae[0]*=Se[2],Ae[1]*=Se[2]),Ae[0]+=Se[4],Ae[1]+=Se[4],Ae[2]+=Se[5],Ae[3]+=Se[5]}static transform(Se,Ae){return[Se[0]*Ae[0]+Se[2]*Ae[1],Se[1]*Ae[0]+Se[3]*Ae[1],Se[0]*Ae[2]+Se[2]*Ae[3],Se[1]*Ae[2]+Se[3]*Ae[3],Se[0]*Ae[4]+Se[2]*Ae[5]+Se[4],Se[1]*Ae[4]+Se[3]*Ae[5]+Se[5]]}static applyTransform(Se,Ae){const Ye=Se[0]*Ae[0]+Se[1]*Ae[2]+Ae[4],lt=Se[0]*Ae[1]+Se[1]*Ae[3]+Ae[5];return[Ye,lt]}static applyInverseTransform(Se,Ae){const Ye=Ae[0]*Ae[3]-Ae[1]*Ae[2],lt=(Se[0]*Ae[3]-Se[1]*Ae[2]+Ae[2]*Ae[5]-Ae[4]*Ae[3])/Ye,gt=(-Se[0]*Ae[1]+Se[1]*Ae[0]+Ae[4]*Ae[1]-Ae[5]*Ae[0])/Ye;return[lt,gt]}static getAxialAlignedBoundingBox(Se,Ae){const Ye=tt.applyTransform(Se,Ae),lt=tt.applyTransform(Se.slice(2,4),Ae),gt=tt.applyTransform([Se[0],Se[3]],Ae),yt=tt.applyTransform([Se[2],Se[1]],Ae);return[Math.min(Ye[0],lt[0],gt[0],yt[0]),Math.min(Ye[1],lt[1],gt[1],yt[1]),Math.max(Ye[0],lt[0],gt[0],yt[0]),Math.max(Ye[1],lt[1],gt[1],yt[1])]}static inverseTransform(Se){const Ae=Se[0]*Se[3]-Se[1]*Se[2];return[Se[3]/Ae,-Se[1]/Ae,-Se[2]/Ae,Se[0]/Ae,(Se[2]*Se[5]-Se[4]*Se[3])/Ae,(Se[4]*Se[1]-Se[5]*Se[0])/Ae]}static apply3dTransform(Se,Ae){return[Se[0]*Ae[0]+Se[1]*Ae[1]+Se[2]*Ae[2],Se[3]*Ae[0]+Se[4]*Ae[1]+Se[5]*Ae[2],Se[6]*Ae[0]+Se[7]*Ae[1]+Se[8]*Ae[2]]}static singularValueDecompose2dScale(Se){const Ae=[Se[0],Se[2],Se[1],Se[3]],Ye=Se[0]*Ae[0]+Se[1]*Ae[2],lt=Se[0]*Ae[1]+Se[1]*Ae[3],gt=Se[2]*Ae[0]+Se[3]*Ae[2],yt=Se[2]*Ae[1]+Se[3]*Ae[3],Zt=(Ye+yt)/2,Pr=Math.sqrt((Ye+yt)**2-4*(Ye*yt-gt*lt))/2,gr=Zt+Pr||1,Vt=Zt-Pr||1;return[Math.sqrt(gr),Math.sqrt(Vt)]}static normalizeRect(Se){const Ae=Se.slice(0);return Se[0]>Se[2]&&(Ae[0]=Se[2],Ae[2]=Se[0]),Se[1]>Se[3]&&(Ae[1]=Se[3],Ae[3]=Se[1]),Ae}static intersect(Se,Ae){const Ye=Math.max(Math.min(Se[0],Se[2]),Math.min(Ae[0],Ae[2])),lt=Math.min(Math.max(Se[0],Se[2]),Math.max(Ae[0],Ae[2]));if(Ye>lt)return null;const gt=Math.max(Math.min(Se[1],Se[3]),Math.min(Ae[1],Ae[3])),yt=Math.min(Math.max(Se[1],Se[3]),Math.max(Ae[1],Ae[3]));return gt>yt?null:[Ye,gt,lt,yt]}static bezierBoundingBox(Se,Ae,Ye,lt,gt,yt,Zt,Pr){const gr=[],Vt=[[],[]];let _r,er,sa,Ft,Hr,zr,ia,q;for(let ue=0;ue<2;++ue){if(ue===0?(er=6*Se-12*Ye+6*gt,_r=-3*Se+9*Ye-9*gt+3*Zt,sa=3*Ye-3*Se):(er=6*Ae-12*lt+6*yt,_r=-3*Ae+9*lt-9*yt+3*Pr,sa=3*lt-3*Ae),Math.abs(_r)<1e-12){if(Math.abs(er)<1e-12)continue;Ft=-sa/er,0<Ft&&Ft<1&&gr.push(Ft);continue}ia=er*er-4*sa*_r,q=Math.sqrt(ia),!(ia<0)&&(Hr=(-er+q)/(2*_r),0<Hr&&Hr<1&&gr.push(Hr),zr=(-er-q)/(2*_r),0<zr&&zr<1&&gr.push(zr))}let ce=gr.length,te;const ne=ce;for(;ce--;)Ft=gr[ce],te=1-Ft,Vt[0][ce]=te*te*te*Se+3*te*te*Ft*Ye+3*te*Ft*Ft*gt+Ft*Ft*Ft*Zt,Vt[1][ce]=te*te*te*Ae+3*te*te*Ft*lt+3*te*Ft*Ft*yt+Ft*Ft*Ft*Pr;return Vt[0][ne]=Se,Vt[1][ne]=Ae,Vt[0][ne+1]=Zt,Vt[1][ne+1]=Pr,Vt[0].length=Vt[1].length=ne+2,[Math.min(...Vt[0]),Math.min(...Vt[1]),Math.max(...Vt[0]),Math.max(...Vt[1])]}}r.Util=tt;const Je=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function et(Me){if(Me[0]>=""){let Ae;if(Me[0]===""&&Me[1]===""?Ae="utf-16be":Me[0]===""&&Me[1]===""?Ae="utf-16le":Me[0]===""&&Me[1]===""&&Me[2]===""&&(Ae="utf-8"),Ae)try{const Ye=new TextDecoder(Ae,{fatal:!0}),lt=H(Me);return Ye.decode(lt)}catch(Ye){xe(`stringToPDFString: "${Ye}".`)}}const Se=[];for(let Ae=0,Ye=Me.length;Ae<Ye;Ae++){const lt=Je[Me.charCodeAt(Ae)];Se.push(lt?String.fromCharCode(lt):Me.charAt(Ae))}return Se.join("")}function ht(Me){return Me.replace(/([()\\\n\r])/g,Se=>Se===`
`?"\\n":Se==="\r"?"\\r":`\\${Se}`)}function Qe(Me){return/^[\x00-\x7F]*$/.test(Me)}function it(Me){const Se=[""];for(let Ae=0,Ye=Me.length;Ae<Ye;Ae++){const lt=Me.charCodeAt(Ae);Se.push(String.fromCharCode(lt>>8&255),String.fromCharCode(lt&255))}return Se.join("")}function pt(Me){return decodeURIComponent(escape(Me))}function st(Me){return unescape(encodeURIComponent(Me))}function ct(Me){return typeof Me=="object"&&Me!==null&&Me.byteLength!==void 0}function lr(Me,Se){if(Me.length!==Se.length)return!1;for(let Ae=0,Ye=Me.length;Ae<Ye;Ae++)if(Me[Ae]!==Se[Ae])return!1;return!0}function Yt(Me=new Date){return[Me.getUTCFullYear().toString(),(Me.getUTCMonth()+1).toString().padStart(2,"0"),Me.getUTCDate().toString().padStart(2,"0"),Me.getUTCHours().toString().padStart(2,"0"),Me.getUTCMinutes().toString().padStart(2,"0"),Me.getUTCSeconds().toString().padStart(2,"0")].join("")}function Mt(){const Me=Object.create(null);let Se=!1;return Object.defineProperty(Me,"settled",{get(){return Se}}),Me.promise=new Promise(function(Ae,Ye){Me.resolve=function(lt){Se=!0,Ae(lt)},Me.reject=function(lt){Se=!0,Ye(lt)}}),Me}},(e,r,t)=>{t(3)},(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.isNodeJS=void 0;const t=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");r.isNodeJS=t},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var e,t,n,i,l,c,f,d,h,Ul,E,v;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(5),_display_utils=__w_pdfjs_require__(8),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:x,NodeCMapReaderFactory:g,NodeStandardFontDataFactory:m}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=x,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=g,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=m}let createPDFNetworkStream;function setPDFNetworkStreamFactory(x){createPDFNetworkStream=x}function getDocument(x){const g=new PDFDocumentLoadingTask;let m;if(typeof x=="string"||x instanceof URL)m={url:x};else if((0,_util.isArrayBuffer)(x))m={data:x};else if(x instanceof PDFDataRangeTransport)m={range:x};else{if(typeof x!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!x.url&&!x.data&&!x.range)throw new Error("Invalid parameter object: need either .data, .range or .url");m=x}const b=Object.create(null);let D=null,C=null;for(const T in m){const w=m[T];switch(T){case"url":if(typeof window<"u")try{b[T]=new URL(w,window.location).href;continue}catch(y){(0,_util.warn)(`Cannot create valid URL: "${y}".`)}else if(typeof w=="string"||w instanceof URL){b[T]=w.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":D=w;continue;case"worker":C=w;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&w instanceof Buffer)b[T]=new Uint8Array(w);else{if(w instanceof Uint8Array)break;if(typeof w=="string")b[T]=(0,_util.stringToBytes)(w);else if(typeof w=="object"&&w!==null&&!isNaN(w.length))b[T]=new Uint8Array(w);else if((0,_util.isArrayBuffer)(w))b[T]=new Uint8Array(w);else throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}continue}b[T]=w}if(b.CMapReaderFactory=b.CMapReaderFactory||DefaultCMapReaderFactory,b.StandardFontDataFactory=b.StandardFontDataFactory||DefaultStandardFontDataFactory,b.ignoreErrors=b.stopAtErrors!==!0,b.fontExtraProperties=b.fontExtraProperties===!0,b.pdfBug=b.pdfBug===!0,b.enableXfa=b.enableXfa===!0,(!Number.isInteger(b.rangeChunkSize)||b.rangeChunkSize<1)&&(b.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),(typeof b.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(b.docBaseUrl))&&(b.docBaseUrl=null),(!Number.isInteger(b.maxImageSize)||b.maxImageSize<-1)&&(b.maxImageSize=-1),typeof b.cMapUrl!="string"&&(b.cMapUrl=null),typeof b.standardFontDataUrl!="string"&&(b.standardFontDataUrl=null),typeof b.useWorkerFetch!="boolean"&&(b.useWorkerFetch=b.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&b.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof b.isEvalSupported!="boolean"&&(b.isEvalSupported=!0),typeof b.disableFontFace!="boolean"&&(b.disableFontFace=_is_node.isNodeJS),typeof b.useSystemFonts!="boolean"&&(b.useSystemFonts=!_is_node.isNodeJS&&!b.disableFontFace),(typeof b.ownerDocument!="object"||b.ownerDocument===null)&&(b.ownerDocument=globalThis.document),typeof b.disableRange!="boolean"&&(b.disableRange=!1),typeof b.disableStream!="boolean"&&(b.disableStream=!1),typeof b.disableAutoFetch!="boolean"&&(b.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(b.verbosity),!C){const T={verbosity:b.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};C=T.port?PDFWorker.fromPort(T):new PDFWorker(T),g._worker=C}const F=g.docId;return C.promise.then(function(){if(g.destroyed)throw new Error("Loading aborted");const T=_fetchDocument(C,b,D,F),w=new Promise(function(y){let N;D?N=new _transport_stream.PDFDataTransportStream({length:b.length,initialData:b.initialData,progressiveDone:b.progressiveDone,contentDispositionFilename:b.contentDispositionFilename,disableRange:b.disableRange,disableStream:b.disableStream},D):b.data||(N=createPDFNetworkStream({url:b.url,length:b.length,httpHeaders:b.httpHeaders,withCredentials:b.withCredentials,rangeChunkSize:b.rangeChunkSize,disableRange:b.disableRange,disableStream:b.disableStream})),y(N)});return Promise.all([T,w]).then(function([y,N]){if(g.destroyed)throw new Error("Loading aborted");const L=new _message_handler.MessageHandler(F,y,C.port),X=new WorkerTransport(L,g,N,b);g._transport=X,L.send("Ready",null)})}).catch(g._capability.reject),g}async function _fetchDocument(x,g,m,b){if(x.destroyed)throw new Error("Worker was destroyed");m&&(g.length=m.length,g.initialData=m.initialData,g.progressiveDone=m.progressiveDone,g.contentDispositionFilename=m.contentDispositionFilename);const D=await x.messageHandler.sendWithPromise("GetDocRequest",{docId:b,apiVersion:"2.16.105",source:{data:g.data,url:g.url,password:g.password,disableAutoFetch:g.disableAutoFetch,rangeChunkSize:g.rangeChunkSize,length:g.length},maxImageSize:g.maxImageSize,disableFontFace:g.disableFontFace,docBaseUrl:g.docBaseUrl,ignoreErrors:g.ignoreErrors,isEvalSupported:g.isEvalSupported,fontExtraProperties:g.fontExtraProperties,enableXfa:g.enableXfa,useSystemFonts:g.useSystemFonts,cMapUrl:g.useWorkerFetch?g.cMapUrl:null,standardFontDataUrl:g.useWorkerFetch?g.standardFontDataUrl:null});if(g.data&&(g.data=null),x.destroyed)throw new Error("Worker was destroyed");return D}const r=class r{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${Bl(r,e)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var g;this.destroyed=!0,await((g=this._transport)==null?void 0:g.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};e=new WeakMap,qe(r,e,0);let PDFDocumentLoadingTask=r;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(g,m,b=!1,D=null){this.length=g,this.initialData=m,this.progressiveDone=b,this.contentDispositionFilename=D,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(g){this._rangeListeners.push(g)}addProgressListener(g){this._progressListeners.push(g)}addProgressiveReadListener(g){this._progressiveReadListeners.push(g)}addProgressiveDoneListener(g){this._progressiveDoneListeners.push(g)}onDataRange(g,m){for(const b of this._rangeListeners)b(g,m)}onDataProgress(g,m){this._readyCapability.promise.then(()=>{for(const b of this._progressListeners)b(g,m)})}onDataProgressiveRead(g){this._readyCapability.promise.then(()=>{for(const m of this._progressiveReadListeners)m(g)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const g of this._progressiveDoneListeners)g()})}transportReady(){this._readyCapability.resolve()}requestDataRange(g,m){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(g,m){this._pdfInfo=g,this._transport=m,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(g){return this._transport.getPage(g)}getPageIndex(g){return this._transport.getPageIndex(g)}getDestinations(){return this._transport.getDestinations()}getDestination(g){return this._transport.getDestination(g)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(g=!1){return this._transport.startCleanup(g||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(g,m,b,D,C=!1){this._pageIndex=g,this._pageInfo=m,this._ownerDocument=D,this._transport=b,this._stats=C?new _display_utils.StatTimer:null,this._pdfBug=C,this.commonObjs=b.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:g,rotation:m=this.rotate,offsetX:b=0,offsetY:D=0,dontFlip:C=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:g,rotation:m,offsetX:b,offsetY:D,dontFlip:C})}getAnnotations({intent:g="display"}={}){const m=this._transport.getRenderingIntent(g);let b=this._annotationPromises.get(m.cacheKey);return b||(b=this._transport.getAnnotations(this._pageIndex,m.renderingIntent),this._annotationPromises.set(m.cacheKey,b),b=b.then(D=>{for(const C of D)C.titleObj!==void 0&&Object.defineProperty(C,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),C.titleObj.str}}),C.contentsObj!==void 0&&Object.defineProperty(C,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),C.contentsObj.str}});return D})),b}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var g;return((g=this._transport._htmlForXfa)==null?void 0:g.children[this._pageIndex])||null}render({canvasContext:g,viewport:m,intent:b="display",annotationMode:D=_util.AnnotationMode.ENABLE,transform:C=null,imageLayer:F=null,canvasFactory:T=null,background:w=null,optionalContentConfigPromise:y=null,annotationCanvasMap:N=null,pageColors:L=null,printAnnotationStorage:X=null}){var fe,ae;((fe=arguments[0])==null?void 0:fe.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&D===_util.AnnotationMode.ENABLE&&(D=_util.AnnotationMode.ENABLE_FORMS)),((ae=arguments[0])==null?void 0:ae.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&D===_util.AnnotationMode.ENABLE&&(D=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const z=this._transport.getRenderingIntent(b,D,X);this.pendingCleanup=!1,y||(y=this._transport.getOptionalContentConfig());let se=this._intentStates.get(z.cacheKey);se||(se=Object.create(null),this._intentStates.set(z.cacheKey,se)),se.streamReaderCancelTimeout&&(clearTimeout(se.streamReaderCancelTimeout),se.streamReaderCancelTimeout=null);const me=T||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),_e=!!(z.renderingIntent&_util.RenderingIntentFlag.PRINT);se.displayReadyCapability||(se.displayReadyCapability=(0,_util.createPromiseCapability)(),se.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(z));const de=W=>{se.renderTasks.delete(Y),(this.cleanupAfterRender||_e)&&(this.pendingCleanup=!0),this._tryCleanup(),W?(Y.capability.reject(W),this._abortOperatorList({intentState:se,reason:W instanceof Error?W:new Error(W)})):Y.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},Y=new InternalRenderTask({callback:de,params:{canvasContext:g,viewport:m,transform:C,imageLayer:F,background:w},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:N,operatorList:se.operatorList,pageIndex:this._pageIndex,canvasFactory:me,useRequestAnimationFrame:!_e,pdfBug:this._pdfBug,pageColors:L});(se.renderTasks||(se.renderTasks=new Set)).add(Y);const ie=Y.task;return Promise.all([se.displayReadyCapability.promise,y]).then(([W,xe])=>{if(this.pendingCleanup){de();return}this._stats&&this._stats.time("Rendering"),Y.initializeGraphics({transparency:W,optionalContentConfig:xe}),Y.operatorListChanged()}).catch(de),ie}getOperatorList({intent:g="display",annotationMode:m=_util.AnnotationMode.ENABLE,printAnnotationStorage:b=null}={}){function D(){F.operatorList.lastChunk&&(F.opListReadCapability.resolve(F.operatorList),F.renderTasks.delete(T))}const C=this._transport.getRenderingIntent(g,m,b,!0);let F=this._intentStates.get(C.cacheKey);F||(F=Object.create(null),this._intentStates.set(C.cacheKey,F));let T;return F.opListReadCapability||(T=Object.create(null),T.operatorListChanged=D,F.opListReadCapability=(0,_util.createPromiseCapability)(),(F.renderTasks||(F.renderTasks=new Set)).add(T),F.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(C)),F.opListReadCapability.promise}streamTextContent({disableCombineTextItems:g=!1,includeMarkedContent:m=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:g!==!0,includeMarkedContent:m===!0},{highWaterMark:100,size(D){return D.items.length}})}getTextContent(g={}){if(this._transport._htmlForXfa)return this.getXfa().then(b=>_xfa_text.XfaText.textContent(b));const m=this.streamTextContent(g);return new Promise(function(b,D){function C(){F.read().then(function({value:w,done:y}){if(y){b(T);return}Object.assign(T.styles,w.styles),T.items.push(...w.items),C()},D)}const F=m.getReader(),T={items:[],styles:Object.create(null)};C()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0;const g=[];for(const m of this._intentStates.values())if(this._abortOperatorList({intentState:m,reason:new Error("Page was destroyed."),force:!0}),!m.opListReadCapability)for(const b of m.renderTasks)g.push(b.completed),b.cancel();this.objs.clear();for(const m of this._bitmaps)m.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(g)}cleanup(g=!1){return this.pendingCleanup=!0,this._tryCleanup(g)}_tryCleanup(g=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:m,operatorList:b}of this._intentStates.values())if(m.size>0||!b.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,g&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const m of this._bitmaps)m.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(g,m){const b=this._intentStates.get(m);b&&(this._stats&&this._stats.timeEnd("Page Request"),b.displayReadyCapability&&b.displayReadyCapability.resolve(g))}_renderPageChunk(g,m){for(let b=0,D=g.length;b<D;b++)m.operatorList.fnArray.push(g.fnArray[b]),m.operatorList.argsArray.push(g.argsArray[b]);m.operatorList.lastChunk=g.lastChunk,m.operatorList.separateAnnots=g.separateAnnots;for(const b of m.renderTasks)b.operatorListChanged();g.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:g,cacheKey:m,annotationStorageMap:b}){const C=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:g,cacheKey:m,annotationStorage:b}).getReader(),F=this._intentStates.get(m);F.streamReader=C;const T=()=>{C.read().then(({value:w,done:y})=>{if(y){F.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(w,F),T())},w=>{if(F.streamReader=null,!this._transport.destroyed){if(F.operatorList){F.operatorList.lastChunk=!0;for(const y of F.renderTasks)y.operatorListChanged();this._tryCleanup()}if(F.displayReadyCapability)F.displayReadyCapability.reject(w);else if(F.opListReadCapability)F.opListReadCapability.reject(w);else throw w}})};T()}_abortOperatorList({intentState:g,reason:m,force:b=!1}){if(g.streamReader){if(!b){if(g.renderTasks.size>0)return;if(m instanceof _display_utils.RenderingCancelledException){g.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:g,reason:m,force:!0}),g.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(g.streamReader.cancel(new _util.AbortException(m.message)).catch(()=>{}),g.streamReader=null,!this._transport.destroyed){for(const[D,C]of this._intentStates)if(C===g){this._intentStates.delete(D);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(g,m){const b={data:structuredClone(g,m)};this._deferred.then(()=>{for(const D of this._listeners)D.call(this,b)})}addEventListener(g,m){this._listeners.push(m)}removeEventListener(g,m){const b=this._listeners.indexOf(m);this._listeners.splice(b,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const x=(t=document==null?void 0:document.currentScript)==null?void 0:t.src;x&&(PDFWorkerUtil.fallbackWorkerSrc=x.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(x,g){let m;try{if(m=new URL(x),!m.origin||m.origin==="null")return!1}catch{return!1}const b=new URL(g,m);return m.origin===b.origin},PDFWorkerUtil.createCDNWrapper=function(x){const g=`importScripts("${x}");`;return URL.createObjectURL(new Blob([g]))}}const _PDFWorker=class _PDFWorker{constructor({name:x=null,port:g=null,verbosity:m=(0,_util.getVerbosityLevel)()}={}){if(g&&le(_PDFWorker,n).has(g))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=x,this.destroyed=!1,this.verbosity=m,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,g){le(_PDFWorker,n).set(g,this),this._initializeFromPort(g);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(x){this._port=x,this._messageHandler=new _message_handler.MessageHandler("main","worker",x),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:x}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,x)||(x=PDFWorkerUtil.createCDNWrapper(new URL(x,window.location).href));const g=new Worker(x),m=new _message_handler.MessageHandler("main","worker",g),b=()=>{g.removeEventListener("error",D),m.destroy(),g.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},D=()=>{this._webWorker||b()};g.addEventListener("error",D),m.on("test",F=>{if(g.removeEventListener("error",D),this.destroyed){b();return}F?(this._messageHandler=m,this._port=g,this._webWorker=g,this._readyCapability.resolve(),m.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),m.destroy(),g.terminate())}),m.on("ready",F=>{if(g.removeEventListener("error",D),this.destroyed){b();return}try{C()}catch{this._setupFakeWorker()}});const C=()=>{const F=new Uint8Array;m.send("test",F,[F.buffer])};C();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(x=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const g=new LoopbackPort;this._port=g;const m=`fake${PDFWorkerUtil.fakeWorkerId++}`,b=new _message_handler.MessageHandler(m+"_worker",m,g);x.setup(b,g);const D=new _message_handler.MessageHandler(m,m+"_worker",g);this._messageHandler=D,this._readyCapability.resolve(),D.send("configure",{verbosity:this.verbosity})}).catch(x=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${x.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),le(_PDFWorker,n).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(x){if(!(x!=null&&x.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return le(this,n).has(x.port)?le(this,n).get(x.port):new _PDFWorker(x)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var x;try{return((x=globalThis.pdfjsWorker)==null?void 0:x.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};n=new WeakMap,qe(_PDFWorker,n,new WeakMap);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(g,m,b,D){qe(this,i,null);qe(this,l,new Map);qe(this,c,new Map);qe(this,f,null);this.messageHandler=g,this.loadingTask=m,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:m.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:D.ownerDocument,styleElement:D.styleElement}),this._params=D,D.useWorkerFetch||(this.CMapReaderFactory=new D.CMapReaderFactory({baseUrl:D.cMapUrl,isCompressed:D.cMapPacked}),this.StandardFontDataFactory=new D.StandardFontDataFactory({baseUrl:D.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=b,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return le(this,i)}getRenderingIntent(g,m=_util.AnnotationMode.ENABLE,b=null,D=!1){let C=_util.RenderingIntentFlag.DISPLAY,F=null;switch(g){case"any":C=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":C=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${g}`)}switch(m){case _util.AnnotationMode.DISABLE:C+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:C+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:C+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,F=(C&_util.RenderingIntentFlag.PRINT&&b instanceof _annotation_storage.PrintAnnotationStorage?b:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${m}`)}return D&&(C+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:C,cacheKey:`${C}_${_annotation_storage.AnnotationStorage.getHash(F)}`,annotationStorageMap:F}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const g=[];for(const b of le(this,l).values())g.push(b._destroy());le(this,l).clear(),le(this,c).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const m=this.messageHandler.sendWithPromise("Terminate",null);return g.push(m),Promise.all(g).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),$e(this,f,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:g,loadingTask:m}=this;g.on("GetReader",(b,D)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=C=>{this._lastProgress={loaded:C.loaded,total:C.total}},D.onPull=()=>{this._fullReader.read().then(function({value:C,done:F}){if(F){D.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(C),"GetReader - expected an ArrayBuffer."),D.enqueue(new Uint8Array(C),1,[C])}).catch(C=>{D.error(C)})},D.onCancel=C=>{this._fullReader.cancel(C),D.ready.catch(F=>{if(!this.destroyed)throw F})}}),g.on("ReaderHeadersReady",b=>{const D=(0,_util.createPromiseCapability)(),C=this._fullReader;return C.headersReady.then(()=>{var F;(!C.isStreamingSupported||!C.isRangeSupported)&&(this._lastProgress&&((F=m.onProgress)==null||F.call(m,this._lastProgress)),C.onProgress=T=>{var w;(w=m.onProgress)==null||w.call(m,{loaded:T.loaded,total:T.total})}),D.resolve({isStreamingSupported:C.isStreamingSupported,isRangeSupported:C.isRangeSupported,contentLength:C.contentLength})},D.reject),D.promise}),g.on("GetRangeReader",(b,D)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const C=this._networkStream.getRangeReader(b.begin,b.end);if(!C){D.close();return}D.onPull=()=>{C.read().then(function({value:F,done:T}){if(T){D.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(F),"GetRangeReader - expected an ArrayBuffer."),D.enqueue(new Uint8Array(F),1,[F])}).catch(F=>{D.error(F)})},D.onCancel=F=>{C.cancel(F),D.ready.catch(T=>{if(!this.destroyed)throw T})}}),g.on("GetDoc",({pdfInfo:b})=>{this._numPages=b.numPages,this._htmlForXfa=b.htmlForXfa,delete b.htmlForXfa,m._capability.resolve(new PDFDocumentProxy(b,this))}),g.on("DocException",function(b){let D;switch(b.name){case"PasswordException":D=new _util.PasswordException(b.message,b.code);break;case"InvalidPDFException":D=new _util.InvalidPDFException(b.message);break;case"MissingPDFException":D=new _util.MissingPDFException(b.message);break;case"UnexpectedResponseException":D=new _util.UnexpectedResponseException(b.message,b.status);break;case"UnknownErrorException":D=new _util.UnknownErrorException(b.message,b.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}m._capability.reject(D)}),g.on("PasswordRequest",b=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),m.onPassword){const D=C=>{C instanceof Error?this._passwordCapability.reject(C):this._passwordCapability.resolve({password:C})};try{m.onPassword(D,b.code)}catch(C){this._passwordCapability.reject(C)}}else this._passwordCapability.reject(new _util.PasswordException(b.message,b.code));return this._passwordCapability.promise}),g.on("DataLoaded",b=>{var D;(D=m.onProgress)==null||D.call(m,{loaded:b.length,total:b.length}),this.downloadInfoCapability.resolve(b)}),g.on("StartRenderPage",b=>{if(this.destroyed)return;le(this,l).get(b.pageIndex)._startRenderPage(b.transparency,b.cacheKey)}),g.on("commonobj",([b,D,C])=>{var F;if(!this.destroyed&&!this.commonObjs.has(b))switch(D){case"Font":const T=this._params;if("error"in C){const N=C.error;(0,_util.warn)(`Error during font loading: ${N}`),this.commonObjs.resolve(b,N);break}let w=null;T.pdfBug&&((F=globalThis.FontInspector)!=null&&F.enabled)&&(w={registerFont(N,L){globalThis.FontInspector.fontAdded(N,L)}});const y=new _font_loader.FontFaceObject(C,{isEvalSupported:T.isEvalSupported,disableFontFace:T.disableFontFace,ignoreErrors:T.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:w});this.fontLoader.bind(y).catch(N=>g.sendWithPromise("FontFallback",{id:b})).finally(()=>{!T.fontExtraProperties&&y.data&&(y.data=null),this.commonObjs.resolve(b,y)});break;case"FontPath":case"Image":this.commonObjs.resolve(b,C);break;default:throw new Error(`Got unknown common object type ${D}`)}}),g.on("obj",([b,D,C,F])=>{var w;if(this.destroyed)return;const T=le(this,l).get(D);if(!T.objs.has(b))switch(C){case"Image":T.objs.resolve(b,F);const y=8e6;if(F){let N;if(F.bitmap){const{bitmap:L,width:X,height:z}=F;N=X*z*4,T._bitmaps.add(L)}else N=((w=F.data)==null?void 0:w.length)||0;N>y&&(T.cleanupAfterRender=!0)}break;case"Pattern":T.objs.resolve(b,F);break;default:throw new Error(`Got unknown object type ${C}`)}}),g.on("DocProgress",b=>{var D;this.destroyed||(D=m.onProgress)==null||D.call(m,{loaded:b.loaded,total:b.total})}),g.on("DocStats",b=>{this.destroyed||$e(this,i,Object.freeze({streamTypes:Object.freeze(b.streamTypes),fontTypes:Object.freeze(b.fontTypes)}))}),g.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),g.on("FetchBuiltInCMap",b=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(b):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),g.on("FetchStandardFontData",b=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(b):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:g}){var m,b;this.destroyed||(b=(m=this.loadingTask).onUnsupportedFeature)==null||b.call(m,g)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(g){if(!Number.isInteger(g)||g<=0||g>this._numPages)return Promise.reject(new Error("Invalid page request."));const m=g-1,b=le(this,c).get(m);if(b)return b;const D=this.messageHandler.sendWithPromise("GetPage",{pageIndex:m}).then(C=>{if(this.destroyed)throw new Error("Transport destroyed");const F=new PDFPageProxy(m,C,this,this._params.ownerDocument,this._params.pdfBug);return le(this,l).set(m,F),F});return le(this,c).set(m,D),D}getPageIndex(g){return typeof g!="object"||g===null||!Number.isInteger(g.num)||g.num<0||!Number.isInteger(g.gen)||g.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:g.num,gen:g.gen})}getAnnotations(g,m){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:g,intent:m})}saveDocument(){var g;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((g=this._fullReader)==null?void 0:g.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(g){return typeof g!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:g})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(g){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:g})}getStructTree(g){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:g})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(g=>new _optional_content_config.OptionalContentConfig(g))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return le(this,f)||$e(this,f,this.messageHandler.sendWithPromise("GetMetadata",null).then(g=>{var m,b;return{info:g[0],metadata:g[1]?new _metadata.Metadata(g[1]):null,contentDispositionFilename:((m=this._fullReader)==null?void 0:m.filename)??null,contentLength:((b=this._fullReader)==null?void 0:b.contentLength)??null}}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(g=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const m of le(this,l).values())if(!m.cleanup())throw new Error(`startCleanup: Page ${m.pageNumber} is currently rendering.`);this.commonObjs.clear(),g||this.fontLoader.clear(),$e(this,f,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const g=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:g.disableAutoFetch,enableXfa:g.enableXfa})}}i=new WeakMap,l=new WeakMap,c=new WeakMap,f=new WeakMap;class PDFObjects{constructor(){qe(this,h);qe(this,d,Object.create(null))}get(g,m=null){if(m){const D=je(this,h,Ul).call(this,g);return D.capability.promise.then(()=>m(D.data)),null}const b=le(this,d)[g];if(!(b!=null&&b.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${g}.`);return b.data}has(g){const m=le(this,d)[g];return(m==null?void 0:m.capability.settled)||!1}resolve(g,m=null){const b=je(this,h,Ul).call(this,g);b.data=m,b.capability.resolve()}clear(){$e(this,d,Object.create(null))}}d=new WeakMap,h=new WeakSet,Ul=function(g){const m=le(this,d)[g];return m||(le(this,d)[g]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(g){qe(this,E,null);$e(this,E,g),this.onContinue=null}get promise(){return le(this,E).capability.promise}cancel(){le(this,E).cancel()}get separateAnnots(){const{separateAnnots:g}=le(this,E).operatorList;if(!g)return!1;const{annotationCanvasMap:m}=le(this,E);return g.form||g.canvas&&(m==null?void 0:m.size)>0}}E=new WeakMap,exports.RenderTask=RenderTask;const S=class S{constructor({callback:g,params:m,objs:b,commonObjs:D,annotationCanvasMap:C,operatorList:F,pageIndex:T,canvasFactory:w,useRequestAnimationFrame:y=!1,pdfBug:N=!1,pageColors:L=null}){this.callback=g,this.params=m,this.objs=b,this.commonObjs=D,this.annotationCanvasMap=C,this.operatorListIdx=null,this.operatorList=F,this._pageIndex=T,this.canvasFactory=w,this._pdfBug=N,this.pageColors=L,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=y===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=m.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:g=!1,optionalContentConfig:m}){var w;if(this.cancelled)return;if(this._canvas){if(le(S,v).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");le(S,v).add(this._canvas)}this._pdfBug&&((w=globalThis.StepperManager)!=null&&w.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:b,viewport:D,transform:C,imageLayer:F,background:T}=this.params;this.gfx=new _canvas.CanvasGraphics(b,this.commonObjs,this.objs,this.canvasFactory,F,m,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:C,viewport:D,transparency:g,background:T}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(g=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&le(S,v).delete(this._canvas),this.callback(g||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&le(S,v).delete(this._canvas),this.callback())))}};v=new WeakMap,qe(S,v,new WeakSet);let InternalRenderTask=S;const version="2.16.105";exports.version=version;const build="172ccdbe5";exports.build=build},(e,r,t)=>{var d,wh,p;Object.defineProperty(r,"__esModule",{value:!0}),r.PrintAnnotationStorage=r.AnnotationStorage=void 0;var n=t(1),i=t(6),l=t(10);class c{constructor(){qe(this,d);this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(v,S){const x=this._storage.get(v);return x===void 0?S:Object.assign(S,x)}getRawValue(v){return this._storage.get(v)}remove(v){if(this._storage.delete(v),this._storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const S of this._storage.values())if(S instanceof i.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(v,S){const x=this._storage.get(v);let g=!1;if(x!==void 0)for(const[m,b]of Object.entries(S))x[m]!==b&&(g=!0,x[m]=b);else g=!0,this._storage.set(v,S);g&&je(this,d,wh).call(this),S instanceof i.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(S.constructor._type)}has(v){return this._storage.has(v)}getAll(){return this._storage.size>0?(0,n.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new f(this)}get serializable(){if(this._storage.size===0)return null;const v=new Map;for(const[S,x]of this._storage){const g=x instanceof i.AnnotationEditor?x.serialize():x;g&&v.set(S,g)}return v}static getHash(v){if(!v)return"";const S=new l.MurmurHash3_64;for(const[x,g]of v)S.update(`${x}:${JSON.stringify(g)}`);return S.hexdigest()}}d=new WeakSet,wh=function(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())},r.AnnotationStorage=c;class f extends c{constructor(S){super();qe(this,p,null);$e(this,p,structuredClone(S.serializable))}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return le(this,p)}}p=new WeakMap,r.PrintAnnotationStorage=f},(e,r,t)=>{var c,f,d,h,p,E;Object.defineProperty(r,"__esModule",{value:!0}),r.AnnotationEditor=void 0;var n=t(7),i=t(1);const v=class v{constructor(x){qe(this,c,this.focusin.bind(this));qe(this,f,this.focusout.bind(this));qe(this,d,!1);qe(this,h,!1);qe(this,p,!1);qe(this,E,v._zIndex++);this.constructor===v&&(0,i.unreachable)("Cannot initialize AnnotationEditor."),this.parent=x.parent,this.id=x.id,this.width=this.height=null,this.pageIndex=x.parent.pageIndex,this.name=x.name,this.div=null;const[g,m]=this.parent.viewportBaseDimensions;this.x=x.x/g,this.y=x.y/m,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,i.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=le(this,E)}focusin(x){le(this,d)?$e(this,d,!1):this.parent.setSelected(this)}focusout(x){if(!this.isAttachedToDOM)return;const g=x.relatedTarget;g!=null&&g.closest(`#${this.id}`)||(x.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(x){const g=this.parent.div.getBoundingClientRect();this.startX=x.clientX-g.x,this.startY=x.clientY-g.y,x.dataTransfer.setData("text/plain",this.id),x.dataTransfer.effectAllowed="move"}setAt(x,g,m,b){const[D,C]=this.parent.viewportBaseDimensions;[m,b]=this.screenToPageTranslation(m,b),this.x=(x+m)/D,this.y=(g+b)/C,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(x,g){const[m,b]=this.parent.viewportBaseDimensions;[x,g]=this.screenToPageTranslation(x,g),this.x+=x/m,this.y+=g/b,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(x,g){const{rotation:m}=this.parent.viewport;switch(m){case 90:return[g,-x];case 180:return[-x,-g];case 270:return[-g,x];default:return[x,g]}}setDims(x,g){const[m,b]=this.parent.viewportBaseDimensions;this.div.style.width=`${100*x/m}%`,this.div.style.height=`${100*g/b}%`}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",le(this,c)),this.div.addEventListener("focusout",le(this,f));const[x,g]=this.getInitialTranslation();return this.translate(x,g),(0,n.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(x){const g=n.KeyboardManager.platform.isMac;if(x.button!==0||x.ctrlKey&&g){x.preventDefault();return}x.ctrlKey&&!g||x.shiftKey||x.metaKey&&g?this.parent.toggleSelected(this):this.parent.setSelected(this),$e(this,d,!0)}getRect(x,g){const[m,b]=this.parent.viewportBaseDimensions,[D,C]=this.parent.pageDimensions,F=D*x/m,T=C*g/b,w=this.x*D,y=this.y*C,N=this.width*D,L=this.height*C;switch(this.rotation){case 0:return[w+F,C-y-T-L,w+F+N,C-y-T];case 90:return[w+T,C-y+F,w+T+L,C-y+F+N];case 180:return[w-F-N,C-y+T,w-F,C-y+T+L];case 270:return[w-T-L,C-y-F-N,w-T,C-y-F];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(x,g){const[m,b,D,C]=x,F=D-m,T=C-b;switch(this.rotation){case 0:return[m,g-C,F,T];case 90:return[m,g-b,T,F];case 180:return[D,g-b,F,T];case 270:return[D,g-C,T,F];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){$e(this,p,!0)}disableEditMode(){$e(this,p,!1)}isInEditMode(){return le(this,p)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var x;(x=this.div)==null||x.addEventListener("focusin",le(this,c))}serialize(){(0,i.unreachable)("An editor must be serializable")}static deserialize(x,g){const m=new this.prototype.constructor({parent:g,id:g.getNextId()});m.rotation=x.rotation;const[b,D]=g.pageDimensions,[C,F,T,w]=m.getRectInCurrentCoords(x.rect,D);return m.x=C/b,m.y=F/D,m.width=T/b,m.height=w/D,m}remove(){this.div.removeEventListener("focusin",le(this,c)),this.div.removeEventListener("focusout",le(this,f)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var x;(x=this.div)==null||x.classList.add("selectedEditor")}unselect(){var x;(x=this.div)==null||x.classList.remove("selectedEditor")}updateParams(x,g){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return le(this,h)}set isEditing(x){$e(this,h,x),x?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};c=new WeakMap,f=new WeakMap,d=new WeakMap,h=new WeakMap,p=new WeakMap,E=new WeakMap,Ut(v,"_colorManager",new n.ColorManager),Ut(v,"_zIndex",1);let l=v;r.AnnotationEditor=l},(e,r,t)=>{var S,x,g,m,b,D,Ch,T,y,N,L,X,z,se,me,_e,de,Y,ie,fe,ae,W,xe,I,M,R,kh,jl,pr,Es,Rh,Fh,Hl,Ss,Ri;Object.defineProperty(r,"__esModule",{value:!0}),r.KeyboardManager=r.CommandManager=r.ColorManager=r.AnnotationEditorUIManager=void 0,r.bindEvents=l,r.opacityToHex=c;var n=t(1),i=t(8);function l(re,H,Q){for(const be of Q)H.addEventListener(be,re[be].bind(re))}function c(re){return Math.round(Math.min(255,Math.max(1,255*re))).toString(16).padStart(2,"0")}class f{constructor(){qe(this,S,0)}getId(){return`${n.AnnotationEditorPrefix}${Bl(this,S)._++}`}}S=new WeakMap;class d{constructor(H=128){qe(this,x,[]);qe(this,g,!1);qe(this,m);qe(this,b,-1);$e(this,m,H)}add({cmd:H,undo:Q,mustExec:be,type:ge=NaN,overwriteIfSameType:ye=!1,keepUndo:we=!1}){if(be&&H(),le(this,g))return;const Le={cmd:H,undo:Q,type:ge};if(le(this,b)===-1){le(this,x).length>0&&(le(this,x).length=0),$e(this,b,0),le(this,x).push(Le);return}if(ye&&le(this,x)[le(this,b)].type===ge){we&&(Le.undo=le(this,x)[le(this,b)].undo),le(this,x)[le(this,b)]=Le;return}const Ve=le(this,b)+1;Ve===le(this,m)?le(this,x).splice(0,1):($e(this,b,Ve),Ve<le(this,x).length&&le(this,x).splice(Ve)),le(this,x).push(Le)}undo(){le(this,b)!==-1&&($e(this,g,!0),le(this,x)[le(this,b)].undo(),$e(this,g,!1),$e(this,b,le(this,b)-1))}redo(){le(this,b)<le(this,x).length-1&&($e(this,b,le(this,b)+1),$e(this,g,!0),le(this,x)[le(this,b)].cmd(),$e(this,g,!1))}hasSomethingToUndo(){return le(this,b)!==-1}hasSomethingToRedo(){return le(this,b)<le(this,x).length-1}destroy(){$e(this,x,null)}}x=new WeakMap,g=new WeakMap,m=new WeakMap,b=new WeakMap,r.CommandManager=d;const F=class F{constructor(H){qe(this,D);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const Q=F.platform.isMac;for(const[be,ge]of H)for(const ye of be){const we=ye.startsWith("mac+");Q&&we?(this.callbacks.set(ye.slice(4),ge),this.allKeys.add(ye.split("+").at(-1))):!Q&&!we&&(this.callbacks.set(ye,ge),this.allKeys.add(ye.split("+").at(-1)))}}static get platform(){const H=typeof navigator<"u"?navigator.platform:"";return(0,n.shadow)(this,"platform",{isWin:H.includes("Win"),isMac:H.includes("Mac")})}exec(H,Q){if(!this.allKeys.has(Q.key))return;const be=this.callbacks.get(je(this,D,Ch).call(this,Q));be&&(be.bind(H)(),Q.stopPropagation(),Q.preventDefault())}};D=new WeakSet,Ch=function(H){H.altKey&&this.buffer.push("alt"),H.ctrlKey&&this.buffer.push("ctrl"),H.metaKey&&this.buffer.push("meta"),H.shiftKey&&this.buffer.push("shift"),this.buffer.push(H.key);const Q=this.buffer.join("+");return this.buffer.length=0,Q};let h=F;r.KeyboardManager=h;class p{constructor(){qe(this,T,null)}copy(H){H&&(Array.isArray(H)?$e(this,T,H.map(Q=>Q.serialize())):$e(this,T,[H.serialize()]),$e(this,T,le(this,T).filter(Q=>!!Q)),le(this,T).length===0&&$e(this,T,null))}paste(){return le(this,T)}isEmpty(){return le(this,T)===null}destroy(){$e(this,T,null)}}T=new WeakMap;const w=class w{get _colors(){const H=new Map([["CanvasText",null],["Canvas",null]]);return(0,i.getColorValues)(H),(0,n.shadow)(this,"_colors",H)}convert(H){const Q=(0,i.getRGB)(H);if(!window.matchMedia("(forced-colors: active)").matches)return Q;for(const[be,ge]of this._colors)if(ge.every((ye,we)=>ye===Q[we]))return w._colorsMapping.get(be);return Q}getHexCode(H){const Q=this._colors.get(H);return Q?n.Util.makeHexColor(...Q):H}};Ut(w,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let E=w;r.ColorManager=E;const oe=class oe{constructor(H,Q){qe(this,R);qe(this,y,null);qe(this,N,new Map);qe(this,L,new Map);qe(this,X,new p);qe(this,z,new d);qe(this,se,0);qe(this,me,null);qe(this,_e,null);qe(this,de,new f);qe(this,Y,!1);qe(this,ie,n.AnnotationEditorType.NONE);qe(this,fe,new Set);qe(this,ae,this.keydown.bind(this));qe(this,W,this.onEditingAction.bind(this));qe(this,xe,this.onPageChanging.bind(this));qe(this,I,{isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});qe(this,M,null);$e(this,M,H),$e(this,_e,Q),le(this,_e)._on("editingaction",le(this,W)),le(this,_e)._on("pagechanging",le(this,xe))}destroy(){je(this,R,jl).call(this),le(this,_e)._off("editingaction",le(this,W)),le(this,_e)._off("pagechanging",le(this,xe));for(const H of le(this,L).values())H.destroy();le(this,L).clear(),le(this,N).clear(),$e(this,y,null),le(this,fe).clear(),le(this,X).destroy(),le(this,z).destroy()}onPageChanging({pageNumber:H}){$e(this,se,H-1)}focusMainContainer(){le(this,M).focus()}keydown(H){var Q;(Q=this.getActive())!=null&&Q.shouldGetKeyboardEvents()||oe._keyboardManager.exec(this,H)}onEditingAction(H){["undo","redo","cut","copy","paste","delete","selectAll"].includes(H.name)&&this[H.name]()}setEditingState(H){H?(je(this,R,kh).call(this),je(this,R,pr).call(this,{isEditing:le(this,ie)!==n.AnnotationEditorType.NONE,isEmpty:je(this,R,Ss).call(this),hasSomethingToUndo:le(this,z).hasSomethingToUndo(),hasSomethingToRedo:le(this,z).hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:le(this,X).isEmpty()})):(je(this,R,jl).call(this),je(this,R,pr).call(this,{isEditing:!1}))}registerEditorTypes(H){$e(this,me,H);for(const Q of le(this,me))je(this,R,Es).call(this,Q.defaultPropertiesToUpdate)}getId(){return le(this,de).getId()}addLayer(H){le(this,L).set(H.pageIndex,H),le(this,Y)?H.enable():H.disable()}removeLayer(H){le(this,L).delete(H.pageIndex)}updateMode(H){if($e(this,ie,H),H===n.AnnotationEditorType.NONE)this.setEditingState(!1),je(this,R,Fh).call(this);else{this.setEditingState(!0),je(this,R,Rh).call(this);for(const Q of le(this,L).values())Q.updateMode(H)}}updateToolbar(H){H!==le(this,ie)&&le(this,_e).dispatch("switchannotationeditormode",{source:this,mode:H})}updateParams(H,Q){for(const be of le(this,fe))be.updateParams(H,Q);for(const be of le(this,me))be.updateDefaultParams(H,Q)}getEditors(H){const Q=[];for(const be of le(this,N).values())be.pageIndex===H&&Q.push(be);return Q}getEditor(H){return le(this,N).get(H)}addEditor(H){le(this,N).set(H.id,H)}removeEditor(H){le(this,N).delete(H.id),this.unselect(H)}setActiveEditor(H){le(this,y)!==H&&($e(this,y,H),H&&je(this,R,Es).call(this,H.propertiesToUpdate))}toggleSelected(H){if(le(this,fe).has(H)){le(this,fe).delete(H),H.unselect(),je(this,R,pr).call(this,{hasSelectedEditor:this.hasSelection});return}le(this,fe).add(H),H.select(),je(this,R,Es).call(this,H.propertiesToUpdate),je(this,R,pr).call(this,{hasSelectedEditor:!0})}setSelected(H){for(const Q of le(this,fe))Q!==H&&Q.unselect();le(this,fe).clear(),le(this,fe).add(H),H.select(),je(this,R,Es).call(this,H.propertiesToUpdate),je(this,R,pr).call(this,{hasSelectedEditor:!0})}isSelected(H){return le(this,fe).has(H)}unselect(H){H.unselect(),le(this,fe).delete(H),je(this,R,pr).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return le(this,fe).size!==0}undo(){le(this,z).undo(),je(this,R,pr).call(this,{hasSomethingToUndo:le(this,z).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:je(this,R,Ss).call(this)})}redo(){le(this,z).redo(),je(this,R,pr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:le(this,z).hasSomethingToRedo(),isEmpty:je(this,R,Ss).call(this)})}addCommands(H){le(this,z).add(H),je(this,R,pr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:je(this,R,Ss).call(this)})}delete(){if(le(this,y)&&le(this,y).commitOrRemove(),!this.hasSelection)return;const H=[...le(this,fe)],Q=()=>{for(const ge of H)ge.remove()},be=()=>{for(const ge of H)je(this,R,Hl).call(this,ge)};this.addCommands({cmd:Q,undo:be,mustExec:!0})}copy(){if(le(this,y)&&le(this,y).commitOrRemove(),this.hasSelection){const H=[];for(const Q of le(this,fe))Q.isEmpty()||H.push(Q);if(H.length===0)return;le(this,X).copy(H),je(this,R,pr).call(this,{hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(le(this,X).isEmpty())return;this.unselectAll();const H=le(this,L).get(le(this,se)),Q=le(this,X).paste().map(ye=>H.deserialize(ye)),be=()=>{for(const ye of Q)je(this,R,Hl).call(this,ye);je(this,R,Ri).call(this,Q)},ge=()=>{for(const ye of Q)ye.remove()};this.addCommands({cmd:be,undo:ge,mustExec:!0})}selectAll(){for(const H of le(this,fe))H.commit();je(this,R,Ri).call(this,le(this,N).values())}unselectAll(){if(le(this,y)){le(this,y).commitOrRemove();return}if(je(this,R,Ri).size!==0){for(const H of le(this,fe))H.unselect();le(this,fe).clear(),je(this,R,pr).call(this,{hasSelectedEditor:!1})}}isActive(H){return le(this,y)===H}getActive(){return le(this,y)}getMode(){return le(this,ie)}};y=new WeakMap,N=new WeakMap,L=new WeakMap,X=new WeakMap,z=new WeakMap,se=new WeakMap,me=new WeakMap,_e=new WeakMap,de=new WeakMap,Y=new WeakMap,ie=new WeakMap,fe=new WeakMap,ae=new WeakMap,W=new WeakMap,xe=new WeakMap,I=new WeakMap,M=new WeakMap,R=new WeakSet,kh=function(){le(this,M).addEventListener("keydown",le(this,ae))},jl=function(){le(this,M).removeEventListener("keydown",le(this,ae))},pr=function(H){Object.entries(H).some(([be,ge])=>le(this,I)[be]!==ge)&&le(this,_e).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(le(this,I),H)})},Es=function(H){le(this,_e).dispatch("annotationeditorparamschanged",{source:this,details:H})},Rh=function(){if(!le(this,Y)){$e(this,Y,!0);for(const H of le(this,L).values())H.enable()}},Fh=function(){if(this.unselectAll(),le(this,Y)){$e(this,Y,!1);for(const H of le(this,L).values())H.disable()}},Hl=function(H){const Q=le(this,L).get(H.pageIndex);Q?Q.addOrRebuild(H):this.addEditor(H)},Ss=function(){if(le(this,N).size===0)return!0;if(le(this,N).size===1)for(const H of le(this,N).values())return H.isEmpty();return!1},Ri=function(H){le(this,fe).clear();for(const Q of H)Q.isEmpty()||(le(this,fe).add(Q),Q.select());je(this,R,pr).call(this,{hasSelectedEditor:!0})},Ut(oe,"_keyboardManager",new h([[["ctrl+a","mac+meta+a"],oe.prototype.selectAll],[["ctrl+c","mac+meta+c"],oe.prototype.copy],[["ctrl+v","mac+meta+v"],oe.prototype.paste],[["ctrl+x","mac+meta+x"],oe.prototype.cut],[["ctrl+z","mac+meta+z"],oe.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],oe.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],oe.prototype.delete],[["Escape","mac+Escape"],oe.prototype.unselectAll]]));let v=oe;r.AnnotationEditorUIManager=v},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.StatTimer=r.RenderingCancelledException=r.PixelsPerInch=r.PageViewport=r.PDFDateString=r.DOMStandardFontDataFactory=r.DOMSVGFactory=r.DOMCanvasFactory=r.DOMCMapReaderFactory=r.AnnotationPrefix=void 0,r.deprecated=w,r.getColorValues=z,r.getCurrentTransform=se,r.getCurrentTransformInverse=me,r.getFilenameFromUrl=b,r.getPdfFilenameFromUrl=D,r.getRGB=X,r.getXfaPageViewport=L,r.isDataScheme=g,r.isPdfFile=m,r.isValidFetchUrl=F,r.loadScript=T;var n=t(9),i=t(1);const l="http://www.w3.org/2000/svg",c="pdfjs_internal_id_";r.AnnotationPrefix=c;const _e=class _e{};Ut(_e,"CSS",96),Ut(_e,"PDF",72),Ut(_e,"PDF_TO_CSS_UNITS",_e.CSS/_e.PDF);let f=_e;r.PixelsPerInch=f;class d extends n.BaseCanvasFactory{constructor({ownerDocument:Y=globalThis.document}={}){super(),this._document=Y}_createCanvas(Y,ie){const fe=this._document.createElement("canvas");return fe.width=Y,fe.height=ie,fe}}r.DOMCanvasFactory=d;async function h(de,Y=!1){if(F(de,document.baseURI)){const ie=await fetch(de);if(!ie.ok)throw new Error(ie.statusText);return Y?new Uint8Array(await ie.arrayBuffer()):(0,i.stringToBytes)(await ie.text())}return new Promise((ie,fe)=>{const ae=new XMLHttpRequest;ae.open("GET",de,!0),Y&&(ae.responseType="arraybuffer"),ae.onreadystatechange=()=>{if(ae.readyState===XMLHttpRequest.DONE){if(ae.status===200||ae.status===0){let W;if(Y&&ae.response?W=new Uint8Array(ae.response):!Y&&ae.responseText&&(W=(0,i.stringToBytes)(ae.responseText)),W){ie(W);return}}fe(new Error(ae.statusText))}},ae.send(null)})}class p extends n.BaseCMapReaderFactory{_fetchData(Y,ie){return h(Y,this.isCompressed).then(fe=>({cMapData:fe,compressionType:ie}))}}r.DOMCMapReaderFactory=p;class E extends n.BaseStandardFontDataFactory{_fetchData(Y){return h(Y,!0)}}r.DOMStandardFontDataFactory=E;class v extends n.BaseSVGFactory{_createSVG(Y){return document.createElementNS(l,Y)}}r.DOMSVGFactory=v;class S{constructor({viewBox:Y,scale:ie,rotation:fe,offsetX:ae=0,offsetY:W=0,dontFlip:xe=!1}){this.viewBox=Y,this.scale=ie,this.rotation=fe,this.offsetX=ae,this.offsetY=W;const I=(Y[2]+Y[0])/2,M=(Y[3]+Y[1])/2;let R,U,V,Z;switch(fe%=360,fe<0&&(fe+=360),fe){case 180:R=-1,U=0,V=0,Z=1;break;case 90:R=0,U=1,V=1,Z=0;break;case 270:R=0,U=-1,V=-1,Z=0;break;case 0:R=1,U=0,V=0,Z=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}xe&&(V=-V,Z=-Z);let J,O,B,G;R===0?(J=Math.abs(M-Y[1])*ie+ae,O=Math.abs(I-Y[0])*ie+W,B=Math.abs(Y[3]-Y[1])*ie,G=Math.abs(Y[2]-Y[0])*ie):(J=Math.abs(I-Y[0])*ie+ae,O=Math.abs(M-Y[1])*ie+W,B=Math.abs(Y[2]-Y[0])*ie,G=Math.abs(Y[3]-Y[1])*ie),this.transform=[R*ie,U*ie,V*ie,Z*ie,J-R*ie*I-V*ie*M,O-U*ie*I-Z*ie*M],this.width=B,this.height=G}clone({scale:Y=this.scale,rotation:ie=this.rotation,offsetX:fe=this.offsetX,offsetY:ae=this.offsetY,dontFlip:W=!1}={}){return new S({viewBox:this.viewBox.slice(),scale:Y,rotation:ie,offsetX:fe,offsetY:ae,dontFlip:W})}convertToViewportPoint(Y,ie){return i.Util.applyTransform([Y,ie],this.transform)}convertToViewportRectangle(Y){const ie=i.Util.applyTransform([Y[0],Y[1]],this.transform),fe=i.Util.applyTransform([Y[2],Y[3]],this.transform);return[ie[0],ie[1],fe[0],fe[1]]}convertToPdfPoint(Y,ie){return i.Util.applyInverseTransform([Y,ie],this.transform)}}r.PageViewport=S;class x extends i.BaseException{constructor(Y,ie){super(Y,"RenderingCancelledException"),this.type=ie}}r.RenderingCancelledException=x;function g(de){const Y=de.length;let ie=0;for(;ie<Y&&de[ie].trim()==="";)ie++;return de.substring(ie,ie+5).toLowerCase()==="data:"}function m(de){return typeof de=="string"&&/\.pdf$/i.test(de)}function b(de){const Y=de.indexOf("#"),ie=de.indexOf("?"),fe=Math.min(Y>0?Y:de.length,ie>0?ie:de.length);return de.substring(de.lastIndexOf("/",fe)+1,fe)}function D(de,Y="document.pdf"){if(typeof de!="string")return Y;if(g(de))return(0,i.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),Y;const ie=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,fe=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,ae=ie.exec(de);let W=fe.exec(ae[1])||fe.exec(ae[2])||fe.exec(ae[3]);if(W&&(W=W[0],W.includes("%")))try{W=fe.exec(decodeURIComponent(W))[0]}catch{}return W||Y}class C{constructor(){this.started=Object.create(null),this.times=[]}time(Y){Y in this.started&&(0,i.warn)(`Timer is already running for ${Y}`),this.started[Y]=Date.now()}timeEnd(Y){Y in this.started||(0,i.warn)(`Timer has not been started for ${Y}`),this.times.push({name:Y,start:this.started[Y],end:Date.now()}),delete this.started[Y]}toString(){const Y=[];let ie=0;for(const fe of this.times){const ae=fe.name;ae.length>ie&&(ie=ae.length)}for(const fe of this.times){const ae=fe.end-fe.start;Y.push(`${fe.name.padEnd(ie)} ${ae}ms
`)}return Y.join("")}}r.StatTimer=C;function F(de,Y){try{const{protocol:ie}=Y?new URL(de,Y):new URL(de);return ie==="http:"||ie==="https:"}catch{return!1}}function T(de,Y=!1){return new Promise((ie,fe)=>{const ae=document.createElement("script");ae.src=de,ae.onload=function(W){Y&&ae.remove(),ie(W)},ae.onerror=function(){fe(new Error(`Cannot load script at: ${ae.src}`))},(document.head||document.documentElement).append(ae)})}function w(de){console.log("Deprecated API usage: "+de)}let y;class N{static toDateObject(Y){if(!Y||typeof Y!="string")return null;y||(y=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const ie=y.exec(Y);if(!ie)return null;const fe=parseInt(ie[1],10);let ae=parseInt(ie[2],10);ae=ae>=1&&ae<=12?ae-1:0;let W=parseInt(ie[3],10);W=W>=1&&W<=31?W:1;let xe=parseInt(ie[4],10);xe=xe>=0&&xe<=23?xe:0;let I=parseInt(ie[5],10);I=I>=0&&I<=59?I:0;let M=parseInt(ie[6],10);M=M>=0&&M<=59?M:0;const R=ie[7]||"Z";let U=parseInt(ie[8],10);U=U>=0&&U<=23?U:0;let V=parseInt(ie[9],10)||0;return V=V>=0&&V<=59?V:0,R==="-"?(xe+=U,I+=V):R==="+"&&(xe-=U,I-=V),new Date(Date.UTC(fe,ae,W,xe,I,M))}}r.PDFDateString=N;function L(de,{scale:Y=1,rotation:ie=0}){const{width:fe,height:ae}=de.attributes.style,W=[0,0,parseInt(fe),parseInt(ae)];return new S({viewBox:W,scale:Y,rotation:ie})}function X(de){if(de.startsWith("#")){const Y=parseInt(de.slice(1),16);return[(Y&16711680)>>16,(Y&65280)>>8,Y&255]}return de.startsWith("rgb(")?de.slice(4,-1).split(",").map(Y=>parseInt(Y)):de.startsWith("rgba(")?de.slice(5,-1).split(",").map(Y=>parseInt(Y)).slice(0,3):((0,i.warn)(`Not a valid color format: "${de}"`),[0,0,0])}function z(de){const Y=document.createElement("span");Y.style.visibility="hidden",document.body.append(Y);for(const ie of de.keys()){Y.style.color=ie;const fe=window.getComputedStyle(Y).color;de.set(ie,X(fe))}Y.remove()}function se(de){const{a:Y,b:ie,c:fe,d:ae,e:W,f:xe}=de.getTransform();return[Y,ie,fe,ae,W,xe]}function me(de){const{a:Y,b:ie,c:fe,d:ae,e:W,f:xe}=de.getTransform().invertSelf();return[Y,ie,fe,ae,W,xe]}},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.BaseStandardFontDataFactory=r.BaseSVGFactory=r.BaseCanvasFactory=r.BaseCMapReaderFactory=void 0;var n=t(1);class i{constructor(){this.constructor===i&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(h,p){if(h<=0||p<=0)throw new Error("Invalid canvas size");const E=this._createCanvas(h,p);return{canvas:E,context:E.getContext("2d")}}reset(h,p,E){if(!h.canvas)throw new Error("Canvas is not specified");if(p<=0||E<=0)throw new Error("Invalid canvas size");h.canvas.width=p,h.canvas.height=E}destroy(h){if(!h.canvas)throw new Error("Canvas is not specified");h.canvas.width=0,h.canvas.height=0,h.canvas=null,h.context=null}_createCanvas(h,p){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}r.BaseCanvasFactory=i;class l{constructor({baseUrl:h=null,isCompressed:p=!1}){this.constructor===l&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=h,this.isCompressed=p}async fetch({name:h}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!h)throw new Error("CMap name must be specified.");const p=this.baseUrl+h+(this.isCompressed?".bcmap":""),E=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(p,E).catch(v=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${p}`)})}_fetchData(h,p){(0,n.unreachable)("Abstract method `_fetchData` called.")}}r.BaseCMapReaderFactory=l;class c{constructor({baseUrl:h=null}){this.constructor===c&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=h}async fetch({filename:h}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!h)throw new Error("Font filename must be specified.");const p=`${this.baseUrl}${h}`;return this._fetchData(p).catch(E=>{throw new Error(`Unable to load font data at: ${p}`)})}_fetchData(h){(0,n.unreachable)("Abstract method `_fetchData` called.")}}r.BaseStandardFontDataFactory=c;class f{constructor(){this.constructor===f&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(h,p,E=!1){if(h<=0||p<=0)throw new Error("Invalid SVG dimensions");const v=this._createSVG("svg:svg");return v.setAttribute("version","1.1"),E||(v.setAttribute("width",`${h}px`),v.setAttribute("height",`${p}px`)),v.setAttribute("preserveAspectRatio","none"),v.setAttribute("viewBox",`0 0 ${h} ${p}`),v}createElement(h){if(typeof h!="string")throw new Error("Invalid SVG element type");return this._createSVG(h)}_createSVG(h){(0,n.unreachable)("Abstract method `_createSVG` called.")}}r.BaseSVGFactory=f},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.MurmurHash3_64=void 0;var n=t(1);const i=3285377520,l=4294901760,c=65535;class f{constructor(h){this.h1=h?h&4294967295:i,this.h2=h?h&4294967295:i}update(h){let p,E;if(typeof h=="string"){p=new Uint8Array(h.length*2),E=0;for(let y=0,N=h.length;y<N;y++){const L=h.charCodeAt(y);L<=255?p[E++]=L:(p[E++]=L>>>8,p[E++]=L&255)}}else if((0,n.isArrayBuffer)(h))p=h.slice(),E=p.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const v=E>>2,S=E-v*4,x=new Uint32Array(p.buffer,0,v);let g=0,m=0,b=this.h1,D=this.h2;const C=3432918353,F=461845907,T=C&c,w=F&c;for(let y=0;y<v;y++)y&1?(g=x[y],g=g*C&l|g*T&c,g=g<<15|g>>>17,g=g*F&l|g*w&c,b^=g,b=b<<13|b>>>19,b=b*5+3864292196):(m=x[y],m=m*C&l|m*T&c,m=m<<15|m>>>17,m=m*F&l|m*w&c,D^=m,D=D<<13|D>>>19,D=D*5+3864292196);switch(g=0,S){case 3:g^=p[v*4+2]<<16;case 2:g^=p[v*4+1]<<8;case 1:g^=p[v*4],g=g*C&l|g*T&c,g=g<<15|g>>>17,g=g*F&l|g*w&c,v&1?b^=g:D^=g}this.h1=b,this.h2=D}hexdigest(){let h=this.h1,p=this.h2;h^=p>>>1,h=h*3981806797&l|h*36045&c,p=p*4283543511&l|((p<<16|h>>>16)*2950163797&l)>>>16,h^=p>>>1,h=h*444984403&l|h*60499&c,p=p*3301882366&l|((p<<16|h>>>16)*3120437893&l)>>>16,h^=p>>>1;const E=(h>>>0).toString(16),v=(p>>>0).toString(16);return E.padStart(8,"0")+v.padStart(8,"0")}}r.MurmurHash3_64=f},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.FontLoader=r.FontFaceObject=void 0;var n=t(1);class i{constructor({docId:d,onUnsupportedFeature:h,ownerDocument:p=globalThis.document,styleElement:E=null}){this.constructor===i&&(0,n.unreachable)("Cannot initialize BaseFontLoader."),this.docId=d,this._onUnsupportedFeature=h,this._document=p,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(d){this.nativeFontFaces.push(d),this._document.fonts.add(d)}insertRule(d){let h=this.styleElement;h||(h=this.styleElement=this._document.createElement("style"),h.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(h));const p=h.sheet;p.insertRule(d,p.cssRules.length)}clear(){for(const d of this.nativeFontFaces)this._document.fonts.delete(d);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(d){if(d.attached||d.missingFile)return;if(d.attached=!0,this.isFontLoadingAPISupported){const p=d.createNativeFontFace();if(p){this.addNativeFontFace(p);try{await p.loaded}catch(E){throw this._onUnsupportedFeature({featureId:n.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,n.warn)(`Failed to load font '${p.family}': '${E}'.`),d.disableFontFace=!0,E}}return}const h=d.createFontFaceRule();if(h){if(this.insertRule(h),this.isSyncFontLoadingSupported)return;await new Promise(p=>{const E=this._queueLoadingCallback(p);this._prepareFontLoadEvent([h],[d],E)})}}_queueLoadingCallback(d){(0,n.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var h;const d=!!((h=this._document)!=null&&h.fonts);return(0,n.shadow)(this,"isFontLoadingAPISupported",d)}get isSyncFontLoadingSupported(){(0,n.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,n.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(d,h,p){(0,n.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let l;r.FontLoader=l,r.FontLoader=l=class extends i{constructor(d){super(d),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let d=!1;if(typeof navigator>"u")d=!0;else{const h=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(h==null?void 0:h[1])>=14&&(d=!0)}return(0,n.shadow)(this,"isSyncFontLoadingSupported",d)}_queueLoadingCallback(d){function h(){for((0,n.assert)(!E.done,"completeRequest() cannot be called twice."),E.done=!0;p.requests.length>0&&p.requests[0].done;){const v=p.requests.shift();setTimeout(v.callback,0)}}const p=this.loadingContext,E={id:`pdfjs-font-loading-${p.nextRequestId++}`,done:!1,complete:h,callback:d};return p.requests.push(E),E}get _loadTestFont(){const d=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,n.shadow)(this,"_loadTestFont",d())}_prepareFontLoadEvent(d,h,p){function E(me,_e){return me.charCodeAt(_e)<<24|me.charCodeAt(_e+1)<<16|me.charCodeAt(_e+2)<<8|me.charCodeAt(_e+3)&255}function v(me,_e,de,Y){const ie=me.substring(0,_e),fe=me.substring(_e+de);return ie+Y+fe}let S,x;const g=this._document.createElement("canvas");g.width=1,g.height=1;const m=g.getContext("2d");let b=0;function D(me,_e){if(b++,b>30){(0,n.warn)("Load test font never loaded."),_e();return}if(m.font="30px "+me,m.fillText(".",0,20),m.getImageData(0,0,1,1).data[3]>0){_e();return}setTimeout(D.bind(null,me,_e))}const C=`lt${Date.now()}${this.loadTestFontId++}`;let F=this._loadTestFont;F=v(F,976,C.length,C);const w=16,y=1482184792;let N=E(F,w);for(S=0,x=C.length-3;S<x;S+=4)N=N-y+E(C,S)|0;S<C.length&&(N=N-y+E(C+"XXX",S)|0),F=v(F,w,4,(0,n.string32)(N));const L=`url(data:font/opentype;base64,${btoa(F)});`,X=`@font-face {font-family:"${C}";src:${L}}`;this.insertRule(X);const z=[];for(const me of h)z.push(me.loadedName);z.push(C);const se=this._document.createElement("div");se.style.visibility="hidden",se.style.width=se.style.height="10px",se.style.position="absolute",se.style.top=se.style.left="0px";for(const me of z){const _e=this._document.createElement("span");_e.textContent="Hi",_e.style.fontFamily=me,se.append(_e)}this._document.body.append(se),D(C,()=>{se.remove(),p.complete()})}};class c{constructor(d,{isEvalSupported:h=!0,disableFontFace:p=!1,ignoreErrors:E=!1,onUnsupportedFeature:v,fontRegistry:S=null}){this.compiledGlyphs=Object.create(null);for(const x in d)this[x]=d[x];this.isEvalSupported=h!==!1,this.disableFontFace=p===!0,this.ignoreErrors=E===!0,this._onUnsupportedFeature=v,this.fontRegistry=S}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let d;if(!this.cssFontInfo)d=new FontFace(this.loadedName,this.data,{});else{const h={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(h.style=`oblique ${this.cssFontInfo.italicAngle}deg`),d=new FontFace(this.cssFontInfo.fontFamily,this.data,h)}return this.fontRegistry&&this.fontRegistry.registerFont(this),d}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const d=(0,n.bytesToString)(this.data),h=`url(data:${this.mimetype};base64,${btoa(d)});`;let p;if(!this.cssFontInfo)p=`@font-face {font-family:"${this.loadedName}";src:${h}}`;else{let E=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(E+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),p=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${E}src:${h}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,h),p}getPathGenerator(d,h){if(this.compiledGlyphs[h]!==void 0)return this.compiledGlyphs[h];let p;try{p=d.get(this.loadedName+"_path_"+h)}catch(E){if(!this.ignoreErrors)throw E;return this._onUnsupportedFeature({featureId:n.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,n.warn)(`getPathGenerator - ignoring character: "${E}".`),this.compiledGlyphs[h]=function(v,S){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const E=[];for(const v of p){const S=v.args!==void 0?v.args.join(","):"";E.push("c.",v.cmd,"(",S,`);
`)}return this.compiledGlyphs[h]=new Function("c","size",E.join(""))}return this.compiledGlyphs[h]=function(E,v){for(const S of p)S.cmd==="scale"&&(S.args=[v,-v]),E[S.cmd].apply(E,S.args)}}}r.FontFaceObject=c},(e,r,t)=>{var ae,zl;Object.defineProperty(r,"__esModule",{value:!0}),r.CanvasGraphics=void 0;var n=t(8),i=t(1),l=t(13),c=t(14),f=t(3);const d=16,h=100,p=4096,E=15,v=10,S=f.isNodeJS&&typeof Path2D>"u"?-1:1e3,x=16;function g(I,M){if(I._removeMirroring)throw new Error("Context is already forwarding operations.");I.__originalSave=I.save,I.__originalRestore=I.restore,I.__originalRotate=I.rotate,I.__originalScale=I.scale,I.__originalTranslate=I.translate,I.__originalTransform=I.transform,I.__originalSetTransform=I.setTransform,I.__originalResetTransform=I.resetTransform,I.__originalClip=I.clip,I.__originalMoveTo=I.moveTo,I.__originalLineTo=I.lineTo,I.__originalBezierCurveTo=I.bezierCurveTo,I.__originalRect=I.rect,I.__originalClosePath=I.closePath,I.__originalBeginPath=I.beginPath,I._removeMirroring=()=>{I.save=I.__originalSave,I.restore=I.__originalRestore,I.rotate=I.__originalRotate,I.scale=I.__originalScale,I.translate=I.__originalTranslate,I.transform=I.__originalTransform,I.setTransform=I.__originalSetTransform,I.resetTransform=I.__originalResetTransform,I.clip=I.__originalClip,I.moveTo=I.__originalMoveTo,I.lineTo=I.__originalLineTo,I.bezierCurveTo=I.__originalBezierCurveTo,I.rect=I.__originalRect,I.closePath=I.__originalClosePath,I.beginPath=I.__originalBeginPath,delete I._removeMirroring},I.save=function(){M.save(),this.__originalSave()},I.restore=function(){M.restore(),this.__originalRestore()},I.translate=function(U,V){M.translate(U,V),this.__originalTranslate(U,V)},I.scale=function(U,V){M.scale(U,V),this.__originalScale(U,V)},I.transform=function(U,V,Z,J,O,B){M.transform(U,V,Z,J,O,B),this.__originalTransform(U,V,Z,J,O,B)},I.setTransform=function(U,V,Z,J,O,B){M.setTransform(U,V,Z,J,O,B),this.__originalSetTransform(U,V,Z,J,O,B)},I.resetTransform=function(){M.resetTransform(),this.__originalResetTransform()},I.rotate=function(U){M.rotate(U),this.__originalRotate(U)},I.clip=function(U){M.clip(U),this.__originalClip(U)},I.moveTo=function(R,U){M.moveTo(R,U),this.__originalMoveTo(R,U)},I.lineTo=function(R,U){M.lineTo(R,U),this.__originalLineTo(R,U)},I.bezierCurveTo=function(R,U,V,Z,J,O){M.bezierCurveTo(R,U,V,Z,J,O),this.__originalBezierCurveTo(R,U,V,Z,J,O)},I.rect=function(R,U,V,Z){M.rect(R,U,V,Z),this.__originalRect(R,U,V,Z)},I.closePath=function(){M.closePath(),this.__originalClosePath()},I.beginPath=function(){M.beginPath(),this.__originalBeginPath()}}class m{constructor(M){this.canvasFactory=M,this.cache=Object.create(null)}getCanvas(M,R,U){let V;return this.cache[M]!==void 0?(V=this.cache[M],this.canvasFactory.reset(V,R,U)):(V=this.canvasFactory.create(R,U),this.cache[M]=V),V}delete(M){delete this.cache[M]}clear(){for(const M in this.cache){const R=this.cache[M];this.canvasFactory.destroy(R),delete this.cache[M]}}}function b(I,M,R,U,V,Z,J,O,B,G){const[P,K,oe,re,H,Q]=(0,n.getCurrentTransform)(I);if(K===0&&oe===0){const ye=J*P+H,we=Math.round(ye),Le=O*re+Q,Ve=Math.round(Le),Ce=(J+B)*P+H,nt=Math.abs(Math.round(Ce)-we)||1,tt=(O+G)*re+Q,Je=Math.abs(Math.round(tt)-Ve)||1;return I.setTransform(Math.sign(P),0,0,Math.sign(re),we,Ve),I.drawImage(M,R,U,V,Z,0,0,nt,Je),I.setTransform(P,K,oe,re,H,Q),[nt,Je]}if(P===0&&re===0){const ye=O*oe+H,we=Math.round(ye),Le=J*K+Q,Ve=Math.round(Le),Ce=(O+G)*oe+H,nt=Math.abs(Math.round(Ce)-we)||1,tt=(J+B)*K+Q,Je=Math.abs(Math.round(tt)-Ve)||1;return I.setTransform(0,Math.sign(K),Math.sign(oe),0,we,Ve),I.drawImage(M,R,U,V,Z,0,0,Je,nt),I.setTransform(P,K,oe,re,H,Q),[Je,nt]}I.drawImage(M,R,U,V,Z,J,O,B,G);const be=Math.hypot(P,K),ge=Math.hypot(oe,re);return[be*B,ge*G]}function D(I){const{width:M,height:R}=I;if(M>S||R>S)return null;const U=1e3,V=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),Z=M+1;let J=new Uint8Array(Z*(R+1)),O,B,G;const P=M+7&-8;let K=new Uint8Array(P*R),oe=0;for(const ge of I.data){let ye=128;for(;ye>0;)K[oe++]=ge&ye?0:255,ye>>=1}let re=0;for(oe=0,K[oe]!==0&&(J[0]=1,++re),B=1;B<M;B++)K[oe]!==K[oe+1]&&(J[B]=K[oe]?2:1,++re),oe++;for(K[oe]!==0&&(J[B]=2,++re),O=1;O<R;O++){oe=O*P,G=O*Z,K[oe-P]!==K[oe]&&(J[G]=K[oe]?1:8,++re);let ge=(K[oe]?4:0)+(K[oe-P]?8:0);for(B=1;B<M;B++)ge=(ge>>2)+(K[oe+1]?4:0)+(K[oe-P+1]?8:0),V[ge]&&(J[G+B]=V[ge],++re),oe++;if(K[oe-P]!==K[oe]&&(J[G+B]=K[oe]?2:4,++re),re>U)return null}for(oe=P*(R-1),G=O*Z,K[oe]!==0&&(J[G]=8,++re),B=1;B<M;B++)K[oe]!==K[oe+1]&&(J[G+B]=K[oe]?4:8,++re),oe++;if(K[oe]!==0&&(J[G+B]=4,++re),re>U)return null;const H=new Int32Array([0,Z,-1,0,-Z,0,0,0,1]),Q=new Path2D;for(O=0;re&&O<=R;O++){let ge=O*Z;const ye=ge+M;for(;ge<ye&&!J[ge];)ge++;if(ge===ye)continue;Q.moveTo(ge%Z,O);const we=ge;let Le=J[ge];do{const Ve=H[Le];do ge+=Ve;while(!J[ge]);const Ce=J[ge];Ce!==5&&Ce!==10?(Le=Ce,J[ge]=0):(Le=Ce&51*Le>>4,J[ge]&=Le>>2|Le<<2),Q.lineTo(ge%Z,ge/Z|0),J[ge]||--re}while(we!==ge);--O}return K=null,J=null,function(ge){ge.save(),ge.scale(1/M,-1/R),ge.translate(0,-R),ge.fill(Q),ge.beginPath(),ge.restore()}}class C{constructor(M,R){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=i.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=i.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,M,R])}clone(){const M=Object.create(this);return M.clipBox=this.clipBox.slice(),M}setCurrentPoint(M,R){this.x=M,this.y=R}updatePathMinMax(M,R,U){[R,U]=i.Util.applyTransform([R,U],M),this.minX=Math.min(this.minX,R),this.minY=Math.min(this.minY,U),this.maxX=Math.max(this.maxX,R),this.maxY=Math.max(this.maxY,U)}updateRectMinMax(M,R){const U=i.Util.applyTransform(R,M),V=i.Util.applyTransform(R.slice(2),M);this.minX=Math.min(this.minX,U[0],V[0]),this.minY=Math.min(this.minY,U[1],V[1]),this.maxX=Math.max(this.maxX,U[0],V[0]),this.maxY=Math.max(this.maxY,U[1],V[1])}updateScalingPathMinMax(M,R){i.Util.scaleMinMax(M,R),this.minX=Math.min(this.minX,R[0]),this.maxX=Math.max(this.maxX,R[1]),this.minY=Math.min(this.minY,R[2]),this.maxY=Math.max(this.maxY,R[3])}updateCurvePathMinMax(M,R,U,V,Z,J,O,B,G,P){const K=i.Util.bezierBoundingBox(R,U,V,Z,J,O,B,G);if(P){P[0]=Math.min(P[0],K[0],K[2]),P[1]=Math.max(P[1],K[0],K[2]),P[2]=Math.min(P[2],K[1],K[3]),P[3]=Math.max(P[3],K[1],K[3]);return}this.updateRectMinMax(M,K)}getPathBoundingBox(M=l.PathType.FILL,R=null){const U=[this.minX,this.minY,this.maxX,this.maxY];if(M===l.PathType.STROKE){R||(0,i.unreachable)("Stroke bounding box must include transform.");const V=i.Util.singularValueDecompose2dScale(R),Z=V[0]*this.lineWidth/2,J=V[1]*this.lineWidth/2;U[0]-=Z,U[1]-=J,U[2]+=Z,U[3]+=J}return U}updateClipFromPath(){const M=i.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(M||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(M){this.clipBox=M,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(M=l.PathType.FILL,R=null){return i.Util.intersect(this.clipBox,this.getPathBoundingBox(M,R))}}function F(I,M,R=null){if(typeof ImageData<"u"&&M instanceof ImageData){I.putImageData(M,0,0);return}const U=M.height,V=M.width,Z=U%x,J=(U-Z)/x,O=Z===0?J:J+1,B=I.createImageData(V,x);let G=0,P;const K=M.data,oe=B.data;let re,H,Q,be,ge,ye,we,Le;if(R)switch(R.length){case 1:ge=R[0],ye=R[0],we=R[0],Le=R[0];break;case 4:ge=R[0],ye=R[1],we=R[2],Le=R[3];break}if(M.kind===i.ImageKind.GRAYSCALE_1BPP){const Ve=K.byteLength,Ce=new Uint32Array(oe.buffer,0,oe.byteLength>>2),nt=Ce.length,tt=V+7>>3;let Je=4294967295,et=i.FeatureTest.isLittleEndian?4278190080:255;for(Le&&Le[0]===255&&Le[255]===0&&([Je,et]=[et,Je]),re=0;re<O;re++){for(Q=re<J?x:Z,P=0,H=0;H<Q;H++){const ht=Ve-G;let Qe=0;const it=ht>tt?V:ht*8-7,pt=it&-8;let st=0,ct=0;for(;Qe<pt;Qe+=8)ct=K[G++],Ce[P++]=ct&128?Je:et,Ce[P++]=ct&64?Je:et,Ce[P++]=ct&32?Je:et,Ce[P++]=ct&16?Je:et,Ce[P++]=ct&8?Je:et,Ce[P++]=ct&4?Je:et,Ce[P++]=ct&2?Je:et,Ce[P++]=ct&1?Je:et;for(;Qe<it;Qe++)st===0&&(ct=K[G++],st=128),Ce[P++]=ct&st?Je:et,st>>=1}for(;P<nt;)Ce[P++]=0;I.putImageData(B,0,re*x)}}else if(M.kind===i.ImageKind.RGBA_32BPP){const Ve=!!(ge||ye||we);for(H=0,be=V*x*4,re=0;re<J;re++){if(oe.set(K.subarray(G,G+be)),G+=be,Ve)for(let Ce=0;Ce<be;Ce+=4)ge&&(oe[Ce+0]=ge[oe[Ce+0]]),ye&&(oe[Ce+1]=ye[oe[Ce+1]]),we&&(oe[Ce+2]=we[oe[Ce+2]]);I.putImageData(B,0,H),H+=x}if(re<O){if(be=V*Z*4,oe.set(K.subarray(G,G+be)),Ve)for(let Ce=0;Ce<be;Ce+=4)ge&&(oe[Ce+0]=ge[oe[Ce+0]]),ye&&(oe[Ce+1]=ye[oe[Ce+1]]),we&&(oe[Ce+2]=we[oe[Ce+2]]);I.putImageData(B,0,H)}}else if(M.kind===i.ImageKind.RGB_24BPP){const Ve=!!(ge||ye||we);for(Q=x,be=V*Q,re=0;re<O;re++){for(re>=J&&(Q=Z,be=V*Q),P=0,H=be;H--;)oe[P++]=K[G++],oe[P++]=K[G++],oe[P++]=K[G++],oe[P++]=255;if(Ve)for(let Ce=0;Ce<P;Ce+=4)ge&&(oe[Ce+0]=ge[oe[Ce+0]]),ye&&(oe[Ce+1]=ye[oe[Ce+1]]),we&&(oe[Ce+2]=we[oe[Ce+2]]);I.putImageData(B,0,re*x)}}else throw new Error(`bad image kind: ${M.kind}`)}function T(I,M){if(M.bitmap){I.drawImage(M.bitmap,0,0);return}const R=M.height,U=M.width,V=R%x,Z=(R-V)/x,J=V===0?Z:Z+1,O=I.createImageData(U,x);let B=0;const G=M.data,P=O.data;for(let K=0;K<J;K++){const oe=K<Z?x:V;({srcPos:B}=(0,c.applyMaskImageData)({src:G,srcPos:B,dest:P,width:U,height:oe})),I.putImageData(O,0,K*x)}}function w(I,M){const R=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let U=0,V=R.length;U<V;U++){const Z=R[U];I[Z]!==void 0&&(M[Z]=I[Z])}I.setLineDash!==void 0&&(M.setLineDash(I.getLineDash()),M.lineDashOffset=I.lineDashOffset)}function y(I,M){I.strokeStyle=I.fillStyle=M||"#000000",I.fillRule="nonzero",I.globalAlpha=1,I.lineWidth=1,I.lineCap="butt",I.lineJoin="miter",I.miterLimit=10,I.globalCompositeOperation="source-over",I.font="10px sans-serif",I.setLineDash!==void 0&&(I.setLineDash([]),I.lineDashOffset=0)}function N(I,M,R,U){const V=I.length;for(let Z=3;Z<V;Z+=4){const J=I[Z];if(J===0)I[Z-3]=M,I[Z-2]=R,I[Z-1]=U;else if(J<255){const O=255-J;I[Z-3]=I[Z-3]*J+M*O>>8,I[Z-2]=I[Z-2]*J+R*O>>8,I[Z-1]=I[Z-1]*J+U*O>>8}}}function L(I,M,R){const U=I.length,V=1/255;for(let Z=3;Z<U;Z+=4){const J=R?R[I[Z]]:I[Z];M[Z]=M[Z]*J*V|0}}function X(I,M,R){const U=I.length;for(let V=3;V<U;V+=4){const Z=I[V-3]*77+I[V-2]*152+I[V-1]*28;M[V]=R?M[V]*R[Z>>8]>>8:M[V]*Z>>16}}function z(I,M,R,U,V,Z,J,O,B,G,P){const K=!!Z,oe=K?Z[0]:0,re=K?Z[1]:0,H=K?Z[2]:0;let Q;V==="Luminosity"?Q=X:Q=L;const ge=Math.min(U,Math.ceil(1048576/R));for(let ye=0;ye<U;ye+=ge){const we=Math.min(ge,U-ye),Le=I.getImageData(O-G,ye+(B-P),R,we),Ve=M.getImageData(O,ye+B,R,we);K&&N(Le.data,oe,re,H),Q(Le.data,Ve.data,J),M.putImageData(Ve,O,ye+B)}}function se(I,M,R,U){const V=U[0],Z=U[1],J=U[2]-V,O=U[3]-Z;J===0||O===0||(z(M.context,R,J,O,M.subtype,M.backdrop,M.transferMap,V,Z,M.offsetX,M.offsetY),I.save(),I.globalAlpha=1,I.globalCompositeOperation="source-over",I.setTransform(1,0,0,1,0,0),I.drawImage(R.canvas,0,0),I.restore())}function me(I,M){const R=i.Util.singularValueDecompose2dScale(I);R[0]=Math.fround(R[0]),R[1]=Math.fround(R[1]);const U=Math.fround((globalThis.devicePixelRatio||1)*n.PixelsPerInch.PDF_TO_CSS_UNITS);return M!==void 0?M:R[0]<=U||R[1]<=U}const _e=["butt","round","square"],de=["miter","round","bevel"],Y={},ie={},xe=class xe{constructor(M,R,U,V,Z,J,O,B){qe(this,ae);this.ctx=M,this.current=new C(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=R,this.objs=U,this.canvasFactory=V,this.imageLayer=Z,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=J,this.cachedCanvases=new m(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=O,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(B==null?void 0:B.background)||null,this.foregroundColor=(B==null?void 0:B.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(M,R=null){return typeof M=="string"?M.startsWith("g_")?this.commonObjs.get(M):this.objs.get(M):R}beginDrawing({transform:M,viewport:R,transparency:U=!1,background:V=null}){const Z=this.ctx.canvas.width,J=this.ctx.canvas.height,O=V||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const B=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const G=this.backgroundColor=this.ctx.fillStyle;let P=!0,K=O;if(this.ctx.fillStyle=O,K=this.ctx.fillStyle,P=typeof K=="string"&&/^#[0-9A-Fa-f]{6}$/.test(K),B==="#000000"&&G==="#ffffff"||B===G||!P)this.foregroundColor=this.backgroundColor=null;else{const[oe,re,H]=(0,n.getRGB)(K),Q=ge=>(ge/=255,ge<=.03928?ge/12.92:((ge+.055)/1.055)**2.4),be=Math.round(.2126*Q(oe)+.7152*Q(re)+.0722*Q(H));this.selectColor=(ge,ye,we)=>{const Le=.2126*Q(ge)+.7152*Q(ye)+.0722*Q(we);return Math.round(Le)===be?G:B}}}if(this.ctx.fillStyle=this.backgroundColor||O,this.ctx.fillRect(0,0,Z,J),this.ctx.restore(),U){const B=this.cachedCanvases.getCanvas("transparent",Z,J);this.compositeCtx=this.ctx,this.transparentCanvas=B.canvas,this.ctx=B.context,this.ctx.save(),this.ctx.transform(...(0,n.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),y(this.ctx,this.foregroundColor),M&&(this.ctx.transform(...M),this.outputScaleX=M[0],this.outputScaleY=M[0]),this.ctx.transform(...R.transform),this.viewportScale=R.scale,this.baseTransform=(0,n.getCurrentTransform)(this.ctx),this.imageLayer&&((0,n.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}executeOperatorList(M,R,U,V){const Z=M.argsArray,J=M.fnArray;let O=R||0;const B=Z.length;if(B===O)return O;const G=B-O>v&&typeof U=="function",P=G?Date.now()+E:0;let K=0;const oe=this.commonObjs,re=this.objs;let H;for(;;){if(V!==void 0&&O===V.nextBreakPoint)return V.breakIt(O,U),O;if(H=J[O],H!==i.OPS.dependency)this[H].apply(this,Z[O]);else for(const Q of Z[O]){const be=Q.startsWith("g_")?oe:re;if(!be.has(Q))return be.get(Q,U),O}if(O++,O===B)return O;if(G&&++K>v){if(Date.now()>P)return U(),O;K=0}}}endDrawing(){je(this,ae,zl).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const M of this._cachedBitmapsMap.values()){for(const R of M.values())typeof HTMLCanvasElement<"u"&&R instanceof HTMLCanvasElement&&(R.width=R.height=0);M.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(M,R){const U=M.width,V=M.height;let Z=Math.max(Math.hypot(R[0],R[1]),1),J=Math.max(Math.hypot(R[2],R[3]),1),O=U,B=V,G="prescale1",P,K;for(;Z>2&&O>1||J>2&&B>1;){let oe=O,re=B;Z>2&&O>1&&(oe=Math.ceil(O/2),Z/=O/oe),J>2&&B>1&&(re=Math.ceil(B/2),J/=B/re),P=this.cachedCanvases.getCanvas(G,oe,re),K=P.context,K.clearRect(0,0,oe,re),K.drawImage(M,0,0,O,B,0,0,oe,re),M=P.canvas,O=oe,B=re,G=G==="prescale1"?"prescale2":"prescale1"}return{img:M,paintWidth:O,paintHeight:B}}_createMaskCanvas(M){const R=this.ctx,{width:U,height:V}=M,Z=this.current.fillColor,J=this.current.patternFill,O=(0,n.getCurrentTransform)(R);let B,G,P,K;if((M.bitmap||M.data)&&M.count>1){const nt=M.bitmap||M.data.buffer,tt=O.slice(0,4);G=JSON.stringify(J?tt:[tt,Z]),B=this._cachedBitmapsMap.get(nt),B||(B=new Map,this._cachedBitmapsMap.set(nt,B));const Je=B.get(G);if(Je&&!J){const et=Math.round(Math.min(O[0],O[2])+O[4]),ht=Math.round(Math.min(O[1],O[3])+O[5]);return{canvas:Je,offsetX:et,offsetY:ht}}P=Je}P||(K=this.cachedCanvases.getCanvas("maskCanvas",U,V),T(K.context,M));let oe=i.Util.transform(O,[1/U,0,0,-1/V,0,0]);oe=i.Util.transform(oe,[1,0,0,1,0,-V]);const re=i.Util.applyTransform([0,0],oe),H=i.Util.applyTransform([U,V],oe),Q=i.Util.normalizeRect([re[0],re[1],H[0],H[1]]),be=Math.round(Q[2]-Q[0])||1,ge=Math.round(Q[3]-Q[1])||1,ye=this.cachedCanvases.getCanvas("fillCanvas",be,ge),we=ye.context,Le=Math.min(re[0],H[0]),Ve=Math.min(re[1],H[1]);we.translate(-Le,-Ve),we.transform(...oe),P||(P=this._scaleImage(K.canvas,(0,n.getCurrentTransformInverse)(we)),P=P.img,B&&J&&B.set(G,P)),we.imageSmoothingEnabled=me((0,n.getCurrentTransform)(we),M.interpolate),b(we,P,0,0,P.width,P.height,0,0,U,V),we.globalCompositeOperation="source-in";const Ce=i.Util.transform((0,n.getCurrentTransformInverse)(we),[1,0,0,1,-Le,-Ve]);return we.fillStyle=J?Z.getPattern(R,this,Ce,l.PathType.FILL):Z,we.fillRect(0,0,U,V),B&&!J&&(this.cachedCanvases.delete("fillCanvas"),B.set(G,ye.canvas)),{canvas:ye.canvas,offsetX:Math.round(Le),offsetY:Math.round(Ve)}}setLineWidth(M){M!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=M,this.ctx.lineWidth=M}setLineCap(M){this.ctx.lineCap=_e[M]}setLineJoin(M){this.ctx.lineJoin=de[M]}setMiterLimit(M){this.ctx.miterLimit=M}setDash(M,R){const U=this.ctx;U.setLineDash!==void 0&&(U.setLineDash(M),U.lineDashOffset=R)}setRenderingIntent(M){}setFlatness(M){}setGState(M){for(let R=0,U=M.length;R<U;R++){const V=M[R],Z=V[0],J=V[1];switch(Z){case"LW":this.setLineWidth(J);break;case"LC":this.setLineCap(J);break;case"LJ":this.setLineJoin(J);break;case"ML":this.setMiterLimit(J);break;case"D":this.setDash(J[0],J[1]);break;case"RI":this.setRenderingIntent(J);break;case"FL":this.setFlatness(J);break;case"Font":this.setFont(J[0],J[1]);break;case"CA":this.current.strokeAlpha=V[1];break;case"ca":this.current.fillAlpha=V[1],this.ctx.globalAlpha=V[1];break;case"BM":this.ctx.globalCompositeOperation=J;break;case"SMask":this.current.activeSMask=J?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=J}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const M=this.inSMaskMode;this.current.activeSMask&&!M?this.beginSMaskMode():!this.current.activeSMask&&M&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const M=this.ctx.canvas.width,R=this.ctx.canvas.height,U="smaskGroupAt"+this.groupLevel,V=this.cachedCanvases.getCanvas(U,M,R);this.suspendedCtx=this.ctx,this.ctx=V.context;const Z=this.ctx;Z.setTransform(...(0,n.getCurrentTransform)(this.suspendedCtx)),w(this.suspendedCtx,Z),g(Z,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),w(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(M){if(!this.current.activeSMask)return;M?(M[0]=Math.floor(M[0]),M[1]=Math.floor(M[1]),M[2]=Math.ceil(M[2]),M[3]=Math.ceil(M[3])):M=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const R=this.current.activeSMask,U=this.suspendedCtx;se(U,R,this.ctx,M),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(w(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const M=this.current;this.stateStack.push(M),this.current=M.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),w(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(M,R,U,V,Z,J){this.ctx.transform(M,R,U,V,Z,J),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(M,R,U){const V=this.ctx,Z=this.current;let J=Z.x,O=Z.y,B,G;const P=(0,n.getCurrentTransform)(V),K=P[0]===0&&P[3]===0||P[1]===0&&P[2]===0,oe=K?U.slice(0):null;for(let re=0,H=0,Q=M.length;re<Q;re++)switch(M[re]|0){case i.OPS.rectangle:J=R[H++],O=R[H++];const be=R[H++],ge=R[H++],ye=J+be,we=O+ge;V.moveTo(J,O),be===0||ge===0?V.lineTo(ye,we):(V.lineTo(ye,O),V.lineTo(ye,we),V.lineTo(J,we)),K||Z.updateRectMinMax(P,[J,O,ye,we]),V.closePath();break;case i.OPS.moveTo:J=R[H++],O=R[H++],V.moveTo(J,O),K||Z.updatePathMinMax(P,J,O);break;case i.OPS.lineTo:J=R[H++],O=R[H++],V.lineTo(J,O),K||Z.updatePathMinMax(P,J,O);break;case i.OPS.curveTo:B=J,G=O,J=R[H+4],O=R[H+5],V.bezierCurveTo(R[H],R[H+1],R[H+2],R[H+3],J,O),Z.updateCurvePathMinMax(P,B,G,R[H],R[H+1],R[H+2],R[H+3],J,O,oe),H+=6;break;case i.OPS.curveTo2:B=J,G=O,V.bezierCurveTo(J,O,R[H],R[H+1],R[H+2],R[H+3]),Z.updateCurvePathMinMax(P,B,G,J,O,R[H],R[H+1],R[H+2],R[H+3],oe),J=R[H+2],O=R[H+3],H+=4;break;case i.OPS.curveTo3:B=J,G=O,J=R[H+2],O=R[H+3],V.bezierCurveTo(R[H],R[H+1],J,O,J,O),Z.updateCurvePathMinMax(P,B,G,R[H],R[H+1],J,O,J,O,oe),H+=4;break;case i.OPS.closePath:V.closePath();break}K&&Z.updateScalingPathMinMax(P,oe),Z.setCurrentPoint(J,O)}closePath(){this.ctx.closePath()}stroke(M){M=typeof M<"u"?M:!0;const R=this.ctx,U=this.current.strokeColor;R.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof U=="object"&&(U!=null&&U.getPattern)?(R.save(),R.strokeStyle=U.getPattern(R,this,(0,n.getCurrentTransformInverse)(R),l.PathType.STROKE),this.rescaleAndStroke(!1),R.restore()):this.rescaleAndStroke(!0)),M&&this.consumePath(this.current.getClippedPathBoundingBox()),R.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(M){M=typeof M<"u"?M:!0;const R=this.ctx,U=this.current.fillColor,V=this.current.patternFill;let Z=!1;V&&(R.save(),R.fillStyle=U.getPattern(R,this,(0,n.getCurrentTransformInverse)(R),l.PathType.FILL),Z=!0);const J=this.current.getClippedPathBoundingBox();this.contentVisible&&J!==null&&(this.pendingEOFill?(R.fill("evenodd"),this.pendingEOFill=!1):R.fill()),Z&&R.restore(),M&&this.consumePath(J)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Y}eoClip(){this.pendingClip=ie}beginText(){this.current.textMatrix=i.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const M=this.pendingTextPaths,R=this.ctx;if(M===void 0){R.beginPath();return}R.save(),R.beginPath();for(const U of M)R.setTransform(...U.transform),R.translate(U.x,U.y),U.addToPath(R,U.fontSize);R.restore(),R.clip(),R.beginPath(),delete this.pendingTextPaths}setCharSpacing(M){this.current.charSpacing=M}setWordSpacing(M){this.current.wordSpacing=M}setHScale(M){this.current.textHScale=M/100}setLeading(M){this.current.leading=-M}setFont(M,R){const U=this.commonObjs.get(M),V=this.current;if(!U)throw new Error(`Can't find font for ${M}`);if(V.fontMatrix=U.fontMatrix||i.FONT_IDENTITY_MATRIX,(V.fontMatrix[0]===0||V.fontMatrix[3]===0)&&(0,i.warn)("Invalid font matrix for font "+M),R<0?(R=-R,V.fontDirection=-1):V.fontDirection=1,this.current.font=U,this.current.fontSize=R,U.isType3Font)return;const Z=U.loadedName||"sans-serif";let J="normal";U.black?J="900":U.bold&&(J="bold");const O=U.italic?"italic":"normal",B=`"${Z}", ${U.fallbackName}`;let G=R;R<d?G=d:R>h&&(G=h),this.current.fontSizeScale=R/G,this.ctx.font=`${O} ${J} ${G}px ${B}`}setTextRenderingMode(M){this.current.textRenderingMode=M}setTextRise(M){this.current.textRise=M}moveText(M,R){this.current.x=this.current.lineX+=M,this.current.y=this.current.lineY+=R}setLeadingMoveText(M,R){this.setLeading(-R),this.moveText(M,R)}setTextMatrix(M,R,U,V,Z,J){this.current.textMatrix=[M,R,U,V,Z,J],this.current.textMatrixScale=Math.hypot(M,R),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(M,R,U,V){const Z=this.ctx,J=this.current,O=J.font,B=J.textRenderingMode,G=J.fontSize/J.fontSizeScale,P=B&i.TextRenderingMode.FILL_STROKE_MASK,K=!!(B&i.TextRenderingMode.ADD_TO_PATH_FLAG),oe=J.patternFill&&!O.missingFile;let re;(O.disableFontFace||K||oe)&&(re=O.getPathGenerator(this.commonObjs,M)),O.disableFontFace||oe?(Z.save(),Z.translate(R,U),Z.beginPath(),re(Z,G),V&&Z.setTransform(...V),(P===i.TextRenderingMode.FILL||P===i.TextRenderingMode.FILL_STROKE)&&Z.fill(),(P===i.TextRenderingMode.STROKE||P===i.TextRenderingMode.FILL_STROKE)&&Z.stroke(),Z.restore()):((P===i.TextRenderingMode.FILL||P===i.TextRenderingMode.FILL_STROKE)&&Z.fillText(M,R,U),(P===i.TextRenderingMode.STROKE||P===i.TextRenderingMode.FILL_STROKE)&&Z.strokeText(M,R,U)),K&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,n.getCurrentTransform)(Z),x:R,y:U,fontSize:G,addToPath:re})}get isFontSubpixelAAEnabled(){const{context:M}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);M.scale(1.5,1),M.fillText("I",0,10);const R=M.getImageData(0,0,10,10).data;let U=!1;for(let V=3;V<R.length;V+=4)if(R[V]>0&&R[V]<255){U=!0;break}return(0,i.shadow)(this,"isFontSubpixelAAEnabled",U)}showText(M){const R=this.current,U=R.font;if(U.isType3Font)return this.showType3Text(M);const V=R.fontSize;if(V===0)return;const Z=this.ctx,J=R.fontSizeScale,O=R.charSpacing,B=R.wordSpacing,G=R.fontDirection,P=R.textHScale*G,K=M.length,oe=U.vertical,re=oe?1:-1,H=U.defaultVMetrics,Q=V*R.fontMatrix[0],be=R.textRenderingMode===i.TextRenderingMode.FILL&&!U.disableFontFace&&!R.patternFill;Z.save(),Z.transform(...R.textMatrix),Z.translate(R.x,R.y+R.textRise),G>0?Z.scale(P,-1):Z.scale(P,1);let ge;if(R.patternFill){Z.save();const Ce=R.fillColor.getPattern(Z,this,(0,n.getCurrentTransformInverse)(Z),l.PathType.FILL);ge=(0,n.getCurrentTransform)(Z),Z.restore(),Z.fillStyle=Ce}let ye=R.lineWidth;const we=R.textMatrixScale;if(we===0||ye===0){const Ce=R.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;(Ce===i.TextRenderingMode.STROKE||Ce===i.TextRenderingMode.FILL_STROKE)&&(ye=this.getSinglePixelWidth())}else ye/=we;J!==1&&(Z.scale(J,J),ye/=J),Z.lineWidth=ye;let Le=0,Ve;for(Ve=0;Ve<K;++Ve){const Ce=M[Ve];if(typeof Ce=="number"){Le+=re*Ce*V/1e3;continue}let nt=!1;const tt=(Ce.isSpace?B:0)+O,Je=Ce.fontChar,et=Ce.accent;let ht,Qe,it=Ce.width;if(oe){const st=Ce.vmetric||H,ct=-(Ce.vmetric?st[1]:it*.5)*Q,lr=st[2]*Q;it=st?-st[0]:it,ht=ct/J,Qe=(Le+lr)/J}else ht=Le/J,Qe=0;if(U.remeasure&&it>0){const st=Z.measureText(Je).width*1e3/V*J;if(it<st&&this.isFontSubpixelAAEnabled){const ct=it/st;nt=!0,Z.save(),Z.scale(ct,1),ht/=ct}else it!==st&&(ht+=(it-st)/2e3*V/J)}if(this.contentVisible&&(Ce.isInFont||U.missingFile)){if(be&&!et)Z.fillText(Je,ht,Qe);else if(this.paintChar(Je,ht,Qe,ge),et){const st=ht+V*et.offset.x/J,ct=Qe-V*et.offset.y/J;this.paintChar(et.fontChar,st,ct,ge)}}let pt;oe?pt=it*Q-tt*G:pt=it*Q+tt*G,Le+=pt,nt&&Z.restore()}oe?R.y-=Le:R.x+=Le*P,Z.restore(),this.compose()}showType3Text(M){const R=this.ctx,U=this.current,V=U.font,Z=U.fontSize,J=U.fontDirection,O=V.vertical?1:-1,B=U.charSpacing,G=U.wordSpacing,P=U.textHScale*J,K=U.fontMatrix||i.FONT_IDENTITY_MATRIX,oe=M.length,re=U.textRenderingMode===i.TextRenderingMode.INVISIBLE;let H,Q,be,ge;if(!(re||Z===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,R.save(),R.transform(...U.textMatrix),R.translate(U.x,U.y),R.scale(P,J),H=0;H<oe;++H){if(Q=M[H],typeof Q=="number"){ge=O*Q*Z/1e3,this.ctx.translate(ge,0),U.x+=ge*P;continue}const ye=(Q.isSpace?G:0)+B,we=V.charProcOperatorList[Q.operatorListId];if(!we){(0,i.warn)(`Type3 character "${Q.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Q,this.save(),R.scale(Z,Z),R.transform(...K),this.executeOperatorList(we),this.restore()),be=i.Util.applyTransform([Q.width,0],K)[0]*Z+ye,R.translate(be,0),U.x+=be*P}R.restore(),this.processingType3=null}}setCharWidth(M,R){}setCharWidthAndBounds(M,R,U,V,Z,J){this.ctx.rect(U,V,Z-U,J-V),this.ctx.clip(),this.endPath()}getColorN_Pattern(M){let R;if(M[0]==="TilingPattern"){const U=M[1],V=this.baseTransform||(0,n.getCurrentTransform)(this.ctx),Z={createCanvasGraphics:J=>new xe(J,this.commonObjs,this.objs,this.canvasFactory)};R=new l.TilingPattern(M,U,this.ctx,Z,V)}else R=this._getPattern(M[1],M[2]);return R}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(M,R,U){var Z;const V=((Z=this.selectColor)==null?void 0:Z.call(this,M,R,U))||i.Util.makeHexColor(M,R,U);this.ctx.strokeStyle=V,this.current.strokeColor=V}setFillRGBColor(M,R,U){var Z;const V=((Z=this.selectColor)==null?void 0:Z.call(this,M,R,U))||i.Util.makeHexColor(M,R,U);this.ctx.fillStyle=V,this.current.fillColor=V,this.current.patternFill=!1}_getPattern(M,R=null){let U;return this.cachedPatterns.has(M)?U=this.cachedPatterns.get(M):(U=(0,l.getShadingPattern)(this.objs.get(M)),this.cachedPatterns.set(M,U)),R&&(U.matrix=R),U}shadingFill(M){if(!this.contentVisible)return;const R=this.ctx;this.save();const U=this._getPattern(M);R.fillStyle=U.getPattern(R,this,(0,n.getCurrentTransformInverse)(R),l.PathType.SHADING);const V=(0,n.getCurrentTransformInverse)(R);if(V){const Z=R.canvas,J=Z.width,O=Z.height,B=i.Util.applyTransform([0,0],V),G=i.Util.applyTransform([0,O],V),P=i.Util.applyTransform([J,0],V),K=i.Util.applyTransform([J,O],V),oe=Math.min(B[0],G[0],P[0],K[0]),re=Math.min(B[1],G[1],P[1],K[1]),H=Math.max(B[0],G[0],P[0],K[0]),Q=Math.max(B[1],G[1],P[1],K[1]);this.ctx.fillRect(oe,re,H-oe,Q-re)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,i.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,i.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(M,R){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(M)&&M.length===6&&this.transform(...M),this.baseTransform=(0,n.getCurrentTransform)(this.ctx),R)){const U=R[2]-R[0],V=R[3]-R[1];this.ctx.rect(R[0],R[1],U,V),this.current.updateRectMinMax((0,n.getCurrentTransform)(this.ctx),R),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(M){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const R=this.ctx;M.isolated||(0,i.info)("TODO: Support non-isolated groups."),M.knockout&&(0,i.warn)("Knockout groups not supported.");const U=(0,n.getCurrentTransform)(R);if(M.matrix&&R.transform(...M.matrix),!M.bbox)throw new Error("Bounding box is required.");let V=i.Util.getAxialAlignedBoundingBox(M.bbox,(0,n.getCurrentTransform)(R));const Z=[0,0,R.canvas.width,R.canvas.height];V=i.Util.intersect(V,Z)||[0,0,0,0];const J=Math.floor(V[0]),O=Math.floor(V[1]);let B=Math.max(Math.ceil(V[2])-J,1),G=Math.max(Math.ceil(V[3])-O,1),P=1,K=1;B>p&&(P=B/p,B=p),G>p&&(K=G/p,G=p),this.current.startNewPathAndClipBox([0,0,B,G]);let oe="groupAt"+this.groupLevel;M.smask&&(oe+="_smask_"+this.smaskCounter++%2);const re=this.cachedCanvases.getCanvas(oe,B,G),H=re.context;H.scale(1/P,1/K),H.translate(-J,-O),H.transform(...U),M.smask?this.smaskStack.push({canvas:re.canvas,context:H,offsetX:J,offsetY:O,scaleX:P,scaleY:K,subtype:M.smask.subtype,backdrop:M.smask.backdrop,transferMap:M.smask.transferMap||null,startTransformInverse:null}):(R.setTransform(1,0,0,1,0,0),R.translate(J,O),R.scale(P,K),R.save()),w(R,H),this.ctx=H,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(R),this.groupLevel++}endGroup(M){if(!this.contentVisible)return;this.groupLevel--;const R=this.ctx,U=this.groupStack.pop();if(this.ctx=U,this.ctx.imageSmoothingEnabled=!1,M.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const V=(0,n.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...V);const Z=i.Util.getAxialAlignedBoundingBox([0,0,R.canvas.width,R.canvas.height],V);this.ctx.drawImage(R.canvas,0,0),this.ctx.restore(),this.compose(Z)}}beginAnnotation(M,R,U,V,Z){if(je(this,ae,zl).call(this),y(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(R)&&R.length===4){const J=R[2]-R[0],O=R[3]-R[1];if(Z&&this.annotationCanvasMap){U=U.slice(),U[4]-=R[0],U[5]-=R[1],R=R.slice(),R[0]=R[1]=0,R[2]=J,R[3]=O;const[B,G]=i.Util.singularValueDecompose2dScale((0,n.getCurrentTransform)(this.ctx)),{viewportScale:P}=this,K=Math.ceil(J*this.outputScaleX*P),oe=Math.ceil(O*this.outputScaleY*P);this.annotationCanvas=this.canvasFactory.create(K,oe);const{canvas:re,context:H}=this.annotationCanvas;this.annotationCanvasMap.set(M,re),this.annotationCanvas.savedCtx=this.ctx,this.ctx=H,this.ctx.setTransform(B,0,0,-G,0,O*G),y(this.ctx,this.foregroundColor)}else y(this.ctx,this.foregroundColor),this.ctx.rect(R[0],R[1],J,O),this.ctx.clip(),this.endPath()}this.current=new C(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...U),this.transform(...V)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(M){if(!this.contentVisible)return;const R=M.count;M=this.getObject(M.data,M),M.count=R;const U=this.ctx,V=this.processingType3;if(V&&(V.compiled===void 0&&(V.compiled=D(M)),V.compiled)){V.compiled(U);return}const Z=this._createMaskCanvas(M),J=Z.canvas;U.save(),U.setTransform(1,0,0,1,0,0),U.drawImage(J,Z.offsetX,Z.offsetY),U.restore(),this.compose()}paintImageMaskXObjectRepeat(M,R,U=0,V=0,Z,J){if(!this.contentVisible)return;M=this.getObject(M.data,M);const O=this.ctx;O.save();const B=(0,n.getCurrentTransform)(O);O.transform(R,U,V,Z,0,0);const G=this._createMaskCanvas(M);O.setTransform(1,0,0,1,0,0);for(let P=0,K=J.length;P<K;P+=2){const oe=i.Util.transform(B,[R,U,V,Z,J[P],J[P+1]]),[re,H]=i.Util.applyTransform([0,0],oe);O.drawImage(G.canvas,re,H)}O.restore(),this.compose()}paintImageMaskXObjectGroup(M){if(!this.contentVisible)return;const R=this.ctx,U=this.current.fillColor,V=this.current.patternFill;for(const Z of M){const{data:J,width:O,height:B,transform:G}=Z,P=this.cachedCanvases.getCanvas("maskCanvas",O,B),K=P.context;K.save();const oe=this.getObject(J,Z);T(K,oe),K.globalCompositeOperation="source-in",K.fillStyle=V?U.getPattern(K,this,(0,n.getCurrentTransformInverse)(R),l.PathType.FILL):U,K.fillRect(0,0,O,B),K.restore(),R.save(),R.transform(...G),R.scale(1,-1),b(R,P.canvas,0,0,O,B,0,-1,1,1),R.restore()}this.compose()}paintImageXObject(M){if(!this.contentVisible)return;const R=this.getObject(M);if(!R){(0,i.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(R)}paintImageXObjectRepeat(M,R,U,V){if(!this.contentVisible)return;const Z=this.getObject(M);if(!Z){(0,i.warn)("Dependent image isn't ready yet");return}const J=Z.width,O=Z.height,B=[];for(let G=0,P=V.length;G<P;G+=2)B.push({transform:[R,0,0,U,V[G],V[G+1]],x:0,y:0,w:J,h:O});this.paintInlineImageXObjectGroup(Z,B)}paintInlineImageXObject(M){if(!this.contentVisible)return;const R=M.width,U=M.height,V=this.ctx;this.save(),V.scale(1/R,-1/U);let Z;if(typeof HTMLElement=="function"&&M instanceof HTMLElement||!M.data)Z=M;else{const G=this.cachedCanvases.getCanvas("inlineImage",R,U),P=G.context;F(P,M,this.current.transferMaps),Z=G.canvas}const J=this._scaleImage(Z,(0,n.getCurrentTransformInverse)(V));V.imageSmoothingEnabled=me((0,n.getCurrentTransform)(V),M.interpolate);const[O,B]=b(V,J.img,0,0,J.paintWidth,J.paintHeight,0,-U,R,U);if(this.imageLayer){const[G,P]=i.Util.applyTransform([0,-U],(0,n.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:M,left:G,top:P,width:O,height:B})}this.compose(),this.restore()}paintInlineImageXObjectGroup(M,R){if(!this.contentVisible)return;const U=this.ctx,V=M.width,Z=M.height,J=this.cachedCanvases.getCanvas("inlineImage",V,Z),O=J.context;F(O,M,this.current.transferMaps);for(const B of R){if(U.save(),U.transform(...B.transform),U.scale(1,-1),b(U,J.canvas,B.x,B.y,B.w,B.h,0,-1,1,1),this.imageLayer){const[G,P]=i.Util.applyTransform([B.x,B.y],(0,n.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:M,left:G,top:P,width:V,height:Z})}U.restore()}this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(M){}markPointProps(M,R){}beginMarkedContent(M){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(M,R){M==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(R)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(M){const R=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(M);const U=this.ctx;this.pendingClip&&(R||(this.pendingClip===ie?U.clip("evenodd"):U.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),U.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const M=(0,n.getCurrentTransform)(this.ctx);if(M[1]===0&&M[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(M[0]),Math.abs(M[3]));else{const R=Math.abs(M[0]*M[3]-M[2]*M[1]),U=Math.hypot(M[0],M[2]),V=Math.hypot(M[1],M[3]);this._cachedGetSinglePixelWidth=Math.max(U,V)/R}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:M}=this.current,R=(0,n.getCurrentTransform)(this.ctx);let U,V;if(R[1]===0&&R[2]===0){const Z=Math.abs(R[0]),J=Math.abs(R[3]);if(M===0)U=1/Z,V=1/J;else{const O=Z*M,B=J*M;U=O<1?1/O:1,V=B<1?1/B:1}}else{const Z=Math.abs(R[0]*R[3]-R[2]*R[1]),J=Math.hypot(R[0],R[1]),O=Math.hypot(R[2],R[3]);if(M===0)U=O/Z,V=J/Z;else{const B=M*Z;U=O>B?O/B:1,V=J>B?J/B:1}}this._cachedScaleForStroking=[U,V]}return this._cachedScaleForStroking}rescaleAndStroke(M){const{ctx:R}=this,{lineWidth:U}=this.current,[V,Z]=this.getScaleForStroking();if(R.lineWidth=U||1,V===1&&Z===1){R.stroke();return}let J,O,B;M&&(J=(0,n.getCurrentTransform)(R),O=R.getLineDash().slice(),B=R.lineDashOffset),R.scale(V,Z);const G=Math.max(V,Z);R.setLineDash(R.getLineDash().map(P=>P/G)),R.lineDashOffset/=G,R.stroke(),M&&(R.setTransform(...J),R.setLineDash(O),R.lineDashOffset=B)}isContentVisible(){for(let M=this.markedContentStack.length-1;M>=0;M--)if(!this.markedContentStack[M].visible)return!1;return!0}};ae=new WeakSet,zl=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)};let fe=xe;r.CanvasGraphics=fe;for(const I in i.OPS)fe.prototype[I]!==void 0&&(fe.prototype[i.OPS[I]]=fe.prototype[I])},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TilingPattern=r.PathType=void 0,r.getShadingPattern=x;var n=t(1),i=t(8),l=t(3);const c={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};r.PathType=c;function f(b,D){if(!D||l.isNodeJS)return;const C=D[2]-D[0],F=D[3]-D[1],T=new Path2D;T.rect(D[0],D[1],C,F),b.clip(T)}class d{constructor(){this.constructor===d&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class h extends d{constructor(D){super(),this._type=D[1],this._bbox=D[2],this._colorStops=D[3],this._p0=D[4],this._p1=D[5],this._r0=D[6],this._r1=D[7],this.matrix=null}_createGradient(D){let C;this._type==="axial"?C=D.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(C=D.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const F of this._colorStops)C.addColorStop(F[0],F[1]);return C}getPattern(D,C,F,T){let w;if(T===c.STROKE||T===c.FILL){const y=C.current.getClippedPathBoundingBox(T,(0,i.getCurrentTransform)(D))||[0,0,0,0],N=Math.ceil(y[2]-y[0])||1,L=Math.ceil(y[3]-y[1])||1,X=C.cachedCanvases.getCanvas("pattern",N,L,!0),z=X.context;z.clearRect(0,0,z.canvas.width,z.canvas.height),z.beginPath(),z.rect(0,0,z.canvas.width,z.canvas.height),z.translate(-y[0],-y[1]),F=n.Util.transform(F,[1,0,0,1,y[0],y[1]]),z.transform(...C.baseTransform),this.matrix&&z.transform(...this.matrix),f(z,this._bbox),z.fillStyle=this._createGradient(z),z.fill(),w=D.createPattern(X.canvas,"no-repeat");const se=new DOMMatrix(F);try{w.setTransform(se)}catch(me){(0,n.warn)(`RadialAxialShadingPattern.getPattern: "${me==null?void 0:me.message}".`)}}else f(D,this._bbox),w=this._createGradient(D);return w}}function p(b,D,C,F,T,w,y,N){const L=D.coords,X=D.colors,z=b.data,se=b.width*4;let me;L[C+1]>L[F+1]&&(me=C,C=F,F=me,me=w,w=y,y=me),L[F+1]>L[T+1]&&(me=F,F=T,T=me,me=y,y=N,N=me),L[C+1]>L[F+1]&&(me=C,C=F,F=me,me=w,w=y,y=me);const _e=(L[C]+D.offsetX)*D.scaleX,de=(L[C+1]+D.offsetY)*D.scaleY,Y=(L[F]+D.offsetX)*D.scaleX,ie=(L[F+1]+D.offsetY)*D.scaleY,fe=(L[T]+D.offsetX)*D.scaleX,ae=(L[T+1]+D.offsetY)*D.scaleY;if(de>=ae)return;const W=X[w],xe=X[w+1],I=X[w+2],M=X[y],R=X[y+1],U=X[y+2],V=X[N],Z=X[N+1],J=X[N+2],O=Math.round(de),B=Math.round(ae);let G,P,K,oe,re,H,Q,be;for(let ge=O;ge<=B;ge++){if(ge<ie){let Ce;ge<de?Ce=0:Ce=(de-ge)/(de-ie),G=_e-(_e-Y)*Ce,P=W-(W-M)*Ce,K=xe-(xe-R)*Ce,oe=I-(I-U)*Ce}else{let Ce;ge>ae?Ce=1:ie===ae?Ce=0:Ce=(ie-ge)/(ie-ae),G=Y-(Y-fe)*Ce,P=M-(M-V)*Ce,K=R-(R-Z)*Ce,oe=U-(U-J)*Ce}let ye;ge<de?ye=0:ge>ae?ye=1:ye=(de-ge)/(de-ae),re=_e-(_e-fe)*ye,H=W-(W-V)*ye,Q=xe-(xe-Z)*ye,be=I-(I-J)*ye;const we=Math.round(Math.min(G,re)),Le=Math.round(Math.max(G,re));let Ve=se*ge+we*4;for(let Ce=we;Ce<=Le;Ce++)ye=(G-Ce)/(G-re),ye<0?ye=0:ye>1&&(ye=1),z[Ve++]=P-(P-H)*ye|0,z[Ve++]=K-(K-Q)*ye|0,z[Ve++]=oe-(oe-be)*ye|0,z[Ve++]=255}}function E(b,D,C){const F=D.coords,T=D.colors;let w,y;switch(D.type){case"lattice":const N=D.verticesPerRow,L=Math.floor(F.length/N)-1,X=N-1;for(w=0;w<L;w++){let z=w*N;for(let se=0;se<X;se++,z++)p(b,C,F[z],F[z+1],F[z+N],T[z],T[z+1],T[z+N]),p(b,C,F[z+N+1],F[z+1],F[z+N],T[z+N+1],T[z+1],T[z+N])}break;case"triangles":for(w=0,y=F.length;w<y;w+=3)p(b,C,F[w],F[w+1],F[w+2],T[w],T[w+1],T[w+2]);break;default:throw new Error("illegal figure")}}class v extends d{constructor(D){super(),this._coords=D[2],this._colors=D[3],this._figures=D[4],this._bounds=D[5],this._bbox=D[7],this._background=D[8],this.matrix=null}_createMeshCanvas(D,C,F){const N=Math.floor(this._bounds[0]),L=Math.floor(this._bounds[1]),X=Math.ceil(this._bounds[2])-N,z=Math.ceil(this._bounds[3])-L,se=Math.min(Math.ceil(Math.abs(X*D[0]*1.1)),3e3),me=Math.min(Math.ceil(Math.abs(z*D[1]*1.1)),3e3),_e=X/se,de=z/me,Y={coords:this._coords,colors:this._colors,offsetX:-N,offsetY:-L,scaleX:1/_e,scaleY:1/de},ie=se+2*2,fe=me+2*2,ae=F.getCanvas("mesh",ie,fe,!1),W=ae.context,xe=W.createImageData(se,me);if(C){const M=xe.data;for(let R=0,U=M.length;R<U;R+=4)M[R]=C[0],M[R+1]=C[1],M[R+2]=C[2],M[R+3]=255}for(const M of this._figures)E(xe,M,Y);return W.putImageData(xe,2,2),{canvas:ae.canvas,offsetX:N-2*_e,offsetY:L-2*de,scaleX:_e,scaleY:de}}getPattern(D,C,F,T){f(D,this._bbox);let w;if(T===c.SHADING)w=n.Util.singularValueDecompose2dScale((0,i.getCurrentTransform)(D));else if(w=n.Util.singularValueDecompose2dScale(C.baseTransform),this.matrix){const N=n.Util.singularValueDecompose2dScale(this.matrix);w=[w[0]*N[0],w[1]*N[1]]}const y=this._createMeshCanvas(w,T===c.SHADING?null:this._background,C.cachedCanvases);return T!==c.SHADING&&(D.setTransform(...C.baseTransform),this.matrix&&D.transform(...this.matrix)),D.translate(y.offsetX,y.offsetY),D.scale(y.scaleX,y.scaleY),D.createPattern(y.canvas,"no-repeat")}}class S extends d{getPattern(){return"hotpink"}}function x(b){switch(b[0]){case"RadialAxial":return new h(b);case"Mesh":return new v(b);case"Dummy":return new S}throw new Error(`Unknown IR type: ${b[0]}`)}const g={COLORED:1,UNCOLORED:2};class m{static get MAX_PATTERN_SIZE(){return(0,n.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(D,C,F,T,w){this.operatorList=D[2],this.matrix=D[3]||[1,0,0,1,0,0],this.bbox=D[4],this.xstep=D[5],this.ystep=D[6],this.paintType=D[7],this.tilingType=D[8],this.color=C,this.ctx=F,this.canvasGraphicsFactory=T,this.baseTransform=w}createPatternCanvas(D){const C=this.operatorList,F=this.bbox,T=this.xstep,w=this.ystep,y=this.paintType,N=this.tilingType,L=this.color,X=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+N);const z=F[0],se=F[1],me=F[2],_e=F[3],de=n.Util.singularValueDecompose2dScale(this.matrix),Y=n.Util.singularValueDecompose2dScale(this.baseTransform),ie=[de[0]*Y[0],de[1]*Y[1]],fe=this.getSizeAndScale(T,this.ctx.canvas.width,ie[0]),ae=this.getSizeAndScale(w,this.ctx.canvas.height,ie[1]),W=D.cachedCanvases.getCanvas("pattern",fe.size,ae.size,!0),xe=W.context,I=X.createCanvasGraphics(xe);I.groupLevel=D.groupLevel,this.setFillAndStrokeStyleToContext(I,y,L);let M=z,R=se,U=me,V=_e;return z<0&&(M=0,U+=Math.abs(z)),se<0&&(R=0,V+=Math.abs(se)),xe.translate(-(fe.scale*M),-(ae.scale*R)),I.transform(fe.scale,0,0,ae.scale,0,0),xe.save(),this.clipBbox(I,M,R,U,V),I.baseTransform=(0,i.getCurrentTransform)(I.ctx),I.executeOperatorList(C),I.endDrawing(),{canvas:W.canvas,scaleX:fe.scale,scaleY:ae.scale,offsetX:M,offsetY:R}}getSizeAndScale(D,C,F){D=Math.abs(D);const T=Math.max(m.MAX_PATTERN_SIZE,C);let w=Math.ceil(D*F);return w>=T?w=T:F=w/D,{scale:F,size:w}}clipBbox(D,C,F,T,w){const y=T-C,N=w-F;D.ctx.rect(C,F,y,N),D.current.updateRectMinMax((0,i.getCurrentTransform)(D.ctx),[C,F,T,w]),D.clip(),D.endPath()}setFillAndStrokeStyleToContext(D,C,F){const T=D.ctx,w=D.current;switch(C){case g.COLORED:const y=this.ctx;T.fillStyle=y.fillStyle,T.strokeStyle=y.strokeStyle,w.fillColor=y.fillStyle,w.strokeColor=y.strokeStyle;break;case g.UNCOLORED:const N=n.Util.makeHexColor(F[0],F[1],F[2]);T.fillStyle=N,T.strokeStyle=N,w.fillColor=N,w.strokeColor=N;break;default:throw new n.FormatError(`Unsupported paint type: ${C}`)}}getPattern(D,C,F,T){let w=F;T!==c.SHADING&&(w=n.Util.transform(w,C.baseTransform),this.matrix&&(w=n.Util.transform(w,this.matrix)));const y=this.createPatternCanvas(C);let N=new DOMMatrix(w);N=N.translate(y.offsetX,y.offsetY),N=N.scale(1/y.scaleX,1/y.scaleY);const L=D.createPattern(y.canvas,"repeat");try{L.setTransform(N)}catch(X){(0,n.warn)(`TilingPattern.getPattern: "${X==null?void 0:X.message}".`)}return L}}r.TilingPattern=m},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.applyMaskImageData=i;var n=t(1);function i({src:l,srcPos:c=0,dest:f,destPos:d=0,width:h,height:p,inverseDecode:E=!1}){const v=n.FeatureTest.isLittleEndian?4278190080:255,[S,x]=E?[0,v]:[v,0],g=h>>3,m=h&7,b=l.length;f=new Uint32Array(f.buffer);for(let D=0;D<p;D++){for(const F=c+g;c<F;c++){const T=c<b?l[c]:255;f[d++]=T&128?x:S,f[d++]=T&64?x:S,f[d++]=T&32?x:S,f[d++]=T&16?x:S,f[d++]=T&8?x:S,f[d++]=T&4?x:S,f[d++]=T&2?x:S,f[d++]=T&1?x:S}if(m===0)continue;const C=c<b?l[c++]:255;for(let F=0;F<m;F++)f[d++]=C&1<<7-F?x:S}return{srcPos:c,destPos:d}}},(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.GlobalWorkerOptions=void 0;const t=Object.create(null);r.GlobalWorkerOptions=t,t.workerPort=t.workerPort===void 0?null:t.workerPort,t.workerSrc=t.workerSrc===void 0?"":t.workerSrc},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.MessageHandler=void 0;var n=t(1);const i={UNKNOWN:0,DATA:1,ERROR:2},l={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function c(d){switch(d instanceof Error||typeof d=="object"&&d!==null||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),d.name){case"AbortException":return new n.AbortException(d.message);case"MissingPDFException":return new n.MissingPDFException(d.message);case"PasswordException":return new n.PasswordException(d.message,d.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(d.message,d.status);case"UnknownErrorException":return new n.UnknownErrorException(d.message,d.details);default:return new n.UnknownErrorException(d.message,d.toString())}}class f{constructor(h,p,E){this.sourceName=h,this.targetName=p,this.comObj=E,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=v=>{const S=v.data;if(S.targetName!==this.sourceName)return;if(S.stream){this._processStreamMessage(S);return}if(S.callback){const g=S.callbackId,m=this.callbackCapabilities[g];if(!m)throw new Error(`Cannot resolve callback ${g}`);if(delete this.callbackCapabilities[g],S.callback===i.DATA)m.resolve(S.data);else if(S.callback===i.ERROR)m.reject(c(S.reason));else throw new Error("Unexpected callback case");return}const x=this.actionHandler[S.action];if(!x)throw new Error(`Unknown action from worker: ${S.action}`);if(S.callbackId){const g=this.sourceName,m=S.sourceName;new Promise(function(b){b(x(S.data))}).then(function(b){E.postMessage({sourceName:g,targetName:m,callback:i.DATA,callbackId:S.callbackId,data:b})},function(b){E.postMessage({sourceName:g,targetName:m,callback:i.ERROR,callbackId:S.callbackId,reason:c(b)})});return}if(S.streamId){this._createStreamSink(S);return}x(S.data)},E.addEventListener("message",this._onComObjOnMessage)}on(h,p){const E=this.actionHandler;if(E[h])throw new Error(`There is already an actionName called "${h}"`);E[h]=p}send(h,p,E){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,data:p},E)}sendWithPromise(h,p,E){const v=this.callbackId++,S=(0,n.createPromiseCapability)();this.callbackCapabilities[v]=S;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:h,callbackId:v,data:p},E)}catch(x){S.reject(x)}return S.promise}sendWithStream(h,p,E,v){const S=this.streamId++,x=this.sourceName,g=this.targetName,m=this.comObj;return new ReadableStream({start:b=>{const D=(0,n.createPromiseCapability)();return this.streamControllers[S]={controller:b,startCall:D,pullCall:null,cancelCall:null,isClosed:!1},m.postMessage({sourceName:x,targetName:g,action:h,streamId:S,data:p,desiredSize:b.desiredSize},v),D.promise},pull:b=>{const D=(0,n.createPromiseCapability)();return this.streamControllers[S].pullCall=D,m.postMessage({sourceName:x,targetName:g,stream:l.PULL,streamId:S,desiredSize:b.desiredSize}),D.promise},cancel:b=>{(0,n.assert)(b instanceof Error,"cancel must have a valid reason");const D=(0,n.createPromiseCapability)();return this.streamControllers[S].cancelCall=D,this.streamControllers[S].isClosed=!0,m.postMessage({sourceName:x,targetName:g,stream:l.CANCEL,streamId:S,reason:c(b)}),D.promise}},E)}_createStreamSink(h){const p=h.streamId,E=this.sourceName,v=h.sourceName,S=this.comObj,x=this,g=this.actionHandler[h.action],m={enqueue(b,D=1,C){if(this.isCancelled)return;const F=this.desiredSize;this.desiredSize-=D,F>0&&this.desiredSize<=0&&(this.sinkCapability=(0,n.createPromiseCapability)(),this.ready=this.sinkCapability.promise),S.postMessage({sourceName:E,targetName:v,stream:l.ENQUEUE,streamId:p,chunk:b},C)},close(){this.isCancelled||(this.isCancelled=!0,S.postMessage({sourceName:E,targetName:v,stream:l.CLOSE,streamId:p}),delete x.streamSinks[p])},error(b){(0,n.assert)(b instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,S.postMessage({sourceName:E,targetName:v,stream:l.ERROR,streamId:p,reason:c(b)}))},sinkCapability:(0,n.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:h.desiredSize,ready:null};m.sinkCapability.resolve(),m.ready=m.sinkCapability.promise,this.streamSinks[p]=m,new Promise(function(b){b(g(h.data,m))}).then(function(){S.postMessage({sourceName:E,targetName:v,stream:l.START_COMPLETE,streamId:p,success:!0})},function(b){S.postMessage({sourceName:E,targetName:v,stream:l.START_COMPLETE,streamId:p,reason:c(b)})})}_processStreamMessage(h){const p=h.streamId,E=this.sourceName,v=h.sourceName,S=this.comObj,x=this.streamControllers[p],g=this.streamSinks[p];switch(h.stream){case l.START_COMPLETE:h.success?x.startCall.resolve():x.startCall.reject(c(h.reason));break;case l.PULL_COMPLETE:h.success?x.pullCall.resolve():x.pullCall.reject(c(h.reason));break;case l.PULL:if(!g){S.postMessage({sourceName:E,targetName:v,stream:l.PULL_COMPLETE,streamId:p,success:!0});break}g.desiredSize<=0&&h.desiredSize>0&&g.sinkCapability.resolve(),g.desiredSize=h.desiredSize,new Promise(function(m){m(g.onPull&&g.onPull())}).then(function(){S.postMessage({sourceName:E,targetName:v,stream:l.PULL_COMPLETE,streamId:p,success:!0})},function(m){S.postMessage({sourceName:E,targetName:v,stream:l.PULL_COMPLETE,streamId:p,reason:c(m)})});break;case l.ENQUEUE:if((0,n.assert)(x,"enqueue should have stream controller"),x.isClosed)break;x.controller.enqueue(h.chunk);break;case l.CLOSE:if((0,n.assert)(x,"close should have stream controller"),x.isClosed)break;x.isClosed=!0,x.controller.close(),this._deleteStreamController(x,p);break;case l.ERROR:(0,n.assert)(x,"error should have stream controller"),x.controller.error(c(h.reason)),this._deleteStreamController(x,p);break;case l.CANCEL_COMPLETE:h.success?x.cancelCall.resolve():x.cancelCall.reject(c(h.reason)),this._deleteStreamController(x,p);break;case l.CANCEL:if(!g)break;new Promise(function(m){m(g.onCancel&&g.onCancel(c(h.reason)))}).then(function(){S.postMessage({sourceName:E,targetName:v,stream:l.CANCEL_COMPLETE,streamId:p,success:!0})},function(m){S.postMessage({sourceName:E,targetName:v,stream:l.CANCEL_COMPLETE,streamId:p,reason:c(m)})}),g.sinkCapability.reject(c(h.reason)),g.isCancelled=!0,delete this.streamSinks[p];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(h,p){await Promise.allSettled([h.startCall&&h.startCall.promise,h.pullCall&&h.pullCall.promise,h.cancelCall&&h.cancelCall.promise]),delete this.streamControllers[p]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}r.MessageHandler=f},(e,r,t)=>{var l,c;Object.defineProperty(r,"__esModule",{value:!0}),r.Metadata=void 0;var n=t(1);class i{constructor({parsedData:d,rawData:h}){qe(this,l);qe(this,c);$e(this,l,d),$e(this,c,h)}getRaw(){return le(this,c)}get(d){return le(this,l).get(d)??null}getAll(){return(0,n.objectFromMap)(le(this,l))}has(d){return le(this,l).has(d)}}l=new WeakMap,c=new WeakMap,r.Metadata=i},(e,r,t)=>{var f,d,h,p,E,v,Vl;Object.defineProperty(r,"__esModule",{value:!0}),r.OptionalContentConfig=void 0;var n=t(1);const i=Symbol("INTERNAL");class l{constructor(g,m){qe(this,f,!0);this.name=g,this.intent=m}get visible(){return le(this,f)}_setVisible(g,m){g!==i&&(0,n.unreachable)("Internal method `_setVisible` called."),$e(this,f,m)}}f=new WeakMap;class c{constructor(g){qe(this,v);qe(this,d,!0);qe(this,h,new Map);qe(this,p,null);qe(this,E,null);if(this.name=null,this.creator=null,g!==null){this.name=g.name,this.creator=g.creator,$e(this,E,g.order);for(const m of g.groups)le(this,h).set(m.id,new l(m.name,m.intent));if(g.baseState==="OFF")for(const m of le(this,h).values())m._setVisible(i,!1);for(const m of g.on)le(this,h).get(m)._setVisible(i,!0);for(const m of g.off)le(this,h).get(m)._setVisible(i,!1);$e(this,p,new Map);for(const[m,b]of le(this,h))le(this,p).set(m,b.visible)}}isVisible(g){if(le(this,h).size===0)return!0;if(!g)return(0,n.warn)("Optional content group not defined."),!0;if(g.type==="OCG")return le(this,h).has(g.id)?le(this,h).get(g.id).visible:((0,n.warn)(`Optional content group not found: ${g.id}`),!0);if(g.type==="OCMD"){if(g.expression)return je(this,v,Vl).call(this,g.expression);if(!g.policy||g.policy==="AnyOn"){for(const m of g.ids){if(!le(this,h).has(m))return(0,n.warn)(`Optional content group not found: ${m}`),!0;if(le(this,h).get(m).visible)return!0}return!1}else if(g.policy==="AllOn"){for(const m of g.ids){if(!le(this,h).has(m))return(0,n.warn)(`Optional content group not found: ${m}`),!0;if(!le(this,h).get(m).visible)return!1}return!0}else if(g.policy==="AnyOff"){for(const m of g.ids){if(!le(this,h).has(m))return(0,n.warn)(`Optional content group not found: ${m}`),!0;if(!le(this,h).get(m).visible)return!0}return!1}else if(g.policy==="AllOff"){for(const m of g.ids){if(!le(this,h).has(m))return(0,n.warn)(`Optional content group not found: ${m}`),!0;if(le(this,h).get(m).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${g.policy}.`),!0}return(0,n.warn)(`Unknown group type ${g.type}.`),!0}setVisibility(g,m=!0){if(!le(this,h).has(g)){(0,n.warn)(`Optional content group not found: ${g}`);return}le(this,h).get(g)._setVisible(i,!!m),$e(this,d,null)}get hasInitialVisibility(){if(le(this,d)!==null)return le(this,d);for(const[g,m]of le(this,h)){const b=le(this,p).get(g);if(m.visible!==b)return $e(this,d,!1)}return $e(this,d,!0)}getOrder(){return le(this,h).size?le(this,E)?le(this,E).slice():[...le(this,h).keys()]:null}getGroups(){return le(this,h).size>0?(0,n.objectFromMap)(le(this,h)):null}getGroup(g){return le(this,h).get(g)||null}}d=new WeakMap,h=new WeakMap,p=new WeakMap,E=new WeakMap,v=new WeakSet,Vl=function(g){const m=g.length;if(m<2)return!0;const b=g[0];for(let D=1;D<m;D++){const C=g[D];let F;if(Array.isArray(C))F=je(this,v,Vl).call(this,C);else if(le(this,h).has(C))F=le(this,h).get(C).visible;else return(0,n.warn)(`Optional content group not found: ${C}`),!0;switch(b){case"And":if(!F)return!1;break;case"Or":if(F)return!0;break;case"Not":return!F;default:return!0}}return b==="And"},r.OptionalContentConfig=c},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFDataTransportStream=void 0;var n=t(1),i=t(8);class l{constructor(h,p){(0,n.assert)(p,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=h.progressiveDone||!1,this._contentDispositionFilename=h.contentDispositionFilename||null;const E=h.initialData;if((E==null?void 0:E.length)>0){const v=new Uint8Array(E).buffer;this._queuedChunks.push(v)}this._pdfDataRangeTransport=p,this._isStreamingSupported=!h.disableStream,this._isRangeSupported=!h.disableRange,this._contentLength=h.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((v,S)=>{this._onReceiveData({begin:v,chunk:S})}),this._pdfDataRangeTransport.addProgressListener((v,S)=>{this._onProgress({loaded:v,total:S})}),this._pdfDataRangeTransport.addProgressiveReadListener(v=>{this._onReceiveData({chunk:v})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(h){const p=new Uint8Array(h.chunk).buffer;if(h.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(p):this._queuedChunks.push(p);else{const E=this._rangeReaders.some(function(v){return v._begin!==h.begin?!1:(v._enqueue(p),!0)});(0,n.assert)(E,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var h;return((h=this._fullRequestReader)==null?void 0:h._loaded)??0}_onProgress(h){if(h.total===void 0){const p=this._rangeReaders[0];p!=null&&p.onProgress&&p.onProgress({loaded:h.loaded})}else{const p=this._fullRequestReader;p!=null&&p.onProgress&&p.onProgress({loaded:h.loaded,total:h.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(h){const p=this._rangeReaders.indexOf(h);p>=0&&this._rangeReaders.splice(p,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const h=this._queuedChunks;return this._queuedChunks=null,new c(this,h,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(h,p){if(p<=this._progressiveDataLength)return null;const E=new f(this,h,p);return this._pdfDataRangeTransport.requestDataRange(h,p),this._rangeReaders.push(E),E}cancelAllRequests(h){this._fullRequestReader&&this._fullRequestReader.cancel(h);for(const p of this._rangeReaders.slice(0))p.cancel(h);this._pdfDataRangeTransport.abort()}}r.PDFDataTransportStream=l;class c{constructor(h,p,E=!1,v=null){this._stream=h,this._done=E||!1,this._filename=(0,i.isPdfFile)(v)?v:null,this._queuedChunks=p||[],this._loaded=0;for(const S of this._queuedChunks)this._loaded+=S.byteLength;this._requests=[],this._headersReady=Promise.resolve(),h._fullRequestReader=this,this.onProgress=null}_enqueue(h){this._done||(this._requests.length>0?this._requests.shift().resolve({value:h,done:!1}):this._queuedChunks.push(h),this._loaded+=h.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const h=(0,n.createPromiseCapability)();return this._requests.push(h),h.promise}cancel(h){this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class f{constructor(h,p,E){this._stream=h,this._begin=p,this._end=E,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(h){if(!this._done){if(this._requests.length===0)this._queuedChunk=h;else{this._requests.shift().resolve({value:h,done:!1});for(const E of this._requests)E.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const p=this._queuedChunk;return this._queuedChunk=null,{value:p,done:!1}}if(this._done)return{value:void 0,done:!0};const h=(0,n.createPromiseCapability)();return this._requests.push(h),h.promise}cancel(h){this._done=!0;for(const p of this._requests)p.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.XfaText=void 0;class t{static textContent(i){const l=[],c={items:l,styles:Object.create(null)};function f(d){var E;if(!d)return;let h=null;const p=d.name;if(p==="#text")h=d.value;else if(t.shouldBuildText(p))(E=d==null?void 0:d.attributes)!=null&&E.textContent?h=d.attributes.textContent:d.value&&(h=d.value);else return;if(h!==null&&l.push({str:h}),!!d.children)for(const v of d.children)f(v)}return f(i),c}static shouldBuildText(i){return!(i==="textarea"||i==="input"||i==="option"||i==="select")}}r.XfaText=t},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.NodeStandardFontDataFactory=r.NodeCanvasFactory=r.NodeCMapReaderFactory=void 0;var n=t(9);const i=function(d){return new Promise((h,p)=>{require$$5.readFile(d,(v,S)=>{if(v||!S){p(new Error(v));return}h(new Uint8Array(S))})})};class l extends n.BaseCanvasFactory{_createCanvas(h,p){return require$$5.createCanvas(h,p)}}r.NodeCanvasFactory=l;class c extends n.BaseCMapReaderFactory{_fetchData(h,p){return i(h).then(E=>({cMapData:E,compressionType:p}))}}r.NodeCMapReaderFactory=c;class f extends n.BaseStandardFontDataFactory{_fetchData(h){return i(h)}}r.NodeStandardFontDataFactory=f},(e,r,t)=>{var d,h,p,E,v,S,x,g,m,Xl,Oh,Gl,Dh;Object.defineProperty(r,"__esModule",{value:!0}),r.AnnotationEditorLayer=void 0;var n=t(7),i=t(1),l=t(23),c=t(24);const T=class T{constructor(y){qe(this,m);qe(this,d);qe(this,h,!1);qe(this,p,this.pointerup.bind(this));qe(this,E,this.pointerdown.bind(this));qe(this,v,new Map);qe(this,S,!1);qe(this,x,!1);qe(this,g);T._initialized||(T._initialized=!0,l.FreeTextEditor.initialize(y.l10n),c.InkEditor.initialize(y.l10n),y.uiManager.registerEditorTypes([l.FreeTextEditor,c.InkEditor])),$e(this,g,y.uiManager),this.annotationStorage=y.annotationStorage,this.pageIndex=y.pageIndex,this.div=y.div,$e(this,d,y.accessibilityManager),le(this,g).addLayer(this)}updateToolbar(y){le(this,g).updateToolbar(y)}updateMode(y=le(this,g).getMode()){je(this,m,Dh).call(this),y===i.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),le(this,g).unselectAll()}addInkEditorIfNeeded(y){if(!y&&le(this,g).getMode()!==i.AnnotationEditorType.INK)return;if(!y){for(const L of le(this,v).values())if(L.isEmpty()){L.setInBackground();return}}je(this,m,Gl).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(y){le(this,g).setEditingState(y)}addCommands(y){le(this,g).addCommands(y)}enable(){this.div.style.pointerEvents="auto";for(const y of le(this,v).values())y.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const y of le(this,v).values())y.disableEditing()}setActiveEditor(y){le(this,g).getActive()!==y&&le(this,g).setActiveEditor(y)}enableClick(){this.div.addEventListener("pointerdown",le(this,E)),this.div.addEventListener("pointerup",le(this,p))}disableClick(){this.div.removeEventListener("pointerdown",le(this,E)),this.div.removeEventListener("pointerup",le(this,p))}attach(y){le(this,v).set(y.id,y)}detach(y){var N;le(this,v).delete(y.id),(N=le(this,d))==null||N.removePointerInTextLayer(y.contentDiv)}remove(y){le(this,g).removeEditor(y),this.detach(y),this.annotationStorage.remove(y.id),y.div.style.display="none",setTimeout(()=>{y.div.style.display="",y.div.remove(),y.isAttachedToDOM=!1,document.activeElement===document.body&&le(this,g).focusMainContainer()},0),le(this,x)||this.addInkEditorIfNeeded(!1)}add(y){if(je(this,m,Xl).call(this,y),le(this,g).addEditor(y),this.attach(y),!y.isAttachedToDOM){const N=y.render();this.div.append(N),y.isAttachedToDOM=!0}this.moveEditorInDOM(y),y.onceAdded(),this.addToAnnotationStorage(y)}moveEditorInDOM(y){var N;(N=le(this,d))==null||N.moveElementInDOM(this.div,y.div,y.contentDiv,!0)}addToAnnotationStorage(y){!y.isEmpty()&&!this.annotationStorage.has(y.id)&&this.annotationStorage.setValue(y.id,y)}addOrRebuild(y){y.needsToBeRebuilt()?y.rebuild():this.add(y)}addANewEditor(y){const N=()=>{this.addOrRebuild(y)},L=()=>{y.remove()};this.addCommands({cmd:N,undo:L,mustExec:!0})}addUndoableEditor(y){const N=()=>{this.addOrRebuild(y)},L=()=>{y.remove()};this.addCommands({cmd:N,undo:L,mustExec:!1})}getNextId(){return le(this,g).getId()}deserialize(y){switch(y.annotationType){case i.AnnotationEditorType.FREETEXT:return l.FreeTextEditor.deserialize(y,this);case i.AnnotationEditorType.INK:return c.InkEditor.deserialize(y,this)}return null}setSelected(y){le(this,g).setSelected(y)}toggleSelected(y){le(this,g).toggleSelected(y)}isSelected(y){return le(this,g).isSelected(y)}unselect(y){le(this,g).unselect(y)}pointerup(y){const N=n.KeyboardManager.platform.isMac;if(!(y.button!==0||y.ctrlKey&&N)&&y.target===this.div&&le(this,S)){if($e(this,S,!1),!le(this,h)){$e(this,h,!0);return}je(this,m,Gl).call(this,y)}}pointerdown(y){const N=n.KeyboardManager.platform.isMac;if(y.button!==0||y.ctrlKey&&N||y.target!==this.div)return;$e(this,S,!0);const L=le(this,g).getActive();$e(this,h,!L||L.isEmpty())}drop(y){const N=y.dataTransfer.getData("text/plain"),L=le(this,g).getEditor(N);if(!L)return;y.preventDefault(),y.dataTransfer.dropEffect="move",je(this,m,Xl).call(this,L);const X=this.div.getBoundingClientRect(),z=y.clientX-X.x,se=y.clientY-X.y;L.translate(z-L.startX,se-L.startY),this.moveEditorInDOM(L),L.div.focus()}dragover(y){y.preventDefault()}destroy(){var y,N;((y=le(this,g).getActive())==null?void 0:y.parent)===this&&le(this,g).setActiveEditor(null);for(const L of le(this,v).values())(N=le(this,d))==null||N.removePointerInTextLayer(L.contentDiv),L.isAttachedToDOM=!1,L.div.remove(),L.parent=null;this.div=null,le(this,v).clear(),le(this,g).removeLayer(this)}render(y){this.viewport=y.viewport,(0,n.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const N of le(this,g).getEditors(this.pageIndex))this.add(N);this.updateMode()}update(y){this.viewport=y.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[y,N,L,X]=this.viewport.viewBox,z=L-y,se=X-N;return[z,se]}get viewportBaseDimensions(){const{width:y,height:N,rotation:L}=this.viewport;return L%180===0?[y,N]:[N,y]}setDimensions(){const{width:y,height:N,rotation:L}=this.viewport,X=L%180!==0,z=Math.floor(y)+"px",se=Math.floor(N)+"px";this.div.style.width=X?se:z,this.div.style.height=X?z:se,this.div.setAttribute("data-main-rotation",L)}};d=new WeakMap,h=new WeakMap,p=new WeakMap,E=new WeakMap,v=new WeakMap,S=new WeakMap,x=new WeakMap,g=new WeakMap,m=new WeakSet,Xl=function(y){var N;y.parent!==this&&(this.attach(y),y.pageIndex=this.pageIndex,(N=y.parent)==null||N.detach(y),y.parent=this,y.div&&y.isAttachedToDOM&&(y.div.remove(),this.div.append(y.div)))},Oh=function(y){switch(le(this,g).getMode()){case i.AnnotationEditorType.FREETEXT:return new l.FreeTextEditor(y);case i.AnnotationEditorType.INK:return new c.InkEditor(y)}return null},Gl=function(y){const N=this.getNextId(),L=je(this,m,Oh).call(this,{parent:this,id:N,x:y.offsetX,y:y.offsetY});return L&&this.add(L),L},Dh=function(){$e(this,x,!0);for(const y of le(this,v).values())y.isEmpty()&&y.remove();$e(this,x,!1)},Ut(T,"_initialized",!1);let f=T;r.AnnotationEditorLayer=f},(e,r,t)=>{var f,d,h,p,E,v,S,x,Ph,Mh,Lh,ql;Object.defineProperty(r,"__esModule",{value:!0}),r.FreeTextEditor=void 0;var n=t(1),i=t(7),l=t(6);const C=class C extends l.AnnotationEditor{constructor(w){super({...w,name:"freeTextEditor"});qe(this,x);qe(this,f,this.editorDivBlur.bind(this));qe(this,d,this.editorDivFocus.bind(this));qe(this,h,this.editorDivKeydown.bind(this));qe(this,p);qe(this,E,"");qe(this,v,!1);qe(this,S);$e(this,p,w.color||C._defaultColor||l.AnnotationEditor._defaultLineColor),$e(this,S,w.fontSize||C._defaultFontSize)}static initialize(w){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(N=>[N,w.get(N)]));const y=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(y.getPropertyValue("--freetext-padding"))}static updateDefaultParams(w,y){switch(w){case n.AnnotationEditorParamsType.FREETEXT_SIZE:C._defaultFontSize=y;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:C._defaultColor=y;break}}updateParams(w,y){switch(w){case n.AnnotationEditorParamsType.FREETEXT_SIZE:je(this,x,Ph).call(this,y);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:je(this,x,Mh).call(this,y);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,C._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,C._defaultColor||l.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,le(this,S)],[n.AnnotationEditorParamsType.FREETEXT_COLOR,le(this,p)]]}getInitialTranslation(){return[-C._internalPadding*this.parent.scaleFactor,-(C._internalPadding+le(this,S))*this.parent.scaleFactor]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",le(this,h)),this.editorDiv.addEventListener("focus",le(this,d)),this.editorDiv.addEventListener("blur",le(this,f)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",le(this,h)),this.editorDiv.removeEventListener("focus",le(this,d)),this.editorDiv.removeEventListener("blur",le(this,f)),this.div.focus(),this.isEditing=!1)}focusin(w){super.focusin(w),w.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}commit(){super.commit(),le(this,v)||($e(this,v,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),$e(this,E,je(this,x,Lh).call(this).trimEnd()),je(this,x,ql).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(w){this.enableEditMode(),this.editorDiv.focus()}keydown(w){w.target===this.div&&w.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(w){C._keyboardManager.exec(this,w)}editorDivFocus(w){this.isEditing=!0}editorDivBlur(w){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let w,y;this.width&&(w=this.x,y=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),C._l10nPromise.get("editor_free_text_aria_label").then(L=>{var X;return(X=this.editorDiv)==null?void 0:X.setAttribute("aria-label",L)}),C._l10nPromise.get("free_text_default_content").then(L=>{var X;return(X=this.editorDiv)==null?void 0:X.setAttribute("default-content",L)}),this.editorDiv.contentEditable=!0;const{style:N}=this.editorDiv;if(N.fontSize=`calc(${le(this,S)}px * var(--scale-factor))`,N.color=le(this,p),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,i.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[L,X]=this.parent.viewportBaseDimensions;this.setAt(w*L,y*X,this.width*L,this.height*X);for(const z of le(this,E).split(`
`)){const se=document.createElement("div");se.append(z?document.createTextNode(z):document.createElement("br")),this.editorDiv.append(se)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(w,y){const N=super.deserialize(w,y);return $e(N,S,w.fontSize),$e(N,p,n.Util.makeHexColor(...w.color)),$e(N,E,w.value),N}serialize(){if(this.isEmpty())return null;const w=C._internalPadding*this.parent.scaleFactor,y=this.getRect(w,w),N=l.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:n.AnnotationEditorType.FREETEXT,color:N,fontSize:le(this,S),value:le(this,E),pageIndex:this.parent.pageIndex,rect:y,rotation:this.rotation}}};f=new WeakMap,d=new WeakMap,h=new WeakMap,p=new WeakMap,E=new WeakMap,v=new WeakMap,S=new WeakMap,x=new WeakSet,Ph=function(w){const y=L=>{this.editorDiv.style.fontSize=`calc(${L}px * var(--scale-factor))`,this.translate(0,-(L-le(this,S))*this.parent.scaleFactor),$e(this,S,L),je(this,x,ql).call(this)},N=le(this,S);this.parent.addCommands({cmd:()=>{y(w)},undo:()=>{y(N)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},Mh=function(w){const y=le(this,p);this.parent.addCommands({cmd:()=>{$e(this,p,w),this.editorDiv.style.color=w},undo:()=>{$e(this,p,y),this.editorDiv.style.color=y},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Lh=function(){const w=this.editorDiv.getElementsByTagName("div");if(w.length===0)return this.editorDiv.innerText;const y=[];for(let N=0,L=w.length;N<L;N++){const z=w[N].firstChild;(z==null?void 0:z.nodeName)==="#text"?y.push(z.data):y.push("")}return y.join(`
`)},ql=function(){const[w,y]=this.parent.viewportBaseDimensions,N=this.div.getBoundingClientRect();this.width=N.width/w,this.height=N.height/y},Ut(C,"_freeTextDefaultContent",""),Ut(C,"_l10nPromise"),Ut(C,"_internalPadding",0),Ut(C,"_defaultColor",null),Ut(C,"_defaultFontSize",10),Ut(C,"_keyboardManager",new i.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],C.prototype.commitOrRemove]])),Ut(C,"_type","freetext");let c=C;r.FreeTextEditor=c},(e,r,t)=>{var h,p,E,v,S,x,g,m,b,D,C,F,T,w,y,Nh,Ih,Bh,Uh,$l,jh,Hh,zh,jr,Wl,Fi,Oi,Cn,Yl,Di,M,Kl,Vh,Xh,Gh,Jl,Pi,kn,Ql;Object.defineProperty(r,"__esModule",{value:!0}),r.InkEditor=void 0,Object.defineProperty(r,"fitCurve",{enumerable:!0,get:function(){return l.fitCurve}});var n=t(1),i=t(6),l=t(25),c=t(7);const f=16,P=class P extends i.AnnotationEditor{constructor(re){super({...re,name:"inkEditor"});qe(this,y);qe(this,h,0);qe(this,p,0);qe(this,E,0);qe(this,v,this.canvasPointermove.bind(this));qe(this,S,this.canvasPointerleave.bind(this));qe(this,x,this.canvasPointerup.bind(this));qe(this,g,this.canvasPointerdown.bind(this));qe(this,m,!1);qe(this,b,!1);qe(this,D,null);qe(this,C,null);qe(this,F,0);qe(this,T,0);qe(this,w,null);this.color=re.color||null,this.thickness=re.thickness||null,this.opacity=re.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(re){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(H=>[H,re.get(H)]))}static updateDefaultParams(re,H){switch(re){case n.AnnotationEditorParamsType.INK_THICKNESS:P._defaultThickness=H;break;case n.AnnotationEditorParamsType.INK_COLOR:P._defaultColor=H;break;case n.AnnotationEditorParamsType.INK_OPACITY:P._defaultOpacity=H/100;break}}updateParams(re,H){switch(re){case n.AnnotationEditorParamsType.INK_THICKNESS:je(this,y,Nh).call(this,H);break;case n.AnnotationEditorParamsType.INK_COLOR:je(this,y,Ih).call(this,H);break;case n.AnnotationEditorParamsType.INK_OPACITY:je(this,y,Bh).call(this,H);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,P._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,P._defaultColor||i.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(P._defaultOpacity*100)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||P._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||P._defaultColor||i.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??P._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(je(this,y,Fi).call(this),je(this,y,Oi).call(this)),this.isAttachedToDOM||(this.parent.add(this),je(this,y,Cn).call(this)),je(this,y,kn).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,le(this,C).disconnect(),$e(this,C,null),super.remove())}enableEditMode(){le(this,m)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",le(this,g)),this.canvas.addEventListener("pointerup",le(this,x)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",le(this,g)),this.canvas.removeEventListener("pointerup",le(this,x)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){le(this,m)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),$e(this,m,!0),this.div.classList.add("disabled"),je(this,y,kn).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(re){super.focusin(re),this.enableEditMode()}canvasPointerdown(re){re.button!==0||!this.isInEditMode()||le(this,m)||(this.setInForeground(),re.type!=="mouse"&&this.div.focus(),re.stopPropagation(),this.canvas.addEventListener("pointerleave",le(this,S)),this.canvas.addEventListener("pointermove",le(this,v)),je(this,y,jh).call(this,re.offsetX,re.offsetY))}canvasPointermove(re){re.stopPropagation(),je(this,y,Hh).call(this,re.offsetX,re.offsetY)}canvasPointerup(re){re.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(re.stopPropagation(),je(this,y,Wl).call(this,re),this.setInBackground())}canvasPointerleave(re){je(this,y,Wl).call(this,re),this.setInBackground()}render(){if(this.div)return this.div;let re,H;this.width&&(re=this.x,H=this.y),super.render(),P._l10nPromise.get("editor_ink_aria_label").then(we=>{var Le;return(Le=this.div)==null?void 0:Le.setAttribute("aria-label",we)});const[Q,be,ge,ye]=je(this,y,Uh).call(this);if(this.setAt(Q,be,0,0),this.setDims(ge,ye),je(this,y,Fi).call(this),this.width){const[we,Le]=this.parent.viewportBaseDimensions;this.setAt(re*we,H*Le,this.width*we,this.height*Le),$e(this,b,!0),je(this,y,Cn).call(this),this.setDims(this.width*we,this.height*Le),je(this,y,jr).call(this),je(this,y,Ql).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return je(this,y,Oi).call(this),this.div}setDimensions(re,H){const Q=Math.round(re),be=Math.round(H);if(le(this,F)===Q&&le(this,T)===be)return;$e(this,F,Q),$e(this,T,be),this.canvas.style.visibility="hidden",le(this,h)&&Math.abs(le(this,h)-re/H)>.01&&(H=Math.ceil(re/le(this,h)),this.setDims(re,H));const[ge,ye]=this.parent.viewportBaseDimensions;this.width=re/ge,this.height=H/ye,le(this,m)&&je(this,y,Yl).call(this,re,H),je(this,y,Cn).call(this),je(this,y,jr).call(this),this.canvas.style.visibility="visible"}static deserialize(re,H){var nt,tt;const Q=super.deserialize(re,H);Q.thickness=re.thickness,Q.color=n.Util.makeHexColor(...re.color),Q.opacity=re.opacity;const[be,ge]=H.pageDimensions,ye=Q.width*be,we=Q.height*ge,Le=H.scaleFactor,Ve=re.thickness/2;$e(Q,h,ye/we),$e(Q,m,!0),$e(Q,F,Math.round(ye)),$e(Q,T,Math.round(we));for(const{bezier:Je}of re.paths){const et=[];Q.paths.push(et);let ht=Le*(Je[0]-Ve),Qe=Le*(we-Je[1]-Ve);for(let pt=2,st=Je.length;pt<st;pt+=6){const ct=Le*(Je[pt]-Ve),lr=Le*(we-Je[pt+1]-Ve),Yt=Le*(Je[pt+2]-Ve),Mt=Le*(we-Je[pt+3]-Ve),Me=Le*(Je[pt+4]-Ve),Se=Le*(we-Je[pt+5]-Ve);et.push([[ht,Qe],[ct,lr],[Yt,Mt],[Me,Se]]),ht=Me,Qe=Se}const it=je(this,M,Kl).call(this,et);Q.bezierPath2D.push(it)}const Ce=je(nt=Q,y,Jl).call(nt);return $e(Q,E,Math.max(f,Ce[2]-Ce[0])),$e(Q,p,Math.max(f,Ce[3]-Ce[1])),je(tt=Q,y,Yl).call(tt,ye,we),Q}serialize(){if(this.isEmpty())return null;const re=this.getRect(0,0),H=this.rotation%180===0?re[3]-re[1]:re[2]-re[0],Q=i.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:Q,thickness:this.thickness,opacity:this.opacity,paths:je(this,y,Vh).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,H),pageIndex:this.parent.pageIndex,rect:re,rotation:this.rotation}}};h=new WeakMap,p=new WeakMap,E=new WeakMap,v=new WeakMap,S=new WeakMap,x=new WeakMap,g=new WeakMap,m=new WeakMap,b=new WeakMap,D=new WeakMap,C=new WeakMap,F=new WeakMap,T=new WeakMap,w=new WeakMap,y=new WeakSet,Nh=function(re){const H=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=re,je(this,y,kn).call(this)},undo:()=>{this.thickness=H,je(this,y,kn).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Ih=function(re){const H=this.color;this.parent.addCommands({cmd:()=>{this.color=re,je(this,y,jr).call(this)},undo:()=>{this.color=H,je(this,y,jr).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Bh=function(re){re/=100;const H=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=re,je(this,y,jr).call(this)},undo:()=>{this.opacity=H,je(this,y,jr).call(this)},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Uh=function(){const{width:re,height:H,rotation:Q}=this.parent.viewport;switch(Q){case 90:return[0,re,re,H];case 180:return[re,H,re,H];case 270:return[H,0,re,H];default:return[0,0,re,H]}},$l=function(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,c.opacityToHex)(this.opacity)}`},jh=function(re,H){this.isEditing=!0,le(this,b)||($e(this,b,!0),je(this,y,Cn).call(this),this.thickness||(this.thickness=P._defaultThickness),this.color||(this.color=P._defaultColor||i.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=P._defaultOpacity)),this.currentPath.push([re,H]),$e(this,D,null),je(this,y,$l).call(this),this.ctx.beginPath(),this.ctx.moveTo(re,H),$e(this,w,()=>{le(this,w)&&(le(this,D)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):je(this,y,jr).call(this),this.ctx.lineTo(...le(this,D)),$e(this,D,null),this.ctx.stroke()),window.requestAnimationFrame(le(this,w)))}),window.requestAnimationFrame(le(this,w))},Hh=function(re,H){const[Q,be]=this.currentPath.at(-1);re===Q&&H===be||(this.currentPath.push([re,H]),$e(this,D,[re,H]))},zh=function(re,H){var Ve;this.ctx.closePath(),$e(this,w,null),re=Math.min(Math.max(re,0),this.canvas.width),H=Math.min(Math.max(H,0),this.canvas.height);const[Q,be]=this.currentPath.at(-1);(re!==Q||H!==be)&&this.currentPath.push([re,H]);let ge;if(this.currentPath.length!==1)ge=(0,l.fitCurve)(this.currentPath,30,null);else{const Ce=[re,H];ge=[[Ce,Ce.slice(),Ce.slice(),Ce]]}const ye=je(Ve=P,M,Kl).call(Ve,ge);this.currentPath.length=0;const we=()=>{this.paths.push(ge),this.bezierPath2D.push(ye),this.rebuild()},Le=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(je(this,y,Fi).call(this),je(this,y,Oi).call(this)),je(this,y,kn).call(this))};this.parent.addCommands({cmd:we,undo:Le,mustExec:!0})},jr=function(){if(this.isEmpty()){je(this,y,Di).call(this);return}je(this,y,$l).call(this);const{canvas:re,ctx:H}=this;H.setTransform(1,0,0,1,0,0),H.clearRect(0,0,re.width,re.height),je(this,y,Di).call(this);for(const Q of this.bezierPath2D)H.stroke(Q)},Wl=function(re){je(this,y,zh).call(this,re.offsetX,re.offsetY),this.canvas.removeEventListener("pointerleave",le(this,S)),this.canvas.removeEventListener("pointermove",le(this,v)),this.parent.addToAnnotationStorage(this)},Fi=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",P._l10nPromise.get("editor_ink_canvas_aria_label").then(re=>{var H;return(H=this.canvas)==null?void 0:H.setAttribute("aria-label",re)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Oi=function(){$e(this,C,new ResizeObserver(re=>{const H=re[0].contentRect;H.width&&H.height&&this.setDimensions(H.width,H.height)})),le(this,C).observe(this.div)},Cn=function(){if(!le(this,b))return;const[re,H]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*re),this.canvas.height=Math.ceil(this.height*H),je(this,y,Di).call(this)},Yl=function(re,H){const Q=je(this,y,Pi).call(this),be=(re-Q)/le(this,E),ge=(H-Q)/le(this,p);this.scaleFactor=Math.min(be,ge)},Di=function(){const re=je(this,y,Pi).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+re,this.translationY*this.scaleFactor+re)},M=new WeakSet,Kl=function(re){const H=new Path2D;for(let Q=0,be=re.length;Q<be;Q++){const[ge,ye,we,Le]=re[Q];Q===0&&H.moveTo(...ge),H.bezierCurveTo(ye[0],ye[1],we[0],we[1],Le[0],Le[1])}return H},Vh=function(re,H,Q,be){const ye=[],we=this.thickness/2;let Le,Ve;for(const Ce of this.paths){Le=[],Ve=[];for(let nt=0,tt=Ce.length;nt<tt;nt++){const[Je,et,ht,Qe]=Ce[nt],it=re*(Je[0]+H)+we,pt=be-re*(Je[1]+Q)-we,st=re*(et[0]+H)+we,ct=be-re*(et[1]+Q)-we,lr=re*(ht[0]+H)+we,Yt=be-re*(ht[1]+Q)-we,Mt=re*(Qe[0]+H)+we,Me=be-re*(Qe[1]+Q)-we;nt===0&&(Le.push(it,pt),Ve.push(it,pt)),Le.push(st,ct,lr,Yt,Mt,Me),je(this,y,Xh).call(this,it,pt,st,ct,lr,Yt,Mt,Me,4,Ve)}ye.push({bezier:Le,points:Ve})}return ye},Xh=function(re,H,Q,be,ge,ye,we,Le,Ve,Ce){if(je(this,y,Gh).call(this,re,H,Q,be,ge,ye,we,Le)){Ce.push(we,Le);return}for(let nt=1;nt<Ve-1;nt++){const tt=nt/Ve,Je=1-tt;let et=tt*re+Je*Q,ht=tt*H+Je*be,Qe=tt*Q+Je*ge,it=tt*be+Je*ye;const pt=tt*ge+Je*we,st=tt*ye+Je*Le;et=tt*et+Je*Qe,ht=tt*ht+Je*it,Qe=tt*Qe+Je*pt,it=tt*it+Je*st,et=tt*et+Je*Qe,ht=tt*ht+Je*it,Ce.push(et,ht)}Ce.push(we,Le)},Gh=function(re,H,Q,be,ge,ye,we,Le){const Ce=(3*Q-2*re-we)**2,nt=(3*be-2*H-Le)**2,tt=(3*ge-re-2*we)**2,Je=(3*ye-H-2*Le)**2;return Math.max(Ce,tt)+Math.max(nt,Je)<=10},Jl=function(){let re=1/0,H=-1/0,Q=1/0,be=-1/0;for(const ge of this.paths)for(const[ye,we,Le,Ve]of ge){const Ce=n.Util.bezierBoundingBox(...ye,...we,...Le,...Ve);re=Math.min(re,Ce[0]),Q=Math.min(Q,Ce[1]),H=Math.max(H,Ce[2]),be=Math.max(be,Ce[3])}return[re,Q,H,be]},Pi=function(){return le(this,m)?Math.ceil(this.thickness*this.parent.scaleFactor):0},kn=function(re=!1){if(this.isEmpty())return;if(!le(this,m)){je(this,y,jr).call(this);return}const H=je(this,y,Jl).call(this),Q=je(this,y,Pi).call(this);$e(this,E,Math.max(f,H[2]-H[0])),$e(this,p,Math.max(f,H[3]-H[1]));const be=Math.ceil(Q+le(this,E)*this.scaleFactor),ge=Math.ceil(Q+le(this,p)*this.scaleFactor),[ye,we]=this.parent.viewportBaseDimensions;this.width=be/ye,this.height=ge/we,$e(this,h,be/ge),je(this,y,Ql).call(this);const Le=this.translationX,Ve=this.translationY;this.translationX=-H[0],this.translationY=-H[1],je(this,y,Cn).call(this),je(this,y,jr).call(this),$e(this,F,be),$e(this,T,ge),this.setDims(be,ge);const Ce=re?Q/this.scaleFactor/2:0;this.translate(Le-this.translationX-Ce,Ve-this.translationY-Ce)},Ql=function(){const{style:re}=this.div;le(this,h)>=1?(re.minHeight=`${f}px`,re.minWidth=`${Math.round(le(this,h)*f)}px`):(re.minWidth=`${f}px`,re.minHeight=`${Math.round(f/le(this,h))}px`)},qe(P,M),Ut(P,"_defaultColor",null),Ut(P,"_defaultOpacity",1),Ut(P,"_defaultThickness",1),Ut(P,"_l10nPromise"),Ut(P,"_type","ink");let d=P;r.InkEditor=d},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.fitCurve=void 0;const n=t(26);r.fitCurve=n},e=>{function r(x,g,m){if(!Array.isArray(x))throw new TypeError("First argument should be an array");if(x.forEach(F=>{if(!Array.isArray(F)||F.some(T=>typeof T!="number")||F.length!==x[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),x=x.filter((F,T)=>T===0||!F.every((w,y)=>w===x[T-1][y])),x.length<2)return[];const b=x.length,D=E(x[1],x[0]),C=E(x[b-2],x[b-1]);return t(x,D,C,g,m)}function t(x,g,m,b,D){var F,T,w,y,N,L,X,z,se,me,_e,de,Y;if(x.length===2)return de=v.vectorLen(v.subtract(x[0],x[1]))/3,F=[x[0],v.addArrays(x[0],v.mulItems(g,de)),v.addArrays(x[1],v.mulItems(m,de)),x[1]],[F];if(T=f(x),[F,y,L]=n(x,T,T,g,m,D),y===0||y<b)return[F];if(y<b*b)for(w=T,N=y,X=L,Y=0;Y<20;Y++){if(w=l(F,x,w),[F,y,L]=n(x,T,w,g,m,D),y<b)return[F];if(L===X){let ie=y/N;if(ie>.9999&&ie<1.0001)break}N=y,X=L}return _e=[],z=v.subtract(x[L-1],x[L+1]),z.every(ie=>ie===0)&&(z=v.subtract(x[L-1],x[L]),[z[0],z[1]]=[-z[1],z[0]]),se=v.normalize(z),me=v.mulItems(se,-1),_e=_e.concat(t(x.slice(0,L+1),g,se,b,D)),_e=_e.concat(t(x.slice(L),me,m,b,D)),_e}function n(x,g,m,b,D,C){var F,T,w;return F=i(x,m,b,D),[T,w]=d(x,F,g),C&&C({bez:F,points:x,params:g,maxErr:T,maxPoint:w}),[F,T,w]}function i(x,g,m,b){var D,C,F,T,w,y,N,L,X,z,se,me,_e,de,Y,ie,fe,ae=x[0],W=x[x.length-1];for(D=[ae,null,null,W],C=v.zeros_Xx2x2(g.length),_e=0,de=g.length;_e<de;_e++)ie=g[_e],fe=1-ie,F=C[_e],F[0]=v.mulItems(m,3*ie*(fe*fe)),F[1]=v.mulItems(b,3*fe*(ie*ie));for(T=[[0,0],[0,0]],w=[0,0],_e=0,de=x.length;_e<de;_e++)ie=g[_e],F=C[_e],T[0][0]+=v.dot(F[0],F[0]),T[0][1]+=v.dot(F[0],F[1]),T[1][0]+=v.dot(F[0],F[1]),T[1][1]+=v.dot(F[1],F[1]),Y=v.subtract(x[_e],S.q([ae,ae,W,W],ie)),w[0]+=v.dot(F[0],Y),w[1]+=v.dot(F[1],Y);return y=T[0][0]*T[1][1]-T[1][0]*T[0][1],N=T[0][0]*w[1]-T[1][0]*w[0],L=w[0]*T[1][1]-w[1]*T[0][1],X=y===0?0:L/y,z=y===0?0:N/y,me=v.vectorLen(v.subtract(ae,W)),se=1e-6*me,X<se||z<se?(D[1]=v.addArrays(ae,v.mulItems(m,me/3)),D[2]=v.addArrays(W,v.mulItems(b,me/3))):(D[1]=v.addArrays(ae,v.mulItems(m,X)),D[2]=v.addArrays(W,v.mulItems(b,z))),D}function l(x,g,m){return m.map((b,D)=>c(x,g[D],b))}function c(x,g,m){var b=v.subtract(S.q(x,m),g),D=S.qprime(x,m),C=v.mulMatrix(b,D),F=v.sum(v.squareItems(D))+2*v.mulMatrix(b,S.qprimeprime(x,m));return F===0?m:m-C/F}function f(x){var g=[],m,b,D;return x.forEach((C,F)=>{m=F?b+v.vectorLen(v.subtract(C,D)):0,g.push(m),b=m,D=C}),g=g.map(C=>C/b),g}function d(x,g,m){var b,D,C,F,T,w,y,N;D=0,C=Math.floor(x.length/2);const L=h(g,10);for(T=0,w=x.length;T<w;T++)y=x[T],N=p(g,m[T],L,10),F=v.subtract(S.q(g,N),y),b=F[0]*F[0]+F[1]*F[1],b>D&&(D=b,C=T);return[D,C]}var h=function(x,g){for(var m,b=[0],D=x[0],C=0,F=1;F<=g;F++)m=S.q(x,F/g),C+=v.vectorLen(v.subtract(m,D)),b.push(C),D=m;return b=b.map(T=>T/C),b};function p(x,g,m,b){if(g<0)return 0;if(g>1)return 1;for(var D,C,F,T,w,y=1;y<=b;y++)if(g<=m[y]){T=(y-1)/b,F=y/b,C=m[y-1],D=m[y],w=(g-C)/(D-C)*(F-T)+T;break}return w}function E(x,g){return v.normalize(v.subtract(x,g))}class v{static zeros_Xx2x2(g){for(var m=[];g--;)m.push([0,0]);return m}static mulItems(g,m){return g.map(b=>b*m)}static mulMatrix(g,m){return g.reduce((b,D,C)=>b+D*m[C],0)}static subtract(g,m){return g.map((b,D)=>b-m[D])}static addArrays(g,m){return g.map((b,D)=>b+m[D])}static addItems(g,m){return g.map(b=>b+m)}static sum(g){return g.reduce((m,b)=>m+b)}static dot(g,m){return v.mulMatrix(g,m)}static vectorLen(g){return Math.hypot(...g)}static divItems(g,m){return g.map(b=>b/m)}static squareItems(g){return g.map(m=>m*m)}static normalize(g){return this.divItems(g,this.vectorLen(g))}}class S{static q(g,m){var b=1-m,D=v.mulItems(g[0],b*b*b),C=v.mulItems(g[1],3*b*b*m),F=v.mulItems(g[2],3*b*m*m),T=v.mulItems(g[3],m*m*m);return v.addArrays(v.addArrays(D,C),v.addArrays(F,T))}static qprime(g,m){var b=1-m,D=v.mulItems(v.subtract(g[1],g[0]),3*b*b),C=v.mulItems(v.subtract(g[2],g[1]),6*b*m),F=v.mulItems(v.subtract(g[3],g[2]),3*m*m);return v.addArrays(v.addArrays(D,C),F)}static qprimeprime(g,m){return v.addArrays(v.mulItems(v.addArrays(v.subtract(g[2],v.mulItems(g[1],2)),g[0]),6*(1-m)),v.mulItems(v.addArrays(v.subtract(g[3],v.mulItems(g[2],2)),g[1]),6*m))}}e.exports=r,e.exports.fitCubic=t,e.exports.createTangent=E},(e,r,t)=>{var M,Zl,ec,tc;Object.defineProperty(r,"__esModule",{value:!0}),r.AnnotationLayer=void 0;var n=t(1),i=t(8),l=t(5),c=t(28),f=t(29);const d=1e3,h=9,p=new WeakSet;function E(J){return{width:J[2]-J[0],height:J[3]-J[1]}}class v{static create(O){switch(O.data.annotationType){case n.AnnotationType.LINK:return new x(O);case n.AnnotationType.TEXT:return new g(O);case n.AnnotationType.WIDGET:switch(O.data.fieldType){case"Tx":return new b(O);case"Btn":return O.data.radioButton?new C(O):O.data.checkBox?new D(O):new F(O);case"Ch":return new T(O)}return new m(O);case n.AnnotationType.POPUP:return new w(O);case n.AnnotationType.FREETEXT:return new N(O);case n.AnnotationType.LINE:return new L(O);case n.AnnotationType.SQUARE:return new X(O);case n.AnnotationType.CIRCLE:return new z(O);case n.AnnotationType.POLYLINE:return new se(O);case n.AnnotationType.CARET:return new _e(O);case n.AnnotationType.INK:return new de(O);case n.AnnotationType.POLYGON:return new me(O);case n.AnnotationType.HIGHLIGHT:return new Y(O);case n.AnnotationType.UNDERLINE:return new ie(O);case n.AnnotationType.SQUIGGLY:return new fe(O);case n.AnnotationType.STRIKEOUT:return new ae(O);case n.AnnotationType.STAMP:return new W(O);case n.AnnotationType.FILEATTACHMENT:return new xe(O);default:return new S(O)}}}class S{constructor(O,{isRenderable:B=!1,ignoreBorder:G=!1,createQuadrilaterals:P=!1}={}){this.isRenderable=B,this.data=O.data,this.layer=O.layer,this.page=O.page,this.viewport=O.viewport,this.linkService=O.linkService,this.downloadManager=O.downloadManager,this.imageResourcesPath=O.imageResourcesPath,this.renderForms=O.renderForms,this.svgFactory=O.svgFactory,this.annotationStorage=O.annotationStorage,this.enableScripting=O.enableScripting,this.hasJSActions=O.hasJSActions,this._fieldObjects=O.fieldObjects,this._mouseState=O.mouseState,B&&(this.container=this._createContainer(G)),P&&(this.quadrilaterals=this._createQuadrilaterals(G))}_createContainer(O=!1){const B=this.data,G=this.page,P=this.viewport,K=document.createElement("section"),{width:oe,height:re}=E(B.rect),[H,Q,be,ge]=P.viewBox,ye=be-H,we=ge-Q;K.setAttribute("data-annotation-id",B.id);const Le=n.Util.normalizeRect([B.rect[0],G.view[3]-B.rect[1]+G.view[1],B.rect[2],G.view[3]-B.rect[3]+G.view[1]]);if(!O&&B.borderStyle.width>0){K.style.borderWidth=`${B.borderStyle.width}px`;const Ce=B.borderStyle.horizontalCornerRadius,nt=B.borderStyle.verticalCornerRadius;if(Ce>0||nt>0){const Je=`calc(${Ce}px * var(--scale-factor)) / calc(${nt}px * var(--scale-factor))`;K.style.borderRadius=Je}else if(this instanceof C){const Je=`calc(${oe}px * var(--scale-factor)) / calc(${re}px * var(--scale-factor))`;K.style.borderRadius=Je}switch(B.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:K.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:K.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:K.style.borderBottomStyle="solid";break}const tt=B.borderColor||null;tt?K.style.borderColor=n.Util.makeHexColor(tt[0]|0,tt[1]|0,tt[2]|0):K.style.borderWidth=0}K.style.left=`${100*(Le[0]-H)/ye}%`,K.style.top=`${100*(Le[1]-Q)/we}%`;const{rotation:Ve}=B;return B.hasOwnCanvas||Ve===0?(K.style.width=`${100*oe/ye}%`,K.style.height=`${100*re/we}%`):this.setRotation(Ve,K),K}setRotation(O,B=this.container){const[G,P,K,oe]=this.viewport.viewBox,re=K-G,H=oe-P,{width:Q,height:be}=E(this.data.rect);let ge,ye;O%180===0?(ge=100*Q/re,ye=100*be/H):(ge=100*be/re,ye=100*Q/H),B.style.width=`${ge}%`,B.style.height=`${ye}%`,B.setAttribute("data-main-rotation",(360-O)%360)}get _commonActions(){const O=(B,G,P)=>{const K=P.detail[B];P.target.style[G]=c.ColorConverters[`${K[0]}_HTML`](K.slice(1))};return(0,n.shadow)(this,"_commonActions",{display:B=>{const G=B.detail.display%2===1;this.container.style.visibility=G?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:G,print:B.detail.display===0||B.detail.display===3})},print:B=>{this.annotationStorage.setValue(this.data.id,{print:B.detail.print})},hidden:B=>{this.container.style.visibility=B.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:B.detail.hidden})},focus:B=>{setTimeout(()=>B.target.focus({preventScroll:!1}),0)},userName:B=>{B.target.title=B.detail.userName},readonly:B=>{B.detail.readonly?B.target.setAttribute("readonly",""):B.target.removeAttribute("readonly")},required:B=>{this._setRequired(B.target,B.detail.required)},bgColor:B=>{O("bgColor","backgroundColor",B)},fillColor:B=>{O("fillColor","backgroundColor",B)},fgColor:B=>{O("fgColor","color",B)},textColor:B=>{O("textColor","color",B)},borderColor:B=>{O("borderColor","borderColor",B)},strokeColor:B=>{O("strokeColor","borderColor",B)},rotation:B=>{const G=B.detail.rotation;this.setRotation(G),this.annotationStorage.setValue(this.data.id,{rotation:G})}})}_dispatchEventFromSandbox(O,B){const G=this._commonActions;for(const P of Object.keys(B.detail)){const K=O[P]||G[P];K&&K(B)}}_setDefaultPropertiesFromJS(O){if(!this.enableScripting)return;const B=this.annotationStorage.getRawValue(this.data.id);if(!B)return;const G=this._commonActions;for(const[P,K]of Object.entries(B)){const oe=G[P];if(oe){const re={detail:{[P]:K},target:O};oe(re),delete B[P]}}}_createQuadrilaterals(O=!1){if(!this.data.quadPoints)return null;const B=[],G=this.data.rect;for(const P of this.data.quadPoints)this.data.rect=[P[2].x,P[2].y,P[1].x,P[1].y],B.push(this._createContainer(O));return this.data.rect=G,B}_createPopup(O,B){let G=this.container;this.quadrilaterals&&(O=O||this.quadrilaterals,G=this.quadrilaterals[0]),O||(O=document.createElement("div"),O.className="popupTriggerArea",G.append(O));const K=new y({container:G,trigger:O,color:B.color,titleObj:B.titleObj,modificationDate:B.modificationDate,contentsObj:B.contentsObj,richText:B.richText,hideWrapper:!0}).render();K.style.left="100%",G.append(K)}_renderQuadrilaterals(O){for(const B of this.quadrilaterals)B.className=O;return this.quadrilaterals}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(O,B=null){const G=[];if(this._fieldObjects){const P=this._fieldObjects[O];if(P)for(const{page:K,id:oe,exportValues:re}of P){if(K===-1||oe===B)continue;const H=typeof re=="string"?re:null,Q=document.querySelector(`[data-element-id="${oe}"]`);if(Q&&!p.has(Q)){(0,n.warn)(`_getElementsByName - element not allowed: ${oe}`);continue}G.push({id:oe,exportValue:H,domElement:Q})}return G}for(const P of document.getElementsByName(O)){const{id:K,exportValue:oe}=P;K!==B&&p.has(P)&&G.push({id:K,exportValue:oe,domElement:P})}return G}static get platform(){const O=typeof navigator<"u"?navigator.platform:"";return(0,n.shadow)(this,"platform",{isWin:O.includes("Win"),isMac:O.includes("Mac")})}}class x extends S{constructor(O,B=null){super(O,{isRenderable:!0,ignoreBorder:!!(B!=null&&B.ignoreBorder),createQuadrilaterals:!0}),this.isTooltipOnly=O.data.isTooltipOnly}render(){const{data:O,linkService:B}=this,G=document.createElement("a");G.setAttribute("data-element-id",O.id);let P=!1;return O.url?(B.addLinkAttributes(G,O.url,O.newWindow),P=!0):O.action?(this._bindNamedAction(G,O.action),P=!0):O.dest?(this._bindLink(G,O.dest),P=!0):(O.actions&&(O.actions.Action||O.actions["Mouse Up"]||O.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(G,O),P=!0),O.resetForm?(this._bindResetFormAction(G,O.resetForm),P=!0):this.isTooltipOnly&&!P&&(this._bindLink(G,""),P=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((K,oe)=>{const re=oe===0?G:G.cloneNode();return K.append(re),K}):(this.container.className="linkAnnotation",P&&this.container.append(G),this.container)}_bindLink(O,B){O.href=this.linkService.getDestinationHash(B),O.onclick=()=>(B&&this.linkService.goToDestination(B),!1),(B||B==="")&&(O.className="internalLink")}_bindNamedAction(O,B){O.href=this.linkService.getAnchorUrl(""),O.onclick=()=>(this.linkService.executeNamedAction(B),!1),O.className="internalLink"}_bindJSAction(O,B){O.href=this.linkService.getAnchorUrl("");const G=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const P of Object.keys(B.actions)){const K=G.get(P);K&&(O[K]=()=>{var oe;return(oe=this.linkService.eventBus)==null||oe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:B.id,name:P}}),!1})}O.onclick||(O.onclick=()=>!1),O.className="internalLink"}_bindResetFormAction(O,B){const G=O.onclick;if(G||(O.href=this.linkService.getAnchorUrl("")),O.className="internalLink",!this._fieldObjects){(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),G||(O.onclick=()=>!1);return}O.onclick=()=>{var be;G&&G();const{fields:P,refs:K,include:oe}=B,re=[];if(P.length!==0||K.length!==0){const ge=new Set(K);for(const ye of P){const we=this._fieldObjects[ye]||[];for(const{id:Le}of we)ge.add(Le)}for(const ye of Object.values(this._fieldObjects))for(const we of ye)ge.has(we.id)===oe&&re.push(we)}else for(const ge of Object.values(this._fieldObjects))re.push(...ge);const H=this.annotationStorage,Q=[];for(const ge of re){const{id:ye}=ge;switch(Q.push(ye),ge.type){case"text":{const Le=ge.defaultValue||"";H.setValue(ye,{value:Le});break}case"checkbox":case"radiobutton":{const Le=ge.defaultValue===ge.exportValues;H.setValue(ye,{value:Le});break}case"combobox":case"listbox":{const Le=ge.defaultValue||"";H.setValue(ye,{value:Le});break}default:continue}const we=document.querySelector(`[data-element-id="${ye}"]`);if(we){if(!p.has(we)){(0,n.warn)(`_bindResetFormAction - element not allowed: ${ye}`);continue}}else continue;we.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((be=this.linkService.eventBus)==null||be.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Q,name:"ResetForm"}})),!1}}}class g extends S{constructor(O){var G,P,K;const B=!!(O.data.hasPopup||(G=O.data.titleObj)!=null&&G.str||(P=O.data.contentsObj)!=null&&P.str||(K=O.data.richText)!=null&&K.str);super(O,{isRenderable:B})}render(){this.container.className="textAnnotation";const O=document.createElement("img");return O.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",O.alt="[{{type}} Annotation]",O.dataset.l10nId="text_annotation_type",O.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(O,this.data),this.container.append(O),this.container}}class m extends S{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(O){const{isWin:B,isMac:G}=S.platform;return B&&O.ctrlKey||G&&O.metaKey}_setEventListener(O,B,G,P){B.includes("mouse")?O.addEventListener(B,K=>{var oe;(oe=this.linkService.eventBus)==null||oe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:G,value:P(K),shift:K.shiftKey,modifier:this._getKeyModifier(K)}})}):O.addEventListener(B,K=>{var oe;(oe=this.linkService.eventBus)==null||oe.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:G,value:P(K)}})})}_setEventListeners(O,B,G){var P;for(const[K,oe]of B)(oe==="Action"||(P=this.data.actions)!=null&&P[oe])&&this._setEventListener(O,K,oe,G)}_setBackgroundColor(O){const B=this.data.backgroundColor||null;O.style.backgroundColor=B===null?"transparent":n.Util.makeHexColor(B[0],B[1],B[2])}_setTextStyle(O){const B=["left","center","right"],{fontColor:G}=this.data.defaultAppearanceData,P=this.data.defaultAppearanceData.fontSize||h,K=O.style;let oe;if(this.data.multiLine){const re=Math.abs(this.data.rect[3]-this.data.rect[1]),H=Math.round(re/(n.LINE_FACTOR*P))||1,Q=re/H;oe=Math.min(P,Math.round(Q/n.LINE_FACTOR))}else{const re=Math.abs(this.data.rect[3]-this.data.rect[1]);oe=Math.min(P,Math.round(re/n.LINE_FACTOR))}K.fontSize=`calc(${oe}px * var(--scale-factor))`,K.color=n.Util.makeHexColor(G[0],G[1],G[2]),this.data.textAlignment!==null&&(K.textAlign=B[this.data.textAlignment])}_setRequired(O,B){B?O.setAttribute("required",!0):O.removeAttribute("required"),O.setAttribute("aria-required",B)}}class b extends m{constructor(O){const B=O.renderForms||!O.data.hasAppearance&&!!O.data.fieldValue;super(O,{isRenderable:B})}setPropertyOnSiblings(O,B,G,P){const K=this.annotationStorage;for(const oe of this._getElementsByName(O.name,O.id))oe.domElement&&(oe.domElement[B]=G),K.setValue(oe.id,{[P]:G})}render(){var P;const O=this.annotationStorage,B=this.data.id;this.container.className="textWidgetAnnotation";let G=null;if(this.renderForms){const K=O.getValue(B,{value:this.data.fieldValue});let oe=K.formattedValue||K.value||"";const re=O.getValue(B,{charLimit:this.data.maxLen}).charLimit;re&&oe.length>re&&(oe=oe.slice(0,re));const H={userValue:oe,formattedValue:null,valueOnFocus:""};this.data.multiLine?(G=document.createElement("textarea"),G.textContent=oe,this.data.doNotScroll&&(G.style.overflowY="hidden")):(G=document.createElement("input"),G.type="text",G.setAttribute("value",oe),this.data.doNotScroll&&(G.style.overflowX="hidden")),p.add(G),G.setAttribute("data-element-id",B),G.disabled=this.data.readOnly,G.name=this.data.fieldName,G.tabIndex=d,this._setRequired(G,this.data.required),re&&(G.maxLength=re),G.addEventListener("input",be=>{O.setValue(B,{value:be.target.value}),this.setPropertyOnSiblings(G,"value",be.target.value,"value")}),G.addEventListener("resetform",be=>{const ge=this.data.defaultFieldValue??"";G.value=H.userValue=ge,H.formattedValue=null});let Q=be=>{const{formattedValue:ge}=H;ge!=null&&(be.target.value=ge),be.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){G.addEventListener("focus",ge=>{H.userValue&&(ge.target.value=H.userValue),H.valueOnFocus=ge.target.value}),G.addEventListener("updatefromsandbox",ge=>{const ye={value(we){H.userValue=we.detail.value??"",O.setValue(B,{value:H.userValue.toString()}),we.target.value=H.userValue},formattedValue(we){const{formattedValue:Le}=we.detail;H.formattedValue=Le,Le!=null&&we.target!==document.activeElement&&(we.target.value=Le),O.setValue(B,{formattedValue:Le})},selRange(we){we.target.setSelectionRange(...we.detail.selRange)},charLimit:we=>{var nt;const{charLimit:Le}=we.detail,{target:Ve}=we;if(Le===0){Ve.removeAttribute("maxLength");return}Ve.setAttribute("maxLength",Le);let Ce=H.userValue;!Ce||Ce.length<=Le||(Ce=Ce.slice(0,Le),Ve.value=H.userValue=Ce,O.setValue(B,{value:Ce}),(nt=this.linkService.eventBus)==null||nt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:B,name:"Keystroke",value:Ce,willCommit:!0,commitKey:1,selStart:Ve.selectionStart,selEnd:Ve.selectionEnd}}))}};this._dispatchEventFromSandbox(ye,ge)}),G.addEventListener("keydown",ge=>{var Le;let ye=-1;if(ge.key==="Escape"?ye=0:ge.key==="Enter"?ye=2:ge.key==="Tab"&&(ye=3),ye===-1)return;const{value:we}=ge.target;H.valueOnFocus!==we&&(H.userValue=we,(Le=this.linkService.eventBus)==null||Le.dispatch("dispatcheventinsandbox",{source:this,detail:{id:B,name:"Keystroke",value:we,willCommit:!0,commitKey:ye,selStart:ge.target.selectionStart,selEnd:ge.target.selectionEnd}}))});const be=Q;Q=null,G.addEventListener("blur",ge=>{var we;const{value:ye}=ge.target;H.userValue=ye,this._mouseState.isDown&&H.valueOnFocus!==ye&&((we=this.linkService.eventBus)==null||we.dispatch("dispatcheventinsandbox",{source:this,detail:{id:B,name:"Keystroke",value:ye,willCommit:!0,commitKey:1,selStart:ge.target.selectionStart,selEnd:ge.target.selectionEnd}})),be(ge)}),(P=this.data.actions)!=null&&P.Keystroke&&G.addEventListener("beforeinput",ge=>{var Je;const{data:ye,target:we}=ge,{value:Le,selectionStart:Ve,selectionEnd:Ce}=we;let nt=Ve,tt=Ce;switch(ge.inputType){case"deleteWordBackward":{const et=Le.substring(0,Ve).match(/\w*[^\w]*$/);et&&(nt-=et[0].length);break}case"deleteWordForward":{const et=Le.substring(Ve).match(/^[^\w]*\w*/);et&&(tt+=et[0].length);break}case"deleteContentBackward":Ve===Ce&&(nt-=1);break;case"deleteContentForward":Ve===Ce&&(tt+=1);break}ge.preventDefault(),(Je=this.linkService.eventBus)==null||Je.dispatch("dispatcheventinsandbox",{source:this,detail:{id:B,name:"Keystroke",value:Le,change:ye||"",willCommit:!1,selStart:nt,selEnd:tt}})}),this._setEventListeners(G,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ge=>ge.target.value)}if(Q&&G.addEventListener("blur",Q),this.data.comb){const ge=(this.data.rect[2]-this.data.rect[0])/re;G.classList.add("comb"),G.style.letterSpacing=`calc(${ge}px * var(--scale-factor) - 1ch)`}}else G=document.createElement("div"),G.textContent=this.data.fieldValue,G.style.verticalAlign="middle",G.style.display="table-cell";return this._setTextStyle(G),this._setBackgroundColor(G),this._setDefaultPropertiesFromJS(G),this.container.append(G),this.container}}class D extends m{constructor(O){super(O,{isRenderable:O.renderForms})}render(){const O=this.annotationStorage,B=this.data,G=B.id;let P=O.getValue(G,{value:B.exportValue===B.fieldValue}).value;typeof P=="string"&&(P=P!=="Off",O.setValue(G,{value:P})),this.container.className="buttonWidgetAnnotation checkBox";const K=document.createElement("input");return p.add(K),K.setAttribute("data-element-id",G),K.disabled=B.readOnly,this._setRequired(K,this.data.required),K.type="checkbox",K.name=B.fieldName,P&&K.setAttribute("checked",!0),K.setAttribute("exportValue",B.exportValue),K.tabIndex=d,K.addEventListener("change",oe=>{const{name:re,checked:H}=oe.target;for(const Q of this._getElementsByName(re,G)){const be=H&&Q.exportValue===B.exportValue;Q.domElement&&(Q.domElement.checked=be),O.setValue(Q.id,{value:be})}O.setValue(G,{value:H})}),K.addEventListener("resetform",oe=>{const re=B.defaultFieldValue||"Off";oe.target.checked=re===B.exportValue}),this.enableScripting&&this.hasJSActions&&(K.addEventListener("updatefromsandbox",oe=>{const re={value(H){H.target.checked=H.detail.value!=="Off",O.setValue(G,{value:H.target.checked})}};this._dispatchEventFromSandbox(re,oe)}),this._setEventListeners(K,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],oe=>oe.target.checked)),this._setBackgroundColor(K),this._setDefaultPropertiesFromJS(K),this.container.append(K),this.container}}class C extends m{constructor(O){super(O,{isRenderable:O.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const O=this.annotationStorage,B=this.data,G=B.id;let P=O.getValue(G,{value:B.fieldValue===B.buttonValue}).value;typeof P=="string"&&(P=P!==B.buttonValue,O.setValue(G,{value:P}));const K=document.createElement("input");if(p.add(K),K.setAttribute("data-element-id",G),K.disabled=B.readOnly,this._setRequired(K,this.data.required),K.type="radio",K.name=B.fieldName,P&&K.setAttribute("checked",!0),K.tabIndex=d,K.addEventListener("change",oe=>{const{name:re,checked:H}=oe.target;for(const Q of this._getElementsByName(re,G))O.setValue(Q.id,{value:!1});O.setValue(G,{value:H})}),K.addEventListener("resetform",oe=>{const re=B.defaultFieldValue;oe.target.checked=re!=null&&re===B.buttonValue}),this.enableScripting&&this.hasJSActions){const oe=B.buttonValue;K.addEventListener("updatefromsandbox",re=>{const H={value:Q=>{const be=oe===Q.detail.value;for(const ge of this._getElementsByName(Q.target.name)){const ye=be&&ge.id===G;ge.domElement&&(ge.domElement.checked=ye),O.setValue(ge.id,{value:ye})}}};this._dispatchEventFromSandbox(H,re)}),this._setEventListeners(K,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],re=>re.target.checked)}return this._setBackgroundColor(K),this._setDefaultPropertiesFromJS(K),this.container.append(K),this.container}}class F extends x{constructor(O){super(O,{ignoreBorder:O.data.hasAppearance})}render(){const O=super.render();O.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(O.title=this.data.alternativeText);const B=O.lastChild;return this.enableScripting&&this.hasJSActions&&B&&(this._setDefaultPropertiesFromJS(B),B.addEventListener("updatefromsandbox",G=>{this._dispatchEventFromSandbox({},G)})),O}}class T extends m{constructor(O){super(O,{isRenderable:O.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const O=this.annotationStorage,B=this.data.id,G=O.getValue(B,{value:this.data.fieldValue}),P=document.createElement("select");p.add(P),P.setAttribute("data-element-id",B),P.disabled=this.data.readOnly,this._setRequired(P,this.data.required),P.name=this.data.fieldName,P.tabIndex=d;let K=this.data.combo&&this.data.options.length>0;this.data.combo||(P.size=this.data.options.length,this.data.multiSelect&&(P.multiple=!0)),P.addEventListener("resetform",Q=>{const be=this.data.defaultFieldValue;for(const ge of P.options)ge.selected=ge.value===be});for(const Q of this.data.options){const be=document.createElement("option");be.textContent=Q.displayValue,be.value=Q.exportValue,G.value.includes(Q.exportValue)&&(be.setAttribute("selected",!0),K=!1),P.append(be)}let oe=null;if(K){const Q=document.createElement("option");Q.value=" ",Q.setAttribute("hidden",!0),Q.setAttribute("selected",!0),P.prepend(Q),oe=()=>{Q.remove(),P.removeEventListener("input",oe),oe=null},P.addEventListener("input",oe)}const re=(Q,be)=>{const ge=be?"value":"textContent",ye=Q.target.options;return Q.target.multiple?Array.prototype.filter.call(ye,we=>we.selected).map(we=>we[ge]):ye.selectedIndex===-1?null:ye[ye.selectedIndex][ge]},H=Q=>{const be=Q.target.options;return Array.prototype.map.call(be,ge=>({displayValue:ge.textContent,exportValue:ge.value}))};return this.enableScripting&&this.hasJSActions?(P.addEventListener("updatefromsandbox",Q=>{const be={value(ge){oe==null||oe();const ye=ge.detail.value,we=new Set(Array.isArray(ye)?ye:[ye]);for(const Le of P.options)Le.selected=we.has(Le.value);O.setValue(B,{value:re(ge,!0)})},multipleSelection(ge){P.multiple=!0},remove(ge){const ye=P.options,we=ge.detail.remove;ye[we].selected=!1,P.remove(we),ye.length>0&&Array.prototype.findIndex.call(ye,Ve=>Ve.selected)===-1&&(ye[0].selected=!0),O.setValue(B,{value:re(ge,!0),items:H(ge)})},clear(ge){for(;P.length!==0;)P.remove(0);O.setValue(B,{value:null,items:[]})},insert(ge){const{index:ye,displayValue:we,exportValue:Le}=ge.detail.insert,Ve=P.children[ye],Ce=document.createElement("option");Ce.textContent=we,Ce.value=Le,Ve?Ve.before(Ce):P.append(Ce),O.setValue(B,{value:re(ge,!0),items:H(ge)})},items(ge){const{items:ye}=ge.detail;for(;P.length!==0;)P.remove(0);for(const we of ye){const{displayValue:Le,exportValue:Ve}=we,Ce=document.createElement("option");Ce.textContent=Le,Ce.value=Ve,P.append(Ce)}P.options.length>0&&(P.options[0].selected=!0),O.setValue(B,{value:re(ge,!0),items:H(ge)})},indices(ge){const ye=new Set(ge.detail.indices);for(const we of ge.target.options)we.selected=ye.has(we.index);O.setValue(B,{value:re(ge,!0)})},editable(ge){ge.target.disabled=!ge.detail.editable}};this._dispatchEventFromSandbox(be,Q)}),P.addEventListener("input",Q=>{var ye;const be=re(Q,!0),ge=re(Q,!1);O.setValue(B,{value:be}),(ye=this.linkService.eventBus)==null||ye.dispatch("dispatcheventinsandbox",{source:this,detail:{id:B,name:"Keystroke",value:ge,changeEx:be,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(P,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],Q=>Q.target.checked)):P.addEventListener("input",function(Q){O.setValue(B,{value:re(Q,!0)})}),this.data.combo&&this._setTextStyle(P),this._setBackgroundColor(P),this._setDefaultPropertiesFromJS(P),this.container.append(P),this.container}}class w extends S{constructor(O){var G,P,K;const B=!!((G=O.data.titleObj)!=null&&G.str||(P=O.data.contentsObj)!=null&&P.str||(K=O.data.richText)!=null&&K.str);super(O,{isRenderable:B})}render(){const O=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",O.includes(this.data.parentType))return this.container;const B=`[data-annotation-id="${this.data.parentId}"]`,G=this.layer.querySelectorAll(B);if(G.length===0)return this.container;const P=new y({container:this.container,trigger:Array.from(G),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),K=this.page,oe=n.Util.normalizeRect([this.data.parentRect[0],K.view[3]-this.data.parentRect[1]+K.view[1],this.data.parentRect[2],K.view[3]-this.data.parentRect[3]+K.view[1]]),re=oe[0]+this.data.parentRect[2]-this.data.parentRect[0],H=oe[1],[Q,be,ge,ye]=this.viewport.viewBox,we=ge-Q,Le=ye-be;return this.container.style.left=`${100*(re-Q)/we}%`,this.container.style.top=`${100*(H-be)/Le}%`,this.container.append(P.render()),this.container}}class y{constructor(O){this.container=O.container,this.trigger=O.trigger,this.color=O.color,this.titleObj=O.titleObj,this.modificationDate=O.modificationDate,this.contentsObj=O.contentsObj,this.richText=O.richText,this.hideWrapper=O.hideWrapper||!1,this.pinned=!1}render(){var re,H;const B=document.createElement("div");B.className="popupWrapper",this.hideElement=this.hideWrapper?B:this.container,this.hideElement.hidden=!0;const G=document.createElement("div");G.className="popup";const P=this.color;if(P){const Q=.7*(255-P[0])+P[0],be=.7*(255-P[1])+P[1],ge=.7*(255-P[2])+P[2];G.style.backgroundColor=n.Util.makeHexColor(Q|0,be|0,ge|0)}const K=document.createElement("h1");K.dir=this.titleObj.dir,K.textContent=this.titleObj.str,G.append(K);const oe=i.PDFDateString.toDateObject(this.modificationDate);if(oe){const Q=document.createElement("span");Q.className="popupDate",Q.textContent="{{date}}, {{time}}",Q.dataset.l10nId="annotation_date_string",Q.dataset.l10nArgs=JSON.stringify({date:oe.toLocaleDateString(),time:oe.toLocaleTimeString()}),G.append(Q)}if((re=this.richText)!=null&&re.str&&(!((H=this.contentsObj)!=null&&H.str)||this.contentsObj.str===this.richText.str))f.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:G}),G.lastChild.className="richText popupContent";else{const Q=this._formatContents(this.contentsObj);G.append(Q)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const Q of this.trigger)Q.addEventListener("click",this._toggle.bind(this)),Q.addEventListener("mouseover",this._show.bind(this,!1)),Q.addEventListener("mouseout",this._hide.bind(this,!1));return G.addEventListener("click",this._hide.bind(this,!0)),B.append(G),B}_formatContents({str:O,dir:B}){const G=document.createElement("p");G.className="popupContent",G.dir=B;const P=O.split(/(?:\r\n?|\n)/);for(let K=0,oe=P.length;K<oe;++K){const re=P[K];G.append(document.createTextNode(re)),K<oe-1&&G.append(document.createElement("br"))}return G}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(O=!1){O&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(O=!0){O&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class N extends S{constructor(O){var G,P,K;const B=!!(O.data.hasPopup||(G=O.data.titleObj)!=null&&G.str||(P=O.data.contentsObj)!=null&&P.str||(K=O.data.richText)!=null&&K.str);super(O,{isRenderable:B,ignoreBorder:!0}),this.textContent=O.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const O=document.createElement("div");O.className="annotationTextContent",O.setAttribute("role","comment");for(const B of this.textContent){const G=document.createElement("span");G.textContent=B,O.append(G)}this.container.append(O)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class L extends S{constructor(O){var G,P,K;const B=!!(O.data.hasPopup||(G=O.data.titleObj)!=null&&G.str||(P=O.data.contentsObj)!=null&&P.str||(K=O.data.richText)!=null&&K.str);super(O,{isRenderable:B,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const O=this.data,{width:B,height:G}=E(O.rect),P=this.svgFactory.create(B,G,!0),K=this.svgFactory.createElement("svg:line");return K.setAttribute("x1",O.rect[2]-O.lineCoordinates[0]),K.setAttribute("y1",O.rect[3]-O.lineCoordinates[1]),K.setAttribute("x2",O.rect[2]-O.lineCoordinates[2]),K.setAttribute("y2",O.rect[3]-O.lineCoordinates[3]),K.setAttribute("stroke-width",O.borderStyle.width||1),K.setAttribute("stroke","transparent"),K.setAttribute("fill","transparent"),P.append(K),this.container.append(P),this._createPopup(K,O),this.container}}class X extends S{constructor(O){var G,P,K;const B=!!(O.data.hasPopup||(G=O.data.titleObj)!=null&&G.str||(P=O.data.contentsObj)!=null&&P.str||(K=O.data.richText)!=null&&K.str);super(O,{isRenderable:B,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const O=this.data,{width:B,height:G}=E(O.rect),P=this.svgFactory.create(B,G,!0),K=O.borderStyle.width,oe=this.svgFactory.createElement("svg:rect");return oe.setAttribute("x",K/2),oe.setAttribute("y",K/2),oe.setAttribute("width",B-K),oe.setAttribute("height",G-K),oe.setAttribute("stroke-width",K||1),oe.setAttribute("stroke","transparent"),oe.setAttribute("fill","transparent"),P.append(oe),this.container.append(P),this._createPopup(oe,O),this.container}}class z extends S{constructor(O){var G,P,K;const B=!!(O.data.hasPopup||(G=O.data.titleObj)!=null&&G.str||(P=O.data.contentsObj)!=null&&P.str||(K=O.data.richText)!=null&&K.str);super(O,{isRenderable:B,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const O=this.data,{width:B,height:G}=E(O.rect),P=this.svgFactory.create(B,G,!0),K=O.borderStyle.width,oe=this.svgFactory.createElement("svg:ellipse");return oe.setAttribute("cx",B/2),oe.setAttribute("cy",G/2),oe.setAttribute("rx",B/2-K/2),oe.setAttribute("ry",G/2-K/2),oe.setAttribute("stroke-width",K||1),oe.setAttribute("stroke","transparent"),oe.setAttribute("fill","transparent"),P.append(oe),this.container.append(P),this._createPopup(oe,O),this.container}}class se extends S{constructor(O){var G,P,K;const B=!!(O.data.hasPopup||(G=O.data.titleObj)!=null&&G.str||(P=O.data.contentsObj)!=null&&P.str||(K=O.data.richText)!=null&&K.str);super(O,{isRenderable:B,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const O=this.data,{width:B,height:G}=E(O.rect),P=this.svgFactory.create(B,G,!0);let K=[];for(const re of O.vertices){const H=re.x-O.rect[0],Q=O.rect[3]-re.y;K.push(H+","+Q)}K=K.join(" ");const oe=this.svgFactory.createElement(this.svgElementName);return oe.setAttribute("points",K),oe.setAttribute("stroke-width",O.borderStyle.width||1),oe.setAttribute("stroke","transparent"),oe.setAttribute("fill","transparent"),P.append(oe),this.container.append(P),this._createPopup(oe,O),this.container}}class me extends se{constructor(O){super(O),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class _e extends S{constructor(O){var G,P,K;const B=!!(O.data.hasPopup||(G=O.data.titleObj)!=null&&G.str||(P=O.data.contentsObj)!=null&&P.str||(K=O.data.richText)!=null&&K.str);super(O,{isRenderable:B,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class de extends S{constructor(O){var G,P,K;const B=!!(O.data.hasPopup||(G=O.data.titleObj)!=null&&G.str||(P=O.data.contentsObj)!=null&&P.str||(K=O.data.richText)!=null&&K.str);super(O,{isRenderable:B,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const O=this.data,{width:B,height:G}=E(O.rect),P=this.svgFactory.create(B,G,!0);for(const K of O.inkLists){let oe=[];for(const H of K){const Q=H.x-O.rect[0],be=O.rect[3]-H.y;oe.push(`${Q},${be}`)}oe=oe.join(" ");const re=this.svgFactory.createElement(this.svgElementName);re.setAttribute("points",oe),re.setAttribute("stroke-width",O.borderStyle.width||1),re.setAttribute("stroke","transparent"),re.setAttribute("fill","transparent"),this._createPopup(re,O),P.append(re)}return this.container.append(P),this.container}}class Y extends S{constructor(O){var G,P,K;const B=!!(O.data.hasPopup||(G=O.data.titleObj)!=null&&G.str||(P=O.data.contentsObj)!=null&&P.str||(K=O.data.richText)!=null&&K.str);super(O,{isRenderable:B,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class ie extends S{constructor(O){var G,P,K;const B=!!(O.data.hasPopup||(G=O.data.titleObj)!=null&&G.str||(P=O.data.contentsObj)!=null&&P.str||(K=O.data.richText)!=null&&K.str);super(O,{isRenderable:B,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class fe extends S{constructor(O){var G,P,K;const B=!!(O.data.hasPopup||(G=O.data.titleObj)!=null&&G.str||(P=O.data.contentsObj)!=null&&P.str||(K=O.data.richText)!=null&&K.str);super(O,{isRenderable:B,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class ae extends S{constructor(O){var G,P,K;const B=!!(O.data.hasPopup||(G=O.data.titleObj)!=null&&G.str||(P=O.data.contentsObj)!=null&&P.str||(K=O.data.richText)!=null&&K.str);super(O,{isRenderable:B,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class W extends S{constructor(O){var G,P,K;const B=!!(O.data.hasPopup||(G=O.data.titleObj)!=null&&G.str||(P=O.data.contentsObj)!=null&&P.str||(K=O.data.richText)!=null&&K.str);super(O,{isRenderable:B,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class xe extends S{constructor(O){var P;super(O,{isRenderable:!0});const{filename:B,content:G}=this.data.file;this.filename=(0,i.getFilenameFromUrl)(B),this.content=G,(P=this.linkService.eventBus)==null||P.dispatch("fileattachmentannotation",{source:this,filename:B,content:G})}render(){var B,G;this.container.className="fileAttachmentAnnotation";const O=document.createElement("div");return O.className="popupTriggerArea",O.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((B=this.data.titleObj)!=null&&B.str||(G=this.data.contentsObj)!=null&&G.str||this.data.richText)&&this._createPopup(O,this.data),this.container.append(O),this.container}_download(){var O;(O=this.downloadManager)==null||O.openOrDownloadData(this.container,this.content,this.filename)}}const Z=class Z{static render(O){var re,H;const{annotations:B,div:G,viewport:P,accessibilityManager:K}=O;je(this,M,ec).call(this,G,P);let oe=0;for(const Q of B){if(Q.annotationType!==n.AnnotationType.POPUP){const{width:ge,height:ye}=E(Q.rect);if(ge<=0||ye<=0)continue}const be=v.create({data:Q,layer:G,page:O.page,viewport:P,linkService:O.linkService,downloadManager:O.downloadManager,imageResourcesPath:O.imageResourcesPath||"",renderForms:O.renderForms!==!1,svgFactory:new i.DOMSVGFactory,annotationStorage:O.annotationStorage||new l.AnnotationStorage,enableScripting:O.enableScripting,hasJSActions:O.hasJSActions,fieldObjects:O.fieldObjects,mouseState:O.mouseState||{isDown:!1}});if(be.isRenderable){const ge=be.render();if(Q.hidden&&(ge.style.visibility="hidden"),Array.isArray(ge))for(const ye of ge)ye.style.zIndex=oe++,je(re=Z,M,Zl).call(re,ye,Q.id,G,K);else ge.style.zIndex=oe++,be instanceof w?G.prepend(ge):je(H=Z,M,Zl).call(H,ge,Q.id,G,K)}}je(this,M,tc).call(this,G,O.annotationCanvasMap)}static update(O){const{annotationCanvasMap:B,div:G,viewport:P}=O;je(this,M,ec).call(this,G,P),je(this,M,tc).call(this,G,B),G.hidden=!1}};M=new WeakSet,Zl=function(O,B,G,P){const K=O.firstChild||O;K.id=`${i.AnnotationPrefix}${B}`,G.append(O),P==null||P.moveElementInDOM(G,O,K,!1)},ec=function(O,{width:B,height:G,rotation:P}){const{style:K}=O,oe=P%180!==0,re=Math.floor(B)+"px",H=Math.floor(G)+"px";K.width=oe?H:re,K.height=oe?re:H,O.setAttribute("data-main-rotation",P)},tc=function(O,B){if(B){for(const[G,P]of B){const K=O.querySelector(`[data-annotation-id="${G}"]`);if(!K)continue;const{firstChild:oe}=K;oe?oe.nodeName==="CANVAS"?oe.replaceWith(P):oe.before(P):K.append(P)}B.clear()}},qe(Z,M);let I=Z;r.AnnotationLayer=I},(e,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ColorConverters=void 0;function t(i){return Math.floor(Math.max(0,Math.min(1,i))*255).toString(16).padStart(2,"0")}class n{static CMYK_G([l,c,f,d]){return["G",1-Math.min(1,.3*l+.59*f+.11*c+d)]}static G_CMYK([l]){return["CMYK",0,0,0,1-l]}static G_RGB([l]){return["RGB",l,l,l]}static G_HTML([l]){const c=t(l);return`#${c}${c}${c}`}static RGB_G([l,c,f]){return["G",.3*l+.59*c+.11*f]}static RGB_HTML([l,c,f]){const d=t(l),h=t(c),p=t(f);return`#${d}${h}${p}`}static T_HTML(){return"#00000000"}static CMYK_RGB([l,c,f,d]){return["RGB",1-Math.min(1,l+d),1-Math.min(1,f+d),1-Math.min(1,c+d)]}static CMYK_HTML(l){const c=this.CMYK_RGB(l).slice(1);return this.RGB_HTML(c)}static RGB_CMYK([l,c,f]){const d=1-l,h=1-c,p=1-f,E=Math.min(d,h,p);return["CMYK",d,h,p,E]}}r.ColorConverters=n},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.XfaLayer=void 0;var n=t(20);class i{static setupStorage(c,f,d,h,p){const E=h.getValue(f,{value:null});switch(d.name){case"textarea":if(E.value!==null&&(c.textContent=E.value),p==="print")break;c.addEventListener("input",v=>{h.setValue(f,{value:v.target.value})});break;case"input":if(d.attributes.type==="radio"||d.attributes.type==="checkbox"){if(E.value===d.attributes.xfaOn?c.setAttribute("checked",!0):E.value===d.attributes.xfaOff&&c.removeAttribute("checked"),p==="print")break;c.addEventListener("change",v=>{h.setValue(f,{value:v.target.checked?v.target.getAttribute("xfaOn"):v.target.getAttribute("xfaOff")})})}else{if(E.value!==null&&c.setAttribute("value",E.value),p==="print")break;c.addEventListener("input",v=>{h.setValue(f,{value:v.target.value})})}break;case"select":if(E.value!==null)for(const v of d.children)v.attributes.value===E.value&&(v.attributes.selected=!0);c.addEventListener("input",v=>{const S=v.target.options,x=S.selectedIndex===-1?"":S[S.selectedIndex].value;h.setValue(f,{value:x})});break}}static setAttributes({html:c,element:f,storage:d=null,intent:h,linkService:p}){const{attributes:E}=f,v=c instanceof HTMLAnchorElement;E.type==="radio"&&(E.name=`${E.name}-${h}`);for(const[S,x]of Object.entries(E))if(x!=null)switch(S){case"class":x.length&&c.setAttribute(S,x.join(" "));break;case"dataId":break;case"id":c.setAttribute("data-element-id",x);break;case"style":Object.assign(c.style,x);break;case"textContent":c.textContent=x;break;default:(!v||S!=="href"&&S!=="newWindow")&&c.setAttribute(S,x)}v&&p.addLinkAttributes(c,E.href,E.newWindow),d&&E.dataId&&this.setupStorage(c,E.dataId,f,d)}static render(c){var g;const f=c.annotationStorage,d=c.linkService,h=c.xfaHtml,p=c.intent||"display",E=document.createElement(h.name);h.attributes&&this.setAttributes({html:E,element:h,intent:p,linkService:d});const v=[[h,-1,E]],S=c.div;if(S.append(E),c.viewport){const m=`matrix(${c.viewport.transform.join(",")})`;S.style.transform=m}p!=="richText"&&S.setAttribute("class","xfaLayer xfaFont");const x=[];for(;v.length>0;){const[m,b,D]=v.at(-1);if(b+1===m.children.length){v.pop();continue}const C=m.children[++v.at(-1)[1]];if(C===null)continue;const{name:F}=C;if(F==="#text"){const w=document.createTextNode(C.value);x.push(w),D.append(w);continue}let T;if((g=C==null?void 0:C.attributes)!=null&&g.xmlns?T=document.createElementNS(C.attributes.xmlns,F):T=document.createElement(F),D.append(T),C.attributes&&this.setAttributes({html:T,element:C,storage:f,intent:p,linkService:d}),C.children&&C.children.length>0)v.push([C,-1,T]);else if(C.value){const w=document.createTextNode(C.value);n.XfaText.shouldBuildText(F)&&x.push(w),T.append(w)}}for(const m of S.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:x}}static update(c){const f=`matrix(${c.viewport.transform.join(",")})`;c.div.style.transform=f,c.div.hidden=!1}}r.XfaLayer=i},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.TextLayerRenderTask=void 0,r.renderTextLayer=D;var n=t(1),i=t(8);const l=1e5,c=30,f=.8,d=new Map,h=/^\s+$/g;function p(C,F){const T=d.get(C);if(T)return T;F.save(),F.font=`${c}px ${C}`;const w=F.measureText("");let y=w.fontBoundingBoxAscent,N=Math.abs(w.fontBoundingBoxDescent);if(y){F.restore();const X=y/(y+N);return d.set(C,X),X}F.strokeStyle="red",F.clearRect(0,0,c,c),F.strokeText("g",0,0);let L=F.getImageData(0,0,c,c).data;N=0;for(let X=L.length-1-3;X>=0;X-=4)if(L[X]>0){N=Math.ceil(X/4/c);break}F.clearRect(0,0,c,c),F.strokeText("A",0,c),L=F.getImageData(0,0,c,c).data,y=0;for(let X=0,z=L.length;X<z;X+=4)if(L[X]>0){y=c-Math.floor(X/4/c);break}if(F.restore(),y){const X=y/(y+N);return d.set(C,X),X}return d.set(C,f),f}function E(C,F,T,w){const y=document.createElement("span"),N=C._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:F.str!=="",hasEOL:F.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:F.str!=="",hasEOL:F.hasEOL,fontSize:0};C._textDivs.push(y);const L=n.Util.transform(C._viewport.transform,F.transform);let X=Math.atan2(L[1],L[0]);const z=T[F.fontName];z.vertical&&(X+=Math.PI/2);const se=Math.hypot(L[2],L[3]),me=se*p(z.fontFamily,w);let _e,de;X===0?(_e=L[4],de=L[5]-me):(_e=L[4]+me*Math.sin(X),de=L[5]-me*Math.cos(X)),y.style.left=`${_e}px`,y.style.top=`${de}px`,y.style.fontSize=`${se}px`,y.style.fontFamily=z.fontFamily,N.fontSize=se,y.setAttribute("role","presentation"),y.textContent=F.str,y.dir=F.dir,C._fontInspectorEnabled&&(y.dataset.fontName=F.fontName),X!==0&&(N.angle=X*(180/Math.PI));let Y=!1;if(F.str.length>1||C._enhanceTextSelection&&h.test(F.str))Y=!0;else if(F.str!==" "&&F.transform[0]!==F.transform[3]){const ie=Math.abs(F.transform[0]),fe=Math.abs(F.transform[3]);ie!==fe&&Math.max(ie,fe)/Math.min(ie,fe)>1.5&&(Y=!0)}if(Y&&(z.vertical?N.canvasWidth=F.height*C._viewport.scale:N.canvasWidth=F.width*C._viewport.scale),C._textDivProperties.set(y,N),C._textContentStream&&C._layoutText(y),C._enhanceTextSelection&&N.hasText){let ie=1,fe=0;X!==0&&(ie=Math.cos(X),fe=Math.sin(X));const ae=(z.vertical?F.height:F.width)*C._viewport.scale,W=se;let xe,I;X!==0?(xe=[ie,fe,-fe,ie,_e,de],I=n.Util.getAxialAlignedBoundingBox([0,0,ae,W],xe)):I=[_e,de,_e+ae,de+W],C._bounds.push({left:I[0],top:I[1],right:I[2],bottom:I[3],div:y,size:[ae,W],m:xe})}}function v(C){if(C._canceled)return;const F=C._textDivs,T=C._capability,w=F.length;if(w>l){C._renderingDone=!0,T.resolve();return}if(!C._textContentStream)for(let y=0;y<w;y++)C._layoutText(F[y]);C._renderingDone=!0,T.resolve()}function S(C,F,T){let w=0;for(let y=0;y<T;y++){const N=C[F++];N>0&&(w=w?Math.min(N,w):N)}return w}function x(C){const F=C._bounds,T=C._viewport,w=g(T.width,T.height,F);for(let y=0;y<w.length;y++){const N=F[y].div,L=C._textDivProperties.get(N);if(L.angle===0){L.paddingLeft=F[y].left-w[y].left,L.paddingTop=F[y].top-w[y].top,L.paddingRight=w[y].right-F[y].right,L.paddingBottom=w[y].bottom-F[y].bottom,C._textDivProperties.set(N,L);continue}const X=w[y],z=F[y],se=z.m,me=se[0],_e=se[1],de=[[0,0],[0,z.size[1]],[z.size[0],0],z.size],Y=new Float64Array(64);for(let fe=0,ae=de.length;fe<ae;fe++){const W=n.Util.applyTransform(de[fe],se);Y[fe+0]=me&&(X.left-W[0])/me,Y[fe+4]=_e&&(X.top-W[1])/_e,Y[fe+8]=me&&(X.right-W[0])/me,Y[fe+12]=_e&&(X.bottom-W[1])/_e,Y[fe+16]=_e&&(X.left-W[0])/-_e,Y[fe+20]=me&&(X.top-W[1])/me,Y[fe+24]=_e&&(X.right-W[0])/-_e,Y[fe+28]=me&&(X.bottom-W[1])/me,Y[fe+32]=me&&(X.left-W[0])/-me,Y[fe+36]=_e&&(X.top-W[1])/-_e,Y[fe+40]=me&&(X.right-W[0])/-me,Y[fe+44]=_e&&(X.bottom-W[1])/-_e,Y[fe+48]=_e&&(X.left-W[0])/_e,Y[fe+52]=me&&(X.top-W[1])/-me,Y[fe+56]=_e&&(X.right-W[0])/_e,Y[fe+60]=me&&(X.bottom-W[1])/-me}const ie=1+Math.min(Math.abs(me),Math.abs(_e));L.paddingLeft=S(Y,32,16)/ie,L.paddingTop=S(Y,48,16)/ie,L.paddingRight=S(Y,0,16)/ie,L.paddingBottom=S(Y,16,16)/ie,C._textDivProperties.set(N,L)}}function g(C,F,T){const w=T.map(function(N,L){return{x1:N.left,y1:N.top,x2:N.right,y2:N.bottom,index:L,x1New:void 0,x2New:void 0}});m(C,w);const y=new Array(T.length);for(const N of w){const L=N.index;y[L]={left:N.x1New,top:0,right:N.x2New,bottom:0}}T.map(function(N,L){const X=y[L],z=w[L];z.x1=N.top,z.y1=C-X.right,z.x2=N.bottom,z.y2=C-X.left,z.index=L,z.x1New=void 0,z.x2New=void 0}),m(F,w);for(const N of w){const L=N.index;y[L].top=N.x1New,y[L].bottom=N.x2New}return y}function m(C,F){F.sort(function(y,N){return y.x1-N.x1||y.index-N.index});const w=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const y of F){let N=0;for(;N<w.length&&w[N].end<=y.y1;)N++;let L=w.length-1;for(;L>=0&&w[L].start>=y.y2;)L--;let X,z,se,me,_e=-1/0;for(se=N;se<=L;se++){X=w[se],z=X.boundary;let ie;z.x2>y.x1?ie=z.index>y.index?z.x1New:y.x1:z.x2New===void 0?ie=(z.x2+y.x1)/2:ie=z.x2New,ie>_e&&(_e=ie)}for(y.x1New=_e,se=N;se<=L;se++)X=w[se],z=X.boundary,z.x2New===void 0?z.x2>y.x1?z.index>y.index&&(z.x2New=z.x2):z.x2New=_e:z.x2New>_e&&(z.x2New=Math.max(_e,z.x2));const de=[];let Y=null;for(se=N;se<=L;se++){X=w[se],z=X.boundary;const ie=z.x2>y.x2?z:y;Y===ie?de.at(-1).end=X.end:(de.push({start:X.start,end:X.end,boundary:ie}),Y=ie)}for(w[N].start<y.y1&&(de[0].start=y.y1,de.unshift({start:w[N].start,end:y.y1,boundary:w[N].boundary})),y.y2<w[L].end&&(de.at(-1).end=y.y2,de.push({start:y.y2,end:w[L].end,boundary:w[L].boundary})),se=N;se<=L;se++){if(X=w[se],z=X.boundary,z.x2New!==void 0)continue;let ie=!1;for(me=N-1;!ie&&me>=0&&w[me].start>=z.y1;me--)ie=w[me].boundary===z;for(me=L+1;!ie&&me<w.length&&w[me].end<=z.y2;me++)ie=w[me].boundary===z;for(me=0;!ie&&me<de.length;me++)ie=de[me].boundary===z;ie||(z.x2New=_e)}Array.prototype.splice.apply(w,[N,L-N+1,...de])}for(const y of w){const N=y.boundary;N.x2New===void 0&&(N.x2New=Math.max(C,N.x2))}}class b{constructor({textContent:F,textContentStream:T,container:w,viewport:y,textDivs:N,textContentItemsStr:L,enhanceTextSelection:X}){var z;X&&(0,i.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=F,this._textContentStream=T,this._container=w,this._document=w.ownerDocument,this._viewport=y,this._textDivs=N||[],this._textContentItemsStr=L||[],this._enhanceTextSelection=!!X,this._fontInspectorEnabled=!!((z=globalThis.FontInspector)!=null&&z.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,n.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(F,T){for(let w=0,y=F.length;w<y;w++){if(F[w].str===void 0){if(F[w].type==="beginMarkedContentProps"||F[w].type==="beginMarkedContent"){const N=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),F[w].id!==null&&this._container.setAttribute("id",`${F[w].id}`),N.append(this._container)}else F[w].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(F[w].str),E(this,F[w],T,this._layoutTextCtx)}}_layoutText(F){const T=this._textDivProperties.get(F);let w="";if(T.canvasWidth!==0&&T.hasText){const{fontFamily:y}=F.style,{fontSize:N}=T;(N!==this._layoutTextLastFontSize||y!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${N*this._devicePixelRatio}px ${y}`,this._layoutTextLastFontSize=N,this._layoutTextLastFontFamily=y);const{width:L}=this._layoutTextCtx.measureText(F.textContent);if(L>0){const X=this._devicePixelRatio*T.canvasWidth/L;this._enhanceTextSelection&&(T.scale=X),w=`scaleX(${X})`}}if(T.angle!==0&&(w=`rotate(${T.angle}deg) ${w}`),w.length>0&&(this._enhanceTextSelection&&(T.originalTransform=w),F.style.transform=w),T.hasText&&this._container.append(F),T.hasEOL){const y=document.createElement("br");y.setAttribute("role","presentation"),this._container.append(y)}}_render(F=0){const T=(0,n.createPromiseCapability)();let w=Object.create(null);const y=this._document.createElement("canvas");if(y.height=y.width=c,this._layoutTextCtx=y.getContext("2d",{alpha:!1}),this._textContent){const N=this._textContent.items,L=this._textContent.styles;this._processItems(N,L),T.resolve()}else if(this._textContentStream){const N=()=>{this._reader.read().then(({value:L,done:X})=>{if(X){T.resolve();return}Object.assign(w,L.styles),this._processItems(L.items,w),N()},T.reject)};this._reader=this._textContentStream.getReader(),N()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');T.promise.then(()=>{w=null,F?this._renderTimer=setTimeout(()=>{v(this),this._renderTimer=null},F):v(this)},this._capability.reject)}expandTextDivs(F=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(x(this),this._bounds=null);const T=[],w=[];for(let y=0,N=this._textDivs.length;y<N;y++){const L=this._textDivs[y],X=this._textDivProperties.get(L);X.hasText&&(F?(T.length=0,w.length=0,X.originalTransform&&T.push(X.originalTransform),X.paddingTop>0?(w.push(`${X.paddingTop}px`),T.push(`translateY(${-X.paddingTop}px)`)):w.push(0),X.paddingRight>0?w.push(`${X.paddingRight/X.scale}px`):w.push(0),X.paddingBottom>0?w.push(`${X.paddingBottom}px`):w.push(0),X.paddingLeft>0?(w.push(`${X.paddingLeft/X.scale}px`),T.push(`translateX(${-X.paddingLeft/X.scale}px)`)):w.push(0),L.style.padding=w.join(" "),T.length&&(L.style.transform=T.join(" "))):(L.style.padding=null,L.style.transform=X.originalTransform))}}}r.TextLayerRenderTask=b;function D(C){const F=new b({textContent:C.textContent,textContentStream:C.textContentStream,container:C.container,viewport:C.viewport,textDivs:C.textDivs,textContentItemsStr:C.textContentItemsStr,enhanceTextSelection:C.enhanceTextSelection});return F._render(C.timeout),F}},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.SVGGraphics=void 0;var n=t(8),i=t(1),l=t(3);let c=class{constructor(){(0,i.unreachable)("Not implemented: SVGGraphics")}};r.SVGGraphics=c;{let g=function(T){let w=[];const y=[];for(const N of T){if(N.fn==="save"){w.push({fnId:92,fn:"group",items:[]}),y.push(w),w=w.at(-1).items;continue}N.fn==="restore"?w=y.pop():w.push(N)}return w},m=function(T){if(Number.isInteger(T))return T.toString();const w=T.toFixed(10);let y=w.length-1;if(w[y]!=="0")return w;do y--;while(w[y]==="0");return w.substring(0,w[y]==="."?y:y+1)},b=function(T){if(T[4]===0&&T[5]===0){if(T[1]===0&&T[2]===0)return T[0]===1&&T[3]===1?"":`scale(${m(T[0])} ${m(T[3])})`;if(T[0]===T[3]&&T[1]===-T[2]){const w=Math.acos(T[0])*180/Math.PI;return`rotate(${m(w)})`}}else if(T[0]===1&&T[1]===0&&T[2]===0&&T[3]===1)return`translate(${m(T[4])} ${m(T[5])})`;return`matrix(${m(T[0])} ${m(T[1])} ${m(T[2])} ${m(T[3])} ${m(T[4])} ${m(T[5])})`};const f={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},d="http://www.w3.org/XML/1998/namespace",h="http://www.w3.org/1999/xlink",p=["butt","round","square"],E=["miter","round","bevel"],v=function(T,w="",y=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!y)return URL.createObjectURL(new Blob([T],{type:w}));const N="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let L=`data:${w};base64,`;for(let X=0,z=T.length;X<z;X+=3){const se=T[X]&255,me=T[X+1]&255,_e=T[X+2]&255,de=se>>2,Y=(se&3)<<4|me>>4,ie=X+1<z?(me&15)<<2|_e>>6:64,fe=X+2<z?_e&63:64;L+=N[de]+N[Y]+N[ie]+N[fe]}return L},S=function(){const T=new Uint8Array([137,80,78,71,13,10,26,10]),w=12,y=new Int32Array(256);for(let _e=0;_e<256;_e++){let de=_e;for(let Y=0;Y<8;Y++)de&1?de=3988292384^de>>1&2147483647:de=de>>1&2147483647;y[_e]=de}function N(_e,de,Y){let ie=-1;for(let fe=de;fe<Y;fe++){const ae=(ie^_e[fe])&255,W=y[ae];ie=ie>>>8^W}return ie^-1}function L(_e,de,Y,ie){let fe=ie;const ae=de.length;Y[fe]=ae>>24&255,Y[fe+1]=ae>>16&255,Y[fe+2]=ae>>8&255,Y[fe+3]=ae&255,fe+=4,Y[fe]=_e.charCodeAt(0)&255,Y[fe+1]=_e.charCodeAt(1)&255,Y[fe+2]=_e.charCodeAt(2)&255,Y[fe+3]=_e.charCodeAt(3)&255,fe+=4,Y.set(de,fe),fe+=de.length;const W=N(Y,ie+4,fe);Y[fe]=W>>24&255,Y[fe+1]=W>>16&255,Y[fe+2]=W>>8&255,Y[fe+3]=W&255}function X(_e,de,Y){let ie=1,fe=0;for(let ae=de;ae<Y;++ae)ie=(ie+(_e[ae]&255))%65521,fe=(fe+ie)%65521;return fe<<16|ie}function z(_e){if(!l.isNodeJS)return se(_e);try{let de;parseInt(process.versions.node)>=8?de=_e:de=Buffer.from(_e);const Y=require$$5.deflateSync(de,{level:9});return Y instanceof Uint8Array?Y:new Uint8Array(Y)}catch(de){(0,i.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+de)}return se(_e)}function se(_e){let de=_e.length;const Y=65535,ie=Math.ceil(de/Y),fe=new Uint8Array(2+de+ie*5+4);let ae=0;fe[ae++]=120,fe[ae++]=156;let W=0;for(;de>Y;)fe[ae++]=0,fe[ae++]=255,fe[ae++]=255,fe[ae++]=0,fe[ae++]=0,fe.set(_e.subarray(W,W+Y),ae),ae+=Y,W+=Y,de-=Y;fe[ae++]=1,fe[ae++]=de&255,fe[ae++]=de>>8&255,fe[ae++]=~de&65535&255,fe[ae++]=(~de&65535)>>8&255,fe.set(_e.subarray(W),ae),ae+=_e.length-W;const xe=X(_e,0,_e.length);return fe[ae++]=xe>>24&255,fe[ae++]=xe>>16&255,fe[ae++]=xe>>8&255,fe[ae++]=xe&255,fe}function me(_e,de,Y,ie){const fe=_e.width,ae=_e.height;let W,xe,I;const M=_e.data;switch(de){case i.ImageKind.GRAYSCALE_1BPP:xe=0,W=1,I=fe+7>>3;break;case i.ImageKind.RGB_24BPP:xe=2,W=8,I=fe*3;break;case i.ImageKind.RGBA_32BPP:xe=6,W=8,I=fe*4;break;default:throw new Error("invalid format")}const R=new Uint8Array((1+I)*ae);let U=0,V=0;for(let P=0;P<ae;++P)R[U++]=0,R.set(M.subarray(V,V+I),U),V+=I,U+=I;if(de===i.ImageKind.GRAYSCALE_1BPP&&ie){U=0;for(let P=0;P<ae;P++){U++;for(let K=0;K<I;K++)R[U++]^=255}}const Z=new Uint8Array([fe>>24&255,fe>>16&255,fe>>8&255,fe&255,ae>>24&255,ae>>16&255,ae>>8&255,ae&255,W,xe,0,0,0]),J=z(R),O=T.length+w*3+Z.length+J.length,B=new Uint8Array(O);let G=0;return B.set(T,G),G+=T.length,L("IHDR",Z,B,G),G+=w+Z.length,L("IDATA",J,B,G),G+=w+J.length,L("IEND",new Uint8Array(0),B,G),v(B,"image/png",Y)}return function(de,Y,ie){const fe=de.kind===void 0?i.ImageKind.GRAYSCALE_1BPP:de.kind;return me(de,fe,Y,ie)}}();class x{constructor(){this.fontSizeScale=1,this.fontWeight=f.fontWeight,this.fontSize=0,this.textMatrix=i.IDENTITY_MATRIX,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=i.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=f.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(w,y){this.x=w,this.y=y}}let D=0,C=0,F=0;r.SVGGraphics=c=class{constructor(T,w,y=!1){(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new n.DOMSVGFactory,this.current=new x,this.transformMatrix=i.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=T,this.objs=w,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!y,this._operatorIdMapping=[];for(const N in i.OPS)this._operatorIdMapping[i.OPS[N]]=N}save(){this.transformStack.push(this.transformMatrix);const T=this.current;this.extraStack.push(T),this.current=T.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(T){this.save(),this.executeOpTree(T),this.restore()}loadDependencies(T){const w=T.fnArray,y=T.argsArray;for(let N=0,L=w.length;N<L;N++)if(w[N]===i.OPS.dependency)for(const X of y[N]){const z=X.startsWith("g_")?this.commonObjs:this.objs,se=new Promise(me=>{z.get(X,me)});this.current.dependencies.push(se)}return Promise.all(this.current.dependencies)}transform(T,w,y,N,L,X){const z=[T,w,y,N,L,X];this.transformMatrix=i.Util.transform(this.transformMatrix,z),this.tgrp=null}getSVG(T,w){this.viewport=w;const y=this._initialize(w);return this.loadDependencies(T).then(()=>(this.transformMatrix=i.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(T)),y))}convertOpList(T){const w=this._operatorIdMapping,y=T.argsArray,N=T.fnArray,L=[];for(let X=0,z=N.length;X<z;X++){const se=N[X];L.push({fnId:se,fn:w[se],args:y[X]})}return g(L)}executeOpTree(T){for(const w of T){const y=w.fn,N=w.fnId,L=w.args;switch(N|0){case i.OPS.beginText:this.beginText();break;case i.OPS.dependency:break;case i.OPS.setLeading:this.setLeading(L);break;case i.OPS.setLeadingMoveText:this.setLeadingMoveText(L[0],L[1]);break;case i.OPS.setFont:this.setFont(L);break;case i.OPS.showText:this.showText(L[0]);break;case i.OPS.showSpacedText:this.showText(L[0]);break;case i.OPS.endText:this.endText();break;case i.OPS.moveText:this.moveText(L[0],L[1]);break;case i.OPS.setCharSpacing:this.setCharSpacing(L[0]);break;case i.OPS.setWordSpacing:this.setWordSpacing(L[0]);break;case i.OPS.setHScale:this.setHScale(L[0]);break;case i.OPS.setTextMatrix:this.setTextMatrix(L[0],L[1],L[2],L[3],L[4],L[5]);break;case i.OPS.setTextRise:this.setTextRise(L[0]);break;case i.OPS.setTextRenderingMode:this.setTextRenderingMode(L[0]);break;case i.OPS.setLineWidth:this.setLineWidth(L[0]);break;case i.OPS.setLineJoin:this.setLineJoin(L[0]);break;case i.OPS.setLineCap:this.setLineCap(L[0]);break;case i.OPS.setMiterLimit:this.setMiterLimit(L[0]);break;case i.OPS.setFillRGBColor:this.setFillRGBColor(L[0],L[1],L[2]);break;case i.OPS.setStrokeRGBColor:this.setStrokeRGBColor(L[0],L[1],L[2]);break;case i.OPS.setStrokeColorN:this.setStrokeColorN(L);break;case i.OPS.setFillColorN:this.setFillColorN(L);break;case i.OPS.shadingFill:this.shadingFill(L[0]);break;case i.OPS.setDash:this.setDash(L[0],L[1]);break;case i.OPS.setRenderingIntent:this.setRenderingIntent(L[0]);break;case i.OPS.setFlatness:this.setFlatness(L[0]);break;case i.OPS.setGState:this.setGState(L[0]);break;case i.OPS.fill:this.fill();break;case i.OPS.eoFill:this.eoFill();break;case i.OPS.stroke:this.stroke();break;case i.OPS.fillStroke:this.fillStroke();break;case i.OPS.eoFillStroke:this.eoFillStroke();break;case i.OPS.clip:this.clip("nonzero");break;case i.OPS.eoClip:this.clip("evenodd");break;case i.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case i.OPS.paintImageXObject:this.paintImageXObject(L[0]);break;case i.OPS.paintInlineImageXObject:this.paintInlineImageXObject(L[0]);break;case i.OPS.paintImageMaskXObject:this.paintImageMaskXObject(L[0]);break;case i.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(L[0],L[1]);break;case i.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case i.OPS.closePath:this.closePath();break;case i.OPS.closeStroke:this.closeStroke();break;case i.OPS.closeFillStroke:this.closeFillStroke();break;case i.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case i.OPS.nextLine:this.nextLine();break;case i.OPS.transform:this.transform(L[0],L[1],L[2],L[3],L[4],L[5]);break;case i.OPS.constructPath:this.constructPath(L[0],L[1]);break;case i.OPS.endPath:this.endPath();break;case 92:this.group(w.items);break;default:(0,i.warn)(`Unimplemented operator ${y}`);break}}}setWordSpacing(T){this.current.wordSpacing=T}setCharSpacing(T){this.current.charSpacing=T}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(T,w,y,N,L,X){const z=this.current;z.textMatrix=z.lineMatrix=[T,w,y,N,L,X],z.textMatrixScale=Math.hypot(T,w),z.x=z.lineX=0,z.y=z.lineY=0,z.xcoords=[],z.ycoords=[],z.tspan=this.svgFactory.createElement("svg:tspan"),z.tspan.setAttributeNS(null,"font-family",z.fontFamily),z.tspan.setAttributeNS(null,"font-size",`${m(z.fontSize)}px`),z.tspan.setAttributeNS(null,"y",m(-z.y)),z.txtElement=this.svgFactory.createElement("svg:text"),z.txtElement.append(z.tspan)}beginText(){const T=this.current;T.x=T.lineX=0,T.y=T.lineY=0,T.textMatrix=i.IDENTITY_MATRIX,T.lineMatrix=i.IDENTITY_MATRIX,T.textMatrixScale=1,T.tspan=this.svgFactory.createElement("svg:tspan"),T.txtElement=this.svgFactory.createElement("svg:text"),T.txtgrp=this.svgFactory.createElement("svg:g"),T.xcoords=[],T.ycoords=[]}moveText(T,w){const y=this.current;y.x=y.lineX+=T,y.y=y.lineY+=w,y.xcoords=[],y.ycoords=[],y.tspan=this.svgFactory.createElement("svg:tspan"),y.tspan.setAttributeNS(null,"font-family",y.fontFamily),y.tspan.setAttributeNS(null,"font-size",`${m(y.fontSize)}px`),y.tspan.setAttributeNS(null,"y",m(-y.y))}showText(T){const w=this.current,y=w.font,N=w.fontSize;if(N===0)return;const L=w.fontSizeScale,X=w.charSpacing,z=w.wordSpacing,se=w.fontDirection,me=w.textHScale*se,_e=y.vertical,de=_e?1:-1,Y=y.defaultVMetrics,ie=N*w.fontMatrix[0];let fe=0;for(const xe of T){if(xe===null){fe+=se*z;continue}else if(typeof xe=="number"){fe+=de*xe*N/1e3;continue}const I=(xe.isSpace?z:0)+X,M=xe.fontChar;let R,U,V=xe.width;if(_e){let J;const O=xe.vmetric||Y;J=xe.vmetric?O[1]:V*.5,J=-J*ie;const B=O[2]*ie;V=O?-O[0]:V,R=J/L,U=(fe+B)/L}else R=fe/L,U=0;(xe.isInFont||y.missingFile)&&(w.xcoords.push(w.x+R),_e&&w.ycoords.push(-w.y+U),w.tspan.textContent+=M);let Z;_e?Z=V*ie-I*se:Z=V*ie+I*se,fe+=Z}w.tspan.setAttributeNS(null,"x",w.xcoords.map(m).join(" ")),_e?w.tspan.setAttributeNS(null,"y",w.ycoords.map(m).join(" ")):w.tspan.setAttributeNS(null,"y",m(-w.y)),_e?w.y-=fe:w.x+=fe*me,w.tspan.setAttributeNS(null,"font-family",w.fontFamily),w.tspan.setAttributeNS(null,"font-size",`${m(w.fontSize)}px`),w.fontStyle!==f.fontStyle&&w.tspan.setAttributeNS(null,"font-style",w.fontStyle),w.fontWeight!==f.fontWeight&&w.tspan.setAttributeNS(null,"font-weight",w.fontWeight);const ae=w.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;if(ae===i.TextRenderingMode.FILL||ae===i.TextRenderingMode.FILL_STROKE?(w.fillColor!==f.fillColor&&w.tspan.setAttributeNS(null,"fill",w.fillColor),w.fillAlpha<1&&w.tspan.setAttributeNS(null,"fill-opacity",w.fillAlpha)):w.textRenderingMode===i.TextRenderingMode.ADD_TO_PATH?w.tspan.setAttributeNS(null,"fill","transparent"):w.tspan.setAttributeNS(null,"fill","none"),ae===i.TextRenderingMode.STROKE||ae===i.TextRenderingMode.FILL_STROKE){const xe=1/(w.textMatrixScale||1);this._setStrokeAttributes(w.tspan,xe)}let W=w.textMatrix;w.textRise!==0&&(W=W.slice(),W[5]+=w.textRise),w.txtElement.setAttributeNS(null,"transform",`${b(W)} scale(${m(me)}, -1)`),w.txtElement.setAttributeNS(d,"xml:space","preserve"),w.txtElement.append(w.tspan),w.txtgrp.append(w.txtElement),this._ensureTransformGroup().append(w.txtElement)}setLeadingMoveText(T,w){this.setLeading(-w),this.moveText(T,w)}addFontStyle(T){if(!T.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const w=v(T.data,T.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${T.loadedName}"; src: url(${w}); }
`}setFont(T){const w=this.current,y=this.commonObjs.get(T[0]);let N=T[1];w.font=y,this.embedFonts&&!y.missingFile&&!this.embeddedFonts[y.loadedName]&&(this.addFontStyle(y),this.embeddedFonts[y.loadedName]=y),w.fontMatrix=y.fontMatrix||i.FONT_IDENTITY_MATRIX;let L="normal";y.black?L="900":y.bold&&(L="bold");const X=y.italic?"italic":"normal";N<0?(N=-N,w.fontDirection=-1):w.fontDirection=1,w.fontSize=N,w.fontFamily=y.loadedName,w.fontWeight=L,w.fontStyle=X,w.tspan=this.svgFactory.createElement("svg:tspan"),w.tspan.setAttributeNS(null,"y",m(-w.y)),w.xcoords=[],w.ycoords=[]}endText(){var w;const T=this.current;T.textRenderingMode&i.TextRenderingMode.ADD_TO_PATH_FLAG&&((w=T.txtElement)!=null&&w.hasChildNodes())&&(T.element=T.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(T){T>0&&(this.current.lineWidth=T)}setLineCap(T){this.current.lineCap=p[T]}setLineJoin(T){this.current.lineJoin=E[T]}setMiterLimit(T){this.current.miterLimit=T}setStrokeAlpha(T){this.current.strokeAlpha=T}setStrokeRGBColor(T,w,y){this.current.strokeColor=i.Util.makeHexColor(T,w,y)}setFillAlpha(T){this.current.fillAlpha=T}setFillRGBColor(T,w,y){this.current.fillColor=i.Util.makeHexColor(T,w,y),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(T){this.current.strokeColor=this._makeColorN_Pattern(T)}setFillColorN(T){this.current.fillColor=this._makeColorN_Pattern(T)}shadingFill(T){const w=this.viewport.width,y=this.viewport.height,N=i.Util.inverseTransform(this.transformMatrix),L=i.Util.applyTransform([0,0],N),X=i.Util.applyTransform([0,y],N),z=i.Util.applyTransform([w,0],N),se=i.Util.applyTransform([w,y],N),me=Math.min(L[0],X[0],z[0],se[0]),_e=Math.min(L[1],X[1],z[1],se[1]),de=Math.max(L[0],X[0],z[0],se[0]),Y=Math.max(L[1],X[1],z[1],se[1]),ie=this.svgFactory.createElement("svg:rect");ie.setAttributeNS(null,"x",me),ie.setAttributeNS(null,"y",_e),ie.setAttributeNS(null,"width",de-me),ie.setAttributeNS(null,"height",Y-_e),ie.setAttributeNS(null,"fill",this._makeShadingPattern(T)),this.current.fillAlpha<1&&ie.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(ie)}_makeColorN_Pattern(T){return T[0]==="TilingPattern"?this._makeTilingPattern(T):this._makeShadingPattern(T)}_makeTilingPattern(T){const w=T[1],y=T[2],N=T[3]||i.IDENTITY_MATRIX,[L,X,z,se]=T[4],me=T[5],_e=T[6],de=T[7],Y=`shading${F++}`,[ie,fe,ae,W]=i.Util.normalizeRect([...i.Util.applyTransform([L,X],N),...i.Util.applyTransform([z,se],N)]),[xe,I]=i.Util.singularValueDecompose2dScale(N),M=me*xe,R=_e*I,U=this.svgFactory.createElement("svg:pattern");U.setAttributeNS(null,"id",Y),U.setAttributeNS(null,"patternUnits","userSpaceOnUse"),U.setAttributeNS(null,"width",M),U.setAttributeNS(null,"height",R),U.setAttributeNS(null,"x",`${ie}`),U.setAttributeNS(null,"y",`${fe}`);const V=this.svg,Z=this.transformMatrix,J=this.current.fillColor,O=this.current.strokeColor,B=this.svgFactory.create(ae-ie,W-fe);if(this.svg=B,this.transformMatrix=N,de===2){const G=i.Util.makeHexColor(...w);this.current.fillColor=G,this.current.strokeColor=G}return this.executeOpTree(this.convertOpList(y)),this.svg=V,this.transformMatrix=Z,this.current.fillColor=J,this.current.strokeColor=O,U.append(B.childNodes[0]),this.defs.append(U),`url(#${Y})`}_makeShadingPattern(T){switch(typeof T=="string"&&(T=this.objs.get(T)),T[0]){case"RadialAxial":const w=`shading${F++}`,y=T[3];let N;switch(T[1]){case"axial":const L=T[4],X=T[5];N=this.svgFactory.createElement("svg:linearGradient"),N.setAttributeNS(null,"id",w),N.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),N.setAttributeNS(null,"x1",L[0]),N.setAttributeNS(null,"y1",L[1]),N.setAttributeNS(null,"x2",X[0]),N.setAttributeNS(null,"y2",X[1]);break;case"radial":const z=T[4],se=T[5],me=T[6],_e=T[7];N=this.svgFactory.createElement("svg:radialGradient"),N.setAttributeNS(null,"id",w),N.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),N.setAttributeNS(null,"cx",se[0]),N.setAttributeNS(null,"cy",se[1]),N.setAttributeNS(null,"r",_e),N.setAttributeNS(null,"fx",z[0]),N.setAttributeNS(null,"fy",z[1]),N.setAttributeNS(null,"fr",me);break;default:throw new Error(`Unknown RadialAxial type: ${T[1]}`)}for(const L of y){const X=this.svgFactory.createElement("svg:stop");X.setAttributeNS(null,"offset",L[0]),X.setAttributeNS(null,"stop-color",L[1]),N.append(X)}return this.defs.append(N),`url(#${w})`;case"Mesh":return(0,i.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${T[0]}`)}}setDash(T,w){this.current.dashArray=T,this.current.dashPhase=w}constructPath(T,w){const y=this.current;let N=y.x,L=y.y,X=[],z=0;for(const se of T)switch(se|0){case i.OPS.rectangle:N=w[z++],L=w[z++];const me=w[z++],_e=w[z++],de=N+me,Y=L+_e;X.push("M",m(N),m(L),"L",m(de),m(L),"L",m(de),m(Y),"L",m(N),m(Y),"Z");break;case i.OPS.moveTo:N=w[z++],L=w[z++],X.push("M",m(N),m(L));break;case i.OPS.lineTo:N=w[z++],L=w[z++],X.push("L",m(N),m(L));break;case i.OPS.curveTo:N=w[z+4],L=w[z+5],X.push("C",m(w[z]),m(w[z+1]),m(w[z+2]),m(w[z+3]),m(N),m(L)),z+=6;break;case i.OPS.curveTo2:X.push("C",m(N),m(L),m(w[z]),m(w[z+1]),m(w[z+2]),m(w[z+3])),N=w[z+2],L=w[z+3],z+=4;break;case i.OPS.curveTo3:N=w[z+2],L=w[z+3],X.push("C",m(w[z]),m(w[z+1]),m(N),m(L),m(N),m(L)),z+=4;break;case i.OPS.closePath:X.push("Z");break}X=X.join(" "),y.path&&T.length>0&&T[0]!==i.OPS.rectangle&&T[0]!==i.OPS.moveTo?X=y.path.getAttributeNS(null,"d")+X:(y.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(y.path)),y.path.setAttributeNS(null,"d",X),y.path.setAttributeNS(null,"fill","none"),y.element=y.path,y.setCurrentPoint(N,L)}endPath(){const T=this.current;if(T.path=null,!this.pendingClip)return;if(!T.element){this.pendingClip=null;return}const w=`clippath${D++}`,y=this.svgFactory.createElement("svg:clipPath");y.setAttributeNS(null,"id",w),y.setAttributeNS(null,"transform",b(this.transformMatrix));const N=T.element.cloneNode(!0);if(this.pendingClip==="evenodd"?N.setAttributeNS(null,"clip-rule","evenodd"):N.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,y.append(N),this.defs.append(y),T.activeClipUrl){T.clipGroup=null;for(const L of this.extraStack)L.clipGroup=null;y.setAttributeNS(null,"clip-path",T.activeClipUrl)}T.activeClipUrl=`url(#${w})`,this.tgrp=null}clip(T){this.pendingClip=T}closePath(){const T=this.current;if(T.path){const w=`${T.path.getAttributeNS(null,"d")}Z`;T.path.setAttributeNS(null,"d",w)}}setLeading(T){this.current.leading=-T}setTextRise(T){this.current.textRise=T}setTextRenderingMode(T){this.current.textRenderingMode=T}setHScale(T){this.current.textHScale=T/100}setRenderingIntent(T){}setFlatness(T){}setGState(T){for(const[w,y]of T)switch(w){case"LW":this.setLineWidth(y);break;case"LC":this.setLineCap(y);break;case"LJ":this.setLineJoin(y);break;case"ML":this.setMiterLimit(y);break;case"D":this.setDash(y[0],y[1]);break;case"RI":this.setRenderingIntent(y);break;case"FL":this.setFlatness(y);break;case"Font":this.setFont(y);break;case"CA":this.setStrokeAlpha(y);break;case"ca":this.setFillAlpha(y);break;default:(0,i.warn)(`Unimplemented graphic state operator ${w}`);break}}fill(){const T=this.current;T.element&&(T.element.setAttributeNS(null,"fill",T.fillColor),T.element.setAttributeNS(null,"fill-opacity",T.fillAlpha),this.endPath())}stroke(){const T=this.current;T.element&&(this._setStrokeAttributes(T.element),T.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(T,w=1){const y=this.current;let N=y.dashArray;w!==1&&N.length>0&&(N=N.map(function(L){return w*L})),T.setAttributeNS(null,"stroke",y.strokeColor),T.setAttributeNS(null,"stroke-opacity",y.strokeAlpha),T.setAttributeNS(null,"stroke-miterlimit",m(y.miterLimit)),T.setAttributeNS(null,"stroke-linecap",y.lineCap),T.setAttributeNS(null,"stroke-linejoin",y.lineJoin),T.setAttributeNS(null,"stroke-width",m(w*y.lineWidth)+"px"),T.setAttributeNS(null,"stroke-dasharray",N.map(m).join(" ")),T.setAttributeNS(null,"stroke-dashoffset",m(w*y.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const T=this.svgFactory.createElement("svg:rect");T.setAttributeNS(null,"x","0"),T.setAttributeNS(null,"y","0"),T.setAttributeNS(null,"width","1px"),T.setAttributeNS(null,"height","1px"),T.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(T)}paintImageXObject(T){const w=T.startsWith("g_")?this.commonObjs.get(T):this.objs.get(T);if(!w){(0,i.warn)(`Dependent image with object ID ${T} is not ready yet`);return}this.paintInlineImageXObject(w)}paintInlineImageXObject(T,w){const y=T.width,N=T.height,L=S(T,this.forceDataSchema,!!w),X=this.svgFactory.createElement("svg:rect");X.setAttributeNS(null,"x","0"),X.setAttributeNS(null,"y","0"),X.setAttributeNS(null,"width",m(y)),X.setAttributeNS(null,"height",m(N)),this.current.element=X,this.clip("nonzero");const z=this.svgFactory.createElement("svg:image");z.setAttributeNS(h,"xlink:href",L),z.setAttributeNS(null,"x","0"),z.setAttributeNS(null,"y",m(-N)),z.setAttributeNS(null,"width",m(y)+"px"),z.setAttributeNS(null,"height",m(N)+"px"),z.setAttributeNS(null,"transform",`scale(${m(1/y)} ${m(-1/N)})`),w?w.append(z):this._ensureTransformGroup().append(z)}paintImageMaskXObject(T){const w=this.current,y=T.width,N=T.height,L=w.fillColor;w.maskId=`mask${C++}`;const X=this.svgFactory.createElement("svg:mask");X.setAttributeNS(null,"id",w.maskId);const z=this.svgFactory.createElement("svg:rect");z.setAttributeNS(null,"x","0"),z.setAttributeNS(null,"y","0"),z.setAttributeNS(null,"width",m(y)),z.setAttributeNS(null,"height",m(N)),z.setAttributeNS(null,"fill",L),z.setAttributeNS(null,"mask",`url(#${w.maskId})`),this.defs.append(X),this._ensureTransformGroup().append(z),this.paintInlineImageXObject(T,X)}paintFormXObjectBegin(T,w){if(Array.isArray(T)&&T.length===6&&this.transform(T[0],T[1],T[2],T[3],T[4],T[5]),w){const y=w[2]-w[0],N=w[3]-w[1],L=this.svgFactory.createElement("svg:rect");L.setAttributeNS(null,"x",w[0]),L.setAttributeNS(null,"y",w[1]),L.setAttributeNS(null,"width",m(y)),L.setAttributeNS(null,"height",m(N)),this.current.element=L,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(T){const w=this.svgFactory.create(T.width,T.height),y=this.svgFactory.createElement("svg:defs");w.append(y),this.defs=y;const N=this.svgFactory.createElement("svg:g");return N.setAttributeNS(null,"transform",b(T.transform)),w.append(N),this.svg=N,w}_ensureClipGroup(){if(!this.current.clipGroup){const T=this.svgFactory.createElement("svg:g");T.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(T),this.current.clipGroup=T}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",b(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFNodeStream=void 0;var n=t(1),i=t(33);const l=require$$5,c=require$$5,f=require$$5,d=require$$5,h=/^file:\/\/\/[a-zA-Z]:\//;function p(C){const F=d.parse(C);return F.protocol==="file:"||F.host?F:/^[a-z]:[/\\]/i.test(C)?d.parse(`file:///${C}`):(F.host||(F.protocol="file:"),F)}class E{constructor(F){this.source=F,this.url=p(F.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&F.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var F;return((F=this._fullRequestReader)==null?void 0:F._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new b(this):new g(this),this._fullRequestReader}getRangeReader(F,T){if(T<=this._progressiveDataLength)return null;const w=this.isFsUrl?new D(this,F,T):new m(this,F,T);return this._rangeRequestReaders.push(w),w}cancelAllRequests(F){this._fullRequestReader&&this._fullRequestReader.cancel(F);for(const T of this._rangeRequestReaders.slice(0))T.cancel(F)}}r.PDFNodeStream=E;class v{constructor(F){this._url=F.url,this._done=!1,this._storedError=null,this.onProgress=null;const T=F.source;this._contentLength=T.length,this._loaded=0,this._filename=null,this._disableRange=T.disableRange||!1,this._rangeChunkSize=T.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!T.disableStream,this._isRangeSupported=!T.disableRange,this._readableStream=null,this._readCapability=(0,n.createPromiseCapability)(),this._headersCapability=(0,n.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const F=this._readableStream.read();return F===null?(this._readCapability=(0,n.createPromiseCapability)(),this.read()):(this._loaded+=F.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(F).buffer,done:!1})}cancel(F){if(!this._readableStream){this._error(F);return}this._readableStream.destroy(F)}_error(F){this._storedError=F,this._readCapability.resolve()}_setReadableStream(F){this._readableStream=F,F.on("readable",()=>{this._readCapability.resolve()}),F.on("end",()=>{F.destroy(),this._done=!0,this._readCapability.resolve()}),F.on("error",T=>{this._error(T)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class S{constructor(F){this._url=F.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,n.createPromiseCapability)();const T=F.source;this._isStreamingSupported=!T.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const F=this._readableStream.read();return F===null?(this._readCapability=(0,n.createPromiseCapability)(),this.read()):(this._loaded+=F.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(F).buffer,done:!1})}cancel(F){if(!this._readableStream){this._error(F);return}this._readableStream.destroy(F)}_error(F){this._storedError=F,this._readCapability.resolve()}_setReadableStream(F){this._readableStream=F,F.on("readable",()=>{this._readCapability.resolve()}),F.on("end",()=>{F.destroy(),this._done=!0,this._readCapability.resolve()}),F.on("error",T=>{this._error(T)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function x(C,F){return{protocol:C.protocol,auth:C.auth,host:C.hostname,port:C.port,path:C.path,method:"GET",headers:F}}class g extends v{constructor(F){super(F);const T=w=>{if(w.statusCode===404){const X=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=X,this._headersCapability.reject(X);return}this._headersCapability.resolve(),this._setReadableStream(w);const y=X=>this._readableStream.headers[X.toLowerCase()],{allowRangeRequests:N,suggestedLength:L}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:y,isHttp:F.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=N,this._contentLength=L||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(y)};this._request=null,this._url.protocol==="http:"?this._request=c.request(x(this._url,F.httpHeaders),T):this._request=f.request(x(this._url,F.httpHeaders),T),this._request.on("error",w=>{this._storedError=w,this._headersCapability.reject(w)}),this._request.end()}}class m extends S{constructor(F,T,w){super(F),this._httpHeaders={};for(const N in F.httpHeaders){const L=F.httpHeaders[N];typeof L>"u"||(this._httpHeaders[N]=L)}this._httpHeaders.Range=`bytes=${T}-${w-1}`;const y=N=>{if(N.statusCode===404){const L=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=L;return}this._setReadableStream(N)};this._request=null,this._url.protocol==="http:"?this._request=c.request(x(this._url,this._httpHeaders),y):this._request=f.request(x(this._url,this._httpHeaders),y),this._request.on("error",N=>{this._storedError=N}),this._request.end()}}class b extends v{constructor(F){super(F);let T=decodeURIComponent(this._url.path);h.test(this._url.href)&&(T=T.replace(/^\//,"")),l.lstat(T,(w,y)=>{if(w){w.code==="ENOENT"&&(w=new n.MissingPDFException(`Missing PDF "${T}".`)),this._storedError=w,this._headersCapability.reject(w);return}this._contentLength=y.size,this._setReadableStream(l.createReadStream(T)),this._headersCapability.resolve()})}}class D extends S{constructor(F,T,w){super(F);let y=decodeURIComponent(this._url.path);h.test(this._url.href)&&(y=y.replace(/^\//,"")),this._setReadableStream(l.createReadStream(y,{start:T,end:w-1}))}}},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.createResponseStatusError=d,r.extractFilenameFromHeader=f,r.validateRangeRequestCapabilities=c,r.validateResponseStatus=h;var n=t(1),i=t(34),l=t(8);function c({getResponseHeader:p,isHttp:E,rangeChunkSize:v,disableRange:S}){const x={allowRangeRequests:!1,suggestedLength:void 0},g=parseInt(p("Content-Length"),10);return!Number.isInteger(g)||(x.suggestedLength=g,g<=2*v)||S||!E||p("Accept-Ranges")!=="bytes"||(p("Content-Encoding")||"identity")!=="identity"||(x.allowRangeRequests=!0),x}function f(p){const E=p("Content-Disposition");if(E){let v=(0,i.getFilenameFromContentDispositionHeader)(E);if(v.includes("%"))try{v=decodeURIComponent(v)}catch{}if((0,l.isPdfFile)(v))return v}return null}function d(p,E){return p===404||p===0&&E.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+E+'".'):new n.UnexpectedResponseException(`Unexpected server response (${p}) while retrieving PDF "${E}".`,p)}function h(p){return p===200||p===206}},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.getFilenameFromContentDispositionHeader=i;var n=t(1);function i(l){let c=!0,f=d("filename\\*","i").exec(l);if(f){f=f[1];let g=v(f);return g=unescape(g),g=S(g),g=x(g),p(g)}if(f=E(l),f){const g=x(f);return p(g)}if(f=d("filename","i").exec(l),f){f=f[1];let g=v(f);return g=x(g),p(g)}function d(g,m){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',m)}function h(g,m){if(g){if(!/^[\x00-\xFF]+$/.test(m))return m;try{const b=new TextDecoder(g,{fatal:!0}),D=(0,n.stringToBytes)(m);m=b.decode(D),c=!1}catch{}}return m}function p(g){return c&&/[\x80-\xff]/.test(g)&&(g=h("utf-8",g),c&&(g=h("iso-8859-1",g))),g}function E(g){const m=[];let b;const D=d("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(b=D.exec(g))!==null;){let[,F,T,w]=b;if(F=parseInt(F,10),F in m){if(F===0)break;continue}m[F]=[T,w]}const C=[];for(let F=0;F<m.length&&F in m;++F){let[T,w]=m[F];w=v(w),T&&(w=unescape(w),F===0&&(w=S(w))),C.push(w)}return C.join("")}function v(g){if(g.startsWith('"')){const m=g.slice(1).split('\\"');for(let b=0;b<m.length;++b){const D=m[b].indexOf('"');D!==-1&&(m[b]=m[b].slice(0,D),m.length=b+1),m[b]=m[b].replace(/\\(.)/g,"$1")}g=m.join('"')}return g}function S(g){const m=g.indexOf("'");if(m===-1)return g;const b=g.slice(0,m),C=g.slice(m+1).replace(/^[^']*'/,"");return h(b,C)}function x(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(m,b,D,C){if(D==="q"||D==="Q")return C=C.replace(/_/g," "),C=C.replace(/=([0-9a-fA-F]{2})/g,function(F,T){return String.fromCharCode(parseInt(T,16))}),h(b,C);try{C=atob(C)}catch{}return h(b,C)})}return""}},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFNetworkStream=void 0;var n=t(1),i=t(33);const l=200,c=206;function f(v){const S=v.response;return typeof S!="string"?S:(0,n.stringToBytes)(S).buffer}class d{constructor(S,x={}){this.url=S,this.isHttp=/^https?:/i.test(S),this.httpHeaders=this.isHttp&&x.httpHeaders||Object.create(null),this.withCredentials=x.withCredentials||!1,this.getXhr=x.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(S,x,g){const m={begin:S,end:x};for(const b in g)m[b]=g[b];return this.request(m)}requestFull(S){return this.request(S)}request(S){const x=this.getXhr(),g=this.currXhrId++,m=this.pendingRequests[g]={xhr:x};x.open("GET",this.url),x.withCredentials=this.withCredentials;for(const b in this.httpHeaders){const D=this.httpHeaders[b];typeof D>"u"||x.setRequestHeader(b,D)}return this.isHttp&&"begin"in S&&"end"in S?(x.setRequestHeader("Range",`bytes=${S.begin}-${S.end-1}`),m.expectedStatus=c):m.expectedStatus=l,x.responseType="arraybuffer",S.onError&&(x.onerror=function(b){S.onError(x.status)}),x.onreadystatechange=this.onStateChange.bind(this,g),x.onprogress=this.onProgress.bind(this,g),m.onHeadersReceived=S.onHeadersReceived,m.onDone=S.onDone,m.onError=S.onError,m.onProgress=S.onProgress,x.send(null),g}onProgress(S,x){var m;const g=this.pendingRequests[S];g&&((m=g.onProgress)==null||m.call(g,x))}onStateChange(S,x){var F,T,w;const g=this.pendingRequests[S];if(!g)return;const m=g.xhr;if(m.readyState>=2&&g.onHeadersReceived&&(g.onHeadersReceived(),delete g.onHeadersReceived),m.readyState!==4||!(S in this.pendingRequests))return;if(delete this.pendingRequests[S],m.status===0&&this.isHttp){(F=g.onError)==null||F.call(g,m.status);return}const b=m.status||l;if(!(b===l&&g.expectedStatus===c)&&b!==g.expectedStatus){(T=g.onError)==null||T.call(g,m.status);return}const C=f(m);if(b===c){const y=m.getResponseHeader("Content-Range"),N=/bytes (\d+)-(\d+)\/(\d+)/.exec(y);g.onDone({begin:parseInt(N[1],10),chunk:C})}else C?g.onDone({begin:0,chunk:C}):(w=g.onError)==null||w.call(g,m.status)}getRequestXhr(S){return this.pendingRequests[S].xhr}isPendingRequest(S){return S in this.pendingRequests}abortRequest(S){const x=this.pendingRequests[S].xhr;delete this.pendingRequests[S],x.abort()}}class h{constructor(S){this._source=S,this._manager=new d(S.url,{httpHeaders:S.httpHeaders,withCredentials:S.withCredentials}),this._rangeChunkSize=S.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(S){const x=this._rangeRequestReaders.indexOf(S);x>=0&&this._rangeRequestReaders.splice(x,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new p(this._manager,this._source),this._fullRequestReader}getRangeReader(S,x){const g=new E(this._manager,S,x);return g.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(g),g}cancelAllRequests(S){var x;(x=this._fullRequestReader)==null||x.cancel(S);for(const g of this._rangeRequestReaders.slice(0))g.cancel(S)}}r.PDFNetworkStream=h;class p{constructor(S,x){this._manager=S;const g={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=x.url,this._fullRequestId=S.requestFull(g),this._headersReceivedCapability=(0,n.createPromiseCapability)(),this._disableRange=x.disableRange||!1,this._contentLength=x.length,this._rangeChunkSize=x.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const S=this._fullRequestId,x=this._manager.getRequestXhr(S),g=D=>x.getResponseHeader(D),{allowRangeRequests:m,suggestedLength:b}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});m&&(this._isRangeSupported=!0),this._contentLength=b||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(g),this._isRangeSupported&&this._manager.abortRequest(S),this._headersReceivedCapability.resolve()}_onDone(S){if(S&&(this._requests.length>0?this._requests.shift().resolve({value:S.chunk,done:!1}):this._cachedChunks.push(S.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const x of this._requests)x.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(S){this._storedError=(0,i.createResponseStatusError)(S,this._url),this._headersReceivedCapability.reject(this._storedError);for(const x of this._requests)x.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(S){var x;(x=this.onProgress)==null||x.call(this,{loaded:S.loaded,total:S.lengthComputable?S.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const S=(0,n.createPromiseCapability)();return this._requests.push(S),S.promise}cancel(S){this._done=!0,this._headersReceivedCapability.reject(S);for(const x of this._requests)x.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class E{constructor(S,x,g){this._manager=S;const m={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=S.url,this._requestId=S.requestRange(x,g,m),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var S;(S=this.onClosed)==null||S.call(this,this)}_onDone(S){const x=S.chunk;this._requests.length>0?this._requests.shift().resolve({value:x,done:!1}):this._queuedChunk=x,this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(S){this._storedError=(0,i.createResponseStatusError)(S,this._url);for(const x of this._requests)x.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(S){var x;this.isStreamingSupported||(x=this.onProgress)==null||x.call(this,{loaded:S.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const x=this._queuedChunk;return this._queuedChunk=null,{value:x,done:!1}}if(this._done)return{value:void 0,done:!0};const S=(0,n.createPromiseCapability)();return this._requests.push(S),S.promise}cancel(S){this._done=!0;for(const x of this._requests)x.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(e,r,t)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.PDFFetchStream=void 0;var n=t(1),i=t(33);function l(p,E,v){return{method:"GET",headers:p,signal:v.signal,mode:"cors",credentials:E?"include":"same-origin",redirect:"follow"}}function c(p){const E=new Headers;for(const v in p){const S=p[v];typeof S>"u"||E.append(v,S)}return E}class f{constructor(E){this.source=E,this.isHttp=/^https?:/i.test(E.url),this.httpHeaders=this.isHttp&&E.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var E;return((E=this._fullRequestReader)==null?void 0:E._loaded)??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new d(this),this._fullRequestReader}getRangeReader(E,v){if(v<=this._progressiveDataLength)return null;const S=new h(this,E,v);return this._rangeRequestReaders.push(S),S}cancelAllRequests(E){this._fullRequestReader&&this._fullRequestReader.cancel(E);for(const v of this._rangeRequestReaders.slice(0))v.cancel(E)}}r.PDFFetchStream=f;class d{constructor(E){this._stream=E,this._reader=null,this._loaded=0,this._filename=null;const v=E.source;this._withCredentials=v.withCredentials||!1,this._contentLength=v.length,this._headersCapability=(0,n.createPromiseCapability)(),this._disableRange=v.disableRange||!1,this._rangeChunkSize=v.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!v.disableStream,this._isRangeSupported=!v.disableRange,this._headers=c(this._stream.httpHeaders);const S=v.url;fetch(S,l(this._headers,this._withCredentials,this._abortController)).then(x=>{if(!(0,i.validateResponseStatus)(x.status))throw(0,i.createResponseStatusError)(x.status,S);this._reader=x.body.getReader(),this._headersCapability.resolve();const g=D=>x.headers.get(D),{allowRangeRequests:m,suggestedLength:b}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:g,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=m,this._contentLength=b||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(g),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:E,done:v}=await this._reader.read();return v?{value:E,done:v}:(this._loaded+=E.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(E).buffer,done:!1})}cancel(E){this._reader&&this._reader.cancel(E),this._abortController.abort()}}class h{constructor(E,v,S){this._stream=E,this._reader=null,this._loaded=0;const x=E.source;this._withCredentials=x.withCredentials||!1,this._readCapability=(0,n.createPromiseCapability)(),this._isStreamingSupported=!x.disableStream,this._abortController=new AbortController,this._headers=c(this._stream.httpHeaders),this._headers.append("Range",`bytes=${v}-${S-1}`);const g=x.url;fetch(g,l(this._headers,this._withCredentials,this._abortController)).then(m=>{if(!(0,i.validateResponseStatus)(m.status))throw(0,i.createResponseStatusError)(m.status,g);this._readCapability.resolve(),this._reader=m.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:E,done:v}=await this._reader.read();return v?{value:E,done:v}:(this._loaded+=E.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(E).buffer,done:!1})}cancel(E){this._reader&&this._reader.cancel(E),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(e){var r=__webpack_module_cache__[e];if(r!==void 0)return r.exports;var t=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](t,t.exports,__w_pdfjs_require__),t.exports}var __webpack_exports__={};return(()=>{var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"AnnotationEditorLayer",{enumerable:!0,get:function(){return i.AnnotationEditorLayer}}),Object.defineProperty(e,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return r.AnnotationEditorParamsType}}),Object.defineProperty(e,"AnnotationEditorType",{enumerable:!0,get:function(){return r.AnnotationEditorType}}),Object.defineProperty(e,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return l.AnnotationEditorUIManager}}),Object.defineProperty(e,"AnnotationLayer",{enumerable:!0,get:function(){return c.AnnotationLayer}}),Object.defineProperty(e,"AnnotationMode",{enumerable:!0,get:function(){return r.AnnotationMode}}),Object.defineProperty(e,"CMapCompressionType",{enumerable:!0,get:function(){return r.CMapCompressionType}}),Object.defineProperty(e,"GlobalWorkerOptions",{enumerable:!0,get:function(){return f.GlobalWorkerOptions}}),Object.defineProperty(e,"InvalidPDFException",{enumerable:!0,get:function(){return r.InvalidPDFException}}),Object.defineProperty(e,"LoopbackPort",{enumerable:!0,get:function(){return t.LoopbackPort}}),Object.defineProperty(e,"MissingPDFException",{enumerable:!0,get:function(){return r.MissingPDFException}}),Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return r.OPS}}),Object.defineProperty(e,"PDFDataRangeTransport",{enumerable:!0,get:function(){return t.PDFDataRangeTransport}}),Object.defineProperty(e,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(e,"PDFWorker",{enumerable:!0,get:function(){return t.PDFWorker}}),Object.defineProperty(e,"PasswordResponses",{enumerable:!0,get:function(){return r.PasswordResponses}}),Object.defineProperty(e,"PermissionFlag",{enumerable:!0,get:function(){return r.PermissionFlag}}),Object.defineProperty(e,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty(e,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(e,"SVGGraphics",{enumerable:!0,get:function(){return p.SVGGraphics}}),Object.defineProperty(e,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return r.UNSUPPORTED_FEATURES}}),Object.defineProperty(e,"UnexpectedResponseException",{enumerable:!0,get:function(){return r.UnexpectedResponseException}}),Object.defineProperty(e,"Util",{enumerable:!0,get:function(){return r.Util}}),Object.defineProperty(e,"VerbosityLevel",{enumerable:!0,get:function(){return r.VerbosityLevel}}),Object.defineProperty(e,"XfaLayer",{enumerable:!0,get:function(){return E.XfaLayer}}),Object.defineProperty(e,"build",{enumerable:!0,get:function(){return t.build}}),Object.defineProperty(e,"createPromiseCapability",{enumerable:!0,get:function(){return r.createPromiseCapability}}),Object.defineProperty(e,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return r.createValidAbsoluteUrl}}),Object.defineProperty(e,"getDocument",{enumerable:!0,get:function(){return t.getDocument}}),Object.defineProperty(e,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(e,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(e,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty(e,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(e,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(e,"renderTextLayer",{enumerable:!0,get:function(){return h.renderTextLayer}}),Object.defineProperty(e,"shadow",{enumerable:!0,get:function(){return r.shadow}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return t.version}});var r=__w_pdfjs_require__(1),t=__w_pdfjs_require__(4),n=__w_pdfjs_require__(8),i=__w_pdfjs_require__(22),l=__w_pdfjs_require__(7),c=__w_pdfjs_require__(27),f=__w_pdfjs_require__(15),d=__w_pdfjs_require__(3),h=__w_pdfjs_require__(30),p=__w_pdfjs_require__(31),E=__w_pdfjs_require__(29);if(d.isNodeJS){const{PDFNodeStream:v}=__w_pdfjs_require__(32);(0,t.setPDFNetworkStreamFactory)(S=>new v(S))}else{const{PDFNetworkStream:v}=__w_pdfjs_require__(35),{PDFFetchStream:S}=__w_pdfjs_require__(36);(0,t.setPDFNetworkStreamFactory)(x=>(0,n.isValidFetchUrl)(x.url)?new S(x):new v(x))}})(),__webpack_exports__})())}(pdf)),pdf.exports}var pdfExports=requirePdf();pdfExports.GlobalWorkerOptions.workerSrc="/pdf.worker.min.js";const supabaseUrl$1="https://ydxelzxjsuemylifgwte.supabase.co",supabaseAnonKey$1="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkeGVsenhqc3VlbXlsaWZnd3RlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzY2MDY4MzAsImV4cCI6MjA1MjE4MjgzMH0.Nnbgsp8NvJaD_DyXpsNwnvrdZUwZz4ylWzv7_fglxPo";createClient(supabaseUrl$1,supabaseAnonKey$1);const CommentListener=()=>{const[e,r]=reactExports.useState(()=>JSON.parse(localStorage.getItem("messages"))||[]),[t,n]=reactExports.useState("John"),[i,l]=reactExports.useState(""),[c,f]=reactExports.useState("none"),d="/files/contact.xlsx;/files/Mathematical database development_.pdf";async function h(C,F){var T=atob("c2stcHJvai1iV2Z5UEdZUE80OFZJMGVfQmFaSjM2ZnV1X1c5M3c1eDNhWnF0OE9XS0RObFY3RFZrMWdQQ0xaaFdZTUhKdDI5N1ZIRERZMUEwblQzQmxia0ZKckJVa0lBT0J3MFY3RU9OcXE0bllVYUduYUExVTM3SmVBYTEzNDNNYUlwUDQycEdJX1Rtd2wyTGFxV3ZFV19fWkJQc0tQUlpxWUE=");const y=await(await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+T},body:JSON.stringify({model:"gpt-4",messages:[{role:"system",content:"You are a helpful assistant."},{role:"user",content:C+(C===""?"":`
Based on the previous text and/or CSV report, provide a natural and conversational response to the following question :  `)+F}],max_tokens:300})})).json();return alert(y.choices.length),y.choices[0].message.content}async function p(C){try{return alert("SUM = "+v.length),console.log(v[0]),v.length>0?await h(v[0],C):(alert(v[1]),(await(await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+k},body:JSON.stringify({model:"gpt-4",messages:[{role:"system",content:"You are a helpful assistant."},{role:"user",content:data.choices[0].message.content+`
`+v[1]+`
Based on the previous text and/or CSV report, could you repeat the response to the following question :  `+C}],max_tokens:400})})).json()).choices[0].message.content)}catch(F){return console.error("Error fetching ChatGPT response:",F),"Sorry, I couldn't process your request."}}const E=reactExports.useRef(null),[v,S]=reactExports.useState([]);reactExports.useEffect(()=>{(async()=>{try{const F=d.split(";");alert(F);const T=F.map(N=>fetch(N).then(L=>{if(N.endsWith(".txt"))return L.text();if(N.endsWith(".pdf"))return L.arrayBuffer();if(N.endsWith(".xlsx"))return L.arrayBuffer()}).catch(L=>console.error("Error fetching file:",L)));alert("B"+T.length);const w=await Promise.all(T),y=await Promise.all(w.map((N,L)=>{const X=F[L];if(X.endsWith(".txt"))return N;if(X.endsWith(".pdf"))return x(N);if(X.endsWith(".xlsx"))return g(N)}));alert("A"+y.length),S(y)}catch(F){console.error("Error in fetchFiles function:",F)}})()},[]);const x=async C=>{const F=await pdfExports.getDocument({data:C}).promise;let T="";for(let w=1;w<=F.numPages;w++){const L=(await(await F.getPage(w)).getTextContent()).items.map(X=>X.str).join(" ");T+=L+`
`}return T},g=C=>{const F=readSync(C,{type:"array"});let T="";return F.SheetNames.forEach(w=>{const y=F.Sheets[w];T+=utils.sheet_to_csv(y)+`
`}),T};reactExports.useEffect(()=>{localStorage.setItem("messages",JSON.stringify(e))},[e]),reactExports.useEffect(()=>{E.current&&(E.current.scrollTop=E.current.scrollHeight)},[e]);const m=C=>{n(C)},b=async C=>{if(C.preventDefault(),i.trim()==="")return;const F=new Date().toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}),T={sender:t,text:i,timestamp:F};if(r(w=>[...w,T]),t==="John"){console.log("msg : "+i),f("flex");const y={sender:"Jane",text:await p(i),timestamp:F};r(N=>[...N,y]),f("none")}l("")},D=()=>{localStorage.clear(),r([])};return jsxRuntimeExports.jsxs("div",{className:"app-container",children:[jsxRuntimeExports.jsxs("div",{className:"person-selector",children:[jsxRuntimeExports.jsx("button",{className:`button person-selector-button ${t==="John"?"active-person":""}`,onClick:()=>m("John"),children:"John"}),jsxRuntimeExports.jsx("button",{className:`button person-selector-button ${t==="Jane"?"active-person":""}`,onClick:()=>m("Jane"),children:"Jane"})]}),jsxRuntimeExports.jsxs("div",{className:"chat-container",children:[jsxRuntimeExports.jsxs("div",{className:"chat-header typing-indicator",style:{display:c},children:[jsxRuntimeExports.jsxs("h2",{className:"chat-header",children:[t," chatting"]}),jsxRuntimeExports.jsx("span",{className:"dot"}),jsxRuntimeExports.jsx("span",{className:"dot"}),jsxRuntimeExports.jsx("span",{className:"dot"})]}),jsxRuntimeExports.jsx("div",{ref:E,className:"chat-messages",children:e.map((C,F)=>jsxRuntimeExports.jsxs("div",{className:`message ${C.sender==="John"?"blue-bg":"gray-bg"}`,children:[jsxRuntimeExports.jsx("div",{className:"message-sender",children:C.sender}),jsxRuntimeExports.jsx("div",{className:"message-text",children:C.text}),jsxRuntimeExports.jsx("div",{className:"message-timestamp",children:C.timestamp})]},F))}),jsxRuntimeExports.jsxs("form",{className:"chat-input-form",onSubmit:b,children:[jsxRuntimeExports.jsx("textarea",{id:"message",name:"message",rows:"5",cols:"50",className:"chat-input",value:i,placeholder:`Type here, ${t}...`,onChange:C=>l(C.target.value)}),jsxRuntimeExports.jsx("button",{type:"submit",className:"button send-button",children:"Send"})]}),jsxRuntimeExports.jsx("button",{className:"button send-button",onClick:D,children:"Clear Chat"})]})]})},supabaseUrl="https://ydxelzxjsuemylifgwte.supabase.co",supabaseAnonKey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkeGVsenhqc3VlbXlsaWZnd3RlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzY2MDY4MzAsImV4cCI6MjA1MjE4MjgzMH0.Nnbgsp8NvJaD_DyXpsNwnvrdZUwZz4ylWzv7_fglxPo";createClient(supabaseUrl,supabaseAnonKey);const App=()=>jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("main",{children:jsxRuntimeExports.jsx(CommentListener,{})})}),root=ReactDOM.createRoot(document.getElementById("root"));root.render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(BrowserRouter,{basename:"/",children:jsxRuntimeExports.jsx(App,{})})}));export{getDefaultExportFromCjs as g};
